function regionCreate(){var t=regionPool.pop();return t||(t=new Region),t}function regionRelease(t){regionPool.push(t)}function unionArea(t,e){var i=t._minX<e._minX?t._minX:e._minX,n=t._minY<e._minY?t._minY:e._minY,r=t._maxX>e._maxX?t._maxX:e._maxX,o=t._maxY>e._maxY?t._maxY:e._maxY;return(r-i)*(o-n)}var cc=cc||{};cc._tmp=cc._tmp||{},cc._LogInfos={};var _p=window;_p.gl,_p.WebGLRenderingContext,_p.DeviceOrientationEvent,_p.DeviceMotionEvent,_p.AudioContext,_p.AudioContext||_p.webkitAudioContext,_p.mozAudioContext,_p=Object.prototype,_p._super,_p.ctor,_p=null,cc.ORIENTATION_PORTRAIT=0,cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1,cc.ORIENTATION_LANDSCAPE_LEFT=2,cc.ORIENTATION_LANDSCAPE_RIGHT=3,cc._drawingUtil=null,cc._renderContext=null,cc._supportRender=!1,cc._canvas=null,cc.container=null,cc._gameDiv=null,cc.newElement=function(t){return document.createElement(t)},cc.each=function(t,e,i){if(t)if(t instanceof Array){for(var n=0,r=t.length;n<r;n++)if(e.call(i,t[n],n)===!1)return}else for(var o in t)if(e.call(i,t[o],o)===!1)return},cc.extend=function(t){var e=arguments.length>=2?Array.prototype.slice.call(arguments,1):[];return cc.each(e,function(e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}),t},cc.isFunction=function(t){return"function"==typeof t},cc.isNumber=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},cc.isString=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},cc.isArray=function(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)},cc.isUndefined=function(t){return"undefined"==typeof t},cc.isObject=function(t){return"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)},cc.isCrossOrigin=function(t){if(!t)return cc.log("invalid URL"),!1;var e=t.indexOf("://");if(e===-1)return!1;var i=t.indexOf("/",e+3),n=i===-1?t:t.substring(0,i);return n!==location.origin},cc.AsyncPool=function(t,e,i,n,r){var o=this;o._srcObj=t,o._limit=e,o._pool=[],o._iterator=i,o._iteratorTarget=r,o._onEnd=n,o._onEndTarget=r,o._results=t instanceof Array?[]:{},o._errors=t instanceof Array?[]:{},cc.each(t,function(t,e){o._pool.push({index:e,value:t})}),o.size=o._pool.length,o.finishedSize=0,o._workingSize=0,o._limit=o._limit||o.size,o.onIterator=function(t,e){o._iterator=t,o._iteratorTarget=e},o.onEnd=function(t,e){o._onEnd=t,o._onEndTarget=e},o._handleItem=function(){var t=this;if(!(0===t._pool.length||t._workingSize>=t._limit)){var e=t._pool.shift(),i=e.value,n=e.index;t._workingSize++,t._iterator.call(t._iteratorTarget,i,n,function(e,i){if(t.finishedSize++,t._workingSize--,e?t._errors[this.index]=e:t._results[this.index]=i,t.finishedSize!==t.size)t._handleItem();else if(t._onEnd){var n=0===t._errors.length?null:t._errors;t._onEnd.call(t._onEndTarget,n,t._results)}}.bind(e),t)}},o.flow=function(){var t=this;if(0===t._pool.length)return void(t._onEnd&&t._onEnd.call(t._onEndTarget,null,[]));for(var e=0;e<t._limit;e++)t._handleItem()}},cc.async={series:function(t,e,i){var n=new cc.AsyncPool(t,1,function(t,e,n){t.call(i,n)},e,i);return n.flow(),n},parallel:function(t,e,i){var n=new cc.AsyncPool(t,0,function(t,e,n){t.call(i,n)},e,i);return n.flow(),n},waterfall:function(t,e,i){var n=[],r=[null],o=new cc.AsyncPool(t,1,function(e,o,s){n.push(function(e){n=Array.prototype.slice.call(arguments,1),t.length-1===o&&(r=r.concat(n)),s.apply(null,arguments)}),e.apply(i,n)},function(t){if(e)return t?e.call(i,t):void e.apply(i,r)});return o.flow(),o},map:function(t,e,i,n){var r=e;"object"==typeof e&&(i=e.cb,n=e.iteratorTarget,r=e.iterator);var o=new cc.AsyncPool(t,0,r,i,n);return o.flow(),o},mapLimit:function(t,e,i,n,r){var o=new cc.AsyncPool(t,e,i,n,r);return o.flow(),o}},cc.path={normalizeRE:/[^\.\/]+\/\.\.\//,join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(t);return e?e[1]:null},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(e!==-1)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");i>0&&(t=t.substring(0,i));var n=/(\/|\\\\)([^(\/|\\\\)]+)$/g,r=n.exec(t.replace(/(\/|\\\\)$/,""));if(!r)return null;var o=r[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?o.substring(0,o.length-e.length):o},dirname:function(t){return t.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),i=t.lastIndexOf("."),i<0?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),r="",o=i?this.extname(t):"";return n>0&&(r=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=n<=0?0:n+1,t.substring(0,n)+e+o+r},_normalize:function(t){var e=t=String(t);do{e=t,t=t.replace(this.normalizeRE,"")}while(e.length!==t.length);return t}},cc.loader=function(){var t={},e={},i={},n={},r={},o=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))|(?:localhost))(?::\\d{2,5})?(?:/\\S*)?$","i");return{resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(t){var e=t[0],i=t[1],n=t[2],r=["",null,null];if(1===t.length)r[1]=e instanceof Array?e:[e];else if(2===t.length)"function"==typeof i?(r[1]=e instanceof Array?e:[e],r[2]=i):(r[0]=e||"",r[1]=i instanceof Array?i:[i]);else{if(3!==t.length)throw new Error("arguments error to load js!");r[0]=e||"",r[1]=i instanceof Array?i:[i],r[2]=n}return r},isLoading:function(t){return void 0!==r[t]},loadJs:function(e,i,n){var r=this,o=r._getArgs4Js(arguments),s=o[0],c=o[1],a=o[2];navigator.userAgent.indexOf("Trident/5")>-1?r._loadJs4Dependency(s,c,0,a):cc.async.map(c,function(e,i,n){var o=cc.path.join(s,e);return t[o]?n(null):void r._createScript(o,!1,n)},a)},loadJsWithImg:function(t,e,i){var n=this,r=n._loadJsImg(),o=n._getArgs4Js(arguments);this.loadJs(o[0],o[1],function(t){if(t)throw new Error(t);r.parentNode.removeChild(r),o[2]&&o[2]()})},_createScript:function(e,i,n){var r=document,o=this,s=document.createElement("script");s.async=i,t[e]=!0,cc.game.config.noCache&&"string"==typeof e?o._noCacheRex.test(e)?s.src=e+"&_t="+(new Date-0):s.src=e+"?_t="+(new Date-0):s.src=e,s.addEventListener("load",function(){s.parentNode.removeChild(s),this.removeEventListener("load",arguments.callee,!1),n()},!1),s.addEventListener("error",function(){s.parentNode.removeChild(s),n("Load "+e+" failed!")},!1),r.body.appendChild(s)},_loadJs4Dependency:function(t,e,i,n){if(i>=e.length)return void(n&&n());var r=this;r._createScript(cc.path.join(t,e[i]),!1,function(o){return o?n(o):void r._loadJs4Dependency(t,e,i+1,n)})},_loadJsImg:function(){var t=document,e=t.getElementById("cocos2d_loadJsImg");if(!e){e=document.createElement("img"),cc._loadingImage&&(e.src=cc._loadingImage);var i=t.getElementById(cc.game.config.id);i.style.backgroundColor="transparent",i.parentNode.appendChild(e);var n=getComputedStyle?getComputedStyle(i):i.currentStyle;n||(n={width:i.width,height:i.height}),e.style.left=i.offsetLeft+(parseFloat(n.width)-e.width)/2+"px",e.style.top=i.offsetTop+(parseFloat(n.height)-e.height)/2+"px",e.style.position="absolute"}return e},loadTxt:function(t,e){if(cc._isNodeJs){var i=require("fs");i.readFile(t,function(t,i){t?e(t):e(null,i.toString())})}else{var n=this.getXMLHttpRequest(),r="load "+t+" failed!";n.open("GET",t,!0),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(n.setRequestHeader("Accept-Charset","utf-8"),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e(null,n.responseText):e({status:n.status,errorMessage:r},null))}):(n.overrideMimeType&&n.overrideMimeType("text/plain; charset=utf-8"),n.onload=function(){4===n.readyState&&(200===n.status?e(null,n.responseText):e({status:n.status,errorMessage:r},null))},n.onerror=function(){e({status:n.status,errorMessage:r},null)}),n.send(null)}},_loadTxtSync:function(t){if(cc._isNodeJs){var e=require("fs");return e.readFileSync(t).toString()}var i=this.getXMLHttpRequest();return i.open("GET",t,!1),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?i.setRequestHeader("Accept-Charset","utf-8"):i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.send(null),4===!i.readyState||200!==i.status?null:i.responseText},loadCsb:function(t,e){var i=new XMLHttpRequest,n="load "+t+" failed!";i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){var t=i.response;t&&(window.msg=t),4===i.readyState&&(200===i.status?e(null,i.response):e({status:i.status,errorMessage:n},null))},i.onerror=function(){e({status:i.status,errorMessage:n},null)},i.send(null)},loadJson:function(t,e){this.loadTxt(t,function(i,n){if(i)e(i);else{try{var r=JSON.parse(n)}catch(e){throw new Error("parse json ["+t+"] failed : "+e)}e(null,r)}})},_checkIsImageURL:function(t){var e=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(t);return null!=e},loadImg:function(t,e,i){var n={isCrossOrigin:!0};void 0!==i?n.isCrossOrigin=void 0===e.isCrossOrigin?n.isCrossOrigin:e.isCrossOrigin:void 0!==e&&(i=e);var s=this.getRes(t);if(s)return i&&i(null,s),s;var c=r[t];if(c)return c.callbacks.push(i),c.img;s=new Image,n.isCrossOrigin&&"file://"!==location.origin&&(s.crossOrigin="Anonymous");var a=function(){this.removeEventListener("load",a,!1),this.removeEventListener("error",h,!1),o.test(t)||(cc.loader.cache[t]=s);var e=r[t];if(e){for(var i=e.callbacks,n=0;n<i.length;++n){var c=i[n];c&&c(null,s)}e.img=null,delete r[t]}},l=this,h=function(){if(this.removeEventListener("error",h,!1),s.crossOrigin&&"anonymous"===s.crossOrigin.toLowerCase())n.isCrossOrigin=!1,l.release(t),cc.loader.loadImg(t,n,i);else{var e=r[t];if(e){for(var o=e.callbacks,c=0;c<o.length;++c){var a=o[c];a&&a("load image failed")}e.img=null,delete r[t]}}};return r[t]={img:s,callbacks:i?[i]:[]},s.addEventListener("load",a),s.addEventListener("error",h),s.src=t,s},_loadResIterator:function(t,i,n){var r=this,s=null,c=t.type;c?(c="."+c.toLowerCase(),s=t.src?t.src:t.name+c):(s=t,c=cc.path.extname(s));var a=r.getRes(s);if(a)return n(null,a);var l=null;if(c&&(l=e[c.toLowerCase()]),!l)return cc.error("loader for ["+c+"] not exists!"),n();var h=s;if(!o.test(s)){var u=l.getBasePath?l.getBasePath():r.resPath;h=r.getUrl(u,s)}cc.game.config.noCache&&"string"==typeof h&&(h+=r._noCacheRex.test(h)?"&_t="+(new Date-0):"?_t="+(new Date-0)),l.load(h,s,t,function(t,e){t?(cc.log(t),r.cache[s]=null,delete r.cache[s],n({status:520,errorMessage:t},null)):(r.cache[s]=e,n(null,e))})},_noCacheRex:/\?/,getUrl:function(t,n){var r=this,o=cc.path;if(void 0!==t&&void 0===n){n=t;var s=o.extname(n);s=s?s.toLowerCase():"";var c=e[s];t=c&&c.getBasePath?c.getBasePath():r.resPath}if(n=cc.path.join(t||"",n),n.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(i[n])return i[n];var a=o.extname(n)||"";n=i[n]=n.substring(0,n.length-a.length)+"_"+cc.sys.language+a}return n},load:function(t,e,i){var n=this,r=arguments.length;if(0===r)throw new Error("arguments error!");3===r?"function"==typeof e&&(e="function"==typeof i?{trigger:e,cb:i}:{cb:e,cbTarget:i}):2===r?"function"==typeof e&&(e={cb:e}):1===r&&(e={}),t instanceof Array||(t=[t]);var o=new cc.AsyncPool(t,0,function(t,i,r,o){n._loadResIterator(t,i,function(t){var i=Array.prototype.slice.call(arguments,1);e.trigger&&e.trigger.call(e.triggerTarget,i[0],o.size,o.finishedSize),r(t,i[0])})},e.cb,e.cbTarget);return o.flow(),o},_handleAliases:function(t,e){var i=[];for(var r in t){var o=t[r];n[r]=o,i.push(o)}this.load(i,e)},loadAliases:function(t,e){var i=this,n=i.getRes(t);n?i._handleAliases(n.filenames,e):i.load(t,function(t,n){i._handleAliases(n[0].filenames,e)})},register:function(t,i){if(t&&i){if("string"==typeof t)return e[t.trim().toLowerCase()]=i;for(var n=0,r=t.length;n<r;n++)e["."+t[n].trim().toLowerCase()]=i}},getRes:function(t){return this.cache[t]||this.cache[n[t]]},_getAliase:function(t){return n[t]},release:function(t){var e=this.cache,i=r[t];i&&(i.img=null,delete r[t]),delete e[t],delete e[n[t]],delete n[t]},releaseAll:function(){var t=this.cache;for(var e in t)delete t[e];for(var e in n)delete n[e]}}}(),cc.formatStr=function(){var t=arguments,e=t.length;if(e<1)return"";var i=t[0],n=!0;"object"==typeof i&&(n=!1);for(var r=1;r<e;++r){var o=t[r];if(n)for(;;){var s=null;if("number"==typeof o&&(s=i.match(/(%d)|(%s)/))){i=i.replace(/(%d)|(%s)/,o);break}s=i.match(/%s/),s?i=i.replace(/%s/,o):i+="    "+o;break}else i+="    "+o}return i},function(){function t(t){var e=cc.game.CONFIG_KEY,i=parseInt(t[e.renderMode])||0;(isNaN(i)||i>2||i<0)&&(t[e.renderMode]=0),cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!1,0===i?cc.sys.capabilities.opengl?(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0):cc.sys.capabilities.canvas&&(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):1===i&&cc.sys.capabilities.canvas?(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc._supportRender=!0):2===i&&cc.sys.capabilities.opengl&&(cc._renderType=cc.game.RENDER_TYPE_WEBGL,cc._supportRender=!0)}function e(t,i,n){if(a[i])return null;n=n||"";var r=[],o=t[i];if(!o)throw new Error("can not find module ["+i+"]");for(var s=cc.path,c=0,l=o.length;c<l;c++){var h=o[c];if(!a[h]){var u=s.extname(h);if(u)".js"===u.toLowerCase()&&r.push(s.join(n,h));else{var d=e(t,h,n);d&&(r=r.concat(d))}a[h]=1}}return r}function i(t){cc._initDebugSetting&&cc._initDebugSetting(t[cc.game.CONFIG_KEY.debugMode]),cc._engineLoaded=!0,cc.log(cc.ENGINE_VERSION),h&&h()}function n(t){var n=cc.game.CONFIG_KEY,r=t[n.engineDir],o=cc.loader;if(cc.Class)i(t);else{var s=cc.path.join(r,"moduleConfig.json");o.loadJson(s,function(n,o){if(n)throw new Error(n);var s=t.modules||[],c=o.module,a=[];cc.sys.capabilities.opengl&&s.indexOf("base4webgl")<0?s.splice(0,0,"base4webgl"):s.indexOf("core")<0&&s.splice(0,0,"core");for(var l=0,h=s.length;l<h;l++){var u=e(c,s[l],r);u&&(a=a.concat(u))}cc.loader.loadJsWithImg(a,function(e){if(e)throw e;i(t)})})}}function r(){this.removeEventListener("load",r,!1),n(cc.game.config)}var o=document.createElement("canvas"),s=document.createElement("canvas");cc.create3DContext=function(t,e){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,r=0;r<i.length;++r){try{n=t.getContext(i[r],e)}catch(t){}if(n)break}return n};var c=function(){cc.sys={};var t=cc.sys;t.LANGUAGE_ENGLISH="en",t.LANGUAGE_CHINESE="zh",t.LANGUAGE_FRENCH="fr",t.LANGUAGE_ITALIAN="it",t.LANGUAGE_GERMAN="de",t.LANGUAGE_SPANISH="es",t.LANGUAGE_DUTCH="du",t.LANGUAGE_RUSSIAN="ru",t.LANGUAGE_KOREAN="ko",t.LANGUAGE_JAPANESE="ja",t.LANGUAGE_HUNGARIAN="hu",t.LANGUAGE_PORTUGUESE="pt",t.LANGUAGE_ARABIC="ar",t.LANGUAGE_NORWEGIAN="no",t.LANGUAGE_POLISH="pl",t.LANGUAGE_UNKNOWN="unkonwn",t.OS_IOS="iOS",t.OS_ANDROID="Android",t.OS_WINDOWS="Windows",t.OS_MARMALADE="Marmalade",t.OS_LINUX="Linux",t.OS_BADA="Bada",t.OS_BLACKBERRY="Blackberry",t.OS_OSX="OS X",t.OS_WP8="WP8",t.OS_WINRT="WINRT",t.OS_UNKNOWN="Unknown",t.UNKNOWN=-1,t.WIN32=0,t.LINUX=1,t.MACOS=2,t.ANDROID=3,t.IPHONE=4,t.IPAD=5,t.BLACKBERRY=6,t.NACL=7,t.EMSCRIPTEN=8,t.TIZEN=9,t.WINRT=10,t.WP8=11,t.MOBILE_BROWSER=100,t.DESKTOP_BROWSER=101,t.BROWSER_TYPE_WECHAT="wechat",t.BROWSER_TYPE_ANDROID="androidbrowser",t.BROWSER_TYPE_IE="ie",t.BROWSER_TYPE_QQ="qqbrowser",t.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",t.BROWSER_TYPE_UC="ucbrowser",t.BROWSER_TYPE_360="360browser",t.BROWSER_TYPE_BAIDU_APP="baiduboxapp",t.BROWSER_TYPE_BAIDU="baidubrowser",t.BROWSER_TYPE_MAXTHON="maxthon",t.BROWSER_TYPE_OPERA="opera",t.BROWSER_TYPE_OUPENG="oupeng",t.BROWSER_TYPE_MIUI="miuibrowser",t.BROWSER_TYPE_FIREFOX="firefox",t.BROWSER_TYPE_SAFARI="safari",t.BROWSER_TYPE_CHROME="chrome",t.BROWSER_TYPE_LIEBAO="liebao",t.BROWSER_TYPE_QZONE="qzone",t.BROWSER_TYPE_SOUGOU="sogou",t.BROWSER_TYPE_UNKNOWN="unknown",t.isNative=!1;var e=window,i=e.navigator,n=document,r=n.documentElement,c=i.userAgent.toLowerCase();t.isMobile=c.indexOf("mobile")!==-1||c.indexOf("android")!==-1,t.platform=t.isMobile?t.MOBILE_BROWSER:t.DESKTOP_BROWSER;var a=i.language;a=a?a:i.browserLanguage,a=a?a.split("-")[0]:t.LANGUAGE_ENGLISH,t.language=a;var l=!1,h=!1,u="",d=0,_=/android (\d+(?:\.\d+)+)/i.exec(c)||/android (\d+(?:\.\d+)+)/i.exec(i.platform);_&&(l=!0,u=_[1]||"",d=parseInt(u)||0),_=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(c),_&&(h=!0,u=_[2]||"",d=parseInt(u)||0);var p=t.OS_UNKNOWN;i.appVersion.indexOf("Win")!==-1?p=t.OS_WINDOWS:h?p=t.OS_IOS:i.appVersion.indexOf("Mac")!==-1?p=t.OS_OSX:i.appVersion.indexOf("X11")!==-1&&i.appVersion.indexOf("Linux")===-1?p=t.OS_UNIX:l?p=t.OS_ANDROID:i.appVersion.indexOf("Linux")!==-1&&(p=t.OS_LINUX),t.os=p,t.osVersion=u,t.osMainVersion=d,t.browserType=t.BROWSER_TYPE_UNKNOWN,function(){var e=/mqqbrowser|sogou|qzone|liebao|micromessenger|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|trident|miuibrowser/i,i=/qqbrowser|chrome|safari|firefox|opr|oupeng|opera/i,n=e.exec(c);n||(n=i.exec(c));var r=n?n[0]:t.BROWSER_TYPE_UNKNOWN;"micromessenger"===r?r=t.BROWSER_TYPE_WECHAT:"safari"===r&&c.match(/android.*applewebkit/)?r=t.BROWSER_TYPE_ANDROID:"trident"===r?r=t.BROWSER_TYPE_IE:"360 aphone"===r?r=t.BROWSER_TYPE_360:"mxbrowser"===r?r=t.BROWSER_TYPE_MAXTHON:"opr"===r&&(r=t.BROWSER_TYPE_OPERA),t.browserType=r}(),t.browserVersion="",function(){var e=/(micromessenger|qq|mx|maxthon|baidu|sogou)(mobile)?(browser)?\/?([\d.]+)/i,i=/(msie |rv:|firefox|chrome|ucbrowser|oupeng|opera|opr|safari|miui)(mobile)?(browser)?\/?([\d.]+)/i,n=c.match(e);n||(n=c.match(i)),t.browserVersion=n?n[4]:""}();var f=window.innerWidth||document.documentElement.clientWidth,m=window.innerHeight||document.documentElement.clientHeight,g=window.devicePixelRatio||1;if(t.windowPixelResolution={width:g*f,height:g*m},t._checkWebGLRenderMode=function(){if(cc._renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")},t._supportCanvasNewBlendModes=function(){var t=o;t.width=1,t.height=1;var e=t.getContext("2d");e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply";var i=s;i.width=1,i.height=1;var n=i.getContext("2d");return n.fillStyle="#fff",n.fillRect(0,0,1,1),e.drawImage(i,0,0,1,1),0===e.getImageData(0,0,1,1).data[0]}(),cc.sys.isMobile){var y=document.createElement("style");y.type="text/css",document.body.appendChild(y),y.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}"}try{var v=t.localStorage=e.localStorage;v.setItem("storage",""),v.removeItem("storage"),v=null}catch(e){var T=function(){cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")};t.localStorage={getItem:T,setItem:T,removeItem:T,clear:T}}var C=!!o.getContext("2d"),S=!1;if(e.WebGLRenderingContext){var x=document.createElement("CANVAS");try{var A=cc.create3DContext(x,{stencil:!0});if(A&&(S=!0),S&&t.os===t.OS_ANDROID){var E=parseFloat(t.browserVersion);switch(t.browserType){case t.BROWSER_TYPE_MOBILE_QQ:case t.BROWSER_TYPE_BAIDU:case t.BROWSER_TYPE_BAIDU_APP:S=E>=6.2;break;case t.BROWSER_TYPE_CHROME:S=E>=30;break;case t.BROWSER_TYPE_ANDROID:t.osMainVersion&&t.osMainVersion>=5&&(S=!0);break;case t.BROWSER_TYPE_UNKNOWN:case t.BROWSER_TYPE_360:case t.BROWSER_TYPE_MIUI:case t.BROWSER_TYPE_UC:S=!1}}}catch(t){}x=null}var b=t.capabilities={canvas:C,opengl:S};(void 0!==r.ontouchstart||void 0!==n.ontouchstart||i.msPointerEnabled)&&(b.touches=!0),void 0!==r.onmouseup&&(b.mouse=!0),void 0!==r.onkeyup&&(b.keyboard=!0),(e.DeviceMotionEvent||e.DeviceOrientationEvent)&&(b.accelerometer=!0),t.garbageCollect=function(){},t.dumpRoot=function(){},t.restartVM=function(){},t.cleanScript=function(t){},t.isObjectValid=function(t){return!!t},t.dump=function(){var t=this,e="";e+="isMobile : "+t.isMobile+"\r\n",e+="language : "+t.language+"\r\n",e+="browserType : "+t.browserType+"\r\n",e+="browserVersion : "+t.browserVersion+"\r\n",e+="capabilities : "+JSON.stringify(t.capabilities)+"\r\n",e+="os : "+t.os+"\r\n",e+="osVersion : "+t.osVersion+"\r\n",e+="platform : "+t.platform+"\r\n",e+="Using "+(cc._renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(e)},t.openURL=function(t){window.open(t)}};c(),o=null,s=null,cc.log=cc.warn=cc.error=cc.assert=function(){};var a={},l=!1,h=null;cc._engineLoaded=!1,cc.initEngine=function(e,i){if(l){var o=h;return void(h=function(){o&&o(),i&&i()})}h=i,!cc.game.config&&e?cc.game.config=e:cc.game.config||cc.game._loadConfig(),e=cc.game.config,t(e),document.body?n(e):cc._addEventListener(window,"load",r,!1),l=!0}}(),cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESIZE:"game_on_resize",EVENT_RENDERER_INITED:"renderer_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_eventHide:null,_eventShow:null,CONFIG_KEY:{width:"width",height:"height",engineDir:"engineDir",modules:"modules",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList"},_paused:!0,_prepareCalled:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,frame:null,container:null,canvas:null,config:null,onStart:null,onStop:null,setFrameRate:function(t){var e=this,i=e.config,n=e.CONFIG_KEY;i[n.frameRate]=t,e._intervalId&&window.cancelAnimationFrame(e._intervalId),e._paused=!0,e._setAnimFrame(),e._runMainLoop()},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&(cc.audioEngine.stopAllEffects(),cc.audioEngine.pauseMusic()),this._intervalId&&window.cancelAnimationFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,cc.audioEngine&&cc.audioEngine.resumeMusic(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.popToSceneStackLevel(0),cc.audioEngine&&cc.audioEngine.end(),cc.game.onStart()},end:function(){close()},prepare:function(t){var e=this,i=e.config,n=e.CONFIG_KEY;if(this._loadConfig(),this._prepared)return void(t&&t());if(!this._prepareCalled){if(cc._engineLoaded){this._prepareCalled=!0,this._initRenderer(i[n.width],i[n.height]),cc.view=cc.EGLView._getInstance(),cc.director=cc.Director._getInstance(),cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view),cc.winSize=cc.director.getWinSize(),this._initEvents(),this._setAnimFrame(),this._runMainLoop();var r=i[n.jsList];return void(r?cc.loader.loadJsWithImg(r,function(i){if(i)throw new Error(i);e._prepared=!0,t&&t()}):t&&t())}cc.initEngine(this.config,function(){e.prepare(t)})}},run:function(t,e){"function"==typeof t?cc.game.onStart=t:(t&&("string"==typeof t?(cc.game.config||this._loadConfig(),cc.game.config[cc.game.CONFIG_KEY.id]=t):cc.game.config=t),"function"==typeof e&&(cc.game.onStart=e)),this.prepare(cc.game.onStart&&cc.game.onStart.bind(cc.game))},_setAnimFrame:function(){this._lastTime=new Date,this._frameTime=1e3/cc.game.config[cc.game.CONFIG_KEY.frameRate],cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT||60!==cc.game.config[cc.game.CONFIG_KEY.frameRate]?(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(t){var e=(new Date).getTime(),i=Math.max(0,cc.game._frameTime-(e-cc.game._lastTime)),n=window.setTimeout(function(){t()},i);return cc.game._lastTime=e+i,n},_ctTime:function(t){window.clearTimeout(t)},_runMainLoop:function(){var t,e=this,i=e.config,n=e.CONFIG_KEY,r=cc.director;r.setDisplayStats(i[n.showFPS]),t=function(){e._paused||(r.mainLoop(),e._intervalId&&window.cancelAnimationFrame(e._intervalId),e._intervalId=window.requestAnimFrame(t))},window.requestAnimFrame(t),e._paused=!1},_loadConfig:function(){if(this.config)return void this._initConfig(this.config);if(document.ccConfig)this._initConfig(document.ccConfig);else{var t={};try{for(var e=document.getElementsByTagName("script"),i=0;i<e.length;i++){var n=e[i].getAttribute("cocos");if(""===n||n)break}var r,o,s;i<e.length&&(r=e[i].src,r&&(s=/(.*)\//.exec(r)[0],cc.loader.resPath=s,r=cc.path.join(s,"project.json")),o=cc.loader._loadTxtSync(r)),o||(o=cc.loader._loadTxtSync("project.json")),t=JSON.parse(o)}catch(t){cc.log("Failed to read or parse project.json")}this._initConfig(t)}},_initConfig:function(t){var e=this.CONFIG_KEY,i=t[e.modules];t[e.showFPS]="undefined"==typeof t[e.showFPS]||t[e.showFPS],t[e.engineDir]=t[e.engineDir]||"frameworks/cocos2d-html5",null==t[e.debugMode]&&(t[e.debugMode]=0),t[e.frameRate]=t[e.frameRate]||60,null==t[e.renderMode]&&(t[e.renderMode]=0),null==t[e.registerSystemEvent]&&(t[e.registerSystemEvent]=!0),i&&i.indexOf("core")<0&&i.splice(0,0,"core"),i&&(t[e.modules]=i),this.config=t},_initRenderer:function(t,e){if(!this._rendererInitialized){if(!cc._supportRender)throw new Error("The renderer doesn't support the renderMode "+this.config[this.CONFIG_KEY.renderMode]);var i,n,r=this.config[cc.game.CONFIG_KEY.id],o=window,s=cc.$(r)||cc.$("#"+r);"CANVAS"===s.tagName?(t=t||s.width,e=e||s.height,this.canvas=cc._canvas=i=s,this.container=cc.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==s.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),t=t||s.clientWidth,e=e||s.clientHeight,this.canvas=cc._canvas=i=document.createElement("CANVAS"),this.container=cc.container=n=document.createElement("DIV"),s.appendChild(n)),n.setAttribute("id","Cocos2dGameContainer"),n.appendChild(i),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,i.addClass("gameCanvas"),i.setAttribute("width",t||480),i.setAttribute("height",e||320),i.setAttribute("tabindex",99),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._renderContext=cc._renderContext=cc.webglContext=cc.create3DContext(i,{stencil:!0,antialias:!cc.sys.isMobile,alpha:!1})),this._renderContext?(cc.renderer=cc.rendererWebGL,o.gl=this._renderContext,cc.renderer.init(),cc.shaderCache._init(),cc._drawingUtil=new cc.DrawingPrimitiveWebGL(this._renderContext),cc.textureCache._initializingRenderer(),cc.glExt={},cc.glExt.instanced_arrays=o.gl.getExtension("ANGLE_instanced_arrays"),cc.glExt.element_uint=o.gl.getExtension("OES_element_index_uint")):(cc._renderType=cc.game.RENDER_TYPE_CANVAS,cc.renderer=cc.rendererCanvas,this._renderContext=cc._renderContext=new cc.CanvasContextWrapper(i.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(this._renderContext):null),cc._gameDiv=n,cc.game.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this.dispatchEvent(this.EVENT_RENDERER_INITED,!0),this._rendererInitialized=!0}},_initEvents:function(){var t,e,i=window;this._eventHide=this._eventHide||new cc.EventCustom(this.EVENT_HIDE),this._eventHide.setUserData(this),this._eventShow=this._eventShow||new cc.EventCustom(this.EVENT_SHOW),this._eventShow.setUserData(this),this.config[this.CONFIG_KEY.registerSystemEvent]&&cc.inputManager.registerSystemEvent(this.canvas),cc.isUndefined(document.hidden)?cc.isUndefined(document.mozHidden)?cc.isUndefined(document.msHidden)?cc.isUndefined(document.webkitHidden)||(t="webkitHidden",e="webkitvisibilitychange"):(t="msHidden",e="msvisibilitychange"):(t="mozHidden",e="mozvisibilitychange"):(t="hidden",e="visibilitychange");var n=function(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)},r=function(){cc.eventManager&&cc.game._eventShow&&cc.eventManager.dispatchEvent(cc.game._eventShow)};t?document.addEventListener(e,function(){document[t]?n():r()},!1):(i.addEventListener("blur",n,!1),i.addEventListener("focus",r,!1)),navigator.userAgent.indexOf("MicroMessenger")>-1&&(i.onfocus=function(){r()}),"onpageshow"in window&&"onpagehide"in window&&(i.addEventListener("pagehide",n,!1),i.addEventListener("pageshow",r,!1)),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.game.pause()}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.game.resume()})}},Function.prototype.bind=Function.prototype.bind||function(t){if(!cc.isFunction(this))throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},r=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,r.prototype=new n,r},cc._urlRegExp=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))|(?:localhost))(?::\\d{2,5})?(?:/\\S*)?$","i"),cc.SimplePool=function(){this._pool=[]},cc.SimplePool.prototype={constructor:cc.SimplePool,size:function(){return this._pool.length},put:function(t){t&&this._pool.indexOf(t)===-1&&this._pool.unshift(t)},get:function(){var t=this._pool.length-1;if(t<0)return null;var e=this._pool[t];return this._pool.length=t,e},find:function(t,e){var i,n,r,o=this._pool,s=o.length-1;for(n=o.length;n>=0;--n)if(r=o[n],i=t(n,r))return o[n]=o[s],o.length=s,r;if(e){var c=e();if(c>=0)return o[c]=o[s],o.length=s,r}return null}},cc.EventHelper=function(){},cc.EventHelper.prototype={constructor:cc.EventHelper,apply:function(t){t.addEventListener=cc.EventHelper.prototype.addEventListener,t.hasEventListener=cc.EventHelper.prototype.hasEventListener,t.removeEventListener=cc.EventHelper.prototype.removeEventListener,t.dispatchEvent=cc.EventHelper.prototype.dispatchEvent},addEventListener:function(t,e,i){if("load"===t&&this._textureLoaded)return void setTimeout(function(){e.call(i)},0);void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),this.hasEventListener(t,e,i)||n[t].push({callback:e,eventTarget:i})},hasEventListener:function(t,e,i){if(void 0===this._listeners)return!1;var n=this._listeners;if(void 0!==n[t])for(var r=0,o=n.length;r<o;r++){var s=n[r];if(s.callback===e&&s.eventTarget===i)return!0}return!1},removeEventListener:function(t,e,i){if(void 0!==this._listeners){var n=this._listeners,r=n[t];if(void 0!==r)for(var o=0;o<r.length;){var s=r[o];s.eventTarget===i&&s.callback===e?r.splice(o,1):o++}}},removeEventTarget:function(t,e,i){if(void 0!==this._listeners){var n=this._listeners,r=n[t];if(void 0!==r)for(var o=0;o<r.length;){var s=r[o];s.eventTarget===i?r.splice(o,1):o++}}},dispatchEvent:function(t,e){if(void 0!==this._listeners){null==e&&(e=!0);var i=this._listeners,n=i[t];if(void 0!==n){for(var r=[],o=n.length,s=0;s<o;s++)r[s]=n[s];for(s=0;s<o;s++)r[s].callback.call(r[s].eventTarget,this);e&&(n.length=0)}}}},cc.EventHelper.prototype.apply(cc.game);var cc=cc||{};if(cc._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7",cc._fpsImage="data:image/png;base64,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",cc._loaderImage="data:image/png;base64,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itb4P4XNmG/p5/lugO2xYfbr7Jv0vXw3GI0V+T6a/T/HkPRVliXLO6vvEo+irfyPL/Ft9rWeTn8v6ONJjrXZ92bzUdaD/Hp7yPE802TM6TbpZJlu+Tvor9rK/6WyUb4Dlm37e3v3Ne0k/cD7BGnRpnjmFP9nPMYk8iLNXr4lPer8r5RSSimlnlOX2ufNdO9lL/nWlOsgl7BhfRvNvmv699RftfZ5tT+sOdSayWzNeo3S/31tI7/zR9/8S2shrJv082soyznqR/zjMbu/lN7oepbXLK1RvybubM1pVua/iv2y3PsjX9Y88pz2wjO5zp5tJPdeOWcNl3s5JrB3sya82zrLmeuJdY/1Ztaa+rpShfc61r1MK21Xx/QZkFdeox6nxHol90mXve6lMp+j7pdsb6P+z1obtmY/vms09le83Mct6COs860JP1Yv7JdjXv+3IfchEHsZdcy1yrRVptnzGtm3/xNBnNH9kf9HZT5Hff4/xf8Zf/b+kHbinL0Zjvgz/8lYE35qvfqcl3sC+HpUp/RBt09ez/LKsNE+E/ezP3OdeY/KfK628H/fRymfUKY8LzHWMX4yltGe14afUi/CGDf4jwAb074Qc233fx9zco/ymP/5fyLzKPX73f+zMp+rY/7PuR079H6SdS318Sl9g7+Iyzy2Vfgxu2cYtuT9OudhxnDiYue0NXud+DP3KI+Vg39r8SFtJ23KntnI/6Myn/MuyH5b1il9R9/OumKP0VhF3Eyv59f92fvBmnDCluqVYdSDuaT7N+fy0TcYz/fnRnn1MNpA34tMGxM/856Vufe1S2hpvUA9vvS/UkoppZRSSimllFJKXU07EREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREZE75B+Hl45q2TuOnAAAAVNta0JU+s7K/gB/pYUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHic7dbhaYNgFIZRB3ERB3EQF3EQB3ERB7G8gQu3piH/ignngUObT/vrTWzOU5IkSZIkSZIkSZIkSZIkSZIkSR/RcRznvu9P5znLtXf3v7pP929d13Mcx3OapsfP7Bj9LPfUvXUWy7I8XscwDH++h3TvsmOVfbNhdq3N+z21f9U3v/6N7l+263tWOeuf5XqdffvG2b+6XtP9y3O+71//1+d5fto/1+z/fWXbeu7X79u2/frM9+e//b+v+h7X96v3QK7Vd/ucRdWfHddrkiRJkiRJkiRJ+vcGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4QD8K+ay4UtoqZgAAEXJta0JU+s7K/gB/q9EAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHic7Vyts6y4037/NiQSGYuMjMQikZGxkcjIyNhIJBKLHMmb/ghwbm0Vkplf9bO1u/ceZk7xdDqd/sxgtBmM6buuW47jiEYBxvLnrUG4A7AYowv6Oc150q2Z3dh1bUEoDyd82APKd+kLBZ8wDMP/fTlinstbml518N7rQByUXo5A/PUGXGKREZOEx531kyoia7tUHiZ4VOmreJzY4vI2vyeUtyzLZLRyn/JHSzwKi+k4ehLAhEzG8iFzkRyWgHJQsP6zuQTTdf64421+T4B3XGfdjfCHrC89Xo5cBQAbI4MALv5qSEVnVD8suP7wLaaPGlGwJ599+rzN7wkZ3tU2DazjETQBWM5F6Yl/O/h123Ow9REKwNmuHcreyD7a8RJMpxaknyb86/g2vyfodGyFfjN+6kZmlnZejwHomwGVfEkDPsE1Lsx61Qx7+bmHL1/bv+tw/2c0JMVAvM3vCa2eNK6y/8BGNoYNfVnIPs6w+oWUPU7hqGL1mwYEYOOOJ4P1br4LoM+zJVMJn32b3xM6ZQdS8zE4awxLAPa26mFt20ILN0mAB7imRQLlqV9R0bM7vA2n4ei7cmRMqicBqO5tfk9Q/fwhAQx2hAObBFDIF8CDrjBBk5bhQY82rm27vvcolcNPzhYZmmo6usbuq9WsAeptfk+AxU2NCvMn6XwsE0mgvDq8vmtQADMSDfQA93hbxDOGFBMbSXMJrjPkLtE26t/m94Ti0hUTZkMOMRfLvTrir/H9R9oZZkbjyB4ACqDw18brYusWBZsEBIBfVHj+hdOQvM3vCbqsemxNoTWio3esaUvo7RXH2DQMeLSeHgAcbH3fNsYWzVgm+IAaSAC6t2T+WR2+n7/9fCK5feHy2tapvP9gK/0mHdVPZE+v/OuyB43JqpwHxR0eUQCWhPhxrA/mbX5PGJbPVrYrqOpyc1ujm9OeKv12ctGF5KoH2J/Syt7pFoKkEJa4prV+Hw3J8AP8lyu6uQUux2ZWcm2QvsJQz1hLhhGUYEhg/5Mpj8BFdnfh4S/wpA9v83sC+eoeXvVze/19K84NuD+NdRrZFzF0Iyy8xnMQI904lPOgRRN5fXkJiwfXaEtLyPvb/J5w4It/8uoDL+FaYnzcxbMqrl3j5q67BKCL5Z9my1ZgwAMfBHAGfWnEJ6Yq09v8npCr1Vs0+TMY14HH84Ft7ZuRPP4WMezb+ikfrYGQRo+wCKDSDSSZKwx+m98TuoGXfVvwD9uABPR27LCtLfr/pwAwR1RO9zNKHPDIbzlLdCR9Ov5tEYlzX3/+Far+dvAdkY+4cOZ/zsAe+ONHV/ZtdI9+n1Z1/T8T/VjBbunT0HRf7//dUlbJF5ueOM1lA2c/PMf75PYvtEWqd2fpmGu1W5ZiNmZOkik0Fz3EDm/zewJqMez83SHRQVP8x3a92P8zswHpvkCHYw0T10/ecjYlGkTHWNfgEWPEIgHz9fxxGcG9c8yzcujVUBy8Wfv+yu10imykNeTsU2AUyeLBp2rwyJvFfb//U9zcAPQtRXxwdBVuAyQ0LCj7x5ubAPiYTxadu5lPjvJVWHzd66GuPwhAF536+vx3DnjW++rXFZM+uck0Y3TsEE+33H495j455FhdPjb68F8KgXizGEiAv83vCZyt9eX1OWJvOeu/LOTNb1facz7WfLr4l8MHwTIlfKCUwmrUqfKr89fz5xUdgT8Z7+6q+lSXjgQAPl31ku6YWmW4OEAKQD5AOLacvt7+MZ1Ibj28O65//MPQdmqwuFEW77e/7HeM/xtFZ0Zf416wjV7N6W1+TzgXWfOZppp/1/9YIRGgXczHqgtTlsAefXTRqhokltOxLZGyRQlMWBdSy9f7vydJ3+PC8bF/X/+95kHAHcZgzxXi/kwO/UHYUsgh7dm7GeoGb/N7wkVz6PpOdUzjvv6UBsB8j1P/SfqGkQPhiYPit/k94aI532noy8xvWB8xdNqt/73qjS3OMymH/5y/DELAt/k94eKf/xCa9tP44epXs7/+pwZwhpw0ILhANjH+Cv+YwFx590cDBrQBG62qPT9VjUF7FxYLhwRw7hT3I/xjObriceX7CjkMX4Zi54ry2xyW7fyULb6dyfMygqlQwQfFxWMWQNu7eaWd8ivrnzAE+rgz390qKnMiKjn6FLZIgC3Y81h03WfgfCU/fYfZE/Qq519Y/+gTlD3LGw+XPisKYf/oNtT/IEUMCQLiO2NGyJqmlkKPgzLpRQToIjg/f33/S4fdPrYscuXfdoMvblCN4WEpt2WOa5gXtAjLRvRDz0nBEuucuXNOn0D7TIkLi0v0Nr8nIH+lpu2o1Q7jl8SF3prZXfpLqytWTfypHaJnDdg4e4DNVKBEb/N7AvNX48ZuDqzkPg0UxXJmN5oeoxskuVJcGLFnri0uE1TD+hnz5mvm8rFFBVHqB/hzfs9v6jrJlwkrvR3v/8gxHdaBF53WsAR/tsJg5iRGzIHMXEAHEXlQobf5PQEXD3N3G/p27PjuOdl58GATjrOc32cwa1ucag8URPk9ZT6wNFb2SAABjLBTdg3ieZvfE3D58dCK4Nu1xe05Pb/jgNYQd3U/cq7o7PbDQjj2CpjaHBb2tCb8DREThm/ze4Licjbs4EiMzC34S2gAsPTfs5FbaxG861AIYPGGlDnvcaVHNFjHn+Dfo3VLAXqeEPPlz9COSCOUOSwfcbo2wsFXHcS7azERrCL1m45Khm/zewJ2suCCTtT0pP708Mam6W2Y9yUk65fziKMihynMq+tXVARbRqontHGj2Nv8ntDiDsbc7a271WzHBzbxNlAD4KUQ0AdES606ffcHQEXMcArOc8XobX5P4OWn7GdPPXsFk1VhW8JAwYC6Vwh37pBS1DN8YptDyCmxAbDcKPY2vyco4q71RBlcXraWit8AsHJDgJRX3RPc6dTqP7nwZT72EiRyLdFyp9jb/J5Q0542cnNbpX9m+5oaCUE+fy7/bCSAERrjXHCJTEA2Nu+fTOu/lvj4N/ofOV9t13A194EASmTr/0n1uGWi0YClnPFx5XjBQliwzEY1dyMBDfPYLPQ2vydg3944b2DWrib+Fqs3nOyzyzpDSscato9k5DlbYuay4pAEmY6/2OLi3fQ2vyfkuFHX2jZdzY3g1Q9HTfYVBwBzmn+GQ658IWwCU7bI5BJqfvTLclbJvr//6VLYWw87eMW5rrFdyukf9pragE/AsxXaHmvKkMJgu9FUiL16Cd/m9wQ01hkj+3iNd/AACK/xBPt+dLWyV/6CWz20Q+JN0PH3RtpDet5+iH8q74wCcFd3KzeFUE1goI6YczKia8En3rJW2CJr/ci1c/SlTvn8BP+yUjD1hKfWXPUfWdT1bzuq6VqqbSvMeTlIAI14MNr98OdwHPvSIM7FR22+vv6thjXV3tfM3i+RgPYPh7lwYu64v52yXu7YsSyKp95aa8fQAQP/m8EfgFLi1/s/nfJl/5PTtnBrM/nDRSfI/tsVqNvVY7NfnX9aSDvG6JN3XPNG/jA8sJbIgbrA3ub3hK6npTfjEIeOyFP9fl35/HfQHpvghIQkAJ2OGBLB+g+4X+r0Q9/BlyEKitwF9Ta/J6jeI/22o8S/4VEWkAqPf1wVgMGcx2Mxjx/4AifPWAAKesW1w98I+cBfiH8cNjGQz99A+wIoMCrF/A9/V9xCthBgHiE27tkloPmXYUw+DahR7E5//f634x8fPx9LhI5PSvVTAHDG9A1Ow7EAJhwO66tPZOMSA/Y8F7ufYlogY/QD80+17NHRIANYc3D0yH+jAdgxZmhuXVEdaoqIGiXas2sOgqCqKDmU8wTzId9//tXuDtitLel62eYmfcp6fmaO8Cach8SifksC6NoqNbIGyoSpmUPEREmCUUKYfgjr1/s/tP4de3ZtA45QXvJmNbi8DZa4Pc9yojCSt3RJQIu+UTEbMAyJfxt1j5kiFGn4Df8PG3Wa6ezb5rGFCJS7jnZE0CdhYBXYTW4x6sEsN06KNhAggrFIHDX+Av8N1njKZ98272GwAWcnZO5rORwy4Nt5EQQQJ38goKcI/lFacz79wh/gD8o67HE4+9ap8ScZLO82WP+NunYDYBvMOdva0fGnigsJ0yKNietSxLMcs9PtGEJ27uv7H52FLbvxaCtoPCQ+YJKDBpvAIu6mNgO0Ge4Iqc6+7mhMFmYBizOkMOmxbyWiMlxI6b++/7uhoz5y9gs4o+XyHZX/8W+D4rCnMTwHTOPBLWVP4RqIg5QDsVP1HMpJX+//VTsd2MYXjqAA29kNA/tfXyMwqTyqLb4ex37NAKnC6cY/mjON8PX8z8FFsuoQs1Gv38adjivbf3L04ZacwLPOodg8F3Isq5/gcGjPUbp6H47WX8//Glzk2QVo5pkXqOsF7OPLPOCgr8xGRP4B4l9qd12xFabpHF75AhYSzYPWw9fnf0/nfhvqDT8U5A31HptlHTgkBlIory0t3vusGx78nNk84B4xceEhgHne/dv8nuAy128OuvziyoHWot+qOnMOfHEP1Gc27AHT1Sh1PI7EMOIcEAjw8/X8YzonOrCspW8CYA1w08TXGRg9YWJ3m2jEsQC/Hc+6Gf1Ur8Us4Gno3ub3BOPttQXSZs/JVqh68mUGx2rr/R4TtHfvU99Vqg00hewDl034p+osjM5v83tCp9R4G3x32twkcEnGD3W0a1qPub+oNg3edzJySww3RNYv7l8f/8MpTUO9WLMa9K3KoW5TEBtdkgFT/+vQ/9F2MIEfuvIIt8GtXyB8ff5HcaXjWDDn4eoU2K0NJkecjz2l4msWmCXQo/gGDiHQ7aFR8pzT19e/+9qztK24/r029Ta3rqP1z2Tjql6oyfBC8yZoySfgswMzoqRROttf4G9vDX+a5iC5DwBofHbn4RNrnXnv/fBnJp5yBvXM78/a2bGvi/l6/l033gb6Qnve3AVpbkgNOyx+7meDm+6nwfwVAN2hd6ueDvX3TV/v/3LHMyFNeJMft3eShzNiXDxjDyxJwJ+dEiSBbqZdcvWPnY3i4evrP97ZsIIGpBhmVTw3VUMdngTE7GY7upkLI3pep+HWKVH4kwM1neuPy58X6Bf6/vtvvDs8DDRa1ZfFHkOxZCQA7fj6M1hsqOzAAWjgLrA43FtFahtc/uM2ZJwW8l/v//VmpD4vOsrQFVpCHvvWHSsIwEBxf9pX0zjfO/RqP95cTnLXc/wQT88JzCZ0Ccc8fH3/0znmhLp+nQQL1L89DP7tccH9PJmUmerur7twTW11ybqOkON9qUVHhp/o/1enBNrpdotVpAZASurkFV2g8+En8o2Xxp/Oc1IcJlNKIWcYE/h6/5cuKyL+Jbr9hByY0XAV/5ZC9s/wDwxIhOTi1e2+J6cVDtHPkdRkxe3wNr8n4OnGweyUggX/jozAWNN/tJn/veAMGn6vn0WKAPvRL+wvsj14m98T+KpTPOsjX18VyACc6V+sCPqw0PhHiPXm01oZjmE8O8c9DEihXNBh+Hr+6MpRrcOs0LVQZzh2f1Y8CpfVQVYM24TmWtvy/P+o++s4uFrF40/cfwiTfuX1Ie+b6I7Xc4bjfiRsA1KEy9A/bTPSjxq6Oyzr/pY1MtWdXtFfepvfEyCpgY07HbqxDv5q0dbtZ/77uKI/vO6+g5zPCj2vOBJzpodJANcw9PAD998LBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUDwv4D/BzR/CDSC1LItAAAB7G1rQlT6zsr+AH+7AwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJzt2L1qFGEUgGEvQPAvRQKyxp/C2s47Ee/BKpgm1noBWidkzYqN4EXYWGijkDRBUMEyoDO6uzPzHWdQcKZIrCZDdp8DD9seeJmdb77IX9yMk92KfLwW+cvbUR4dRGs2opqfq385u/7f/vnVyPZGUX57024/SdovgpP7712LbHc15p9et9vvRyoulz++Dr07ffafrEe2cyVmH56123+JSKNInv0FcUz/G5FtX4rpu8ft9lnd/k5Us6F3ps/+k+t1+wsxfbsVnUnVvVTkQ+9Ln/2b//zti3X7R530dfsH2i+kf+f85qy3sxKz90+iM6l6GOXPofekt/5/vvHy8Wp91nsanUnVViqnQ+9In/3Ha5FNRjE/fBWdSdVmFL+G3o+++zf3et27He/75RHV0X605nsd/34qsqH34pT6t6a527nr+36p/J30MVK5Hs56y6aZcarm58v889C7cPo2IxVD7wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnG2/AYwmeZSgBIFxAAAPxW1rQlT6zsr+AH/iCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJztmgl0VfW1xsMgEEIkQCaGBDIAYZBRApgBsGIFFEVARhFEAgTClDDX51pKodJqS6U8+7QgGEYLQqUg70m7pDggBQIkJHATMjHdJAwmdx7O9/Y+l0hu7k3EkORi1z5r/Vame8895/v2fw//Ey8AXg9AMuwWVDxst7Og3xUF/ba20O+IJCIeKgw7I4ADnbFhdmsENGmMg3374HJcPM4+8QTO3SU3Lg5rIyPRu7UvNLNn4vuly1C8ZEmNuJmSgrLkRRgT3g4v+PvjUmws0it8FlM4ZAjWR0SizaMNcGxtO+DTzvWlx4N4X852pXIMXD8OXWoo9B93eOhigLU98dv2CG7VEBu6dEV+fLyTF+eJbPJ/fEAAJkd1QllKMm4mp9TYf8a0chV2jHoSHSnePu/XHxcpBpw+MyYGBUPi8Vpwe3Tt1AiFH4TC/km96FYb/re2lV3JhGJ1igFL7n7otgZDn9rR456XY9lNmu4MR2yvRzAxMJjWfRzSSfuKXmTSz98NGoQ+zb2xYegTMK5YQR4mP5D/tyl/XJ2XgH7+vkgJ7ah+7rlKOeBCTCyyYp/AgOaPYuKT3rB9EgHTrjqPgdrwnwmFYikEFKcYMJ/fCN2WNtBv7+Rx7w07HHl/7XQ/RHo3w4mB0ciKiXXxIZvW5p5evRHl0wzHJ41D2fIVD+S9g2RYVq7AqoG90denOc4MZr+d447rTw7FxRf9+yOoySP4IKkNsO9n4z/TH3azrnIMmE6thW5zK/qscI/6r+ztjMyNIWgf0AAbunZFXly8i/dq7ad68HpYGGID/XAlMYHW7tJa8H8JDCtW4uupL6GDd2Ns6dETGjc5gLlCvcBbYZEIC24IzZ9CKA/UaQzUpv/MRMWqpxCwO8fAidUUAy0pD4R5xHvjTkfdnzrcG0+2bIVLcdyDxbhoz7WffXm+TWsk9IyArhZq/70+cCn1gYvxdGgQpgQFQUN55rwb/zMoL2TT9Q32aYmEES3UPoB71p+J/0yS+xj4FcWAn0dqAfZ1xtdvt0P7Rxvhk8d6q/2du7XHtf8k1f6+Pt7Y9Auq/csfvPaXU0RYV63CH5+MQZdmTXE8Olr9vMrXwHXg2pChONinDwK8G+HwG8Gw/7XOckBd+M8shc3oEgPm0+uoH/C/2xPWz1zAa8dKa+jFuKYY2dIf2qFDXWpvObz29/buQ7W/KY5NerGWav89+HwZM6chokUz/LFrlNs4zKP6czZmkNqfBrdshIOr29blLFBX/jOrFZvJNQbOvwf9tuB6mw1NuyiPbw9Hwi9bIKhxE7wVGU4+xyAn1rX+c+1fS3P4oEBf5CXOwp2Uamo/1YaSFOfaUJKcrP6+OLmKGkC1xLB0CcZGdsBYmi95DuTZ7+zdvH+Vav/ux6LQvqEXomgOPPf7ECg/r/pfmWWwuuYBS85eqgOh9bZHxHMUr6EtCwPRooUX+jVtjP29e6Iwfgjl4Ngf9n64/54SGISJXUJwJ3kR+eU+95eQx9cT5+Pa7ERHDCQvUb9qkxYgf/J0aBcsVF/j7r3WlavwwfBYdKMZ5MsBA3AhNkbNAxr6uqhdIIL9fPFY9254qpc3SlPDYd5dl/pE1rX/VfYDvEfE+4S6jwLqJQa4B7j4XgiiQpojZuAABPk2R2JwG/J9kLruy2vCIF8frIl9nGr/cvfeU0wULV6C3LFToRk1AVemJ6jeFy1chNxxU3HpmXEUAzPodfR6N/HDNeDCzJfR7VFvbOzaDSXDhuGfj/dFtHcTRISH4diu3cg8eAAhAb44vDoQSp3V/kjWvj78ZyYrVl1p5dnQfjsThkOjqCegvrCO50Ps74zfvdwC/aIiYTxzEkdTU9GrRzdENWmArd27QDtsKI4NiEbX5k2x74UR0FdR+0uWpqBg2mvk/UvIfnYCsikG2O/c8S/f/d1ENS6uvjpbfa3rHJBCc8USjKcaMC04GBu7hCGwkRfGPT8a2q+/Bgqvwnb+LOL698Oy0d6q/4Za1yNc1Zy0ry//mcGwm132iHjv2PTVQsdswHvGdZALuAfkHvrFAQ3wygujgYsXgfwCGNPSsDopCX605l9p44d3ukSiZ0sfpL06DaXLXNe/mvfnzEP2cxMd3vPX5xx+M+U/899yRk9SX1viJgdYaA748Kk4eDfwQtugALz/5ptAdg5wSQPl7DkgLw//lZiIuK4NcWtrGMy1tg8YqWrMWrPmpH19+s90gs2cDsWGynFgydqiXqPuI/9a99+6JxI3PuyEnh288P4br6ta21nnzCygoBAn932K+MGD0bhhAzzdIQDFi+ar69TJN8779DV3HK3zkePveV0Fl0aMR4FaB1z91y9fiVPTJiCQcs32d/8AXLsOpGfAnnbWcV05ufjH1s0IC2qGk2+3r7X+v1xb1vruUd/+My1s+oJtlZ8Z8WG7mUE5aWSt5wLsjcTxNcHoFOiNE3t20jrLVnVm1PV2ORfQaDCYeoApETSXUN525xvHwNVZc9X1ramw/iujGfmS2gsUUR/orge4RbF1a3EShocEYh3NGNDkQDl3/odrwoUslH73LfpEdca7r7RU94FrXgPurXnWljWucHjC/3KWqc+M1Fxw71BsZph5z/jjkFrLBbz394fpvujTJRy3vv0KyMj8QWtVb1p7lvR0xA7oi7cH9oVpRdVzP9f0awmJP+R9V+8p9z8/Gdr5C1zmw3skw7JiJVb064Hh1PcbT6fRNV24dz0UC8i9jBljx2JcdEOaARxzbE3XPGvJmrK2lcT2pP/MMMWiu+iYDZzrga0kDYbDzzn2jT9uX2Pv1ef91PtPi2uESc+OArKyVH2d/L94CZeOHEFEW38cfH4EDD+y71MxBrIr1X3+emPufLe9X0VM5P+hMaPQrUM7pB/4TL0Gp2vKy8eWtWvQM6QR8v47FLY9PzEXkmasHWvIWlYynjVn7T3tP9MGxpJtsFtdYkChuDBfeB/6Pb1rvHdsovn5zrYwRId7YV3yYsr1l9Wc76R1zmV8+v4mhPo0QcaMqdT7/fj/ezjFAPv+rCMWuD78mPfMnaXLUDCXnwn74YNfr1N7EsUpJjXQfP53RLRrg89WBKg17L7umTRStSLNWDul0txNqrLWrLmnfa/MRNhMea7XS3Oi7gpM3y5X/6dE9xE/T77/WZH7/nPvtkdk2yb437/8j1pr7ZX9v5xLc8A8xPu3QPGCeWp9vq893Yq1YMRLuDojgby/v+cF3F8Y6P2vdA7FzAkTKC/RTHI+vUJNugDbubMYFv04Vo9prvpf7XMg0oS1YY1YK9as0sHassae9rk6Am2mW1sUO9cp51zAh634NExfznL0M2pv8ONxwLl/z+LW6BIahLyj/6fqXNF75Vy6WhNG/WIoXiUvDFX1ftXlgVlzUDjtNbXXK6li79cdZqoBm4YMRPRjPVDy1TfU92U69wCUq5bNnImnejZEWWpVc2C4Qwv2nbRhjVwPhTVlbT3t7/1CRctwEnYbFwHXONCegPGfr6rPEO79f4n7/Mj+rxrjTeuoP6xn0xxzVsW1T7327RPfICo8BOsH9qm296tuLVe131sdOuozTk4Zh+6BrXB8+w51/q+clz7b+B6iOjRF5oYOFebASEee53snDVgL1sTVdoU1ZC097WdNaIwbafNhs1yrvHdcftiLz8B0fKGqh25L67vPE5x7P579xzzeAPMnT1L1den9qO5+uzMVAT6P4MDop9X/0/ipPtaUWzT7FS1IRGyAL95ZtdrRA1ScA7M0yP/iCOWuQHyypA3VgM7qPar3SvfM984auDlYM9aONfS0jw9KIMy319PscrvKOCjNhfnfa2DYH0vatIJuawDlwxD12Yl2cxj6dPTCptd/pfZ5Lr0f5dg1ixLh39AL52dMQZmbfb+6gvOGaflSzI3qiHEjRzn2o5x6AJrVM9Lxy8EDMWeIF+yprWE6EKfeK9+zm4M1Yq1YM0/7Vtt0tJtv/x528/dVxYFiNcBacJjy4XTod/eAktoS37zpi07+jfCvrVup98t29p7n/nNnEBfdC719G9PMPkf9X80ae7p48U9+j5mfBw4bjN5dI1DMPQDFgHp9aWehnElTe5PfLFmA+VOHwn7lEBU/g7tbZ03ehd3CGnnap7qGhro7b9K9XnW3b1B+2EvzgILd+PvvhmNQzwjkf37Ise/De6zl+6w0c+cc+htatWqOCeFBKKX50GXft479V3uAqeMQ4eeDox9tdfSn/z4NO9cBuj6luATm0u/d3iPdO+f5t0gL1sTTvtQ3raC/Pl9RnydY3faJfPDu4pX8PBivX4eSlw97+T47acz5YN+G9fDy8sJbA3tQLl7+k3r/GrNoEYoXLqRZcwFuJs7DjelTEePvi03rfgNoi6DcvAnFaKzCc7Zd4Xvme6dG4LqnfXgYeAZWw59Jk9vV5QT1sNuhlJUBRUVASQneWZ0CHx8fpD4TD8O8+dAmJKBo7lwUJSU5fCqH13Y51a3/ciq8l8/F5+Rza2fNQhF5X8Kx9sYbKN2+HYajR6H57huU6nRVXrbVar1js1r+rNgtfK+e1vthxU+x3Jqr2Iy7oFChpFgg3Wi5VB0PBoMBBYUFuHn6OxiPHEHZ3r34fvNm3Fy7FsX8v98M5wTyVPVx3jxHfMyZ4/CT44W+V3/Hf+O4Yf/5PXffz+fic/K5dYcPw5xOPd5tClWzucrrUg9FMVK87oXNlnQlP7/1l18c8rS+Pyf8YdUlZV7I+NBsNJZQIDhqRDWx4CS9xUI9RClslIutV6/CrNHAeOoUDMeOQU/rlX0s279fhb/n3/Hf+DX8Wn4Pv5fPwee6n8Nms3Gs8rV+CJt9AYwmGmT0ntbxP4EAaLX9YDZvgMm0g9aUVo0HrgUUD+72nOv8KI9Fq1Vr1+l2UC7YkHMxq9+VwkK+Vk/r9Z9OIK5f7243myemZ2T8pTBHswcWywnyoMyu19vV9Vpd0bj/w3EOCjA6J5+bP2MPfb/ZduPGRKK7/datQP3hw57WQwCaa2fPjjedPj3SptU+S8l4va24+BR5pLUVFRntd+7YqCdXFKtVobyh3I0PB/w9/Y7+xq/h1/J7+L2/pXPwuficfG7+DE/fpyAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiAIgiA8bPw/tEMXTOihUOQAACAASURBVHic7J13nF5F9f/fM7c8bXvP7qb3QjoJKUBCLyH0rxRBQBHEgqiIqF9ERARpCiigNAFBpCR0QiItlISSRhoppG6296ffe2d+f9zdzW6yoSYb+P78vF6bPHfmlrn3fu6ZOWfOOSO01vwXPlpWPWRmDTrmQG1EcoUZlih3nFbukULo/ggjH2HaCCFB7OEMGrRWaDeN9uq1FpuENBcgzSXajSvhxRpbNrz0XtbIc9wevbGvMMT/rwRUrVvyZLhXCeghoI/FsHPRlIIaBTITIeVevaBWClQryJUIduClG0G8CGKdildWycy+DXv1el8T/P9DwER1PnZOmdbqXIxAL6HVIQhZjti7PPvc0Aq02q6FfAMvVSmEfJB0UwWh4vr927Cewf9tArqxAoQ8HRkYC2o2GCV+77mnLrQTlINOt4BWaC8FThSdqEEn69BuDO20QLrZ39fORlhZCDOCCBYgQkVgZSCMAAiJsLNAWp+hwRo0gFcF8hlUahlaPY4ZqfvCz+Arjv97BEw35mgZOlMY1qEgZiNE6JMIp70UeElU8wa86rfBiaPTTaiGleiWDfjHKtAeeA5au/5v5fn/AwgDpAHCQAgTDMsvQwIakTUImTcKYeeAFcYonorMHgRG0CfpnlsHWidAP6M953WhEo9i5zbtvYe1//F/h4Bu4hgM62SQ/wMiB9E96bT2UA2rULXvomMVeNvmg9OCdhPoZB2gQZg+MQx7l6OF/yc6b0Ob2Gr7T+/cboeX9omuXUD4UtIMgZWF0ftIRKQMWTgJmTcSIYzu709rQDeB+jeeMwcz9NLneTxfVXy9CRivytWBvLOFNC4COWpPpFOxClT1O3g176EqX0enGtHxSpAWwgyDkG1/e3j5exvaax/7od04KAcR7oUI5CJ7HYpRdCCyeAoyUraH4zWgVmrl3S1SDY8QLvnaKjBfTwKmmgdghc9DGN9GiNLuuljVugWvZjHex0+gmj5CRzf7hDNCbV2m2fPt/iQov2vXXsInZEY/ZM5QjAGnYRRNRmb27eYgDVpXor17ceIPEMje2OPt/pL4WhFQpZv6SjNyKcK4ACGzd63XbgKv8nXcjY+hat5DR7f5XZ20u+lOv+Lw0qDSaDeByOiNLDoQc+A3MHod6t/TrtCqBe3dq9zYn6Wds6XnG/zF8PUgYLqpSBvhnwlpXoiQObtWq9YtuOsextv+EqpxFUgTYQRBBthtPPa1gwCVQntJUC4ydyRG+TGYQ77ZvVTUqkkr9+/Ci9+EnVPT8+39fPhqE7B6uUnBiIuRxi8Rsteu1apuGc5HD+BtfR6davAVBzO8P1rac3DjaC+FCORh9Dkea+h5yIKxu++nVSXKu4661XdRPOYrO/Py1SWglzgBYV+FkBN3VS68mndxVt+N2v6y30XZmSBMvv7S7rNCgHbR6VaEGUKWH4U14iKMokldd9MatHofnb4GI/Ts/mnrJ+MrR0CdbCzCjtwgpHXersqFV7cUd/WdeNvmod24b+D9LEbl/9PQ6HQLwgxj9D4ac8T3MArG7b6Pch4gHbtCBHO/Ut3yV4uAXvIMpH09QnYZ3KhYBc7K23E3PApuDGFlsyeTy/+30BrtNIMZwRx0JtaoH+5uxtFqCyr9C4zgv/ZPI3fHV4OAyfp87KxbkeY5nSWa1gpn7d9xV96Jjm5BBHJ6zlb3dYX20KkmREZfzFHfwxp2oe/As3MHUO5DpFsuI5i/3+eb9zsBtRObKczQXQgxpDP5vPrlpN/7X1TlGwgrA4zgfmzl1xBeEu1Ekb0OwT7wdxj5YzpVatB6nXYTFwsr8up+ayP7m4Da/TmIGzpLNe2lcZbfjLP6TvASCHs3c99/8Tmg081ghLBGfA9rzE8Rne2h2gP0FQjzj/urffuFgF58W4YMlvxVSOucLuUNq0kvvhxV9XabB4nN/z+a7b6C8A3a6RZkyVTsyTdi5I3osodWzkMqWXWJEe4d7fHW9TgBvVQ/pPkcQo7s3OU6Hz2As+RadLr5v1JvH6H92Vrjf4019LzONaDVKpQ7CyOwuSfb1LMEVOkpSPPfIMvbi7RySL/zM9x1//CJ91+ptw/RLg2bMYd8C3vKTYgufopqO8r9H6T9To+1qKcIqN3YWcIM3wUis71MNa0l9c7PUNVvIQJ5/Nem11PQ6FQDsngagSk3IXOGda5r1W78YmFGHumJlvQIAbUb/6Ewgrd1dn/3qt4i9fp30Mn6ti73v1KvZyH8LjmYT+DQezBKpu2s0grtJX8kzPDt+7wV+5yAbuLnGIEbOpPP+fgpnEWXgeeAGeG/5NtfEODG0IaFfdCtWANO2VmlFXipKzBD+1RD3qcROdpL/WpX8qVX3oHz1vdBqS9MPq3BMgThoPzvhMiXggYzglAK563vk155x84qIcEI3KC91K/2ZQv2HQG9xOVCWtd2Id/S63He/63vJmUE+aKSzzQFNc0ub65NYkiQ/yXhl4D234UM4Lz/W9JLr99ZJSRCWtfiJS7fV1ffJwTUbvyHyMAfO5Mv9e7/4iy7AWFntHkjfzHyCQEBS3DbSy0c/MttPL4kQTAo/6u+fClo34fSzsBZdgOpd/93Z5WQIAN/1G78h/viynudgNqNn7GrwpF699e4q25HBHK/9FyuIaA5oVi0OY1ZEOT3c5rY3uhhm/+l4JeGMBCBXNxVt5N699edyiXCCN6m3fgZe/uSe5eAypkgzNA9Xci35A+4q/6KCOazN4LApYTmJDREFVPP6E01JnMXRzG+YiEeX1sIiQjm4676K6klf+habobuQTkT9ubl9h4BtdMHac4FEWkvSq/8C+6KmxGBbPamjU8KjXYVuUVB+k/K4+nFUeJpMPbBgEIIn/SGobEtTSggCAck4ZAkHJGEMyThDOH/H5GEg5KQLbAt/xgpv46eYwIRyMZdcTPplX/pXB5BmnPRTp+9daW9Ije8aEWeESmeB6JjhsPZ/DTOkmt9T5a96EKlFERsQU5QkIy7DJuSz/yXd7C20mFcuUVCfTmTjk84jWWCNCQoA5UWxOKS+lZNQyJB3HVobFU0xDzqYw5CSUwD8jNNinIkuSGbgnCI/CxBRkiDpUAoPFfhuMJ3VP6qW56EgbAy/HeYUY7V78T2inIQ87xoxTQjo+xLh4PuFQIakeLbEWaHOd2reov0Wz9CSLMtJcXee9oaCFmC3IikZkeSMYcXkQxZvLMuyfi+Njhf4FoCbFNjWhI8SbTVYH2l5sPNLh9sbmVNRZLtDS7NrQLXhfp0jKTnh1kMohdH5A/nn/Xv0ko9hYEMPKEI2ga9cgz6FQYYVWYzvn+IkX0tyos0wYgCFOm0wvW+wuJRWgjtkX7rR8hgwU5jtTCHGZHi24Gzv+wlvjwBlfNTpHVW+6bXtI7U699BqH1jZNYabAtKc01WbY4SzrYoGJTJOx/F+e5hmUgBn1UIWqbGsg1wJRXVgrfWJFnwYYz3NqTYWuthuGHyjSwGRXpzVEYxXrbL67WrqfBa6G3kc0LOSM455XjSm1s5sGQMV7z8EOOaC5meO4TtqUYqG1pZv6OZNz+IEqcZO+QxvDTA1CFBDj8gzMQhAfLyPBCKVFrhfeXI6JtohBsj9fp3CBz9NEbOEL9KmGehnCVI6+Yvc4UvNxPixmdgBF9tVy60ckm+dBK6djHYOeyLGQ4BhMKSm+c08YdFKS6+ZyJvP1FB3fNbmP+bMvIscNQnHC8gFACkQX2tYP7yJE+918qbaxIkW0L0svKYkNOb0Rkl9A7kEJYm25NNLKhdyZvpjZT0KWKm25/xqoiDvzWT/ucfynu3vAi1rSwdluCSq3/PD3MPYXSkjJT2EAJS2qPRTbA93cy6RANrk7XESFBSqDlydISTD8xg2gibSLaHdjXJtP6KddEC0k2IwskEj5nr92zQNluSnIkZfu0Ln/kLEzBek0Wo4H2EHNxelHr7MtyPHvA13n2IcFDywtI45z/QwOm3jqOlLs0Lv/mQ535RwuRyi0Q33bAUEAwKUJLl6z0eXNjC44taaakPMSxUyuTs3gwPF1Ikw8ScFCtat/BO4wZW6O0kBEyfOZkLDj2OXu+mSWypZcR3pzDw2MkgDJrWVTL/548w7QdHcM3bT3Dfg49xZdExFJgRkspBIpAITCExhMRBUe3EWJ2oZUm0inrRTL8yxVlTsvjG9AiD+pqgFInU5yOiBmxDYAUEytEkv8hw5JPOn6zHHHoegam3dipU60nUTiRc3PJFzvnFCaich5Hm2e3arbPuIdJv/bCNfPu2KwmYgo11Lkdfs4NxPx7OgLE53HPx+9x6ejbnTwkTT+68JyEgFBSgDd5emeLPLzQwb2mabLeQw/IGMT6jhDyC4HlUpBpZ2LSe11Pr8GyLCaNHcMyMGcw68jD6JjL54JZ5tKabmHz5cZSMG4qOpdFKITMCLLnrFba/tpJDrj+N2b/8KWsXr+aK0mOJGAFcoZBCItqyrwkEEjAAVyu2p1p4t7WCdxJbMcItnDY5kx8ck8vYITboz0ZErSFkCxrjijmLo0wcEuSAUovUXo0I1uhkPfa027GGnNNRhvL+iTS/+UXO+IUIqL3kGcIIPtq+7TWuJfXSLFDOZ8yD9+VgSPAQnHBtBdHxJRz3w4HceeEHfHOowR+/kUsqpdAaAjYYpsHSNR7XP1PHi++nGGD04Zi8wQy2cxGewlMeVekWFjatZ6GzgbxeRZx9wmy+ddwJjBw/GgJBNt//Gm/+9QXKDh7AlEuPI5iXh4olOtojTAPPcXnpxw+RV5ZN/+9M4dBvf4fINoc/HnA2tmGTVi6i/cMUPgk1Gq0VeBqlFE1ujEVNW3im5kOqZQXfmJbB5bMLGDbAxE17pJ09PxPLFDTHPM66tYr5KxJMHJvJMz8tJt/SuJ8wJPncaHvHgWOew8jt5MblJc/8ItF2n5uA2mnNEWZ4NcLoBX66s+SLs1G17/r573rAs0UICNmSn95fw78qDC68ezxPXreWAfUtPPLDYmytsIKS6irJjU83cs+rTZR6pZxYMJJ+ZiaO4yCFIK7SvN60nleSH1HevzeXnHkW3zzhJPLLSyEgia7exqJbnqd6zTYmXjyDoSdMBg9UN0yQYZvGDdW8+OMHGX/qgcjp5cy84Hx61QX4Tul0tNY4WiHaZKAUEkMaBCyboBkgaAUIm0Gy7QgKzRsN6/j75oU0BXZw2bGFXHp8Fpk5ikRid2kogFBQ8tt/1nLTEpfDzuvHK3dt5OHvFzJ7qN3tkORLPH10uglZOIngsc/sTCenvUrtxkcIK/Nz5S80rr766s93eSHuRlrT27ed5TfhbXjUn2brQVghiXLh3wtbGHxIEcmYy/YljZx9SAaZQYs5rziceft2Fi0zOLtgCmcVjafEziAjkEFhZh7LEzu4o/IVGorgl9//AXf+5moOPXQG4YwQpBKsf2Ixb1w7h0CWzczfnkb5waPQCQftet22Rzse4dJccnsX8NYdL9G/Xyknn3sif1kwh9WVmzkgXIbQipRycZWHo1xSbppYOk5zsoWGWBO1sUZqYg1EU3GGRoo5oddYgiqLOxdt4skl9QwtiDCkjz+PrjpJNdOAxqjHLx+sZ+ApfRl3TAlLnq9kan+LCX0snO6b/IUhjCC6eR0Io5NpRmYKIXohjLmf51yfzwzjJY7ACJ7bvqkaPsRdeUdbhoKega9MSBobHSpbHFQszdalLYRDNvVxl/XbDP6woIlb59dxfO54vj1mKrlmiLjnYAvJjlQTt298nvfUVi4+/wx+fsF3KenTG9JJUCmaPqrkvbv+Q92a7Yw+ayojTpuMsCxUS+JT26ajKcpnDGdqdBYLb3qWg39wFC/edRezf/AD/la5kAtLphOUNmntott6CsFOo7SnXFpTDi3JKNtbqolYQaZFyhg95BQeqviA429YwxUn5HPladmEgg6JlH+cZUo2VKaoUZLxo7PxHA0CvL1MvM4Qdhbuyjsw+xyLzDvAL5TWt/ASD2OEFnzW83x2AsZ22ISLb21XMLT2/AlrL7HPTC6d0aHhGfDgq838fk4dWyokKEnl2maGHVJElsrhzOsraG22+d2gU5meNZDaZBMbW+tRjsfbzRt4qOVdDhg9nPm/uI9pU6eDkwYvSbo1zqp/L2LNk4spGlXOsbd9i5zBJeh4GtX+pj+tjVpDNMnAWePRnmbhrc8x+bxDePlvd3PCT37Mn9b/h+8VH0qmESSpXWzDxDYsTMPwlZS2OTuNRitF2nOpiNVhCsl5BaMZ3JrD7+cs4r2P09xzUTG9SlLEk/6Q5OMaFydgkl0UwEl44GlC+3I4Lm1IN5F699cEj36qrSsWIO1biO2YSKQ0/VlO89kJGCr8DsIY1b7prH0AVfk6IljAviSfIX3iCVug0prLH67llrkxxpv9uSJ/CO9Ft7B8zXYGZhewvbaF3rKQXww8jGxl8X7laqT2ifF4/Qe8pyu44uLvcvX3foCVne0H6DhpPn5pFcv+8Qba8zjox8cw4MjRgEC1Jj93e7XySTjopAmYQZs3r5/LyOoDWHDbX/nGNb/mj+/M47cDTuOgvOGk8dCijbgaOqnJvqYsJBqNpxRpN82pmYWMyirl2uULOOra7Tx+aR+GDfHbWNnsQtAgGDGp35bASyqyIsY+tCdqsLNRla/jrL0fe/h3/GJhHECo8DvAXz/LWT6bEpJszCeQvQ4h8wBUopbkc0dAqn6fZCwImALD9nMxxxOaHfUOFfUuf5/XxD/fihEiyFCRT0ynabITBA2b2mQrB+cO41sFk0kkEzSlY4QMi1Yvwd1VC2kugId+fwPHHz/Lz9UcT7L9nfUsf/ANmrfXMeykCRzwjWlYeRnoaMpf1uNLQAiByAxS/d7HvPrbJygqz2PEJTP52WN/46lHnuWiokMYn9GbmJMiqdIorX0FRQNCIITAlBLTsAgYNmE7SNgOkW9nElMpLl89h+ZwFc/+pA+jxqe57p/13Lbc46K/TWTFgmoW3rGOF68qY3yh2MummF3gJSGQT3DWAmSo0C/TqoFU8xCCuZ+a+uMzEVCr9A1C2j9v304t/iXu6jv3icE5HJRUtChefD/Ka8uifLA+SU0cYkIiIia9ysNklwSwcgwy8gK0Lkux5PXtnJA3jh/1OwqlNQ6KTDPI+tYd/GTtQwwYPZgnbvkT/SeMg9o6KhZt4MNH36Zu7Tb6HTaCseccQka/YkikUem9+7ZkZpDoljreuPZp4tvqmXzZ4fxzxwdcdfPtjIrncnLhOAqsDBLawdN6l7TnGq11x28QmIZBfiALw7S4euOLyPwYC6/uy6Pvb+eGJYqL757IM7esw1jXxAtXFJMt1N41w3QDnazHHPE9ApOv21mm0n8U0r7i0479VALqdFOpsLI+QsgMANWwisQLxyLaliXYWxCAbQkeWxznl483UONKykZm03tkFmWDMynsGyanKEAgYtJan2bHmlYaliV47dH1nGBPZHb2SCqitSAEmWaQHU4LN+2Yx9RDJ/PE7XcQKSlkx/xlLP/HG9Su2UrZlP6MPedQ8kf1g7SHSn6Cke1LQoZsvJTDB397hbVPLOaAE8ZSMyrIr/91P6veXsExoeHMyBmKJQ0SKv2JAxqtNa72sLRBCpeba97i4DFBJgw2+cvaZs65aRz/uGIlJw0y+OtZObgpxT7mn58QSXmEjnsRmTeyrUxFdbplqAjk7PikQz9dAirnVqT14/bN5BsX4W16ss3mt/dgSD/W45Sbq3lmUYzZvxnBoEl5mJYgHXNprElSvbmVbWub2LGyFVFh0BiLc2jWUC7rcySmYbG29mNsJNuSTdzc8B9OPu4o/vWXO6DJ4e1bnmHDf5ZTOrYPY845mJIJgwD5mRWMLwUN0jYgYLL9zXW8/5cFmJ5Ln5MP4KXW9dz08EPoimZOz5nA6Eg5KeWSVA5dx9ai41/TMAiZQcqyimjVDj9f/28ysxShkSGGzS7muVs+4q/n53PO+ECXWaF9eovpJoz+pxE85K6dhT53fvJJx30yAZ2WcsyM1QiZCX5K3ORLs/2Yjn2wxJVtCpY3an7xeBNvLYkiTbAtSTyeRsYlOV6IIpXJsFAx20UzFbqVq/ucSLS1mbLcEpTjsKRuI7fULeD444/kX7ffTsN7W3j9uqeQIcG4bx9M/+mjwLTRiTTt9y5NCxAo9zMpbl8cQiAjAZyWOCv/tZj1c9+jfHhvzGml/G3JSzz41DOMSBdwXp9DGBApJOalSCsPAUghMA2LkBUkZNqY0iSajpMhA7wb28Jv1j/FQcf3gTLBxy9t541rSumfLUgmfcP1PqehVqBcgsc8szNlsFatuNERWFnb93TYJxqitRA/F9I8on079d6v0I2roLss7XsBnge9MwSnTopw8sFZjOkb4JXlzYzy+vGdvIM4ODyQ6VkDyQ9k8FzLSs4uncYQK59tLTWEjACBQJjfbn6SAw89kMdvu4Ntc5fx2vVPMeCYERz6v6eSP6wfOuWh28Z50g4irADx5jqaG6sJBiPIvbxG4a7QKRczYNLroEGUTRrI9uVbqH5pDUcOGc3xJ8xkmVvJv9a8idaSMbn9KAnlErT9mRJLmKS9NPXxJrY2VlIXayAnks3QSAnViRZWtG4jVp2i4uMo0aRiQJFFYbZBICixpO+mts+0YiHAjaKcZsx251UhAlqIhBDGK3s8bI8SMFGXSzBvHUIWAHj1H5J68bi25Q72rbOBKcCOSB6c38hFtzdzae5M+gVzSOAQlBZzWlewxWnkT8POoaq5lrpYAxlWmPtq3yE5yObV+x+iZs4aPnj0FSZfehRDTpoCSadNwdBIMwCmRe22dSx/92WWLX6JgUMnMvvsyzGkgVL70ILbCTLkp0qreHs9qx55F9UYo3BaKYvEdu54+VmqVu3gyPAQpmT3xxYmCS+Nh0JphUAyvHggpmHSHGvCDmfwo1X/QPfxCOXabFnXQoZWjOltMXV4iCPHZzCxv012RKLbPGX2Phc1eGkCx76Akd9mnNaqjmTDEEIFjd0dsUcJqA3zO0Iap3V4uyy9DlW3pPs1KvYytABDwy0vNlC3KYcjcwfh4CERRHWKuS0fclTuKCbk9Gd7Sw0BYfB83QreD1Tx3F/vxlmwnfce+Q8H/2oWg46f7JtVHBchJTKcQbylnjdeeIDn//1nlr87j5KygRz3jR8TycpHeftOGdntPl0PgSBSFiGWU0lKu9S+U0t5bYjZEyeSOSiX5+tXsahyA2FsyoK5WMJAC8HQwv5kBTP5qGYjjlYMyi6lLtrMhkg1J115AAedUk6vCXlUegbzlsV56KVG5r7ZyrZ6j+J8k7J8E1PCHmYWvyAE2omCdjH7HNteFNaGtV0I493ujtgjAQXch5BFACq6Fee9/0UY1j4Z++0K0xA0xz1ufq6RwmgZYyIlOHgEpcny5A7Wp2o5q/AgMu0wzdFmNiZqeSj6AXde91tGVGfxxt3PMf3KYxl4zGR0awqtPKRpIQIh1i97gzn/uI4P3nmBdDLGgQefyGkXXEV2UTkq/fkNz18aQpBOObwx70GWf/ws9iADpU2cVS7DWnM4eMhQUkWSZxs+ZEXDNvoHCzmkbAwBK8Camo1EkzEidpisQBhbSF79eB3rP6rGzjAZPr2QSSeXMnl2KX0n5dNimcxd2MK9c+tZtz3NkD5ByvINPG/vjRGFYaFbPsbof2Jbzh+BgL4I2a1hunsCuomZGNbP2uO5nFV34lX8B2FGdt93HyBgCdbtcPjrSy2MEwPoHcjGQ2EIg/nRteQYYY7JH4UhDapjDdxV8xrHnnok3x9xHG/c+AzjvzudYacc3Oav5yFtf9jw+vP38fQjN1K9YzMFRb055pRLOOrki7FDmahUnP2SnUtrrECIgUMmUr1tEys/fIXW0A7sgRYZ2aUEt9gMa8pkUnl/NqtGnqhZRp4VQUaTtKZiCCEJ2gEyghHcVIoqHWXdtmq2vdXEogVbqdocxbZN+ozKYuyRxUw5pYzcwVm8+FYzf3+8lrKSAGP72HxJu/tOCMNfs8XKwujV5rMiRCFu8g2ktXnX3bsnoBBXIYxx4C9/5bx/FTgtPeLrB2DbkrfWxnlqocOMyCCyzAAgiCuH1+LrmRDqzaisPgSkxZPbF7O5MMGdF/yMj+54g6Kp5Uy6+DhIK7RSCMPEdVI8+8iNzJ97N4FQmIlTZ3HSN3/BkAmHgee2ab/7Lx5DKxc7ksnIsYcitWDz2hXU1G4gllFDnxnD6D10HIFtmgmxQnTS4+6a1xGuZmS4F2nlEraDZIcyaYo20aJSNHpRLu41jbxUmI+X1vPWi5tZ/VoNm1a2kkx49B6RxdRTy6hv9fj7PyqZOiaDwQXGXjNYCzQ6WYc56My2/INCIIRCyKd33Xe3uWAv3ZhlWNmndmxXLkQ1rmrL37fv0R5Du2pHEsMJkGuGUWgMIan3YiS1S5mVjRSCRjfOK8m1/PT07+L+pwon4nDg944EBKotak2YNmveX8DGtR9wyNHnMH7qcfQeNBqERMVbe+SePh0ClU5imDZHnn4pfQeP5dXn7mPT+mXMr7qTaUefwYzrL6BlQyODXj+AAav7c92iJ8lqCTApoy+m9CcE0sqhUIaJKgc3pTkqOJzDM4bwTMsq5q1bRd9UksXzK5iHgZFj4yGQGRZxJdr8FPcSzDCqcRVe5ULM3ke1FcpTvXTjjw07t4vr/m4ElEb4NITo8K9yNz6GvwpRz0AI8BzN+h1p8mQuYWnjaYUlBdVuC5lGiGwjhInBK/Uf0mtYb44MDWPzkiVMuepYwoUFqNjOsZx2UgwafiCDhh9IOLsAhESnE+zv1QF2h0C5DnguQ8bNpM+g0Sx56znef/NZ/vPkfTRVVXHaRVdTfNBARunjCd9Zzq9u+RO5RoiZuaU4nkva88gWAWxhUOm10EtlIlKCsaKcN8QGLjkxi1njMli+Kc3WBpcmYTBscJhpBez1+BGEibvx+syPeAAAIABJREFUsZ0EFCJLGuHTgPs677Ybs4Q0jmvvjlR0G6p6EcLsuSUSpBDE0pptdR4lViamkH50GYJ6FSdLBsmQAaqSTcxvXsU3jz6e1je3UTqjP30PGoVOdDUmC9sibOWD56HSKejkh4cQHa7xwFeDlFqjEq0EgxGmHnMuYw48irUrFrJ5/XJqN39Maf8RIODKS37Iqk0beWTOyxxaPg7XdXC0SwgLC0mDG0MiSOFRaEfI93KYv7yVcw/JZuaYMO1rb+NoEum9b5IRZhBVvQgV3YbM6A2INm51JWBXldaJ5YI8vn3Tq3oHHdvelre5ZyAFNEZdKuo9CsxIx3PSKJrcBBlmgJC0eL1mFbLYZqJXTizRwgHfmAYYHV4s7SO6fz/3LFu3bQXLAq2QpomMRBCBAMr1SKWSeI6DMAxkRgYyEOiZ+5QSGQojMyJI20Yahv9n28hIBlgmpOJEsnKZMPN0Tj3/Kkr7DAGtUKkUaM2fLr+SvEG9eGzHYmKpOAKBJQ0i0qJFJzucGGxp0N/OY/nmFFWNLq6jiccV8Zgivg/I59+gjY5tx6vqnG5aHo8T7eI630UCain/RwjRIe7cTU/1iN2vMwwDqps9WqKCAjPcJp0ECoh5SXpZ/lj0vehmJo0fg/VxjF6HDSZ3QDk6vtOGJ6REmCaWZfPH++7l95f9lOxeJVRt2MCbSz5gXUUFDmDaNsr1UE6a0pxcpowZzaiRvtujSu2DeWIhkOEw6eZm3lz0DpX1DRQVF5OX599XQ0MDNdVVlOYVMG3CeOysbFQ8igyGSMcSVNfXU1ZcjI7HKSgr54ZLf8I5P76cMkIMDPruUGFs4iqNaqeWht7BbNY2QmWTS3F2zwyphBnC3fQU1qD/ab/3oJbm6QL+1r5Pl5YIaU/q8HiO70A3r+7xhZ6FFFQ3u6i0QXY42PYQNQiBJyEkbZrcOPXBFAeYvVCJNIOOGAue6OhCtVYk0y5By+bkE07AMAxu+vvfKS4uYl1VJYNGj2bmGWfQt29fAoEAnudSW1vH0iUfcO+rr5K1YAHnzz6RfoMHo+PxvdY1S9ME22be/Pm8sGgR+f37MXHyZAYOH05GRgYAua1RnDWreX3RIua89SazphzEUUcdTcXWrdx4z985dOKB9C4rRztpaG3l5KOO5fDD5vLi/OVc0utQbGkSMEzinbxqPDSFVoRUq0FFg8O4/j00pDJsdPNqdHwHIlyK3w1bk+mOgDpRmyWCece1b3vVi9CtWxBtX1VPoqrZwXQDZBg2nTsIIQS2MNmYqCUjN0KvFpuiMX3I7V+KbotUk1KS9jQ33n8fwwYM4PT/OYOpBxzAvXPnMGPUCH53xc/Jzszc7ZpF+QWMHDaMb551Ns+9+CLXPfJPTps2naOOOAL2AgmlaeJpxZ/uvJNKNJf8+lcMHTSom3bkM6BfX4479ljWrl/PQ/fex/xrfotWilkzD+OIadPA8xBSolwXGQ5z+bnncfzCi1iXqGZcRh8k0v9wdXvvock0A2jHYnuD2/497/vsC9JGt27Bq16E2b8j//RxOlGbJUKFLdBpDCgCWf0RsqR926te3KNjP2gzwWjY0egilUlQmh2eHFIIpBB4WrHeqaNPpIBcFaRs8mCQO8d+Silsy+KCU05lxdqPuPXWW7j2Hw9w5e9/z2WXXtot+XbFrGOP5eob/8izS5cyb/7LiPCXWwRbGgYauOHuvyF6l3HTzTd3S75dMWzwYH5//R/IHjyYcCjMEYcfDsEQqVSS1njczxsXizH9wElMn3IgbzVvBPyYEonsGAhrNCFhYmubupaemefugLR9LrVDyBIRyOrfUd3+QyvVkelIa4WqfM1f9r4HIfBjKiqbXALaxpZGhwSUCIJYtHgJqokyyCwgMy9CztASdo07VI5DWZ8+/Pz8C3h12VJOOf98Dpo0abfrbdq0iTlz5vDwww/z6KOPsmjRoo660uISfnPdtTy/dCkfLluODH6JsXAgwP2PP47Vu5yf/PiyLlWrVq3i8ccf5+GHH+axxx7jww8/3O3wX//yl+QNGcw999/H8/Ne4vKbbmLNxx8jLQulFASCnH38CWwSjVSlW3C1wpJGWyC871VtCoOgsIgm97l7ahcII4iqfM0PwG9DZ67tHAMawd4d47+GlehU0171eP4sEAJcpalv9YhIGwOJh/IfoJRkW2G2JBpImA7lZJHdL59wfibaU7ucx+9fnn71FU4680wOmT69S300GuUPf/gDDz74IBUVFR3dayQS4bDDDuM3v/kNEyZMoCAvnzMvuIBH7n+A3w7oj23bqM8Z6ygDAVZ/+CEra2v43Y03dpRv27aNa665hrlz51JXV9dRnpuby0knncRVV11Fv379Osq/9/3v861vfpN+m7dw6QXfZkBxMSrdZnJKJjniwMkUlhWxsr6ClHbJMkPITuZlicDG8L1gdLtloQcgDHSqCd2wEpHvB3v5XGtvF6Bat+YK7XW8Ja/2PXS8si2ZeM9B4Offa41rwtJuy37vy0BTWhTamWxM1qBtQbGMkNWvECxztwAiYZrUVlSwYvs2Zp14Ype62tpaTj/9dK677joqKirIzMwkKyuLrCzf9v7ss88ya9Ys5s2bB8CUyZPJKCvlrQ8+8E05n+t+AK147s03OWLWLCIhX4quW7eOY489lnvuuYeWlhays7M72pBMJrn//vuZNWsWK1as6DhXIBDg3AsuYEC/vgzs26/LAE47DkUlxUwZN5a1iSpavCRZIrhbWwwh8NQ+MrvsCdJExyvxat/b2RbtTVetW3OhjYAy3KsQYXRkN1XR7T0279sFbRIwkYKI7Op3aEqDAiOCqz0CriAig2SW53f/Gds2iz9cQd9hwygqKOhS9Ytf/IIFCxZw6KGHUlxcTDq903BtGAbZ2dlUVVXxox/9iA0bNgBwyMyZfLB+PdpxOmJ3P9PtmCbbtm6jSXlMn+ZnEIjH41x44YVUVFQwY8YMIpEIjrPTfGRZFllZWaxatYpLL72UhoadSUinTJvGpsZGqrZuQXRKiq21Bstm6tixrNd11Lsx8s3dx6092/l2grR8TrVDGOUy3KsQ2gio0SPaJ2G1l0ZVzO8xz5ddoTQ4niZkWJ26CY0QkG/7pgqZ1hiGQTg/c7dslFIIdDLJe2vWMHL06C51r732Gs888wyPPPIIr732Gv/4xz/Izs7uQgCtNVlZWaxbt44HHngAgBEjR1IdbaWquhphfo5ewbZZv307Rb17k9Wm/DzyyCOsX7+eBQsW8Oqrr3LjjTcipcTbpWvPyMjg9ddfZ86cOR1luVlZFPfpw4Zt23ZPiK0Vg/v0JSZdWlWSfCOjiwVBo3G1ImjJfbs6UTcQZgRVMR/ttX3sQvico42AAnVMx95eAtItO70CerKh7T80WF0ekwAhyJVhgsIiqC3CkSBWOLC7LUFKErEYzckU5eXlXaoeeughAoEAxx7rO0sedthhlJWVdZGCnbFxo69V5uXmYoRCVDc2+prnZ4X27R39+vtKn+M4PPLIIwwcOJAJE/xk80cddRQ5OTm4btdwUCF8u+amTZu6lJeUlVHf3Lz7tVyP3iUl5OfkEMYixwji6Z3TjgqNpz0CbR1Lj3bDQvic8jplFGvjnP80jUBHiJtq3oB24z3ieNodOmu9naHQRGSAIjODLBEgHIlghKxu8/E6nodpWQRDOzVX13XZunUrlZWVXH/99Xz00UfccMMNrFu3jmCwe22/vbsVQCQjA/fzJlvRmkAgQEaGL/2ampqorKzk/fff5+6772bt2rVcf/311NbWYtvdm7x27fJD4TCeVt1+eI2tUWLJJL2sLMLC3jkTgk84hd4/66kIiXbjqOYNO8vaOGc69WvDVt7Q8vb37VW/7a9guY+znH4eiLYv1taCIjMDCwPTtpBW9ysuSSlRnrdbt9YuVf7whz9wxx130NraSigUwjTNTzU0p1Mp5BdYE8xzXZw2Cau1xjRN0uk0P/jBDwiHw0SjUSKRyGceW7qO09Zt7bK/lGypqCAZT9I/awC2MEjqTkMLNAqFuT/WNRMGOlmPV/02RuGE9gaVOw1rwtKK5I8GryPnC26cHhbQ3WK3xyR8qVhu52AKoyN9xW7QmlAoiImmprq6o9g0TQYPHowQgkgkQjqdJhKJYBjGHsmn2rTrWCJBvKWFnEhmt9MH0jC6j6aTklQ6xfYKfwCem5vLwIEDAQgGgziO86nk27VtdTU1ZIa6MYwLwdZa/36HR0q7ORH+M9w/HZvfADfeadsbZUUKR0ttZuTSaRFpnWrscfNLd9C7bAjARdHbzsOWJo7roDzFrlRVSmGGIozs14+1q1d3qTvzzDPJzs7GdV0sy/pUqdNOlk2bNpFj2/QuKe4m55mgJdpKMpXaXSp5HqX5+Wz/+GOctmuedtppHaT/pDa0E69//45JA9KOQ8WmzfQrLaWzD70Qfi62j7ZuIYsAwzJ6obTaRQnZ9UcPQ5o+t3YWZGozkiuFGQLhq1Tac1ANqxCyZ1ySPh8ErvIotrLItELU1NXR2tzS/SetFdNGj2Ht8hU+MdowdepUTj/9dBKJRId06w4tLS0MGTKE8847D4A3X3+dYeXlWJFIF0O0AKRtce+cOSxds2Y3Vy7tOAwdMBBiMVasXAnAySefzIwZM4jFYp94t9FolBkzZnDyySd3lC1bvhzicfr17t3lQxBSkopFWfHRWkaESikKZPkml05k65pzpuchZADVsArdHnUopBRmCIl2d85ROa3olg097gHTFW3OsN08Kk9rcswQpcEcahsa2FFR3e36XDqdZtCQwWQB/1nwn45yKSXXXnsts2bNIhqNktrF3crzPFpaWigqKuLPf/4zgwcPZvuOHXy0dCkzD5y0x4yPyT1o0VopzEiE6SNH8VybOSUSiXDbbbcxduxYWlpaupiAwFeWWlpaGDFiBH/+85873LQAXnj6aWaMGYMZDnf9gCyLjysqqNxezeSMfkgEhiG7PkEBaIG3v4yBhu1zy+kUBqHdA6X2nMN3Fnjsz+Ac2q8u/O62S7nw44UtISkKZJGIJVm1ap0/rtmlG9NtXiDfOPJI5s2ZQ2WnsWBhYSEPP/wwV155Jfn5+bS2thKNRmltbUUpxfHHH8/zzz/PMcf4lql77rqLmaNGUdCrFO10HzMshcQwu5+21IkEhx18MNQ38NzzzwMwbNgw5s6dywUXXEA4HO7SBtu2Oe+883j22WcZ3cmOOfeZZ5FNzRw6ZQrs6qdoWSxe+SG6MUm/QB6OcjviRHY+V3+pCNfbn+N70caxNijnCFMIMaB9W6udLuv7A22p8TAlbcl5dqkDHK3JC0RodTQbVq6nNRol0w7BLnY0lUrRb/Bgjp84keuvuYarf/97cnN8a1N2djbXXXcd559/PmvWrEEpf765qKiIqVOndozLbrv9djITCWYfeRQ6lez+yWiNEAIpDTAMZCTiDwtcF51MopXCsG0uOv00rvn7PWTn5nLw1Kn07duXe++9lx/96Ecdtj6tNf369WPcuHFdLvHGm2/ynyef5NcXfBvDsro4ygohwHVZsPgd+pv5ZFlB0srFMtotBP69SAQGvqva/oNGq1QnEScGmAhjp4x3Wv3kjfsLGkwpCAYFrcrv1mSbPxttefJc5ZElLaQdYeumKjZt387oIcN3IyCAjsc5+sgjcZw0v778cs6/5HtMHDe+o37w4MEMHjx4t+Mqa2q4+y9/Idwa5afnnedfe09jRq2xTIPMzAyqa2p5f+kHVNXVMbR/f6aOHef77SWTlJSVc/m553LznXeybcsWzjjzDCSCMWPGMGbMmG5PrYBHH32UxfNe5mdnn01xaS9UomuuamHbVFVVsviDZZyYOwRDmKQ9F1NaCAS+T4zvlGAIScqhZ50ROkO74EQ7Nd7IMxE7B3w6XuuvA9HjkzU+FJqgJcjPlNQoD7N9CTBpkGmGsDFIp1IYWhK2AtjNimWrVjN6xKhuH6jWGuJxZh0/i7KSXtx78y28MHgwx51wAgeMGkVgF+Pvx5s3M//ll/lg4UKOGjuO0848C5RCdUPuDhgGzdEYt9z/AHlZmZSWlFCcX8jTr72G6ylmTJ2KTiZRsRj9Bwzguh/8kNsffpjLFi7k6NmzmTx5Mvm5XVcYqGtoYNHixcx79ll6mRa/u+gisgsKUPHE7iOkQIAF7y6mtaKBAwb1xnTARBKwgzSKZj+liZSEMLGlRSqt9tPysQKUg07UQE7b+iLCsM3OdgCdrEUrd79owVqDZQikIZBKsNzdxG8qanDwCGMyoLGY3mYOvQO5FJv5WK6gn8xn+aIVpE+Y5fsOdpdUSApw04ybMIE/Dx3Gy2++wRN33c1diQT5xUVk5eSQSiap3rED03UYP3Aw1174XYrKyuBTtGUAlGLEgP6MHDCAE484AjszEwIBRg4cQEVNzU5ziRCoWIys7Gx+demlrFi6jBfmzWPuww8TzMqisLgYhKCmqopUSwsDiou5cOZhjB471ld+PAdhGV2WiZBSQjrN4/PnMUQU0DeYz4fJrbxRtZaNyVo+9mpQbRIwiEENCSZGI2BIhNiL+Tg+EwRauehkbaciIYT2PQX9FBzrHiK96OcIK0xPKyOmIXBczSV37+CZpSbHH30kowcNIKwlNck4H23ZwrJVq6jcVkW+G2BK1kDGB0rZWJLg57f8gv69yncLIhJS4jS0ktpSQ3BACVZuJgSDoFw2b9lKXX094M+OhIMBBpb3JpibC6kUag8Kx27QGhkMgmn6hPU8ZDjMwnfepikW44TDDu82uEm2TRPWVVaxraYaz/N8tzPDoHdxMQVFJWAIv8t1PZJbajByIlgFWR3TjzISYdmHK5h1wYXM0P2oSrXwbmoLvQaVMX3iRMaPGElBvj/Cqqqr4823FzPv1fn86fwcLjgij0Ra9eCiiBrtxLEPugFrSMdKH7prVJzT0lVL6SEIAXZA8Mc5NTy/Mo/n7ruNacNG4s5bggxbyGMPBCFwmptZun4dc197hX8+8zRbwnHuv+p6+hQUo7szhZiS+OotNL28jPyTp2BNzsJraSW+bCNledn0Gz8BtPIlgdbgOKhodPfzfErjVSrVoZkKIUFKFq9YwdjhI/bo1NE+lisoyKegpNgvbFtrtuXlJVRtXULukeMI9CnAjSVpfvVDQiPKsYtHodvipDEM/vncc1Q01vEEjUydPplHz/0pR0yeSiAnC2JJaI2DpyAjzKUXXMjvbvkrV/79OqYMCzGkNEhqbwekfxK052fP6oSuUx7p5v1iirEMQX2Tw6NvtPDDc7/LtNFjqLn3BcgIkDt5DKK11R/sGwaTxoxl0oGT+NnZ59DQ2sKgvv3QqXT302meIjS0HGHbBPsX+57TWpPYUoMXT5M1sJh2w5g0DF+K7cGm91khQgFeW7iQlmiMaePGd/9hALLNuVU5zk4FSgq045LYUUe6ogEvmkQrkOEA+adOQQZttOt/MCIUZMvGjfztsccoKy7i2st+wnknnwJ2AFIJvMpq6l98D7cxjjANtOOS0aeEy06azeMvPscL73/M8JNLwE+Z2ANoM8Gku3ry7P85N3xbcm2zS0WzYOiAfqTf/BACJvmzD8IIWB2Z67XnQTyOiMfJy84hLzcPlew+dleYBkiJXZxLoLQA7bpox0OYkvzZB7VJG5+QMhJh2+bNLFm9mlkzZyL54lkStOuSm5nBhaedRigU7LYrl7bFC6++RnF+PhMOPBAdjfkxE0ojLZPco8fhRpMEygrQbfEuVkG2vwaJUr5ThRDc88TjHDJxIrf+8lcMGjoUWltRSX/lGhGwyT5kNMI2kaaBF03Q/MZqMhdvYHjfgayt/AjP9dXN/eaoyq4EtLPb4kB22o96CkL4RHSTaZxoM6EhpRhBG5Xa/QVq2KNRGPCdALbV4jRGCQ8pR9hqp9uWBmEZHd2ujESoq6vlxvvv55CJEzFME/1JWu+nQKcdxowcBVqjnD1k3RKSnOws7nnySbbX1nLi4YcjhEAlfYlnFeZgF0v/w5O+tNSu6lBohBBEGxqYOWkSv7nk+5ihELqpqdN8r/Y/vpK8jns2C7LJCdi4r63GjDm4lkD1aCoS7XPLzu5S2sXeIqysHg9EAj9LZ2GWRXmeZsOWbUghEFJ+MSkkBMKQJNZX0vrOGlQyhdjVBaktWbIMBFi1Zg3nXv4zZk6exGmnnopynC8XAywEKp1uk3x7GP8lk0ydMpVrL72Uu//1Ly793e/YtGVLWx5D0K7nr8gpQSXSRJduJF3T1DHvrZQiEgxy2LTpmFKi4rFue1Htev6f56FTDmbQwpWCuvp6ssISQ/a0ImwgrK5hsbKzf5EwIyCNHrdQukqTl2MxfUQWi1Z9SFJqvNoWnyif12ilNdrzyJw8lML/OQQjEvKlxy6Qts3qdeu4/8knOHjCRLZU7IBEYp8nKQdfO0drnpr/MifOnMnsww9nW2WlX9d5P8skXdlA/dx3iC3fhDBEx/PQ+ET2nSM+wzMSAtIejQ1NbKvaxrBSG2nIntOCNSANhNU51EPrLmJGBAsQsnsnz33aNg1oxYkH9WXVxrWsNxJQ04JT34KwPsMwVWs/6ZDRJr2VxgjbmLkZe3w32nUpKyjgqu9dwpU/vozWWIz7/v1vCIc/V+DR54UQApGVxZNPP836rVs4/9TTOHzmTA6ZNAmV7rpIjXY87F555M8+iMjofmhPd8gLKeVnb6eUiICJrGll7aatGIEmDhmRidej03IaIc22tQXbi7SWOyNFQISL2qLhen6+0El5TB9u0zvL4aHl7xEuzCW6cBXacxEBa8+SUGtkOEwqlSaVTvvSBdCe2uPavuB7qmRnZvrBQokEP/32t1m6Zg0vzJuHyMhA7IMxsABEdjbz5s3j1Xff5f+Vd95hdlbV/v/s/dbTZs70SZv0npCEQAJEiiiEJigKCPhTQRQU0QsqiCBgu1baBTR48VoQ9CpIk95RgdBCIIGEFNIzmV5Oe9vevz/emcmEJJBJv/d+n2eeOWe/bZ991ll77bXX+q5vf/F8bMdGdXfHU/Z7P6NSyIRNeuYY7PqKzYsmwwDbRqTTSNveqqdCSqRtIR0rZuIX4C1cRX7+UuYt+CdTx4RMGOwQhHvZBpQWIlHbrynyJTraXFDOyrA3ySj7I1CSpN3Nv51YxR8f/DvPmd1USIeu+14iaO5A2gbCjQdVSBlTdTgOsrqatY0b+eiXzuPGO+/oEZ4dg+rZZlO+TzKV4soLL+SBZ57muWefje+zGzWhFAKRzfLoY49y7xNPcOWXv0xlZeXm5PLtdlKjvM2FsqVloQV88Yor+f7119PZ3Y2oqEQmk7FWlIIwV6C4cgP5RavofOYNcne/AK+t5qevPsa9q17BMcx9E3MizFjGeqGjVuOaq674BNIaDkDkES79XbxpvA+SklSomNJgsK7Z56o7n6V2ykgmuVmsJZuINnYgmrqQrTlEfRWkXNZv3Mjv7v4rX/ruFbz19lIWLl3KiYd9iJohQ7brf9smhEAHAZmKCqaNH8+v/nQnptaMnTABEUW7TkxkGJBK8Zd77uHRfzzHVRdeyKBBg2OXyQAgeoT4F7fexk9vu5VnXprPXU8+TktrM9XlWWqrqhFVFRjvNhG+uAyro4QrTdpSgu++8hC3PvEo9aIckfA49dAUtim3ldO1hxBrQGvCeZvtQB0sFFoFVyHM7wHoUhvF++bEJTj3wWoYwDQ0Qrpc+0CJX/y9iYmjJnDMqAkcWN2AJSSrN21gueuzsHEdCxcuguYix1VOpd7OcF3jU8yYNoUH591KdVXVVpEjH4get8yGjRv52a23MmX8OM771GlgGAMWFuiZchNJ/FKRm//4RzY2NXH5BRdQWVER922AGlZWZLnnvgc57zsX8+kPGTw0XzOsNIQ1XjNdScWEiWOZPmki44YMI2s55MOAN9au4vEXnie3soVzqmazLpfjH8mXePLqoYyqtfH21jSsIzBcEqf8C+H2uofCq4XW+njgoficgNJjp6JbXttj5bh2BKbU2JkEv3wgz4Xz1lBJAlImWkJK2BjdIYNFmkOqx3Jg5UiqrRRrO1v4Vec/WdC9lmMO/RB/ueF6stksKp8f2BetNTKRoJDPc9Ptt9PR1ckXTj+DMePGxXu9O7hHLB0HbJsFCxbw+7/dzbgRI7ngzDORptnnLN5RCEBkszzx1DOc8KWvcs2nFCfOyjL36k18xjqSMclKVulO1kadLGhaQafyMByLwPOoIMGRdZMYa1ZRpm1ez2/k9uK/uPeKWj48OUnB20sCGBYR1QfiHvu3uN5MjBNMHRYRhqMQUgrDQlZOJmx6AcG+E8BQCWzPY3qDR2VKcqo5g1FOFl9HjKkeQuD55IsFXNvBkRYdYZGsm2Zoaxltg6pYtGQBJ335q9x943XUDRqE6h4AG76IAwCSrstlF17Io08/zXX/9RsmjhnDKR/5KA0NDT0uDT+OUumdnoWIt/JsG6KIt995h7899ihNLS2c9bGTmX3wLCgW4n3jAQiflBLKy3nwkcf4xFcv5svHmnznrFoWr8xjmJqOsEgYRAw3yjmyZgLHJsbR4eWpL6+iLdeJiWRYto7VHZvoDkrU2Cl0h82SDR4fnrJrtHMDgVYeRuXkzcKnldKRhynCfDuG1Q2yHEA4FaD2YVBqD4IAxtS7DKrTLF3bwsz0YDwVYmpBIAUF7VPyI9yEC1rgmBaTk0N4tmkpV50zhvtfeJc5Z32ee266lqnTZ0BnxweHVvVCCFQQIMOQuUcfzZwZM/jLIw/z43m/oraqmkOmTmX86NHUVlTgWCZaC0qBx8aWVhYtXcr8N9+kUCzw4dmHcOkXzsNKJNG57oHZ/T2OcpJJ/vP3d/Clq67ikhMNrj13EIQRriVI2FDKh2gJRR3QGRQoqYAgDEBD0krQlGsjHeRwbIduv0CZ4ZAiyeuri0QRe4eoEkCFsWxtbugWYb4oaFtTAAAgAElEQVTdDPLNb1hO1SIgZs8x934o1rYQKk1NmcHs0S4PrWwmF/kIoBB62Gaczqh0hBcEuJZNSMTYdC2Z5iwvLF7B/d85kC/c0sjsMz7PbT/8Lmed9klksTgg20tpDbkc6USCc886mzNPOJEXXnuN5159hT8//DBSChKOg9KaoudhCMn4kSM49aMf5eADpmIkU/G0XXj/DLhtQZaXExSLfP071/Cff/4t138uy7+dUk3gh3FusyNJOIJcdzwuWmuUBkMahFpRCErYlo0GCr5Hykn0MMwaNBhZFq3uJF9SOJbso/DYsxA9stULY1GQb37DtKomFkD3URcZdYcRulWx0biPFiLQEzYuBUdOSvLHJzpoCnMMscrwAp+k5WIKA1+FFAOPpO3iRQFZN81h6QYefPVVVq5bzV3fGcb37kzz2Usv4+n5L3HdZd8iU10FXV07rg0hjoju7iZh2xx91FEcfcQRlLq76S4UCaMQhMAyTcqTSaxMT/J6qTTw0C6t4+24sjJefeU1zv3O92ha9woPXtHAsQcl8AohkQLLgIQtyaSgq7HUN15aKwxpIISgFPiknASWNMh7RcoTaRzTRkcRIxMVPLFuBauaAyYPc/Z8ppyOEG4VRt1hm9uEXmdVTSzEvpbI6+htl+VjEGYyjpPbx1CR5pAxCSoqQpbkW+KchjD+wk3DRAjwAj+mnVAaLQQHlQ9DlRLc8a88lFq4+gzNY9+bzLP//DuTP/Yp7n/4UUinkYnkgPW8iiJUPo8qFnFtm5rKCgbV1jKopobqbBbLNOPjhcKABBxASoHMZlHAv193E0eedTYjEot46edjOPZAh2Iu7BMUpTWOJcimJd2R3xfNEqkIQ8q+cQFwLQcv9AmiiLSTIFKKBqecXJfFwtWlbWW17n5ohTCTyPJ+tMSR3wF9wQjykb4DRgLssr1kGLw//FAzstbm4LE2i4qNhFqhVITWCseMjdlIK0qBh2kY+CqgIVnNDGsIf3upm9VNEapU5OjJXbz4szGcPKPEJ796IadfeDHLVq1CZCv6AgAGij4ndhDEf2E4YKGD2LcnUylIpXnkyaeZ9omzuPG2n3DD55Pcc3kDQyrjmh5bbNFpcExBbbmkUxVjsiIgVLEGlEISqIggCnFtB6U0ea9AwnHRUlBrpcmQ5rmlBaII9jhdjNaxTBn9F7axzPUIoHirV+CEYSOHHIMOB2637G4oDZYtOGFGmnW0sinIITX4UYhjbSawzHslTGkQRAGOZXNEdiRrNhjc90oOaUoKRU2Z3c7NXyrnqe+PZP2Kh5l9+plc/uOf0dTejqzYeUHcWQhAJpOIsjIWLH6LU87/GqdccB4H1S/hpZ+P4bxjy/DDiNI2vD5agzAEQystSnj4OkICgQowhUQKGZeqCHxc08aQkoJXwhQSx7Jxhck4q5rn3y7R1BVh7GEJ1GEeOeSYzflvcd72W9BL0VvY0AxRnx0o00N7suP2PVSk+cjkFOUVAYvym5BCUgo8bNPGlAYC8EKPUIdoBAERE9L1jJP1/PaZDlo7I2xT4IeSYr7E4RMjnvnBCK79jMHd997Egaeewb/feAutnZ3Iiuwer5TUq/FEeTmLlr7D5y75Nh864ww61z/Ck9c08NuLhzGsSlMoRNstoaoBJDRUWRSlRz6KmVujKEJK0ZdNWOyZGWzTohT5eGFA2omL/0xJ1rJ8nWLBu0V2JN5jl6CCWKb6EK2LZa6XojczvF1j/LP3sFFzMCI5aL9wx/iBZnS9zZGTXRYUN+DpCD8IkD2Gf6/9l/dK2KZJKfTJuCk+mh3N68s197+Sw+x1PSEoFDVKBZxzTIb5Px3N14/t5j//8FOmnnIaV/zkOlY3bkSWlyNTqdgHtztMkd5onbIyRCrFKwsXcvbXv8VhZ5zFkoV/5faLynjy+yP50CRJsRhR2pFdRAUNVTaR6dMdeTHrgYqnasMwQQj8IEChSdgOWim6SwWStos0BCPdCpwowyML8yg18Ki3HYYKEclBGDUHbx4OjH/KzPB26B+QGpXW9u5Qi8opCCe7TxKU3gulwbAEpx6cYROtrPU70EoRqYiEFWsrIQS5UjGuI6IitIQp6cGMEnX86vF2OnNqC2LGSEEhr8gk4FufrObVX4zl8o+F3HXvPKadcjrnfvNyXnzlVbDteHp2nD7m/R2G1nHARCKBrKzEiyLueuBBjjvnfI7+7LmsX/4wf/xaFf/68WhOnZMhDCMKRb3Dj9CRZmiliZuIaAkLGELGn12B1cNuFmlFyfdIWQmkNMh5RZTWJOwEGcNhilXPw6/n2dAeYhl7SAJ1hHCyiMpeBkDdI2sxNheqkfKOvtdCIgcdhY72QQn7bSAKNEdPTtMwRPNybj1aafzQx7WcOGxKxIwJxcDDMuLppiKR4djsaF5eGnL3/C5Ma+sAKz+MBbEsEXHRyWkW3jCW/7ygkpVLHmHueV9k9umfZd7v/siG5hZEJoOsrIw1o2Vt5qPptZ2FiAsQ2nZ8TmUlpFIsWbaC7/70OiaedBpfuuIyaowlPHTlMJ754XBOniWIVEChoAbsCokU1FeY1FcLNvndCGKBC3WIY5q9BTfI+0Vs08QxLUIV0u3lSbspEILZmSGsXCd44s0cprlnvL86KiEHHRVnC/agv6xtLtXldb0r3MpGhFEPYNTNJnx73h7o0sDhh5r6KpNTDk7z63s3MDcagxu4JOwElmESRCEC6C7mqSurJOcVcV2b6ZmhjOsYzHUPNnLKzAzlaQN/G2mIfgh+LsKUOU471OC0Q4by0gr4w1Nr+MGN3+Pqm6o4aMpkTjrqQxxywAGMHTGCdDYb136DXicc+B5tHZ2sXruWJ19+nXuffIa33lnMoDKP846q58wjJjCyrgRhnlIJlBbs7NceKU15QtJQY7B0RWcPbS/4YYBr2n3xjCXfR2mNazmUAo9cMU95Io1hWoxwKmighj8818Zph5RjmXuAvEj5GHWzN7/XqlF7Xe+KRFwCrk8ARaKmCx09BJwLYNQdgsgMB69jr5fsei/iiGk4fXYZtz62nsWlTdTaGeixb/xigBQSLwxiZijDwAsDyt00J1aO4/p3G/mvZzr41serCcLtT3OhkoQFjRTdzBopmHV+OdecUcm/lhS59r4X+Mo1T1JdnqEsW86wQYOZOmYMlZWVdHR0sGL9etY3NtLZ1UVjcwuDMh7HHVTOD06u4bDxLo7robxWCjnYHdQnSoPjSKYMdXhedVNQAbYw8cKAlJPEMAyiKCLSqs9Z31XMUYoCin6JMjdJexBwVPlIbl/UyFOL83zs4AxhcTcKoPIRmeEYdYf0b32ot04cgHHNNdf0HdHKGySkeRIIhJUhXP8sdK3Yx3yBMZTSDKk0mb+ywMsrPQ5MDSZh2jimTbdX6OGRjrejyhIpin4J13FJa4tNhQIPrd7Axw/MUFtu8D6B0kC8WAkiQRCEJO2ASWMNGsoNnn5b891Pnc2xkyZT7Oxi+coVLH17CR0tLVQZFkePn4BjOpSCdTx05TA+89EMI6siwsDD9zWh2nmNty1YlqCtW/G3l7uZYA2mwnRRQMZNUvQ9gn5UJWWJFMXAJ4wiIqWoTJVRCEpUGC4Lu1pYle/kU7MyWIbYfTGCYRFRfTDWhHN6GjRa+fOENF/tPWXLcq1K/QWpb6CnZrA56lT8tQ8jrPRu6tHOI1LgJCXnHpnl0680806xhWo3QzqVxjYs/ChECknBKxIl00hpEIQhaTfJiRXj+FHTBn58XzO/uWAwUrJdF8eWEHEZupxm6nCLikQ3jR2dfP/MMzhjzhz8MCRSCkNITNMgkUpx4bz/ZFSNT31W4+V7dy/2zHaDijQTBtskMyFrvU5GORV4UYgidtQXg1KP28on1BEpx6UUeBSDEsXAI5NME3WFHJ8dy28XvMDd87v5zFHlBLtJC+qwiDXq1H4NuiRU+Ff67fBuOTJWqh3Ug71vjbpDEelhoHaNLWB3IfA0xxyQYuZ4yXPdq8gHJdC6ZzUcD5pG01nMkbQcCoGHbdsMdSs4OT2B3z5d4O+v5nDtgQlEEGpqyk1mjbF5acVy2ksl8lGEhyYSAk9rSkrRnsvz9oY1TGmwSdh7Pto4DGFErcX4oQbLvVYUoLTCD0Ncy8FAYBKvjgteiZSdwJBxJlxHsZuk7YBhMC05iAlyKN+/p4X1zQEJezdoaeUj0sMw6g7t3/ggVro/UfTWP02tood6v0yZHoasnY0O94/VcBBpMmmT8z5cwXK1kSWFTURhSMpJ9hndQkhypRKRVhhS4AU+iUSCwzMjaFB1fPtPTWxsC3AGWC9DSMHMkS4bulrI19aRnTyJ8nFjKRs3lrLxYymfOJFo6FC6ghJj6qw4u3UPC2CkNemEweyxCVYHreR6/IFF38M1LUoiol3FLpq8V8Q0DBKWixCagleiFPhkk2mkFnyyajIr1lhc9ZeYvcrcRbeMDkvI2tnIdG9dQt0jW1tiKwFUUeEutO4zEs3RZ7BPSSvfg8BXfPzgDFPGCJ7sXElnqUDCim1BpXUPT6Ciq9BNykmQ94o4lk3GTnFm1VTeWiX50T2tSDnAkgUKJg518UptbMzlkGVlWKk0VjqNnU4jy8voUgp0gUEV1l7hu+hhIuaICUk8O88arwNLSEqhjyMtmkWRh713EEIQhCGlwKMskQTibNzWfAcJx0VaJoPNDGeVTeO/nshzy6Pt2K7ctT1iHcays7mzXSIs3PXe07b6Cgy7ogvU3X3vBx2OrJj8nhoP+w5BqKnKmnz5IxUsURtZnNuAUJB2kvRpbiHp9otESuFYFjmvQCqVZKRTyanpqdzyUDd3vdiN6+y4BCqlGVxp44gSm5qaY+LKKOr7Qym6u7uJwhKVaWOvJfuEgWbGiARD6zWLC00IIQjDMHY4GzaLi2tZ5jdjC0lnMU/ScnFNB0QcJ5grFahKlVPSIYdlhnOUO4GLftfKXf/swE3JnYuWCQvIiskYgw7v16juxqnoeu+p2759FNzeO4EIM4HRcBI68tgfAlUh1oKnH1rG1FGCh9uX0eXlybhJTGn21cbQGtrzXaScJAU/DhY1bYejMqOYJBv42u83sXSdR9Ld0eBUSCckZUlFd66brcdCEIYRttQknb2XbRZEmkEVBkdMSrLEb6agYrorL/RImw55L+DZ/HIUcYiWFwWUucmeHgva813YhknaTVGIfD5VOYWDxChOu76J2x5px3EkyQHZhAIdeRgNJyH68oq0jmVqa2xbAM3E02jVV+XFHHsmwqnab6biINRUZg2+cWIly/UGXm5fTcKwSNpO3xcvhaDgl/ACn4yTpL2QozyVwTAMzqyaSq45w5dva6S7oHCsDx5gpcG1JGWJnrIMW10Sk5UbA53adxG9kTEfnpSkW3bTGHRjICn4HuVWkrTh8FapkcVeIzaSrmKelOv2kJiDF4Z0lLqpSpUjpYGvIz5fPZM5xji++MsWzr91Ixs6QpJpY4fGCR0inCrMsWf2a1NvYSae3tbp2x0qraN5mxcjDRgNx6P9AST37GH4JcUnD8lwxFSLu9vepL2YI5vIbGW3tOa7SNgukY7wI5+yVIYKM8F5VQfx9MKIy//UjCF3zOiWMo5GjnaUj2UvIQo1B49OUFkVsqTQgikkhcDDFTZ1iRSJJDzc9TYFHeL5HkppyhMZNBopBR35HEpHVKezcRyhDjm7ajpnlc/itkcCZn1nFdff00pLV/SBkTPa78ZoOB6Zbuht6ZGlbWO7Aii8rjvQuq+WvDnhvB6Vuu8DVQFCBemkwbdPqabRbOWRprcosxIkLRelN9OYeaFHZylPRSJDW64rDue3bcY4VZxVdiC3PNjN9Q+2YbvifY1urXvqkWg98KqZexh+qBlRa3H4RJcFxfV4OiKMQiwtSZNmzgSLINvOIx1LMbSgo9hNxk3hGBZaKyKlaMp1kHGTZNwkvo4oap/D0yO5pu6jjOwYxyW/7WTuD9bx7qYQd7uaUCPMBOaE8/o16Rbhdd2xnQvex0OaqG7XOry1961RNRU57Ni47ut+glJJcey0FGcdnuSvnQtZW2ijKlFOf+0kEHQUupBS4lo2HYUuatJZIglz0sM5JjmZb/yhjT8924mbfP+VX2/8QfhBWyl7GVrHGvy02WU0yTaWlVoxEMhIU0UWUwouOaGSp0tLea2wgcgLCVVIRTKmyZBSUPCKdBZz1KSzfXGWoCmTDnV2GhC4jsQ0xPZVkN+FHDYXo2pqv76Ft5Kobt/eJe9rrYioNA+t+uZde/JFcVj1fpAvArFdJqXgio9Xk8gW+dPGV0nZLknL2UILRiqivdBFJpFicXE93UGR2nQFno44OTuBg+Vozp3XxEMv53ATcjuxcXHV9rguYL984P0EfqD4yNQUB46VPNGxnAhNEAZMztTz2rKIj05N8rmPJPlD52us8dopFoqk3CSuGY9V74LEFRajygdR0hGPdS7juxsf56HoNS79eJIHvj2Yhmpz27zSWoGRwJ58Yf+2bhGV3jei5f3NZatsHTq6re/k6unIhuNjMvP9BEVPMWm4y1WfqOCZ/NsszK2jLrVl3Q0pYuNbhIomq8h9ba9TbifIJjP4KuTs6umM8Rr49I0befL1PIntCKEQcf7E3qU12zGEEWQzBl8/vorlegNvFBqJwpCJyWq8zjQPv57j5i/UMXVswK9bX2ZjoR0zhOHltZQZCZLSxlchTze9xa/Wv8A1jU/wcLSAk46MePaaofz0c7VUpgz87VB56KALOfwEZHW/Kk86ug2rbN02L+jBB67XdJD/BVr15RfaU74GRnK/CFbtReApvnxsJXOmGNyy+l9oU1DmpPqSdSC2XJvzHRyZGs/CsJEn2pYwJF1NwkkQqYgv1h3M0PxQPn7tBh57NbdNIZRCIKWOtavYn5YhMTxPcdqhZZxwsMsdnQtZ63dQb6T5cMV4bn28k4684i8XD8Wt6+CWpvn8o3kZ/+pYzd/b3+GGDc9zZeMTXNf0JO9kFnDxJy1e/OEw7vz6YA4em6BYUtvnkdERGMl4huxrUzkd5H/xQX3+QAEUTnaD1uEv+y6onIw59jPozZmc+xx+pEm4khs/W0+rs4k71r9CXSqLIWSfX1AKQT7wSHqCo8rGMq/1aV7oWMbo7CAMw0RpxQX1s2koDOXEX2zk7ue7SCRlX8KOkLH2E8Tpj++3FuvVlHsboQLbhFvOrWdUQ4nvNz/L1965n6fal7O2SbNgRYkxo1zuvWQozuBWbup4nF91/p1FFQsYM6uZK860eep7g1n4k1H85LN1TBvhUPI0hdL71xPRXgfm2M8gKydvbtPhL4WT3fBBfd6hdBTh53+GY56HkJUA1gEXE615ELxWMNwducUehQCKRcXM8Ul+cmYll/zXK0wtG8zUVC2N+TaUiJkDhJQ0Fzs4KDGUx2SCn6x7iMvlx5hVOZy3W9fEQlg3m982W5x+3bv8sivi/GMqiFRPVVhb4FjEhbK3OUULDEOQsAXSElgqdhTv1XHwNCPqLe7+xhB+/VQHETkqkwZja+o4bEISryPk4DEuz17dwKaukGzSoKbMoDxpxNIQQRBoCvkdtPOjEiLdgHXAxZvbtGoTfv5nuB8cxrdFPOB2YSaK6DCHME4EEFYKLW2iNX+Pk9j3E2ilOWRckrc3Fvj1m6tIyzgZx0TiCBNHmBhCUiZcap0K/tW1kn91LKfMSjKzfAQl38MUkg9lRlLy4Ib5qyhLwPBqiy/Ma+SVFXlWbvCZMPkoDj3ySIRWCNNEOA6UlVFob+fOB/7Ci8tauW9+gdljEtRUmT3TjNhr6xY/1NRlTY4/MM3x0zMcNSXFASMcDBFryTCCirTB0CqLbCrW8n6oCXxNEOoB7eJovwPrwO9i9t920+E3sVLP7cj1O56QV2y+jWTdlxHGFABrwueJVt+P3vQ82Fn2B/9gGIFrwM3nDMKSm7jrteco5g0c7ZLEJYNLuXDIGA61iQw1RgUbwxZuWvcEr6bXc3hmJO3FblqCPC26C6Elz71VYF1byMI3NBuSkuc3KRrFfdhugokjhlORydBdKLBk9Rruf+ZJXl/WQqI6S0sp5AqjmW98rILKjGRIhYWTkISe3q4hv7sgIF6pbmO12qu4t3d8QE/xO5CDjuwXcAro6E2KzbeRGrxjdxkQ+2dUPAbDfaz3Y6i2Nyk9dGKP0WN9wMV7B1rTs2WkWd0c8s5GnxVNHu82+2xoj2jtjugsKHIFTbEoGV5rcursFPOebGNVI2RTkkxa0V5UdOSgPi3Z1Kb41YcP58wDZvLI8rd5fPkyFrd3kFMa3VNrLiVhQlmG48eN44TxU3lp7Qo+9rf7QUoGVUqGDpKceFCKT88uY1CVje/pfVw8eheh4rqv7gkPIit7/X4aotKxGInHd/Q2AxNAAOX/Hmn3VZvzX/8ZwYIfI9yqgd1nD0MKsEyBYYp4qaUBBWGoCSKNF2iKvsIxJZXlBm2dEcUgYuHaEr94sI2VKzQfzlTTVoxYUurm75/+NENqhmAKjYwicl6eXDGPH8Y5KBk3STqRRkuLYhSRIOQL993FonVNXDl6LC+1d/FoaxPt5UW+PLeMi46pJOXKvUcQuZuhS61YMy7Hnn7p5sZYNj4/kPsMWAB10J0VZvIthDEIQOuI0sMno5pfQuwnU/G2IHrdJj3/hRC9tQGRAkwH5j3ezg/+3M4sqvnq8KFMzmT46uK3qKkr47oTPkEhihmohBA91xuxq0bHkchKx5XXNZC2Xd5Yt4wz/3YvV4wYz6l1tbQEHg81tXDD6jXUjwm5+dxaZo5KUvyAVeb+BYH2O5A1s3CPvx/Ry6Cmo406LEwSVmZA7pEBx20IK9OBCi7pey8M7EOvRdjl+03o/ragdSxsSsX5JWGk8UKNKWNSn8/fsoHv/KqTKyrHc9PkCYxLZ3ijK88buU4+Omo0Qsb7pvG9NEopwigmgwyiIE4K780RBgqBz4whI/nIyAZ+s3YN6z0PheCT9fU8MHM6IzZVcez31vPHf7STcMUe52fZbVA+wi6Pv/P+9H0quGSgwgc7my1juH9GBXf0ajujYgLWzKvRfif7qwZ8LzSQsATFQHHajet59inNXTOmcUp9LZ1BnDn2cmcHZUmbmYMbtsgw26H7a4USBp+fNoPVfp5/tLdjCUFbGGBLg2unjOeb1WO54D9aufGhVhw3duHs39BovxNr5tUYFRP62lDhHRjun3fmjjsfuVZq/wpaL+t9a437f5jjz0GX2nb6lnsTjikIlObsX65nxasm/z3zAEYlUrSGQbzA05oX29uYUV9LbSZLsBMsjvnAZ+bQERw/ZgS3r1tHMYqwhIgTmPyQzw0bwvVjJvDd33Vy7QMtOI7YO3x9OwldasMcfw7WuP/Xr1Evo9T6lZ29585/3GRtF1HpS/0DE+xDfo6sm9NTE3b//TUbMuYT/9rtjbz5suC2GZOosR26ehgWLCFYXSzxVr6bo0aMQvbslAwUWmu0tDnngOms9Qu81NmFIyUCUGhaA5/j62q5bux4rvlDB//1VBuOu71giH0JAX4nsm4O9iE/39ysFUSlL5Gs2+nggF37vZnJZ9DRN/u6KU3sw64FtxrCPPujEAoBTkLyH4+2cc9jHv8xaQKD7ATdPcIHYAvBK50dZFIus4cOx98FDtti6DNt8DAOHlLL/ZsaibTeYtDbg4Djamq5qmE0l/6ujX+8lSfh7k9qUMTfpVuNfdi1PbUEe6Cjb2Imn9mVu+/6J5XWtVoFd/a+NbLjcY68DS2tuODNfiaECVfy0jsFfvyXDq4cMZqpmTJy/YRPABGwoLOTybVV1GeyhDvBfNoLpRSWneS0iRNY0NXBykIR6z0x+x1hyKeHDuYTycF88debWNfivU/Q596EgKiElhbOkbdhZMf3HdEquBNpXburT9gtPzVVaLoIHS7pfW/Uz8Ge8x9oFe43RJcAliEolCK+cXsTR1m1fKyulu73RDebQtAWBCzL55hdPxjTtHa5sHMxDDlyxBiqyhI80dKC9Z45VmtNLlR8c8xwyppSfOtPzWj0vl8ZqwCtQuw5/4FRP2dzuw6XqELTRdu/cMexWwTQSA9pAz2Xfmz71ohTsA68Eh3k9ovQLQFYruDGR9toXGZw8cgGfKW3Ei5LCFYVipSEZuagwcS7ZrsmgGEUUVNWyXGjR/FkazOdYYT5HiEMtMISBj+eOJan/xny2+c6cPYlJY+O0EEO68ArsUac0v/AOtBz4+9817H7jA1hrUEFHwfdRy5tT7kQ84BvoL19755xHcmStSVuebCTixqGU2e7+NtYWBhS8mZ3F9UplxEVlYQDdL9sG5pQC04aO55m5fN6V9dW07AA8lHEhHSarw4Zzr//tZ3lG70dy0Tb7dBorxPzgG9gT7mwf3seFZyCsNbsriftXmtX2q/qsHhe/5Wxc+DlmJO/gi617rNQfinieL4f3dfCeD/L8bU15LaRWCSAUGve6OpkUm0V2WQGtZsSfIthyNS6IUyqqeKJlmboYXF4LzrDkDOH1lPfneHnf2/v2bXZLV3YMWiFLrViTv4KzoGXb9keFs9D2q/tzsft9uWWMJN/1lHpa1sI4awfYk6+CO2175Pp2HUkL7yT5+n5Pl9uaEAiUNvQyKYQdAQBa0pFptfVYRi7bv/1IlIRrpPgpDFjeLmzg02+v9U0DPEPIClNrhg7knueKfLYotze04I6QnvtmJMvwpn1w37tCh2VvibM5E45m98Pe2S9L8zkTSj/0i2F8AdY0y9D+7ke8vO9M6hCxNtuv/h7K9NEBUdUVeBvZ1VrSsmaYokiiim19cRp+LtHAAVQihQfGTmayBS81rn1NAxQbpo0hyX+uKERw4YoFHvBehGgQrSfw5p+Gc6sH2w+pBUo71JhJm/aE0/ecw4nw/25VsGVWziqZ3wb66CrQXl7zUUjBXi+ojpp8Wq+i1+vW4MlISW3DoU0hWBpLkc2ZeVhvvYAAA0SSURBVNNQUdWTgL79G4v32nG9sfjb+Vh+GDKysprp9dU829ZKpGM2BQ0YQlBlWcxvb+KEF17k9WQzj10zmBOmpyjtUtzeByF2taA8rIOuxp7x7c2HtEKr4EqMxM+3f/2uYY96PIXh/IjIv2wLIZzyVaw5t8Q0A3vBWR0pMA3Jr86r5ycXZvlp40rOeGk+b3a3UWFaWEL2KRilNYu7uxmRzZJNbJnUtMXnkoKw4OF3F2IhFCCkJPIDChtaUUGE2IYLRWmFZbocN3IEb+W6afQ8DAEpw8AW8PNlb/P1teupnDCRoWU2I2osgj1qNsdOZi0l1pxbsKd8dfMhrSDyLxOG86M92YM973I33Z+91ya0Rp2Kc/SdYJf3BDDsaSHUSENw2BiHoRVJEtNncP7Klfz4nUUEOqTMNDGFIB9FrCjmmFJbh2M627T/hBCoSFPa1EF+XSulli6EkKggpLCxDa8tR6mlq4e0ZevPVVKKOQ0jwRK82ZWj1rJZW8xx9qsv84Cb4i/zbuMvP/sJSzea/OvtHNYeqxcp4rG3y3GPvvM9TKaxzYfp/mxPPb0Xe2XPR5jJm3RUPBt0X5K7UT8Hd+49yNpZaK+FPW7oSHjgpXaSqcE8Me+X3PmrX/PPqlpOf2U+z7U0UmVbdAQh7VHIpOoa1PZ+FFJQau0iLPkIAaXmTvIbWslvaCUs+kjTxO8s4LXnt6kF/SikoaKGKbVVvNTZzp/Xr+KMBQtoOPY4nv/jHRw+50OMHT6CEQ1jefrNeLh2/89To70WZO0s3Ln3bOlkRnfrqHj2nrL53ou9tukozNSdqGALZ7XMTsCdew/muM/FUTQqYE8MtxCgQs3zS/JMnTAJN1nG0Ycfwfw7/sQnz/8qX1+7nkvfeJ2XO9uwLJNRlTXbrKErpCDoLuK352J7r8fm8zsLhAV/83QsoNTSRdBdjM/rB6UUtu0yd8RI/rqpkR915vj+1d/nr9deT211DbqtFSNTzodnH8ILSz068ruzlpuIdzdKbZjjPhcrgOyEfsf1OlQwV5ipO7d7i92MvbvrLe0XiILD0dHiXo0npIVz2A3Yh10P0kL7uz/f2DIEzR0h72zUHDptGhgmqqMD13H54bcu5fHf/5F3x03ksuUrGJxJMqSsbOv4PyFQSlNq6UL3lhrvPSTFltpOCKIgJOjaNqlnEGlmDB5MJuHwi8uu4PzzvhjXFy4U4lGJNEfNPoh1HTYrGn3M3TQNa78DpIV92PU4h92A6Mvj0aCjxUT+4Uj7hd3ztB3D3g+7MOxVUXHDIVqFWxAWWuM/jzP3/nhKLrXuVm1oGrC8sUTOTzBj8iR68w6V76Pb2zlo+nSe/cMfOPjQw6hxHJKWy1apCj0rVrsijZBy6+P9T40UVsrBrS7bpmHhRQEjq2qZVlXOmg3rIV9A9y/Y5nkcNHES5RXD+MdbOaSxKyPRq/VakbWzcObejzX+81v2V4W3R8UNh2A4q3b6MTuJfRL3YySH5YS0PosOL+vvmDYqJ+Eeew/WtEvjWLrdpQ2l4JXlebLZQYxtaIBgc4CEBigUCDwPwy9wQHUNhmFuW8C0xsmmSA6uit0n29gl0ZFGWibJ+kqkbW2TxChSmrSTZmZNDU+9+Dyl7m6E0U/NhQGZmlpmTD6A59/uxg/0TpNear8DrTXWtEtxj70Ho3JS/86CDi8T0vqskRw2wPLuuwf7NvBMmD/TYelotHqnb0o2bOwDL8c9/gFk3aHoUkuPz3AnH9GTNPTaigITx02kIlsF0XuYXi2LVevXs3HdWibX179vYraOFHZ5kuSgynja7X+y1ghDkBpciZGwY6227buggCOGj2DdqndZsXZtHCHbAxXTnnLEzBks2SjY2BZgDtQOjEroUguy7lDc4x/APvDyzfV60aDVOzosHY0w9/hK9/2wzyMfhZV6Gq/9MFR0e/+VsFE1DXfuvViH/BSc6p695IFv40kp6MyFLFkfccD4cWDbW2s302TxuysIuroYWVlF+AF71v2FEBmTVtJTTixRX4GZdtEfEMRaiiKm1A8hUSrwwqJFYBhbTrOez4cOnEExyvLm6iLGjtqBOorHyqnGOuSnuHPvxaia1v8EUNHteO2HCSu1TdrcvYl9LoAAuFWtSPOzRP6ZWqvVvc1CSOyJ5+Oe8CDmpPPRWsXT8gD2Zy0D1rT4tBVtZk6aCJHe2i4TglcWL2ZEwqY2U75DAag6Uli9QigEOlIkastxsskPFD6Iq3tWp8uYWlHGi2+8DmG45c5KEDBy8FAaho7kxaX53m6+T4d0z3SrMCfFY2ZPPH+LKpVaq9VE/plI87O4Va0f2Mm9gP1DAHthOH9Wfucsrfzf9deGMjUEZ/ZPcOfeiznyVNDhDmfgSSlYsraItCoYN2LkVtOvEBJ8j9ffWsyYikpSTmLHAxB6NWF9FremDLsyw44Sq2itMQyL2YMH8eZbi2htbWMLNacijHSGg6dOY/6yErlihLFNCYwz1dAh5shTcefeizP7J8jUkC3PUf7vlN85C8PZ7QEFu4L9SwABw6loEtI+h6h0Mip6pb+2M6pn4Bzxa5xj/oox/GSI/JgmTr8/afjrq4oMqR/KkOqauL5VPwjTpKOznRXvrmBCZSVyewuQ7UBHCrssRaK2PNZCA/CnB1pz8NBh5DZtYMmqd7e2AxEcPmM66zos1rUG/dwxoidypQMiH2P4yTjH/BXniF9jbEEQqUFFrxCVThbSPsdwKpp2vHd7B/udAPbBSDxA86JDUeFFaLVxi0O1s3CP+g3ucQ9gjv0MCBPttW1VTEeImIrj7bUlJo8Zh5lIbV2l0LZYunIFrZsaGV9Xu/0dkPeB1nqbK+IPgh9FDK+qpVKHzF+8GKTc0nHthxwwYRxKlrNodREpBYSF+LMKE3PsZ3CPewD3qN9g1M56T6fURlR4Ec2LDsVIPDDgzu0l7L8CCFA3LcSwbibomq4j/+dotYVfRlZPx5lzA+5Jj2NNvQRRNhrttcUUwsrHkIK2XMS7zZpJo0eDYWyt3aTgifnPo4sBo6pqiHYhAWmgUFpRlkgxtaqSF15/HYJgSwEMfRoGDWHkkJE8+WorqtiKUT4Ga+oluCc9jjPnBmT19C1vqlWHjvyfE3RNx7Bupm7a/lHcZTvYcXq2fQk72yTgUuV33CLN5L8hzHMRsqz3sMyMwJ55BXraJUQbnyVc8d+oppexgnWsXKfoyBtMHTMW1JZhqNIwCHKdPPr8PxmSMqlNZQh3JQB1OwEI2z9dI6TFgYMGc/OKJbS0tVNdWQG+H0/nQYBIuHz40Nmsa0rAUZfi1B8VE8VvdTPVhY5+o8L8jdLOrt4fajzvCP5nCGAPpJ1dDVyM13kzVvJzCOMLCDG41/4TZgJz2HGYw45Dda9GdMynrfE26utX0lBXA36weQUtBFgWa1esYNGy5RxbU0XCSRDs5bSBQCmmDxlCbsEbvLHsHY4+5BAIQrAttONAZSUXX/MD7EzZNq7WoPVGdPQbgsLvcMpXSDu7V/u/q/gfJYB9cMpXAFdRaLxeO5VnCykvAGNyf+0jM8MhM5y53zidaaetpsp20J4PORUvRIIQkpKFy5bQ3l5gyriR2KaNH+7CjLWj2k+pHt+hxit5DDNd6k3J0o0bObqiAlFTDckkwo3pj7fSZVoD0WKt1Dzhtd1Jsr4Np3zn+70P8T9TAHuRrG8XcDNwM2HxOAzrEyBPR4hsr1Y0gCENw/suEUqhCwVEsQhS8m5TE6lUipEVVahcnijw420x09xye0yIbb/uj/7Td7/XOoogDOP/WiOSSaTrgutijRtHor6e333lQuomTYVUapvLoDAMEehOKflvocJ7MBOPCANI1g942PYnDJygcj+HDtqzyMSZQlpHgjg5jFTCMIytwqJ6USwWaWltIdXcSLK5nTCXQ3V2EjY2otp7CvwoFduPYdj3Gq37ttriMCxBbxFiYZr0L0gsKyow6+uR5eWIZBJr2DDMIUMQySTCfh9bLdaSJbR+aP369c+sWLb4jiM+cvz/DPanHcT/OgHcAmG+esmy1WeOGjlqmm2aH8cwYhrXHZgqdRCgS6W+/6pQQHV1ofP5uM330Z4X385xELaNsCxEKoUsK0P2TKHCsvr+fxCiKEJKiYiiVoS8lyB4AxX9iWSyedcGYv/F/24B7I+mphqy2WFo/TksqwalPoKUtbonWqH/ltVeQe+4RxHK85qEZT357qp3m51k6vdDbHsttbX/a4WuP/7vCOB70dhYqyorq99evvyActc+Zuiw4Rmt9XAdhpOEZSWFaUqEiLcjdg0arYUOQ6WDoCBM8y2EWK3a2nLAY8K23yjNn9+SPO64/W6XYm/g/64AbgNNF1yQLD///IPMIUPSRlWVjNrbjyCKPoKUQ4VtlwnHsTBN2Wfz9U7lPStarRSEodKeF2jf70KpdRjGU0ZFxbNRa6sK16/Pdd566yu18+ZtO1T6/yD+P7wJWv7HpKFyAAAAAElFTkSuQmCC",cc.loader.loadBinary=function(t,e){var i=this,n=this.getXMLHttpRequest(),r="load "+t+" failed!";n.open("GET",t,!0),cc.loader.loadBinary._IEFilter?(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=cc._convertResponseBodyToText(n.responseBody);e(null,i._str2Uint8Array(t))}else e(r)}):(n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.onload=function(){4===n.readyState&&200===n.status?e(null,i._str2Uint8Array(n.responseText)):e(r)}),n.send(null)},cc.loader.loadBinary._IEFilter=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&window.IEBinaryToArray_ByteStr&&window.IEBinaryToArray_ByteStr_Last,cc.loader._str2Uint8Array=function(t){if(!t)return null;for(var e=new Uint8Array(t.length),i=0;i<t.length;i++)e[i]=255&t.charCodeAt(i);return e},cc.loader.loadBinarySync=function(t){var e=this,i=this.getXMLHttpRequest(),n="load "+t+" failed!";i.open("GET",t,!1);var r=null;if(cc.loader.loadBinary._IEFilter){if(i.setRequestHeader("Accept-Charset","x-user-defined"),i.send(null),200!==i.status)return cc.log(n),null;var o=cc._convertResponseBodyToText(i.responseBody);o&&(r=e._str2Uint8Array(o))}else{if(i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.send(null),200!==i.status)return cc.log(n),null;r=this._str2Uint8Array(i.responseText)}return r},window.Uint8Array=window.Uint8Array||window.Array,cc.loader.loadBinary._IEFilter){var IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',myVBScript=document.createElement("script");myVBScript.type="text/vbscript",myVBScript.textContent=IEBinaryToArray_ByteStr_Script,document.body.appendChild(myVBScript),cc._convertResponseBodyToText=function(t){for(var e={},i=0;i<256;i++)for(var n=0;n<256;n++)e[String.fromCharCode(i+256*n)]=String.fromCharCode(i)+String.fromCharCode(n);var r=IEBinaryToArray_ByteStr(t),o=IEBinaryToArray_ByteStr_Last(t);return r.replace(/[\s\S]/g,function(t){return e[t]})+o}}var cc=cc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};switch(function(){var t=/\b_super\b/;cc.Class=function(){},cc.Class.extend=function(e){function i(){this.__instanceId=ClassManager.getNewInstanceId(),this.ctor&&this.ctor.apply(this,arguments)}var n=this.prototype,r=Object.create(n),o=ClassManager.getNewID();ClassManager[o]=n;var s={writable:!0,enumerable:!1,configurable:!0};r.__instanceId=null,i.id=o,s.value=o,Object.defineProperty(r,"__pid",s),i.prototype=r,s.value=i,Object.defineProperty(i.prototype,"constructor",s),this.__getters__&&(i.__getters__=cc.clone(this.__getters__)),this.__setters__&&(i.__setters__=cc.clone(this.__setters__));for(var c=0,a=arguments.length;c<a;++c){var l=arguments[c];for(var h in l){var u="function"==typeof l[h],d="function"==typeof n[h],_=t.test(l[h]);if(u&&d&&_?(s.value=function(t,e){return function(){var i=this._super;this._super=n[t];var r=e.apply(this,arguments);return this._super=i,r}}(h,l[h]),Object.defineProperty(r,h,s)):u?(s.value=l[h],Object.defineProperty(r,h,s)):r[h]=l[h],u){var p,f,m;if(this.__getters__&&this.__getters__[h]){m=this.__getters__[h];for(var g in this.__setters__)if(this.__setters__[g]===m){f=g;break}cc.defineGetterSetter(r,m,l[h],l[f]?l[f]:r[f],h,f)}if(this.__setters__&&this.__setters__[h]){m=this.__setters__[h];for(var g in this.__getters__)if(this.__getters__[g]===m){p=g;break}cc.defineGetterSetter(r,m,l[p]?l[p]:r[p],l[h],p,h)}}}}return i.extend=cc.Class.extend,i.implement=function(t){for(var e in t)r[e]=t[e]},i}}(),cc.defineGetterSetter=function(t,e,i,n,r,o){if(t.__defineGetter__)i&&t.__defineGetter__(e,i),n&&t.__defineSetter__(e,n);else{if(!Object.defineProperty)throw new Error("browser does not support getters");var s={enumerable:!1,configurable:!0};i&&(s.get=i),n&&(s.set=n),Object.defineProperty(t,e,s)}if(!r&&!o)for(var c=null!=i,a=void 0!=n,l=Object.getOwnPropertyNames(t),h=0;h<l.length;h++){var u=l[h];if((t.__lookupGetter__?!t.__lookupGetter__(u):!Object.getOwnPropertyDescriptor(t,u))&&"function"==typeof t[u]){var d=t[u];if(c&&d===i&&(r=u,!a||o))break;if(a&&d===n&&(o=u,!c||r))break}}var _=t.constructor;r&&(_.__getters__||(_.__getters__={}),_.__getters__[r]=e),o&&(_.__setters__||(_.__setters__={}),_.__setters__[o]=e)},cc.clone=function(t){var e=t.constructor?new t.constructor:{};for(var i in t){var n=t[i];"object"!=typeof n||!n||n instanceof cc.Node||n instanceof HTMLElement?e[i]=n:e[i]=cc.clone(n)}return e},cc.inject=function(t,e){for(var i in t)e[i]=t[i]},cc.Point=function(t,e){this.x=t||0,this.y=e||0},cc.p=function(t,e){return void 0===t?{x:0,y:0}:void 0===e?{x:t.x,y:t.y}:{x:t,y:e}},cc.pointEqualToPoint=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y},cc.Size=function(t,e){this.width=t||0,this.height=e||0},cc.size=function(t,e){return void 0===t?{width:0,height:0}:void 0===e?{width:t.width,height:t.height}:{width:t,height:e}},cc.sizeEqualToSize=function(t,e){return t&&e&&t.width===e.width&&t.height===e.height},cc.Rect=function(t,e,i,n){this.x=t||0,this.y=e||0,this.width=i||0,this.height=n||0},cc.rect=function(t,e,i,n){return void 0===t?{x:0,y:0,width:0,height:0}:void 0===e?{x:t.x,y:t.y,width:t.width,height:t.height}:{x:t,y:e,width:i,height:n}},cc.rectEqualToRect=function(t,e){return t&&e&&t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},cc._rectEqualToZero=function(t){return t&&0===t.x&&0===t.y&&0===t.width&&0===t.height},cc.rectContainsRect=function(t,e){return!(!t||!e)&&!(t.x>=e.x||t.y>=e.y||t.x+t.width<=e.x+e.width||t.y+t.height<=e.y+e.height)},cc.rectGetMaxX=function(t){return t.x+t.width},cc.rectGetMidX=function(t){return t.x+t.width/2},cc.rectGetMinX=function(t){return t.x},cc.rectGetMaxY=function(t){return t.y+t.height},cc.rectGetMidY=function(t){return t.y+t.height/2},cc.rectGetMinY=function(t){return t.y},cc.rectContainsPoint=function(t,e){return e.x>=cc.rectGetMinX(t)&&e.x<=cc.rectGetMaxX(t)&&e.y>=cc.rectGetMinY(t)&&e.y<=cc.rectGetMaxY(t)},cc.rectIntersectsRect=function(t,e){var i=t.x+t.width,n=t.y+t.height,r=e.x+e.width,o=e.y+e.height;return!(i<e.x||r<t.x||n<e.y||o<t.y)},cc.rectOverlapsRect=function(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},cc.rectUnion=function(t,e){var i=cc.rect(0,0,0,0);return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i},cc.rectIntersection=function(t,e){var i=cc.rect(Math.max(cc.rectGetMinX(t),cc.rectGetMinX(e)),Math.max(cc.rectGetMinY(t),cc.rectGetMinY(e)),0,0);return i.width=Math.min(cc.rectGetMaxX(t),cc.rectGetMaxX(e))-cc.rectGetMinX(i),i.height=Math.min(cc.rectGetMaxY(t),cc.rectGetMaxY(e))-cc.rectGetMinY(i),i},cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(t){return this._parseXML(t)},_parseXML:function(t){var e;return this._isSupportDOMParser?e=this._parser.parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)),e}}),cc.PlistParser=cc.SAXParser.extend({parse:function(t){var e=this._parseXML(t),i=e.documentElement;if("plist"!==i.tagName)return cc.warn("Not a plist file!"),{};for(var n=null,r=0,o=i.childNodes.length;r<o&&(n=i.childNodes[r],1!==n.nodeType);r++);return e=null,this._parseNode(n)},_parseNode:function(t){var e=null,i=t.tagName;if("dict"===i)e=this._parseDict(t);else if("array"===i)e=this._parseArray(t);else if("string"===i)if(1===t.childNodes.length)e=t.firstChild.nodeValue;else{e="";for(var n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].nodeValue}else"false"===i?e=!1:"true"===i?e=!0:"real"===i?e=parseFloat(t.firstChild.nodeValue):"integer"===i&&(e=parseInt(t.firstChild.nodeValue,10));return e},_parseArray:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var r=t.childNodes[i];1===r.nodeType&&e.push(this._parseNode(r))}return e},_parseDict:function(t){for(var e={},i=null,n=0,r=t.childNodes.length;n<r;n++){var o=t.childNodes[n];1===o.nodeType&&("key"===o.tagName?i=o.firstChild.nodeValue:e[i]=this._parseNode(o))}return e}}),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser,cc._txtLoader={load:function(t,e,i,n){cc.loader.loadTxt(t,n)}},cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader),cc._jsonLoader={load:function(t,e,i,n){cc.loader.loadJson(t,n)}},cc.loader.register(["json","ExportJson"],cc._jsonLoader),cc._jsLoader={load:function(t,e,i,n){cc.loader.loadJs(t,n)}},cc.loader.register(["js"],cc._jsLoader),cc._imgLoader={load:function(t,e,i,n){var r;r=cc.loader.isLoading(t)?n:function(t,i){return t?n(t):(cc.loader.cache[e]=i,cc.textureCache.handleLoadedTexture(e),void n(null,i))},cc.loader.loadImg(t,r)}},cc.loader.register(["png","jpg","bmp","jpeg","gif","ico","tiff","webp"],cc._imgLoader),cc._serverImgLoader={load:function(t,e,i,n){cc._imgLoader.load(i.src,e,i,n)}},cc.loader.register(["serverImg"],cc._serverImgLoader),cc._plistLoader={load:function(t,e,i,n){cc.loader.loadTxt(t,function(t,e){return t?n(t):void n(null,cc.plistParser.parse(e))})}},cc.loader.register(["plist"],cc._plistLoader),cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".ttc":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(t,e,i){var n=document,r=cc.path,o=this.TYPE,s=document.createElement("style");s.type="text/css",n.body.appendChild(s);var c="";if(c+=isNaN(t-0)?"@font-face { font-family:"+t+"; src:":"@font-face { font-family:'"+t+"'; src:",e instanceof Array)for(var a=0,l=e.length;a<l;a++){var h=e[a];i=r.extname(h).toLowerCase(),c+="url('"+e[a]+"') format('"+o[i]+"')",c+=a===l-1?";":","}else i=i.toLowerCase(),c+="url('"+e+"') format('"+o[i]+"');";s.textContent+=c+"}";var u=document.createElement("div"),d=u.style;d.fontFamily=t,u.innerHTML=".",d.position="absolute",d.left="-100px",d.top="-100px",n.body.appendChild(u)},load:function(t,e,i,n){var r=this,o=i.type,s=i.name,c=i.srcs;cc.isString(i)?(o=cc.path.extname(i),s=cc.path.basename(i,o),r._loadFont(s,i,o)):r._loadFont(s,c),document.fonts?document.fonts.load("1em "+s).then(function(){n(null,!0)},function(t){n(t)}):n(null,!0)}},cc.loader.register(["font","eot","ttf","woff","svg","ttc"],cc._fontLoader),cc._binaryLoader={load:function(t,e,i,n){cc.loader.loadBinary(t,n)}},cc._csbLoader={load:function(t,e,i,n){cc.loader.loadCsb(t,n)}},cc.loader.register(["csb"],cc._csbLoader),window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.13",cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,cc.DIRECTOR_STATS_POSITION=cc.p(0,0),cc.DIRECTOR_FPS_INTERVAL=.5,cc.COCOSNODE_RENDER_SUBPIXEL=1,cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1,cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=1,cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,cc.TEXTURE_ATLAS_USE_VAO=0,cc.TEXTURE_NPOT_SUPPORT=0,cc.RETINA_DISPLAY_SUPPORT=1,cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd",cc.USE_LA88_LABELS=1,cc.SPRITE_DEBUG_DRAW=0,cc.SPRITEBATCHNODE_DEBUG_DRAW=0,cc.LABELBMFONT_DEBUG_DRAW=0,cc.LABELATLAS_DEBUG_DRAW=0,cc.IS_RETINA_DISPLAY_SUPPORTED=1,cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas",cc.ENABLE_STACKABLE_ACTIONS=1,cc.ENABLE_GL_STATE_CACHE=1,cc.$=function(t){var e=this===cc?document:this,i=t instanceof HTMLElement?t:e.querySelector(t);return i&&(i.find=i.find||cc.$,i.hasClass=i.hasClass||function(t){return this.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},i.addClass=i.addClass||function(t){return this.hasClass(t)||(this.className&&(this.className+=" "),this.className+=t),this},i.removeClass=i.removeClass||function(t){return this.hasClass(t)&&(this.className=this.className.replace(t,"")),this},i.remove=i.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),this},i.appendTo=i.appendTo||function(t){return t.appendChild(this),this},i.prependTo=i.prependTo||function(t){return t.childNodes[0]?t.insertBefore(this,t.childNodes[0]):t.appendChild(this),this},i.transforms=i.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},i.position=i.position||{x:0,y:0},i.rotation=i.rotation||0,i.scale=i.scale||{x:1,y:1},i.skew=i.skew||{x:0,y:0},i.translates=function(t,e){return this.position.x=t,this.position.y=e,this.transforms(),this},i.rotate=function(t){return this.rotation=t,this.transforms(),this},i.resize=function(t,e){return this.scale.x=t,this.scale.y=e,this.transforms(),this},i.setSkew=function(t,e){return this.skew.x=t,this.skew.y=e,this.transforms(),this}),i},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit",cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O",cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms",cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(t){return"translate3d("+t.x+"px, "+t.y+"px, 0) "}:function(t){return"translate("+t.x+"px, "+t.y+"px) "},cc.$.rotate=cc.$.hd?function(t){return"rotateZ("+t+"deg) "}:function(t){return"rotate("+t+"deg) "},cc.$.scale=function(t){return"scale("+t.x+", "+t.y+") "},cc.$.skew=function(t){return"skewX("+-t.x+"deg) skewY("+t.y+"deg)"},cc.$new=function(t){return cc.$(document.createElement(t))},cc.$.findpos=function(t){var e=0,i=0;do{e+=t.offsetLeft,i+=t.offsetTop}while(t=t.offsetParent);return{x:e,y:i}},cc.INVALID_INDEX=-1,cc.PI=Math.PI,cc.FLT_MAX=parseFloat("3.402823466e+38F"),cc.FLT_MIN=parseFloat("1.175494351e-38F"),cc.RAD=cc.PI/180,cc.DEG=180/cc.PI,cc.UINT_MAX=4294967295,cc.swap=function(t,e,i){if(!cc.isObject(i)||cc.isUndefined(i.x)||cc.isUndefined(i.y))cc.log(cc._LogInfos.swap);else{var n=i[t];i[t]=i[e],i[e]=n}},cc.lerp=function(t,e,i){return t+(e-t)*i},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(t){return t*cc.RAD},cc.radiansToDegrees=function(t){return t*cc.DEG},cc.radiansToDegress=function(t){return cc.log(cc._LogInfos.radiansToDegress),t*cc.DEG},cc.REPEAT_FOREVER=Number.MAX_VALUE-1,cc.nodeDrawSetup=function(t){t._shaderProgram&&(t._shaderProgram.use(),t._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.enableDefaultGLStates=function(){},cc.disableDefaultGLStates=function(){},cc.incrementGLDraws=function(t){cc.g_NumberOfDraws+=t},cc.FLT_EPSILON=1.192092896e-7,cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor()}:function(){return 1},cc.pointPointsToPixels=function(t){var e=cc.contentScaleFactor();return cc.p(t.x*e,t.y*e)},cc.pointPixelsToPoints=function(t){var e=cc.contentScaleFactor();return cc.p(t.x/e,t.y/e)},cc._pointPixelsToPointsOut=function(t,e){var i=cc.contentScaleFactor();e.x=t.x/i,e.y=t.y/i},cc.sizePointsToPixels=function(t){var e=cc.contentScaleFactor();return cc.size(t.width*e,t.height*e)},cc.sizePixelsToPoints=function(t){var e=cc.contentScaleFactor();return cc.size(t.width/e,t.height/e)},cc._sizePixelsToPointsOut=function(t,e){var i=cc.contentScaleFactor();e.width=t.width/i,e.height=t.height/i},cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(t){var e=cc.contentScaleFactor();return cc.rect(t.x/e,t.y/e,t.width/e,t.height/e)}:function(t){return t},cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(t){var e=cc.contentScaleFactor();return cc.rect(t.x*e,t.y*e,t.width*e,t.height*e)}:function(t){return t},cc.ONE=1,cc.ZERO=0,cc.SRC_ALPHA=770,cc.SRC_ALPHA_SATURATE=776,cc.SRC_COLOR=768,cc.DST_ALPHA=772,cc.DST_COLOR=774,cc.ONE_MINUS_SRC_ALPHA=771,cc.ONE_MINUS_SRC_COLOR=769,cc.ONE_MINUS_DST_ALPHA=773,cc.ONE_MINUS_DST_COLOR=775,cc.ONE_MINUS_CONSTANT_ALPHA=32772,cc.ONE_MINUS_CONSTANT_COLOR=32770,cc.LINEAR=9729,cc.REPEAT=10497,cc.CLAMP_TO_EDGE=33071,cc.MIRRORED_REPEAT=33648,cc.BLEND_SRC=cc.SRC_ALPHA,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA&&(cc.BLEND_SRC=cc.ONE)}),cc.BLEND_DST=cc.ONE_MINUS_SRC_ALPHA,cc.checkGLErrorDebug=function(){if(cc.renderMode===cc.game.RENDER_TYPE_WEBGL){var t=cc._renderContext.getError();t&&cc.log(cc._LogInfos.checkGLErrorDebug,t)}},cc.ORIENTATION_PORTRAIT=1,cc.ORIENTATION_LANDSCAPE=2,cc.ORIENTATION_AUTO=3,cc.VERTEX_ATTRIB_FLAG_NONE=0,cc.VERTEX_ATTRIB_FLAG_POSITION=1,cc.VERTEX_ATTRIB_FLAG_COLOR=2,cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4,cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS,cc.GL_ALL=0,cc.VERTEX_ATTRIB_POSITION=0,cc.VERTEX_ATTRIB_COLOR=1,cc.VERTEX_ATTRIB_TEX_COORDS=2,cc.VERTEX_ATTRIB_MAX=7,cc.UNIFORM_PMATRIX=0,cc.UNIFORM_MVMATRIX=1,cc.UNIFORM_MVPMATRIX=2,cc.UNIFORM_TIME=3,cc.UNIFORM_SINTIME=4,cc.UNIFORM_COSTIME=5,cc.UNIFORM_RANDOM01=6,cc.UNIFORM_SAMPLER=7,cc.UNIFORM_MAX=8,cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor",cc.SHADER_SPRITE_POSITION_TEXTURECOLOR="ShaderSpritePositionTextureColor",cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest",cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST="ShaderSpritePositionTextureColorAlphaTest",cc.SHADER_POSITION_COLOR="ShaderPositionColor",cc.SHADER_SPRITE_POSITION_COLOR="ShaderSpritePositionColor",cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture",cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor",cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color",cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor",cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor",cc.UNIFORM_PMATRIX_S="CC_PMatrix",cc.UNIFORM_MVMATRIX_S="CC_MVMatrix",cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix",cc.UNIFORM_TIME_S="CC_Time",cc.UNIFORM_SINTIME_S="CC_SinTime",cc.UNIFORM_COSTIME_S="CC_CosTime",cc.UNIFORM_RANDOM01_S="CC_Random01",cc.UNIFORM_SAMPLER_S="CC_Texture0",cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value",cc.ATTRIBUTE_NAME_COLOR="a_color",cc.ATTRIBUTE_NAME_POSITION="a_position",cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord",cc.ATTRIBUTE_NAME_MVMAT="a_mvMatrix",cc.ITEM_SIZE=32,cc.CURRENT_ITEM=3233828865,cc.ZOOM_ACTION_TAG=3233828866,cc.NORMAL_TAG=8801,cc.SELECTED_TAG=8802,cc.DISABLE_TAG=8803,cc.arrayVerifyType=function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.log("element type is wrong!"),!1;return!0},cc.arrayRemoveObject=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);break}},cc.arrayRemoveArray=function(t,e){for(var i=0,n=e.length;i<n;i++)cc.arrayRemoveObject(t,e[i])},cc.arrayAppendObjectsToIndex=function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},cc.copyArray=function(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e+=1)n[e]=t[e];return n},cc._tmp.PrototypeColor=function(){var t=cc.color;t._getWhite=function(){return t(255,255,255)},t._getYellow=function(){return t(255,255,0)},t._getBlue=function(){return t(0,0,255)},t._getGreen=function(){return t(0,255,0)},t._getRed=function(){return t(255,0,0)},t._getMagenta=function(){return t(255,0,255)},t._getBlack=function(){return t(0,0,0)},t._getOrange=function(){return t(255,127,0)},t._getGray=function(){return t(166,166,166)},t.WHITE,cc.defineGetterSetter(t,"WHITE",t._getWhite),t.YELLOW,cc.defineGetterSetter(t,"YELLOW",t._getYellow),t.BLUE,cc.defineGetterSetter(t,"BLUE",t._getBlue),t.GREEN,cc.defineGetterSetter(t,"GREEN",t._getGreen),t.RED,cc.defineGetterSetter(t,"RED",t._getRed),t.MAGENTA,cc.defineGetterSetter(t,"MAGENTA",t._getMagenta),t.BLACK,cc.defineGetterSetter(t,"BLACK",t._getBlack),t.ORANGE,cc.defineGetterSetter(t,"ORANGE",t._getOrange),t.GRAY,cc.defineGetterSetter(t,"GRAY",t._getGray),cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA)},cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)},cc.BlendFunc.DISABLE,cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable),cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied),cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied),cc.BlendFunc.ADDITIVE,cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive)};var cc=cc||{};cc._tmp=cc._tmp||{},cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){cc.color=function(t,e,i,n,r,o){if(void 0===t)return new cc.Color(0,0,0,255,r,o);if(cc.isString(t)){var s=cc.hexToColor(t);return new cc.Color(s.r,s.g,s.b,s.a)}return cc.isObject(t)?new cc.Color(t.r,t.g,t.b,t.a,t.arrayBuffer,t.offset):new cc.Color(t,e,i,n,r,o)},cc.Color=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset;this._view=new Uint8Array(s,c,4),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0,this._view[3]=null==n?255:n,void 0===n&&(this.a_undefined=!0)},cc.Color.BYTES_PER_ELEMENT=4;var t=cc.Color.prototype;t._getR=function(){return this._view[0]},t._setR=function(t){this._view[0]=t<0?0:t},t._getG=function(){return this._view[1]},t._setG=function(t){this._view[1]=t<0?0:t},t._getB=function(){return this._view[2]},t._setB=function(t){this._view[2]=t<0?0:t},t._getA=function(){return this._view[3]},t._setA=function(t){this._view[3]=t<0?0:t},t.r,cc.defineGetterSetter(t,"r",t._getR,t._setR),t.g,cc.defineGetterSetter(t,"g",t._getG,t._setG),t.b,cc.defineGetterSetter(t,"b",t._getB,t._setB),t.a,cc.defineGetterSetter(t,"a",t._getA,t._setA),cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js"),cc._tmp.PrototypeColor(),delete cc._tmp.PrototypeColor}}),cc.Color=function(t,e,i,n){this.r=t||0,this.g=e||0,this.b=i||0,this.a=null==n?255:n},cc.color=function(t,e,i,n){return void 0===t?{r:0,g:0,b:0,a:255}:cc.isString(t)?cc.hexToColor(t):cc.isObject(t)?{r:t.r,g:t.g,b:t.b,a:null==t.a?255:t.a}:{r:t,g:e,b:i,a:null==n?255:n}},cc.colorEqual=function(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b},cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},cc.Vertex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Vertex2F.BYTES_PER_ELEMENT=8,_p=cc.Vertex2F.prototype,_p._getX=function(){return this._view[0]},_p._setX=function(t){this._view[0]=t},_p._getY=function(){return this._view[1]},_p._setY=function(t){this._view[1]=t},_p.x,cc.defineGetterSetter(_p,"x",_p._getX,_p._setX),_p.y,cc.defineGetterSetter(_p,"y",_p._getY,_p._setY),cc.Vertex3F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._view=new Float32Array(o,s,3),this._view[0]=t||0,this._view[1]=e||0,this._view[2]=i||0},cc.Vertex3F.BYTES_PER_ELEMENT=12,_p=cc.Vertex3F.prototype,_p._getX=function(){return this._view[0]},_p._setX=function(t){this._view[0]=t},_p._getY=function(){return this._view[1]},_p._setY=function(t){this._view[1]=t},_p._getZ=function(){return this._view[2]},_p._setZ=function(t){this._view[2]=t},_p.x,cc.defineGetterSetter(_p,"x",_p._getX,_p._setX),_p.y,cc.defineGetterSetter(_p,"y",_p._getY,_p._setY),_p.z,cc.defineGetterSetter(_p,"z",_p._getZ,_p._setZ),cc.Tex2F=function(t,e,i,n){this._arrayBuffer=i||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT),this._offset=n||0,this._view=new Float32Array(this._arrayBuffer,this._offset,2),this._view[0]=t||0,this._view[1]=e||0},cc.Tex2F.BYTES_PER_ELEMENT=8,_p=cc.Tex2F.prototype,_p._getU=function(){return this._view[0]},_p._setU=function(t){this._view[0]=t},_p._getV=function(){return this._view[1]},_p._setV=function(t){this._view[1]=t},_p.u,cc.defineGetterSetter(_p,"u",_p._getU,_p._setU),_p.v,cc.defineGetterSetter(_p,"v",_p._getV,_p._setV),cc.Quad2=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=t?new cc.Vertex2F(t.x,t.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._tr=e?new cc.Vertex2F(e.x,e.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._bl=i?new cc.Vertex2F(i.x,i.y,s,c):new cc.Vertex2F(0,0,s,c),c+=a,this._br=n?new cc.Vertex2F(n.x,n.y,s,c):new cc.Vertex2F(0,0,s,c)},cc.Quad2.BYTES_PER_ELEMENT=32,_p=cc.Quad2.prototype,_p._getTL=function(){return this._tl},_p._setTL=function(t){this._tl._view[0]=t.x,this._tl._view[1]=t.y},_p._getTR=function(){return this._tr},_p._setTR=function(t){this._tr._view[0]=t.x,this._tr._view[1]=t.y},_p._getBL=function(){return this._bl},_p._setBL=function(t){this._bl._view[0]=t.x,this._bl._view[1]=t.y},_p._getBR=function(){return this._br},_p._setBR=function(t){this._br._view[0]=t.x,this._br._view[1]=t.y},_p.tl,cc.defineGetterSetter(_p,"tl",_p._getTL,_p._setTL),_p.tr,cc.defineGetterSetter(_p,"tr",_p._getTR,_p._setTR),_p.bl,cc.defineGetterSetter(_p,"bl",_p._getBL,_p._setBL),_p.br,cc.defineGetterSetter(_p,"br",_p._getBR,_p._setBR),cc.Quad3=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.Quad3.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset,a=cc.Vertex3F.BYTES_PER_ELEMENT;this.bl=t?new cc.Vertex3F(t.x,t.y,t.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.br=e?new cc.Vertex3F(e.x,e.y,e.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tl=i?new cc.Vertex3F(i.x,i.y,i.z,s,c):new cc.Vertex3F(0,0,0,s,c),c+=a,this.tr=n?new cc.Vertex3F(n.x,n.y,n.z,s,c):new cc.Vertex3F(0,0,0,s,c)},cc.Quad3.BYTES_PER_ELEMENT=48,cc.V3F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex3F(t.x,t.y,t.z,o,s):new cc.Vertex3F(0,0,0,o,s),s+=cc.Vertex3F.BYTES_PER_ELEMENT,this._colors=e?new cc.Color(e.r,e.g,e.b,e.a,o,s):new cc.Color(0,0,0,0,o,s),s+=cc.Color.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s):new cc.Tex2F(0,0,o,s)},cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24,_p=cc.V3F_C4B_T2F.prototype,_p._getVertices=function(){return this._vertices},_p._setVertices=function(t){var e=this._vertices;e._view[0]=t.x,e._view[1]=t.y,e._view[2]=t.z},_p._getColor=function(){return this._colors},_p._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},_p._getTexCoords=function(){return this._texCoords},_p._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},_p.vertices,cc.defineGetterSetter(_p,"vertices",_p._getVertices,_p._setVertices),_p.colors,cc.defineGetterSetter(_p,"colors",_p._getColor,_p._setColor),_p.texCoords,cc.defineGetterSetter(_p,"texCoords",_p._getTexCoords,_p._setTexCoords),cc.V3F_C4B_T2F_Quad=function(t,e,i,n,r,o){this._arrayBuffer=r||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT),this._offset=o||0;var s=this._arrayBuffer,c=this._offset,a=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=t?new cc.V3F_C4B_T2F(t.vertices,t.colors,t.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._bl=e?new cc.V3F_C4B_T2F(e.vertices,e.colors,e.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._tr=i?new cc.V3F_C4B_T2F(i.vertices,i.colors,i.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c),c+=a,this._br=n?new cc.V3F_C4B_T2F(n.vertices,n.colors,n.texCoords,s,c):new cc.V3F_C4B_T2F(null,null,null,s,c)},cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96,_p=cc.V3F_C4B_T2F_Quad.prototype,_p._getTL=function(){return this._tl},_p._setTL=function(t){var e=this._tl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getBL=function(){return this._bl},_p._setBL=function(t){var e=this._bl;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getTR=function(){return this._tr},_p._setTR=function(t){var e=this._tr;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getBR=function(){return this._br},_p._setBR=function(t){var e=this._br;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getArrayBuffer=function(){return this._arrayBuffer},_p.tl,cc.defineGetterSetter(_p,"tl",_p._getTL,_p._setTL),_p.tr,cc.defineGetterSetter(_p,"tr",_p._getTR,_p._setTR),_p.bl,cc.defineGetterSetter(_p,"bl",_p._getBL,_p._setBL),_p.br,cc.defineGetterSetter(_p,"br",_p._getBR,_p._setBR),_p.arrayBuffer,cc.defineGetterSetter(_p,"arrayBuffer",_p._getArrayBuffer,null),cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad},cc.V3F_C4B_T2F_QuadCopy=function(t){if(!t)return cc.V3F_C4B_T2F_QuadZero();var e=t.tl,i=t.bl,n=t.tr,r=t.br;return{tl:{vertices:{x:e.vertices.x,y:e.vertices.y,z:e.vertices.z},colors:{r:e.colors.r,g:e.colors.g,b:e.colors.b,a:e.colors.a},texCoords:{u:e.texCoords.u,v:e.texCoords.v}},bl:{vertices:{x:i.vertices.x,y:i.vertices.y,z:i.vertices.z},colors:{r:i.colors.r,g:i.colors.g,b:i.colors.b,a:i.colors.a},texCoords:{u:i.texCoords.u,v:i.texCoords.v}},tr:{vertices:{x:n.vertices.x,y:n.vertices.y,z:n.vertices.z},colors:{r:n.colors.r,g:n.colors.g,b:n.colors.b,a:n.colors.a},texCoords:{u:n.texCoords.u,v:n.texCoords.v}},br:{vertices:{x:r.vertices.x,y:r.vertices.y,z:r.vertices.z},colors:{r:r.colors.r,g:r.colors.g,b:r.colors.b,a:r.colors.a},texCoords:{u:r.texCoords.u,v:r.texCoords.v}}}},cc.V3F_C4B_T2F_QuadsCopy=function(t){if(!t)return[];for(var e=[],i=0;i<t.length;i++)e.push(cc.V3F_C4B_T2F_QuadCopy(t[i]));return e},cc.V2F_C4B_T2F=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset;this._vertices=t?new cc.Vertex2F(t.x,t.y,o,s):new cc.Vertex2F(0,0,o,s),s+=cc.Vertex2F.BYTES_PER_ELEMENT,this._colors=e?cc.color(e.r,e.g,e.b,e.a,o,s):cc.color(0,0,0,0,o,s),s+=cc.Color.BYTES_PER_ELEMENT,this._texCoords=i?new cc.Tex2F(i.u,i.v,o,s):new cc.Tex2F(0,0,o,s)},cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20,_p=cc.V2F_C4B_T2F.prototype,_p._getVertices=function(){return this._vertices},_p._setVertices=function(t){this._vertices._view[0]=t.x,this._vertices._view[1]=t.y},_p._getColor=function(){return this._colors},_p._setColor=function(t){var e=this._colors;e._view[0]=t.r,e._view[1]=t.g,e._view[2]=t.b,e._view[3]=t.a},_p._getTexCoords=function(){return this._texCoords},_p._setTexCoords=function(t){this._texCoords._view[0]=t.u,this._texCoords._view[1]=t.v},_p.vertices,cc.defineGetterSetter(_p,"vertices",_p._getVertices,_p._setVertices),_p.colors,cc.defineGetterSetter(_p,"colors",_p._getColor,_p._setColor),_p.texCoords,cc.defineGetterSetter(_p,"texCoords",_p._getTexCoords,_p._setTexCoords),cc.V2F_C4B_T2F_Triangle=function(t,e,i,n,r){this._arrayBuffer=n||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT),this._offset=r||0;var o=this._arrayBuffer,s=this._offset,c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=t?new cc.V2F_C4B_T2F(t.vertices,t.colors,t.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),s+=c,this._b=e?new cc.V2F_C4B_T2F(e.vertices,e.colors,e.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s),s+=c,this._c=i?new cc.V2F_C4B_T2F(i.vertices,i.colors,i.texCoords,o,s):new cc.V2F_C4B_T2F(null,null,null,o,s)},cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60,_p=cc.V2F_C4B_T2F_Triangle.prototype,_p._getA=function(){return this._a},_p._setA=function(t){var e=this._a;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getB=function(){return this._b},_p._setB=function(t){var e=this._b;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p._getC=function(){return this._c},_p._setC=function(t){var e=this._c;e.vertices=t.vertices,e.colors=t.colors,e.texCoords=t.texCoords},_p.a,cc.defineGetterSetter(_p,"a",_p._getA,_p._setA),_p.b,cc.defineGetterSetter(_p,"b",_p._getB,_p._setB),_p.c,cc.defineGetterSetter(_p,"c",_p._getC,_p._setC),cc.vertex2=function(t,e){return new cc.Vertex2F(t,e)},cc.vertex3=function(t,e,i){return new cc.Vertex3F(t,e,i)},cc.tex2=function(t,e){return new cc.Tex2F(t,e)},cc.BlendFunc=function(t,e){this.src=t,this.dst=e},cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.hexToColor=function(t){t=t.replace(/^#?/,"0x");var e=parseInt(t),i=e>>16,n=(e>>8)%256,r=e%256;return cc.color(i,n,r)},cc.colorToHex=function(t){var e=t.r.toString(16),i=t.g.toString(16),n=t.b.toString(16);return"#"+(t.r<16?"0"+e:e)+(t.g<16?"0"+i:i)+(t.b<16?"0"+n:n)},cc.TEXT_ALIGNMENT_LEFT=0,cc.TEXT_ALIGNMENT_CENTER=1,cc.TEXT_ALIGNMENT_RIGHT=2,cc.VERTICAL_TEXT_ALIGNMENT_TOP=0,cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1,cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={},this._valueMapTb={},this.__currId=2<<(0|10*Math.random())},__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(t,e){if(null!=e){var i=this.__getKey();this._keyMapTb[i]=e,this._valueMapTb[i]=t}},objectForKey:function(t){if(null==t)return null;var e=this._keyMapTb;for(var i in e)if(e[i]===t)return this._valueMapTb[i];return null},valueForKey:function(t){return this.objectForKey(t)},removeObjectForKey:function(t){if(null!=t){var e=this._keyMapTb;for(var i in e)if(e[i]===t)return delete this._valueMapTb[i],void delete e[i]}},removeObjectsForKeys:function(t){if(null!=t)for(var e=0;e<t.length;e++)this.removeObjectForKey(t[e])},allKeys:function(){var t=[],e=this._keyMapTb;for(var i in e)t.push(e[i]);return t},removeAllObjects:function(){this._keyMapTb={},this._valueMapTb={}},count:function(){return this.allKeys().length}}),cc.FontDefinition=function(t){var e=this;if(e.fontName="Arial",e.fontSize=12,e.textAlign=cc.TEXT_ALIGNMENT_CENTER,e.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP,e.fillStyle=cc.color(255,255,255,255),e.boundingWidth=0,e.boundingHeight=0,e.strokeEnabled=!1,e.strokeStyle=cc.color(255,255,255,255),e.lineWidth=1,e.lineHeight="normal",e.fontStyle="normal",e.fontWeight="normal",e.shadowEnabled=!1,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowOpacity=1,t&&t instanceof Object)for(var i in t)e[i]=t[i]},cc.FontDefinition.prototype._getCanvasFontStr=function(){var t=this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px";return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+t+" '"+this.fontName+"'"},cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_CANVAS&&(cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js"),cc._tmp.PrototypeColor(),delete cc._tmp.PrototypeColor)}),cc.Touches=[],cc.TouchesIntergerDict={},cc.DENSITYDPI_DEVICE="device-dpi",cc.DENSITYDPI_HIGH="high-dpi",cc.DENSITYDPI_MEDIUM="medium-dpi",cc.DENSITYDPI_LOW="low-dpi";var __BrowserGetter={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(t){return t&&t!==this.html?t.clientWidth:window.innerWidth},availHeight:function(t){return t&&t!==this.html?t.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(window.navigator.userAgent.indexOf("OS 8_1_")>-1&&(__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_MIUI),cc.sys.os===cc.sys.OS_IOS&&(__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),__BrowserGetter.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:__BrowserGetter.meta["minimal-ui"]="true",__BrowserGetter.availWidth=function(t){return t.clientWidth},__BrowserGetter.availHeight=function(t){return t.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:__BrowserGetter.__defineGetter__("target-densitydpi",function(){return cc.view._targetDensityDPI});case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:__BrowserGetter.availWidth=function(t){return t.clientWidth},__BrowserGetter.availHeight=function(t){return t.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:__BrowserGetter.init=function(t){if(!t.__resizeWithBrowserSize){var e=function(){t.setDesignResolutionSize(t._designResolutionSize.width,t._designResolutionSize.height,t._resolutionPolicy),window.removeEventListener("resize",e,!1)};window.addEventListener("resize",e,!1)}}}var _scissorRect=cc.rect();cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!1,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_isRotated:!1,_orientation:3,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var t=this,e=document,i=cc.ContainerStrategy,n=cc.ContentStrategy;__BrowserGetter.init(this),t._frame=cc.container.parentNode===e.body?e.documentElement:cc.container.parentNode,t._frameSize=cc.size(0,0),t._initFrameSize();var r=cc._canvas.width,o=cc._canvas.height;t._designResolutionSize=cc.size(r,o),t._originalDesignResolutionSize=cc.size(r,o),t._viewPortRect=cc.rect(0,0,r,o),t._visibleRect=cc.rect(0,0,r,o),t._contentTranslateLeftTop={left:0,top:0},t._viewName="Cocos2dHTML5";var s=cc.sys;t.enableRetina(s.os===s.OS_IOS||s.os===s.OS_OSX),t.enableAutoFullScreen(s.isMobile&&s.browserType!==s.BROWSER_TYPE_BAIDU),cc.visibleRect&&cc.visibleRect.init(t._visibleRect),t._rpExactFit=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.EXACT_FIT),t._rpShowAll=new cc.ResolutionPolicy(i.PROPORTION_TO_FRAME,n.SHOW_ALL),t._rpNoBorder=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.NO_BORDER),t._rpFixedHeight=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_HEIGHT),t._rpFixedWidth=new cc.ResolutionPolicy(i.EQUAL_TO_FRAME,n.FIXED_WIDTH),t._targetDensityDPI=cc.DENSITYDPI_HIGH},_resizeEvent:function(){var t;t=this.setDesignResolutionSize?this:cc.view;var e=t._frameSize.width,i=t._frameSize.height,n=t._isRotated;if(t._initFrameSize(),t._isRotated!==n||t._frameSize.width!==e||t._frameSize.height!==i){t._resizeCallback&&t._resizeCallback.call();var r=t._originalDesignResolutionSize.width,o=t._originalDesignResolutionSize.height;r>0&&t.setDesignResolutionSize(r,o,t._resolutionPolicy)}},setTargetDensityDPI:function(t){this._targetDensityDPI=t,this._adjustViewportMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(t){t?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,window.addEventListener("resize",this._resizeEvent),window.addEventListener("orientationchange",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._resizeEvent))},setResizeCallback:function(t){(cc.isFunction(t)||null==t)&&(this._resizeCallback=t)},setOrientation:function(t){t&=cc.ORIENTATION_AUTO,t&&(this._orientation=t)},_initFrameSize:function(){var t=this._frameSize,e=__BrowserGetter.availWidth(this._frame),i=__BrowserGetter.availHeight(this._frame),n=e>=i;!cc.sys.isMobile||n&&this._orientation&cc.ORIENTATION_LANDSCAPE||!n&&this._orientation&cc.ORIENTATION_PORTRAIT?(t.width=e,t.height=i,cc.container.style["-webkit-transform"]="rotate(0deg)",cc.container.style.transform="rotate(0deg)",this._isRotated=!1):(t.width=i,t.height=e,cc.container.style["-webkit-transform"]="rotate(90deg)",cc.container.style.transform="rotate(90deg)",cc.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0)},_adjustSizeKeepCanvasSize:function(){var t=this._originalDesignResolutionSize.width,e=this._originalDesignResolutionSize.height;t>0&&this.setDesignResolutionSize(t,e,this._resolutionPolicy)},_setViewportMeta:function(t,e){var i=document.getElementById("cocosMetaElement");i&&e&&document.head.removeChild(i);var n,r,o,s=document.getElementsByName("viewport"),c=s?s[0]:null;n=c?c.content:"",i=i||document.createElement("meta"),i.id="cocosMetaElement",i.name="viewport",i.content="";for(r in t)n.indexOf(r)==-1?n+=","+r+"="+t[r]:e&&(o=new RegExp(r+"s*=s*[^,]+"),n.replace(o,r+"="+t[r]));/^,/.test(n)&&(n=n.substr(1)),i.content=n,c&&(c.content=n),document.head.appendChild(i)},_adjustViewportMeta:function(){this._isAdjustViewPort&&(this._setViewportMeta(__BrowserGetter.meta,!1),this._isAdjustViewPort=!1)},_setScaleXYForRenderTexture:function(){var t=cc.contentScaleFactor();this._scaleX=t,this._scaleY=t},_resetScale:function(){this._scaleX=this._originalScaleX,this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(t){this._isAdjustViewPort=t},enableRetina:function(t){this._retinaEnabled=!!t},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(t){t&&t!==this._autoFullScreen&&cc.sys.isMobile&&this._frame===document.documentElement?(this._autoFullScreen=!0,cc.screen.autoFullScreen(this._frame)):this._autoFullScreen=!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},end:function(){},isOpenGLReady:function(){return cc.game.canvas&&cc._renderContext},setFrameZoomFactor:function(t){this._frameZoomFactor=t,this.centerWindow(),cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(t){},setContentTranslateLeftTop:function(t,e){this._contentTranslateLeftTop={left:t,top:e}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getCanvasSize:function(){return cc.size(cc._canvas.width,cc._canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(t,e){this._frameSize.width=t,this._frameSize.height=e,this._frame.style.width=t+"px",this._frame.style.height=e+"px",this._resizeEvent(),cc.director.setProjection(cc.director.getProjection())},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.p(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(t){var e=this;if(t instanceof cc.ResolutionPolicy)e._resolutionPolicy=t;else{var i=cc.ResolutionPolicy;t===i.EXACT_FIT&&(e._resolutionPolicy=e._rpExactFit),t===i.SHOW_ALL&&(e._resolutionPolicy=e._rpShowAll),t===i.NO_BORDER&&(e._resolutionPolicy=e._rpNoBorder),t===i.FIXED_HEIGHT&&(e._resolutionPolicy=e._rpFixedHeight),t===i.FIXED_WIDTH&&(e._resolutionPolicy=e._rpFixedWidth)}},setDesignResolutionSize:function(t,e,i){if(!(t>0||e>0))return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(!n)return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);n.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._initFrameSize(),this._originalDesignResolutionSize.width=this._designResolutionSize.width=t,this._originalDesignResolutionSize.height=this._designResolutionSize.height=e;var r=n.apply(this,this._designResolutionSize);if(r.scale&&2===r.scale.length&&(this._scaleX=r.scale[0],this._scaleY=r.scale[1]),r.viewport){var o=this._viewPortRect,s=this._visibleRect,c=r.viewport;o.x=c.x,o.y=c.y,o.width=c.width,o.height=c.height,s.x=-o.x/this._scaleX,s.y=-o.y/this._scaleY,s.width=cc._canvas.width/this._scaleX,s.height=cc._canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(o.x,-o.y)}var a=cc.director;a._winSizeInPoints.width=this._designResolutionSize.width,a._winSizeInPoints.height=this._designResolutionSize.height,n.postApply(this),cc.winSize.width=a._winSizeInPoints.width,cc.winSize.height=a._winSizeInPoints.height,cc._renderType===cc.game.RENDER_TYPE_WEBGL&&a.setGLDefaultValues(),this._originalScaleX=this._scaleX,this._originalScaleY=this._scaleY,cc.DOM&&cc.DOM._resetEGLViewDiv(),cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(t,e,i){this._setViewportMeta({width:t,"target-densitydpi":cc.DENSITYDPI_DEVICE},!0),document.body.style.width=t+"px",document.body.style.left="0px",document.body.style.top="0px",this.setDesignResolutionSize(t,e,i)},setViewPortInPoints:function(t,e,i,n){var r=this._frameZoomFactor,o=this._scaleX,s=this._scaleY;cc._renderContext.viewport(t*o*r+this._viewPortRect.x*r,e*s*r+this._viewPortRect.y*r,i*o*r,n*s*r)},setScissorInPoints:function(t,e,i,n){var r=this._frameZoomFactor,o=this._scaleX,s=this._scaleY;_scissorRect.x=t,_scissorRect.y=e,_scissorRect.width=i,_scissorRect.height=n,cc._renderContext.scissor(t*o*r+this._viewPortRect.x*r,e*s*r+this._viewPortRect.y*r,i*o*r,n*s*r)},isScissorEnabled:function(){return cc._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){return cc.rect(_scissorRect)},setViewName:function(t){null!=t&&t.length>0&&(this._viewName=t)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(t,e,i){var n=this._devicePixelRatio*(t-i.left),r=this._devicePixelRatio*(i.top+i.height-e);return this._isRotated?{x:this._viewPortRect.width-r,y:n}:{x:n,y:r}},_convertMouseToLocationInView:function(t,e){var i=this._viewPortRect,n=this;t.x=(n._devicePixelRatio*(t.x-e.left)-i.x)/n._scaleX,t.y=(n._devicePixelRatio*(e.top+e.height-t.y)-i.y)/n._scaleY},_convertPointWithScale:function(t){var e=this._viewPortRect;t.x=(t.x-e.x)/this._scaleX,t.y=(t.y-e.y)/this._scaleY},_convertTouchesWithScale:function(t){for(var e,i,n,r=this._viewPortRect,o=this._scaleX,s=this._scaleY,c=0;c<t.length;c++)e=t[c],i=e._point,n=e._prevPoint,i.x=(i.x-r.x)/o,i.y=(i.y-r.y)/s,n.x=(n.x-r.x)/o,n.y=(n.y-r.y)/s}}),cc.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize()),this._instance},cc.ContainerStrategy=cc.Class.extend({preApply:function(t){},apply:function(t,e){},postApply:function(t){},_setupContainer:function(t,e,i){var n=cc.game.canvas,r=cc.game.container;r.style.width=n.style.width=e+"px",r.style.height=n.style.height=i+"px";var o=t._devicePixelRatio=1;t.isRetinaEnabled()&&(o=t._devicePixelRatio=Math.min(2,window.devicePixelRatio||1)),n.width=e*o,n.height=i*o,cc._renderContext.resetCache&&cc._renderContext.resetCache()},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var t=document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden";var e=cc.container.style;e.position="fixed",e.left=e.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(t,e,i,n,r,o){Math.abs(t-i)<2&&(i=t),Math.abs(e-n)<2&&(n=e);var s=cc.rect(Math.round((t-i)/2),Math.round((e-n)/2),i,n);return cc._renderType===cc.game.RENDER_TYPE_CANVAS,this._result.scale=[r,o],this._result.viewport=s,this._result},preApply:function(t){},apply:function(t,e){return{scale:[1,1]}},postApply:function(t){}}),function(){var t=cc.ContainerStrategy.extend({apply:function(t){var e=t._frameSize.height,i=cc.container.style;this._setupContainer(t,t._frameSize.width,t._frameSize.height),t._isRotated?i.marginLeft=e+"px":i.margin="0px"}}),e=cc.ContainerStrategy.extend({apply:function(t,e){var i,n,r=t._frameSize.width,o=t._frameSize.height,s=cc.container.style,c=e.width,a=e.height,l=r/c,h=o/a;l<h?(i=r,n=a*l):(i=c*h,n=o);var u=Math.round((r-i)/2),d=Math.round((o-n)/2);i=r-2*u,n=o-2*d,this._setupContainer(t,i,n),t._isRotated?s.marginLeft=o+"px":s.margin="0px",s.paddingLeft=u+"px",s.paddingRight=u+"px",s.paddingTop=d+"px",s.paddingBottom=d+"px"}}),i=(t.extend({preApply:function(t){this._super(t),t._frame=document.documentElement},apply:function(t){this._super(t),this._fixContainer()}}),e.extend({preApply:function(t){this._super(t),t._frame=document.documentElement},apply:function(t,e){this._super(t,e),this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(t){this._setupContainer(t,cc._canvas.width,cc._canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=new t,cc.ContainerStrategy.PROPORTION_TO_FRAME=new e,cc.ContainerStrategy.ORIGINAL_CONTAINER=new i;var n=cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height,r=i/e.width,o=n/e.height;return this._buildResult(i,n,i,n,r,o)}}),r=cc.ContentStrategy.extend({apply:function(t,e){var i,n,r=cc._canvas.width,o=cc._canvas.height,s=e.width,c=e.height,a=r/s,l=o/c,h=0;return a<l?(h=a,i=r,n=c*h):(h=l,i=s*h,n=o),this._buildResult(r,o,i,n,h,h)}}),o=cc.ContentStrategy.extend({apply:function(t,e){var i,n,r,o=cc._canvas.width,s=cc._canvas.height,c=e.width,a=e.height,l=o/c,h=s/a;return l<h?(i=h,n=c*i,r=s):(i=l,n=o,r=a*i),this._buildResult(o,s,n,r,i,i)}}),s=cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height,r=e.height,o=n/r,s=i,c=n;return this._buildResult(i,n,s,c,o,o)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}}),c=cc.ContentStrategy.extend({apply:function(t,e){var i=cc._canvas.width,n=cc._canvas.height,r=e.width,o=i/r,s=i,c=n;return this._buildResult(i,n,s,c,o,o)},postApply:function(t){cc.director._winSizeInPoints=t.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new n,cc.ContentStrategy.SHOW_ALL=new r,cc.ContentStrategy.NO_BORDER=new o,cc.ContentStrategy.FIXED_HEIGHT=new s,cc.ContentStrategy.FIXED_WIDTH=new c}(),cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(t,e){this.setContainerStrategy(t),this.setContentStrategy(e)},preApply:function(t){this._containerStrategy.preApply(t),this._contentStrategy.preApply(t)},apply:function(t,e){return this._containerStrategy.apply(t,e),this._contentStrategy.apply(t,e)},postApply:function(t){this._containerStrategy.postApply(t),this._contentStrategy.postApply(t)},setContainerStrategy:function(t){t instanceof cc.ContainerStrategy&&(this._containerStrategy=t)},setContentStrategy:function(t){t instanceof cc.ContentStrategy&&(this._contentStrategy=t)}}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var t,e,i,n=this._fnMap;for(t=0,l=n.length;t<l;t++)if(e=n[t],e&&e[1]in document){for(t=0,i=e.length;t<i;t++)this._fn[n[0][t]]=e[t];break}this._supportsFullScreen="undefined"!=typeof this._fn.requestFullscreen,this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&(void 0!==document[this._fn.fullscreenElement]&&null!==document[this._fn.fullscreenElement])},requestFullScreen:function(t,e){if(this._supportsFullScreen){if(t=t||document.documentElement,e){var i=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(i,this._preOnFullScreenChange),this._preOnFullScreenChange=e,document.addEventListener(i,e,!1)}return t[this._fn.requestFullscreen]()}},exitFullScreen:function(){return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(t,e){function i(){n.removeEventListener(r._touchEvent,i),r.requestFullScreen(t,e)}t=t||document.body;var n=cc.game.canvas||t,r=this;this.requestFullScreen(t,e),n.addEventListener(this._touchEvent,i)}},cc.screen.init(),cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,r=t.y,o=r+i,s=n+e;this.topLeft.x=n,this.topLeft.y=o,this.topRight.x=s,this.topRight.y=o,this.top.x=n+e/2,this.top.y=o,this.bottomLeft.x=n,this.bottomLeft.y=r,this.bottomRight.x=s,this.bottomRight.y=r,this.bottom.x=n+e/2,this.bottom.y=r,this.center.x=n+e/2,this.center.y=r+i/2,this.left.x=n,this.left.y=r+i/2,this.right.x=s,this.right.y=r+i/2}},cc.UIInterfaceOrientationLandscapeLeft=-90,cc.UIInterfaceOrientationLandscapeRight=90,cc.UIInterfaceOrientationPortraitUpsideDown=180,cc.UIInterfaceOrientationPortrait=0,cc.inputManager={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var t=this._indexBitsUsed,e=0;e<this._maxTouches;e++){if(!(1&t))return this._indexBitsUsed|=1<<e,e;t>>=1}return-1},_removeUsedIndexBit:function(t){if(!(t<0||t>=this._maxTouches)){var e=1<<t;e=~e,this._indexBitsUsed&=e}},_glView:null,handleTouchesBegin:function(t){for(var e,i,n,r,o=[],s=this._touchesIntegerDict,c=0,a=t.length;c<a;c++)if(e=t[c],r=e.getID(),i=s[r],null==i){var l=this._getUnUsedIndex();if(l===-1){cc.log(cc._LogInfos.inputManager_handleTouchesBegin,l);continue}n=this._touches[l]=new cc.Touch(e._point.x,e._point.y,e.getID()),n._setPrevPoint(e._prevPoint),s[r]=l,o.push(n)}if(o.length>0){this._glView._convertTouchesWithScale(o);var h=new cc.EventTouch(o);h._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(h)}},handleTouchesMove:function(t){for(var e,i,n,r=[],o=this._touches,s=0,c=t.length;s<c;s++)e=t[s],n=e.getID(),i=this._touchesIntegerDict[n],null!=i&&o[i]&&(o[i]._setPoint(e._point),o[i]._setPrevPoint(e._prevPoint),r.push(o[i]));if(r.length>0){this._glView._convertTouchesWithScale(r);var a=new cc.EventTouch(r);a._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(a)}},handleTouchesEnd:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.EventTouch(e);i._eventCode=cc.EventTouch.EventCode.ENDED,cc.eventManager.dispatchEvent(i)}},handleTouchesCancel:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.EventTouch(e);i._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(i)}},getSetOfTouchesEndOrCancel:function(t){for(var e,i,n,r=[],o=this._touches,s=this._touchesIntegerDict,c=0,a=t.length;c<a;c++)e=t[c],n=e.getID(),i=s[n],null!=i&&o[i]&&(o[i]._setPoint(e._point),o[i]._setPrevPoint(e._prevPoint),r.push(o[i]),this._removeUsedIndexBit(i),delete s[n]);return r},getHTMLElementPosition:function(t){var e=document.documentElement,i=window,n=null;return n=cc.isFunction(t.getBoundingClientRect)?t.getBoundingClientRect():{left:0,top:0,width:parseInt(t.style.width),height:parseInt(t.style.height)},{left:n.left+i.pageXOffset-e.clientLeft,top:n.top+i.pageYOffset-e.clientTop,width:n.width,height:n.height}},getPreTouch:function(t){for(var e=null,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){e=i[r];break}return e||(e=t),e},setPreTouch:function(t){for(var e=!1,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){i[r]=t,e=!0;break}e||(i.length<=50?i.push(t):(i[this._preTouchPoolPointer]=t,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(t,e,i){var n=this._preTouchPoint,r=this._glView.convertToLocationInView(t,e,i),o=new cc.Touch(r.x,r.y);return o._setPrevPoint(n.x,n.y),n.x=r.x,n.y=r.y,o},getMouseEvent:function(t,e,i){var n=this._prevMousePoint;this._glView._convertMouseToLocationInView(t,e);var r=new cc.EventMouse(i);return r.setLocation(t.x,t.y),r._setPrevCursor(n.x,n.y),n.x=t.x,n.y=t.y,r},getPointByEvent:function(t,e){return null!=t.pageX?{x:t.pageX,y:t.pageY}:(e.left-=document.body.scrollLeft,e.top-=document.body.scrollTop,{x:t.clientX,y:t.clientY})},getTouchesByEvent:function(t,e){for(var i,n,r,o=[],s=this._glView,c=this._preTouchPoint,a=t.changedTouches.length,l=0;l<a;l++)if(i=t.changedTouches[l]){var h;h=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?s.convertToLocationInView(i.pageX,i.pageY,e):s.convertToLocationInView(i.clientX,i.clientY,e),null!=i.identifier?(n=new cc.Touch(h.x,h.y,i.identifier),r=this.getPreTouch(n).getLocation(),n._setPrevPoint(r.x,r.y),this.setPreTouch(n)):(n=new cc.Touch(h.x,h.y),n._setPrevPoint(c.x,c.y)),c.x=h.x,c.y=h.y,o.push(n)}return o},registerSystemEvent:function(t){if(!this._isRegisterEvent){var e=(this._glView=cc.view,this),i="mouse"in cc.sys.capabilities,n="touches"in cc.sys.capabilities,r=!1;if(cc.sys.isMobile&&(r=!0),i&&(window.addEventListener("mousedown",function(){e._mousePressed=!0},!1),window.addEventListener("mouseup",function(i){if(!r){var n=e._mousePressed;if(e._mousePressed=!1,n){var o=e.getHTMLElementPosition(t),s=e.getPointByEvent(i,o);if(!cc.rectContainsPoint(new cc.Rect(o.left,o.top,o.width,o.height),s)){e.handleTouchesEnd([e.getTouchByXY(s.x,s.y,o)]);var c=e.getMouseEvent(s,o,cc.EventMouse.UP);c.setButton(i.button),cc.eventManager.dispatchEvent(c)}}}},!1),t.addEventListener("mousedown",function(i){if(!r){e._mousePressed=!0;var n=e.getHTMLElementPosition(t),o=e.getPointByEvent(i,n);e.handleTouchesBegin([e.getTouchByXY(o.x,o.y,n)]);var s=e.getMouseEvent(o,n,cc.EventMouse.DOWN);s.setButton(i.button),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault(),t.focus()}},!1),t.addEventListener("mouseup",function(i){if(!r){e._mousePressed=!1;var n=e.getHTMLElementPosition(t),o=e.getPointByEvent(i,n);e.handleTouchesEnd([e.getTouchByXY(o.x,o.y,n)]);var s=e.getMouseEvent(o,n,cc.EventMouse.UP);s.setButton(i.button),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault()}},!1),t.addEventListener("mousemove",function(i){if(!r){var n=e.getHTMLElementPosition(t),o=e.getPointByEvent(i,n);e.handleTouchesMove([e.getTouchByXY(o.x,o.y,n)]);var s=e.getMouseEvent(o,n,cc.EventMouse.MOVE);e._mousePressed?s.setButton(i.button):s.setButton(null),cc.eventManager.dispatchEvent(s),i.stopPropagation(),i.preventDefault()}},!1),t.addEventListener("mousewheel",function(i){var n=e.getHTMLElementPosition(t),r=e.getPointByEvent(i,n),o=e.getMouseEvent(r,n,cc.EventMouse.SCROLL);o.setButton(i.button),o.setScrollData(0,i.wheelDelta),cc.eventManager.dispatchEvent(o),i.stopPropagation(),i.preventDefault()},!1),t.addEventListener("DOMMouseScroll",function(i){var n=e.getHTMLElementPosition(t),r=e.getPointByEvent(i,n),o=e.getMouseEvent(r,n,cc.EventMouse.SCROLL);o.setButton(i.button),o.setScrollData(0,i.detail*-120),cc.eventManager.dispatchEvent(o),i.stopPropagation(),i.preventDefault()},!1)),window.navigator.msPointerEnabled){var o={MSPointerDown:e.handleTouchesBegin,MSPointerMove:e.handleTouchesMove,MSPointerUp:e.handleTouchesEnd,MSPointerCancel:e.handleTouchesCancel};for(var s in o)!function(i,n){t.addEventListener(i,function(i){var r=e.getHTMLElementPosition(t);r.left-=document.documentElement.scrollLeft,r.top-=document.documentElement.scrollTop,n.call(e,[e.getTouchByXY(i.clientX,i.clientY,r)]),i.stopPropagation()},!1)}(s,o[s])}n&&(t.addEventListener("touchstart",function(i){if(i.changedTouches){var n=e.getHTMLElementPosition(t);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,e.handleTouchesBegin(e.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault(),t.focus()}},!1),t.addEventListener("touchmove",function(i){if(i.changedTouches){var n=e.getHTMLElementPosition(t);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,e.handleTouchesMove(e.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),t.addEventListener("touchend",function(i){if(i.changedTouches){var n=e.getHTMLElementPosition(t);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,e.handleTouchesEnd(e.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1),t.addEventListener("touchcancel",function(i){if(i.changedTouches){var n=e.getHTMLElementPosition(t);n.left-=document.body.scrollLeft,n.top-=document.body.scrollTop,e.handleTouchesCancel(e.getTouchesByEvent(i,n)),i.stopPropagation(),i.preventDefault()}},!1)),this._registerKeyboardEvent(),this._registerAccelerometerEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(t){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration))),this._accelCurTime+=t}},cc.AffineTransform=function(t,e,i,n,r,o){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=o},cc.affineTransformMake=function(t,e,i,n,r,o){return{a:t,b:e,c:i,d:n,tx:r,ty:o}},cc.pointApplyAffineTransform=function(t,e,i){var n,r;return void 0===i?(i=e,n=t.x,r=t.y):(n=t,r=e),{x:i.a*n+i.c*r+i.tx,y:i.b*n+i.d*r+i.ty}},cc._pointApplyAffineTransform=function(t,e,i){return cc.pointApplyAffineTransform(t,e,i)},cc.sizeApplyAffineTransform=function(t,e){return{width:e.a*t.width+e.c*t.height,height:e.b*t.width+e.d*t.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),r=cc.rectGetMaxX(t),o=cc.rectGetMaxY(t),s=cc.pointApplyAffineTransform(n,i,e),c=cc.pointApplyAffineTransform(r,i,e),a=cc.pointApplyAffineTransform(n,o,e),l=cc.pointApplyAffineTransform(r,o,e),h=Math.min(s.x,c.x,a.x,l.x),u=Math.max(s.x,c.x,a.x,l.x),d=Math.min(s.y,c.y,a.y,l.y),_=Math.max(s.y,c.y,a.y,l.y);return cc.rect(h,d,u-h,_-d)},cc._rectApplyAffineTransformIn=function(t,e){var i=cc.rectGetMinY(t),n=cc.rectGetMinX(t),r=cc.rectGetMaxX(t),o=cc.rectGetMaxY(t),s=cc.pointApplyAffineTransform(n,i,e),c=cc.pointApplyAffineTransform(r,i,e),a=cc.pointApplyAffineTransform(n,o,e),l=cc.pointApplyAffineTransform(r,o,e),h=Math.min(s.x,c.x,a.x,l.x),u=Math.max(s.x,c.x,a.x,l.x),d=Math.min(s.y,c.y,a.y,l.y),_=Math.max(s.y,c.y,a.y,l.y);return t.x=h,t.y=d,t.width=u-h,t.height=_-d,t},cc.affineTransformTranslate=function(t,e,i){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx+t.a*e+t.c*i,ty:t.ty+t.b*e+t.d*i}},cc.affineTransformScale=function(t,e,i){return{a:t.a*e,b:t.b*e,c:t.c*i,d:t.d*i,tx:t.tx,ty:t.ty}},cc.affineTransformRotate=function(t,e){var i=Math.sin(e),n=Math.cos(e);return{a:t.a*n+t.c*i,b:t.b*n+t.d*i,c:t.c*n-t.a*i,d:t.d*n-t.b*i,tx:t.tx,ty:t.ty}},cc.affineTransformConcat=function(t,e){return{a:t.a*e.a+t.b*e.c,b:t.a*e.b+t.b*e.d,c:t.c*e.a+t.d*e.c,d:t.c*e.b+t.d*e.d,tx:t.tx*e.a+t.ty*e.c+e.tx,ty:t.tx*e.b+t.ty*e.d+e.ty}},cc.affineTransformConcatIn=function(t,e){var i=t.a,n=t.b,r=t.c,o=t.d,s=t.tx,c=t.ty;return t.a=i*e.a+n*e.c,t.b=i*e.b+n*e.d,t.c=r*e.a+o*e.c,t.d=r*e.b+o*e.d,t.tx=s*e.a+c*e.c+e.tx,t.ty=s*e.b+c*e.d+e.ty,t},cc.affineTransformEqualToTransform=function(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty},cc.affineTransformInvert=function(t){var e=1/(t.a*t.d-t.b*t.c);return{a:e*t.d,b:-e*t.b,c:-e*t.c,d:e*t.a,tx:e*(t.c*t.ty-t.d*t.tx),ty:e*(t.b*t.tx-t.a*t.ty)}},cc.POINT_EPSILON=parseFloat("1.192092896e-07F"),cc.pNeg=function(t){return cc.p(-t.x,-t.y)},cc.pAdd=function(t,e){return cc.p(t.x+e.x,t.y+e.y)},cc.pSub=function(t,e){return cc.p(t.x-e.x,t.y-e.y)},cc.pMult=function(t,e){return cc.p(t.x*e,t.y*e)},cc.pMidpoint=function(t,e){return cc.pMult(cc.pAdd(t,e),.5)},cc.pDot=function(t,e){return t.x*e.x+t.y*e.y},cc.pCross=function(t,e){return t.x*e.y-t.y*e.x},cc.pPerp=function(t){return cc.p(-t.y,t.x)},cc.pRPerp=function(t){return cc.p(t.y,-t.x)},cc.pProject=function(t,e){return cc.pMult(e,cc.pDot(t,e)/cc.pDot(e,e))},cc.pRotate=function(t,e){return cc.p(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)},cc.pUnrotate=function(t,e){return cc.p(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},cc.pLengthSQ=function(t){return cc.pDot(t,t)},cc.pDistanceSQ=function(t,e){return cc.pLengthSQ(cc.pSub(t,e))},cc.pLength=function(t){return Math.sqrt(cc.pLengthSQ(t))},cc.pDistance=function(t,e){return cc.pLength(cc.pSub(t,e))},cc.pNormalize=function(t){var e=cc.pLength(t);return 0===e?cc.p(t):cc.pMult(t,1/e)},cc.pForAngle=function(t){return cc.p(Math.cos(t),Math.sin(t))},cc.pToAngle=function(t){return Math.atan2(t.y,t.x)},cc.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},cc.pClamp=function(t,e,i){return cc.p(cc.clampf(t.x,e.x,i.x),cc.clampf(t.y,e.y,i.y))},cc.pFromSize=function(t){return cc.p(t.width,t.height)},cc.pCompOp=function(t,e){return cc.p(e(t.x),e(t.y))},cc.pLerp=function(t,e,i){return cc.pAdd(cc.pMult(t,1-i),cc.pMult(e,i))},cc.pFuzzyEqual=function(t,e,i){return t.x-i<=e.x&&e.x<=t.x+i&&t.y-i<=e.y&&e.y<=t.y+i},cc.pCompMult=function(t,e){return cc.p(t.x*e.x,t.y*e.y)},cc.pAngleSigned=function(t,e){var i=cc.pNormalize(t),n=cc.pNormalize(e),r=Math.atan2(i.x*n.y-i.y*n.x,cc.pDot(i,n));return Math.abs(r)<cc.POINT_EPSILON?0:r},cc.pAngle=function(t,e){var i=Math.acos(cc.pDot(cc.pNormalize(t),cc.pNormalize(e)));return Math.abs(i)<cc.POINT_EPSILON?0:i},cc.pRotateByAngle=function(t,e,i){var n=cc.pSub(t,e),r=Math.cos(i),o=Math.sin(i),s=n.x;return n.x=s*r-n.y*o+e.x,n.y=s*o+n.y*r+e.y,n},cc.pLineIntersect=function(t,e,i,n,r){if(t.x===e.x&&t.y===e.y||i.x===n.x&&i.y===n.y)return!1;var o=e.x-t.x,s=e.y-t.y,c=n.x-i.x,a=n.y-i.y,l=t.x-i.x,h=t.y-i.y,u=a*o-c*s;return r.x=c*h-a*l,r.y=o*h-s*l,0===u?0===r.x||0===r.y:(r.x=r.x/u,r.y=r.y/u,!0)},cc.pSegmentIntersect=function(t,e,i,n){var r=cc.p(0,0);return!!(cc.pLineIntersect(t,e,i,n,r)&&r.x>=0&&r.x<=1&&r.y>=0&&r.y<=1)},cc.pIntersectPoint=function(t,e,i,n){var r=cc.p(0,0);if(cc.pLineIntersect(t,e,i,n,r)){var o=cc.p(0,0);return o.x=t.x+r.x*(e.x-t.x),o.y=t.y+r.x*(e.y-t.y),o}return cc.p(0,0)},cc.pSameAs=function(t,e){return null!=t&&null!=e&&(t.x===e.x&&t.y===e.y)},cc.pZeroIn=function(t){t.x=0,t.y=0},cc.pIn=function(t,e){t.x=e.x,t.y=e.y},cc.pMultIn=function(t,e){t.x*=e,t.y*=e},cc.pSubIn=function(t,e){t.x-=e.x,t.y-=e.y},cc.pAddIn=function(t,e){t.x+=e.x,t.y+=e.y},cc.pNormalizeIn=function(t){cc.pMultIn(t,1/Math.sqrt(t.x*t.x+t.y*t.y))},cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(t,e,i){this.setTouchInfo(i,t,e)},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return cc.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(t,e,i){this._prevPoint=this._point,this._point=cc.p(e||0,i||0),this._id=t,this._startPointCaptured||(this._startPoint=cc.p(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(t,e){void 0===e?(this._point.x=t.x,this._point.y=t.y):(this._point.x=t,this._point.y=e)},_setPrevPoint:function(t,e){void 0===e?this._prevPoint=cc.p(t.x,t.y):this._prevPoint=cc.p(t||0,e||0)}}),cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(t){this._currentTarget=t},ctor:function(t){this._type=t},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),cc.Event.TOUCH=0,cc.Event.KEYBOARD=1,cc.Event.ACCELERATION=2,cc.Event.MOUSE=3,cc.Event.FOCUS=4,cc.Event.CUSTOM=6,cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM),this._eventName=t},setUserData:function(t){this._userData=t},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE),this._eventType=t},setScrollData:function(t,e){this._scrollX=t,this._scrollY=e},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(t,e){this._x=t,this._y=e},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},_setPrevCursor:function(t,e){this._prevX=t,this._prevY=e},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(t){this._button=t},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),cc.EventMouse.NONE=0,cc.EventMouse.DOWN=1,cc.EventMouse.UP=2,cc.EventMouse.MOVE=3,cc.EventMouse.SCROLL=4,cc.EventMouse.BUTTON_LEFT=0,cc.EventMouse.BUTTON_RIGHT=2,cc.EventMouse.BUTTON_MIDDLE=1,cc.EventMouse.BUTTON_4=3,cc.EventMouse.BUTTON_5=4,cc.EventMouse.BUTTON_6=5,cc.EventMouse.BUTTON_7=6,cc.EventMouse.BUTTON_8=7,cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH),this._touches=t||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(t){this._eventCode=t},_setTouches:function(t){this._touches=t}}),cc.EventTouch.MAX_TOUCHES=5,cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(t,e){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS),this._widgetGetFocus=e,this._widgetLoseFocus=t}}),cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(t,e,i){this._onEvent=i,this._type=t||0,this._listenerID=e||""},_setPaused:function(t){this._paused=t},_isPaused:function(){return this._paused},_setRegistered:function(t){this._registered=t},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(t){this._fixedPriority=t},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(t){this._node=t},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.FOCUS=7,cc.EventListener.CUSTOM=8,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(t,e){this._onCustomEvent=e;var i=this,n=function(t){null!==i._onCustomEvent&&i._onCustomEvent(t)};cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,t,n)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerCustom.create=function(t,e){return new cc._EventListenerCustom(t,e)},cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var t=this,e=function(e){var i=cc.EventMouse;switch(e._eventType){case i.DOWN:t.onMouseDown&&t.onMouseDown(e);break;case i.UP:t.onMouseUp&&t.onMouseUp(e);break;case i.MOVE:t.onMouseMove&&t.onMouseMove(e);break;case i.SCROLL:t.onMouseScroll&&t.onMouseScroll(e)}};cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,e)},clone:function(){var t=new cc._EventListenerMouse;return t.onMouseDown=this.onMouseDown,t.onMouseUp=this.onMouseUp,t.onMouseMove=this.onMouseMove,t.onMouseScroll=this.onMouseScroll,t},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse},cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null),this._claimedTouches=[]},setSwallowTouches:function(t){this.swallowTouches=t},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var t=new cc._EventListenerTouchOneByOne;return t.onTouchBegan=this.onTouchBegan,t.onTouchMoved=this.onTouchMoved,t.onTouchEnded=this.onTouchEnded,t.onTouchCancelled=this.onTouchCancelled,t.swallowTouches=this.swallowTouches,t},checkAvailable:function(){return!!this.onTouchBegan||(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one",cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne},cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var t=new cc._EventListenerTouchAllAtOnce;return t.onTouchesBegan=this.onTouchesBegan,t.onTouchesMoved=this.onTouchesMoved,t.onTouchesEnded=this.onTouchesEnded,t.onTouchesCancelled=this.onTouchesCancelled,t},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==this.onTouchesEnded||null!==this.onTouchesCancelled||(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1)}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce},cc.EventListener.create=function(t){cc.assert(t&&t.event,cc._LogInfos.EventListener_create);var e=t.event;delete t.event;var i=null;e===cc.EventListener.TOUCH_ONE_BY_ONE?i=new cc._EventListenerTouchOneByOne:e===cc.EventListener.TOUCH_ALL_AT_ONCE?i=new cc._EventListenerTouchAllAtOnce:e===cc.EventListener.MOUSE?i=new cc._EventListenerMouse:e===cc.EventListener.CUSTOM?(i=new cc._EventListenerCustom(t.eventName,t.callback),delete t.eventName,delete t.callback):e===cc.EventListener.KEYBOARD?i=new cc._EventListenerKeyboard:e===cc.EventListener.ACCELERATION?(i=new cc._EventListenerAcceleration(t.callback),delete t.callback):e===cc.EventListener.FOCUS&&(i=new cc._EventListenerFocus);for(var n in t)i[n]=t[n];return i},cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var t=new cc._EventListenerFocus;return t.onFocusChanged=this.onFocusChanged,t},checkAvailable:function(){return!!this.onFocusChanged||(cc.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){var t=function(t){this.onFocusChanged&&this.onFocusChanged(t._widgetLoseFocus,t._widgetGetFocus)};cc.EventListener.prototype.ctor.call(this,cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,t)}}),cc._EventListenerFocus.LISTENER_ID="__cc_focus_event",cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[],this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(t){0===t._getFixedPriority()?this._sceneGraphListeners.push(t):this._fixedListeners.push(t)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),cc.__getListenerID=function(t){var e=cc.Event,i=t.getType();return i===e.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:i===e.CUSTOM?t.getEventName():i===e.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:i===e.MOUSE?cc._EventListenerMouse.LISTENER_ID:i===e.FOCUS?cc._EventListenerFocus.LISTENER_ID:(i===e.TOUCH&&cc.log(cc._LogInfos.__getListenerID),"")},cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(t){null!=this._nodeListenersMap[t.__instanceId]&&this._dirtyNodes.push(t);for(var e=t.getChildren(),i=0,n=e.length;i<n;i++)this._setDirtyForNode(e[i])},pauseTarget:function(t,e){var i,n,r=this._nodeListenersMap[t.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!0);if(e===!0){var o=t.getChildren();for(i=0,n=o.length;i<n;i++)this.pauseTarget(o[i],!0)}},resumeTarget:function(t,e){var i,n,r=this._nodeListenersMap[t.__instanceId];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!1);if(this._setDirtyForNode(t),e===!0){var o=t.getChildren();for(i=0,n=o.length;i<n;i++)this.resumeTarget(o[i],!0)}},_addListener:function(t){0===this._inDispatch?this._forceAddEventListener(t):this._toAddedListeners.push(t)},_forceAddEventListener:function(t){var e=t._getListenerID(),i=this._listenersMap[e];if(i||(i=new cc._EventListenerVector,this._listenersMap[e]=i),i.push(t),0===t._getFixedPriority()){this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY);var n=t._getSceneGraphPriority();null===n&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(n,t),n.isRunning()&&this.resumeTarget(n)}else this._setDirty(e,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(t){return this._listenersMap[t]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var t,e,i=this._dirtyNodes,n=this._nodeListenersMap,r=0,o=i.length;r<o;r++)if(t=n[i[r].__instanceId])for(var s=0,c=t.length;s<c;s++)e=t[s],e&&this._setDirty(e._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(t){if(t)for(var e,i=0;i<t.length;)e=t[i],e._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(t,e):++i},_removeListenersForListenerID:function(t){var e,i=this._listenersMap[t];if(i){var n=i.getFixedPriorityListeners(),r=i.getSceneGraphPriorityListeners();this._removeAllListenersInVector(r),this._removeAllListenersInVector(n),delete this._priorityDirtyFlagMap[t],this._inDispatch||(i.clear(),delete this._listenersMap[t])}var o,s=this._toAddedListeners;for(e=0;e<s.length;)o=s[e],o&&o._getListenerID()===t?cc.arrayRemoveObject(s,o):++e},_sortEventListeners:function(t){var e=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;if(i[t]&&(e=i[t]),e!==this.DIRTY_NONE&&(i[t]=this.DIRTY_NONE,e&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(t),e&this.DIRTY_SCENE_GRAPH_PRIORITY)){var n=cc.director.getRunningScene();n?this._sortListenersOfSceneGraphPriority(t,n):i[t]=this.DIRTY_SCENE_GRAPH_PRIORITY}},_sortListenersOfSceneGraphPriority:function(t,e){var i=this._getListeners(t);if(i){var n=i.getSceneGraphPriorityListeners();n&&0!==n.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(e,!0),i.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(t,e){var i=cc.eventManager._nodePriorityMap,n=t._getSceneGraphPriority(),r=e._getSceneGraphPriority();return e&&r&&i[r.__instanceId]?t&&n&&i[n.__instanceId]?i[e._getSceneGraphPriority().__instanceId]-i[t._getSceneGraphPriority().__instanceId]:1:-1},_sortListenersOfFixedPriority:function(t){var e=this._listenersMap[t];if(e){var i=e.getFixedPriorityListeners();if(i&&0!==i.length){i.sort(this._sortListenersOfFixedPriorityAsc);for(var n=0,r=i.length;n<r&&!(i[n]._getFixedPriority()>=0);)++n;e.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(t,e){return t._getFixedPriority()-e._getFixedPriority()},_onUpdateListeners:function(t){var e=this._listenersMap[t];if(e){var i,n,r,o=e.getFixedPriorityListeners(),s=e.getSceneGraphPriorityListeners(),c=this._toRemovedListeners;if(s)for(i=0;i<s.length;)n=s[i],n._isRegistered()?++i:(cc.arrayRemoveObject(s,n),r=c.indexOf(n),r!==-1&&c.splice(r,1));if(o)for(i=0;i<o.length;)n=o[i],n._isRegistered()?++i:(cc.arrayRemoveObject(o,n),r=c.indexOf(n),r!==-1&&c.splice(r,1));s&&0===s.length&&e.clearSceneGraphListeners(),o&&0===o.length&&e.clearFixedListeners()}},_updateListeners:function(t){var e=this._inDispatch;if(cc.assert(e>0,cc._LogInfos.EventManager__updateListeners),!(e>1)){t.getType()===cc.Event.TOUCH?(this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID)):this._onUpdateListeners(cc.__getListenerID(t)),cc.assert(1===e,cc._LogInfos.EventManager__updateListeners_2);var i=this._listenersMap,n=this._priorityDirtyFlagMap;for(var r in i)i[r].empty()&&(delete n[r],delete i[r]);var o=this._toAddedListeners;if(0!==o.length){for(var s=0,c=o.length;s<c;s++)this._forceAddEventListener(o[s]);this._toAddedListeners.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var t=this._toRemovedListeners,e=0;e<t.length;e++){var i=t[e],n=this._listenersMap[i._getListenerID()];if(n){var r,o=n.getFixedPriorityListeners(),s=n.getSceneGraphPriorityListeners();s&&(r=s.indexOf(i),r!==-1&&s.splice(r,1)),o&&(r=o.indexOf(i),r!==-1&&o.splice(r,1))}}t.length=0},_onTouchEventCallback:function(t,e){if(!t._isRegistered)return!1;var i=e.event,n=e.selTouch;i._setCurrentTarget(t._node);var r,o=!1,s=i.getEventCode(),c=cc.EventTouch.EventCode;return s===c.BEGAN?t.onTouchBegan&&(o=t.onTouchBegan(n,i),o&&t._registered&&t._claimedTouches.push(n)):t._claimedTouches.length>0&&(r=t._claimedTouches.indexOf(n))!==-1&&(o=!0,s===c.MOVED&&t.onTouchMoved?t.onTouchMoved(n,i):s===c.ENDED?(t.onTouchEnded&&t.onTouchEnded(n,i),t._registered&&t._claimedTouches.splice(r,1)):s===c.CANCELLED&&(t.onTouchCancelled&&t.onTouchCancelled(n,i),t._registered&&t._claimedTouches.splice(r,1))),i.isStopped()?(cc.eventManager._updateListeners(i),!0):!!(o&&t._registered&&t.swallowTouches)&&(e.needsMutableSet&&e.touches.splice(n,1),!0)},_dispatchTouchEvent:function(t){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var e=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),i=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==e||null!==i){var n=t.getTouches(),r=cc.copyArray(n),o={event:t,needsMutableSet:e&&i,touches:r,selTouch:null};if(e)for(var s=0;s<n.length;s++)if(o.selTouch=n[s],this._dispatchEventToListeners(e,this._onTouchEventCallback,o),t.isStopped())return;i&&r.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:t,touches:r}),t.isStopped())||this._updateListeners(t)}},_onTouchesEventCallback:function(t,e){if(!t._registered)return!1;var i=cc.EventTouch.EventCode,n=e.event,r=e.touches,o=n.getEventCode();return n._setCurrentTarget(t._node),o===i.BEGAN&&t.onTouchesBegan?t.onTouchesBegan(r,n):o===i.MOVED&&t.onTouchesMoved?t.onTouchesMoved(r,n):o===i.ENDED&&t.onTouchesEnded?t.onTouchesEnded(r,n):o===i.CANCELLED&&t.onTouchesCancelled&&t.onTouchesCancelled(r,n),!!n.isStopped()&&(cc.eventManager._updateListeners(n),!0)},_associateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i||(i=[],this._nodeListenersMap[t.__instanceId]=i),i.push(e)},_dissociateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t.__instanceId];i&&(cc.arrayRemoveObject(i,e),0===i.length&&delete this._nodeListenersMap[t.__instanceId])},_dispatchEventToListeners:function(t,e,i){var n,r,o=!1,s=t.getFixedPriorityListeners(),c=t.getSceneGraphPriorityListeners(),a=0;if(s&&0!==s.length)for(;a<t.gt0Index;++a)if(r=s[a],r.isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}if(c&&!o)for(n=0;n<c.length;n++)if(r=c[n],r.isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}if(s&&!o)for(;a<s.length;++a)if(r=s[a],r.isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){o=!0;break}},_setDirty:function(t,e){var i=this._priorityDirtyFlagMap;null==i[t]?i[t]=e:i[t]=e|i[t]},_visitTarget:function(t,e){var i=t.getChildren(),n=0,r=i.length,o=this._globalZOrderNodeMap,s=this._nodeListenersMap;if(r>0){for(var c;n<r&&(c=i[n],c&&c.getLocalZOrder()<0);n++)this._visitTarget(c,!1);for(null!=s[t.__instanceId]&&(o[t.getGlobalZOrder()]||(o[t.getGlobalZOrder()]=[]),o[t.getGlobalZOrder()].push(t.__instanceId));n<r;n++)c=i[n],c&&this._visitTarget(c,!1)}else null!=s[t.__instanceId]&&(o[t.getGlobalZOrder()]||(o[t.getGlobalZOrder()]=[]),o[t.getGlobalZOrder()].push(t.__instanceId));if(e){var a=[];for(var l in o)a.push(l);a.sort(this._sortNumberAsc);var h,u,d=a.length,_=this._nodePriorityMap;for(n=0;n<d;n++)for(h=o[a[n]],u=0;u<h.length;u++)_[h[u]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(t,e){return t-e},addListener:function(t,e){if(cc.assert(t&&e,cc._LogInfos.eventManager_addListener_2),t instanceof cc.EventListener){if(t._isRegistered())return void cc.log(cc._LogInfos.eventManager_addListener_4)}else cc.assert(!cc.isNumber(e),cc._LogInfos.eventManager_addListener_3),t=cc.EventListener.create(t);if(t.checkAvailable()){if(cc.isNumber(e)){if(0===e)return void cc.log(cc._LogInfos.eventManager_addListener);t._setSceneGraphPriority(null),t._setFixedPriority(e),t._setRegistered(!0),t._setPaused(!1),this._addListener(t)}else t._setSceneGraphPriority(e),t._setFixedPriority(0),t._setRegistered(!0),this._addListener(t);return t}},addCustomListener:function(t,e){var i=new cc._EventListenerCustom(t,e);return this.addListener(i,1),i},removeListener:function(t){if(null!=t){var e,i=this._listenersMap;for(var n in i){var r=i[n],o=r.getFixedPriorityListeners(),s=r.getSceneGraphPriorityListeners();if(e=this._removeListenerInVector(s,t),e?this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(e=this._removeListenerInVector(o,t),e&&this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)),r.empty()&&(delete this._priorityDirtyFlagMap[t._getListenerID()],delete i[n]),e)break}if(!e)for(var c=this._toAddedListeners,a=0,l=c.length;a<l;a++){var h=c[a];if(h===t){cc.arrayRemoveObject(c,h),h._setRegistered(!1);break}}}},_removeListenerInCallback:function(t,e){if(null==t)return!1;for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r._onCustomEvent===e||r._onEvent===e)return r._setRegistered(!1),null!=r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0===this._inDispatch&&cc.arrayRemoveObject(t,r),!0}return!1},_removeListenerInVector:function(t,e){if(null==t)return!1;for(var i=0,n=t.length;i<n;i++){var r=t[i];if(r===e)return r._setRegistered(!1),null!=r._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(r._getSceneGraphPriority(),r),r._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(t,r):this._toRemovedListeners.push(r),!0}return!1},removeListeners:function(t,e){var i=this;if(t instanceof cc.Node){delete i._nodePriorityMap[t.__instanceId],cc.arrayRemoveObject(i._dirtyNodes,t);var n,r=i._nodeListenersMap[t.__instanceId];if(r){var o=cc.copyArray(r);for(n=0;n<o.length;n++)i.removeListener(o[n]);o.length=0}var s=i._toAddedListeners;for(n=0;n<s.length;){var c=s[n];c._getSceneGraphPriority()===t?(c._setSceneGraphPriority(null),c._setRegistered(!1),s.splice(n,1)):++n}if(e===!0){var a,l=t.getChildren();for(n=0,a=l.length;n<a;n++)i.removeListeners(l[n],!0)}}else t===cc.EventListener.TOUCH_ONE_BY_ONE?i._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):t===cc.EventListener.TOUCH_ALL_AT_ONCE?i._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):t===cc.EventListener.MOUSE?i._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):t===cc.EventListener.ACCELERATION?i._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):t===cc.EventListener.KEYBOARD?i._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.log(cc._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(t){this._removeListenersForListenerID(t)},removeAllListeners:function(){var t=this._listenersMap,e=this._internalCustomListenerIDs;for(var i in t)e.indexOf(i)===-1&&this._removeListenersForListenerID(i)},setPriority:function(t,e){if(null!=t){var i=this._listenersMap;for(var n in i){var r=i[n],o=r.getFixedPriorityListeners();if(o){var s=o.indexOf(t);if(s!==-1)return null!=t._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority),void(t._getFixedPriority()!==e&&(t._setFixedPriority(e),this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}}},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},dispatchEvent:function(t){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!t||!t.getType)throw new Error("event is undefined");if(t.getType()===cc.Event.TOUCH)return this._dispatchTouchEvent(t),void this._inDispatch--;var e=cc.__getListenerID(t);this._sortEventListeners(e);var i=this._listenersMap[e];null!=i&&this._dispatchEventToListeners(i,this._onListenerCallback,t),this._updateListeners(t),this._inDispatch--}},_onListenerCallback:function(t,e){return e._setCurrentTarget(t._getSceneGraphPriority()),t._onEvent(e),e.isStopped()},dispatchCustomEvent:function(t,e){var i=new cc.EventCustom(t);i.setUserData(e),this.dispatchEvent(i)}},cc._tmp.PrototypeCCNode=function(){var t=cc.Node.prototype;cc.defineGetterSetter(t,"x",t.getPositionX,t.setPositionX),cc.defineGetterSetter(t,"y",t.getPositionY,t.setPositionY),t.width,cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),t.height,cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight),t.anchorX,cc.defineGetterSetter(t,"anchorX",t._getAnchorX,t._setAnchorX),t.anchorY,cc.defineGetterSetter(t,"anchorY",t._getAnchorY,t._setAnchorY),t.skewX,cc.defineGetterSetter(t,"skewX",t.getSkewX,t.setSkewX),t.skewY,cc.defineGetterSetter(t,"skewY",t.getSkewY,t.setSkewY),t.zIndex,cc.defineGetterSetter(t,"zIndex",t.getLocalZOrder,t.setLocalZOrder),t.vertexZ,cc.defineGetterSetter(t,"vertexZ",t.getVertexZ,t.setVertexZ),t.rotation,cc.defineGetterSetter(t,"rotation",t.getRotation,t.setRotation),t.rotationX,cc.defineGetterSetter(t,"rotationX",t.getRotationX,t.setRotationX),t.rotationY,cc.defineGetterSetter(t,"rotationY",t.getRotationY,t.setRotationY),t.scale,cc.defineGetterSetter(t,"scale",t.getScale,t.setScale),t.scaleX,cc.defineGetterSetter(t,"scaleX",t.getScaleX,t.setScaleX),t.scaleY,cc.defineGetterSetter(t,"scaleY",t.getScaleY,t.setScaleY),t.children,cc.defineGetterSetter(t,"children",t.getChildren),t.childrenCount,cc.defineGetterSetter(t,"childrenCount",t.getChildrenCount),t.parent,cc.defineGetterSetter(t,"parent",t.getParent,t.setParent),t.visible,cc.defineGetterSetter(t,"visible",t.isVisible,t.setVisible),t.running,cc.defineGetterSetter(t,"running",t.isRunning),t.ignoreAnchor,cc.defineGetterSetter(t,"ignoreAnchor",t.isIgnoreAnchorPointForPosition,t.ignoreAnchorPointForPosition),t.tag,t.userData,t.userObject,t.arrivalOrder,t.actionManager,cc.defineGetterSetter(t,"actionManager",t.getActionManager,t.setActionManager),t.scheduler,cc.defineGetterSetter(t,"scheduler",t.getScheduler,t.setScheduler),t.shaderProgram,cc.defineGetterSetter(t,"shaderProgram",t.getShaderProgram,t.setShaderProgram),t.opacity,cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),t.opacityModifyRGB,cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB),t.cascadeOpacity,cc.defineGetterSetter(t,"cascadeOpacity",t.isCascadeOpacityEnabled,t.setCascadeOpacityEnabled),t.color,cc.defineGetterSetter(t,"color",t.getColor,t.setColor),t.cascadeColor,cc.defineGetterSetter(t,"cascadeColor",t.isCascadeColorEnabled,t.setCascadeColorEnabled)},cc.NODE_TAG_INVALID=-1,cc.s_globalOrderOfArrival=1,cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_customZ:NaN,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,ctor:function(){this._initNode(),this._initRendererCmd()},_initNode:function(){var t=this;t._anchorPoint=cc.p(0,0),t._contentSize=cc.size(0,0),t._position=cc.p(0,0),t._normalizedPosition=cc.p(0,0),t._children=[];var e=cc.director;t._actionManager=e.getActionManager(),t._scheduler=e.getScheduler(),t._additionalTransform=cc.affineTransformMakeIdentity(),cc.ComponentContainer&&(t._componentContainer=new cc.ComponentContainer(t)),this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._cascadeColorEnabled=!1,this._cascadeOpacityEnabled=!1},init:function(){return!0},_arrayMakeObjectsPerformSelector:function(t,e){if(t&&0!==t.length){var i,n,r=t.length,o=cc.Node._stateCallbackType;switch(e){case o.onEnter:for(i=0;i<r;i++)n=t[i],n&&n.onEnter();break;case o.onExit:for(i=0;i<r;i++)n=t[i],n&&n.onExit();break;case o.onEnterTransitionDidFinish:for(i=0;i<r;i++)n=t[i],n&&n.onEnterTransitionDidFinish();break;case o.cleanup:for(i=0;i<r;i++)n=t[i],n&&n.cleanup();break;case o.updateTransform:for(i=0;i<r;i++)n=t[i],n&&n.updateTransform();break;case o.onExitTransitionDidStart:for(i=0;i<r;i++)n=t[i],n&&n.onExitTransitionDidStart();break;case o.sortAllChildren:for(i=0;i<r;i++)n=t[i],n&&n.sortAllChildren();break;default:cc.assert(0,cc._LogInfos.Node__arrayMakeObjectsPerformSelector)}}},attr:function(t){for(var e in t)this[e]=t[e]},getSkewX:function(){return this._skewX},setSkewX:function(t){this._skewX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(t){this._skewY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(t){this._localZOrder=t,this._parent&&this._parent.reorderChild(this,t),cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(t){this._localZOrder=t},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){return cc.log(cc._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(t){cc.log(cc._LogInfos.Node_setZOrder),this.setLocalZOrder(t)},setGlobalZOrder:function(t){this._globalZOrder!==t&&(this._globalZOrder=t,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(t){this._customZ=this._vertexZ=t},getRotation:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation),this._rotationX},setRotation:function(t){this._rotationX=this._rotationY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(t){this._rotationX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(t){this._rotationY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX},setScale:function(t,e){this._scaleX=t,this._scaleY=e||0===e?e:t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(t){this._scaleX=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(t){this._scaleY=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setPosition:function(t,e){var i=this._position;if(void 0===e){if(i.x===t.x&&i.y===t.y)return;i.x=t.x,i.y=t.y}else{if(i.x===t&&i.y===e)return;i.x=t,i.y=e}this._usingNormalizedPosition=!1,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(t,e){var i=this._normalizedPosition;void 0===e?(i.x=t.x,i.y=t.y):(i.x=t,i.y=e),this._normalizedPositionDirty=this._usingNormalizedPosition=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getNormalizedPosition:function(){return cc.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(t){this._position.x=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(t){this._position.y=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(t){this._visible!==t&&(this._visible=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(t){this._anchorPoint.x!==t&&(this._anchorPoint.x=t,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(t){this._anchorPoint.y!==t&&(this._anchorPoint.y=t,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(t){this._contentSize.width=t,this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(t){this._contentSize.height=t,this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(t){this._parent=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(t){t!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(t){this.tag=t},setName:function(t){this._name=t},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(t){this.userData=t},getUserObject:function(){return this.userObject},setUserObject:function(t){this.userObject!==t&&(this.userObject=t)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(t){this.arrivalOrder=t},getActionManager:function(){return this._actionManager||(this._actionManager=cc.director.getActionManager()),this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this.stopAllActions(),this._actionManager=t)},getScheduler:function(){return this._scheduler||(this._scheduler=cc.director.getScheduler()),this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this.unscheduleAllCallbacks(),this._scheduler=t)},boundingBox:function(){return cc.log(cc._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(t,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup)},getChildByTag:function(t){var e=this._children;if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];if(n&&n.tag===t)return n}return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t,e,i){e=void 0===e?t._localZOrder:e;var n,r=!1;cc.isUndefined(i)?(i=void 0,n=t._name):cc.isString(i)?(n=i,i=void 0):cc.isNumber(i)&&(r=!0,n=""),cc.assert(t,cc._LogInfos.Node_addChild_3),cc.assert(null===t._parent,"child already added. It can't be added again"),this._addChildHelper(t,e,i,n,r)},_addChildHelper:function(t,e,i,n,r){this._children||(this._children=[]),this._insertChild(t,e),r?t.setTag(i):t.setName(n),t.setParent(this),t.setOrderOfArrival(cc.s_globalOrderOfArrival++),this._running&&(t.onEnter(),this._isTransitionFinished&&t.onEnterTransitionDidFinish()),t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._cascadeColorEnabled&&t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),this._cascadeOpacityEnabled&&t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeFromParentAndCleanup:function(t){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup),this.removeFromParent(t)},removeChild:function(t,e){0!==this._children.length&&(void 0===e&&(e=!0),this._children.indexOf(t)>-1&&this._detachChild(t,e),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(t,e){t===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.log(cc._LogInfos.Node_removeChildByTag_2,t)},removeAllChildrenWithCleanup:function(t){this.removeAllChildren(t)},removeAllChildren:function(t){var e=this._children;if(null!==e){void 0===t&&(t=!0);for(var i=0;i<e.length;i++){var n=e[i];n&&(this._running&&(n.onExitTransitionDidStart(),n.onExit()),t&&n.cleanup(),n.parent=null,n._renderCmd.detachFromParent())}this._children.length=0,cc.renderer.childrenOrderDirty=!0}},_detachChild:function(t,e){this._running&&(t.onExitTransitionDidStart(),t.onExit()),e&&t.cleanup(),t.parent=null,t._renderCmd.detachFromParent(),cc.arrayRemoveObject(this._children,t)},_insertChild:function(t,e){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,this._children.push(t),t._setLocalZOrder(e)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},reorderChild:function(t,e){cc.assert(t,cc._LogInfos.Node_reorderChild),cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0,t.arrivalOrder=cc.s_globalOrderOfArrival,cc.s_globalOrderOfArrival++,t._setLocalZOrder(e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.orderDirty)},sortAllChildren:function(){if(this._reorderChildDirty){var t,e,i,n=this._children,r=n.length;for(t=1;t<r;t++){for(i=n[t],e=t-1;e>=0;){if(i._localZOrder<n[e]._localZOrder)n[e+1]=n[e];else{if(!(i._localZOrder===n[e]._localZOrder&&i.arrivalOrder<n[e].arrivalOrder))break;n[e+1]=n[e]}e--}n[e+1]=i}this._reorderChildDirty=!1}},draw:function(t){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1,this._running=!0,this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnter),this.resume()},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0,this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExitTransitionDidStart)},onExit:function(){this._running=!1,this.pause(),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExit),this.removeAllComponents()},runAction:function(t){return cc.assert(t,cc._LogInfos.Node_runAction),this.actionManager.addAction(t,this,!this._running),t},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(t){this.actionManager.removeAction(t)},stopActionByTag:function(t){return t===cc.ACTION_TAG_INVALID?void cc.log(cc._LogInfos.Node_stopActionByTag):void this.actionManager.removeActionByTag(t,this)},getActionByTag:function(t){return t===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(t,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(t){this.scheduler.scheduleUpdate(this,t,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(t,e,i,n,r){var o=arguments.length;"function"==typeof t?1===o?(e=0,i=cc.REPEAT_FOREVER,n=0,r=this.__instanceId):2===o?"number"==typeof e?(i=cc.REPEAT_FOREVER,n=0,r=this.__instanceId):(r=e,e=0,i=cc.REPEAT_FOREVER,n=0):3===o?("string"==typeof i?(r=i,i=cc.REPEAT_FOREVER):r=this.__instanceId,n=0):4===o&&(r=this.__instanceId):1===o?(e=0,i=cc.REPEAT_FOREVER,n=0):2===o&&(i=cc.REPEAT_FOREVER,n=0),cc.assert(t,cc._LogInfos.Node_schedule),cc.assert(e>=0,cc._LogInfos.Node_schedule_2),e=e||0,i=null==i?cc.REPEAT_FOREVER:i,n=n||0,this.scheduler.schedule(t,this,e,i,n,!this._running,r)},scheduleOnce:function(t,e,i){void 0===i&&(i=this.__instanceId),this.schedule(t,0,0,e,i)},unschedule:function(t){t&&this.scheduler.unschedule(t,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions),this.resume()},resume:function(){this.scheduler.resumeTarget(this),this.actionManager&&this.actionManager.resumeTarget(this),cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions),this.pause()},pause:function(){this.scheduler.pauseTarget(this),this.actionManager&&this.actionManager.pauseTarget(this),cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(t){return void 0===t?this._additionalTransformDirty=!1:(this._additionalTransform=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),void(this._additionalTransformDirty=!0))},getParentToNodeTransform:function(){return this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var t=this.getNodeToParentTransform(),e=this._parent;null!==e;e=e.parent)t=cc.affineTransformConcat(t,e.getNodeToParentTransform());return t},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(t){return cc.pointApplyAffineTransform(t,this.getWorldToNodeTransform())},convertToWorldSpace:function(t){return t=t||cc.p(0,0),cc.pointApplyAffineTransform(t,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(t){return cc.pSub(this.convertToNodeSpace(t),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(t){t=t||cc.p(0,0);var e=cc.pAdd(t,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(e)},_convertToWindowSpace:function(t){var e=this.convertToWorldSpace(t);return cc.director.convertToUI(e)},convertTouchToNodeSpace:function(t){var e=t.getLocation();return this.convertToNodeSpace(e)},convertTouchToNodeSpaceAR:function(t){var e=cc.director.convertToGL(t.getLocation());return this.convertToNodeSpaceAR(e)},update:function(t){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(t)},updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.updateTransform)},retain:function(){},release:function(){},getComponent:function(t){return this._componentContainer?this._componentContainer.getComponent(t):null},addComponent:function(t){this._componentContainer&&this._componentContainer.add(t)},removeComponent:function(t){return!!this._componentContainer&&this._componentContainer.remove(t)},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(t){this._renderCmd.visit(t)},transform:function(t,e){this._renderCmd.transform(t,e)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(t){var e=this._renderCmd.getNodeToParentTransform();if(t){for(var i={a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx,ty:e.ty},n=this._parent;null!=n&&n!=t;n=n.getParent())cc.affineTransformConcatIn(i,n.getNodeToParentTransform());return i}return e},getNodeToParentAffineTransform:function(t){return this.getNodeToParentTransform(t)},getCamera:function(){return null},getGrid:function(){return this.grid},setGrid:function(t){this.grid=t},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t)},getGLServerState:function(){return 0},setGLServerState:function(t){},getBoundingBoxToWorld:function(){var t=cc.rect(0,0,this._contentSize.width,this._contentSize.height),e=this.getNodeToWorldTransform();if(t=cc.rectApplyAffineTransform(t,e),!this._children)return t;for(var i=this._children,n=0;n<i.length;n++){var r=i[n];if(r&&r._visible){var o=r._getBoundingBoxToCurrentNode(e);o&&(t=cc.rectUnion(t,o))}}return t},_getBoundingBoxToCurrentNode:function(t){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height),i=void 0===t?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),t);if(e=cc.rectApplyAffineTransform(e,i),!this._children)return e;for(var n=this._children,r=0;r<n.length;r++){var o=n[r];if(o&&o._visible){var s=o._getBoundingBoxToCurrentNode(i);s&&(e=cc.rectUnion(e,s))}}return e},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(t){this._realOpacity=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(t){this._renderCmd._updateDisplayOpacity(t)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(t){this._cascadeOpacityEnabled!==t&&(this._cascadeOpacityEnabled=t,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var t=this._realColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(t){var e=this._realColor;e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(t){this._renderCmd._updateDisplayColor(t)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(t){this._cascadeColorEnabled!==t&&(this._cascadeColorEnabled=t,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Node.CanvasRenderCmd(this):new cc.Node.WebGLRenderCmd(this)},enumerateChildren:function(t,e){cc.assert(t&&0!=t.length,"Invalid name"),cc.assert(null!=e,"Invalid callback function");var i=t.length,n=0,r=i,o=!1;i>2&&"/"===t[0]&&"/"===t[1]&&(o=!0,n=2,r-=2);var s=!1;i>3&&"/"===t[i-3]&&"."===t[i-2]&&"."===t[i-1]&&(s=!0,r-=3);var c=t.substr(n,r);s&&(c="[[:alnum:]]+/"+c),o?this.doEnumerateRecursive(this,c,e):this.doEnumerate(c,e)},doEnumerateRecursive:function(t,e,i){var n=!1;if(t.doEnumerate(e,i))n=!0;else for(var r,o=t.getChildren(),s=o.length,c=0;c<s;c++)if(r=o[c],this.doEnumerateRecursive(r,e,i)){n=!0;break}},doEnumerate:function(t,e){var i=t.indexOf("/"),n=t,r=!1;i!==-1&&(n=t.substr(0,i),r=!0);for(var o,s=!1,c=this._children,a=c.length,l=0;l<a;l++)if(o=c[l],o._name.indexOf(n)!==-1)if(r){if(s=o.doEnumerate(t,e))break}else if(e(o)){s=!0;break}return s}}),cc.Node.create=function(){return new cc.Node},cc.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7},cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),cc._tmp.PrototypeCCNode(),delete cc._tmp.PrototypeCCNode,cc.CustomRenderCmd=function(t,e){this._needDraw=!0,this._target=t,this._callback=e,this.rendering=function(t,e,i){this._callback&&this._callback.call(this._target,t,e,i)},this.needDraw=function(){return this._needDraw}},cc.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,textureDirty:256,contentDirty:512,COUNT:10,all:1023},cc.Node.RenderCmd=function(t){this._dirtyFlag=1,this._savedDirtyFlag=!0,this._node=t,this._needDraw=!1,this._anchorPointInPoints=new cc.Point(0,0),this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0},this._displayedOpacity=255,this._displayedColor=cc.color(255,255,255,255),this._cascadeColorEnabledDirty=!1,this._cascadeOpacityEnabledDirty=!1,this._curLevel=-1},cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,needDraw:function(){return this._needDraw},getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var t=this._displayedColor;return cc.color(t.r,t.g,t.b,t.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getParentToNodeTransform:function(){return this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform())),this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var t=this._anchorPointInPoints,e=this._node._contentSize,i=this._node._anchorPoint;t.x=e.width*i.x,t.y=e.height*i.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(t){0===this._dirtyFlag&&0!==t&&cc.renderer.pushDirtyNode(this),this._dirtyFlag|=t},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},transform:function(t,e){var i=this._node,n=t?t._worldTransform:null,r=this._transform,o=this._worldTransform;if(i._usingNormalizedPosition&&i._parent){var s=i._parent._contentSize;i._position.x=i._normalizedPosition.x*s.width,i._position.y=i._normalizedPosition.y*s.height,i._normalizedPositionDirty=!1}var c=i._rotationX||i._rotationY,a=i._skewX||i._skewY,l=i._scaleX,h=i._scaleY,u=this._anchorPointInPoints.x,d=this._anchorPointInPoints.y,_=1,p=0,f=0,m=1;if(c||a){if(r.tx=i._position.x,r.ty=i._position.y,c){var g=.017453292519943295*i._rotationX;if(f=Math.sin(g),m=Math.cos(g),i._rotationY===i._rotationX)_=m,p=-f;else{var y=.017453292519943295*i._rotationY;_=Math.cos(y),p=-Math.sin(y)}}if(r.a=_*=l,r.b=p*=l,r.c=f*=h,r.d=m*=h,a){var v=Math.tan(i._skewX*Math.PI/180),T=Math.tan(i._skewY*Math.PI/180);v===1/0&&(v=99999999),T===1/0&&(T=99999999),r.a=_+f*T,r.b=p+m*T,r.c=f+_*v,r.d=m+p*v}(u||d)&&(r.tx-=r.a*u+r.c*d,r.ty-=r.b*u+r.d*d,i._ignoreAnchorPointForPosition&&(r.tx+=u,r.ty+=d)),n?(o.a=r.a*n.a+r.b*n.c,o.b=r.a*n.b+r.b*n.d,o.c=r.c*n.a+r.d*n.c,o.d=r.c*n.b+r.d*n.d,o.tx=n.a*r.tx+n.c*r.ty+n.tx,o.ty=n.d*r.ty+n.ty+n.b*r.tx):(o.a=r.a,o.b=r.b,o.c=r.c,o.d=r.d,o.tx=r.tx,o.ty=r.ty)}else r.a=l,r.b=0,r.c=0,r.d=h,r.tx=i._position.x,r.ty=i._position.y,(u||d)&&(r.tx-=r.a*u,r.ty-=r.d*d,i._ignoreAnchorPointForPosition&&(r.tx+=u,r.ty+=d)),n?(o.a=r.a*n.a+r.b*n.c,o.b=r.a*n.b+r.b*n.d,o.c=r.c*n.a+r.d*n.c,o.d=r.c*n.b+r.d*n.d,o.tx=r.tx*n.a+r.ty*n.c+n.tx,o.ty=r.tx*n.b+r.ty*n.d+n.ty):(o.a=r.a,o.b=r.b,o.c=r.c,o.d=r.d,o.tx=r.tx,o.ty=r.ty);if(i._additionalTransformDirty&&(this._transform=cc.affineTransformConcat(r,i._additionalTransform)),this._updateCurrentRegions&&this._updateCurrentRegions(),this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble),e){var C=this._node._children;if(!C||0===C.length)return;var S,x;for(S=0,x=C.length;S<x;S++)C[S]._renderCmd.transform(this,e)}this._cacheDirty=!0},getNodeToParentTransform:function(){return this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&this.transform(),this._transform},visit:function(t){var e=this._node,i=cc.renderer;e._visible&&(t=t||this.getParentRenderCmd(),t&&(this._curLevel=t._curLevel+1),isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t),this.visitChildren())},_updateDisplayColor:function(t){var e,i,n,r,o=this._node,s=this._displayedColor,c=o._realColor;if(this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){s.r=c.r,s.g=c.g,s.b=c.b;var a=new cc.Color(255,255,255,255);for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&r._renderCmd._updateDisplayColor(a);this._cascadeColorEnabledDirty=!1}else{if(void 0===t){var l=o._parent;t=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.color.WHITE}if(s.r=0|c.r*t.r/255,s.g=0|c.g*t.g/255,s.b=0|c.b*t.b/255,o._cascadeColorEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty^this._dirtyFlag},_updateDisplayOpacity:function(t){var e,i,n,r,o=this._node;if(this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._cascadeOpacityEnabledDirty&&!o._cascadeOpacityEnabled){for(this._displayedOpacity=o._realOpacity,n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&r._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===t){var s=o._parent;t=255,s&&s._cascadeOpacityEnabled&&(t=s.getDisplayedOpacity())}if(this._displayedOpacity=o._realOpacity*t/255,o._cascadeOpacityEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty^this._dirtyFlag},_syncDisplayColor:function(t){var e=this._node,i=this._displayedColor,n=e._realColor;if(void 0===t){var r=e._parent;t=r&&r._cascadeColorEnabled?r.getDisplayedColor():cc.color.WHITE}i.r=0|n.r*t.r/255,i.g=0|n.g*t.g/255,i.b=0|n.b*t.b/255},_syncDisplayOpacity:function(t){var e=this._node;if(void 0===t){var i=e._parent;t=255,i&&i._cascadeOpacityEnabled&&(t=i.getDisplayedOpacity())}this._displayedOpacity=e._realOpacity*t/255},_updateColor:function(){},updateStatus:function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag,i=e&t.colorDirty,n=e&t.opacityDirty;this._savedDirtyFlag=this._savedDirtyFlag||e,i&&this._updateDisplayColor(),n&&this._updateDisplayOpacity(),(i||n)&&this._updateColor(),e&t.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=this._dirtyFlag&t.transformDirty^this._dirtyFlag),e&t.orderDirty&&(this._dirtyFlag=this._dirtyFlag&t.orderDirty^this._dirtyFlag)},_syncStatus:function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag,n=null;t?(n=t._node,this._savedDirtyFlag=this._savedDirtyFlag||t._savedDirtyFlag||i):this._savedDirtyFlag=this._savedDirtyFlag||i,n&&n._cascadeColorEnabled&&t._dirtyFlag&e.colorDirty&&(i|=e.colorDirty),n&&n._cascadeOpacityEnabled&&t._dirtyFlag&e.opacityDirty&&(i|=e.opacityDirty),t&&t._dirtyFlag&e.transformDirty&&(i|=e.transformDirty);var r=i&e.colorDirty,o=i&e.opacityDirty;this._dirtyFlag=i,r&&this._syncDisplayColor(),o&&this._syncDisplayOpacity(),(r||o)&&this._updateColor(),i&e.transformDirty&&this.transform(t),i&e.orderDirty&&(this._dirtyFlag=this._dirtyFlag&e.orderDirty^this._dirtyFlag)},visitChildren:function(){var t,e,i=cc.renderer,n=this._node,r=n._children,o=r.length;if(o>0){for(n.sortAllChildren(),t=0;t<o&&(e=r[t],e._localZOrder<0);t++)e._renderCmd.visit(this);for(i.pushRenderCommand(this);t<o;t++)r[t]._renderCmd.visit(this)}else i.pushRenderCommand(this);this._dirtyFlag=0}},cc.Node.RenderCmd.prototype.originVisit=cc.Node.RenderCmd.prototype.visit,cc.Node.RenderCmd.prototype.originTransform=cc.Node.RenderCmd.prototype.transform,function(){cc.Node.CanvasRenderCmd=function(t){cc.Node.RenderCmd.call(this,t),this._cachedParent=null,this._cacheDirty=!1,this._currentRegion=new cc.Region,this._oldRegion=new cc.Region,this._regionFlag=0,this._canUseDirtyRegion=!1},cc.Node.CanvasRenderCmd.RegionStatus={NotDirty:0,Dirty:1,DirtyDouble:2};var t=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);t.constructor=cc.Node.CanvasRenderCmd,t._notifyRegionStatus=function(t){this._needDraw&&this._regionFlag<t&&(this._regionFlag=t)};var e=new cc.Rect;t.getLocalBB=function(){var t=this._node;return e.x=e.y=0,e.width=t._contentSize.width,e.height=t._contentSize.height,e},t._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._worldTransform)},t.setDirtyFlag=function(t,e){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,t,e),this._setCacheDirty(e),this._cachedParent&&this._cachedParent.setDirtyFlag(t,!0)},t._setCacheDirty=function(){if(this._cacheDirty===!1){this._cacheDirty=!0;var t=this._cachedParent;t&&t!==this&&t._setNodeDirtyForCache&&t._setNodeDirtyForCache()}},t._setCachedParent=function(t){if(this._cachedParent!==t){this._cachedParent=t;for(var e=this._node._children,i=0,n=e.length;i<n;i++)e[i]._renderCmd._setCachedParent(t)}},t.detachFromParent=function(){this._cachedParent=null;for(var t,e=this._node._children,i=0,n=e.length;i<n;i++)t=e[i],t&&t._renderCmd&&t._renderCmd.detachFromParent()},t.setShaderProgram=function(t){},t.getShaderProgram=function(){return null},cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(t){return t?t.src===cc.SRC_ALPHA&&t.dst===cc.ONE||t.src===cc.ONE&&t.dst===cc.ONE?"lighter":t.src===cc.ZERO&&t.dst===cc.SRC_ALPHA?"destination-in":t.src===cc.ZERO&&t.dst===cc.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}}(),cc._tmp.PrototypeTexture2D=function(){var t=cc.Texture2D;t.PVRImagesHavePremultipliedAlpha=function(t){cc.PVRHaveAlphaPremultiplied_=t},t.PIXEL_FORMAT_RGBA8888=2,t.PIXEL_FORMAT_RGB888=3,t.PIXEL_FORMAT_RGB565=4,t.PIXEL_FORMAT_A8=5,t.PIXEL_FORMAT_I8=6,t.PIXEL_FORMAT_AI88=7,t.PIXEL_FORMAT_RGBA4444=8,t.PIXEL_FORMAT_RGB5A1=7,t.PIXEL_FORMAT_PVRTC4=9,t.PIXEL_FORMAT_PVRTC2=10,t.PIXEL_FORMAT_DEFAULT=t.PIXEL_FORMAT_RGBA8888,t.defaultPixelFormat=t.PIXEL_FORMAT_DEFAULT;var e=cc.Texture2D._M={};e[t.PIXEL_FORMAT_RGBA8888]="RGBA8888",e[t.PIXEL_FORMAT_RGB888]="RGB888",e[t.PIXEL_FORMAT_RGB565]="RGB565",e[t.PIXEL_FORMAT_A8]="A8",e[t.PIXEL_FORMAT_I8]="I8",e[t.PIXEL_FORMAT_AI88]="AI88",e[t.PIXEL_FORMAT_RGBA4444]="RGBA4444",e[t.PIXEL_FORMAT_RGB5A1]="RGB5A1",e[t.PIXEL_FORMAT_PVRTC4]="PVRTC4",e[t.PIXEL_FORMAT_PVRTC2]="PVRTC2";var i=cc.Texture2D._B={};i[t.PIXEL_FORMAT_RGBA8888]=32,i[t.PIXEL_FORMAT_RGB888]=24,i[t.PIXEL_FORMAT_RGB565]=16,i[t.PIXEL_FORMAT_A8]=8,i[t.PIXEL_FORMAT_I8]=8,i[t.PIXEL_FORMAT_AI88]=16,i[t.PIXEL_FORMAT_RGBA4444]=16,i[t.PIXEL_FORMAT_RGB5A1]=16,i[t.PIXEL_FORMAT_PVRTC4]=4,i[t.PIXEL_FORMAT_PVRTC2]=3;var n=cc.Texture2D.prototype;n.name,cc.defineGetterSetter(n,"name",n.getName),n.pixelFormat,cc.defineGetterSetter(n,"pixelFormat",n.getPixelFormat),n.pixelsWidth,cc.defineGetterSetter(n,"pixelsWidth",n.getPixelsWide),n.pixelsHeight,cc.defineGetterSetter(n,"pixelsHeight",n.getPixelsHigh),n.width,cc.defineGetterSetter(n,"width",n._getWidth),n.height,cc.defineGetterSetter(n,"height",n._getHeight)},cc._tmp.PrototypeTextureAtlas=function(){var t=cc.TextureAtlas.prototype;t.totalQuads,cc.defineGetterSetter(t,"totalQuads",t.getTotalQuads),t.capacity,cc.defineGetterSetter(t,"capacity",t.getCapacity),t.quads,cc.defineGetterSetter(t,"quads",t.getQuads,t.setQuads)},cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=cc.size(0,0),this._pixelFormat=cc.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj),cc.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),this._contentSize.height/cc.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(t){this.maxS=t},getMaxT:function(){return this.maxT},setMaxT:function(t){this.maxT=t},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(t){this.shaderProgram=t},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){var t=this;return"<cc.Texture2D | Name = "+t._name+" | Dimensions = "+t._pixelsWide+" x "+t._pixelsHigh+" | Coordinates = ("+t.maxS+", "+t.maxT+")>"},releaseData:function(t){t=null},keepData:function(t,e){return t},initWithData:function(t,e,i,n,r){var o=this,s=cc.Texture2D,c=cc._renderContext,a=c.RGBA,l=c.UNSIGNED_BYTE,h=cc.Texture2D._B[e],u=i*h/8;switch(u%8===0?c.pixelStorei(c.UNPACK_ALIGNMENT,8):u%4===0?c.pixelStorei(c.UNPACK_ALIGNMENT,4):u%2===0?c.pixelStorei(c.UNPACK_ALIGNMENT,2):c.pixelStorei(c.UNPACK_ALIGNMENT,1),o._webTextureObj=c.createTexture(),cc.glBindTexture2D(o),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),e){case s.PIXEL_FORMAT_RGBA8888:a=c.RGBA;break;case s.PIXEL_FORMAT_RGB888:a=c.RGB;break;case s.PIXEL_FORMAT_RGBA4444:l=c.UNSIGNED_SHORT_4_4_4_4;break;case s.PIXEL_FORMAT_RGB5A1:l=c.UNSIGNED_SHORT_5_5_5_1;break;case s.PIXEL_FORMAT_RGB565:l=c.UNSIGNED_SHORT_5_6_5;break;case s.PIXEL_FORMAT_AI88:a=c.LUMINANCE_ALPHA;break;case s.PIXEL_FORMAT_A8:a=c.ALPHA;break;case s.PIXEL_FORMAT_I8:a=c.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData)}return c.texImage2D(c.TEXTURE_2D,0,a,i,n,0,a,l,t),o._contentSize.width=r.width,o._contentSize.height=r.height,o._pixelsWide=i,o._pixelsHigh=n,o._pixelFormat=e,o.maxS=r.width/i,o.maxT=r.height/n,o._hasPremultipliedAlpha=!1,o._hasMipmaps=!1,o.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),o._textureLoaded=!0,!0},drawAtPoint:function(t){var e=this,i=[0,e.maxT,e.maxS,e.maxT,0,0,e.maxS,0],n=cc._renderContext,r=e._pixelsWide*e.maxS,o=e._pixelsHigh*e.maxT,s=[t.x,t.y,0,r+t.x,t.y,0,t.x,o+t.y,0,r+t.x,o+t.y,0];e._shaderProgram.use(),e._shaderProgram.setUniformsForBuiltins(),cc.glBindTexture2D(e),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,s),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,i),n.drawArrays(n.TRIANGLE_STRIP,0,4)},drawInRect:function(t){var e=this,i=[0,e.maxT,e.maxS,e.maxT,0,0,e.maxS,0],n=[t.x,t.y,t.x+t.width,t.y,t.x,t.y+t.height,t.x+t.width,t.y+t.height];e._shaderProgram.use(),e._shaderProgram.setUniformsForBuiltins(),cc.glBindTexture2D(e);var r=cc._renderContext;r.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),r.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),r.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,r.FLOAT,!1,0,n),r.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,r.FLOAT,!1,0,i),r.drawArrays(r.TRIANGLE_STRIP,0,4)},initWithImage:function(t){if(null==t)return cc.log(cc._LogInfos.Texture2D_initWithImage),!1;var e=t.getWidth(),i=t.getHeight(),n=cc.configuration.getMaxTextureSize();return e>n||i>n?(cc.log(cc._LogInfos.Texture2D_initWithImage_2,e,i,n,n),!1):(this._textureLoaded=!0,this._initPremultipliedATextureWithImage(t,e,i))},initWithElement:function(t){t&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=t,this._textureLoaded=!0,this._hasPremultipliedAlpha=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(t){var e=this;if(t=void 0!==t?t:e._hasPremultipliedAlpha,cc.game._rendererInitialized){if(!e._htmlElementObj){var i=cc.loader.getRes(e.url);if(!i)return;e.initWithElement(i)}if(e._htmlElementObj.width&&e._htmlElementObj.height){var n=cc._renderContext;cc.glBindTexture2D(e),n.pixelStorei(n.UNPACK_ALIGNMENT,4),t&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e._htmlElementObj),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),e.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),cc.glBindTexture2D(null),t&&n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0);var r=e._htmlElementObj.width,o=e._htmlElementObj.height;e._pixelsWide=e._contentSize.width=r,e._pixelsHigh=e._contentSize.height=o,e._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,e.maxS=1,e.maxT=1,e._hasPremultipliedAlpha=t,e._hasMipmaps=!1,e.dispatchEvent("load")}}},initWithString:function(t,e,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithString),null},initWithETCFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithETCFile_2),!1},initWithPVRFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2),!1},initWithPVRTCData:function(t,e,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2),!1},setTexParameters:function(t,e,i,n){var r=this,o=cc._renderContext;void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),cc.assert(r._pixelsWide===cc.NextPOT(r._pixelsWide)&&r._pixelsHigh===cc.NextPOT(r._pixelsHigh)||t.wrapS===o.CLAMP_TO_EDGE&&t.wrapT===o.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures"),cc.glBindTexture2D(r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t.minFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t.magFilter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t.wrapS),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t.wrapT)},setAntiAliasTexParameters:function(){var t=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)},setAliasTexParameters:function(){var t=cc._renderContext;cc.glBindTexture2D(this),this._hasMipmaps?t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)},generateMipmap:function(){var t=this;cc.assert(t._pixelsWide===cc.NextPOT(t._pixelsWide)&&t._pixelsHigh===cc.NextPOT(t._pixelsHigh),"Mimpap texture only works in POT textures"),cc.glBindTexture2D(t),cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D),t._hasMipmaps=!0},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(t){t=t||this._pixelFormat;var e=cc.Texture2D._B[t];return null!=e?e:(cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,t),-1)},_initPremultipliedATextureWithImage:function(t,e,i){var n,r=cc.Texture2D,o=t.getData(),s=null,c=null,a=t.hasAlpha(),l=cc.size(t.getWidth(),t.getHeight()),h=r.defaultPixelFormat,u=t.getBitsPerComponent();a||(u>=8?h=r.PIXEL_FORMAT_RGB888:(cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage),h=r.PIXEL_FORMAT_RGB565));var d=e*i;if(h===r.PIXEL_FORMAT_RGB565)if(a)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>2<<5|(s[n]>>16&255)>>3<<0;else for(o=new Uint16Array(e*i),c=t.getData(),n=0;n<d;++n)o[n]=(255&c[n])>>3<<11|(255&c[n])>>2<<5|(255&c[n])>>3<<0;else if(h===r.PIXEL_FORMAT_RGBA4444)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>4<<12|(s[n]>>8&255)>>4<<8|(s[n]>>16&255)>>4<<4|(s[n]>>24&255)>>4<<0;else if(h===r.PIXEL_FORMAT_RGB5A1)for(o=new Uint16Array(e*i),s=t.getData(),n=0;n<d;++n)o[n]=(s[n]>>0&255)>>3<<11|(s[n]>>8&255)>>3<<6|(s[n]>>16&255)>>3<<1|(s[n]>>24&255)>>7<<0;else if(h===r.PIXEL_FORMAT_A8)for(o=new Uint8Array(e*i),s=t.getData(),n=0;n<d;++n)o[n]=s>>24&255;if(a&&h===r.PIXEL_FORMAT_RGB888)for(s=t.getData(),o=new Uint8Array(e*i*3),n=0;n<d;++n)o[3*n]=s>>0&255,o[3*n+1]=s>>8&255,o[3*n+2]=s>>16&255;return this.initWithData(o,h,e,i,l),o!=t.getData()&&(o=null),this._hasPremultipliedAlpha=t.isPremultipliedAlpha(),!0},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},removeLoadedEventListener:function(t){this.removeEventTarget("load",t)}})},cc._tmp.WebGLTextureAtlas=function(){var t=cc.TextureAtlas.prototype;t._setupVBO=function(){var t=this,e=cc._renderContext;t._buffersVBO[0]=e.createBuffer(),t._buffersVBO[1]=e.createBuffer(),t._quadsWebBuffer=e.createBuffer(),t._mapBuffers()},t._mapBuffers=function(){var t=this,e=cc._renderContext;e.bindBuffer(e.ARRAY_BUFFER,t._quadsWebBuffer),e.bufferData(e.ARRAY_BUFFER,t._quadsArrayBuffer,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._buffersVBO[1]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t._indices,e.STATIC_DRAW)},t.drawNumberOfQuads=function(t,e){var i=this;if(e=e||0,0!==t&&i.texture&&i.texture.isLoaded()){var n=cc._renderContext;cc.glBindTexture2D(i.texture),n.bindBuffer(n.ARRAY_BUFFER,i._quadsWebBuffer),i.dirty&&(n.bufferData(n.ARRAY_BUFFER,i._quadsArrayBuffer,n.DYNAMIC_DRAW),i.dirty=!1),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,24,0),n.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,24,12),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,24,16),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i._buffersVBO[1]),cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?n.drawElements(n.TRIANGLE_STRIP,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT):n.drawElements(n.TRIANGLES,6*t,n.UNSIGNED_SHORT,6*e*i._indices.BYTES_PER_ELEMENT),cc.g_NumberOfDraws++}}},cc._tmp.WebGLTextureCache=function(){var t=cc.textureCache;t.handleLoadedTexture=function(t){var e,i,n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore),e=n[t],e||(e=n[t]=new cc.Texture2D,e.url=t),i=cc.path.extname(t),".png"===i?e.handleLoadedTexture(!0):e.handleLoadedTexture()},t.addImage=function(t,e,i){cc.assert(t,cc._LogInfos.Texture2D_addImage_2);var n=this._textures;cc.game._rendererInitialized||(n=this._loadedTexturesBefore);var r=n[t]||n[cc.loader._getAliase(t)];if(r)return r.isLoaded()?(e&&e.call(i,r),r):(r.addEventListener("load",function(){e&&e.call(i,r)},i),r);r=n[t]=new cc.Texture2D,r.url=t;var o=cc.loader.getBasePath?cc.loader.getBasePath():cc.loader.resPath;return cc.loader.loadImg(cc.path.join(o||"",t),function(r,o){if(r)return e&&e.call(i,r);cc.loader.cache[t]||(cc.loader.cache[t]=o),cc.textureCache.handleLoadedTexture(t);var s=n[t];e&&e.call(i,s)}),r},t.addImageAsync=t.addImage,t=null},cc.ALIGN_CENTER=51,cc.ALIGN_TOP=19,cc.ALIGN_TOP_RIGHT=18,cc.ALIGN_RIGHT=50,cc.ALIGN_BOTTOM_RIGHT=34,cc.ALIGN_BOTTOM=35,cc.ALIGN_BOTTOM_LEFT=33,cc.ALIGN_LEFT=49,cc.ALIGN_TOP_LEFT=17,cc.PVRHaveAlphaPremultiplied_=!1,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var t={_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0),this._textureLoaded=!1,this._htmlElementObj=null,this._pattern=""},getPixelsWide:function(){return this._contentSize.width},getPixelsHigh:function(){return this._contentSize.height},getContentSize:function(){var t=cc.contentScaleFactor();return cc.size(this._contentSize.width/t,this._contentSize.height/t)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(t){t&&(this._htmlElementObj=t,this._contentSize.width=t.width,this._contentSize.height=t.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){var t=this;if(!t._textureLoaded){if(!t._htmlElementObj){var e=cc.loader.getRes(t.url);if(!e)return;t.initWithElement(e)}var i=t._htmlElementObj;t._contentSize.width=i.width,t._contentSize.height=i.height,t.dispatchEvent("load")}},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">"},initWithData:function(t,e,i,n,r){return!1},initWithImage:function(t){return!1},initWithString:function(t,e,i,n,r,o){return!1},releaseTexture:function(){cc.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(t){},getMaxT:function(){return 1},setMaxT:function(t){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(t){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},releaseData:function(t){t=null},keepData:function(t,e){return t},drawAtPoint:function(t){},drawInRect:function(t){},initWithETCFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(t){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile),!1},initWithPVRTCData:function(t,e,i,n,r,o){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(t,e,i,n){return void 0!==e&&(t={minFilter:t,magFilter:e,wrapS:i,wrapT:n}),t.wrapS===cc.REPEAT&&t.wrapT===cc.REPEAT?void(this._pattern="repeat"):t.wrapS===cc.REPEAT?void(this._pattern="repeat-x"):t.wrapT===cc.REPEAT?void(this._pattern="repeat-y"):void(this._pattern="")},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(t){return-1},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},removeLoadedEventListener:function(t){this.removeEventTarget("load",t)},_generateColorTexture:function(){},_generateTextureCacheForColor:function(){if(this.channelCache)return this.channelCache;var t=[document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas"),document.createElement("canvas")];return e(this._htmlElementObj,t),this.channelCache=t},_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(t){this._textureLoaded&&this._isGray!==t&&(this._isGray=t,this._isGray?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))}},e=function(t,e){var i=t.width,n=t.height;e[0].width=i,e[0].height=n,e[1].width=i,e[1].height=n,e[2].width=i,e[2].height=n,e[3].width=i,e[3].height=n;var r=e[3].getContext("2d");r.drawImage(t,0,0);for(var o,s=r.getImageData(0,0,i,n).data,c=0;c<4;c++){o=e[c].getContext("2d");for(var a=o.getImageData(0,0,i,n),l=a.data,h=0;h<s.length;h+=4)l[h]=0===c?s[h]:0,l[h+1]=1===c?s[h+1]:0,l[h+2]=2===c?s[h+2]:0,l[h+3]=s[h+3];o.putImageData(a,0,0)}t.onload=null};cc.sys._supportCanvasNewBlendModes?t._generateColorTexture=function(t,e,i,n,r){var o=!1;r?o=!0:r=document.createElement("canvas");var s=this._htmlElementObj;n||(n=cc.rect(0,0,s.width,s.height)),r.width=n.width,r.height=n.height;var c=r.getContext("2d");if(c.globalCompositeOperation="source-over",c.fillStyle="rgb("+(0|t)+","+(0|e)+","+(0|i)+")",c.fillRect(0,0,n.width,n.height),c.globalCompositeOperation="multiply",c.drawImage(s,n.x,n.y,n.width,n.height,0,0,n.width,n.height),c.globalCompositeOperation="destination-atop",c.drawImage(s,n.x,n.y,n.width,n.height,0,0,n.width,n.height),o)return r;var a=new cc.Texture2D;return a.initWithElement(r),a.handleLoadedTexture(),a}:t._generateColorTexture=function(t,e,i,n,r){var o=!1;r?o=!0:r=document.createElement("canvas");var s=this._htmlElementObj;n||(n=cc.rect(0,0,s.width,s.height));var c,a,l,h;if(c=n.x,a=n.y,l=n.width,h=n.height,l&&h){r.width=l,r.height=h;var u=r.getContext("2d"),d=cc.textureCache.getTextureColors(this);if(u.globalCompositeOperation="lighter",u.drawImage(d[3],c,a,l,h,0,0,l,h),t>0&&(u.globalAlpha=t/255,u.drawImage(d[0],c,a,l,h,0,0,l,h)),e>0&&(u.globalAlpha=e/255,u.drawImage(d[1],c,a,l,h,0,0,l,h)),i>0&&(u.globalAlpha=i/255,u.drawImage(d[2],c,a,l,h,0,0,l,h)),o)return r;var _=new cc.Texture2D;return _.initWithElement(r),_.handleLoadedTexture(),_}},cc.Texture2D=cc.Class.extend(t),cc.Texture2D._generateGrayTexture=function(t,e,i){if(null===t)return null;i=i||document.createElement("canvas"),e=e||cc.rect(0,0,t.width,t.height),i.width=e.width,i.height=e.height;var n=i.getContext("2d");n.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),o=r.data,s=0,c=o.length;s<c;s+=4)o[s]=o[s+1]=o[s+2]=.34*o[s]+.5*o[s+1]+.16*o[s+2];return n.putImageData(r,0,0),i}}else cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D);cc.EventHelper.prototype.apply(cc.Texture2D.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTexture2D(),delete cc._tmp.PrototypeTexture2D}),cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1e3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var t,e=this._loadedTexturesBefore,i=this._textures;for(t in e){var n=e[t];n.handleLoadedTexture(),i[t]=n}this._loadedTexturesBefore={}},addPVRTCImage:function(t){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(t){cc.log(cc._LogInfos.textureCache_addETCImage)},description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(t){return cc.log(cc._LogInfos.textureCache_textureForKey),this.getTextureForKey(t)},getTextureForKey:function(t){return this._textures[t]||this._textures[cc.loader._getAliase(t)]},getKeyByTexture:function(t){for(var e in this._textures)if(this._textures[e]===t)return e;return null},_generalTextureKey:function(t){return"_textureKey_"+t},getTextureColors:function(t){var e=t._htmlElementObj,i=this.getKeyByTexture(e);return i||(i=e instanceof HTMLImageElement?e.src:this._generalTextureKey(t.__instanceId)),this._textureColorsCache[i]||(this._textureColorsCache[i]=t._generateTextureCacheForColor()),this._textureColorsCache[i]},addPVRImage:function(t){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var t=this._textures;for(var e in t)t[e]&&t[e].releaseTexture();this._textures={}},removeTexture:function(t){if(t){var e=this._textures;for(var i in e)e[i]===t&&(e[i].releaseTexture(),delete e[i])}},removeTextureForKey:function(t){null!=t&&this._textures[t]&&delete this._textures[t]},cacheImage:function(t,e){if(e instanceof cc.Texture2D)return void(this._textures[t]=e);var i=new cc.Texture2D;i.initWithElement(e),i.handleLoadedTexture(),this._textures[t]=i},addUIImage:function(t,e){if(cc.assert(t,cc._LogInfos.textureCache_addUIImage_2),e&&this._textures[e])return this._textures[e];var i=new cc.Texture2D;return i.initWithImage(t),null!=e?this._textures[e]=i:cc.log(cc._LogInfos.textureCache_addUIImage),i},dumpCachedTextureInfo:function(){var t=0,e=0,i=this._textures;for(var n in i){var r=i[n];t++,r.getHtmlElementObj()instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,n,r.getHtmlElementObj().src,r.pixelsWidth,r.pixelsHeight):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,n,r.pixelsWidth,r.pixelsHeight),e+=r.pixelsWidth*r.pixelsHeight*4}var o=this._textureColorsCache;for(n in o){var s=o[n];for(var c in s){var a=s[c];t++,cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,n,a.width,a.height),e+=a.width*a.height*4}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,t,e/1024,(e/1048576).toFixed(2))},_clear:function(){this._textures={},this._textureColorsCache={},this._textureKeySeq=0|1e3*Math.random(),this._loadedTexturesBefore={}}},cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var t=cc.textureCache;t.handleLoadedTexture=function(t){var e=this._textures,i=e[t];i||(i=e[t]=new cc.Texture2D,i.url=t),i.handleLoadedTexture()},t.addImage=function(t,e,i){cc.assert(t,cc._LogInfos.Texture2D_addImage);var n=this._textures,r=n[t]||n[cc.loader._getAliase(t)];if(r)return r.isLoaded()?(e&&e.call(i,r),r):(r.addEventListener("load",function(){e&&e.call(i,r)},i),r);r=n[t]=new cc.Texture2D,r.url=t;var o=cc.loader.getBasePath?cc.loader.getBasePath():cc.loader.resPath;return cc.loader.loadImg(cc.path.join(o||"",t),function(r,o){if(r)return e&&e.call(i,r);cc.loader.cache[t]||(cc.loader.cache[t]=o),cc.textureCache.handleLoadedTexture(t);var s=n[t];e&&e.call(i,s)}),r},t.addImageAsync=t.addImage,t=null}else cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),delete cc._tmp.WebGLTextureCache)}),cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.director.getWinSize())}}),cc.Scene.create=function(){return new cc.Scene},cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",cb:null,target:null,init:function(){var t=this,e=160,i=200,n=t._bgLayer=new cc.LayerColor(cc.color(255,242,200,255));t.addChild(n,0);var r=24,o=-i/2+100;cc._loaderImage&&(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(n,r){e=r.width,i=r.height,t._initStage(r,cc.visibleRect.center)}),r=14,o=-i/2-10);var s=t._label=new cc.LabelTTF("Loading... 0%","Arial",r);return s.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,o))),s.setColor(cc.color(180,180,180)),n.addChild(this._label,10),!0},_initStage:function(t,e){var i=this,n=i._texture2d=new cc.Texture2D;n.initWithElement(t),n.handleLoadedTexture();var r=i._logo=new cc.Sprite(n);r.setScale(cc.contentScaleFactor()),r.x=e.x,r.y=e.y,i._bgLayer.addChild(r,10)},onEnter:function(){var t=this;cc.Node.prototype.onEnter.call(t),t.schedule(t._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);var t="Loading... 0%";this._label.setString(t)},initWithResources:function(t,e,i){cc.isString(t)&&(t=[t]),this.resources=t||[],this.cb=e,this.target=i},_startLoading:function(){var t=this;t.unschedule(t._startLoading);var e=t.resources;cc.loader.load(e,function(e,i,n){var r=n/i*100|0;r=Math.min(r,100),t._label.setString("Loading... "+r+"%")},function(){t.cb&&t.cb.call(t.target)})},_updateTransform:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bgLayer._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._label._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._logo._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)}}),cc.LoaderScene.preload=function(t,e,i){var n=cc;return n.loaderScene||(n.loaderScene=new cc.LoaderScene,n.loaderScene.init(),cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,function(){n.loaderScene._updateTransform()})),n.loaderScene.initWithResources(t,e,i),cc.director.runScene(n.loaderScene),n.loaderScene},cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){cc.Node.prototype.ctor.call(this),this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.winSize)},init:function(){var t=this;return t._ignoreAnchorPointForPosition=!0,t.setAnchorPoint(.5,.5),t.setContentSize(cc.winSize),t._cascadeColorEnabled=!1,t._cascadeOpacityEnabled=!1,!0},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._renderCmd._isBaked},addChild:function(t,e,i){cc.Node.prototype.addChild.call(this,t,e,i),this._renderCmd._bakeForAddChild(t)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Layer.CanvasRenderCmd(this):new cc.Layer.WebGLRenderCmd(this)}}),cc.Layer.create=function(){return new cc.Layer},cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(t,e){this.width=t,this.height=e},changeWidth:function(t){this.width=t},changeHeight:function(t){this.height=t},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},ctor:function(t,e,i){cc.Layer.prototype.ctor.call(this),this._blendFunc=cc.BlendFunc._alphaNonPremultiplied(),cc.LayerColor.prototype.init.call(this,t,e,i)},init:function(t,e,i){var n=cc.director.getWinSize();t=t||cc.color(0,0,0,255),e=void 0===e?n.width:e,i=void 0===i?n.height:i;var r=this._realColor;return r.r=t.r,r.g=t.g,r.b=t.b,this._realOpacity=t.a,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty),cc.LayerColor.prototype.setContentSize.call(this,e,i),!0},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.LayerColor.CanvasRenderCmd(this):new cc.LayerColor.WebGLRenderCmd(this)}}),cc.LayerColor.create=function(t,e,i){return new cc.LayerColor(t,e,i)},function(){var t=cc.LayerColor.prototype;cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight)}(),cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",_colorStops:[],ctor:function(t,e,i,n){cc.LayerColor.prototype.ctor.call(this),this._endColor=cc.color(0,0,0,255),this._alongVector=cc.p(0,-1),this._startOpacity=255,this._endOpacity=255,n&&n instanceof Array?(this._colorStops=n,n.splice(0,0,{p:0,color:t||cc.color.BLACK}),n.push({p:1,color:e||cc.color.BLACK})):this._colorStops=[{p:0,color:t||cc.color.BLACK},{p:1,color:e||cc.color.BLACK}],cc.LayerGradient.prototype.init.call(this,t,e,i,n)},init:function(t,e,i,n){t=t||cc.color(0,0,0,255),e=e||cc.color(0,0,0,255),i=i||cc.p(0,-1);var r=this,o=r._endColor;return r._startOpacity=t.a,o.r=e.r,o.g=e.g,o.b=e.b,r._endOpacity=e.a,r._alongVector=i,r._compressedInterpolation=!0,cc.LayerColor.prototype.init.call(r,cc.color(t.r,t.g,t.b,255)),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty),!0},setContentSize:function(t,e){cc.LayerColor.prototype.setContentSize.call(this,t,e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setWidth:function(t){cc.LayerColor.prototype._setWidth.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setHeight:function(t){cc.LayerColor.prototype._setHeight.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return cc.color(this._realColor)},setStartColor:function(t){this.color=t;var e=this._colorStops;if(e&&e.length>0){var i=e[0].color;i.r=t.r,i.g=t.g,i.b=t.b}},setEndColor:function(t){var e=this._endColor;e.r=t.r,e.g=t.g,e.b=t.b;var i=this._colorStops;if(i&&i.length>0){var n=i[i.length-1].color;n.r=t.r,n.g=t.g,n.b=t.b}this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},getEndColor:function(){return cc.color(this._endColor)},setStartOpacity:function(t){this._startOpacity=t;var e=this._colorStops;e&&e.length>0&&(e[0].color.a=t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(t){this._endOpacity=t;var e=this._colorStops;e&&e.length>0&&(e[e.length-1].color.a=t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(t){this._alongVector.x=t.x,this._alongVector.y=t.y,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(t){this._compressedInterpolation=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getColorStops:function(){return this._colorStops},setColorStops:function(t){this._colorStops=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.LayerGradient.CanvasRenderCmd(this):new cc.LayerGradient.WebGLRenderCmd(this)}}),cc.LayerGradient.create=function(t,e,i,n){return new cc.LayerGradient(t,e,i,n)},function(){var t=cc.LayerGradient.prototype;t.startColor,cc.defineGetterSetter(t,"startColor",t.getStartColor,t.setStartColor),t.endColor,cc.defineGetterSetter(t,"endColor",t.getEndColor,t.setEndColor),t.startOpacity,cc.defineGetterSetter(t,"startOpacity",t.getStartOpacity,t.setStartOpacity),t.endOpacity,cc.defineGetterSetter(t,"endOpacity",t.getEndOpacity,t.setEndOpacity),t.vector,cc.defineGetterSetter(t,"vector",t.getVector,t.setVector),t.colorStops,cc.defineGetterSetter(t,"colorStops",t.getColorStops,t.setColorStops)}(),cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(t){cc.Layer.prototype.ctor.call(this),t instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,t):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(t){return t.length>0&&null==t[t.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),this._layers=t,this._enabledLayer=0,this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(t){return t>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=t,void this.addChild(this._layers[t]))},switchToAndReleaseMe:function(t){return t>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=t,void this.addChild(this._layers[t]))},addLayer:function(t){return t?void this._layers.push(t):void cc.log(cc._LogInfos.LayerMultiplex_addLayer)}}),cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))},function(){cc.Layer.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._isBaked=!1,this._bakeSprite=null,this._canUseDirtyRegion=!0,this._updateCache=2};var t=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.Layer.CanvasRenderCmd,t._setCacheDirty=function(t){if(t&&0===this._updateCache&&(this._updateCache=2),this._cacheDirty===!1){this._cacheDirty=!0;var e=this._cachedParent;e&&e!==this&&e._setNodeDirtyForCache&&e._setNodeDirtyForCache()}},t.updateStatus=function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.orderDirty&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag=e&t.orderDirty^e),cc.Node.RenderCmd.prototype.updateStatus.call(this)},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.orderDirty&&(this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2),this._dirtyFlag=i&e.orderDirty^i),cc.Node.RenderCmd.prototype._syncStatus.call(this,t)},t.transform=function(t,e){var i=this._worldTransform,n=i.a,r=i.b,o=i.c,s=i.d;i.tx,i.ty;cc.Node.CanvasRenderCmd.prototype.transform.call(this,t,e),i.a===n&&i.b===r&&i.c===o&&i.d===s||0!==this._updateCache||(this._updateCache=2)},t.bake=function(){if(!this._isBaked){this._needDraw=!0,cc.renderer.childrenOrderDirty=!0,this._isBaked=this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var t=this._node._children,e=0,i=t.length;e<i;e++)t[e]._renderCmd._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new cc.BakeSprite,this._bakeSprite.setAnchorPoint(0,0))}},t.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=!0,this._needDraw=!1,this._isBaked=!1,this._cacheDirty=!0,0===this._updateCache&&(this._updateCache=2);for(var t=this._node._children,e=0,i=t.length;e<i;e++)t[e]._renderCmd._setCachedParent(null)}},t.isBaked=function(){return this._isBaked},t.rendering=function(){if(this._cacheDirty){var t=this._node,e=t._children,i=this._bakeSprite;this.transform(this.getParentRenderCmd(),!0);var n=this._getBoundingBoxForBake();n.width=0|n.width+.5,n.height=0|n.height+.5;var r=i.getCacheContext(),o=r.getContext();if(i.setPosition(n.x,n.y),this._updateCache>0){i.resetCanvasSize(n.width,n.height),r.setOffset(0-n.x,o.canvas.height-n.height+n.y),t.sortAllChildren(),cc.renderer._turnToCacheMode(this.__instanceId);for(var s=0,c=e.length;s<c;s++)e[s].visit(this);cc.renderer._renderingToCacheCanvas(r,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},t.visit=function(t){if(!this._isBaked)return void this.originVisit(t);var e=this._node,i=e._children,n=i.length;e._visible&&0!==n&&(this._syncStatus(t),cc.renderer.pushRenderCommand(this),this._bakeSprite.visit(this),this._dirtyFlag=0)},t._bakeForAddChild=function(t){t._parent===this._node&&this._isBaked&&t._renderCmd._setCachedParent(this)},t._getBoundingBoxForBake=function(){var t=null,e=this._node;if(!e._children||0===e._children.length)return cc.rect(0,0,10,10);for(var i=e.getNodeToWorldTransform(),n=e._children,r=0,o=n.length;r<o;r++){var s=n[r];if(s&&s._visible)if(t){var c=s._getBoundingBoxToCurrentNode(i);c&&(t=cc.rectUnion(t,c))}else t=s._getBoundingBoxToCurrentNode(i)}return t}}(),function(){cc.LayerColor.CanvasRenderCmd=function(t){cc.Layer.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._blendFuncStr="source-over",this._bakeRenderCmd=new cc.CustomRenderCmd(this,this._bakeRendering)};var t=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);t.constructor=cc.LayerColor.CanvasRenderCmd,t.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this),this._needDraw=!0},t.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),o=this._node,s=this._displayedColor,c=this._displayedOpacity/255,a=o._contentSize.width,l=o._contentSize.height;0!==c&&(n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(c),n.setFillStyle("rgba("+(0|s.r)+","+(0|s.g)+","+(0|s.b)+", 1)"),n.setTransform(this._worldTransform,e,i),r.fillRect(0,0,a,-l),cc.g_NumberOfDraws++)},t.updateBlendFunc=function(t){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},t._updateSquareVertices=t._updateSquareVerticesWidth=t._updateSquareVerticesHeight=function(){},t._bakeRendering=function(){if(this._cacheDirty){var t,e=this._node,i=this._bakeSprite,n=e._children,r=n.length;this.transform(this.getParentRenderCmd(),!0);var o=this._getBoundingBoxForBake();o.width=0|o.width+.5,o.height=0|o.height+.5;var s=i.getCacheContext(),c=s.getContext();if(i.setPosition(o.x,o.y),this._updateCache>0){c.fillStyle=s._currentFillStyle,i.resetCanvasSize(o.width,o.height),s.setOffset(0-o.x,c.canvas.height-o.height+o.y);var a;if(cc.renderer._turnToCacheMode(this.__instanceId),r>0){for(e.sortAllChildren(),t=0;t<r&&(a=n[t],a._localZOrder<0);t++)a._renderCmd.visit(this);for(cc.renderer.pushRenderCommand(this);t<r;t++)n[t]._renderCmd.visit(this)}else cc.renderer.pushRenderCommand(this);cc.renderer._renderingToCacheCanvas(s,this.__instanceId),i.transform(),this._updateCache--}this._cacheDirty=!1}},t.visit=function(t){if(!this._isBaked)return void this.originVisit();var e=this._node;e._visible&&(this._syncStatus(t),cc.renderer.pushRenderCommand(this._bakeRenderCmd),this._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bakeSprite.visit(this),this._dirtyFlag=0)},t._getBoundingBoxForBake=function(){var t=this._node,e=cc.rect(0,0,t._contentSize.width,t._contentSize.height),i=t.getNodeToWorldTransform();if(e=cc.rectApplyAffineTransform(e,t.getNodeToWorldTransform()),!t._children||0===t._children.length)return e;for(var n=t._children,r=0;r<n.length;r++){var o=n[r];if(o&&o._visible){var s=o._getBoundingBoxToCurrentNode(i);e=cc.rectUnion(e,s)}}return e}}(),function(){cc.LayerGradient.CanvasRenderCmd=function(t){cc.LayerColor.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._startPoint=cc.p(0,0),this._endPoint=cc.p(0,0),this._startStopStr=null,this._endStopStr=null};var t=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);t.constructor=cc.LayerGradient.CanvasRenderCmd,t.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),o=this._node,s=this._displayedOpacity/255;if(0!==s){var c=o._contentSize.width,a=o._contentSize.height;n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(s);var l=r.createLinearGradient(this._startPoint.x,this._startPoint.y,this._endPoint.x,this._endPoint.y);if(o._colorStops)for(var h=0;h<o._colorStops.length;h++){var u=o._colorStops[h];l.addColorStop(u.p,this._colorStopsStr[h])}else l.addColorStop(0,this._startStopStr),l.addColorStop(1,this._endStopStr);n.setFillStyle(l),n.setTransform(this._worldTransform,e,i),r.fillRect(0,0,c,-a),cc.g_NumberOfDraws++}},t.updateStatus=function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._dirtyFlag=e&t.gradientDirty^e),cc.Node.RenderCmd.prototype.updateStatus.call(this)},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._dirtyFlag=i&e.gradientDirty^i),cc.Node.RenderCmd.prototype._syncStatus.call(this,t)},t._updateColor=function(){var t=this._node,e=t._contentSize,i=.5*e.width,n=.5*e.height,r=cc.pAngleSigned(cc.p(0,-1),t._alongVector),o=cc.pRotateByAngle(cc.p(0,-1),cc.p(0,0),r),s=Math.min(Math.abs(1/o.x),Math.abs(1/o.y));this._startPoint.x=i*(-o.x*s)+i,this._startPoint.y=n*(o.y*s)-n,this._endPoint.x=i*(o.x*s)+i,this._endPoint.y=n*(-o.y*s)-n;var c=this._displayedColor,a=t._endColor,l=t._startOpacity/255,h=t._endOpacity/255;if(this._startStopStr="rgba("+Math.round(c.r)+","+Math.round(c.g)+","+Math.round(c.b)+","+l.toFixed(4)+")",this._endStopStr="rgba("+Math.round(a.r)+","+Math.round(a.g)+","+Math.round(a.b)+","+h.toFixed(4)+")",t._colorStops){this._startOpacity=0,this._endOpacity=0,this._colorStopsStr=[];for(var u=0;u<t._colorStops.length;u++){var d=t._colorStops[u].color,_=null==d.a?1:d.a/255;this._colorStopsStr.push("rgba("+Math.round(d.r)+","+Math.round(d.g)+","+Math.round(d.b)+","+_.toFixed(4)+")")}}}}(),cc._tmp.PrototypeSprite=function(){var t=cc.Sprite.prototype;cc.defineGetterSetter(t,"opacityModifyRGB",t.isOpacityModifyRGB,t.setOpacityModifyRGB),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),t.dirty,t.flippedX,cc.defineGetterSetter(t,"flippedX",t.isFlippedX,t.setFlippedX),t.flippedY,cc.defineGetterSetter(t,"flippedY",t.isFlippedY,t.setFlippedY),t.offsetX,cc.defineGetterSetter(t,"offsetX",t._getOffsetX),t.offsetY,cc.defineGetterSetter(t,"offsetY",t._getOffsetY),t.atlasIndex,t.texture,cc.defineGetterSetter(t,"texture",t.getTexture,t.setTexture),t.textureRectRotated,cc.defineGetterSetter(t,"textureRectRotated",t.isTextureRectRotated),t.textureAtlas,t.batchNode,cc.defineGetterSetter(t,"batchNode",t.getBatchNode,t.setBatchNode),t.quad,cc.defineGetterSetter(t,"quad",t.getQuad)},cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(t,e,i){var n=this;cc.Node.prototype.ctor.call(n),this.setAnchorPoint(.5,.5),n._loader=new cc.Sprite.LoadManager,n._shouldBeHidden=!1,n._offsetPosition=cc.p(0,0),n._unflippedOffsetPositionFromCenter=cc.p(0,0),n._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},n._rect=cc.rect(0,0,0,0),n._softInit(t,e,i)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},isDirty:function(){return this.dirty},setDirty:function(t){this.dirty=t},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(t){return cc.assert(t,cc._LogInfos.Sprite_initWithSpriteFrame),this.setSpriteFrame(t)},initWithSpriteFrameName:function(t){cc.assert(t,cc._LogInfos.Sprite_initWithSpriteFrameName);var e=cc.spriteFrameCache.getSpriteFrame(t);return cc.assert(e,t+cc._LogInfos.Sprite_initWithSpriteFrameName1),this.initWithSpriteFrame(e)},useBatchNode:function(t){this.textureAtlas=t.getTextureAtlas(),this._batchNode=t},setVertexRect:function(t){var e=this._rect;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},sortAllChildren:function(){if(this._reorderChildDirty){var t=this._children;cc.Node.prototype.sortAllChildren.call(this),this._batchNode&&this._arrayMakeObjectsPerformSelector(t,cc.Node._stateCallbackType.sortAllChildren),this._reorderChildDirty=!1}},reorderChild:function(t,e){return cc.assert(t,cc._LogInfos.Sprite_reorderChild_2),this._children.indexOf(t)===-1?void cc.log(cc._LogInfos.Sprite_reorderChild):void(e!==t.zIndex&&(this._batchNode&&!this._reorderChildDirty&&(this._setReorderChildDirtyRecursively(),this._batchNode.reorderBatch(!0)),cc.Node.prototype.reorderChild.call(this,t,e)))},removeChild:function(t,e){this._batchNode&&this._batchNode.removeSpriteFromAtlas(t),cc.Node.prototype.removeChild.call(this,t,e)},setVisible:function(t){cc.Node.prototype.setVisible.call(this,t),this._renderCmd.setDirtyRecursively(!0)},removeAllChildren:function(t){var e=this._children,i=this._batchNode;if(i&&null!=e)for(var n=0,r=e.length;n<r;n++)i.removeSpriteFromAtlas(e[n]);cc.Node.prototype.removeAllChildren.call(this,t),this._hasChildren=!1},ignoreAnchorPointForPosition:function(t){return this._batchNode?void cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition):void cc.Node.prototype.ignoreAnchorPointForPosition.call(this,t)},setFlippedX:function(t){this._flippedX!==t&&(this._flippedX=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(t){this._flippedY!==t&&(this._flippedY=t,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(t){this._opacityModifyRGB!==t&&(this._opacityModifyRGB=t,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(t,e){cc.assert(t,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var i=cc.animationCache.getAnimation(t);if(!i)return void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName);var n=i.getFrames()[e];return n?void this.setSpriteFrame(n.getSpriteFrame()):void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2)},getBatchNode:function(){return this._batchNode},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=!0;for(var t=this._parent;t&&t!==this._batchNode;)t._setReorderChildDirtyRecursively(),t=t.parent}},getTexture:function(){return this._texture},_softInit:function(t,e,i){if(void 0===t)cc.Sprite.prototype.init.call(this);else if(cc.isString(t))if("#"===t[0]){var n=t.substr(1,t.length-1),r=cc.spriteFrameCache.getSpriteFrame(n);r?this.initWithSpriteFrame(r):cc.log("%s does not exist",t)}else cc.Sprite.prototype.init.call(this,t,e);else if("object"==typeof t)if(t instanceof cc.Texture2D)this.initWithTexture(t,e,i);else if(t instanceof cc.SpriteFrame)this.initWithSpriteFrame(t);else if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var o=new cc.Texture2D;o.initWithElement(t),o.handleLoadedTexture(),this.initWithTexture(o)}},getQuad:function(){return null},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e),this._renderCmd.updateBlendFunc(i)},init:function(){var t=this;return arguments.length>0?t.initWithFile(arguments[0],arguments[1]):(cc.Node.prototype.init.call(t),t.dirty=t._recursiveDirty=!1,t._blendFunc.src=cc.BLEND_SRC,t._blendFunc.dst=cc.BLEND_DST,t.texture=null,t._flippedX=t._flippedY=!1,t.anchorX=.5,t.anchorY=.5,t._offsetPosition.x=0,t._offsetPosition.y=0,t._hasChildren=!1,t.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},initWithFile:function(t,e){cc.assert(t,cc._LogInfos.Sprite_initWithFile);var i=cc.textureCache.getTextureForKey(t);if(i||(i=cc.textureCache.addImage(t)),!i.isLoaded())return this._loader.clear(),this._loader.once(i,function(){this.initWithFile(t,e),this.dispatchEvent("load")},this),!1;if(!e){var n=i.getContentSize();e=cc.rect(0,0,n.width,n.height)}return this.initWithTexture(i,e)},initWithTexture:function(t,e,i,n){var r=this;return cc.assert(0!==arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture),this._loader.clear(),r._textureLoaded=t.isLoaded(),r._textureLoaded?(i=i||!1,t=this._renderCmd._handleTextureForRotatedTexture(t,e,i,n),!!cc.Node.prototype.init.call(r)&&(r._batchNode=null,r._recursiveDirty=!1,r.dirty=!1,r._opacityModifyRGB=!0,r._blendFunc.src=cc.BLEND_SRC,r._blendFunc.dst=cc.BLEND_DST,r._flippedX=r._flippedY=!1,r._offsetPosition.x=0,r._offsetPosition.y=0,r._hasChildren=!1,r._rectRotated=i,e&&(r._rect.x=e.x,r._rect.y=e.y,r._rect.width=e.width,r._rect.height=e.height),e||(e=cc.rect(0,0,t.width,t.height)),this._renderCmd._checkTextureBoundary(t,e,i),r.setTexture(t),r.setTextureRect(e,i),r.setBatchNode(null),!0)):(this._loader.once(t,function(){this.initWithTexture(t,e,i,n),this.dispatchEvent("load")},this),!1)},setTextureRect:function(t,e,i,n){var r=this;r._rectRotated=e||!1,r.setContentSize(i||t),r.setVertexRect(t),r._renderCmd._setTextureCoords(t,n);var o=r._unflippedOffsetPositionFromCenter.x,s=r._unflippedOffsetPositionFromCenter.y;r._flippedX&&(o=-o),r._flippedY&&(s=-s);var c=r._rect;r._offsetPosition.x=o+(r._contentSize.width-c.width)/2,r._offsetPosition.y=s+(r._contentSize.height-c.height)/2},addChild:function(t,e,i){cc.assert(t,cc._LogInfos.CCSpriteBatchNode_addChild_2),null==e&&(e=t._localZOrder),null==i&&(i=t.tag),this._renderCmd._setBatchNodeForAddChild(t)&&(cc.Node.prototype.addChild.call(this,t,e,i),this._hasChildren=!0)},setSpriteFrame:function(t){var e=this;cc.isString(t)&&(t=cc.spriteFrameCache.getSpriteFrame(t),cc.assert(t,cc._LogInfos.Sprite_setSpriteFrame)),this._loader.clear(),this.setNodeDirty(!0);var i=t.getTexture();if(e._textureLoaded=t.textureLoaded(),this._loader.clear(),!e._textureLoaded)return this._loader.once(i,function(){this.setSpriteFrame(t),this.dispatchEvent("load")},this),!1;var n=t.getOffset();e._unflippedOffsetPositionFromCenter.x=n.x,e._unflippedOffsetPositionFromCenter.y=n.y,i!==e._texture&&(this._renderCmd._setTexture(i),e.setColor(e._realColor)),e.setTextureRect(t.getRect(),t.isRotated(),t.getOriginalSize())},setDisplayFrame:function(t){cc.log(cc._LogInfos.Sprite_setDisplayFrame),this.setSpriteFrame(t)},isFrameDisplayed:function(t){return this._renderCmd.isFrameDisplayed(t)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:function(t){var e=this;e._batchNode=t,e._batchNode?(e._transformToBatch=cc.affineTransformIdentity(),e.textureAtlas=e._batchNode.getTextureAtlas()):(e.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED,e.textureAtlas=null,e._recursiveDirty=!1,e.dirty=!1)},setTexture:function(t){if(!t)return this._renderCmd._setTexture(null);var e=cc.isString(t);return e&&(t=cc.textureCache.addImage(t)),this._loader.clear(),t._textureLoaded?(this._renderCmd._setTexture(t),e&&this._changeRectWithTexture(t),this.setColor(this._realColor),void(this._textureLoaded=!0)):(this._loader.once(t,function(){this.setTexture(t),this.dispatchEvent("load")},this),!1)},_changeRectWithTexture:function(t){var e=t._contentSize,i=cc.rect(0,0,e.width,e.height);this.setTextureRect(i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Sprite.CanvasRenderCmd(this):new cc.Sprite.WebGLRenderCmd(this)}}),cc.Sprite.create=function(t,e,i){return new cc.Sprite(t,e,i)},cc.Sprite.createWithTexture=cc.Sprite.create,cc.Sprite.createWithSpriteFrameName=cc.Sprite.create,cc.Sprite.createWithSpriteFrame=cc.Sprite.create,cc.Sprite.INDEX_NOT_INITIALIZED=-1,cc.EventHelper.prototype.apply(cc.Sprite.prototype),cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite,function(){var t=cc.Sprite.LoadManager=function(){this.list=[]};t.prototype.add=function(t,e,i){t&&t.addEventListener&&(t.addEventListener("load",e,i),this.list.push({source:t,listener:e,target:i}))},t.prototype.once=function(t,e,i){if(t&&t.addEventListener){var n=function(r){t.removeEventListener("load",n,i),e.call(i,r)};t.addEventListener("load",n,i),this.list.push({source:t,listener:n,target:i})}},t.prototype.clear=function(){for(;this.list.length>0;){var t=this.list.pop();t.source.removeEventListener("load",t.listener,t.target)}}}(),function(){cc.Sprite.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1},this._blendFuncStr="source-over",this._colorized=!1,this._canUseDirtyRegion=!0,this._textureToRender=null};var t=cc.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.Sprite.CanvasRenderCmd,t.setDirtyRecursively=function(t){},t._setTexture=function(t){var e=this._node;e._texture!==t&&(t?e._textureLoaded=t._textureLoaded:e._textureLoaded=!1,e._texture=t,this._updateColor())},t._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)},t.isFrameDisplayed=function(t){var e=this._node;return t.getTexture()===e._texture&&cc.rectEqualToRect(t.getRect(),e._rect)},t.updateBlendFunc=function(t){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(t)},t._setBatchNodeForAddChild=function(t){return!0},t._handleTextureForRotatedTexture=function(t,e,i,n){if(i&&t.isLoaded()){var r=t.getHtmlElementObj();r=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,e,n);var o=new cc.Texture2D;o.initWithElement(r),o.handleLoadedTexture(),t=o,e.x=e.y=0,this._node._rect=cc.rect(0,0,e.width,e.height)}return t},t._checkTextureBoundary=function(t,e,i){if(t&&t.url){var n=e.x+e.width,r=e.y+e.height;n>t.width&&cc.error(cc._LogInfos.RectWidth,t.url),r>t.height&&cc.error(cc._LogInfos.RectHeight,t.url)}},t.rendering=function(t,e,i){var n=this._node,r=this._textureCoord,o=this._displayedOpacity/255,s=this._textureToRender||n._texture;if((!s||0!==r.width&&0!==r.height&&s._textureLoaded)&&0!==o){var c,a=t||cc._renderContext,l=a.getContext(),h=n._offsetPosition.x,u=n._rect.height,d=n._rect.width,_=-n._offsetPosition.y-u;a.setTransform(this._worldTransform,e,i),a.setCompositeOperation(this._blendFuncStr),a.setGlobalAlpha(o),(n._flippedX||n._flippedY)&&a.save(),n._flippedX&&(h=-h-d,l.scale(-1,1)),n._flippedY&&(_=n._offsetPosition.y,l.scale(1,-1));var p,f,m,g,y,v,T,C;if(this._colorized?(p=0,f=0):(p=r.renderX,f=r.renderY),m=r.width,g=r.height,y=h,v=_,T=d,C=u,s&&s._htmlElementObj)c=s._htmlElementObj,""!==s._pattern?(a.setFillStyle(l.createPattern(c,s._pattern)),l.fillRect(y,v,T,C)):l.drawImage(c,p,f,m,g,y,v,T,C);else{var S=n._contentSize;if(r.validRect){var x=this._displayedColor;a.setFillStyle("rgba("+x.r+","+x.g+","+x.b+",1)"),l.fillRect(y,v,S.width*e,S.height*i)}}(n._flippedX||n._flippedY)&&a.restore(),cc.g_NumberOfDraws++}},t._updateColor=function(){var t=this._node,e=t._texture,i=this._textureCoord,n=this._displayedColor;e&&(255!==n.r||255!==n.g||255!==n.b?(this._textureToRender=e._generateColorTexture(n.r,n.g,n.b,i),this._colorized=!0):e&&(this._textureToRender=e,this._colorized=!1))},t._textureLoadedCallback=function(t){var e=this;if(!e._textureLoaded){e._textureLoaded=!0;var i=e._rect,n=this._renderCmd;i?cc._rectEqualToZero(i)&&(i.width=t.width,i.height=t.height):i=cc.rect(0,0,t.width,t.height),e.texture=t,e.setTextureRect(i,e._rectRotated);var r=n._displayedColor;255===r.r&&255===r.g&&255===r.b||n._updateColor(),e.setBatchNode(e._batchNode),e.dispatchEvent("load")}},t._setTextureCoords=function(t,e){void 0===e&&(e=!0);var i=this._textureCoord,n=e?cc.contentScaleFactor():1;i.renderX=i.x=0|t.x*n,i.renderY=i.y=0|t.y*n,i.width=0|t.width*n,i.height=0|t.height*n,i.validRect=!(0===i.width||0===i.height||i.x<0||i.y<0)},cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(t,e,i){if(!t)return null;if(!e)return t;i=null==i||i;var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var r=n.getContext("2d");return r.translate(n.width/2,n.height/2),i?r.rotate(-1.5707963267948966):r.rotate(1.5707963267948966),r.drawImage(t,e.x,e.y,e.height,e.width,-e.height/2,-e.width/2,e.height,e.width),n}}(),cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var t=document.createElement("canvas");t.width=t.height=10,this._cacheCanvas=t,this._cacheContext=new cc.CanvasContextWrapper(t.getContext("2d"));var e=new cc.Texture2D;e.initWithElement(t),e.handleLoadedTexture(),this.setTexture(e)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(t,e){var i=this._cacheCanvas,n=this._cacheContext,r=n._context.strokeStyle,o=n._context.fillStyle;void 0===e&&(e=t.height,t=t.width),i.width=t,i.height=e,r!==n._context.strokeStyle&&(n._context.strokeStyle=r),o!==n._context.fillStyle&&(n._context.fillStyle=o),this.getTexture().handleLoadedTexture(),this.setTextureRect(cc.rect(0,0,t,e),!1,null,!1)}}),cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(t,e,i){this._spriteFrame=t||null,this._delayPerUnit=e||0,this._userInfo=i||null},clone:function(){var t=new cc.AnimationFrame;return t.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),t},copyWithZone:function(t){return cc.clone(this)},copy:function(t){var e=new cc.AnimationFrame;return e.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),e},initWithSpriteFrame:function(t,e,i){return this._spriteFrame=t,this._delayPerUnit=e,this._userInfo=i,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(t){this._spriteFrame=t},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(t){this._delayPerUnit=t},getUserInfo:function(){return this._userInfo},setUserInfo:function(t){this._userInfo=t}}),cc.AnimationFrame.create=function(t,e,i){return new cc.AnimationFrame(t,e,i)},cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(t,e,i){if(this._frames=[],void 0===t)this.initWithSpriteFrames(null,0);else{var n=t[0];n&&(n instanceof cc.SpriteFrame?this.initWithSpriteFrames(t,e,i):n instanceof cc.AnimationFrame&&this.initWithAnimationFrames(t,e,i))}},getFrames:function(){return this._frames},setFrames:function(t){this._frames=t},addSpriteFrame:function(t){var e=new cc.AnimationFrame;e.initWithSpriteFrame(t,1,null),this._frames.push(e),this._totalDelayUnits++},addSpriteFrameWithFile:function(t){var e=cc.textureCache.addImage(t),i=cc.rect(0,0,0,0);i.width=e.width,i.height=e.height;var n=new cc.SpriteFrame(e,i);this.addSpriteFrame(n)},addSpriteFrameWithTexture:function(t,e){var i=new cc.SpriteFrame(t,e);this.addSpriteFrame(i)},initWithAnimationFrames:function(t,e,i){cc.arrayVerifyType(t,cc.AnimationFrame),this._delayPerUnit=e,this._loops=void 0===i?1:i,this._totalDelayUnits=0;var n=this._frames;n.length=0;for(var r=0;r<t.length;r++){var o=t[r];n.push(o),this._totalDelayUnits+=o.getDelayUnits()}return!0},clone:function(){var t=new cc.Animation;return t.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),t.setRestoreOriginalFrame(this._restoreOriginalFrame),t},copyWithZone:function(t){var e=new cc.Animation;return e.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),e.setRestoreOriginalFrame(this._restoreOriginalFrame),e},_copyFrames:function(){for(var t=[],e=0;e<this._frames.length;e++)t.push(this._frames[e].clone());return t},copy:function(t){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(t){this._loops=t},setRestoreOriginalFrame:function(t){this._restoreOriginalFrame=t},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(t){this._delayPerUnit=t},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(t,e,i){cc.arrayVerifyType(t,cc.SpriteFrame),this._loops=void 0===i?1:i,this._delayPerUnit=e||0,this._totalDelayUnits=0;var n=this._frames;if(n.length=0,t){for(var r=0;r<t.length;r++){var o=t[r],s=new cc.AnimationFrame;s.initWithSpriteFrame(o,1,null),n.push(s)}this._totalDelayUnits+=t.length}return!0},retain:function(){},release:function(){}}),cc.Animation.create=function(t,e,i){return new cc.Animation(t,e,i)},cc.Animation.createWithAnimationFrames=cc.Animation.create,cc.animationCache={_animations:{},addAnimation:function(t,e){this._animations[e]=t},removeAnimation:function(t){t&&this._animations[t]&&delete this._animations[t]},getAnimation:function(t){return this._animations[t]?this._animations[t]:null},_addAnimationsWithDictionary:function(t,e){var i=t.animations;if(!i)return void cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary);var n=1,r=t.properties;if(r){n=null!=r.format?parseInt(r.format):n;for(var o=r.spritesheets,s=cc.spriteFrameCache,c=cc.path,a=0;a<o.length;a++)s.addSpriteFrames(c.changeBasename(e,o[a]))}switch(n){case 1:this._parseVersion1(i);break;case 2:this._parseVersion2(i);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}},addAnimations:function(t){cc.assert(t,cc._LogInfos.animationCache_addAnimations_2);var e=cc.loader.getRes(t);return e?void this._addAnimationsWithDictionary(e,t):void cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(t){var e=cc.spriteFrameCache;for(var i in t){var n=t[i],r=n.frames,o=parseFloat(n.delay)||0,s=null;if(r){for(var c=[],a=0;a<r.length;a++){var l=e.getSpriteFrame(r[a]);if(l){var h=new cc.AnimationFrame;h.initWithSpriteFrame(l,1,null),c.push(h)}else cc.log(cc._LogInfos.animationCache__parseVersion1_2,i,r[a])}0!==c.length?(c.length!==r.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,i),s=new cc.Animation(c,o,1),cc.animationCache.addAnimation(s,i)):cc.log(cc._LogInfos.animationCache__parseVersion1_3,i)}else cc.log(cc._LogInfos.animationCache__parseVersion1,i)}},_parseVersion2:function(t){var e=cc.spriteFrameCache;for(var i in t){var n=t[i],r=n.loop,o=parseInt(n.loops),s=r?cc.REPEAT_FOREVER:isNaN(o)?1:o,c=!(!n.restoreOriginalFrame||1!=n.restoreOriginalFrame),a=n.frames;if(a){for(var l=[],h=0;h<a.length;h++){var u=a[h],d=u.spriteframe,_=e.getSpriteFrame(d);if(_){var p=parseFloat(u.delayUnits)||0,f=u.notification,m=new cc.AnimationFrame;m.initWithSpriteFrame(_,p,f),l.push(m)}else cc.log(cc._LogInfos.animationCache__parseVersion2_2,i,d)}var g=parseFloat(n.delayPerUnit)||0,y=new cc.Animation;y.initWithAnimationFrames(l,g,s),y.setRestoreOriginalFrame(c),cc.animationCache.addAnimation(y,i)}else cc.log(cc._LogInfos.animationCache__parseVersion2,i)}},_clear:function(){this._animations={}}};cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(t,e,i,n,r){this._offset=cc.p(0,0),this._offsetInPixels=cc.p(0,0),this._originalSize=cc.size(0,0),this._rotated=!1,this._originalSizeInPixels=cc.size(0,0),this._textureFilename="",this._texture=null,this._textureLoaded=!1,void 0!==t&&void 0!==e&&(void 0===i||void 0===n||void 0===r?this.initWithTexture(t,e):this.initWithTexture(t,e,i,n,r))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},getRectInPixels:function(){var t=this._rectInPixels;return cc.rect(t.x,t.y,t.width,t.height)},setRectInPixels:function(t){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0)),this._rectInPixels.x=t.x,this._rectInPixels.y=t.y,this._rectInPixels.width=t.width,this._rectInPixels.height=t.height,this._rect=cc.rectPixelsToPoints(t)},isRotated:function(){return this._rotated},setRotated:function(t){this._rotated=t},getRect:function(){var t=this._rect;return cc.rect(t.x,t.y,t.width,t.height)},setRect:function(t){this._rect||(this._rect=cc.rect(0,0,0,0)),this._rect.x=t.x,this._rect.y=t.y,this._rect.width=t.width,this._rect.height=t.height,this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},setOffsetInPixels:function(t){this._offsetInPixels.x=t.x,this._offsetInPixels.y=t.y,cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(t){this._originalSizeInPixels.width=t.width,this._originalSizeInPixels.height=t.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(t){this._originalSize.width=t.width,this._originalSize.height=t.height},getTexture:function(){if(this._texture)return this._texture;if(""!==this._textureFilename){var t=cc.textureCache.addImage(this._textureFilename);return t&&(this._textureLoaded=t.isLoaded()),t}return null},setTexture:function(t){if(this._texture!==t){var e=t.isLoaded();this._textureLoaded=e,this._texture=t,e||t.addEventListener("load",function(t){if(this._textureLoaded=!0,this._rotated&&cc._renderType===cc.game.RENDER_TYPE_CANVAS){var e=t.getHtmlElementObj();e=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(e,this.getRect());var i=new cc.Texture2D;i.initWithElement(e),i.handleLoadedTexture(),this.setTexture(i);var n=this.getRect();this.setRect(cc.rect(0,0,n.width,n.height))}var r=this._rect;if(0===r.width&&0===r.height){var o=t.width,s=t.height;this._rect.width=o,this._rect.height=s,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=o,this._originalSize.height=s}this.dispatchEvent("load")},this)}},getOffset:function(){return cc.p(this._offset)},setOffset:function(t){this._offset.x=t.x,this._offset.y=t.y},clone:function(){var t=new cc.SpriteFrame;return t.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),t.setTexture(this._texture),t},copyWithZone:function(){var t=new cc.SpriteFrame;return t.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),t.setTexture(this._texture),t},copy:function(){return this.copyWithZone()},initWithTexture:function(t,e,i,n,r){if(2===arguments.length&&(e=cc.rectPointsToPixels(e)),n=n||cc.p(0,0),r=r||e,i=i||!1,cc.isString(t)?(this._texture=null,this._textureFilename=t):t instanceof cc.Texture2D&&this.setTexture(t),t=this.getTexture(),this._rectInPixels=e,this._rect=cc.rectPixelsToPoints(e),t&&t.url&&t.isLoaded()){var o,s;i?(o=e.x+e.height,s=e.y+e.width):(o=e.x+e.width,s=e.y+e.height),o>t.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,t.url),s>t.getPixelsHigh()&&cc.error(cc._LogInfos.RectHeight,t.url)}return this._offsetInPixels.x=n.x,this._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(n,this._offset),this._originalSizeInPixels.width=r.width,this._originalSizeInPixels.height=r.height,cc._sizePixelsToPointsOut(r,this._originalSize),this._rotated=i,!0}});cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype),cc.SpriteFrame.create=function(t,e,i,n,r){return new cc.SpriteFrame(t,e,i,n,r)},cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create,cc.SpriteFrame._frameWithTextureForCanvas=function(t,e,i,n,r){var o=new cc.SpriteFrame;return o._texture=t,o._rectInPixels=e,o._rect=cc.rectPixelsToPoints(e),o._offsetInPixels.x=n.x,o._offsetInPixels.y=n.y,cc._pointPixelsToPointsOut(o._offsetInPixels,o._offset),o._originalSizeInPixels.width=r.width,o._originalSizeInPixels.height=r.height,cc._sizePixelsToPointsOut(o._originalSizeInPixels,o._originalSize),o._rotated=i,o},cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(t){var e=this._CCNS_REG2.exec(t);return e?cc.rect(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])):cc.rect(0,0,0,0)},_pointFromString:function(t){var e=this._CCNS_REG1.exec(t);return e?cc.p(parseFloat(e[1]),parseFloat(e[2])):cc.p(0,0)},_sizeFromString:function(t){var e=this._CCNS_REG1.exec(t);return e?cc.size(parseFloat(e[1]),parseFloat(e[2])):cc.size(0,0)},_getFrameConfig:function(t){var e=cc.loader.getRes(t);return cc.assert(e,cc._LogInfos.spriteFrameCache__getFrameConfig_2,t),cc.loader.release(t),e._inited?(this._frameConfigCache[t]=e,e):(this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t])},_getFrameConfigByJsonObject:function(t,e){return cc.assert(e,cc._LogInfos.spriteFrameCache__getFrameConfig_2,t),this._frameConfigCache[t]=this._parseFrameConfig(e),this._frameConfigCache[t]},_parseFrameConfig:function(t){var e=t.frames,i=t.metadata||t.meta,n={},r={},o=0;if(i){var s=i.format;o=s.length<=1?parseInt(s):s,r.image=i.textureFileName||i.textureFileName||i.image}for(var c in e){var a=e[c];if(a){var l={};if(0==o){l.rect=cc.rect(a.x,a.y,a.width,a.height),l.rotated=!1,l.offset=cc.p(a.offsetX,a.offsetY);var h=a.originalWidth,u=a.originalHeight;h&&u||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig),h=Math.abs(h),u=Math.abs(u),l.size=cc.size(h,u)}else if(1==o||2==o)l.rect=this._rectFromString(a.frame),l.rotated=a.rotated||!1,l.offset=this._pointFromString(a.offset),l.size=this._sizeFromString(a.sourceSize);else if(3==o){var d=this._sizeFromString(a.spriteSize),_=this._rectFromString(a.textureRect);d&&(_=cc.rect(_.x,_.y,d.width,d.height)),l.rect=_,l.rotated=a.textureRotated||!1,l.offset=this._pointFromString(a.spriteOffset),l.size=this._sizeFromString(a.spriteSourceSize),l.aliases=a.aliases}else{var p=a.frame,f=a.sourceSize;c=a.filename||c,l.rect=cc.rect(p.x,p.y,p.w,p.h),l.rotated=a.rotated||!1,l.offset=cc.p(0,0),l.size=cc.size(f.w,f.h)}n[c]=l}}return{_inited:!0,frames:n,meta:r}},_addSpriteFramesByObject:function(t,e,i){if(cc.assert(t,cc._LogInfos.spriteFrameCache_addSpriteFrames_2),e&&e.frames){var n=this._frameConfigCache[t]||this._getFrameConfigByJsonObject(t,e);this._createSpriteFrames(t,n,i)}},_createSpriteFrames:function(t,e,i){var n=e.frames,r=e.meta;if(i)i instanceof cc.Texture2D||(cc.isString(i)?i=cc.textureCache.addImage(i):cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3));else{var o=cc.path.changeBasename(t,r.image||".png");i=cc.textureCache.addImage(o)}var s=this._spriteFramesAliases,c=this._spriteFrames;for(var a in n){var l=n[a],h=c[a];if(!h){h=new cc.SpriteFrame(i,l.rect,l.rotated,l.offset,l.size);var u=l.aliases;if(u)for(var d=0,_=u.length;d<_;d++){var p=u[d];s[p]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,p),s[p]=a}if(cc._renderType===cc.game.RENDER_TYPE_CANVAS&&h.isRotated()){var f=h.getTexture();if(f.isLoaded()){var m=h.getTexture().getHtmlElementObj();m=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(m,h.getRectInPixels());var g=new cc.Texture2D;g.initWithElement(m),g.handleLoadedTexture(),h.setTexture(g);var y=h._rect;h.setRect(cc.rect(0,0,y.width,y.height))}}c[a]=h}}},addSpriteFrames:function(t,e){cc.assert(t,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var i=this._frameConfigCache[t]||cc.loader.getRes(t);if(i&&i.frames){var n=this._frameConfigCache[t]||this._getFrameConfig(t);this._createSpriteFrames(t,n,e)}},_checkConflict:function(t){var e=t.frames;for(var i in e)this._spriteFrames[i]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,i)},addSpriteFrame:function(t,e){this._spriteFrames[e]=t},removeSpriteFrames:function(){this._spriteFrames={},this._spriteFramesAliases={}},removeSpriteFrameByName:function(t){t&&(this._spriteFramesAliases[t]&&delete this._spriteFramesAliases[t],this._spriteFrames[t]&&delete this._spriteFrames[t])},removeSpriteFramesFromFile:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases,r=e._frameConfigCache[t];if(r){var o=r.frames;for(var s in o)if(i[s]){delete i[s];for(var c in n)n[c]===s&&delete n[c]}}},removeSpriteFramesFromTexture:function(t){var e=this,i=e._spriteFrames,n=e._spriteFramesAliases;for(var r in i){var o=i[r];if(o&&o.getTexture()===t){delete i[r];for(var s in n)n[s]===r&&delete n[s]}}},getSpriteFrame:function(t){var e=this,i=e._spriteFrames[t];if(!i){var n=e._spriteFramesAliases[t];n&&(i=e._spriteFrames[n.toString()],i||delete e._spriteFramesAliases[t])}return i},_clear:function(){this._spriteFrames={},this._spriteFramesAliases={},this._frameConfigCache={}}},cc.g_NumberOfDraws=0,cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_contentScaleFactor:1,_deltaTime:0,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterUpdate:null,_eventAfterVisit:null,_eventAfterDraw:null,ctor:function(){var t=this;t._lastUpdate=Date.now(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){t._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=null,this._totalFrames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._actionManager=null,this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW),this._eventAfterDraw.setUserData(this),this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),!0},calculateDeltaTime:function(){var t=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(t-this._lastUpdate)/1e3,cc.game.config[cc.game.CONFIG_KEY.debugMode]>0&&this._deltaTime>.2&&(this._deltaTime=1/60),this._lastUpdate=t},convertToGL:function(t){var e=document.documentElement,i=cc.view,n=element.getBoundingClientRect();n.left+=window.pageXOffset-e.clientLeft,n.top+=window.pageYOffset-e.clientTop;var r=i._devicePixelRatio*(t.x-n.left),o=i._devicePixelRatio*(n.top+n.height-t.y);return i._isRotated?{x:i._viewPortRect.width-o,y:r}:{x:r,y:o}},convertToUI:function(t){var e=document.documentElement,i=cc.view,n=element.getBoundingClientRect();n.left+=window.pageXOffset-e.clientLeft,n.top+=window.pageYOffset-e.clientTop;var r={x:0,y:0};return i._isRotated?(r.x=n.left+t.y/i._devicePixelRatio,r.y=n.top+n.height-(i._viewPortRect.width-t.x)/i._devicePixelRatio):(r.x=n.left+t.x/i._devicePixelRatio,r.y=n.top+n.height-t.y/i._devicePixelRatio),r},drawScene:function(){var t=cc.renderer;this.calculateDeltaTime(),this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate)),this._nextScene&&this.setNextScene(),this._beforeVisitScene&&this._beforeVisitScene(),this._runningScene&&(t.childrenOrderDirty?(cc.renderer.clearRenderCommands(),cc.renderer.assignedZ=0,this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),t.resetFlag()):t.transformDirty()&&t.transform()),t.clear(),this._notificationNode&&this._notificationNode.visit(),cc.eventManager.dispatchEvent(this._eventAfterVisit),cc.g_NumberOfDraws=0,this._afterVisitScene&&this._afterVisitScene(),t.rendering(cc._renderContext),this._totalFrames++,cc.eventManager.dispatchEvent(this._eventAfterDraw),this._calculateMPF()},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene),this._scenesStack.pop();var t=this._scenesStack.length;0===t?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[t-1])},purgeCachedData:function(){cc.animationCache._clear(),cc.spriteFrameCache._clear(),cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll(),cc.eventManager&&cc.eventManager.setEnabled(!1),this._runningScene&&(this._runningScene.onExitTransitionDidStart(),this._runningScene.onExit(),this._runningScene.cleanup()),this._runningScene=null,this._nextScene=null,this._scenesStack.length=0,this.stopAnimation(),this.purgeCachedData(),cc.checkGLErrorDebug()},pushScene:function(t){cc.assert(t,cc._LogInfos.Director_pushScene),this._sendCleanupToScene=!1,this._scenesStack.push(t),this._nextScene=t},runScene:function(t){if(cc.assert(t,cc._LogInfos.Director_pushScene),this._runningScene){var e=this._scenesStack.length;0===e?(this._sendCleanupToScene=!0,this._scenesStack[e]=t,this._nextScene=t):(this._sendCleanupToScene=!0,this._scenesStack[e-1]=t,this._nextScene=t)}else this.pushScene(t),this.startAnimation()},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(t){t!==this._contentScaleFactor&&(this._contentScaleFactor=t)},setDepthTest:null,setClearColor:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(t){this._nextDeltaTimeZero=t},setNextScene:function(){var t=!1,e=!1;if(cc.TransitionScene&&(t=!!this._runningScene&&this._runningScene instanceof cc.TransitionScene,e=!!this._nextScene&&this._nextScene instanceof cc.TransitionScene),!e){var i=this._runningScene;i&&(i.onExitTransitionDidStart(),i.onExit()),this._sendCleanupToScene&&i&&i.cleanup()}this._runningScene=this._nextScene,cc.renderer.childrenOrderDirty=!0,this._nextScene=null,t||null===this._runningScene||(this._runningScene.onEnter(),this._runningScene.onEnterTransitionDidFinish())},setNotificationNode:function(t){cc.renderer.childrenOrderDirty=!0,this._notificationNode&&(this._notificationNode.onExitTransitionDidStart(),this._notificationNode.onExit(),this._notificationNode.cleanup()),this._notificationNode=t,t&&(this._notificationNode.onEnter(),this._notificationNode.onEnterTransitionDidFinish())},getDelegate:function(){return this._projectionDelegate},setDelegate:function(t){this._projectionDelegate=t},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(t){cc.profiler&&(t?cc.profiler.showStats():cc.profiler.hideStats())},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(t){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var e=this._scenesStack,i=e.length;if(0===t)return void this.end();if(!(t>=i)){for(;i>t;){var n=e.pop();n.running&&(n.onExitTransitionDidStart(),n.onExit()),n.cleanup(),i--}this._nextScene=e[e.length-1],this._sendCleanupToScene=!0}},getScheduler:function(){return this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this._scheduler=t)},getActionManager:function(){return this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this._actionManager=t)},getDeltaTime:function(){return this._deltaTime},_calculateMPF:function(){var t=Date.now();this._secondsPerFrame=(t-this._lastUpdate)/1e3}}),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_AFTER_VISIT="director_after_visit",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0,this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(t){this._animationInterval=t,this.invalid||(this.stopAnimation(),this.startAnimation())}}),cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){var t=cc.Director.prototype;t.getProjection=function(t){return this._projection},t.setProjection=function(t){this._projection=t,cc.eventManager.dispatchEvent(this._eventProjectionChanged)},t.setDepthTest=function(){},t.setClearColor=function(t){cc.renderer._clearColor=t,cc.renderer._clearFillStyle="rgb("+t.r+","+t.g+","+t.b+")"},t.setOpenGLView=function(t){this._winSizeInPoints.width=cc._canvas.width,this._winSizeInPoints.height=cc._canvas.height,this._openGLView=t||cc.view,cc.eventManager&&cc.eventManager.setEnabled(!0)},t.getVisibleSize=function(){return this.getWinSize()},t.getVisibleOrigin=function(){return cc.p(0,0)}}else cc.Director._fpsImage=new Image,cc.Director._fpsImage.addEventListener("load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage)}),cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1,cc.ListEntry=function(t,e,i,n,r,o,s){this.prev=t,this.next=e,this.callback=i,this.target=n,this.priority=r,this.paused=o,this.markedForDeletion=s},cc.HashUpdateEntry=function(t,e,i,n,r){this.list=t,this.entry=e,this.target=i,this.callback=n,this.hh=r},cc.HashTimerEntry=cc.hashSelectorEntry=function(t,e,i,n,r,o,s){var c=this;c.timers=t,c.target=e,c.timerIndex=i,c.currentTimer=n,c.currentTimerSalvaged=r,c.paused=o,c.hh=s},cc.Timer=cc.Class.extend({_scheduler:null,_elapsed:0,_runForever:!1,_useDelay:!1,_timesExecuted:0,_repeat:0,_delay:0,_interval:0,getInterval:function(){return this._interval},setInterval:function(t){this._interval=t},setupTimerWithInterval:function(t,e,i){this._elapsed=-1,this._interval=t,this._delay=i,this._useDelay=this._delay>0,this._repeat=e,this._runForever=this._repeat===cc.REPEAT_FOREVER},trigger:function(){return 0},cancel:function(){return 0},ctor:function(){this._scheduler=null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0},update:function(t){this._elapsed===-1?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=t,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))}}),cc.TimerTargetSelector=cc.Timer.extend({_target:null,_selector:null,ctor:function(){this._target=null,this._selector=null},initWithSelector:function(t,e,i,n,r,o){return this._scheduler=t,this._target=i,this._selector=e,this.setupTimerWithInterval(n,r,o),!0},getSelector:function(){return this._selector},trigger:function(){this._target&&this._selector&&this._target.call(this._selector,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._selector,this._target)}}),cc.TimerTargetCallback=cc.Timer.extend({_target:null,_callback:null,_key:null,ctor:function(){this._target=null,this._callback=null},initWithCallback:function(t,e,i,n,r,o,s){return this._scheduler=t,this._target=i,this._callback=e,this._key=n,this.setupTimerWithInterval(r,o,s),!0},getCallback:function(){return this._callback},getKey:function(){return this._key},trigger:function(){this._callback&&this._callback.call(this._target,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._callback,this._target)}}),cc.Scheduler=cc.Class.extend({_timeScale:1,_updatesNegList:null,_updates0List:null,_updatesPosList:null,_hashForTimers:null,_arrayForTimers:null,_hashForUpdates:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,ctor:function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates={},this._hashForTimers={},this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},_schedulePerFrame:function(t,e,i,n){var r=this._hashForUpdates[e.__instanceId];if(r&&r.entry){if(r.entry.priority===i)return r.entry.markedForDeletion=!1,void(r.entry.paused=n);if(this._updateHashLocked)return cc.log("warning: you CANNOT change update priority in scheduled function"),r.entry.markedForDeletion=!1,void(r.entry.paused=n);this.unscheduleUpdate(e)}0===i?this._appendIn(this._updates0List,t,e,n):i<0?this._priorityIn(this._updatesNegList,t,e,i,n):this._priorityIn(this._updatesPosList,t,e,i,n)},_removeHashElement:function(t){delete this._hashForTimers[t.target.__instanceId],cc.arrayRemoveObject(this._arrayForTimers,t),t.Timer=null,t.target=null,t=null},_removeUpdateFromHash:function(t){var e=this,i=e._hashForUpdates[t.target.__instanceId];i&&(cc.arrayRemoveObject(i.list,i.entry),delete e._hashForUpdates[i.target.__instanceId],i.entry=null,i.target=null)},_priorityIn:function(t,e,i,n,r){var o=this,s=new cc.ListEntry(null,null,e,i,n,r,!1);if(t){for(var c=t.length-1,a=0;a<=c;a++)if(n<t[a].priority){c=a;break}t.splice(a,0,s)}else t=[],t.push(s);return o._hashForUpdates[i.__instanceId]=new cc.HashUpdateEntry(t,s,i,null),t},_appendIn:function(t,e,i,n){var r=this,o=new cc.ListEntry(null,null,e,i,0,n,!1);t.push(o),r._hashForUpdates[i.__instanceId]=new cc.HashUpdateEntry(t,o,i,null,null)},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},update:function(t){this._updateHashLocked=!0,1!==this._timeScale&&(t*=this._timeScale);var e,i,n,r;for(e=0,i=this._updatesNegList,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||r.callback(t);for(e=0,i=this._updates0List,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||r.callback(t);for(e=0,i=this._updatesPosList,n=i.length;e<n;e++)r=i[e],r.paused||r.markedForDeletion||r.callback(t);var o,s=this._arrayForTimers;for(e=0;e<s.length;e++){if(o=s[e],this._currentTarget=o,this._currentTargetSalvaged=!1,!o.paused)for(o.timerIndex=0;o.timerIndex<o.timers.length;++o.timerIndex)o.currentTimer=o.timers[o.timerIndex],o.currentTimerSalvaged=!1,o.currentTimer.update(t),o.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&this._removeHashElement(this._currentTarget)}for(e=0,i=this._updatesNegList;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updates0List;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updatesPosList;e<i.length;)r=i[e],r.markedForDeletion?this._removeUpdateFromHash(r):e++;this._updateHashLocked=!1,this._currentTarget=null},scheduleCallbackForTarget:function(t,e,i,n,r,o){this.schedule(e,t,i,n,r,o,t.__instanceId+"")},schedule:function(t,e,i,n,r,o,s){var c=!1;if("function"!=typeof t){var a=t;c=!0}c===!1?4!==arguments.length&&5!==arguments.length||(s=r,o=n,r=0,n=cc.REPEAT_FOREVER):4===arguments.length&&(o=n,n=cc.REPEAT_FOREVER,r=0),void 0===s&&(s=e.__instanceId+""),cc.assert(e,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3);var l=this._hashForTimers[e.__instanceId];l?cc.assert(l.paused===o,""):(l=new cc.HashTimerEntry(null,e,0,null,null,o,null),this._arrayForTimers.push(l),this._hashForTimers[e.__instanceId]=l);var h,u;if(null==l.timers)l.timers=[];else if(c===!1){for(u=0;u<l.timers.length;u++)if(h=l.timers[u],t===h._callback)return cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,h.getInterval().toFixed(4),i.toFixed(4)),void(h._interval=i)}else for(u=0;u<l.timers.length;++u)if(h=l.timers[u],h&&a===h.getSelector())return cc.log("CCScheduler#scheduleSelector. Selector already scheduled. Updating interval from: %.4f to %.4f",h.getInterval(),i),void h.setInterval(i);c===!1?(h=new cc.TimerTargetCallback,h.initWithCallback(this,t,e,s,i,n,r),l.timers.push(h)):(h=new cc.TimerTargetSelector,h.initWithSelector(this,a,e,i,n,r),l.timers.push(h))},scheduleUpdate:function(t,e,i){this._schedulePerFrame(function(e){t.update(e)},t,e,i)},_getUnscheduleMark:function(t,e){switch(typeof t){case"number":case"string":return t===e.getKey();case"function":return t===e._callback;default:return t===e.getSelector()}},unschedule:function(t,e){if(e&&t){var i=this,n=i._hashForTimers[e.__instanceId];if(n)for(var r=n.timers,o=0,s=r.length;o<s;o++){var c=r[o];if(this._getUnscheduleMark(t,c))return c!==n.currentTimer||n.currentTimerSalvaged||(n.currentTimerSalvaged=!0),r.splice(o,1),n.timerIndex>=o&&n.timerIndex--,void(0===r.length&&(i._currentTarget===n?i._currentTargetSalvaged=!0:i._removeHashElement(n)))}}},unscheduleUpdate:function(t){if(null!=t){var e=this._hashForUpdates[t.__instanceId];e&&(this._updateHashLocked?e.entry.markedForDeletion=!0:this._removeUpdateFromHash(e.entry))}},unscheduleAllForTarget:function(t){if(null!=t){var e=this._hashForTimers[t.__instanceId];e&&(e.timers.indexOf(e.currentTimer)>-1&&!e.currentTimerSalvaged&&(e.currentTimerSalvaged=!0),e.timers.length=0,this._currentTarget===e?this._currentTargetSalvaged=!0:this._removeHashElement(e)),this.unscheduleUpdate(t)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(t){var e,i,n=this._arrayForTimers;for(e=n.length-1;e>=0;e--)i=n[e],this.unscheduleAllForTarget(i.target);var r,o=0;if(t<0)for(e=0;e<this._updatesNegList.length;)o=this._updatesNegList.length,r=this._updatesNegList[e],r&&r.priority>=t&&this.unscheduleUpdate(r.target),o==this._updatesNegList.length&&e++;if(t<=0)for(e=0;e<this._updates0List.length;)o=this._updates0List.length,r=this._updates0List[e],r&&this.unscheduleUpdate(r.target),o==this._updates0List.length&&e++;for(e=0;e<this._updatesPosList.length;)o=this._updatesPosList.length,r=this._updatesPosList[e],r&&r.priority>=t&&this.unscheduleUpdate(r.target),o==this._updatesPosList.length&&e++},isScheduled:function(t,e){cc.assert(t,"Argument key must not be empty"),cc.assert(e,"Argument target must be non-nullptr");var i=this._hashForUpdates[e.__instanceId];if(!i)return!1;if(null==i.timers)return!1;for(var n=i.timers,r=0;r<n.length;++r){var o=n[r];if(t===o.getKey())return!0}return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(t){var e,i,n,r=[],o=this,s=o._arrayForTimers;for(i=0,n=s.length;i<n;i++)e=s[i],e&&(e.paused=!0,r.push(e.target));var c;if(t<0)for(i=0;i<this._updatesNegList.length;i++)c=this._updatesNegList[i],c&&c.priority>=t&&(c.paused=!0,r.push(c.target));if(t<=0)for(i=0;i<this._updates0List.length;i++)c=this._updates0List[i],c&&(c.paused=!0,r.push(c.target));for(i=0;i<this._updatesPosList.length;i++)c=this._updatesPosList[i],c&&c.priority>=t&&(c.paused=!0,r.push(c.target));return r},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)this.resumeTarget(t[e])},pauseTarget:function(t){cc.assert(t,cc._LogInfos.Scheduler_pauseTarget);var e=this,i=e._hashForTimers[t.__instanceId];i&&(i.paused=!0);var n=e._hashForUpdates[t.__instanceId];n&&(n.entry.paused=!0)},resumeTarget:function(t){cc.assert(t,cc._LogInfos.Scheduler_resumeTarget);var e=this,i=e._hashForTimers[t.__instanceId];i&&(i.paused=!1);var n=e._hashForUpdates[t.__instanceId];n&&(n.entry.paused=!1)},isTargetPaused:function(t){cc.assert(t,cc._LogInfos.Scheduler_isTargetPaused);var e=this._hashForTimers[t.__instanceId];if(e)return e.paused;var i=this._hashForUpdates[t.__instanceId];return!!i&&i.entry.paused},scheduleUpdateForTarget:function(t,e,i){this.scheduleUpdate(t,e,i)},unscheduleCallbackForTarget:function(t,e){this.unschedule(e,t)},unscheduleUpdateForTarget:function(t){this.unscheduleUpdate(t)},unscheduleAllCallbacksForTarget:function(t){this.unschedule(t.__instanceId+"",t)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(t){this.unscheduleAllWithMinPriority(t)}}),cc.Scheduler.PRIORITY_SYSTEM=-2147483648,cc._tmp.PrototypeLabelTTF=function(){var t=cc.LabelTTF.prototype;cc.defineGetterSetter(t,"color",t.getColor,t.setColor),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),t.string,cc.defineGetterSetter(t,"string",t.getString,t.setString),t.textAlign,cc.defineGetterSetter(t,"textAlign",t.getHorizontalAlignment,t.setHorizontalAlignment),t.verticalAlign,cc.defineGetterSetter(t,"verticalAlign",t.getVerticalAlignment,t.setVerticalAlignment),t.fontSize,cc.defineGetterSetter(t,"fontSize",t.getFontSize,t.setFontSize),t.fontName,cc.defineGetterSetter(t,"fontName",t.getFontName,t.setFontName),t.font,cc.defineGetterSetter(t,"font",t._getFont,t._setFont),t.boundingSize,t.boundingWidth,cc.defineGetterSetter(t,"boundingWidth",t._getBoundingWidth,t._setBoundingWidth),t.boundingHeight,cc.defineGetterSetter(t,"boundingHeight",t._getBoundingHeight,t._setBoundingHeight),t.fillStyle,cc.defineGetterSetter(t,"fillStyle",t._getFillStyle,t.setFontFillColor),t.strokeStyle,cc.defineGetterSetter(t,"strokeStyle",t._getStrokeStyle,t._setStrokeStyle),t.lineWidth,cc.defineGetterSetter(t,"lineWidth",t._getLineWidth,t._setLineWidth),t.shadowOffset,t.shadowOffsetX,cc.defineGetterSetter(t,"shadowOffsetX",t._getShadowOffsetX,t._setShadowOffsetX),t.shadowOffsetY,cc.defineGetterSetter(t,"shadowOffsetY",t._getShadowOffsetY,t._setShadowOffsetY),t.shadowOpacity,cc.defineGetterSetter(t,"shadowOpacity",t._getShadowOpacity,t._setShadowOpacity),t.shadowBlur,cc.defineGetterSetter(t,"shadowBlur",t._getShadowBlur,t._setShadowBlur)},cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_onCacheCanvasMode:!0,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_fontStyle:"normal",_fontWeight:"normal",_lineHeight:"normal",initWithString:function(t,e,i,n,r,o){var s;return s=t?t+"":"",i=i||16,n=n||cc.size(0,0),r=r||cc.TEXT_ALIGNMENT_LEFT,o=o||cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=cc.size(n.width,n.height),this._fontName=e||"Arial",this._hAlignment=r,this._vAlignment=o,this._fontSize=i,this._renderCmd._setFontStyle(this._fontName,i,this._fontStyle,this._fontWeight),this.string=s,this._renderCmd._setColorsString(),this._renderCmd._updateTexture(),this._setUpdateTextureDirty(),this._scaleX=this._scaleY=1/cc.view.getDevicePixelRatio(),!0},_setUpdateTextureDirty:function(){this._needUpdateTexture=!0,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)},ctor:function(t,e,i,n,r,o){cc.Sprite.prototype.ctor.call(this),this._dimensions=cc.size(0,0),this._hAlignment=cc.TEXT_ALIGNMENT_LEFT,this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._fontName="Arial",this._shadowEnabled=!1,this._shadowOffset=cc.p(0,0),this._shadowOpacity=0,this._shadowBlur=0,this._strokeEnabled=!1,this._strokeColor=cc.color(255,255,255,255),this._strokeSize=0,this._textFillColor=cc.color(255,255,255,255),this._strokeShadowOffsetX=0,this._strokeShadowOffsetY=0,this._needUpdateTexture=!1,this._lineWidths=[],this._renderCmd._setColorsString(),this._textureLoaded=!0,e&&e instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(t,e):cc.LabelTTF.prototype.initWithString.call(this,t,e,i,n,r,o)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">"},getLineHeight:function(){return!this._lineHeight||this._lineHeight.charAt?this._renderCmd._getFontClientHeight():this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(t){this._lineHeight=t},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:function(t,e){return this._updateWithTextDefinition(e,!1),this.string=t,!0},setTextDefinition:function(t){t&&this._updateWithTextDefinition(t,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(t,e,i,n){null!=t.r&&null!=t.g&&null!=t.b&&null!=t.a?this._enableShadow(t,e,i):this._enableShadowNoneColor(t,e,i,n)},_enableShadowNoneColor:function(t,e,i,n){i=i||.5,!1===this._shadowEnabled&&(this._shadowEnabled=!0);var r=this._shadowOffset;(r&&r.x!==t||r._y!==e)&&(r.x=t,r.y=e),this._shadowOpacity!==i&&(this._shadowOpacity=i),this._renderCmd._setColorsString(),this._shadowBlur!==n&&(this._shadowBlur=n),this._setUpdateTextureDirty()},_enableShadow:function(t,e,i){this._shadowColor||(this._shadowColor=cc.color(255,255,255,128)),this._shadowColor.r=t.r,this._shadowColor.g=t.g,this._shadowColor.b=t.b;var n,r,o,s;n=e.width||e.x||0,r=e.height||e.y||0,o=null!=t.a?t.a/255:.5,s=i,this._enableShadowNoneColor(n,r,o,s)},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x!==t&&(this._shadowOffset.x=t,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset._y!==t&&(this._shadowOffset._y=t,this._setUpdateTextureDirty())},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOffset.x===t.x&&this._shadowOffset.y===t.y||(this._shadowOffset.x=t.x,this._shadowOffset.y=t.y,this._setUpdateTextureDirty())},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowOpacity!==t&&(this._shadowOpacity=t,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(t){!1===this._shadowEnabled&&(this._shadowEnabled=!0),this._shadowBlur!==t&&(this._shadowBlur=t,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(t,e){this._strokeEnabled===!1&&(this._strokeEnabled=!0);var i=this._strokeColor;i.r===t.r&&i.g===t.g&&i.b===t.b||(i.r=t.r,i.g=t.g,i.b=t.b,this._renderCmd._setColorsString()),this._strokeSize!==e&&(this._strokeSize=e||0),this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(t){this._strokeEnabled===!1&&(this._strokeEnabled=!0);var e=this._strokeColor;e.r===t.r&&e.g===t.g&&e.b===t.b||(e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(t){this._strokeEnabled===!1&&(this._strokeEnabled=!0),this._strokeSize!==t&&(this._strokeSize=t||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._setUpdateTextureDirty())},setFontFillColor:function(t){var e=this._textFillColor;e.r===t.r&&e.g===t.g&&e.b===t.b||(e.r=t.r,e.g=t.g,e.b=t.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0)},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(t,e){t.fontDimensions?(this._dimensions.width=t.boundingWidth,this._dimensions.height=t.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0),this._hAlignment=t.textAlign,this._vAlignment=t.verticalAlign,this._fontName=t.fontName,this._fontSize=t.fontSize||12,t.lineHeight?this._lineHeight=t.lineHeight:this._lineHeight=this._fontSize,this._renderCmd._setFontStyle(t),t.shadowEnabled&&this.enableShadow(t.shadowOffsetX,t.shadowOffsetY,t.shadowOpacity,t.shadowBlur),t.strokeEnabled&&this.enableStroke(t.strokeStyle,t.lineWidth),this.setFontFillColor(t.fillStyle),e&&this._renderCmd._updateTexture();var i=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(i.colorDirty|i.opacityDirty|i.textDirty)},_prepareTextDefinition:function(t){var e=new cc.FontDefinition;if(t?(e.fontSize=this._fontSize,e.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,e.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(e.fontSize=this._fontSize,e.boundingWidth=this._dimensions.width,e.boundingHeight=this._dimensions.height),e.fontName=this._fontName,e.textAlign=this._hAlignment,e.verticalAlign=this._vAlignment,this._strokeEnabled){e.strokeEnabled=!0;var i=this._strokeColor;e.strokeStyle=cc.color(i.r,i.g,i.b),e.lineWidth=this._strokeSize}else e.strokeEnabled=!1;this._shadowEnabled?(e.shadowEnabled=!0,e.shadowBlur=this._shadowBlur,e.shadowOpacity=this._shadowOpacity,e.shadowOffsetX=(t?cc.contentScaleFactor():1)*this._shadowOffset.x,e.shadowOffsetY=(t?cc.contentScaleFactor():1)*this._shadowOffset.y):e._shadowEnabled=!1;var n=this._textFillColor;return e.fillStyle=cc.color(n.r,n.g,n.b),e},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX*cc.view.getDevicePixelRatio()},setScale:function(t,e){this._scaleX=t/cc.view.getDevicePixelRatio(),this._scaleY=(e||0===e?e:t)/cc.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX*cc.view.getDevicePixelRatio()},setScaleX:function(t){this._scaleX=t/cc.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY*cc.view.getDevicePixelRatio()},setScaleY:function(t){this._scaleY=t/cc.view.getDevicePixelRatio(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setString:function(t){t=String(t),this._originalText!==t&&(this._originalText=t+"",this._updateString(),this._setUpdateTextureDirty(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(cc.renderer.childrenOrderDirty=!0),this._string=this._originalText},setHorizontalAlignment:function(t){t!==this._hAlignment&&(this._hAlignment=t,this._setUpdateTextureDirty())},setVerticalAlignment:function(t){t!==this._vAlignment&&(this._vAlignment=t,this._setUpdateTextureDirty())},setDimensions:function(t,e){var i;void 0===e?(i=t.width,e=t.height):i=t,i===this._dimensions.width&&e===this._dimensions.height||(this._dimensions.width=i,this._dimensions.height=e,this._updateString(),this._setUpdateTextureDirty())},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(t){t!==this._dimensions.width&&(this._dimensions.width=t,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(t){t!==this._dimensions.height&&(this._dimensions.height=t,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(t){this._fontSize!==t&&(this._fontSize=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(t){this._fontName&&this._fontName!==t&&(this._fontName=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},_setFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._fontSize=parseInt(e[1]),this._fontName=e[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},getContentSize:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),cc.size(this._contentSize)},_getWidth:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.width},_getHeight:function(){return this._needUpdateTexture&&this._renderCmd._updateTTF(),this._contentSize.height},setTextureRect:function(t,e,i){cc.Sprite.prototype.setTextureRect.call(this,t,e,i,!1)},setDrawMode:function(t){this._onCacheCanvasMode=t},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.LabelTTF.WebGLRenderCmd(this):this._onCacheCanvasMode?new cc.LabelTTF.CacheCanvasRenderCmd(this):new cc.LabelTTF.CanvasRenderCmd(this)},_setFontStyle:function(t){this._fontStyle!==t&&(this._fontStyle=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(t){this._fontWeight!==t&&(this._fontWeight=t,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}}),cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js"),cc._tmp.PrototypeLabelTTF(),delete cc._tmp.PrototypeLabelTTF,cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/,cc.LabelTTF.create=function(t,e,i,n,r,o){return new cc.LabelTTF(t,e,i,n,r,o)},cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create,cc.LabelTTF.__labelHeightDiv=document.createElement("div"),cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial",cc.LabelTTF.__labelHeightDiv.style.position="absolute",cc.LabelTTF.__labelHeightDiv.style.left="-100px",cc.LabelTTF.__labelHeightDiv.style.top="-100px",cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal",document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):window.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1),cc.LabelTTF.__getFontHeightByDiv=function(t,e){var i,n=cc.LabelTTF.__labelHeightDiv;if(t instanceof cc.FontDefinition){var r=t;if(i=cc.LabelTTF.__fontHeightCache[r._getCanvasFontStr()],i>0)return i;n.innerHTML="ajghl~!",n.style.fontFamily=r.fontName,n.style.fontSize=r.fontSize+"px",n.style.fontStyle=r.fontStyle,n.style.fontWeight=r.fontWeight,i=n.clientHeight,cc.LabelTTF.__fontHeightCache[r._getCanvasFontStr()]=i,n.innerHTML=""}else{if(i=cc.LabelTTF.__fontHeightCache[t+"."+e],i>0)return i;n.innerHTML="ajghl~!",n.style.fontFamily=t,n.style.fontSize=e+"px",i=n.clientHeight,cc.LabelTTF.__fontHeightCache[t+"."+e]=i,n.innerHTML=""}return i},cc.LabelTTF.__fontHeightCache={},cc.LabelTTF._textAlign=["left","center","right"],cc.LabelTTF._textBaseline=["top","middle","bottom"],cc.LabelTTF.wrapInspection=!0,cc.LabelTTF._wordRex=/([a-zA-Z0-9]+|\S)/,cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>]/,cc.LabelTTF._lastWordRex=/([a-zA-Z0-9]+|\S)$/,cc.LabelTTF._lastEnglish=/[a-zA-Z0-9]+$/,cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9]/,function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18,this._fontStyleStr="",this._shadowColorStr="rgba(128, 128, 128, 0.5)",this._strokeColorStr="",this._fillColorStr="rgba(255,255,255,1)",this._labelCanvas=null,this._labelContext=null,this._lineWidths=[],this._strings=[],this._isMultiLine=!1,this._status=[],this._renderingIndex=0,this._texRect=cc.rect(),this._canUseDirtyRegion=!0};var t=cc.LabelTTF.RenderCmd.prototype;t.constructor=cc.LabelTTF.RenderCmd,t._setFontStyle=function(t,e,i,n){if(t instanceof cc.FontDefinition)this._fontStyleStr=t._getCanvasFontStr(),this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(t);else{var r=e*cc.view.getDevicePixelRatio();this._fontStyleStr=i+" "+n+" "+r+"px '"+t+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(t,e)}},t._getFontStyle=function(){return this._fontStyleStr},t._getFontClientHeight=function(){return this._fontClientHeight},t._updateColor=function(){this._setColorsString(),this._updateTexture()},t._setColorsString=function(){var t=this._displayedColor,e=this._node,i=e._shadowColor||this._displayedColor,n=e._strokeColor,r=e._textFillColor,o=t.r/255,s=t.g/255,c=t.b/255;this._shadowColorStr="rgba("+(0|o*i.r)+","+(0|s*i.g)+","+(0|c*i.b)+","+e._shadowOpacity+")",this._fillColorStr="rgba("+(0|o*r.r)+","+(0|s*r.g)+","+(0|c*r.b)+", 1)",this._strokeColorStr="rgba("+(0|o*n.r)+","+(0|s*n.g)+","+(0|c*n.b)+", 1)"};var e=new cc.Rect;t.getLocalBB=function(){var t=this._node;e.x=e.y=0;var i=cc.view.getDevicePixelRatio();return e.width=t._getWidth()*i,e.height=t._getHeight()*i,e},t._updateTTF=function(){var t,e,i=this._node,n=cc.view.getDevicePixelRatio(),r=i._dimensions.width*n,o=this._lineWidths;if(o.length=0,this._isMultiLine=!1,this._measureConfig(),0!==r)for(this._strings=i._string.split("\n"),t=0;t<this._strings.length;t++)this._checkWarp(this._strings,t,r);else for(this._strings=i._string.split("\n"),t=0,e=this._strings.length;t<e;t++)o.push(this._measure(this._strings[t]));this._strings.length>1&&(this._isMultiLine=!0);var s,c=0,a=0;if(i._strokeEnabled&&(c=a=2*i._strokeSize),i._shadowEnabled){var l=i._shadowOffset;c+=2*Math.abs(l.x),a+=2*Math.abs(l.y)}s=0===r?this._isMultiLine?cc.size(Math.ceil(Math.max.apply(Math,o)+c),Math.ceil(this._fontClientHeight*n*this._strings.length+a)):cc.size(Math.ceil(this._measure(i._string)+c),Math.ceil(this._fontClientHeight*n+a)):0===i._dimensions.height?this._isMultiLine?cc.size(Math.ceil(r+c),Math.ceil(i.getLineHeight()*n*this._strings.length+a)):cc.size(Math.ceil(r+c),Math.ceil(i.getLineHeight()*n+a)):cc.size(Math.ceil(r+c),Math.ceil(i._dimensions.height*n+a)),"normal"!==i._getFontStyle()&&(s.width=Math.ceil(s.width+.3*i._fontSize)),0===this._strings.length?(this._texRect.width=1,this._texRect.height=s.height||1):(this._texRect.width=s.width,this._texRect.height=s.height);var h=s.width/n,u=s.height/n;i.setContentSize(h,u),i._strokeShadowOffsetX=c,i._strokeShadowOffsetY=a;var d=i._anchorPoint;this._anchorPointInPoints.x=.5*c+(s.width-c)*d.x,this._anchorPointInPoints.y=.5*a+(s.height-a)*d.y},t._saveStatus=function(){var t=this._node,e=cc.view.getDevicePixelRatio(),i=t._strokeShadowOffsetX,n=t._strokeShadowOffsetY,r=t._contentSize.height*e-n,o=t._vAlignment,s=t._hAlignment,c=.5*i,a=r+.5*n,l=0,h=0,u=[],d=t._contentSize.width*e-i,_=t.getLineHeight()*e,p=(_-this._fontClientHeight*e)/2;if(l+=s===cc.TEXT_ALIGNMENT_RIGHT?d:s===cc.TEXT_ALIGNMENT_CENTER?d/2:0,this._isMultiLine){var f=this._strings.length;o===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?h=_-2*p+r-_*f:o===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(h=(_-2*p)/2+(r-_*f)/2);for(var m=0;m<f;m++){var g=-r+(_*m+p)+h;u.push(g)}}else o===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM||(h-=o===cc.VERTICAL_TEXT_ALIGNMENT_TOP?r:.5*r),u.push(h);var y={contextTransform:cc.p(c,a),xOffset:l,OffsetYArray:u};this._status.push(y)},t._drawTTFInCanvas=function(t){if(t){var e=this._status.pop();t.setTransform(1,0,0,1,e.contextTransform.x,e.contextTransform.y);var i=e.xOffset,n=e.OffsetYArray;this.drawLabels(t,i,n)}},t._checkWarp=function(t,e,i){var n=t[e],r=this._measure(n);if(r>i&&n.length>1){for(var o,s=n.length*(i/r)|0,c=n.substr(s),a=r-this._measure(c),l=0,h=0;a>i&&h++<100;)s*=i/a,s|=0,c=n.substr(s),a=r-this._measure(c);for(h=0;a<i&&h++<100;){if(c){var u=cc.LabelTTF._wordRex.exec(c);l=u?u[0].length:1,o=c}s+=l,c=n.substr(s),a=r-this._measure(c)}s-=l,0===s&&(s=1,o=o.substr(1));var d,_=n.substr(0,s);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(o||c)&&(d=cc.LabelTTF._lastWordRex.exec(_),s-=d?d[0].length:0,0===s&&(s=1),o=n.substr(s),_=n.substr(0,s)),cc.LabelTTF._firsrEnglish.test(o)&&(d=cc.LabelTTF._lastEnglish.exec(_),d&&_!==d[0]&&(s-=d[0].length,o=n.substr(s),_=n.substr(0,s))),t[e]=o||c,t.splice(e,0,_)}},t.updateStatus=function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.textDirty&&this._updateTexture(),cc.Node.RenderCmd.prototype.updateStatus.call(this),this._dirtyFlag&t.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag)},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.textDirty&&this._updateTexture(),cc.Node.RenderCmd.prototype._syncStatus.call(this,t),(cc._renderType===cc.game.RENDER_TYPE_WEBGL||i&e.transformDirty)&&this.transform(t)},t.drawLabels=function(t,e,i){var n=this._node;if(n._shadowEnabled){var r=n._shadowOffset;t.shadowColor=this._shadowColorStr,t.shadowOffsetX=r.x,t.shadowOffsetY=-r.y,t.shadowBlur=n._shadowBlur}var o=n._hAlignment,s=n._vAlignment,c=n._strokeSize;t.font!==this._fontStyleStr&&(t.font=this._fontStyleStr),t.fillStyle=this._fillColorStr;var a=n._strokeEnabled;a&&(t.lineWidth=2*c,t.strokeStyle=this._strokeColorStr),t.textBaseline=cc.LabelTTF._textBaseline[s],t.textAlign=cc.LabelTTF._textAlign[o];for(var l=this._strings.length,h=0;h<l;h++){var u=this._strings[h];a&&t.strokeText(u,e,i[h]),t.fillText(u,e,i[h])}cc.g_NumberOfDraws++}}(),function(){cc.LabelTTF.CacheRenderCmd=function(t){cc.LabelTTF.RenderCmd.call(this,t);var e=this._labelCanvas=document.createElement("canvas");e.width=1,e.height=1,this._labelContext=e.getContext("2d"),this._texRect=cc.rect()},cc.LabelTTF.CacheRenderCmd.prototype=Object.create(cc.LabelTTF.RenderCmd.prototype),cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CacheRenderCmd.prototype);var t=cc.LabelTTF.CacheRenderCmd.prototype;t.constructor=cc.LabelTTF.CacheRenderCmd,t._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.textDirty^this._dirtyFlag;var t=this._node;this._updateTTF();var e=this._texRect.width,i=this._texRect.height,n=this._labelContext,r=this._labelCanvas;if(!t._texture){var o=new cc.Texture2D;o.initWithElement(this._labelCanvas),t.setTexture(o)}if(0===t._string.length)return r.width=e,r.height=i,t._texture&&t._texture.handleLoadedTexture(),t.setTextureRect(this._texRect),!0;n.font=this._fontStyleStr;var s=r.width===e&&r.height===i;return r.width=this._texRect.width,r.height=this._texRect.height,s&&n.clearRect(0,0,e,i),this._saveStatus(),this._drawTTFInCanvas(n),t._texture&&t._texture.handleLoadedTexture(),t.setTextureRect(this._texRect),!0},t._measureConfig=function(){this._labelContext.font=this._fontStyleStr},t._measure=function(t){return this._labelContext.measureText(t).width}}(),function(){cc.LabelTTF.CacheCanvasRenderCmd=function(t){cc.Sprite.CanvasRenderCmd.call(this,t),cc.LabelTTF.CacheRenderCmd.call(this)};var t=cc.LabelTTF.CacheCanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(cc.LabelTTF.CacheRenderCmd.prototype,t),t.constructor=cc.LabelTTF.CacheCanvasRenderCmd}(),function(){cc.LabelTTF.CanvasRenderCmd=function(t){cc.Sprite.CanvasRenderCmd.call(this,t),cc.LabelTTF.RenderCmd.call(this)},cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype),cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var t=cc.LabelTTF.CanvasRenderCmd.prototype;t.constructor=cc.LabelTTF.CanvasRenderCmd,t._measureConfig=function(){},t._measure=function(t){var e=cc._renderContext.getContext();return e.font=this._fontStyleStr,e.measureText(t).width},t._updateTexture=function(){this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.textDirty^this._dirtyFlag;var t=this._node;cc.view.getDevicePixelRatio();return this._updateTTF(),0===t._string.length?(t.setTextureRect(this._texRect),!0):(this._saveStatus(),t.setTextureRect(this._texRect),!0)},t.rendering=function(t){var e=cc.view.getScaleX(),i=cc.view.getScaleY(),n=t||cc._renderContext,r=n.getContext();if(r){var o=this._node;if(n.computeRealOffsetY(),!(this._status.length<=0)){var s=this._renderingIndex>=this._status.length?this._renderingIndex-this._status.length:this._renderingIndex,c=this._status[s];this._renderingIndex=s+1;var a=o._rect.height,l=o._offsetPosition.x,h=-o._offsetPosition.y-a,u=this._displayedOpacity/255;n.setTransform(this._worldTransform,e,i),n.setCompositeOperation(this._blendFuncStr),n.setGlobalAlpha(u),n.save(),o._flippedX&&(l=-l-o._rect.width,r.scale(-1,1)),o._flippedY&&(h=o._offsetPosition.y,r.scale(1,-1));for(var d=c.xOffset+c.contextTransform.x+l*e,_=[],p=this._strings.length,f=0;f<p;f++)_.push(c.OffsetYArray[f]+c.contextTransform.y+h*i);this.drawLabels(r,d,_),n.restore()}}}}();var cc=cc||{};cc._tmp=cc._tmp||{},cc.associateWithNative=function(t,e){},cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.FMT_JPG=0,cc.FMT_PNG=1,cc.FMT_TIFF=2,cc.FMT_RAWDATA=3,cc.FMT_WEBP=4,cc.FMT_UNKNOWN=5,cc.getImageFormatByData=function(t){return t.length>8&&137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]?cc.FMT_PNG:t.length>2&&(73===t[0]&&73===t[1]||77===t[0]&&77===t[1]||255===t[0]&&216===t[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN},cc.inherits=function(t,e){function i(){}i.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new i,t.prototype.constructor=t},cc.base=function(t,e,i){var n=arguments.callee.caller;if(n.superClass_)return ret=n.superClass_.constructor.apply(t,Array.prototype.slice.call(arguments,1)),ret;for(var r=Array.prototype.slice.call(arguments,2),o=!1,s=t.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[e]===n)o=!0;else if(o)return s.prototype[e].apply(t,r);if(t[e]===n)return t.constructor.prototype[e].apply(t,r);throw Error("cc.base called from a method of one name to a method of a different name")};var GlobalVertexBuffer=function(){var t=888,e=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.size=t,this.byteLength=4*t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,this.data=new ArrayBuffer(this.byteLength),this.dataArray=new Float32Array(this.data),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.dataArray,e.DYNAMIC_DRAW),this._dirty=!1,this._spaces={0:this.byteLength}};return e.prototype={constructor:e,allocBuffer:function(t,e){var i=this._spaces[t];if(i&&i>=e){if(delete this._spaces[t],i>e){var n=t+e;this._spaces[n]=i-e}return!0}return!1},requestBuffer:function(t){var e,i,n;for(e in this._spaces)if(i=parseInt(e),n=this._spaces[e],n>=t&&this.allocBuffer(i,t))return{buffer:this,offset:i,size:t};return null},freeBuffer:function(t,e){var i,n,r,o=this._spaces;for(n in o){if(i=parseInt(n),i>t)break;if(i+o[n]>=t){e=e+t-i,t=i;break}}r=t+e,this._spaces[r]&&(e+=this._spaces[r],delete this._spaces[r]),this._spaces[t]=e},setDirty:function(){this._dirty=!0},update:function(){this._dirty&&(this.gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferSubData(gl.ARRAY_BUFFER,0,this.dataArray),this._dirty=!1)},destroy:function(){this.gl.deleteBuffer(this.vertexBuffer),this.data=null,this.positions=null,this.colors=null,this.texCoords=null,this.vertexBuffer=null}},e}();cc.rendererCanvas={childrenOrderDirty:!0,assignedZ:0,assignedZStep:1e-4,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(),_clearFillStyle:"rgb(0, 0, 0)",_dirtyRegion:null,_allNeedDraw:!0,_enableDirtyRegion:!1,_debugDirtyRegion:!1,_canUseDirtyRegion:!1,_dirtyRegionCountThreshold:10,getRenderCmd:function(t){return t._createRenderCmd()},enableDirtyRegion:function(t){this._enableDirtyRegion=t},isDirtyRegionEnabled:function(){return this._enableDirtyRegion},setDirtyRegionCountThreshold:function(t){this._dirtyRegionCountThreshold=t},_collectDirtyRegion:function(){var t,e,i=this._renderCmds,n=this._dirtyRegion,r=0,o=!0,s=cc.Node.CanvasRenderCmd.RegionStatus;for(t=0,e=i.length;t<e;t++){var c=i[t],a=c._regionFlag,l=c._oldRegion,h=c._currentRegion;a>s.NotDirty&&(++r,r>this._dirtyRegionCountThreshold&&(o=!1),o&&(!h.isEmpty()&&n.addRegion(h),c._regionFlag>s.Dirty&&!l.isEmpty()&&n.addRegion(l)),c._regionFlag=s.NotDirty)}return o},_beginDrawDirtyRegion:function(t){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions();e.save();var n=t._scaleX,r=t._scaleY;t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},n,r),e.beginPath();for(var o=0,s=i.length;o<s;++o){var c=i[o];e.rect(c._minX,-c._maxY,c._width,c._height)}e.clip()},_endDrawDirtyRegion:function(t){t.restore()},_debugDrawDirtyRegion:function(t){if(this._debugDirtyRegion){var e=t.getContext(),i=this._dirtyRegion.getDirtyRegions(),n=t._scaleX,r=t._scaleY;t.setTransform({a:1,b:0,c:0,d:1,tx:0,ty:0},n,r),e.beginPath();for(var o=0,s=i.length;o<s;++o){var c=i[o];e.rect(c._minX,-c._maxY,c._width,c._height)}var a=e.fillStyle;e.fillStyle="green",e.fill(),e.fillStyle=a}},rendering:function(t){var e=this._dirtyRegion=this._dirtyRegion||new cc.DirtyRegion,i=cc._canvas,n=t||cc._renderContext,r=n.getContext(),o=cc.view.getScaleX(),s=cc.view.getScaleY();n.setViewScale(o,s),n.computeRealOffsetY();var c,a,l=this._dirtyRegion.getDirtyRegions(),h=this._renderCmds,u=this._allNeedDraw||!this._enableDirtyRegion||!this._canUseDirtyRegion,d=!0;for(u||(d=this._collectDirtyRegion()),u=u||!d,u||this._beginDrawDirtyRegion(n),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,i.width,i.height),0===this._clearColor.r&&0===this._clearColor.g&&0===this._clearColor.b||(n.setFillStyle(this._clearFillStyle),n.setGlobalAlpha(this._clearColor.a),r.fillRect(0,0,i.width,i.height)),c=0,a=h.length;c<a;c++){var _=h[c],p=!1,f=_._currentRegion;if(!f||u)p=!0;else for(var m=0,g=l.length;m<g;++m)if(l[m].intersects(f)){p=!0;break}p&&_.rendering(n,o,s)}u||(this._debugDrawDirtyRegion(n),this._endDrawDirtyRegion(r)),e.clear(),this._allNeedDraw=!1},_renderingToCacheCanvas:function(t,e,i,n){t||cc.log("The context of RenderTexture is invalid."),i=cc.isUndefined(i)?1:i,n=cc.isUndefined(n)?1:n,e=e||this._currentID;var r,o,s=this._cacheToCanvasCmds[e];for(t.computeRealOffsetY(),r=0,o=s.length;r<o;r++)s[r].rendering(t,i,n);this._removeCache(e);var c=this._cacheInstanceIds;0===c.length?this._isCacheToCanvasOn=!1:this._currentID=c[c.length-1]},_turnToCacheMode:function(t){this._isCacheToCanvasOn=!0,t=t||0,this._cacheToCanvasCmds[t]=[],this._cacheInstanceIds.indexOf(t)===-1&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToCanvasCmds[t];e&&(e.length=0,delete this._cacheToCanvasCmds[t]);var i=this._cacheInstanceIds;cc.arrayRemoveObject(i,t)},resetFlag:function(){this.childrenOrderDirty=!1,this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);for(var e=0,i=t.length;e<i;e++)0!==t[e]._dirtyFlag&&t[e].updateStatus();t.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clear:function(){},clearRenderCommands:function(){this._renderCmds.length=0,this._cacheInstanceIds.length=0,this._isCacheToCanvasOn=!1,this._allNeedDraw=!0,this._canUseDirtyRegion=!0},pushRenderCommand:function(t){if(t.needDraw())if(t._canUseDirtyRegion||(this._canUseDirtyRegion=!1),this._isCacheToCanvasOn){var e=this._currentID,i=this._cacheToCanvasCmds,n=i[e];n.indexOf(t)===-1&&n.push(t)}else this._renderCmds.indexOf(t)===-1&&this._renderCmds.push(t)}},function(){cc.CanvasContextWrapper=function(t){this._context=t,this._saveCount=0,this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._offsetX=0,this._offsetY=0,this._realOffsetY=this.height,this._armatureMode=0};var t=cc.CanvasContextWrapper.prototype;t.resetCache=function(){var t=this._context;this._currentAlpha=t.globalAlpha,this._currentCompositeOperation=t.globalCompositeOperation,this._currentFillStyle=t.fillStyle,this._currentStrokeStyle=t.strokeStyle,this._realOffsetY=this._context.canvas.height+this._offsetY},t.setOffset=function(t,e){this._offsetX=t,this._offsetY=e,this._realOffsetY=this._context.canvas.height+this._offsetY},t.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY},t.setViewScale=function(t,e){this._scaleX=t,this._scaleY=e},t.getContext=function(){return this._context},t.save=function(){this._context.save(),this._saveCount++},t.restore=function(){this._context.restore(),this._saveCount--},t.setGlobalAlpha=function(t){this._saveCount>0?this._context.globalAlpha=t:this._currentAlpha!==t&&(this._currentAlpha=t,this._context.globalAlpha=t)},t.setCompositeOperation=function(t){this._saveCount>0?this._context.globalCompositeOperation=t:this._currentCompositeOperation!==t&&(this._currentCompositeOperation=t,this._context.globalCompositeOperation=t)},t.setFillStyle=function(t){this._saveCount>0?this._context.fillStyle=t:this._currentFillStyle!==t&&(this._currentFillStyle=t,this._context.fillStyle=t)},t.setStrokeStyle=function(t){this._saveCount>0?this._context.strokeStyle=t:this._currentStrokeStyle!==t&&(this._currentStrokeStyle=t,this._context.strokeStyle=t)},t.setTransform=function(t,e,i){this._armatureMode>0?(this.restore(),this.save(),this._context.transform(t.a*e,-t.b*i,-t.c*e,t.d*i,t.tx*e,-(t.ty*i))):this._context.setTransform(t.a*e,-t.b*i,-t.c*e,t.d*i,this._offsetX+t.tx*e,this._realOffsetY-t.ty*i)},t._switchToArmatureMode=function(t,e,i,n){t?(this._armatureMode++,this._context.setTransform(e.a,e.c,e.b,e.d,this._offsetX+e.tx*i,this._realOffsetY-e.ty*n),this.save()):(this._armatureMode--,this.restore())}}();var Region=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},regionProto=Region.prototype,regionPool=[];regionProto.setTo=function(t,e,i,n){return this._minX=t,this._minY=e,this._maxX=i,this._maxY=n,this.updateArea(),this},regionProto.intValues=function(){this._minX=Math.floor(this._minX),this._minY=Math.floor(this._minY),this._maxX=Math.ceil(this._maxX),this._maxY=Math.ceil(this._maxY),this.updateArea()},regionProto.updateArea=function(){this._width=this._maxX-this._minX,this._height=this._maxY-this._minY,this._area=this._width*this._height},regionProto.union=function(t){return this._width<=0||this._height<=0?void this.setTo(t._minX,t._minY,t._maxX,t._maxY):(this._minX>t._minX&&(this._minX=t._minX),this._minY>t._minY&&(this._minY=t._minY),this._maxX<t._maxX&&(this._maxX=t._maxX),this._maxY<t._maxY&&(this._maxY=t._maxY),void this.updateArea())},regionProto.setEmpty=function(){this._minX=0,this._minY=0,this._maxX=0,this._maxY=0,this._width=0,this._height=0,this._area=0},regionProto.isEmpty=function(){return this._width<=0||this._height<=0},regionProto.intersects=function(t){if(this._width<=0||this._height<=0||t._width<=0||t._height<=0)return!1;var e=this._minX>t._minX?this._minX:t._minX,i=this._maxX<t._maxX?this._maxX:t._maxX;return!(e>i)&&(e=this._minY>t._minY?this._minY:t._minY,i=this._maxY<t._maxY?this._maxY:t._maxY,e<=i)},regionProto.updateRegion=function(t,e){if(0==t.width||0==t.height)return void this.setEmpty();var i,n,r,o,s=e,c=s.a,a=s.b,l=s.c,h=s.d,u=s.tx,d=s.ty,_=t.x,p=t.y,f=_+t.width,m=p+t.height;if(1==c&&0==a&&0==l&&1==h)i=_+u-1,n=p+d-1,r=f+u+1,o=m+d+1;else{var g=c*_+l*p+u,y=a*_+h*p+d,v=c*f+l*p+u,T=a*f+h*p+d,C=c*f+l*m+u,S=a*f+h*m+d,x=c*_+l*m+u,A=a*_+h*m+d,E=0;g>v&&(E=g,g=v,v=E),C>x&&(E=C,C=x,x=E),i=(g<C?g:C)-1,r=(v>x?v:x)+1,y>T&&(E=y,y=T,T=E),S>A&&(E=S,S=A,A=E),n=(y<S?y:S)-1,o=(T>A?T:A)+1}this._minX=i,this._minY=n,this._maxX=r,this._maxY=o,this._width=r-i,this._height=o-n,this._area=this._width*this._height};var DirtyRegion=function(){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1},dirtyRegionProto=DirtyRegion.prototype;dirtyRegionProto.setClipRect=function(t,e){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},dirtyRegionProto.addRegion=function(t){var e=t._minX,i=t._minY,n=t._maxX,r=t._maxY;if(this.hasClipRect&&(e<0&&(e=0),i<0&&(i=0),n>this.clipWidth&&(n=this.clipWidth),r>this.clipHeight&&(r=this.clipHeight)),e>=n||i>=r)return!1;if(this.clipRectChanged)return!0;var o=this.dirtyList,s=regionCreate();return o.push(s.setTo(e,i,n,r)),this.mergeDirtyList(o),!0},dirtyRegionProto.clear=function(){for(var t=this.dirtyList,e=t.length,i=0;i<e;i++)regionRelease(t[i]);t.length=0},dirtyRegionProto.getDirtyRegions=function(){var t=this.dirtyList;if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var e=regionCreate();t.push(e.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(t););var i=this.dirtyList.length;if(i>0)for(var n=0;n<i;n++)this.dirtyList[n].intValues();return this.dirtyList},dirtyRegionProto.mergeDirtyList=function(t){var e=t.length;if(e<2)return!1;for(var i=this.hasClipRect,n=e>3?Number.POSITIVE_INFINITY:0,r=0,o=0,s=0,c=0;c<e-1;c++){var a=t[c];i&&(s+=a.area);for(var l=c+1;l<e;l++){var h=t[l],u=unionArea(a,h)-a.area-h.area;n>u&&(r=c,o=l,n=u)}}if(i&&s/this.clipArea>.95&&(this.clipRectChanged=!0),r!=o){var d=t[o];return t[r].union(d),regionRelease(d),t.splice(o,1),!0}return!1},cc.Region=Region,cc.DirtyRegion=DirtyRegion,cc.profiler=function(){var t=!1,e=!1,i=0,n=0,r=0,o=0,s=null,c=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),u=.6,d=10,_=[0,10,20,30],p=[0,0,0,0],f=3,m=0,g=0;h.id="fps",h.style.position="absolute",h.style.padding="3px",h.style.textAlign="left",h.style.backgroundColor="rgb(0, 0, 34)",h.style.bottom=cc.DIRECTOR_STATS_POSITION.y+"0px",h.style.left=cc.DIRECTOR_STATS_POSITION.x+"px",h.style.width="45px",h.style.height="60px";for(var y=[l,a,c],v=0;v<3;++v){var T=y[v].style;T.color="rgb(0, 255, 255)",T.font="bold 12px Helvetica, Arial",T.lineHeight="20px",T.width="100%",h.appendChild(y[v])}var C=function(t){var e,i=_.length-1,n=i,r=0;for(m++,g+=t;n>=0;n--)if(t>=_[n]){p[n]++;break}if(m>=d){for(r=g/d,n=i;n>0;n--)if(e=p[n]/d,e>=u&&r>=_[n]){n!=f&&(f=n,x.onFrameRateChange&&x.onFrameRateChange(r.toFixed(2)));break}for(_changeCount=0,m=0,g=0,n=i;n>0;n--)p[n]=0}},S=function(){r=cc.director.getSecondsPerFrame(),i++,o+=cc.director.getDeltaTime(),o>cc.DIRECTOR_FPS_INTERVAL&&(n=i/o,i=0,o=0,x.onFrameRateChange&&C(n),t&&(a.innerText=r.toFixed(3),c.innerText=n.toFixed(1),l.innerText=(0|cc.g_NumberOfDraws).toString()))},x={onFrameRateChange:null,getSecondsPerFrame:function(){return r},getFrameRate:function(){return n},setProfileDuration:function(t){!isNaN(t)&&t>0&&(d=t/cc.DIRECTOR_FPS_INTERVAL)},resumeProfiling:function(){cc.eventManager.addListener(s,1)},stopProfiling:function(){cc.eventManager.removeListener(s)},isShowingStats:function(){return t},showStats:function(){e||this.init(),null===h.parentElement&&cc.container.appendChild(h),t=!0},hideStats:function(){t=!1,h.parentElement===cc.container&&cc.container.removeChild(h)},init:function(){e||(s=cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_VISIT,S),e=!0)}};return x}();cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){cc.DirectorDelegate=cc.Class.extend({updateProjection:function(){}});var t=cc.Director.prototype,e=function(t){if(t&&t._renderCmd){t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);var i,n=t._children;for(i=0;i<n.length;i++)e(n[i])}};cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,function(){for(var t=(cc.director,cc.director._scenesStack),i=0;i<t.length;i++)e(t[i])}),t.setProjection=function(t){var e=this,i=e._winSizeInPoints;e.setViewport();var n=e._openGLView,r=n._viewPortRect.x/n._scaleX,o=n._viewPortRect.y/n._scaleY;switch(t){case cc.Director.PROJECTION_2D:cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity();var s=cc.math.Matrix4.createOrthographicProjection(0,i.width,0,i.height,-1024,1024);cc.kmGLMultMatrix(s),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();break;case cc.Director.PROJECTION_3D:var c=e.getZEye(),a=new cc.math.Matrix4,l=new cc.math.Matrix4;cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity(),a=cc.math.Matrix4.createPerspectiveProjection(60,i.width/i.height,.1,2*c),cc.kmGLMultMatrix(a),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity();var h=new cc.math.Vec3(-r+i.width/2,-o+i.height/2,c),u=new cc.math.Vec3(-r+i.width/2,-o+i.height/2,0),d=new cc.math.Vec3(0,1,0);l.lookAt(h,u,d),cc.kmGLMultMatrix(l);break;case cc.Director.PROJECTION_CUSTOM:e._projectionDelegate&&e._projectionDelegate.updateProjection();break;default:cc.log(cc._LogInfos.Director_setProjection)}e._projection=t,cc.eventManager.dispatchEvent(e._eventProjectionChanged),cc.setProjectionMatrixDirty(),cc.renderer.childrenOrderDirty=!0},t.setDepthTest=function(t){cc.renderer.setDepthTest(t)},t.setClearColor=function(t){cc.renderer._clearColor=t},t.setOpenGLView=function(t){var e=this;e._winSizeInPoints.width=cc._canvas.width,e._winSizeInPoints.height=cc._canvas.height,e._openGLView=t||cc.view;var i=cc.configuration;i.gatherGPUInfo(),i.dumpInfo(),e.setGLDefaultValues(),cc.eventManager&&cc.eventManager.setEnabled(!0)},t._clear=function(){var t=cc._renderContext;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},t.getVisibleSize=function(){return this._openGLView.getVisibleSize()},t.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()},t.getZEye=function(){return this._winSizeInPoints.height/1.1566},t.setViewport=function(){var t=this._openGLView;if(t){var e=this._winSizeInPoints;t.setViewPortInPoints(-t._viewPortRect.x/t._scaleX,-t._viewPortRect.y/t._scaleY,e.width,e.height)}},t.getOpenGLView=function(){return this._openGLView},t.getProjection=function(){return this._projection},t.setAlphaBlending=function(t){t?cc.glBlendFunc(cc.BLEND_SRC,cc.BLEND_DST):cc.glBlendFunc(cc._renderContext.ONE,cc._renderContext.ZERO)},t.setGLDefaultValues=function(){var t=this;t.setAlphaBlending(!0),t.setProjection(t._projection),cc._renderContext.clearColor(0,0,0,0)}}}),cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var t=this._valueDict;t["cocos2d.x.version"]=cc.ENGINE_VERSION,t["cocos2d.x.compiled_with_profiler"]=!1,t["cocos2d.x.compiled_with_gl_state_cache"]=cc.ENABLE_GL_STATE_CACHE,this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(t){return this._GlExtensions.indexOf(t)>-1},getValue:function(t,e){this._inited||this._init();var i=this._valueDict;return i[t]?i[t]:e},setValue:function(t,e){this._valueDict[t]=e},dumpInfo:function(){0===cc.ENABLE_GL_STATE_CACHE&&(cc.log(""),cc.log(cc._LogInfos.configuration_dumpInfo),cc.log(""))},gatherGPUInfo:function(){if(cc._renderType!==cc.game.RENDER_TYPE_CANVAS){this._inited||this._init();var t=cc._renderContext,e=this._valueDict;e["gl.vendor"]=t.getParameter(t.VENDOR),e["gl.renderer"]=t.getParameter(t.RENDERER),e["gl.version"]=t.getParameter(t.VERSION),this._GlExtensions="";for(var i=t.getSupportedExtensions(),n=0;n<i.length;n++)this._GlExtensions+=i[n]+" ";this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),e["gl.max_texture_size"]=this._maxTextureSize,this._maxTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e["gl.max_texture_units"]=this._maxTextureUnits,this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc"),e["gl.supports_PVRTC"]=this._supportsPVRTC,this._supportsNPOT=!1,e["gl.supports_NPOT"]=this._supportsNPOT,this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888"),e["gl.supports_BGRA8888"]=this._supportsBGRA8888,this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer"),e["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer,this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object"),e["gl.supports_vertex_array_object"]=this._supportsShareableVAO,cc.checkGLErrorDebug()}},loadConfigFile:function(t){this._inited||this._init();var e=cc.loader.getRes(t);if(!e)throw new Error("Please load the resource first : "+t);cc.assert(e,cc._LogInfos.configuration_loadConfigFile_2,t);var i=e.data;if(!i)return void cc.log(cc._LogInfos.configuration_loadConfigFile,t);for(var n in i)this._valueDict[n]=i[n]}},cc.rendererWebGL=function(){function t(t){var e=cc._renderContext;if(n){e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n);for(var i=new Uint16Array(6*t),s=0,d=0,_=6*t;d<_;d+=6)i[d]=s+0,i[d+1]=s+1,i[d+2]=s+2,i[d+3]=s+1,i[d+4]=s+2,i[d+5]=s+3,s+=4;e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW)}if(r){l=4*t*c;var p=4*l;a=new ArrayBuffer(p),h=new Float32Array(a),u=new Uint32Array(a),e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,h,e.DYNAMIC_DRAW)}o=4*t}function e(e){var i=cc._renderContext;null===n?(r=i.createBuffer(),n=i.createBuffer(),t(e)):t(e)}var i={texture:null,blendSrc:null,blendDst:null,shader:null},n=null,r=null,o=0,s=0,c=6,a=null,l=0,h=null,u=null,d=!1;return{mat4Identity:null,childrenOrderDirty:!0,assignedZ:0,assignedZStep:.01,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,_clearColor:cc.color(),init:function(){var t=cc._renderContext;t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),this.mat4Identity=new cc.math.Matrix4,this.mat4Identity.identity(),e(2e3),cc.sys.os===cc.sys.OS_IOS&&(d=!0)},getVertexSize:function(){return o},getRenderCmd:function(t){return t._createRenderCmd()},_turnToCacheMode:function(t){this._isCacheToBufferOn=!0,t=t||0,this._cacheToBufferCmds[t]?this._cacheToBufferCmds[t].length=0:this._cacheToBufferCmds[t]=[],this._cacheInstanceIds.indexOf(t)===-1&&this._cacheInstanceIds.push(t),this._currentID=t},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_removeCache:function(t){t=t||this._currentID;var e=this._cacheToBufferCmds[t];e&&(e.length=0,delete this._cacheToBufferCmds[t]);var i=this._cacheInstanceIds;cc.arrayRemoveObject(i,t)},_renderingToBuffer:function(t){t=t||this._currentID;var e=this._cacheToBufferCmds[t],i=cc._renderContext;this.rendering(i,e),this._removeCache(t);var n=this._cacheInstanceIds;0===n.length?this._isCacheToBufferOn=!1:this._currentID=n[n.length-1]},resetFlag:function(){this.childrenOrderDirty&&(this.childrenOrderDirty=!1),this._transformNodePool.length=0},transform:function(){var t=this._transformNodePool;t.sort(this._sortNodeByLevelAsc);var e,i,n;for(e=0,i=t.length;e<i;e++)n=t[e],n.updateStatus();t.length=0},transformDirty:function(){return this._transformNodePool.length>0},_sortNodeByLevelAsc:function(t,e){return t._curLevel-e._curLevel},pushDirtyNode:function(t){this._transformNodePool.push(t)},clearRenderCommands:function(){this._renderCmds.length=0},clear:function(){var t=cc._renderContext;t.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},setDepthTest:function(t){var e=cc._renderContext;t?(e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL)):e.disable(e.DEPTH_TEST)},pushRenderCommand:function(t){if(t.needDraw())if(this._isCacheToBufferOn){var e=this._currentID,i=this._cacheToBufferCmds,n=i[e];n.indexOf(t)===-1&&n.push(t)}else this._renderCmds.indexOf(t)===-1&&this._renderCmds.push(t)},_increaseBatchingSize:function(t){s+=t},_uploadBufferData:function(t){s>=o&&this._batchRendering();var e=t._node._texture,n=t._node._blendFunc.src,r=t._node._blendFunc.dst,a=t._shaderProgram;i.texture===e&&i.blendSrc===n&&i.blendDst===r&&i.shader===a||(this._batchRendering(),i.texture=e,i.blendSrc=n,i.blendDst=r,i.shader=a);var l=t.uploadData(h,u,s*c);l>0&&(s+=l)},_batchRendering:function(){if(0!==s&&i.texture){var t=cc._renderContext,e=i.texture,a=i.shader,l=s/4;a&&(a.use(),a._updateProjectionUniform()),cc.glBlendFunc(i.blendSrc,i.blendDst),cc.glBindTexture2DN(0,e);var u=!t.bindBuffer(t.ARRAY_BUFFER,r);if(s>.5*o)t.bufferData(t.ARRAY_BUFFER,h,t.DYNAMIC_DRAW);else{var d=h.subarray(0,s*c);t.bufferData(t.ARRAY_BUFFER,d,t.DYNAMIC_DRAW)}u&&(t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,24,12),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,24,16)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.drawElements(t.TRIANGLES,6*l,t.UNSIGNED_SHORT,0),cc.g_NumberOfDraws++,s=0}},rendering:function(t,e){var n,r,o,c=e||this._renderCmds,a=t||cc._renderContext;for(a.bindBuffer(gl.ARRAY_BUFFER,null),n=0,r=c.length;n<r;++n)o=c[n],o.uploadData?this._uploadBufferData(o):(s>0&&this._batchRendering(),o.rendering(a));this._batchRendering(),i.texture=null}}}(),function(){cc.Node.WebGLRenderCmd=function(t){cc.Node.RenderCmd.call(this,t),this._shaderProgram=null};var t=cc.Node.WebGLRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);t.constructor=cc.Node.WebGLRenderCmd,t._updateColor=function(){},t.setShaderProgram=function(t){this._shaderProgram=t},t.getShaderProgram=function(){return this._shaderProgram}}(),function(){cc.Layer.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t)};var t=cc.Layer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.Layer.WebGLRenderCmd,t.bake=function(){},t.unbake=function(){},t._bakeForAddChild=function(){}}(),function(){cc.LayerColor.WebGLRenderCmd=function(t){cc.Layer.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity();var e=this;e._squareVerticesAB=new ArrayBuffer(48),e._squareColorsAB=new ArrayBuffer(16);var i=e._squareVerticesAB,n=e._squareColorsAB,r=cc.Vertex3F.BYTES_PER_ELEMENT,o=cc.Color.BYTES_PER_ELEMENT;e._squareVertices=[new cc.Vertex3F(0,0,0,i,0),new cc.Vertex3F(0,0,0,i,r),new cc.Vertex3F(0,0,0,i,2*r),new cc.Vertex3F(0,0,0,i,3*r)],e._squareColors=[cc.color(0,0,0,255,n,0),cc.color(0,0,0,255,n,o),cc.color(0,0,0,255,n,2*o),cc.color(0,0,0,255,n,3*o)],e._verticesFloat32Buffer=cc._renderContext.createBuffer(),e._colorsUint8Buffer=cc._renderContext.createBuffer(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR)};var t=cc.LayerColor.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);t.constructor=cc.LayerColor.WebGLRenderCmd,t.rendering=function(t){var e=t||cc._renderContext,i=this._node,n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),e.bindBuffer(e.ARRAY_BUFFER,this._verticesFloat32Buffer),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._colorsUint8Buffer),e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,0,0),e.drawArrays(e.TRIANGLE_STRIP,0,this._squareVertices.length)},t.transform=function(t,e){this.originTransform(t,e);var i=this._node,n=i._contentSize.width,r=i._contentSize.height,o=this._squareVertices;o[1].x=n,o[2].y=r,o[3].x=n,o[3].y=r,o[0].z=o[1].z=o[2].z=o[3].z=i._vertexZ,this._bindLayerVerticesBufferData()},t._updateColor=function(){for(var t=this._displayedColor,e=this._displayedOpacity,i=this._squareColors,n=0;n<4;n++)i[n].r=t.r,i[n].g=t.g,i[n].b=t.b,i[n].a=e;this._bindLayerColorsBufferData()},t._bindLayerVerticesBufferData=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._verticesFloat32Buffer),t.bufferData(t.ARRAY_BUFFER,this._squareVerticesAB,t.DYNAMIC_DRAW)},t._bindLayerColorsBufferData=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._colorsUint8Buffer),t.bufferData(t.ARRAY_BUFFER,this._squareColorsAB,t.STATIC_DRAW)},t.updateBlendFunc=function(t){}}(),function(){cc.LayerGradient.WebGLRenderCmd=function(t){cc.LayerColor.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._clipRect=new cc.Rect,this._clippingRectDirty=!1};var t=cc.LayerGradient.WebGLRenderCmd.prototype=Object.create(cc.LayerColor.WebGLRenderCmd.prototype);t.constructor=cc.LayerGradient.WebGLRenderCmd,t.updateStatus=function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag;e&t.gradientDirty&&(this._dirtyFlag|=t.colorDirty,this._updateVertex(),this._dirtyFlag=e&t.gradientDirty^e),cc.Node.RenderCmd.prototype.updateStatus.call(this)},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.gradientDirty&&(this._dirtyFlag|=e.colorDirty,this._updateVertex(),this._dirtyFlag=i&e.gradientDirty^i),cc.Node.RenderCmd.prototype._syncStatus.call(this,t)},t.transform=function(t,e){this.originTransform(t,e),this._updateVertex()},t._updateVertex=function(){var t=this._node,e=t._colorStops;if(e&&!(e.length<2)){this._clippingRectDirty=!0;var i,n=e.length,r=2*n,o=t._contentSize,s=this._squareVertices;if(s.length<r){this._squareVerticesAB=new ArrayBuffer(12*r),s.length=0;var c=this._squareVerticesAB,a=cc.Vertex3F.BYTES_PER_ELEMENT;for(i=0;i<r;i++)s.push(new cc.Vertex3F(0,0,0,c,a*i))}var l=Math.PI+cc.pAngleSigned(cc.p(0,-1),t._alongVector),h=cc.p(o.width/2,o.height/2),u=Math.round(cc.radiansToDegrees(l)),d=cc.affineTransformMake(1,0,0,1,h.x,h.y);d=cc.affineTransformRotate(d,l);var _,p;u<90?(_=cc.p(-h.x,h.y),p=cc.p(h.x,h.y)):u<180?(_=cc.p(h.x,h.y),p=cc.p(h.x,-h.y)):u<270?(_=cc.p(h.x,-h.y),p=cc.p(-h.x,-h.y)):(_=cc.p(-h.x,-h.y),p=cc.p(-h.x,h.y));var f=Math.sin(l),m=Math.cos(l),g=Math.abs((_.x*m-_.y*f)/h.x),y=Math.abs((p.x*f+p.y*m)/h.y);for(d=cc.affineTransformScale(d,g,y),i=0;i<n;i++){var v=e[i],T=v.p*o.height,C=cc.pointApplyAffineTransform(-h.x,T-h.y,d);s[2*i].x=C.x,s[2*i].y=C.y,s[2*i].z=t._vertexZ;var S=cc.pointApplyAffineTransform(o.width-h.x,T-h.y,d);s[2*i+1].x=S.x,s[2*i+1].y=S.y,s[2*i+1].z=t._vertexZ}this._bindLayerVerticesBufferData()}},t._updateColor=function(){var t=this._node,e=t._colorStops;if(e&&!(e.length<2)){var n=e.length,r=this._squareColors,o=2*n;if(r.length<o){this._squareColorsAB=new ArrayBuffer(4*o),r.length=0;var s=this._squareColorsAB,c=cc.Color.BYTES_PER_ELEMENT;for(i=0;i<o;i++)r.push(cc.color(0,0,0,255,s,c*i))}var a=this._displayedOpacity/255;for(i=0;i<n;i++){var l=e[i].color,h=r[2*i],u=r[2*i+1];h.r=l.r,h.g=l.g,h.b=l.b,h.a=l.a*a,u.r=l.r,u.g=l.g,u.b=l.b,u.a=l.a*a}this._bindLayerColorsBufferData()}},t.rendering=function(t){var e=t||cc._renderContext,i=this._node,n=this._getClippingRect();e.enable(e.SCISSOR_TEST),cc.view.setScissorInPoints(n.x,n.y,n.width,n.height);var r=this._worldTransform;this._matrix.mat[0]=r.a,this._matrix.mat[4]=r.c,this._matrix.mat[12]=r.tx,this._matrix.mat[1]=r.b,this._matrix.mat[5]=r.d,this._matrix.mat[13]=r.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),e.bindBuffer(e.ARRAY_BUFFER,this._verticesFloat32Buffer),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._colorsUint8Buffer),e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,0,0),e.drawArrays(e.TRIANGLE_STRIP,0,this._squareVertices.length),e.disable(e.SCISSOR_TEST)},t._getClippingRect=function(){if(this._clippingRectDirty){var t=this._node,e=cc.rect(0,0,t._contentSize.width,t._contentSize.height),i=t.getNodeToWorldTransform();this._clipRect=cc._rectApplyAffineTransformIn(e,i)}return this._clipRect}}(),function(){cc.Sprite.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._vertices=[{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0},{x:0,y:0,u:0,v:0}],this._color=new Uint32Array(1),this._dirty=!1,this._recursiveDirty=!1,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST)};var t=cc.Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.Sprite.WebGLRenderCmd,t.updateBlendFunc=function(t){},t.setDirtyFlag=function(t){cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,t),this._dirty=!0},t.setDirtyRecursively=function(t){this._recursiveDirty=t,this._dirty=t;for(var e,i=this._node._children,n=i?i.length:0,r=0;r<n;r++)e=i[r],e instanceof cc.Sprite&&e._renderCmd.setDirtyRecursively(t)},t._setBatchNodeForAddChild=function(t){var e=this._node;if(e._batchNode){if(!(t instanceof cc.Sprite))return cc.log(cc._LogInfos.Sprite_addChild),!1;t.texture._webTextureObj!==e.textureAtlas.texture._webTextureObj&&cc.log(cc._LogInfos.Sprite_addChild_2),e._batchNode.appendChild(t),e._reorderChildDirty||e._setReorderChildDirtyRecursively()}return!0},t._handleTextureForRotatedTexture=function(t){return t},t.isFrameDisplayed=function(t){var e=this._node;return cc.rectEqualToRect(t.getRect(),e._rect)&&t.getTexture().getName()===e._texture.getName()&&cc.pointEqualToPoint(t.getOffset(),e._unflippedOffsetPositionFromCenter)},t._textureLoadedCallback=function(t){if(!this._textureLoaded){this._textureLoaded=!0;var e=this._rect;e?cc._rectEqualToZero(e)&&(e.width=t.width,e.height=t.height):e=cc.rect(0,0,t.width,t.height),this.texture=t,this.setTextureRect(e,this._rectRotated),this.setBatchNode(this._batchNode),this.dispatchEvent("load"),cc.renderer.childrenOrderDirty=!0}},t._setTextureCoords=function(t,e){void 0===e&&(e=!0),e&&(t=cc.rectPointsToPixels(t));var i=this._node,n=i._batchNode?i.textureAtlas.texture:i._texture,r=this._vertices;if(n){var o,s,c,a,l,h=n.pixelsWidth,u=n.pixelsHeight;i._rectRotated?(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(2*t.x+1)/(2*h),s=o+(2*t.height-2)/(2*h),c=(2*t.y+1)/(2*u),a=c+(2*t.width-2)/(2*u)):(o=t.x/h,s=(t.x+t.height)/h,c=t.y/u,a=(t.y+t.width)/u),i._flippedX&&(l=c,c=a,a=l),i._flippedY&&(l=o,o=s,s=l),r[0].u=s,r[0].v=c,r[1].u=o,r[1].v=c,r[2].u=s,r[2].v=a,r[3].u=o,r[3].v=a):(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(o=(2*t.x+1)/(2*h),s=o+(2*t.width-2)/(2*h),c=(2*t.y+1)/(2*u),a=c+(2*t.height-2)/(2*u)):(o=t.x/h,s=(t.x+t.width)/h,c=t.y/u,a=(t.y+t.height)/u),i._flippedX&&(l=o,o=s,s=l),i._flippedY&&(l=c,c=a,a=l),r[0].u=o,r[0].v=c,r[1].u=o,r[1].v=a,r[2].u=s,r[2].v=c,r[3].u=s,r[3].v=a)}},t._setColorDirty=function(){},t._updateBlendFunc=function(){if(this._batchNode)return void cc.log(cc._LogInfos.Sprite__updateBlendFunc);var t=this._node,e=t._blendFunc;t._texture&&t._texture.hasPremultipliedAlpha()?(e.src===cc.SRC_ALPHA&&e.dst===cc.BLEND_DST&&(e.src=cc.ONE),t.opacityModifyRGB=!0):(e.src===cc.ONE&&e.dst===cc.BLEND_DST&&(e.src=cc.SRC_ALPHA),t.opacityModifyRGB=!1)},t._setTexture=function(t){var e=this._node;if(e._batchNode){if(e._batchNode.texture!==t)return void cc.log(cc._LogInfos.Sprite_setTexture)}else e._texture!==t&&(e._textureLoaded=!!t&&t._textureLoaded,e._texture=t,this._updateBlendFunc(),e._textureLoaded&&(cc.renderer.childrenOrderDirty=!0))},t._checkTextureBoundary=function(t,e,i){if(t&&t.url){var n,r;i?(n=e.x+e.height,r=e.y+e.width):(n=e.x+e.width,r=e.y+e.height),n>t.width&&cc.error(cc._LogInfos.RectWidth,t.url),r>t.height&&cc.error(cc._LogInfos.RectHeight,t.url)}},t.transform=function(t,e){this.originTransform(t,e);var i=this._node,n=i._offsetPosition.x,r=n+i._rect.width,o=i._offsetPosition.y,s=o+i._rect.height,c=this._worldTransform,a=this._vertices;a[0].x=n*c.a+s*c.c+c.tx,a[0].y=n*c.b+s*c.d+c.ty,a[1].x=n*c.a+o*c.c+c.tx,a[1].y=n*c.b+o*c.d+c.ty,a[2].x=r*c.a+s*c.c+c.tx,a[2].y=r*c.b+s*c.d+c.ty,a[3].x=r*c.a+o*c.c+c.tx,a[3].y=r*c.b+o*c.d+c.ty},t.needDraw=function(){var t=this._node,e=t._texture;return this._needDraw&&e},t.uploadData=function(t,e,i){var n=this._node,r=n._texture;if(!(r&&r._textureLoaded&&n._rect.width&&n._rect.height&&this._displayedOpacity))return!1;var o=this._displayedOpacity,s=this._displayedColor.r,c=this._displayedColor.g,a=this._displayedColor.b;if(n._opacityModifyRGB){var l=o/255;s*=l,c*=l,a*=l}this._color[0]=o<<24|a<<16|c<<8|s;var h,u,d=n._vertexZ,_=this._vertices,p=_.length,f=i;for(h=0;h<p;++h)u=_[h],t[f]=u.x,t[f+1]=u.y,t[f+2]=d,e[f+3]=this._color[0],t[f+4]=u.u,t[f+5]=u.v,f+=6;return p}}(),function(){cc.LabelTTF.WebGLRenderCmd=function(t){cc.Sprite.WebGLRenderCmd.call(this,t),cc.LabelTTF.CacheRenderCmd.call(this)};var t=cc.LabelTTF.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);cc.inject(cc.LabelTTF.CacheRenderCmd.prototype,t),t.constructor=cc.LabelTTF.WebGLRenderCmd,t._updateColor=function(){}}(),cc.DrawingPrimitiveWebGL=cc.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:"u_color",_colorArray:null,_pointSizeLocation:"u_pointSize",_pointSize:-1,ctor:function(t){if(null==t&&(t=cc._renderContext),!t instanceof WebGLRenderingContext)throw new Error("Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext");this._renderContext=t,this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){var t=this;t._initialized||(t._shader=cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR),t._shader._addUniformLocation(this._colorLocation),t._shader._addUniformLocation(this._pointSizeLocation),t._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(t){this.lazy_init();var e=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),e.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([t.x,t.y]),e.STATIC_DRAW),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0),e.drawArrays(e.POINTS,0,1),e.deleteBuffer(i),cc.incrementGLDraws(1)},drawPoints:function(t,e){if(t&&0!==t.length){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray),this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray(t),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.POINTS,0,t.length),i.deleteBuffer(n),cc.incrementGLDraws(1)}},_pointsToTypeArray:function(t){for(var e=new Float32Array(2*t.length),i=0;i<t.length;i++)e[2*i]=t[i].x,e[2*i+1]=t[i].y;return e},drawLine:function(t,e){this.lazy_init();var i=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.bufferData(i.ARRAY_BUFFER,this._pointsToTypeArray([t,e]),i.STATIC_DRAW),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,i.FLOAT,!1,0,0),i.drawArrays(i.LINES,0,2),i.deleteBuffer(n),cc.incrementGLDraws(1)},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){var n=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(t,e,i){this.lazy_init();var n=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(t),n.STATIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),i?n.drawArrays(n.LINE_LOOP,0,t.length):n.drawArrays(n.LINE_STRIP,0,t.length),n.deleteBuffer(r),cc.incrementGLDraws(1)},drawSolidPoly:function(t,e,i){this.lazy_init(),i&&this.setDrawColor(i.r,i.g,i.b,i.a);var n=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r),n.bufferData(n.ARRAY_BUFFER,this._pointsToTypeArray(t),n.STATIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLE_FAN,0,t.length),n.deleteBuffer(r),cc.incrementGLDraws(1)},drawCircle:function(t,e,i,n,r){this.lazy_init();var o=1;r&&o++;var s=2*Math.PI/n,c=new Float32Array(2*(n+2));if(c){for(var a=0;a<=n;a++){var l=a*s,h=e*Math.cos(l+i)+t.x,u=e*Math.sin(l+i)+t.y;c[2*a]=h,c[2*a+1]=u}c[2*(n+1)]=t.x,c[2*(n+1)+1]=t.y;var d=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),d.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var _=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,_),d.bufferData(d.ARRAY_BUFFER,c,d.STATIC_DRAW),d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0),d.drawArrays(d.LINE_STRIP,0,n+o),d.deleteBuffer(_),cc.incrementGLDraws(1)}},drawQuadBezier:function(t,e,i,n){this.lazy_init();for(var r=new Float32Array(2*(n+1)),o=0,s=0;s<n;s++)r[2*s]=Math.pow(1-o,2)*t.x+2*(1-o)*o*e.x+o*o*i.x,r[2*s+1]=Math.pow(1-o,2)*t.y+2*(1-o)*o*e.y+o*o*i.y,o+=1/n;r[2*n]=i.x,r[2*n+1]=i.y;var c=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),c.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a),c.bufferData(c.ARRAY_BUFFER,r,c.STATIC_DRAW),c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,c.FLOAT,!1,0,0),c.drawArrays(c.LINE_STRIP,0,n+1),c.deleteBuffer(a),cc.incrementGLDraws(1)},drawCubicBezier:function(t,e,i,n,r){this.lazy_init();for(var o=new Float32Array(2*(r+1)),s=0,c=0;c<r;c++)o[2*c]=Math.pow(1-s,3)*t.x+3*Math.pow(1-s,2)*s*e.x+3*(1-s)*s*s*i.x+s*s*s*n.x,o[2*c+1]=Math.pow(1-s,3)*t.y+3*Math.pow(1-s,2)*s*e.y+3*(1-s)*s*s*i.y+s*s*s*n.y,s+=1/r;o[2*r]=n.x,o[2*r+1]=n.y;var a=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),a.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var l=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,o,a.STATIC_DRAW),a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0),a.drawArrays(a.LINE_STRIP,0,r+1),a.deleteBuffer(l),cc.incrementGLDraws(1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){this.lazy_init();for(var n,r,o=new Float32Array(2*(i+1)),s=1/t.length,c=0;c<i+1;c++){var a=c/i;1===a?(n=t.length-1,r=1):(n=0|a/s,r=(a-s*n)/s);var l=cc.cardinalSplineAt(cc.getControlPointAt(t,n-1),cc.getControlPointAt(t,n),cc.getControlPointAt(t,n+1),cc.getControlPointAt(t,n+2),e,r);o[2*c]=l.x,o[2*c+1]=l.y}var h=this._renderContext;this._shader.use(),this._shader.setUniformForModelViewAndProjectionMatrixWithMat4(),h.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),this._shader.setUniformLocationWith4fv(this._colorLocation,this._colorArray);var u=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,u),h.bufferData(h.ARRAY_BUFFER,o,h.STATIC_DRAW),h.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,0),h.drawArrays(h.LINE_STRIP,0,i+1),h.deleteBuffer(u),cc.incrementGLDraws(1)},setDrawColor:function(t,e,i,n){this._colorArray[0]=t/255,this._colorArray[1]=e/255,this._colorArray[2]=i/255,this._colorArray[3]=n/255},setPointSize:function(t){this._pointSize=t*cc.contentScaleFactor()},setLineWidth:function(t){this._renderContext.lineWidth&&this._renderContext.lineWidth(t)}});var _p=cc.inputManager;_p.setAccelerometerEnabled=function(t){var e=this;if(e._accelEnabled!==t){e._accelEnabled=t;var i=cc.director.getScheduler();e._accelEnabled?(e._accelCurTime=0,i.scheduleUpdate(e)):(e._accelCurTime=0,i.scheduleUpdate(e))}},_p.setAccelerometerInterval=function(t){this._accelInterval!==t&&(this._accelInterval=t)},_p._registerKeyboardEvent=function(){cc._canvas.addEventListener("keydown",function(t){cc.eventManager.dispatchEvent(new cc.EventKeyboard(t.keyCode,!0)),t.stopPropagation(),t.preventDefault()},!1),cc._canvas.addEventListener("keyup",function(t){cc.eventManager.dispatchEvent(new cc.EventKeyboard(t.keyCode,!1)),t.stopPropagation(),t.preventDefault()},!1)},_p._registerAccelerometerEvent=function(){var t=window,e=this;e._acceleration=new cc.Acceleration,e._accelDeviceEvent=t.DeviceMotionEvent||t.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(e._accelDeviceEvent=window.DeviceOrientationEvent);var i=e._accelDeviceEvent===t.DeviceMotionEvent?"devicemotion":"deviceorientation",n=navigator.userAgent;(/Android/.test(n)||/Adr/.test(n)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(e._minus=-1),t.addEventListener(i,e.didAccelerate.bind(e),!1)},_p.didAccelerate=function(t){var e=this,i=window;if(e._accelEnabled){var n,r,o,s=e._acceleration;if(e._accelDeviceEvent===window.DeviceMotionEvent){var c=t.accelerationIncludingGravity;n=e._accelMinus*c.x*.1,r=e._accelMinus*c.y*.1,o=.1*c.z}else n=t.gamma/90*.981,r=.981*-(t.beta/90),o=t.alpha/90*.981;s.x=n,s.y=r,s.z=o,s.timestamp=t.timeStamp||Date.now();var a=s.x;i.orientation===cc.UIInterfaceOrientationLandscapeRight?(s.x=-s.y,s.y=a):i.orientation===cc.UIInterfaceOrientationLandscapeLeft?(s.x=s.y,s.y=-a):i.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(s.x=-s.x,s.y=-s.y)}},delete _p,cc.vertexLineToPolygon=function(t,e,i,n,r){if(r+=n,!(r<=1)){e*=.5;for(var o,s=r-1,c=n;c<r;c++){o=2*c;var a,l=cc.p(t[2*c],t[2*c+1]);if(0===c)a=cc.pPerp(cc.pNormalize(cc.pSub(l,cc.p(t[2*(c+1)],t[2*(c+1)+1]))));else if(c===s)a=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(t[2*(c-1)],t[2*(c-1)+1]),l)));else{var h=cc.p(t[2*(c-1)],t[2*(c-1)+1]),u=cc.p(t[2*(c+1)],t[2*(c+1)+1]),d=cc.pNormalize(cc.pSub(u,l)),_=cc.pNormalize(cc.pSub(h,l)),p=Math.acos(cc.pDot(d,_));a=p<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(d,_))):p<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(d,_)):cc.pPerp(cc.pNormalize(cc.pSub(u,h)))}a=cc.pMult(a,e),i[2*o]=l.x+a.x,i[2*o+1]=l.y+a.y,i[2*(o+1)]=l.x-a.x,i[2*(o+1)+1]=l.y-a.y}for(n=0===n?0:n-1,c=n;c<s;c++){o=2*c;var f=o+2,m=cc.vertex2(i[2*o],i[2*o+1]),g=cc.vertex2(i[2*(o+1)],i[2*(o+1)+1]),y=cc.vertex2(i[2*f],i[2*f]),v=cc.vertex2(i[2*(f+1)],i[2*(f+1)+1]),T=!cc.vertexLineIntersect(m.x,m.y,v.x,v.y,g.x,g.y,y.x,y.y);T.isSuccess||(T.value<0||T.value>1)&&(T.isSuccess=!0),T.isSuccess&&(i[2*f]=v.x,i[2*f+1]=v.y,i[2*(f+1)]=y.x,i[2*(f+1)+1]=y.y)}}},cc.vertexLineIntersect=function(t,e,i,n,r,o,s,c){var a,l,h,u;if(t===i&&e===n||r===s&&o===c)return{isSuccess:!1,value:0};if(i-=t,n-=e,r-=t,o-=e,s-=t,c-=e,a=Math.sqrt(i*i+n*n),l=i/a,h=n/a,u=r*l+o*h,o=o*l-r*h,r=u,u=s*l+c*h,c=c*l-s*h,s=u,o===c)return{isSuccess:!1,value:0};var d=(s+(r-s)*c/(c-o))/a;return{isSuccess:!0,value:d}},cc.vertexListIsClockwise=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e],r=t[(e+1)%i],o=t[(e+2)%i];if(cc.pCross(cc.pSub(r,n),cc.pSub(o,r))>0)return!1}return!0},cc.CGAffineToGL=function(t,e){e[2]=e[3]=e[6]=e[7]=e[8]=e[9]=e[11]=e[14]=0,e[10]=e[15]=1,e[0]=t.a,e[4]=t.c,e[12]=t.tx,e[1]=t.b,e[5]=t.d,e[13]=t.ty},cc.GLToCGAffine=function(t,e){e.a=t[0],e.c=t[4],e.tx=t[12],e.b=t[1],e.d=t[5],e.ty=t[13]},cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(t){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION),this._acc=t}}),cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(t,e){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD),this._keyCode=t,this._isPressed=e}}),cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(t){this._onAccelerationEvent=t;var e=this,i=function(t){e._onAccelerationEvent(t._acc,t)};cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,i)},checkAvailable:function(){return cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}}),cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration",cc._EventListenerAcceleration.create=function(t){return new cc._EventListenerAcceleration(t)},cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var t=this,e=function(e){e._isPressed?t.onKeyPressed&&t.onKeyPressed(e._keyCode,e):t.onKeyReleased&&t.onKeyReleased(e._keyCode,e)};cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,e)},clone:function(){var t=new cc._EventListenerKeyboard;return t.onKeyPressed=this.onKeyPressed,t.onKeyReleased=this.onKeyReleased,t},checkAvailable:function(){return null!==this.onKeyPressed||null!==this.onKeyReleased||(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1)}}),cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard",cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard},cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_texture:null,_textureForCanvas:null,ctor:function(t,e,i,n){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._ignoreContentScaleFactor=!1,void 0!==n&&this.initWithTileFile(t,e,i,n)},_createRenderCmd:function(){cc._renderType===cc.game.RENDER_TYPE_CANVAS?this._renderCmd=new cc.AtlasNode.CanvasRenderCmd(this):this._renderCmd=new cc.AtlasNode.WebGLRenderCmd(this)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(t){var e=this.color;this._opacityModifyRGB=t,this.setColor(e)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:this._blendFunc={src:t,dst:e}},setTextureAtlas:function(t){this.textureAtlas=t},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(t){this.quadsToDraw=t},initWithTileFile:function(t,e,i,n){if(!t)throw new Error("cc.AtlasNode.initWithTileFile(): title should not be null");var r=cc.textureCache.addImage(t);return this.initWithTexture(r,e,i,n)},initWithTexture:function(t,e,i,n){return this._renderCmd.initWithTexture(t,e,i,n)},setColor:function(t){this._renderCmd.setColor(t)},setOpacity:function(t){this._renderCmd.setOpacity(t)},getTexture:function(){return this._texture},setTexture:function(t){this._texture=t},_setIgnoreContentScaleFactor:function(t){this._ignoreContentScaleFactor=t}});var _p=cc.AtlasNode.prototype;cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor),_p.texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),_p.textureAtlas,_p.quadsToDraw,cc.EventHelper.prototype.apply(_p),cc.AtlasNode.create=function(t,e,i,n){return new cc.AtlasNode(t,e,i,n)},function(){cc.AtlasNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!1,this._colorUnmodified=cc.color.WHITE,this._textureToRender=null};var t=cc.AtlasNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.AtlasNode.CanvasRenderCmd,t.initWithTexture=function(t,e,i,n){var r=this._node;return r._itemWidth=e,r._itemHeight=i,r._opacityModifyRGB=!0,r._texture=t,r._texture?(this._textureToRender=t,this._calculateMaxItems(),r.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},t.setColor=function(t){var e=this._node,i=e._realColor;i.r===t.r&&i.g===t.g&&i.b===t.b||(this._colorUnmodified=t,this._changeTextureColor())},t._changeTextureColor=function(){var t=this._node,e=t._texture,i=this._colorUnmodified,n=e.getHtmlElementObj(),r=cc.rect(0,0,n.width,n.height);e===this._textureToRender?this._textureToRender=e._generateColorTexture(i.r,i.g,i.b,r):e._generateColorTexture(i.r,i.g,i.b,r,this._textureToRender.getHtmlElementObj())},t.setOpacity=function(t){var e=this._node;cc.Node.prototype.setOpacity.call(e,t)},t._calculateMaxItems=function(){var t=this._node,e=t._texture,i=e.getContentSize();t._itemsPerColumn=0|i.height/t._itemHeight,t._itemsPerRow=0|i.width/t._itemWidth}}(),cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(t,e){this._buffersVBO=[],cc.isString(t)?this.initWithFile(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(t){this.texture=t},setDirty:function(t){this.dirty=t},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(t){this._quads=t},_copyQuadsToTextureAtlas:function(t,e){if(t)for(var i=0;i<t.length;i++)this._setQuadToArray(t[i],e+i)},_setQuadToArray:function(t,e){var i=this._quads;return i[e]?(i[e].bl=t.bl,i[e].br=t.br,i[e].tl=t.tl,void(i[e].tr=t.tr)):void(i[e]=new cc.V3F_C4B_T2F_Quad(t.tl,t.bl,t.tr,t.br,this._quadsArrayBuffer,e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT))},description:function(){return"<cc.TextureAtlas | totalQuads ="+this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var t=this._indices,e=this._capacity,i=0;i<e;i++)cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(t[6*i+0]=4*i+0,t[6*i+1]=4*i+0,t[6*i+2]=4*i+2,t[6*i+3]=4*i+1,t[6*i+4]=4*i+3,t[6*i+5]=4*i+3):(t[6*i+0]=4*i+0,t[6*i+1]=4*i+1,t[6*i+2]=4*i+2,t[6*i+3]=4*i+3,t[6*i+4]=4*i+2,t[6*i+5]=4*i+1)},_setupVBO:function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),this._buffersVBO[1]=t.createBuffer(),this._quadsWebBuffer=t.createBuffer(),this._mapBuffers()},_mapBuffers:function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._quadsWebBuffer),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},initWithFile:function(t,e){var i=cc.textureCache.addImage(t);return i?this.initWithTexture(i,e):(cc.log(cc._LogInfos.TextureAtlas_initWithFile,t),!1)},initWithTexture:function(t,e){cc.assert(t,cc._LogInfos.TextureAtlas_initWithTexture),e|=0,this._capacity=e,this._totalQuads=0,this.texture=t,this._quads=[],this._indices=new Uint16Array(6*e);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(i*e),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&e>0)return!1;for(var n=this._quads,r=0;r<e;r++)n[r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,r*i);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(t,e){cc.assert(t,cc._LogInfos.TextureAtlas_updateQuad),cc.assert(e>=0&&e<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2),this._totalQuads=Math.max(e+1,this._totalQuads),this._setQuadToArray(t,e),this.dirty=!0},insertQuad:function(t,e){if(cc.assert(e<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2),this._totalQuads++,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=this._totalQuads-1-e,r=e*i,o=n*i;this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*i),this._quadsReader.set(this._quadsReader.subarray(r,r+o),r+i),this._setQuadToArray(t,e),this.dirty=!0},insertQuads:function(t,e,i){i=i||t.length,cc.assert(e+i<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=i,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var r,o=this._totalQuads-1-e-i,s=e*n,c=o*n,a=this._totalQuads-1-i;for(r=0;r<i;r++)this._quads[a+r]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*n);for(this._quadsReader.set(this._quadsReader.subarray(s,s+c),s+n*i),r=0;r<i;r++)this._setQuadToArray(t[r],e+r);this.dirty=!0},insertQuadFromIndex:function(t,e){if(t!==e){cc.assert(e>=0||e<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex),cc.assert(t>=0||t<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);var i,n,r=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,o=this._quadsReader,s=o.subarray(t*r,r);t>e?(i=e*r,n=(t-e)*r,o.set(o.subarray(i,i+n),i+r),o.set(s,i)):(i=(t+1)*r,n=(e-t)*r,o.set(o.subarray(i,i+n),i-r),o.set(s,e*r)),this.dirty=!0}},removeQuadAtIndex:function(t){cc.assert(t<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,t!==this._totalQuads){var i=(t+1)*e,n=(this._totalQuads-t)*e;this._quadsReader.set(this._quadsReader.subarray(i,i+n),i-e)}this.dirty=!0},removeQuadsAtIndex:function(t,e){if(cc.assert(t+e<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=e,t!==this._totalQuads){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=(t+e)*i,r=(this._totalQuads-t)*i,o=t*i;this._quadsReader.set(this._quadsReader.subarray(n,n+r),o)}this.dirty=!0},removeAllQuads:function(){this._quads.length=0,this._totalQuads=0},_setDirty:function(t){this.dirty=t},resizeCapacity:function(t){if(t===this._capacity)return!0;var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=this._capacity;this._totalQuads=Math.min(this._totalQuads,t),this._capacity=0|t;var n,r=this._capacity,o=this._totalQuads;if(null===this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(e*r),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),n=0;n<r;n++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,n*e);else{var s,c,a=this._quads;if(r>i){for(s=[],c=new ArrayBuffer(e*r),n=0;n<o;n++)s[n]=new cc.V3F_C4B_T2F_Quad(a[n].tl,a[n].bl,a[n].tr,a[n].br,c,n*e);for(;n<r;n++)s[n]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,c,n*e);this._quadsReader=new Uint8Array(c),this._quads=s,this._quadsArrayBuffer=c}else{var l=Math.max(o,r);for(s=[],c=new ArrayBuffer(e*r),n=0;n<l;n++)s[n]=new cc.V3F_C4B_T2F_Quad(a[n].tl,a[n].bl,a[n].tr,a[n].br,c,n*e);this._quadsReader=new Uint8Array(c),this._quads=s,this._quadsArrayBuffer=c}}if(null===this._indices)this._indices=new Uint16Array(6*r);else if(r>i){var h=new Uint16Array(6*r);h.set(this._indices,0),this._indices=h}else this._indices=this._indices.subarray(0,6*r);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(t){this._totalQuads+=t},moveQuadsFromIndex:function(t,e,i){if(void 0===i){if(i=e,e=this._totalQuads-t,cc.assert(i+(this._totalQuads-t)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===e)return}else if(cc.assert(i+e<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(t<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),t===i)return;var n,r,o=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=t*o,c=e*o,a=this._quadsReader,l=a.subarray(s,s+c),h=i*o;i<t?(n=(t-i)*o,r=i*o,a.set(a.subarray(r,r+n),r+c)):(n=(i-t)*o,r=(t+e)*o,a.set(a.subarray(r,r+n),s)),a.set(l,h),this.dirty=!0},fillWithEmptyQuadsFromIndex:function(t,e){for(var i=e*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,n=new Uint8Array(this._quadsArrayBuffer,t*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i),r=0;r<i;r++)n[r]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var t=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&t.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&t.deleteBuffer(this._buffersVBO[1])),this._quadsWebBuffer&&t.deleteBuffer(this._quadsWebBuffer)}});var _p=cc.TextureAtlas.prototype;_p.totalQuads,cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads),_p.capacity,cc.defineGetterSetter(_p,"capacity",_p.getCapacity),_p.quads,cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads),cc.TextureAtlas.create=function(t,e){return new cc.TextureAtlas(t,e)},cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas)}),cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js"),cc._tmp.PrototypeTextureAtlas(),delete cc._tmp.PrototypeTextureAtlas,cc.PI2=2*Math.PI,cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(t){this._renderContext=t},drawPoint:function(t,e){e||(e=1);var i=cc.view.getScaleX(),n=cc.view.getScaleY(),r=cc.p(t.x*i,t.y*n),o=this._renderContext.getContext();o.beginPath(),o.arc(r.x,-r.y,e*i,0,2*Math.PI,!1),o.closePath(),o.fill()},drawPoints:function(t,e,i){if(null!=t){i||(i=1);var n=this._renderContext.getContext(),r=cc.view.getScaleX(),o=cc.view.getScaleY();n.beginPath();for(var s=0,c=t.length;s<c;s++)n.arc(t[s].x*r,-t[s].y*o,i*r,0,2*Math.PI,!1);n.closePath(),n.fill()}},drawLine:function(t,e){var i=this._renderContext.getContext();cc.view.getScaleX(),cc.view.getScaleY();i.beginPath(),i.moveTo(t.x,-t.y),i.lineTo(e.x,-e.y),i.closePath(),i.stroke()},drawRect:function(t,e){this.drawLine(cc.p(t.x,t.y),cc.p(e.x,t.y)),this.drawLine(cc.p(e.x,t.y),cc.p(e.x,e.y)),this.drawLine(cc.p(e.x,e.y),cc.p(t.x,e.y)),this.drawLine(cc.p(t.x,e.y),cc.p(t.x,t.y))},drawSolidRect:function(t,e,i){var n=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];this.drawSolidPoly(n,4,i)},drawPoly:function(t,e,i,n){if(n=n||!1,null!=t){if(t.length<3)throw new Error("Polygon's point must greater than 2");var r=t[0],o=this._renderContext.getContext();cc.view.getScaleX(),cc.view.getScaleY();o.beginPath(),o.moveTo(r.x,-r.y);for(var s=1,c=t.length;s<c;s++)o.lineTo(t[s].x,-t[s].y);i&&o.closePath(),n?o.fill():o.stroke()}},drawSolidPoly:function(t,e,i){this.setDrawColor(i.r,i.g,i.b,i.a),this.drawPoly(t,e,!0,!0)},drawCircle:function(t,e,i,n,r){r=r||!1;var o=this._renderContext.getContext();cc.view.getScaleX(),cc.view.getScaleY();o.beginPath();var s=i-2*Math.PI;o.arc(0|t.x,0|-t.y,e,-i,-s,!1),r&&o.lineTo(0|t.x,0|-t.y),o.stroke()},drawQuadBezier:function(t,e,i,n){var r=this._cacheArray;r.length=0;for(var o=0,s=0;s<n;s++){var c=Math.pow(1-o,2)*t.x+2*(1-o)*o*e.x+o*o*i.x,a=Math.pow(1-o,2)*t.y+2*(1-o)*o*e.y+o*o*i.y;r.push(cc.p(c,a)),o+=1/n}r.push(cc.p(i.x,i.y)),this.drawPoly(r,n+1,!1,!1)},drawCubicBezier:function(t,e,i,n,r){var o=this._cacheArray;o.length=0;for(var s=0,c=0;c<r;c++){var a=Math.pow(1-s,3)*t.x+3*Math.pow(1-s,2)*s*e.x+3*(1-s)*s*s*i.x+s*s*s*n.x,l=Math.pow(1-s,3)*t.y+3*Math.pow(1-s,2)*s*e.y+3*(1-s)*s*s*i.y+s*s*s*n.y;o.push(cc.p(a,l)),s+=1/r}o.push(cc.p(n.x,n.y)),this.drawPoly(o,r+1,!1,!1)},drawCatmullRom:function(t,e){this.drawCardinalSpline(t,.5,e)},drawCardinalSpline:function(t,e,i){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var n=this._cacheArray;n.length=0;for(var r,o,s=1/t.length,c=0;c<i+1;c++){var a=c/i;1===a?(r=t.length-1,o=1):(r=0|a/s,o=(a-s*r)/s);var l=cc.CardinalSplineAt(cc.getControlPointAt(t,r-1),cc.getControlPointAt(t,r-0),cc.getControlPointAt(t,r+1),cc.getControlPointAt(t,r+2),e,o);n.push(l)}this.drawPoly(n,i+1,!1,!1)},drawImage:function(t,e,i,n,r){var o=arguments.length,s=this._renderContext.getContext();switch(o){case 2:var c=t.height;s.drawImage(t,e.x,-(e.y+c));break;case 3:s.drawImage(t,e.x,-(e.y+i.height),i.width,i.height);break;case 5:s.drawImage(t,e.x,e.y,i.width,i.height,n.x,-(n.y+r.height),r.width,r.height);break;default:throw new Error("Argument must be non-nil")}},drawStar:function(t,e,i){var n=t||this._renderContext,r=n.getContext(),o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b);n.setFillStyle(o+",1)");var s=e/10;r.beginPath(),r.moveTo(-e,e),r.lineTo(0,s),r.lineTo(e,e),r.lineTo(s,0),r.lineTo(e,-e),r.lineTo(0,-s),r.lineTo(-e,-e),r.lineTo(-s,0),r.lineTo(-e,e),r.closePath(),r.fill();var c=r.createRadialGradient(0,0,s,0,0,e);c.addColorStop(0,o+", 1)"),c.addColorStop(.3,o+", 0.8)"),c.addColorStop(1,o+", 0.0)"),n.setFillStyle(c),r.beginPath();var a=0,l=cc.PI2;r.arc(0,0,e-s,a,l,!1),r.closePath(),r.fill()},drawColorBall:function(t,e,i){var n=t||this._renderContext,r=n.getContext();e*=cc.view.getScaleX();var o="rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b),s=e/10,c=r.createRadialGradient(0,0,s,0,0,e);c.addColorStop(0,o+", 1)"),c.addColorStop(.3,o+", 0.8)"),c.addColorStop(.6,o+", 0.4)"),c.addColorStop(1,o+", 0.0)"),n.setFillStyle(c),r.beginPath();var a=0,l=cc.PI2;r.arc(0,0,e,a,l,!1),r.closePath(),r.fill()},fillText:function(t,e,i){this._renderContext.getContext().fillText(t,e,-i)},setDrawColor:function(t,e,i,n){this._renderContext.setFillStyle("rgba("+t+","+e+","+i+","+n/255+")"),this._renderContext.setStrokeStyle("rgba("+t+","+e+","+i+","+n/255+")")},setPointSize:function(t){},setLineWidth:function(t){this._renderContext.getContext().lineWidth=t*cc.view.getScaleX()}});!function(){cc.AtlasNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._textureAtlas=null,this._colorUnmodified=cc.color.WHITE,this._colorF32Array=null,this._uniformColor=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR),this._uniformColor=cc._renderContext.getUniformLocation(this._shaderProgram.getProgram(),"u_color")};var t=cc.AtlasNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.AtlasNode.WebGLRenderCmd,t._updateBlendFunc=function(){var t=this._node;this._textureAtlas.texture.hasPremultipliedAlpha()||(t._blendFunc.src=cc.SRC_ALPHA,t._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},t._updateOpacityModifyRGB=function(){this._node._opacityModifyRGB=this._textureAtlas.texture.hasPremultipliedAlpha()},t.rendering=function(t){var e=t||cc._renderContext,i=this._node,n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.glBlendFunc(i._blendFunc.src,i._blendFunc.dst),this._uniformColor&&this._colorF32Array&&(e.uniform4fv(this._uniformColor,this._colorF32Array),this._textureAtlas.drawNumberOfQuads(i.quadsToDraw,0))},t.initWithTexture=function(t,e,i,n){var r=this._node;r._itemWidth=e,r._itemHeight=i,this._colorUnmodified=cc.color.WHITE,r._opacityModifyRGB=!0,r._blendFunc.src=cc.BLEND_SRC,r._blendFunc.dst=cc.BLEND_DST;var o=r._realColor;return this._colorF32Array=new Float32Array([o.r/255,o.g/255,o.b/255,r._realOpacity/255]),this._textureAtlas=new cc.TextureAtlas,this._textureAtlas.initWithTexture(t,n),this._textureAtlas?(this._updateBlendFunc(),this._updateOpacityModifyRGB(),this._calculateMaxItems(),r.quadsToDraw=n,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},t.setColor=function(t){var e=cc.color(t.r,t.g,t.b),i=this._node;this._colorUnmodified=t;var n=this._displayedOpacity;i._opacityModifyRGB&&(e.r=e.r*n/255,e.g=e.g*n/255,e.b=e.b*n/255),cc.Node.prototype.setColor.call(i,e)},t.setOpacity=function(t){var e=this._node;cc.Node.prototype.setOpacity.call(e,t),e._opacityModifyRGB&&(e.color=this._colorUnmodified)},t._updateColor=function(){if(this._colorF32Array){var t=this._displayedColor;this._colorF32Array[0]=t.r/255,this._colorF32Array[1]=t.g/255,this._colorF32Array[2]=t.b/255,this._colorF32Array[3]=this._displayedOpacity/255}},t.getTexture=function(){return this._textureAtlas.texture},t.setTexture=function(t){this._textureAtlas.texture=t,this._updateBlendFunc(),this._updateOpacityModifyRGB()},t._calculateMaxItems=function(){var t=this._node,e=this._textureAtlas.texture,i=e.getContentSize();t._ignoreContentScaleFactor&&(i=e.getContentSizeInPixels()),t._itemsPerColumn=0|i.height/t._itemHeight,t._itemsPerRow=0|i.width/t._itemWidth}}();cc._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag = %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX != RotationY. Don't know which one to return",Node_getScale:"ScaleX != ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag = %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"child must be non-null",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex = %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id=%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id= HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."},cc._logToWebPage=function(t){if(cc._canvas){var e=cc._logList,i=document;if(!e){var n=i.createElement("Div"),r=n.style;n.setAttribute("id","logInfoDiv"),cc._canvas.parentNode.appendChild(n),n.setAttribute("width","200"),n.setAttribute("height",cc._canvas.height),r.zIndex="99999",r.position="absolute",r.top="0",r.left="0",e=cc._logList=i.createElement("textarea");var o=e.style;e.setAttribute("rows","20"),e.setAttribute("cols","30"),e.setAttribute("disabled",!0),n.appendChild(e),o.backgroundColor="transparent",o.borderBottom="1px solid #cccccc",o.borderRightWidth="0px",o.borderLeftWidth="0px",o.borderTopWidth="0px",o.borderTopStyle="none",o.borderRightStyle="none",o.borderLeftStyle="none",o.padding="0px",o.margin=0}e.value=e.value+t+"\r\n",e.scrollTop=e.scrollHeight}},cc._formatString=function(t){if(!cc.isObject(t))return t;try{return JSON.stringify(t)}catch(t){return""}},cc._initDebugSetting=function(t){var e=cc.game;if(t!==e.DEBUG_MODE_NONE){var i;t>e.DEBUG_MODE_ERROR?(i=cc._logToWebPage.bind(cc),cc.error=function(){i("ERROR :  "+cc.formatStr.apply(cc,arguments))},cc.assert=function(t,e){if(!t&&e){for(var n=2;n<arguments.length;n++)e=e.replace(/(%s)|(%d)/,cc._formatString(arguments[n]));i("Assert: "+e)}},t!==e.DEBUG_MODE_ERROR_FOR_WEB_PAGE&&(cc.warn=function(){i("WARN :  "+cc.formatStr.apply(cc,arguments))}),t===e.DEBUG_MODE_INFO_FOR_WEB_PAGE&&(cc.log=function(){i(cc.formatStr.apply(cc,arguments))})):console&&console.log.apply&&(cc.error=Function.prototype.bind.call(console.error,console),console.assert?cc.assert=Function.prototype.bind.call(console.assert,console):cc.assert=function(t,e){if(!t&&e){for(var i=2;i<arguments.length;i++)e=e.replace(/(%s)|(%d)/,cc._formatString(arguments[i]));throw new Error(e)}},t!==e.DEBUG_MODE_ERROR&&(cc.warn=Function.prototype.bind.call(console.warn,console)),t===e.DEBUG_MODE_INFO&&(cc.log=Function.prototype.bind.call(console.log,console)))}};cc.HashElement=cc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:!1,paused:!1,hh:null,ctor:function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.currentActionSalvaged=!1,this.paused=!1,this.hh=null}}),cc.ActionManager=cc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:!1,_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return null},ctor:function(){this._hashTargets={},this._arrayTargets=[],this._currentTarget=null,this._currentTargetSalvaged=!1},addAction:function(t,e,i){if(!t)throw new Error("cc.ActionManager.addAction(): action must be non-null");if(!e)throw new Error("cc.ActionManager.addAction(): action must be non-null");var n=this._hashTargets[e.__instanceId];n||(n=new cc.HashElement,n.paused=i,n.target=e,this._hashTargets[e.__instanceId]=n,this._arrayTargets.push(n)),this._actionAllocWithHashElement(n),n.actions.push(t),t.startWithTarget(e)},removeAllActions:function(){for(var t=this._arrayTargets,e=0;e<t.length;e++){var i=t[e];i&&this.removeAllActionsFromTarget(i.target,!0)}},removeAllActionsFromTarget:function(t,e){if(null!=t){var i=this._hashTargets[t.__instanceId];i&&(i.actions.indexOf(i.currentAction)===-1||i.currentActionSalvaged||(i.currentActionSalvaged=!0),i.actions.length=0,this._currentTarget!==i||e?this._deleteHashElement(i):this._currentTargetSalvaged=!0)}},removeAction:function(t){if(null!=t){var e=t.getOriginalTarget(),i=this._hashTargets[e.__instanceId];if(i){for(var n=0;n<i.actions.length;n++)if(i.actions[n]===t){i.actions.splice(n,1);break}}else cc.log(cc._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(t,e){t===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_addAction),cc.assert(e,cc._LogInfos.ActionManager_addAction);var i=this._hashTargets[e.__instanceId];if(i)for(var n=i.actions.length,r=0;r<n;++r){var o=i.actions[r];if(o&&o.getTag()===t&&o.getOriginalTarget()===e){this._removeActionAtIndex(r,i);break}}},getActionByTag:function(t,e){t===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_getActionByTag);var i=this._hashTargets[e.__instanceId];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var r=i.actions[n];if(r&&r.getTag()===t)return r}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,t)}return null},numberOfRunningActionsInTarget:function(t){var e=this._hashTargets[t.__instanceId];return e&&e.actions?e.actions.length:0},pauseTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!0)},resumeTarget:function(t){var e=this._hashTargets[t.__instanceId];e&&(e.paused=!1)},pauseAllRunningActions:function(){for(var t=[],e=this._arrayTargets,i=0;i<e.length;i++){var n=e[i];n&&!n.paused&&(n.paused=!0,t.push(n.target))}return t},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(t,e){var i=e.actions[t];i!==e.currentAction||e.currentActionSalvaged||(e.currentActionSalvaged=!0),e.actions.splice(t,1),e.actionIndex>=t&&e.actionIndex--,0===e.actions.length&&(this._currentTarget===e?this._currentTargetSalvaged=!0:this._deleteHashElement(e))},_deleteHashElement:function(t){var e=!1;return t&&(this._hashTargets[t.target.__instanceId]&&(delete this._hashTargets[t.target.__instanceId],cc.arrayRemoveObject(this._arrayTargets,t),e=!0),t.actions=null,t.target=null),e},_actionAllocWithHashElement:function(t){null==t.actions&&(t.actions=[])},update:function(t){for(var e,i=this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],e=this._currentTarget,!e.paused)for(e.actionIndex=0;e.actionIndex<(e.actions?e.actions.length:0);e.actionIndex++)if(e.currentAction=e.actions[e.actionIndex],e.currentAction){if(e.currentActionSalvaged=!1,e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentActionSalvaged)e.currentAction=null;else if(e.currentAction.isDone()){e.currentAction.stop();var r=e.currentAction;e.currentAction=null,this.removeAction(r)}e.currentAction=null}this._currentTargetSalvaged&&0===e.actions.length&&this._deleteHashElement(e)&&n--}}}),cc.ACTION_TAG_INVALID=-1,cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.ACTION_TAG_INVALID},copy:function(){return cc.log("copy is deprecated. Please use clone instead."),this.clone()},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(t){cc.log("[Action step]. override me")},update:function(t){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.action=function(){return new cc.Action},cc.Action.create=cc.action,cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this),this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){if(!t)throw new Error("cc.Speed.initWithAction(): action must be non nil");return this._innerAction=t,this._speed=e,!0},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Speed.create=cc.speed,cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(t,e){cc.Action.prototype.ctor.call(this),this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)throw new Error("cc.Follow.initWithAction(): followedNode must be non nil");var i=this;e=e||cc.rect(0,0,0,0),i._followedNode=t,i._worldRect=e,i._boundarySet=!cc._rectEqualToZero(e),i._boundaryFullyCovered=!1;var n=cc.director.getWinSize();return i._fullScreenSize=cc.p(n.width,n.height),i._halfScreenSize=cc.pMult(i._fullScreenSize,.5),i._boundarySet&&(i.leftBoundary=-(e.x+e.width-i._fullScreenSize.x),i.rightBoundary=-e.x,i.topBoundary=-e.y,i.bottomBoundary=-(e.y+e.height-i._fullScreenSize.y),i.rightBoundary<i.leftBoundary&&(i.rightBoundary=i.leftBoundary=(i.leftBoundary+i.rightBoundary)/2),i.topBoundary<i.bottomBoundary&&(i.topBoundary=i.bottomBoundary=(i.topBoundary+i.bottomBoundary)/2),i.topBoundary===i.bottomBoundary&&i.leftBoundary===i.rightBoundary&&(i._boundaryFullyCovered=!0)),!0},step:function(t){var e=this._followedNode.x,i=this._followedNode.y;if(e=this._halfScreenSize.x-e,i=this._halfScreenSize.y-i,this.target._renderCmd._dirtyFlag=0,this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(cc.clampf(e,this.leftBoundary,this.rightBoundary),cc.clampf(i,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(e,i)},isDone:function(){return!this._followedNode.running},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)},cc.Follow.create=cc.follow,cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(t){this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this.MAX_VALUE=2,this._repeatMethod=!1,this._speedMethod=!1,cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(t){this._easeList?this._easeList.length=0:this._easeList=[];for(var e=0;e<arguments.length;e++)this._easeList.push(arguments[e]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(t){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),0},speed:function(t){return t<=0?(cc.log("The speed parameter error"),this):(this._speedMethod=!0,this._speed*=t,this)},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||t<1?(cc.log("The repeat parameter error"),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.ActionInterval.create=cc.actionInterval,cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._actions=[];var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,r=e[0],o=1;o<i;o++)e[o]&&(n=r,r=cc.Sequence._actionOneTwo(n,e[o]));this.initWithTwoActions(r,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Sequence.initWithTwoActions(): arguments must all be non nil");var i=t._duration+e._duration;return this.initWithDuration(i),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._last=-1},stop:function(){this._last!==-1&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,r=this._split,o=this._actions,s=this._last;t=this._computeEaseTime(t),t<r?(e=0!==r?t/r:1,0===n&&1===s&&(o[1].update(0),o[1].stop())):(n=1,e=1===r?1:(t-r)/(1-r),s===-1&&(o[0].startWithTarget(this.target),o[0].update(1),o[0].stop()),s||(o[0].update(1),o[0].stop())),i=o[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;e.length>0&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i,n,r,o;e&&e.length>0;)for(n=Array.prototype.shift.call(e),o=n._timesForRepeat||1,n._repeatMethod=!1,n._timesForRepeat=1,r=0,i||(i=n,r=1),r;r<o;r++)i=cc.Sequence._actionOneTwo(i,n);return i},cc.Sequence.create=cc.sequence,cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;return!!this.initWithDuration(i)&&(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(t>=r){for(;t>r&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),r+=e._duration/i,this._nextDt=r;t>=1&&this._total<n&&this._total++,this._actionInstant||(this._total===n?(e.update(1),e.stop()):e.update(t-(r-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.Repeat.create=cc.repeat,cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.RepeatForever.initWithAction(): action must be non null");return this._innerAction=t,!0},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.RepeatForever.create=cc.repeatForever,cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._one=null,this._two=null;var e=t instanceof Array?t:arguments,i=e.length-1;if(i>=0&&null==e[i]&&cc.log("parameters should not be ending with null in Javascript"),i>=0){for(var n,r=e[0],o=1;o<i;o++)e[o]&&(n=r,r=cc.Spawn._actionOneTwo(n,e[o]));this.initWithTwoActions(r,e[i])}},initWithTwoActions:function(t,e){if(!t||!e)throw new Error("cc.Spawn.initWithTwoActions(): arguments must all be non null");var i=!1,n=t._duration,r=e._duration;return this.initWithDuration(Math.max(n,r))&&(this._one=t,this._two=e,n>r?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-r)):n<r&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(r-n))),i=!0),i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;e.length>0&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn.create=cc.spawn,cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngleX=e||0,this._dstAngleY=i||this._dstAngleX,!0)},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.rotationX%360,i=this._dstAngleX-e;i>180&&(i-=360),i<-180&&(i+=360),this._startAngleX=e,this._diffAngleX=i,this._startAngleY=t.rotationY%360;var n=this._dstAngleY-this._startAngleY;n>180&&(n-=360),n<-180&&(n+=360),this._diffAngleY=n},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*t,this.target.rotationY=this._startAngleY+this._diffAngleY*t)}}),cc.rotateTo=function(t,e,i){return new cc.RotateTo(t,e,i)},cc.RotateTo.create=cc.rotateTo,cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._angleX=e||0,this._angleY=i||this._angleX,!0)},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angleX,this._angleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngleX=t.rotationX,this._startAngleY=t.rotationY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.rotationX=this._startAngleX+this._angleX*t,this.target.rotationY=this._startAngleY+this._angleY*t)},reverse:function(){var t=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e,i){return new cc.RotateBy(t,e,i)},cc.RotateBy.create=cc.rotateBy,cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._positionDelta=cc.p(0,0),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0)},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var r=this.target.getPositionX(),o=this.target.getPositionY(),s=this._previousPosition;n.x=n.x+r-s.x,n.y=n.y+o-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveBy.create=cc.moveBy,cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(t,e,i){cc.MoveBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)&&(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.getPositionX(),this._positionDelta.y=this._endPosition.y-t.getPositionY()}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.MoveTo.create=cc.moveTo,cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewTo.create=cc.skewTo,cc.SkewBy=cc.SkewTo.extend({ctor:function(t,e,i){cc.SkewTo.prototype.ctor.call(this),void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.SkewBy.create=cc.skewBy,cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(t,e,i,n,r){cc.ActionInterval.prototype.ctor.call(this),this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),this._delta=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0===r&&(r=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=r,!0)},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,r=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var o=this.target.getPositionX(),s=this.target.getPositionY(),c=this._previousPosition;r.x=r.x+o-c.x,r.y=r.y+s-c.y,n+=r.x,i+=r.y,c.x=n,c.y=i,this.target.setPosition(n,i)}else this.target.setPosition(r.x+n,r.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,r){return new cc.JumpBy(t,e,i,n,r)},cc.JumpBy.create=cc.jumpBy,cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(t,e,i,n,r){cc.JumpBy.prototype.ctor.call(this),this._endPosition=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,r)&&(void 0===r&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,r){return new cc.JumpTo(t,e,i,n,r)},cc.JumpTo.create=cc.jumpTo,cc.bezierAt=function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._config=[],this._startPosition=cc.p(0,0),this._previousPosition=cc.p(0,0),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.p(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.getPositionX(),i=t.getPositionY();this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._config,i=0,n=e[0].x,r=e[1].x,o=e[2].x,s=0,c=e[0].y,a=e[1].y,l=e[2].y,h=cc.bezierAt(i,n,r,o,t),u=cc.bezierAt(s,c,a,l,t),d=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var _=this.target.getPositionX(),p=this.target.getPositionY(),f=this._previousPosition;d.x=d.x+_-f.x,d.y=d.y+p-f.y,h+=d.x,u+=d.y,f.x=h,f.y=u,this.target.setPosition(h,u)}else this.target.setPosition(d.x+h,d.y+u)}},reverse:function(){var t=this._config,e=[cc.pAdd(t[1],cc.pNeg(t[2])),cc.pAdd(t[0],cc.pNeg(t[2])),cc.pNeg(t[2])],i=new cc.BezierBy(this._duration,e);return this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierBy.create=cc.bezierBy,cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(t,e){cc.BezierBy.prototype.ctor.call(this),this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=cc.pSub(i[0],e),n[1]=cc.pSub(i[1],e),n[2]=cc.pSub(i[2],e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.BezierTo.create=cc.bezierTo,cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0)},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleTo.create=cc.scaleTo,cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.ScaleBy.create=cc.scaleBy,cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._times=e,!0)},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.visible=i>e/2}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.visible},stop:function(){this.target.visible=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.Blink.create=cc.blink,cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeTo.create=cc.fadeTo,cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeIn.create=cc.fadeIn,cc.FadeOut=cc.FadeTo.extend({ctor:function(t){cc.FadeTo.prototype.ctor.call(this),null==t&&(t=0),this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.FadeOut.create=cc.fadeOut,cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&this.target.setColor(cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintTo.create=cc.tintTo,cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.TintBy.create=cc.tintBy,cc.DelayTime=cc.ActionInterval.extend({update:function(t){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.DelayTime.create=cc.delayTime,cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ReverseTime.initWithAction(): action must be non null");if(t===this._other)throw new Error("cc.ReverseTime.initWithAction(): the action was already passed in.");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.ReverseTime.create=cc.reverseTime,cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,_currFrameIndex:0,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),this._splitTimes=[],t&&this.initWithAnimation(t)},getAnimation:function(){return this._animation},setAnimation:function(t){this._animation=t},getCurrentFrameIndex:function(){return this._currFrameIndex},initWithAnimation:function(t){if(!t)throw new Error("cc.Animate.initWithAnimation(): animation must be non-NULL");var e=t.getDuration();if(this.initWithDuration(e*t.getLoops())){this._nextFrame=0,this.setAnimation(t),this._origFrame=null,this._executedLoops=0;var i=this._splitTimes;i.length=0;var n=0,r=e/t.getTotalDelayUnits(),o=t.getFrames();cc.arrayVerifyType(o,cc.AnimationFrame);for(var s=0;s<o.length;s++){var c=o[s],a=n*r/e;n+=c.getDelayUnits(),i.push(a)}return!0}return!1},clone:function(){var t=new cc.Animate;return this._cloneDecoration(t),t.initWithAnimation(this._animation.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._animation.getRestoreOriginalFrame()&&(this._origFrame=t.displayFrame()),this._nextFrame=0,this._executedLoops=0},update:function(t){if(t=this._computeEaseTime(t),t<1){t*=this._animation.getLoops();var e=0|t;e>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),t%=1}for(var i=this._animation.getFrames(),n=i.length,r=this._splitTimes,o=this._nextFrame;o<n&&r[o]<=t;o++)_currFrameIndex=o,this.target.setSpriteFrame(i[_currFrameIndex].getSpriteFrame()),this._nextFrame=o+1},reverse:function(){var t=this._animation,e=t.getFrames(),i=[];if(cc.arrayVerifyType(e,cc.AnimationFrame),e.length>0)for(var n=e.length-1;n>=0;n--){var r=e[n];if(!r)break;i.push(r.clone())}var o=new cc.Animation(i,t.getDelayPerUnit(),t.getLoops());o.setRestoreOriginalFrame(t.getRestoreOriginalFrame());var s=new cc.Animate(o);return this._cloneDecoration(s),this._reverseEaseList(s),s},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame),cc.Action.prototype.stop.call(this)}}),cc.animate=function(t){return new cc.Animate(t)},cc.Animate.create=cc.animate,cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)},cc.TargetedAction.create=cc.targetedAction,cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(t){this.update(1)},update:function(t){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.ActionInstant.extend({update:function(t){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Show.create=cc.show,cc.Hide=cc.ActionInstant.extend({update:function(t){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.Hide.create=cc.hide,cc.ToggleVisibility=cc.ActionInstant.extend({update:function(t){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.ToggleVisibility.create=cc.toggleVisibility,cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),void 0!==t&&this.init(t)},update:function(t){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.RemoveSelf.create=cc.removeSelf,cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(t){this.target.flippedX=this._flippedX},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipX.create=cc.flipX,cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(t){cc.FiniteTimeAction.prototype.ctor.call(this),this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(t){this.target.flippedY=this._flippedY},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.FlipY.create=cc.flipY,cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(t,e){cc.FiniteTimeAction.prototype.ctor.call(this),this._x=0,this._y=0,void 0!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(t){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.Place.create=cc.place,cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_function:null,_data:null,ctor:function(t,e,i){cc.FiniteTimeAction.prototype.ctor.call(this),this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(t){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)},cc.CallFunc.create=cc.callFunc,cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(t){cc.ActionInterval.prototype.ctor.call(this),t&&this.initWithAction(t)},initWithAction:function(t){if(!t)throw new Error("cc.ActionEase.initWithAction(): action must be non nil");return!!this.initWithDuration(t.getDuration())&&(this._inner=t,!0)},clone:function(){var t=new cc.ActionEase;return t.initWithAction(this._inner.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop(),cc.ActionInterval.prototype.stop.call(this)},update:function(t){this._inner.update(t)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}}),cc.actionEase=function(t){return new cc.ActionEase(t)},cc.ActionEase.create=cc.actionEase,cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),void 0!==e&&this.initWithAction(t,e)},setRate:function(t){this._rate=t},getRate:function(){return this._rate},initWithAction:function(t,e){return!!cc.ActionEase.prototype.initWithAction.call(this,t)&&(this._rate=e,!0)},clone:function(){var t=new cc.EaseRateAction;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}}),cc.easeRateAction=function(t,e){return new cc.EaseRateAction(t,e)},cc.EaseRateAction.create=cc.easeRateAction,cc.EaseIn=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseIn;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.EaseIn.create=function(t,e){return new cc.EaseIn(t,e)},cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.EaseOut=cc.EaseRateAction.extend({update:function(t){this._inner.update(Math.pow(t,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var t=new cc.EaseOut;return t.initWithAction(this._inner.clone(),this._rate),t}}),cc.EaseOut.create=function(t,e){return new cc.EaseOut(t,e)},cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.EaseInOut=cc.EaseRateAction.extend({update:function(t){t*=2,t<1?this._inner.update(.5*Math.pow(t,this._rate)):this._inner.update(1-.5*Math.pow(2-t,this._rate))},clone:function(){var t=new cc.EaseInOut;return t.initWithAction(this._inner.clone(),this._rate),t},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}}),cc.EaseInOut.create=function(t,e){return new cc.EaseInOut(t,e)},cc.easeInOut=function(t){return{_rate:t,easing:function(t){return t*=2,t<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}},cc.EaseExponentialIn=cc.ActionEase.extend({update:function(t){this._inner.update(0===t?0:Math.pow(2,10*(t-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialIn.create=function(t){return new cc.EaseExponentialIn(t)},cc._easeExponentialInObj={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return cc._easeExponentialOutObj}},cc.easeExponentialIn=function(){return cc._easeExponentialInObj},cc.EaseExponentialOut=cc.ActionEase.extend({update:function(t){this._inner.update(1===t?1:-Math.pow(2,-10*t)+1)},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialOut.create=function(t){return new cc.EaseExponentialOut(t)},cc._easeExponentialOutObj={easing:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},reverse:function(){return cc._easeExponentialInObj}},cc.easeExponentialOut=function(){return cc._easeExponentialOutObj},cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(t){1!==t&&0!==t&&(t*=2,t=t<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)),this._inner.update(t)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var t=new cc.EaseExponentialInOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseExponentialInOut.create=function(t){return new cc.EaseExponentialInOut(t)},cc._easeExponentialInOutObj={easing:function(t){return 1!==t&&0!==t?(t*=2,t<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)):t},reverse:function(){return cc._easeExponentialInOutObj}},cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj},cc.EaseSineIn=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1,this._inner.update(t)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var t=new cc.EaseSineIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseSineIn.create=function(t){return new cc.EaseSineIn(t)},cc._easeSineInObj={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}},cc.easeSineIn=function(){return cc._easeSineInObj},cc.EaseSineOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:Math.sin(t*Math.PI/2),this._inner.update(t)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var t=new cc.EaseSineOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseSineOut.create=function(t){return new cc.EaseSineOut(t)},cc._easeSineOutObj={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return cc._easeSineInObj}},cc.easeSineOut=function(){return cc._easeSineOutObj},cc.EaseSineInOut=cc.ActionEase.extend({update:function(t){t=0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1),this._inner.update(t)},clone:function(){var t=new cc.EaseSineInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}}),cc.EaseSineInOut.create=function(t){return new cc.EaseSineInOut(t)},cc._easeSineInOutObj={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return cc._easeSineInOutObj}},cc.easeSineInOut=function(){return cc._easeSineInOutObj},cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(t,e){cc.ActionEase.prototype.ctor.call(this),t&&this.initWithAction(t,e)},getPeriod:function(){return this._period},setPeriod:function(t){this._period=t},initWithAction:function(t,e){return cc.ActionEase.prototype.initWithAction.call(this,t),this._period=null==e?.3:e,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var t=new cc.EaseElastic;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElastic.create=function(t,e){return new cc.EaseElastic(t,e)},cc.EaseElasticIn=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;t-=1,e=-Math.pow(2,10*t)*Math.sin((t-i)*Math.PI*2/this._period)}this._inner.update(e)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticIn;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticIn.create=function(t,e){return new cc.EaseElasticIn(t,e)},cc._easeElasticInObj={easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}},cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj},cc.EaseElasticOut=cc.EaseElastic.extend({update:function(t){var e=0;if(0===t||1===t)e=t;else{var i=this._period/4;e=Math.pow(2,-10*t)*Math.sin((t-i)*Math.PI*2/this._period)+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticOut.create=function(t,e){return new cc.EaseElasticOut(t,e)},cc._easeElasticOutObj={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}},cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj},cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;t-=1,e=t<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}this._inner.update(e)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var t=new cc.EaseElasticInOut;return t.initWithAction(this._inner.clone(),this._period),t}}),cc.EaseElasticInOut.create=function(t,e){return new cc.EaseElasticInOut(t,e)},cc.easeElasticInOut=function(t){return t=t||.3,{_period:t,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;t-=1,e=t<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}},cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?(t-=1.5/2.75,7.5625*t*t+.75):t<2.5/2.75?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},clone:function(){var t=new cc.EaseBounce;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}}),cc.EaseBounce.create=function(t){return new cc.EaseBounce(t)},cc.EaseBounceIn=cc.EaseBounce.extend({update:function(t){var e=1-this.bounceTime(1-t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBounceIn.create=function(t){return new cc.EaseBounceIn(t)},cc._bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?(t-=1.5/2.75,7.5625*t*t+.75):t<2.5/2.75?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},cc._easeBounceInObj={easing:function(t){return 1-cc._bounceTime(1-t)},reverse:function(){return cc._easeBounceOutObj}},cc.easeBounceIn=function(){return cc._easeBounceInObj},cc.EaseBounceOut=cc.EaseBounce.extend({update:function(t){var e=this.bounceTime(t);this._inner.update(e)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBounceOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBounceOut.create=function(t){return new cc.EaseBounceOut(t)},cc._easeBounceOutObj={easing:function(t){return cc._bounceTime(t)},reverse:function(){return cc._easeBounceInObj}},cc.easeBounceOut=function(){return cc._easeBounceOutObj},cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(t){var e=0;t<.5?(t*=2,e=.5*(1-this.bounceTime(1-t))):e=.5*this.bounceTime(2*t-1)+.5,this._inner.update(e)},clone:function(){var t=new cc.EaseBounceInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}}),cc.EaseBounceInOut.create=function(t){return new cc.EaseBounceInOut(t)},cc._easeBounceInOutObj={easing:function(t){var e;return t<.5?(t*=2,e=.5*(1-cc._bounceTime(1-t))):e=.5*cc._bounceTime(2*t-1)+.5,e},reverse:function(){return cc._easeBounceInOutObj}},cc.easeBounceInOut=function(){return cc._easeBounceInOutObj},cc.EaseBackIn=cc.ActionEase.extend({update:function(t){var e=1.70158;t=0===t||1===t?t:t*t*((e+1)*t-e),this._inner.update(t)},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var t=new cc.EaseBackIn;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBackIn.create=function(t){return new cc.EaseBackIn(t)},cc._easeBackInObj={easing:function(t){var e=1.70158;return 0===t||1===t?t:t*t*((e+1)*t-e)},reverse:function(){return cc._easeBackOutObj}},cc.easeBackIn=function(){return cc._easeBackInObj},cc.EaseBackOut=cc.ActionEase.extend({update:function(t){var e=1.70158;t-=1,this._inner.update(t*t*((e+1)*t+e)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var t=new cc.EaseBackOut;return t.initWithAction(this._inner.clone()),t}}),cc.EaseBackOut.create=function(t){return new cc.EaseBackOut(t)},cc._easeBackOutObj={easing:function(t){var e=1.70158;return t-=1,t*t*((e+1)*t+e)+1},reverse:function(){return cc._easeBackInObj}},cc.easeBackOut=function(){return cc._easeBackOutObj},cc.EaseBackInOut=cc.ActionEase.extend({update:function(t){var e=2.5949095;t*=2,t<1?this._inner.update(t*t*((e+1)*t-e)/2):(t-=2,this._inner.update(t*t*((e+1)*t+e)/2+1))},clone:function(){var t=new cc.EaseBackInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}}),cc.EaseBackInOut.create=function(t){return new cc.EaseBackInOut(t)},cc._easeBackInOutObj={easing:function(t){var e=2.5949095;return t*=2,t<1?t*t*((e+1)*t-e)/2:(t-=2,t*t*((e+1)*t+e)/2+1)},reverse:function(){return cc._easeBackInOutObj}};cc.easeBackInOut=function(){return cc._easeBackInOutObj};cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(t){cc.ActionEase.prototype.ctor.call(this,t)},_updateTime:function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},update:function(t){var e=this._updateTime(this._p0,this._p1,this._p2,this._p3,t);this._inner.update(e)},clone:function(){var t=new cc.EaseBezierAction;return t.initWithAction(this._inner.clone()),t.setBezierParamer(this._p0,this._p1,this._p2,this._p3),t},reverse:function(){var t=new cc.EaseBezierAction(this._inner.reverse());return t.setBezierParamer(this._p3,this._p2,this._p1,this._p0),t},setBezierParamer:function(t,e,i,n){this._p0=t||0,this._p1=e||0,this._p2=i||0,this._p3=n||0}}),cc.EaseBezierAction.create=function(t){return new cc.EaseBezierAction(t)},cc.easeBezierAction=function(t,e,i,n){return{easing:function(r){return cc.EaseBezierAction.prototype._updateTime(t,e,i,n,r)},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}},cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(t){return Math.pow(t,2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}}),cc.EaseQuadraticActionIn.create=function(t){return new cc.EaseQuadraticActionIn(t)},cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}},cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn},cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(t){return-t*(t-2)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionOut;return t.initWithAction(),t},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}}),cc.EaseQuadraticActionOut.create=function(t){return new cc.EaseQuadraticActionOut(t)},cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}},cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut},cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(t){var e=t;return t*=2,t<1?e=t*t*.5:(--t,e=-.5*(t*(t-2)-1)),e},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuadraticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}}),cc.EaseQuadraticActionInOut.create=function(t){return new cc.EaseQuadraticActionInOut(t)},cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}},cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut},cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}}),cc.EaseQuarticActionIn.create=function(t){return new cc.EaseQuarticActionIn(t)},cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}},cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn},cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,-(t*t*t*t-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}}),cc.EaseQuarticActionOut.create=function(t){return new cc.EaseQuarticActionOut(t)},cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}},cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut},cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?.5*t*t*t*t:(t-=2,-.5*(t*t*t*t-2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuarticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}}),cc.EaseQuarticActionInOut.create=function(t){return new cc.EaseQuarticActionInOut(t)},cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}},cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut},cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}}),cc.EaseQuinticActionIn.create=function(t){return new cc.EaseQuinticActionIn(t)},cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}},cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn},cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}}),cc.EaseQuinticActionOut.create=function(t){return new cc.EaseQuinticActionOut(t)},cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}},cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut},cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?.5*t*t*t*t*t:(t-=2,.5*(t*t*t*t*t+2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseQuinticActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}}),cc.EaseQuinticActionInOut.create=function(t){return new cc.EaseQuinticActionInOut(t)},cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}},cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut},cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(t){return-1*(Math.sqrt(1-t*t)-1)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}}),cc.EaseCircleActionIn.create=function(t){return new cc.EaseCircleActionIn(t)},cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}},cc.easeCircleActionIn=function(){return cc._easeCircleActionIn},cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,Math.sqrt(1-t*t)},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}}),cc.EaseCircleActionOut.create=function(t){return new cc.EaseCircleActionOut(t)},cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}},cc.easeCircleActionOut=function(){return cc._easeCircleActionOut},cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCircleActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}}),cc.EaseCircleActionInOut.create=function(t){return new cc.EaseCircleActionInOut(t)},cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}},cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut},cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(t){return t*t*t},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionIn;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}}),cc.EaseCubicActionIn.create=function(t){return new cc.EaseCubicActionIn(t)},cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}},cc.easeCubicActionIn=function(){return cc._easeCubicActionIn},cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(t){return t-=1,t*t*t+1},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}}),cc.EaseCubicActionOut.create=function(t){return new cc.EaseCubicActionOut(t)},cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}},cc.easeCubicActionOut=function(){return cc._easeCubicActionOut},cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(t){return t*=2,t<1?.5*t*t*t:(t-=2,.5*(t*t*t+2))},update:function(t){this._inner.update(this._updateTime(t))},clone:function(){var t=new cc.EaseCubicActionInOut;return t.initWithAction(this._inner.clone()),t},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}}),cc.EaseCubicActionInOut.create=function(t){return new cc.EaseCubicActionInOut(t)},cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}},cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut},cc.cardinalSplineAt=function(t,e,i,n,r,o){var s=o*o,c=s*o,a=(1-r)/2,l=a*(-c+2*s-o),h=a*(-c+s)+(2*c-3*s+1),u=a*(c-2*s+o)+(-2*c+3*s),d=a*(c-s),_=t.x*l+e.x*h+i.x*u+n.x*d,p=t.y*l+e.y*h+i.y*u+n.y*d;return cc.p(_,p)},cc.reverseControlPoints=function(t){for(var e=[],i=t.length-1;i>=0;i--)e.push(cc.p(t[i].x,t[i].y));return e},cc.cloneControlPoints=function(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.p(t[i].x,t[i].y));return e},cc.copyControlPoints=cc.cloneControlPoints,cc.getControlPointAt=function(t,e){var i=Math.min(t.length-1,Math.max(e,0));return t[i]},cc.reverseControlPointsInline=function(t){for(var e=t.length,i=0|e/2,n=0;n<i;++n){var r=t[n];t[n]=t[e-n-1],t[e-n-1]=r}},cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._points=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){if(!e||0===e.length)throw new Error("Invalid configuration. It must at least have one control point");return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.setPoints(e),this._tension=i,!0)},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY()),this._accumulatedDiff=cc.p(0,0)},update:function(t){t=this._computeEaseTime(t);var e,i,n=this._points;if(1===t)e=n.length-1,i=1;else{var r=this._deltaT;e=0|t/r,i=(t-r*e)/r}var o=cc.cardinalSplineAt(cc.getControlPointAt(n,e-1),cc.getControlPointAt(n,e-0),cc.getControlPointAt(n,e+1),cc.getControlPointAt(n,e+2),this._tension,i);if(cc.ENABLE_STACKABLE_ACTIONS){var s,c;if(s=this.target.getPositionX()-this._previousPosition.x,c=this.target.getPositionY()-this._previousPosition.y,0!==s||0!==c){var a=this._accumulatedDiff;s=a.x+s,c=a.y+c,a.x=s,a.y=c,o.x+=s,o.y+=c}}this.updatePosition(o)},reverse:function(){var t=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineTo.create=cc.cardinalSplineTo,cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(t,e,i){cc.CardinalSplineTo.prototype.ctor.call(this),this._startPosition=cc.p(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.getPositionX(),this._startPosition.y=t.getPositionY()},reverse:function(){for(var t,e=this._points.slice(),i=e[0],n=1;n<e.length;++n)t=e[n],e[n]=cc.pSub(t,i),i=t;var r=cc.reverseControlPoints(e);i=r[r.length-1],r.pop(),i.x=-i.x,i.y=-i.y,r.unshift(i);for(var n=1;n<r.length;++n)t=r[n],t.x=-t.x,t.y=-t.y,t.x+=i.x,t.y+=i.y,r[n]=t,i=t;return cc.cardinalSplineBy(this._duration,r,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CardinalSplineBy.create=cc.cardinalSplineBy,cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomTo.create=cc.catmullRomTo,cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(t,e){cc.CardinalSplineBy.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,cc.copyControlPoints(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)},cc.CatmullRomBy.create=cc.catmullRomBy,cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(t,e){}}),cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(t,e,i,n){cc.ActionInterval.prototype.ctor.call(this),this.key="",void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.key=e,this.to=n,this.from=i,!0)},startWithTarget:function(t){if(!t||!t.updateTweenAction)throw new Error("cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function");cc.ActionInterval.prototype.startWithTarget.call(this,t),this.delta=this.to-this.from},update:function(t){this.target.updateTweenAction(this.to-this.delta*(1-t),this.key)},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var t=new cc.ActionTween;return t.initWithDuration(this._duration,this.key,this.from,this.to),t}}),cc.actionTween=function(t,e,i,n){return new cc.ActionTween(t,e,i,n)},cc.ActionTween.create=cc.actionTween;!function(){var t=!1,e=cc.sys,i=e.browserVersion,n=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),r={ONLY_ONE:!1,WEB_AUDIO:n,DELAY_CREATE_CTX:!1,ONE_SOURCE:!1};e.browserType===e.BROWSER_TYPE_FIREFOX&&(r.DELAY_CREATE_CTX=!0,r.USE_LOADER_EVENT="canplay"),e.os===e.OS_IOS&&(r.USE_LOADER_EVENT="loadedmetadata"),e.os===e.OS_ANDROID&&e.browserType===e.BROWSER_TYPE_UC&&(r.ONE_SOURCE=!0),window.__audioSupport=r,t&&setTimeout(function(){cc.log("browse type: "+e.browserType),cc.log("browse version: "+i),cc.log("MULTI_CHANNEL: "+window.__audioSupport.MULTI_CHANNEL),cc.log("WEB_AUDIO: "+window.__audioSupport.WEB_AUDIO),cc.log("AUTOPLAY: "+window.__audioSupport.AUTOPLAY)},0)}(),cc.Audio=cc.Class.extend({src:null,_element:null,_AUDIO_TYPE:"AUDIO",ctor:function(t){this.src=t},setBuffer:function(t){this._AUDIO_TYPE="WEBAUDIO",this._element=new cc.Audio.WebAudio(t)},setElement:function(t){this._AUDIO_TYPE="AUDIO",this._element=t,t.addEventListener("ended",function(){t.loop||(t.paused=!0)})},play:function(t,e){this._element&&(this._element.loop=e,this._element.play(),"AUDIO"===this._AUDIO_TYPE&&this._element.paused&&(this.stop(),cc.Audio.touchPlayList.push({loop:e,offset:t,audio:this._element})),cc.Audio.bindTouch===!1&&(cc.Audio.bindTouch=!0,cc.game.canvas.addEventListener("touchstart",cc.Audio.touchStart)))},getPlaying:function(){return!this._element||!this._element.paused},stop:function(){if(this._element){this._element.pause();try{this._element.currentTime=0}catch(t){}}},pause:function(){this._element&&this._element.pause()},resume:function(){this._element&&this._element.play()},setVolume:function(t){this._element&&(this._element.volume=t)},getVolume:function(){if(this._element)return this._element.volume},cloneNode:function(){var t=new cc.Audio(this.src);if("AUDIO"===this._AUDIO_TYPE){for(var e=document.createElement("audio"),i=e.getElementsByTagName("source"),n=0;n<i.length;n++)e.appendChild(i[n]);e.src=this.src,t.setElement(e)}else t.setBuffer(this._element.buffer);return t}}),cc.Audio.touchPlayList=[],cc.Audio.bindTouch=!1,cc.Audio.touchStart=function(){for(var t=cc.Audio.touchPlayList,e=null;e=t.pop();)e.audio.loop=!!e.loop,e.audio.play(e.offset)},cc.Audio.WebAudio=function(t){this.buffer=t,this.context=cc.Audio._context;var e=this.context.createGain();e.gain.value=1,e.connect(this.context.destination),this._volume=e,this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currextTimer=null},cc.Audio.WebAudio.prototype={constructor:cc.Audio.WebAudio,get paused(){return(!this._currentSource||!this._currentSource.loop)&&(this._startTime===-1||this.context.currentTime-this._startTime>this.buffer.duration)},set paused(t){},get loop(){return this._loop},set loop(t){return this._loop=t},get volume(){return this._volume.gain.value},set volume(t){return this._volume.gain.value=t},get currentTime(){return this.playedLength},set currentTime(t){return this.playedLength=t},play:function(t){this._currentSource&&!this.paused&&(this._currentSource.stop(0),this.playedLength=0);var e=this.context.createBufferSource();e.buffer=this.buffer,e.connect(this._volume),e.loop=this._loop,this._startTime=this.context.currentTime,t=t||this.playedLength;var i=this.buffer.duration;if(this._loop?e.start?e.start(0):e.notoGrainOn?e.noteGrainOn(0):e.noteOn(0):e.start?e.start(0,t,i-t):e.notoGrainOn?e.noteGrainOn(0,t,i-t):e.noteOn(0,t,i-t),this._currentSource=e,0===this.context.currentTime){var n=this;clearTimeout(this._currextTimer),this._currextTimer=setTimeout(function(){0===n.context.currentTime&&cc.Audio.touchPlayList.push({offset:t,audio:n})},10)}},pause:function(){this.playedLength=this.context.currentTime-this._startTime,this.playedLength%=this.buffer.duration;var t=this._currentSource;this._currentSource=null,this._startTime=-1,t&&t.stop(0)}},function(t){var e=t.WEB_AUDIO,i=t.ONLY_ONE,n=[];!function(){var t=document.createElement("audio");if(t.canPlayType){var e=t.canPlayType('audio/ogg; codecs="vorbis"');e&&""!==e&&n.push(".ogg");var i=t.canPlayType("audio/mpeg");i&&""!==i&&n.push(".mp3");var r=t.canPlayType('audio/wav; codecs="1"');r&&""!==r&&n.push(".wav");var o=t.canPlayType("audio/mp4");o&&""!==o&&n.push(".mp4");var s=t.canPlayType("audio/x-m4a");s&&""!==s&&n.push(".m4a")}}();try{if(e){var r=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);cc.Audio._context=r,t.DELAY_CREATE_CTX&&setTimeout(function(){r=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),cc.Audio._context=r},0)}}catch(t){e=!1,cc.log("browser don't support web audio")}var o={cache:{},useWebAudio:!1,loadBuffer:function(t,i){if(e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){r.decodeAudioData(n.response,function(t){i(null,t)},function(){i("decode error - "+t)})},n.onerror=function(){i("request error - "+t)},n.send()}},load:function(t,e,i,r){if(0===n.length)return r("can not support audio!");var o=cc.loader.getRes(e);if(o)return r(null,o);var s;cc.loader.audioPath&&(t=cc.path.join(cc.loader.audioPath,t));var c=cc.path.extname(t),a=[c];for(s=0;s<n.length;s++)c!==n[s]&&a.push(n[s]);return o=new cc.Audio(t),cc.loader.cache[e]=o,this.loadAudioFromExtList(t,a,o,r),o},loadAudioFromExtList:function(i,r,o,s){if(0===r.length){var c="can not found the resource of audio! Last match url is : ";return c+=i.replace(/\.(.*)?$/,"("),n.forEach(function(t){c+=t+"|"}),c=c.replace(/\|$/,")"),s({status:520,errorMessage:c},null)}if(e&&this.useWebAudio)return void this.loadBuffer(i,function(t,e){t&&cc.log(t),e&&o.setBuffer(e),s(null,o)});for(var a=t.ONE_SOURCE?1:r.length,l=document.createElement("audio"),h=0;h<a;h++){var u=document.createElement("source");u.src=cc.path.changeExtname(i,r[h]),l.appendChild(u)}o.setElement(l);var d=setTimeout(function(){0===l.readyState?p():_()},8e3),_=function(){l.removeEventListener("canplaythrough",_,!1),l.removeEventListener("error",p,!1),l.removeEventListener("emptied",_,!1),t.USE_LOADER_EVENT&&l.removeEventListener(t.USE_LOADER_EVENT,_,!1),clearTimeout(d),s(null,o)},p=function(){cc.log("load audio failure - "+i),_()};l.addEventListener("canplaythrough",_,!1),l.addEventListener("error",p,!1),t.USE_LOADER_EVENT&&l.addEventListener(t.USE_LOADER_EVENT,_,!1)}};cc.loader.register(["mp3","ogg","wav","mp4","m4a"],o),cc.audioEngine={_currMusic:null,_musicVolume:1,features:t,willPlayMusic:function(){return!1},playMusic:function(t,e){var i=this._currMusic;i&&i.getPlaying()&&i.stop();var n=cc.loader.getRes(t);n||(cc.loader.load(t),n=cc.loader.getRes(t)),n.setVolume(this._musicVolume),n.play(0,e||!1),this._currMusic=n},stopMusic:function(t){var e=this._currMusic;e&&(e.stop(),this._currMusic=null,t&&cc.loader.release(e.src))},pauseMusic:function(){var t=this._currMusic;t&&t.pause()},resumeMusic:function(){var t=this._currMusic;t&&t.resume()},rewindMusic:function(){var t=this._currMusic;t&&(t.stop(),t.play())},getMusicVolume:function(){return this._musicVolume},setMusicVolume:function(t){t-=0,isNaN(t)&&(t=1),t>1&&(t=1),t<0&&(t=0),this._musicVolume=t;var e=this._currMusic;e&&e.setVolume(t)},isMusicPlaying:function(){var t=this._currMusic;return!!t&&t.getPlaying()},_audioPool:{},_maxAudioInstance:10,_effectVolume:1,playEffect:function(t,n){if(i&&this._currMusic&&this._currMusic.getPlaying())return cc.log("Browser is only allowed to play one audio"),null;var r=this._audioPool[t];r||(r=this._audioPool[t]=[]);var s;for(s=0;s<r.length&&r[s].getPlaying();s++);if(!e&&s>this._maxAudioInstance){var c=r.shift();c.stop(),r.push(c),s=r.length-1}var a;if(r[s])return a=r[s],a.setVolume(this._effectVolume),a.play(0,n||!1),a;if(a=cc.loader.getRes(t),a&&e&&"AUDIO"===a._AUDIO_TYPE&&(cc.loader.release(t),a=null),a){if(!e||"AUDIO"!==a._AUDIO_TYPE)return a=a.cloneNode(),a.setVolume(this._effectVolume),a.play(0,n||!1),r.push(a),a;o.loadBuffer(t,function(t,e){a.setBuffer(e),a.setVolume(cc.audioEngine._effectVolume),a.getPlaying()||a.play(0,n||!1)})}return o.useWebAudio=!0,cc.loader.load(t,function(e){e=cc.loader.getRes(t),e=e.cloneNode(),e.setVolume(cc.audioEngine._effectVolume),e.play(0,n||!1),r.push(e)}),o.useWebAudio=!1,a},setEffectsVolume:function(t){t-=0,isNaN(t)&&(t=1),t>1&&(t=1),t<0&&(t=0),this._effectVolume=t;var e=this._audioPool;for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r].setVolume(t)}},getEffectsVolume:function(){return this._effectVolume},pauseEffect:function(t){t&&t.pause()},pauseAllEffects:function(){var t=this._audioPool;for(var e in t)for(var i=t[e],n=0;n<t[e].length;n++)i[n].getPlaying()&&i[n].pause()},resumeEffect:function(t){t&&t.resume()},resumeAllEffects:function(){var t=this._audioPool;for(var e in t)for(var i=t[e],n=0;n<t[e].length;n++)i[n].resume()},stopEffect:function(t){t&&t.stop()},stopAllEffects:function(){var t=this._audioPool;for(var e in t){for(var i=t[e],n=0;n<i.length;n++)i[n].stop();i.length=0}},unloadEffect:function(t){if(t){cc.loader.release(t);var e=this._audioPool[t];e&&(e.length=0),delete this._audioPool[t]}},end:function(){this.stopMusic(),this.stopAllEffects()},_pauseCache:[],_pausePlaying:function(){var t=this._currMusic;t&&t.getPlaying()&&(t.pause(),this._pauseCache.push(t));var e=this._audioPool;for(var i in e)for(var n=e[i],r=0;r<e[i].length;r++)n[r].getPlaying()&&(n[r].pause(),this._pauseCache.push(n[r]))},_resumePlaying:function(){for(var t=this._pauseCache,e=0;e<t.length;e++)t[e].resume();t.length=0}}}(window.__audioSupport);cc._globalFontSize=cc.ITEM_SIZE,cc._globalFontName="Arial",cc._globalFontNameRelease=!1,cc.MenuItem=cc.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(t,e){var i=cc.Node.prototype;i.ctor.call(this),this._target=null,this._callback=null,this._isSelected=!1,this._enabled=!1,i.setAnchorPoint.call(this,.5,.5),this._target=e||null,this._callback=t||null,this._callback&&(this._enabled=!0)},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},setTarget:function(t,e){this._target=e,this._callback=t},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t},initWithCallback:function(t,e){return this.anchorX=.5,this.anchorY=.5,this._target=e,this._callback=t,this._enabled=!0,this._isSelected=!1,!0},rect:function(){var t=this._position,e=this._contentSize,i=this._anchorPoint;return cc.rect(t.x-e.width*i.x,t.y-e.height*i.y,e.width,e.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(t,e){this._target=e,this._callback=t},activate:function(){if(this._enabled){var t=this._target,e=this._callback;if(!e)return;t&&cc.isString(e)?t[e](this):t&&cc.isFunction(e)?e.call(t,this):e(this)}}});var _p=cc.MenuItem.prototype;_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),cc.MenuItem.create=function(t,e){return new cc.MenuItem(t,e)},cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(t,e,i){cc.MenuItem.prototype.ctor.call(this,e,i),this._disabledColor=null,this._label=null,this._colorBackup=null,t&&(this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(t),t.textureLoaded&&!t.textureLoaded()&&t.addEventListener("load",function(t){this.width=t.width,this.height=t.height,this.parent instanceof cc.Menu&&this.parent.updateAlign()},this),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0))},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(t){this._disabledColor=t},getLabel:function(){return this._label},setLabel:function(t){t&&(this.addChild(t),t.anchorX=0,t.anchorY=0,this.width=t.width,this.height=t.height,t.setCascadeColorEnabled(!0)),this._label&&this.removeChild(this._label,!0),this._label=t},setEnabled:function(t){this._enabled!==t&&(t?this.setColor(this._colorBackup):(this._colorBackup=this.color,this.setColor(this._disabledColor))),cc.MenuItem.prototype.setEnabled.call(this,t)},initWithLabel:function(t,e,i){return this.initWithCallback(e,i),this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(t),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},setString:function(t){this._label.string=t,this.width=this._label.width,this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,cc.MenuItem.prototype.activate.call(this))},selected:function(){if(this._enabled){cc.MenuItem.prototype.selected.call(this);var t=this.getActionByTag(cc.ZOOM_ACTION_TAG);t?this.stopAction(t):this._originalScale=this.scale;var e=cc.scaleTo(.1,1.2*this._originalScale);e.setTag(cc.ZOOM_ACTION_TAG),this.runAction(e)}},unselected:function(){if(this._enabled){cc.MenuItem.prototype.unselected.call(this),this.stopActionByTag(cc.ZOOM_ACTION_TAG);var t=cc.scaleTo(.1,this._originalScale);t.setTag(cc.ZOOM_ACTION_TAG),this.runAction(t)}}});var _p=cc.MenuItemLabel.prototype;_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.disabledColor,cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor),_p.label,cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel),cc.MenuItemLabel.create=function(t,e,i){return new cc.MenuItemLabel(t,e,i)},cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(t,e,i,n,r,o,s){var c;t&&t.length>0&&(c=new cc.LabelAtlas(t,e,i,n,r)),cc.MenuItemLabel.prototype.ctor.call(this,c,o,s)},initWithString:function(t,e,i,n,r,o,s){if(!t||0===t.length)throw new Error("cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0");var c=new cc.LabelAtlas;return c.initWithString(t,e,i,n,r),this.initWithLabel(c,o,s),!0}}),cc.MenuItemAtlasFont.create=function(t,e,i,n,r,o,s){return new cc.MenuItemAtlasFont(t,e,i,n,r,o,s)},cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(t,e,i){var n;t&&t.length>0?(this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,n=new cc.LabelTTF(t,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName=""),cc.MenuItemLabel.prototype.ctor.call(this,n,e,i)},initWithString:function(t,e,i){if(!t||0===t.length)throw new Error("Value should be non-null and its length should be greater than 0");this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize;var n=new cc.LabelTTF(t,this._fontName,this._fontSize);return this.initWithLabel(n,e,i),!0},setFontSize:function(t){this._fontSize=t,this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(t){this._fontName=t,this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var t=new cc.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(t)}}),cc.MenuItemFont.setFontSize=function(t){cc._globalFontSize=t},cc.MenuItemFont.fontSize=function(){return cc._globalFontSize},cc.MenuItemFont.setFontName=function(t){cc._globalFontNameRelease&&(cc._globalFontName=""),cc._globalFontName=t,cc._globalFontNameRelease=!0};var _p=cc.MenuItemFont.prototype;_p.fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),cc.MenuItemFont.fontName=function(){return cc._globalFontName},cc.MenuItemFont.create=function(t,e,i){return new cc.MenuItemFont(t,e,i)},cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(t,e,i,n,r){if(cc.MenuItem.prototype.ctor.call(this),this._normalImage=null,this._selectedImage=null,this._disabledImage=null,this._loader=new cc.Sprite.LoadManager,void 0!==t){e=e||null;var o,s,c;return void 0!==r?(o=i,c=n,s=r):void 0!==n&&cc.isFunction(n)?(o=i,c=n):void 0!==n&&cc.isFunction(i)?(s=n,c=i,o=null):void 0===i&&(o=null),this._loader.clear(),t.textureLoaded&&!t.textureLoaded()?(this._loader.once(t,function(){this.initWithNormalSprite(t,e,o,c,s)},this),!1):(this.initWithNormalSprite(t,e,o,c,s),!0)}},getNormalImage:function(){return this._normalImage},setNormalImage:function(t){this._normalImage!==t&&(t&&(this.addChild(t,0,cc.NORMAL_TAG),t.anchorX=0,t.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=t,this._normalImage&&(this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),t.textureLoaded&&!t.textureLoaded()&&t.addEventListener("load",function(t){this.width=t.width,this.height=t.height,this.parent instanceof cc.Menu&&this.parent.updateAlign()},this)))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(t){this._selectedImage!==t&&(t&&(this.addChild(t,0,cc.SELECTED_TAG),t.anchorX=0,t.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=t,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(t){this._disabledImage!==t&&(t&&(this.addChild(t,0,cc.DISABLE_TAG),t.anchorX=0,t.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=t,this._updateImagesVisibility())},initWithNormalSprite:function(t,e,i,n,r){if(this._loader.clear(),t.textureLoaded&&!t.textureLoaded())return this._loader.once(t,function(){this.initWithNormalSprite(t,e,i,n,r)},this),!1;this.initWithCallback(n,r),this.setNormalImage(t),this.setSelectedImage(e),this.setDisabledImage(i);var o=this._normalImage;return o&&(this.width=o.width,this.height=o.height),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},selected:function(){cc.MenuItem.prototype.selected.call(this),this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=!0):this._normalImage.visible=!0)},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage&&(this._disabledImage.visible=!1))},setEnabled:function(t){this._enabled!==t&&(cc.MenuItem.prototype.setEnabled.call(this,t),this._updateImagesVisibility())},_updateImagesVisibility:function(){var t=this._normalImage,e=this._selectedImage,i=this._disabledImage;this._enabled?(t&&(t.visible=!0),e&&(e.visible=!1),i&&(i.visible=!1)):i?(t&&(t.visible=!1),e&&(e.visible=!1),i&&(i.visible=!0)):(t&&(t.visible=!0),e&&(e.visible=!1))}});var _p=cc.MenuItemSprite.prototype;_p.normalImage,cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage),_p.selectedImage,cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage),_p.disabledImage,cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage),cc.MenuItemSprite.create=function(t,e,i,n,r){return new cc.MenuItemSprite(t,e,i,n,r||void 0)},cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(t,e,i,n,r){var o=null,s=null,c=null,a=null,l=null;void 0===t||null===t?cc.MenuItemSprite.prototype.ctor.call(this):(o=new cc.Sprite(t),e&&(s=new cc.Sprite(e)),void 0===n?a=i:void 0===r?(a=i,l=n):r&&(c=new cc.Sprite(i),a=n,l=r),cc.MenuItemSprite.prototype.ctor.call(this,o,s,c,a,l))},setNormalSpriteFrame:function(t){this.setNormalImage(new cc.Sprite(t))},setSelectedSpriteFrame:function(t){this.setSelectedImage(new cc.Sprite(t))},setDisabledSpriteFrame:function(t){this.setDisabledImage(new cc.Sprite(t))},initWithNormalImage:function(t,e,i,n,r){var o=null,s=null,c=null;return t&&(o=new cc.Sprite(t)),e&&(s=new cc.Sprite(e)),i&&(c=new cc.Sprite(i)),this.initWithNormalSprite(o,s,c,n,r)}}),cc.MenuItemImage.create=function(t,e,i,n,r){return new cc.MenuItemImage(t,e,i,n,r)},cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this),this._selectedIndex=0,this.subItems=[],this._opacity=0,this._color=cc.color.WHITE,arguments.length>0&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(t){if(this._opacity=t,this.subItems&&this.subItems.length>0)for(var e=0;e<this.subItems.length;e++)this.subItems[e].opacity=t;this._color.a=t},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},setColor:function(t){var e=this._color;if(e.r=t.r,e.g=t.g,e.b=t.b,this.subItems&&this.subItems.length>0)for(var i=0;i<this.subItems.length;i++)this.subItems[i].setColor(t);void 0===t.a||t.a_undefined||this.setOpacity(t.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(t){if(t!==this._selectedIndex){this._selectedIndex=t;var e=this.getChildByTag(cc.CURRENT_ITEM);e&&e.removeFromParent(!1);var i=this.subItems[this._selectedIndex];this.addChild(i,0,cc.CURRENT_ITEM);var n=i.width,r=i.height;this.width=n,this.height=r,i.setPosition(n/2,r/2)}},getSubItems:function(){return this.subItems},setSubItems:function(t){this.subItems=t},initWithItems:function(t){var e=t.length;cc.isFunction(t[t.length-2])?(this.initWithCallback(t[t.length-2],t[t.length-1]),e-=2):cc.isFunction(t[t.length-1])?(this.initWithCallback(t[t.length-1],null),e-=1):this.initWithCallback(null,null);var i=this.subItems;i.length=0;for(var n=0;n<e;n++)t[n]&&i.push(t[n]);return this._selectedIndex=cc.UINT_MAX,this.setSelectedIndex(0),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),!0},addSubItem:function(t){this.subItems.push(t)},activate:function(){if(this._enabled){var t=(this._selectedIndex+1)%this.subItems.length;this.setSelectedIndex(t)}cc.MenuItem.prototype.activate.call(this)},selected:function(){cc.MenuItem.prototype.selected.call(this),this.subItems[this._selectedIndex].selected()},unselected:function(){cc.MenuItem.prototype.unselected.call(this),this.subItems[this._selectedIndex].unselected()},setEnabled:function(t){if(this._enabled!==t){cc.MenuItem.prototype.setEnabled.call(this,t);var e=this.subItems;if(e&&e.length>0)for(var i=0;i<e.length;i++)e[i].enabled=t}},selectedItem:function(){return this.subItems[this._selectedIndex]},getSelectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.setSelectedIndex(this._selectedIndex)}});var _p=cc.MenuItemToggle.prototype;_p.selectedIndex,cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex),cc.MenuItemToggle.create=function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var t=new cc.MenuItemToggle;return t.initWithItems(Array.prototype.slice.apply(arguments)),t},cc.MENU_STATE_WAITING=0,cc.MENU_STATE_TRACKING_TOUCH=1,cc.MENU_HANDLER_PRIORITY=-128,cc.DEFAULT_PADDING=5,cc.Menu=cc.Layer.extend({enabled:!1,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(t){cc.Layer.prototype.ctor.call(this),this._color=cc.color.WHITE,this.enabled=!1,this._opacity=255,this._selectedItem=null,this._state=-1,this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled}),arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var e,i=arguments.length;if(0===i)e=[];else if(1===i)e=t instanceof Array?t:[t];else if(i>1){e=[];for(var n=0;n<i;n++)arguments[n]&&e.push(arguments[n])}this.initWithArray(e)},onEnter:function(){var t=this._touchListener;t._isRegistered()||cc.eventManager.addListener(t,this),cc.Node.prototype.onEnter.call(this)},isEnabled:function(){return this.enabled},setEnabled:function(t){this.enabled=t},initWithItems:function(t){var e=[];if(t)for(var i=0;i<t.length;i++)t[i]&&e.push(t[i]);return this.initWithArray(e)},initWithArray:function(t){if(cc.Layer.prototype.init.call(this)){this.enabled=!0;var e=cc.winSize;if(this.setPosition(e.width/2,e.height/2),this.setContentSize(e),this.setAnchorPoint(.5,.5),this.ignoreAnchorPointForPosition(!0),t)for(var i=0;i<t.length;i++)this.addChild(t[i],i);return this._selectedItem=null,this._state=cc.MENU_STATE_WAITING,this.cascadeColor=!0,this.cascadeOpacity=!0,!0}return!1},addChild:function(t,e,i){if(!(t instanceof cc.MenuItem))throw new Error("cc.Menu.addChild() : Menu only supports MenuItem objects as children");cc.Layer.prototype.addChild.call(this,t,e,i)},updateAlign:function(){switch(this._align){case"vertically":this.alignItemsVertically();break;case"horizontally":this.alignItemsHorizontally()}},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(t){this._align="vertically";var e,i,n,r,o,s=-t,c=this._children;if(c&&c.length>0){for(i=0,e=c.length;i<e;i++)s+=c[i].height*c[i].scaleY+t;var a=s/2;for(i=0,e=c.length;i<e;i++)o=c[i],r=o.height,n=o.scaleY,o.setPosition(0,a-r*n/2),a-=r*n+t}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(t){this._align="horizontally";var e,i,n,r,o,s=-t,c=this._children;if(c&&c.length>0){for(e=0,i=c.length;e<i;e++)s+=c[e].width*c[e].scaleX+t;var a=-s/2;for(e=0,i=c.length;e<i;e++)o=c[e],n=o.scaleX,r=c[e].width,o.setPosition(a+r*n/2,0),a+=r*n+t}},alignItemsInColumns:function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var i,n,r,o=-5,s=0,c=0,a=0,l=this._children;if(l&&l.length>0)for(e=0,r=l.length;e<r;e++)s>=t.length||(i=t[s],i&&(n=l[e].height,c=c>=n||isNaN(n)?c:n,++a,a>=i&&(o+=c+5,a=0,c=0,++s)));var h=cc.director.getWinSize();s=0,c=0,i=0;var u=0,d=0,_=o/2;if(l&&l.length>0)for(e=0,r=l.length;e<r;e++){var p=l[e];0===i&&(i=t[s],u=h.width/(1+i),d=u),n=p._getHeight(),c=c>=n||isNaN(n)?c:n,p.setPosition(d-h.width/2,_-n/2),d+=u,++a,a>=i&&(_-=c+5,a=0,i=0,c=0,++s)}},alignItemsInRows:function(){arguments.length>0&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var t,e=[];for(t=0;t<arguments.length;t++)e.push(arguments[t]);var i,n,r,o,s=[],c=[],a=-10,l=-5,h=0,u=0,d=0,_=this._children;if(_&&_.length>0)for(t=0,r=_.length;t<r;t++)n=_[t],h>=e.length||(i=e[h],i&&(o=n.width,u=u>=o||isNaN(o)?u:o,l+=n.height+5,++d,d>=i&&(s.push(u),c.push(l),a+=u+10,d=0,u=0,l=-5,++h)));var p=cc.director.getWinSize();h=0,u=0,i=0;var f=-a/2,m=0;if(_&&_.length>0)for(t=0,r=_.length;t<r;t++)n=_[t],0===i&&(i=e[h],m=c[h]),o=n._getWidth(),u=u>=o||isNaN(o)?u:o,n.setPosition(f+s[h]/2,m-p.height/2),m-=n.height+10,++d,d>=i&&(f+=u+5,d=0,i=0,u=0,++h)},removeChild:function(t,e){if(null!=t){if(!(t instanceof cc.MenuItem))return void cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children");this._selectedItem===t&&(this._selectedItem=null),cc.Node.prototype.removeChild.call(this,t,e)}},_onTouchBegan:function(t,e){var i=e.getCurrentTarget();if(i._state!==cc.MENU_STATE_WAITING||!i._visible||!i.enabled)return!1;for(var n=i.parent;null!=n;n=n.parent)if(!n.isVisible())return!1;return i._selectedItem=i._itemForTouch(t),!!i._selectedItem&&(i._state=cc.MENU_STATE_TRACKING_TOUCH,i._selectedItem.selected(),i._selectedItem.setNodeDirty(),!0)},_onTouchEnded:function(t,e){var i=e.getCurrentTarget();return i._state!==cc.MENU_STATE_TRACKING_TOUCH?void cc.log("cc.Menu.onTouchEnded(): invalid state"):(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty(),i._selectedItem.activate()),void(i._state=cc.MENU_STATE_WAITING))},_onTouchCancelled:function(t,e){var i=e.getCurrentTarget();return i._state!==cc.MENU_STATE_TRACKING_TOUCH?void cc.log("cc.Menu.onTouchCancelled(): invalid state"):(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),void(i._state=cc.MENU_STATE_WAITING))},_onTouchMoved:function(t,e){var i=e.getCurrentTarget();if(i._state!==cc.MENU_STATE_TRACKING_TOUCH)return void cc.log("cc.Menu.onTouchMoved(): invalid state");var n=i._itemForTouch(t);n!==i._selectedItem&&(i._selectedItem&&(i._selectedItem.unselected(),i._selectedItem.setNodeDirty()),i._selectedItem=n,i._selectedItem&&(i._selectedItem.selected(),i._selectedItem.setNodeDirty()))},onExit:function(){this._state===cc.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),this._selectedItem=null),this._state=cc.MENU_STATE_WAITING),cc.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},_itemForTouch:function(t){var e,i=t.getLocation(),n=this._children;if(n&&n.length>0)for(var r=n.length-1;r>=0;r--)if(e=n[r],e.isVisible()&&e.isEnabled()){var o=e.convertToNodeSpace(i),s=e.rect();if(s.x=0,s.y=0,cc.rectContainsPoint(s,o))return e}return null}});var _p=cc.Menu.prototype;_p.enabled,cc.Menu.create=function(t){var e=arguments.length;e>0&&null==arguments[e-1]&&cc.log("parameters should not be ending with null in Javascript");var i;return i=0===e?new cc.Menu:1===e?new cc.Menu(t):new cc.Menu(Array.prototype.slice.call(arguments,0))};cc.math=cc.math||{},cc.math.EPSILON=1/64,cc.math.square=function(t){return t*t},cc.math.almostEqual=function(t,e){return t+cc.math.EPSILON>e&&t-cc.math.EPSILON<e},function(t){t.math.Vec2=function(t,e){void 0===e?(this.x=t.x,this.y=t.y):(this.x=t||0,this.y=e||0)};var e=t.math.Vec2.prototype;e.fill=function(t,e){this.x=t,this.y=e},e.length=function(){return Math.sqrt(t.math.square(this.x)+t.math.square(this.y))},e.lengthSq=function(){return t.math.square(this.x)+t.math.square(this.y)},e.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this},t.math.Vec2.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t},e.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.dot=function(t){return this.x*t.x+this.y*t.y},t.math.Vec2.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t},e.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.transform=function(t){var e=this.x,i=this.y;return this.x=e*t.mat[0]+i*t.mat[3]+t.mat[6],this.y=e*t.mat[1]+i*t.mat[4]+t.mat[7],this},t.math.Vec2.scale=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t},e.scale=function(t){return this.x*=t,this.y*=t,this},e.equals=function(e){return this.x<e.x+t.math.EPSILON&&this.x>e.x-t.math.EPSILON&&this.y<e.y+t.math.EPSILON&&this.y>e.y-t.math.EPSILON}}(cc),function(t){t.math.Vec3=t.kmVec3=function(t,e,i){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t||0,this.y=e||0,this.z=i||0)},t.math.vec3=function(e,i,n){return new t.math.Vec3(e,i,n)};var e=t.math.Vec3.prototype;e.fill=function(t,e,i){return t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=i),this},e.length=function(){return Math.sqrt(t.math.square(this.x)+t.math.square(this.y)+t.math.square(this.z))},e.lengthSq=function(){return t.math.square(this.x)+t.math.square(this.y)+t.math.square(this.z)},e.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this},e.cross=function(t){var e=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-e*t.z,this.z=e*t.y-i*t.x,this},e.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},e.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},e.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},e.transform=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8]+r[12],this.y=e*r[1]+i*r[5]+n*r[9]+r[13],this.z=e*r[2]+i*r[6]+n*r[10]+r[14],this},e.transformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[4]+n*r[8],this.y=e*r[1]+i*r[5]+n*r[9],this.z=e*r[2]+i*r[6]+n*r[10],this},e.transformCoord=function(e){var i=new t.math.Vec4(this.x,this.y,this.z,1);return i.transform(e),this.x=i.x/i.w,this.y=i.y/i.w,this.z=i.z/i.w,this},e.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},e.equals=function(e){var i=t.math.EPSILON;return this.x<e.x+i&&this.x>e.x-i&&this.y<e.y+i&&this.y>e.y-i&&this.z<e.z+i&&this.z>e.z-i},e.inverseTransform=function(e){var i=e.mat,n=new t.math.Vec3(this.x-i[12],this.y-i[13],this.z-i[14]);return this.x=n.x*i[0]+n.y*i[1]+n.z*i[2],this.y=n.x*i[4]+n.y*i[5]+n.z*i[6],this.z=n.x*i[8]+n.y*i[9]+n.z*i[10],this},e.inverseTransformNormal=function(t){var e=this.x,i=this.y,n=this.z,r=t.mat;return this.x=e*r[0]+i*r[1]+n*r[2],this.y=e*r[4]+i*r[5]+n*r[6],this.z=e*r[8]+i*r[9]+n*r[10],this},e.assignFrom=function(t){return t?(this.x=t.x,this.y=t.y,this.z=t.z,this):this},t.math.Vec3.zero=function(t){return t.x=t.y=t.z=0,t},e.toTypeArray=function(){var t=new Float32Array(3);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t}}(cc),function(t){t.math.Vec4=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},t.kmVec4=t.math.Vec4;var e=t.math.Vec4.prototype;e.fill=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t,this.y=e,this.z=i,this.w=n)},e.add=function(t){return t?(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this):this},e.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},e.length=function(){return Math.sqrt(t.math.square(this.x)+t.math.square(this.y)+t.math.square(this.z)+t.math.square(this.w))},e.lengthSq=function(){return t.math.square(this.x)+t.math.square(this.y)+t.math.square(this.z)+t.math.square(this.w)},e.lerp=function(t,e){return this},e.normalize=function(){var t=1/this.length();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},e.scale=function(t){return this.normalize(),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},e.subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},e.transform=function(t){var e=this.x,i=this.y,n=this.z,r=this.w,o=t.mat;return this.x=e*o[0]+i*o[4]+n*o[8]+r*o[12],this.y=e*o[1]+i*o[5]+n*o[9]+r*o[13],this.z=e*o[2]+i*o[6]+n*o[10]+r*o[14],this.w=e*o[3]+i*o[7]+n*o[11]+r*o[15],this},t.math.Vec4.transformArray=function(e,i){for(var n=[],r=0;r<e.length;r++){var o=new t.math.Vec4(e[r]);o.transform(i),n.push(o)}return n},e.equals=function(e){var i=t.math.EPSILON;return this.x<e.x+i&&this.x>e.x-i&&this.y<e.y+i&&this.y>e.y-i&&this.z<e.z+i&&this.z>e.z-i&&this.w<e.w+i&&this.w>e.w-i},e.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},e.toTypeArray=function(){var t=new Float32Array(4);return t[0]=this.x,t[1]=this.y,t[2]=this.z,t[3]=this.w,t}}(cc),function(t){function e(e,i,n){var r=new t.math.Vec2(i);r.subtract(e),n.x=-r.y,n.y=r.x,n.normalize()}t.math.Ray2=function(e,i){this.start=e||new t.math.Vec2,this.dir=i||new t.math.Vec2},t.math.Ray2.prototype.fill=function(t,e,i,n){this.start.x=t,this.start.y=e,this.dir.x=i,this.dir.y=n},t.math.Ray2.prototype.intersectLineSegment=function(e,i,n){var r,o,s,c=this.start.x,a=this.start.y,l=this.start.x+this.dir.x,h=this.start.y+this.dir.y,u=e.x,d=e.y,_=i.x,p=i.y,f=(p-d)*(l-c)-(_-u)*(h-a);return!(f>-t.math.EPSILON&&f<t.math.EPSILON)&&(r=((_-u)*(a-d)-(p-d)*(c-u))/f,o=c+r*(l-c),s=a+r*(h-a),!(o<Math.min(e.x,i.x)-t.math.EPSILON||o>Math.max(e.x,i.x)+t.math.EPSILON||s<Math.min(e.y,i.y)-t.math.EPSILON||s>Math.max(e.y,i.y)+t.math.EPSILON)&&(!(o<Math.min(c,l)-t.math.EPSILON||o>Math.max(c,l)+t.math.EPSILON||s<Math.min(a,h)-t.math.EPSILON||s>Math.max(a,h)+t.math.EPSILON)&&(n.x=o,n.y=s,!0)))},t.math.Ray2.prototype.intersectTriangle=function(i,n,r,o,s){var c,a=new t.math.Vec2,l=new t.math.Vec2,h=new t.math.Vec2,u=1e4,d=!1;return this.intersectLineSegment(i,n,a)&&(d=!0,c=a.subtract(this.start).length(),c<u&&(l.x=a.x,l.y=a.y,u=c,e(i,n,h))),this.intersectLineSegment(n,r,a)&&(d=!0,c=a.subtract(this.start).length(),c<u&&(l.x=a.x,l.y=a.y,u=c,e(n,r,h))),this.intersectLineSegment(r,i,a)&&(d=!0,c=a.subtract(this.start).length(),c<u&&(l.x=a.x,l.y=a.y,u=c,e(r,i,h))),d&&(o.x=l.x,o.y=l.y,s&&(s.x=h.x,s.y=h.y)),d}}(cc),window.Uint16Array=window.Uint16Array||window.Array,window.Float32Array=window.Float32Array||window.Array,function(t){t.math.Matrix3=function(t){t&&t.mat?this.mat=new Float32Array(t.mat):this.mat=new Float32Array(9)},t.kmMat3=t.math.Matrix3;var e=t.math.Matrix3.prototype;e.fill=function(t){var e=this.mat,i=t.mat;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},e.adjugate=function(){var t=this.mat,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],c=t[6],a=t[7],l=t[8];return t[0]=o*l-s*a,t[1]=n*a-i*l,t[2]=i*s-n*o,t[3]=s*c-r*l,t[4]=e*l-n*c,t[5]=n*r-e*s,t[6]=r*a-o*c,t[8]=e*o-i*r,this},e.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0,t[0]=t[4]=t[8]=1,this};var i=new t.math.Matrix3;e.inverse=function(t){if(0===t)return this;i.assignFrom(this);var e=1/t;return this.adjugate(),this.multiplyScalar(e),this},e.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]},e.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[3],r=t[5],o=t[6],s=t[7];return t[1]=n,t[2]=o,t[3]=e,t[5]=s,t[6]=i,t[7]=r,this},e.determinant=function(){var t=this.mat,e=t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7];return e-=t[2]*t[4]*t[6]+t[0]*t[5]*t[7]+t[1]*t[3]*t[8]},e.multiply=function(t){var e=this.mat,i=t.mat,n=e[0],r=e[1],o=e[2],s=e[3],c=e[4],a=e[5],l=e[6],h=e[7],u=e[8],d=i[0],_=i[1],p=i[2],f=i[3],m=i[4],g=i[5],y=i[6],v=i[7],T=i[8];return e[0]=n*d+s*_+l*p,e[1]=r*d+c*_+h*p,e[2]=o*d+a*_+u*p,e[3]=o*d+a*_+u*p,e[4]=r*f+c*m+h*g,e[5]=o*f+a*m+u*g,e[6]=n*y+s*v+l*T,e[7]=r*y+c*v+h*T,e[8]=o*y+a*v+u*T,this},e.multiplyScalar=function(t){var e=this.mat;return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t,e[5]*=t,e[6]*=t,e[7]*=t,e[8]*=t,this},t.math.Matrix3.rotationAxisAngle=function(e,i){var n=Math.cos(i),r=Math.sin(i),o=new t.math.Matrix3,s=o.mat;return s[0]=n+e.x*e.x*(1-n),s[1]=e.z*r+e.y*e.x*(1-n),s[2]=-e.y*r+e.z*e.x*(1-n),s[3]=-e.z*r+e.x*e.y*(1-n),s[4]=n+e.y*e.y*(1-n),s[5]=e.x*r+e.z*e.y*(1-n),s[6]=e.y*r+e.x*e.z*(1-n),s[7]=-e.x*r+e.y*e.z*(1-n),s[8]=n+e.z*e.z*(1-n),o},e.assignFrom=function(e){if(this===e)return t.log("cc.math.Matrix3.assign(): current matrix equals matIn"),this;var i=this.mat,n=e.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this},e.equals=function(e){if(this===e)return!0;for(var i=t.math.EPSILON,n=this.mat,r=e.mat,o=0;o<9;++o)if(!(n[o]+i>r[o]&&n[o]-i<r[o]))return!1;return!0},t.math.Matrix3.createByRotationX=function(e){var i=new t.math.Matrix3,n=i.mat;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=Math.cos(e),n[5]=Math.sin(e),n[6]=0,n[7]=-Math.sin(e),n[8]=Math.cos(e),i},t.math.Matrix3.createByRotationY=function(e){var i=new t.math.Matrix3,n=i.mat;return n[0]=Math.cos(e),n[1]=0,n[2]=-Math.sin(e),n[3]=0,n[4]=1,n[5]=0,n[6]=Math.sin(e),n[7]=0,n[8]=Math.cos(e),i},t.math.Matrix3.createByRotationZ=function(e){var i=new t.math.Matrix3,n=i.mat;return n[0]=Math.cos(e),n[1]=-Math.sin(e),n[2]=0,n[3]=Math.sin(e),n[4]=Math.cos(e),n[5]=0,n[6]=0,n[7]=0,n[8]=1,i},t.math.Matrix3.createByRotation=function(e){var i=new t.math.Matrix3,n=i.mat;return n[0]=Math.cos(e),n[1]=Math.sin(e),n[2]=0,n[3]=-Math.sin(e),n[4]=Math.cos(e),n[5]=0,n[6]=0,n[7]=0,n[8]=1,i},t.math.Matrix3.createByScale=function(e,i){var n=new t.math.Matrix3;return n.identity(),n.mat[0]=e,n.mat[4]=i,n},t.math.Matrix3.createByTranslation=function(e,i){var n=new t.math.Matrix3;return n.identity(),n.mat[6]=e,n.mat[7]=i,n},t.math.Matrix3.createByQuaternion=function(e){if(!e)return null;var i=new t.math.Matrix3,n=i.mat;return n[0]=1-2*(e.y*e.y+e.z*e.z),n[1]=2*(e.x*e.y-e.w*e.z),n[2]=2*(e.x*e.z+e.w*e.y),n[3]=2*(e.x*e.y+e.w*e.z),n[4]=1-2*(e.x*e.x+e.z*e.z),n[5]=2*(e.y*e.z-e.w*e.x),n[6]=2*(e.x*e.z-e.w*e.y),n[7]=2*(e.y*e.z+e.w*e.x),n[8]=1-2*(e.x*e.x+e.y*e.y),i},e.rotationToAxisAngle=function(){return t.math.Quaternion.rotationMatrix(this).toAxisAndAngle()}}(cc),function(t){t.math.Matrix4=function(t){t&&t.mat?this.mat=new Float32Array(t.mat):this.mat=new Float32Array(16)},t.kmMat4=t.math.Matrix4;var e=t.math.Matrix4.prototype;e.fill=function(t){for(var e=this.mat,i=0;i<16;i++)e[i]=t[i];return this},t.kmMat4Identity=function(t){var e=t.mat;return e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1,t},e.identity=function(){var t=this.mat;return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[5]=t[10]=t[15]=1,this},e.get=function(t,e){return this.mat[t+4*e]},e.set=function(t,e,i){this.mat[t+4*e]=i},e.swap=function(t,e,i,n){var r=this.mat,o=r[t+4*e];r[t+4*e]=r[i+4*n],r[i+4*n]=o},t.math.Matrix4._gaussj=function(t,e){var i,n,r,o,s,c,a,l,h,u=0,d=0,_=4,p=4,f=[0,0,0,0],m=[0,0,0,0],g=[0,0,0,0];for(i=0;i<_;i++){for(a=0,n=0;n<_;n++)if(1!==g[n])for(r=0;r<_;r++)0===g[r]&&(c=Math.abs(t.get(n,r)),c>=a&&(a=c,d=n,u=r));if(++g[u],d!==u){for(o=0;o<_;o++)t.swap(d,o,u,o);for(o=0;o<p;o++)e.swap(d,o,u,o)}if(m[i]=d,f[i]=u,0===t.get(u,u))return!1;for(h=1/t.get(u,u),t.set(u,u,1),o=0;o<_;o++)t.set(u,o,t.get(u,o)*h);for(o=0;o<p;o++)e.set(u,o,e.get(u,o)*h);for(s=0;s<_;s++)if(s!==u){for(l=t.get(s,u),t.set(s,u,0),o=0;o<_;o++)t.set(s,o,t.get(s,o)-t.get(u,o)*l);for(o=0;o<p;o++)e.set(s,o,t.get(s,o)-e.get(u,o)*l)}}for(o=_-1;o>=0;o--)if(m[o]!==f[o])for(r=0;r<_;r++)t.swap(r,m[o],r,f[o]);return!0};var i=(new t.math.Matrix4).identity();t.kmMat4Inverse=function(e,n){var r=new t.math.Matrix4(n),o=new t.math.Matrix4(i);return t.math.Matrix4._gaussj(r,o)===!1?null:(e.assignFrom(r),e)},e.inverse=function(){var e=new t.math.Matrix4(this),n=new t.math.Matrix4(i);return t.math.Matrix4._gaussj(e,n)===!1?null:e},e.isIdentity=function(){var t=this.mat;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},e.transpose=function(){var t=this.mat,e=t[1],i=t[2],n=t[3],r=t[4],o=t[6],s=t[7],c=t[8],a=t[9],l=t[11],h=t[12],u=t[13],d=t[14];return t[1]=r,t[2]=c,t[3]=h,t[4]=e,t[6]=a,t[7]=u,t[8]=i,t[9]=o,t[11]=d,t[12]=n,t[13]=s,t[14]=l,this},t.kmMat4Multiply=function(t,e,i){var n=t.mat,r=e.mat,o=i.mat,s=r[0],c=r[1],a=r[2],l=r[3],h=r[4],u=r[5],d=r[6],_=r[7],p=r[8],f=r[9],m=r[10],g=r[11],y=r[12],v=r[13],T=r[14],C=r[15],S=o[0],x=o[1],A=o[2],E=o[3],b=o[4],R=o[5],P=o[6],w=o[7],I=o[8],D=o[9],L=o[10],O=o[11],B=o[12],N=o[13],F=o[14],M=o[15];return n[0]=S*s+x*h+A*p+E*y,n[1]=S*c+x*u+A*f+E*v,n[2]=S*a+x*d+A*m+E*T,n[3]=S*l+x*_+A*g+E*C,n[4]=b*s+R*h+P*p+w*y,n[5]=b*c+R*u+P*f+w*v,n[6]=b*a+R*d+P*m+w*T,n[7]=b*l+R*_+P*g+w*C,n[8]=I*s+D*h+L*p+O*y,n[9]=I*c+D*u+L*f+O*v,n[10]=I*a+D*d+L*m+O*T,n[11]=I*l+D*_+L*g+O*C,n[12]=B*s+N*h+F*p+M*y,n[13]=B*c+N*u+F*f+M*v,n[14]=B*a+N*d+F*m+M*T,n[15]=B*l+N*_+F*g+M*C,t},e.multiply=function(t){var e=this.mat,i=t.mat,n=e[0],r=e[1],o=e[2],s=e[3],c=e[4],a=e[5],l=e[6],h=e[7],u=e[8],d=e[9],_=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=i[0],T=i[1],C=i[2],S=i[3],x=i[4],A=i[5],E=i[6],b=i[7],R=i[8],P=i[9],w=i[10],I=i[11],D=i[12],L=i[13],O=i[14],B=i[15];return e[0]=v*n+T*c+C*u+S*f,e[1]=v*r+T*a+C*d+S*m,e[2]=v*o+T*l+C*_+S*g,e[3]=v*s+T*h+C*p+S*y,e[4]=x*n+A*c+E*u+b*f,e[5]=x*r+A*a+E*d+b*m,e[6]=x*o+A*l+E*_+b*g,e[7]=x*s+A*h+E*p+b*y,e[8]=R*n+P*c+w*u+I*f,e[9]=R*r+P*a+w*d+I*m,e[10]=R*o+P*l+w*_+I*g,e[11]=R*s+P*h+w*p+I*y,e[12]=D*n+L*c+O*u+B*f,e[13]=D*r+L*a+O*d+B*m,e[14]=D*o+L*l+O*_+B*g,e[15]=D*s+L*h+O*p+B*y,this},t.getMat4MultiplyValue=function(t,e){var i=t.mat,n=e.mat,r=new Float32Array(16);return r[0]=i[0]*n[0]+i[4]*n[1]+i[8]*n[2]+i[12]*n[3],r[1]=i[1]*n[0]+i[5]*n[1]+i[9]*n[2]+i[13]*n[3],r[2]=i[2]*n[0]+i[6]*n[1]+i[10]*n[2]+i[14]*n[3],r[3]=i[3]*n[0]+i[7]*n[1]+i[11]*n[2]+i[15]*n[3],r[4]=i[0]*n[4]+i[4]*n[5]+i[8]*n[6]+i[12]*n[7],r[5]=i[1]*n[4]+i[5]*n[5]+i[9]*n[6]+i[13]*n[7],r[6]=i[2]*n[4]+i[6]*n[5]+i[10]*n[6]+i[14]*n[7],r[7]=i[3]*n[4]+i[7]*n[5]+i[11]*n[6]+i[15]*n[7],r[8]=i[0]*n[8]+i[4]*n[9]+i[8]*n[10]+i[12]*n[11],r[9]=i[1]*n[8]+i[5]*n[9]+i[9]*n[10]+i[13]*n[11],r[10]=i[2]*n[8]+i[6]*n[9]+i[10]*n[10]+i[14]*n[11],r[11]=i[3]*n[8]+i[7]*n[9]+i[11]*n[10]+i[15]*n[11],r[12]=i[0]*n[12]+i[4]*n[13]+i[8]*n[14]+i[12]*n[15],r[13]=i[1]*n[12]+i[5]*n[13]+i[9]*n[14]+i[13]*n[15],r[14]=i[2]*n[12]+i[6]*n[13]+i[10]*n[14]+i[14]*n[15],r[15]=i[3]*n[12]+i[7]*n[13]+i[11]*n[14]+i[15]*n[15],r},t.kmMat4Assign=function(e,i){if(e===i)return t.log("cc.kmMat4Assign(): pOut equals pIn"),e;var n=e.mat,r=i.mat;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],e},e.assignFrom=function(e){if(this===e)return t.log("cc.mat.Matrix4.assignFrom(): mat4 equals current matrix"),this;var i=this.mat,n=e.mat;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},e.equals=function(e){if(this===e)return t.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object."),!0;for(var i=this.mat,n=e.mat,r=t.math.EPSILON,o=0;o<16;o++)if(!(i[o]+r>n[o]&&i[o]-r<n[o]))return!1;return!0},t.math.Matrix4.createByRotationX=function(e,i){i=i||new t.math.Matrix4;var n=i.mat;return n[0]=1,n[3]=n[2]=n[1]=0,n[4]=0,n[5]=Math.cos(e),n[6]=Math.sin(e),n[7]=0,n[8]=0,n[9]=-Math.sin(e),n[10]=Math.cos(e),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},t.math.Matrix4.createByRotationY=function(e,i){i=i||new t.math.Matrix4;var n=i.mat;return n[0]=Math.cos(e),n[1]=0,n[2]=-Math.sin(e),n[3]=0,n[7]=n[6]=n[4]=0,n[5]=1,n[8]=Math.sin(e),n[9]=0,n[10]=Math.cos(e),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},t.math.Matrix4.createByRotationZ=function(e,i){i=i||new t.math.Matrix4;var n=i.mat;return n[0]=Math.cos(e),n[1]=Math.sin(e),n[3]=n[2]=0,n[4]=-Math.sin(e),n[5]=Math.cos(e),n[7]=n[6]=0,n[11]=n[9]=n[8]=0,n[10]=1,n[14]=n[13]=n[12]=0,n[15]=1,i},t.math.Matrix4.createByPitchYawRoll=function(e,i,n,r){r=r||new t.math.Matrix4;var o=Math.cos(e),s=Math.sin(e),c=Math.cos(i),a=Math.sin(i),l=Math.cos(n),h=Math.sin(n),u=s*a,d=o*a,_=r.mat;return _[0]=c*l,_[4]=c*h,_[8]=-a,_[1]=u*l-o*h,_[5]=u*h+o*l,_[9]=s*c,_[2]=d*l+s*h,_[6]=d*h-s*l,_[10]=o*c,_[3]=_[7]=_[11]=0,_[15]=1,r},t.math.Matrix4.createByQuaternion=function(e,i){i=i||new t.math.Matrix4;var n=i.mat;return n[0]=1-2*(e.y*e.y+e.z*e.z),n[1]=2*(e.x*e.y+e.z*e.w),n[2]=2*(e.x*e.z-e.y*e.w),n[3]=0,n[4]=2*(e.x*e.y-e.z*e.w),n[5]=1-2*(e.x*e.x+e.z*e.z),n[6]=2*(e.z*e.y+e.x*e.w),n[7]=0,n[8]=2*(e.x*e.z+e.y*e.w),n[9]=2*(e.y*e.z-e.x*e.w),n[10]=1-2*(e.x*e.x+e.y*e.y),n[11]=0,n[14]=n[13]=n[12]=0,n[15]=1,i},t.math.Matrix4.createByRotationTranslation=function(e,i,n){n=n||new t.math.Matrix4;var r=n.mat,o=e.mat;return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=0,r[4]=o[3],r[5]=o[4],r[6]=o[5],r[7]=0,r[8]=o[6],r[9]=o[7],r[10]=o[8],r[11]=0,r[12]=i.x,r[13]=i.y,r[14]=i.z,r[15]=1,n},t.math.Matrix4.createByScale=function(e,i,n,r){r=r||new t.math.Matrix4;var o=r.mat;return o[0]=e,o[5]=i,o[10]=n,o[15]=1,o[1]=o[2]=o[3]=o[4]=o[6]=o[7]=o[8]=o[9]=o[11]=o[12]=o[13]=o[14]=0,r},t.kmMat4Translation=function(t,e,i,n){return t.mat[0]=t.mat[5]=t.mat[10]=t.mat[15]=1,t.mat[1]=t.mat[2]=t.mat[3]=t.mat[4]=t.mat[6]=t.mat[7]=t.mat[8]=t.mat[9]=t.mat[11]=0,t.mat[12]=e,t.mat[13]=i,t.mat[14]=n,t},t.math.Matrix4.createByTranslation=function(e,i,n,r){return r=r||new t.math.Matrix4,r.identity(),r.mat[12]=e,r.mat[13]=i,r.mat[14]=n,r},e.getUpVec3=function(){var e=this.mat,i=new t.math.Vec3(e[4],e[5],e[6]);return i.normalize()},e.getRightVec3=function(){var e=this.mat,i=new t.math.Vec3(e[0],e[1],e[2]);return i.normalize()},e.getForwardVec3=function(){var e=this.mat,i=new t.math.Vec3(e[8],e[9],e[10]);return i.normalize()},t.kmMat4PerspectiveProjection=function(e,i,n,r,o){var s=t.degreesToRadians(i/2),c=o-r,a=Math.sin(s);if(0===c||0===a||0===n)return null;var l=Math.cos(s)/a;return e.identity(),e.mat[0]=l/n,e.mat[5]=l,e.mat[10]=-(o+r)/c,e.mat[11]=-1,e.mat[14]=-2*r*o/c,e.mat[15]=0,e},t.math.Matrix4.createPerspectiveProjection=function(e,i,n,r){var o=t.degreesToRadians(e/2),s=r-n,c=Math.sin(o);if(0===s||0===c||0===i)return null;var a=Math.cos(o)/c,l=new t.math.Matrix4,h=l.mat;return l.identity(),h[0]=a/i,h[5]=a,h[10]=-(r+n)/s,h[11]=-1,h[14]=-2*n*r/s,h[15]=0,l},t.kmMat4OrthographicProjection=function(t,e,i,n,r,o,s){return t.identity(),t.mat[0]=2/(i-e),t.mat[5]=2/(r-n),t.mat[10]=-2/(s-o),t.mat[12]=-((i+e)/(i-e)),t.mat[13]=-((r+n)/(r-n)),t.mat[14]=-((s+o)/(s-o)),t},t.math.Matrix4.createOrthographicProjection=function(e,i,n,r,o,s){var c=new t.math.Matrix4,a=c.mat;return c.identity(),a[0]=2/(i-e),a[5]=2/(r-n),a[10]=-2/(s-o),a[12]=-((i+e)/(i-e)),a[13]=-((r+n)/(r-n)),a[14]=-((s+o)/(s-o)),c},t.kmMat4LookAt=function(e,i,n,r){var o=new t.math.Vec3(n),s=new t.math.Vec3(r);o.subtract(i),o.normalize(),s.normalize();var c=new t.math.Vec3(o);c.cross(s),c.normalize();var a=new t.math.Vec3(c);a.cross(o),c.normalize(),e.identity(),e.mat[0]=c.x,e.mat[4]=c.y,e.mat[8]=c.z,e.mat[1]=a.x,e.mat[5]=a.y,e.mat[9]=a.z,e.mat[2]=-o.x,e.mat[6]=-o.y,e.mat[10]=-o.z;var l=t.math.Matrix4.createByTranslation(-i.x,-i.y,-i.z);return e.multiply(l),e};var n=new t.math.Matrix4;e.lookAt=function(e,i,r){var o=new t.math.Vec3(i),s=new t.math.Vec3(r),c=this.mat;o.subtract(e),o.normalize(),s.normalize();var a=new t.math.Vec3(o);a.cross(s),a.normalize();var l=new t.math.Vec3(a);return l.cross(o),a.normalize(),this.identity(),c[0]=a.x,c[4]=a.y,c[8]=a.z,c[1]=l.x,c[5]=l.y,c[9]=l.z,c[2]=-o.x,c[6]=-o.y,c[10]=-o.z,n=t.math.Matrix4.createByTranslation(-e.x,-e.y,-e.z,n),this.multiply(n),this},t.kmMat4RotationAxisAngle=function(e,i,n){var r=Math.cos(n),o=Math.sin(n),s=new t.math.Vec3(i);return s.normalize(),e.mat[0]=r+s.x*s.x*(1-r),e.mat[1]=s.z*o+s.y*s.x*(1-r),e.mat[2]=-s.y*o+s.z*s.x*(1-r),e.mat[3]=0,e.mat[4]=-s.z*o+s.x*s.y*(1-r),e.mat[5]=r+s.y*s.y*(1-r),e.mat[6]=s.x*o+s.z*s.y*(1-r),e.mat[7]=0,e.mat[8]=s.y*o+s.x*s.z*(1-r),e.mat[9]=-s.x*o+s.y*s.z*(1-r),e.mat[10]=r+s.z*s.z*(1-r),e.mat[11]=0,e.mat[12]=0,e.mat[13]=0,e.mat[14]=0,e.mat[15]=1,e},t.math.Matrix4.createByAxisAndAngle=function(e,i,n){n=n||new t.math.Matrix4;var r=this.mat,o=Math.cos(i),s=Math.sin(i),c=new t.math.Vec3(e);return c.normalize(),r[0]=o+c.x*c.x*(1-o),r[1]=c.z*s+c.y*c.x*(1-o),r[2]=-c.y*s+c.z*c.x*(1-o),r[3]=0,r[4]=-c.z*s+c.x*c.y*(1-o),r[5]=o+c.y*c.y*(1-o),r[6]=c.x*s+c.z*c.y*(1-o),r[7]=0,r[8]=c.y*s+c.x*c.z*(1-o),r[9]=-c.x*s+c.y*c.z*(1-o),r[10]=o+c.z*c.z*(1-o),r[11]=0,r[12]=r[13]=r[14]=0,r[15]=1,n},e.extractRotation=function(){var e=new t.math.Matrix3,i=this.mat,n=e.mat;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[4],n[4]=i[5],n[5]=i[6],n[6]=i[8],n[7]=i[9],n[8]=i[10],e},e.extractPlane=function(e){var i=new t.math.Plane,n=this.mat;switch(e){case t.math.Plane.RIGHT:i.a=n[3]-n[0],i.b=n[7]-n[4],i.c=n[11]-n[8],i.d=n[15]-n[12];break;case t.math.Plane.LEFT:i.a=n[3]+n[0],i.b=n[7]+n[4],i.c=n[11]+n[8],i.d=n[15]+n[12];break;case t.math.Plane.BOTTOM:i.a=n[3]+n[1],i.b=n[7]+n[5],i.c=n[11]+n[9],i.d=n[15]+n[13];break;case t.math.Plane.TOP:i.a=n[3]-n[1],i.b=n[7]-n[5],i.c=n[11]-n[9],i.d=n[15]-n[13];break;case t.math.Plane.FAR:i.a=n[3]-n[2],i.b=n[7]-n[6],i.c=n[11]-n[10],i.d=n[15]-n[14];break;case t.math.Plane.NEAR:i.a=n[3]+n[2],i.b=n[7]+n[6],i.c=n[11]+n[10],i.d=n[15]+n[14];break;default:t.log("cc.math.Matrix4.extractPlane: Invalid plane index")}var r=Math.sqrt(i.a*i.a+i.b*i.b+i.c*i.c);return i.a/=r,i.b/=r,i.c/=r,i.d/=r,i},e.toAxisAndAngle=function(){var e=this.extractRotation(),i=t.math.Quaternion.rotationMatrix(e);return i.toAxisAndAngle()}}(cc),function(t){t.math.Plane=function(t,e,i,n){t&&void 0===e?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d):(this.a=t||0,this.b=e||0,this.c=i||0,this.d=n||0)},t.kmPlane=t.math.Plane;var e=t.math.Plane.prototype;t.math.Plane.LEFT=0,t.math.Plane.RIGHT=1,t.math.Plane.BOTTOM=2,t.math.Plane.TOP=3,t.math.Plane.NEAR=4,t.math.Plane.FAR=5,t.math.Plane.POINT_INFRONT_OF_PLANE=0,t.math.Plane.POINT_BEHIND_PLANE=1,t.math.Plane.POINT_ON_PLANE=2,e.dot=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d*t.w},e.dotCoord=function(t){return this.a*t.x+this.b*t.y+this.c*t.z+this.d},e.dotNormal=function(t){return this.a*t.x+this.b*t.y+this.c*t.z},t.math.Plane.fromPointNormal=function(e,i){return new t.math.Plane(i.x,i.y,i.z,-i.dot(e))},t.math.Plane.fromPoints=function(e,i,n){var r=new t.math.Vec3(i),o=new t.math.Vec3(n),s=new t.math.Plane;return r.subtract(e),o.subtract(e),r.cross(o),r.normalize(),s.a=r.x,s.b=r.y,s.c=r.z,s.d=r.scale(-1).dot(e),s},e.normalize=function(){var e=new t.math.Vec3(this.a,this.b,this.c),i=1/e.length();return e.normalize(),this.a=e.x,this.b=e.y,this.c=e.z,this.d=this.d*i,this},e.classifyPoint=function(e){var i=this.a*e.x+this.b*e.y+this.c*e.z+this.d;return i>.001?t.math.Plane.POINT_INFRONT_OF_PLANE:i<-.001?t.math.Plane.POINT_BEHIND_PLANE:t.math.Plane.POINT_ON_PLANE}}(cc),function(t){t.math.Quaternion=function(t,e,i,n){t&&void 0===e?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},t.kmQuaternion=t.math.Quaternion;var e=t.math.Quaternion.prototype;e.conjugate=function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this.w=t.w,this},e.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},e.exponential=function(){return this},e.identity=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},e.inverse=function(){var e=this.length();return Math.abs(e)>t.math.EPSILON?(this.x=0,this.y=0,this.z=0,this.w=0,this):(this.conjugate(this).scale(1/e),this)},e.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w},e.length=function(){return Math.sqrt(this.lengthSq())},e.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},e.multiply=function(t){var e=this.x,i=this.y,n=this.z,r=this.w;return this.w=r*t.w-e*t.x-i*t.y-n*t.z,this.x=r*t.x+e*t.w+i*t.z-n*t.y,this.y=r*t.y+i*t.w+n*t.x-e*t.z,this.z=r*t.z+n*t.w+e*t.y-i*t.x,this},e.normalize=function(){var e=this.length();if(Math.abs(e)<=t.math.EPSILON)throw new Error("current quaternion is an invalid value");return this.scale(1/e),this},e.rotationAxis=function(t,e){var i=.5*e,n=Math.sin(i);return this.w=Math.cos(i),this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this},t.math.Quaternion.rotationMatrix=function(e){if(!e)return null;var i,n,r,o,s=[],c=e.mat,a=0;s[0]=c[0],s[1]=c[3],s[2]=c[6],s[4]=c[1],s[5]=c[4],s[6]=c[7],s[8]=c[2],s[9]=c[5],s[10]=c[8],s[15]=1;var l=s[0],h=l[0]+l[5]+l[10]+1;return h>t.math.EPSILON?(a=2*Math.sqrt(h),i=(l[9]-l[6])/a,n=(l[2]-l[8])/a,r=(l[4]-l[1])/a,o=.25*a):l[0]>l[5]&&l[0]>l[10]?(a=2*Math.sqrt(1+l[0]-l[5]-l[10]),i=.25*a,n=(l[4]+l[1])/a,r=(l[2]+l[8])/a,o=(l[9]-l[6])/a):l[5]>l[10]?(a=2*Math.sqrt(1+l[5]-l[0]-l[10]),i=(l[4]+l[1])/a,n=.25*a,r=(l[9]+l[6])/a,o=(l[2]-l[8])/a):(a=2*Math.sqrt(1+l[10]-l[0]-l[5]),i=(l[2]+l[8])/a,n=(l[9]+l[6])/a,r=.25*a,o=(l[4]-l[1])/a),new t.math.Quaternion(i,n,r,o)},t.math.Quaternion.rotationYawPitchRoll=function(e,i,n){var r,o,s,c,a,l,h,u,d,_,p;r=t.degreesToRadians(i)/2,o=t.degreesToRadians(e)/2,s=t.degreesToRadians(n)/2,c=Math.cos(r),a=Math.cos(o),l=Math.cos(s),h=Math.sin(r),u=Math.sin(o),d=Math.sin(s),_=a*l,p=u*d;var f=new t.math.Quaternion;return f.w=c*_+h*p,f.x=h*_-c*p,f.y=c*u*l+h*a*d,f.z=c*a*d-h*u*l,f.normalize(),f},e.slerp=function(e,i){if(this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w)return this;var n=this.dot(e),r=Math.acos(n),o=Math.sqrt(1-t.math.square(n)),s=Math.sin(i*r)/o,c=Math.sin((1-i)*r)/o,a=new t.math.Quaternion(e);return this.scale(c),a.scale(s),this.add(a),this},e.toAxisAndAngle=function(){var e,i,n,r=new t.math.Vec3;return e=Math.acos(this.w),i=Math.sqrt(t.math.square(this.x)+t.math.square(this.y)+t.math.square(this.z)),i>-t.math.EPSILON&&i<t.math.EPSILON||i<2*Math.PI+t.math.EPSILON&&i>2*Math.PI-t.math.EPSILON?(n=0,r.x=0,r.y=0,r.z=1):(n=2*e,r.x=this.x/i,r.y=this.y/i,r.z=this.z/i,r.normalize()),{axis:r,angle:n}},e.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},e.assignFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},e.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.math.Quaternion.rotationBetweenVec3=function(e,i,n){var r=new t.math.Vec3(e),o=new t.math.Vec3(i);r.normalize(),o.normalize();var s=r.dot(o),c=new t.math.Quaternion;if(s>=1)return c.identity(),c;if(s<1e-6-1)if(Math.abs(n.lengthSq())<t.math.EPSILON)c.rotationAxis(n,Math.PI);else{var a=new t.math.Vec3(1,0,0);a.cross(e),Math.abs(a.lengthSq())<t.math.EPSILON&&(a.fill(0,1,0),a.cross(e)),a.normalize(),c.rotationAxis(a,Math.PI)}else{var l=Math.sqrt(2*(1+s)),h=1/l;r.cross(o),c.x=r.x*h,c.y=r.y*h,c.z=r.z*h,c.w=.5*l,c.normalize()}return c},e.multiplyVec3=function(e){var i=this.x,n=this.y,r=this.z,o=new t.math.Vec3(e),s=new t.math.Vec3(i,n,r),c=new t.math.Vec3(i,n,r);return s.cross(e),c.cross(s),s.scale(2*q.w),c.scale(2),o.add(s),o.add(c),o}}(cc),cc.math.AABB=function(t,e){this.min=t||new cc.math.Vec3,this.max=e||new cc.math.Vec3},cc.math.AABB.prototype.containsPoint=function(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z},cc.math.AABB.containsPoint=function(t,e){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y&&t.z>=e.min.z&&t.z<=e.max.z},cc.math.AABB.prototype.assignFrom=function(t){this.min.assignFrom(t.min),this.max.assignFrom(t.max)},cc.math.AABB.assign=function(t,e){return t.min.assignFrom(e.min),t.max.assignFrom(e.max),t},function(t){t.math.Matrix4Stack=function(t,e){this.top=t,this.stack=e||[]},t.km_mat4_stack=t.math.Matrix4Stack;var e=t.math.Matrix4Stack.prototype;e.initialize=function(){this.stack.length=0,this.top=null},t.km_mat4_stack_push=function(e,i){e.stack.push(e.top),e.top=new t.math.Matrix4(i)},t.km_mat4_stack_pop=function(t,e){t.top=t.stack.pop()},t.km_mat4_stack_release=function(t){t.stack=null,t.top=null},e.push=function(e){e=e||this.top,this.stack.push(this.top),this.top=new t.math.Matrix4(e)},e.pop=function(){this.top=this.stack.pop()},e.release=function(){this.stack=null,this.top=null,this._matrixPool=null},e._getFromPool=function(e){var i=this._matrixPool;if(0===i.length)return new t.math.Matrix4(e);var n=i.pop();return n.assignFrom(e),n},e._putInPool=function(t){this._matrixPool.push(t)}}(cc),function(t){t.KM_GL_MODELVIEW=5888,t.KM_GL_PROJECTION=5889,t.KM_GL_TEXTURE=5890,t.modelview_matrix_stack=new t.math.Matrix4Stack,t.projection_matrix_stack=new t.math.Matrix4Stack,t.texture_matrix_stack=new t.math.Matrix4Stack,t.current_stack=null;var e=!1;t.lazyInitialize=function(){if(!e){var i=new t.math.Matrix4;t.modelview_matrix_stack.initialize(),t.projection_matrix_stack.initialize(),t.texture_matrix_stack.initialize(),t.current_stack=t.modelview_matrix_stack,t.initialized=!0,i.identity(),t.modelview_matrix_stack.push(i),t.projection_matrix_stack.push(i),t.texture_matrix_stack.push(i)}},t.lazyInitialize(),t.kmGLFreeAll=function(){t.modelview_matrix_stack.release(),t.modelview_matrix_stack=null,t.projection_matrix_stack.release(),t.projection_matrix_stack=null,t.texture_matrix_stack.release(),t.texture_matrix_stack=null,t.initialized=!1,t.current_stack=null},t.kmGLPushMatrix=function(){t.current_stack.push(t.current_stack.top)},t.kmGLPushMatrixWitMat4=function(e){t.current_stack.stack.push(t.current_stack.top),e.assignFrom(t.current_stack.top),t.current_stack.top=e},t.kmGLPopMatrix=function(){t.current_stack.top=t.current_stack.stack.pop()},t.kmGLMatrixMode=function(e){switch(e){case t.KM_GL_MODELVIEW:t.current_stack=t.modelview_matrix_stack;break;case t.KM_GL_PROJECTION:t.current_stack=t.projection_matrix_stack;break;case t.KM_GL_TEXTURE:t.current_stack=t.texture_matrix_stack;break;default:throw new Error("Invalid matrix mode specified")}},t.kmGLLoadIdentity=function(){t.current_stack.top.identity()},t.kmGLLoadMatrix=function(e){t.current_stack.top.assignFrom(e)},t.kmGLMultMatrix=function(e){t.current_stack.top.multiply(e)};var i=new t.math.Matrix4;t.kmGLTranslatef=function(e,n,r){var o=t.math.Matrix4.createByTranslation(e,n,r,i);t.current_stack.top.multiply(o)};var n=new t.math.Vec3;t.kmGLRotatef=function(e,r,o,s){n.fill(r,o,s);var c=t.math.Matrix4.createByAxisAndAngle(n,t.degreesToRadians(e),i);t.current_stack.top.multiply(c)},t.kmGLScalef=function(e,n,r){var o=t.math.Matrix4.createByScale(e,n,r,i);t.current_stack.top.multiply(o)},t.kmGLGetMatrix=function(e,i){switch(e){case t.KM_GL_MODELVIEW:i.assignFrom(t.modelview_matrix_stack.top);break;case t.KM_GL_PROJECTION:i.assignFrom(t.projection_matrix_stack.top);break;case t.KM_GL_TEXTURE:i.assignFrom(t.texture_matrix_stack.top);break;default:throw new Error("Invalid matrix mode specified")}}}(cc);if(cc.SHADER_POSITION_UCOLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor = v_fragmentColor;      \n}\n",cc.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize = u_pointSize;          \n    v_fragmentColor = u_color;           \n}",cc.SHADER_POSITION_COLOR_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor = v_fragmentColor; \n} ",cc.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color;             \n}",cc.SHADER_SPRITE_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color;             \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor = v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor = v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color = a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord = a_texcoord; \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n}",cc.SHADER_POSITION_TEXTURE_FRAG="precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord);   \n}",cc.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;               \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor =  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord = a_texCoord;                 \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}",cc.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a <= CC_alpha_value )          \n        discard; \n    gl_FragColor = texColor * v_fragmentColor;  \n}",cc.SHADEREX_SWITCHMASK_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   = texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  = texture2D(u_mask, v_texCoord); \n    vec4 finalColor = vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    = v_fragmentColor * finalColor; \n}",cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_SPRITE_POSITION_TEXTURECOLOR:8,TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:9,TYPE_SPRITE_POSITION_COLOR:10,TYPE_MAX:10,_programs:{},_init:function(){return this.loadDefaultShaders(),!0},_loadDefaultShader:function(t,e){switch(e){case this.TYPE_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_SPRITE_POSITION_TEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_COLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case this.TYPE_SPRITE_POSITION_COLOR:t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case this.TYPE_POSITION_TEXTURE:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_VERT,cc.SHADER_POSITION_TEXTURE_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_UCOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT,cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_A8COLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT,cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_UCOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_UCOLOR_VERT,cc.SHADER_POSITION_UCOLOR_FRAG),t.addAttribute("aVertex",cc.VERTEX_ATTRIB_POSITION);break;case this.TYPE_POSITION_LENGTH_TEXTURECOLOR:t.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;default:return void cc.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type")}t.link(),t.updateUniforms()},loadDefaultShaders:function(){var t=new cc.GLProgram;this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURECOLOR),this._programs[cc.SHADER_POSITION_TEXTURECOLOR]=t,this._programs.ShaderPositionTextureColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_SPRITE_POSITION_TEXTURECOLOR),this._programs[cc.SHADER_SPRITE_POSITION_TEXTURECOLOR]=t,this._programs.ShaderSpritePositionTextureColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST),this._programs[cc.SHADER_POSITION_TEXTURECOLORALPHATEST]=t,this._programs.ShaderPositionTextureColorAlphaTest=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST),this._programs[cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST]=t,this._programs.ShaderSpritePositionTextureColorAlphaTest=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_COLOR),this._programs[cc.SHADER_POSITION_COLOR]=t,this._programs.ShaderPositionColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_SPRITE_POSITION_COLOR),this._programs[cc.SHADER_SPRITE_POSITION_COLOR]=t,this._programs.ShaderSpritePositionColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE),this._programs[cc.SHADER_POSITION_TEXTURE]=t,this._programs.ShaderPositionTexture=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE_UCOLOR),this._programs[cc.SHADER_POSITION_TEXTURE_UCOLOR]=t,this._programs.ShaderPositionTextureUColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE_A8COLOR),this._programs[cc.SHADER_POSITION_TEXTUREA8COLOR]=t,this._programs.ShaderPositionTextureA8Color=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_UCOLOR),this._programs[cc.SHADER_POSITION_UCOLOR]=t,this._programs.ShaderPositionUColor=t,t=new cc.GLProgram,this._loadDefaultShader(t,this.TYPE_POSITION_LENGTH_TEXTURECOLOR),this._programs[cc.SHADER_POSITION_LENGTHTEXTURECOLOR]=t,this._programs.ShaderPositionLengthTextureColor=t},reloadDefaultShaders:function(){var t=this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURECOLOR),t=this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR),t.reset(),this._loadDefaultShader(t,this.TYPE_SPRITE_POSITION_TEXTURECOLOR),t=this.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST),t=this.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),t.reset(),this._loadDefaultShader(t,this.TYPE_SPRITE_POSITION_TEXTURECOLOR_ALPHATEST),t=this.programForKey(cc.SHADER_POSITION_COLOR),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_COLOR),t=this.programForKey(cc.SHADER_POSITION_TEXTURE),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE),t=this.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE_UCOLOR),t=this.programForKey(cc.SHADER_POSITION_TEXTUREA8COLOR),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_TEXTURE_A8COLOR),t=this.programForKey(cc.SHADER_POSITION_UCOLOR),t.reset(),this._loadDefaultShader(t,this.TYPE_POSITION_UCOLOR)},programForKey:function(t){return this._programs[t]},getProgram:function(t){return this._programs[t]},addProgram:function(t,e){this._programs[e]=t}},cc.GLProgram=cc.Class.extend({_glContext:null,_programObj:null,_vertShader:null,_fragShader:null,_uniforms:null,_hashForUniforms:null,_usesTime:!1,_updateUniformLocation:function(t){if(!t)return!1;var e,i=this._hashForUniforms[t];if(i){e=!1;for(var n=arguments.length-1,r=0;r<n;++r)arguments[r+1]!==i[r]&&(i[r]=arguments[r+1],e=!0)}else i=[arguments[1],arguments[2],arguments[3],arguments[4]],this._hashForUniforms[t]=i,e=!0;return e},_description:function(){return"<CCGLProgram = "+this.toString()+" | Program = "+this._programObj.toString()+", VertexShader = "+this._vertShader.toString()+", FragmentShader = "+this._fragShader.toString()+">"},_compileShader:function(t,e,i){if(!i||!t)return!1;var n=cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n";i=n+"uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n"+i,this._glContext.shaderSource(t,i),this._glContext.compileShader(t);var r=this._glContext.getShaderParameter(t,this._glContext.COMPILE_STATUS);return r||(cc.log("cocos2d: ERROR: Failed to compile shader:\n"+this._glContext.getShaderSource(t)),e===this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog())),r===!0},ctor:function(t,e,i){this._uniforms={},this._hashForUniforms={},this._glContext=i||cc._renderContext,t&&e&&this.init(t,e)},destroyProgram:function(){this._vertShader=null,this._fragShader=null,this._uniforms=null,this._hashForUniforms=null,this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(t,e){var i=this._glContext;this._programObj=i.createProgram(),this._vertShader=null,this._fragShader=null,t&&(this._vertShader=i.createShader(i.VERTEX_SHADER),this._compileShader(this._vertShader,i.VERTEX_SHADER,t)||cc.log("cocos2d: ERROR: Failed to compile vertex shader")),e&&(this._fragShader=i.createShader(i.FRAGMENT_SHADER),this._compileShader(this._fragShader,i.FRAGMENT_SHADER,e)||cc.log("cocos2d: ERROR: Failed to compile fragment shader")),this._vertShader&&i.attachShader(this._programObj,this._vertShader),cc.checkGLErrorDebug(),this._fragShader&&i.attachShader(this._programObj,this._fragShader);for(var n in this._hashForUniforms)delete this._hashForUniforms[n];return cc.checkGLErrorDebug(),!0},initWithString:function(t,e){return this.initWithVertexShaderByteArray(t,e)},initWithVertexShaderFilename:function(t,e){var i=cc.loader.getRes(t);if(!i)throw new Error("Please load the resource firset : "+t);var n=cc.loader.getRes(e);if(!n)throw new Error("Please load the resource firset : "+e);return this.initWithVertexShaderByteArray(i,n)},init:function(t,e){return this.initWithVertexShaderFilename(t,e)},addAttribute:function(t,e){this._glContext.bindAttribLocation(this._programObj,e,t)},link:function(){if(!this._programObj)return cc.log("cc.GLProgram.link(): Cannot link invalid program"),!1;if(this._glContext.linkProgram(this._programObj),this._vertShader&&this._glContext.deleteShader(this._vertShader),this._fragShader&&this._glContext.deleteShader(this._fragShader),this._vertShader=null,this._fragShader=null,cc.game.config[cc.game.CONFIG_KEY.debugMode]){var t=this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS);if(!t)return cc.log("cocos2d: ERROR: Failed to link program: "+this._glContext.getProgramInfoLog(this._programObj)),cc.glDeleteProgram(this._programObj),this._programObj=null,!1}return!0},use:function(){cc.glUseProgram(this._programObj)},updateUniforms:function(){this._uniforms[cc.UNIFORM_PMATRIX_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_PMATRIX_S),this._uniforms[cc.UNIFORM_MVMATRIX_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVMATRIX_S),this._uniforms[cc.UNIFORM_MVPMATRIX_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVPMATRIX_S),this._uniforms[cc.UNIFORM_TIME_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_TIME_S),this._uniforms[cc.UNIFORM_SINTIME_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SINTIME_S),this._uniforms[cc.UNIFORM_COSTIME_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_COSTIME_S),this._usesTime=null!=this._uniforms[cc.UNIFORM_TIME_S]||null!=this._uniforms[cc.UNIFORM_SINTIME_S]||null!=this._uniforms[cc.UNIFORM_COSTIME_S],this._uniforms[cc.UNIFORM_RANDOM01_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_RANDOM01_S),this._uniforms[cc.UNIFORM_SAMPLER_S]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SAMPLER_S),this.use(),this.setUniformLocationWith1i(this._uniforms[cc.UNIFORM_SAMPLER_S],0)},_addUniformLocation:function(t){var e=this._glContext.getUniformLocation(this._programObj,t);this._uniforms[t]=e},getUniformLocationForName:function(t){if(!t)throw new Error("cc.GLProgram.getUniformLocationForName(): uniform name should be non-null");if(!this._programObj)throw new Error("cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized");var e=this._uniforms[t]||this._glContext.getUniformLocation(this._programObj,t);return e},getUniformMVPMatrix:function(){return this._uniforms[cc.UNIFORM_MVPMATRIX_S]},getUniformSampler:function(){return this._uniforms[cc.UNIFORM_SAMPLER_S]},setUniformLocationWith1i:function(t,e){var i=this._glContext;if("string"==typeof t){var n=this._updateUniformLocation(t,e);if(n){var r=this.getUniformLocationForName(t);i.uniform1i(r,e)}}else i.uniform1i(t,e)},setUniformLocationWith2i:function(t,e,i){var n=this._glContext;if("string"==typeof t){var r=this._updateUniformLocation(t,e,i);if(r){var o=this.getUniformLocationForName(t);n.uniform2i(o,e,i)}}else n.uniform2i(t,e,i)},setUniformLocationWith3i:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){var o=this._updateUniformLocation(t,e,i,n);if(o){var s=this.getUniformLocationForName(t);r.uniform3i(s,e,i,n)}}else r.uniform3i(t,e,i,n)},setUniformLocationWith4i:function(t,e,i,n,r){var o=this._glContext;if("string"==typeof t){var s=this._updateUniformLocation(t,e,i,n,r);if(s){var c=this.getUniformLocationForName(t);o.uniform4i(c,e,i,n,r)}}else o.uniform4i(t,e,i,n,r)},setUniformLocationWith2iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2iv(i,e)},setUniformLocationWith3iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3iv(i,e)},setUniformLocationWith4iv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4iv(i,e)},setUniformLocationI32:function(t,e){this.setUniformLocationWith1i(t,e)},setUniformLocationWith1f:function(t,e){var i=this._glContext;if("string"==typeof t){var n=this._updateUniformLocation(t,e);if(n){var r=this.getUniformLocationForName(t);i.uniform1f(r,e)}}else i.uniform1f(t,e)},setUniformLocationWith2f:function(t,e,i){var n=this._glContext;if("string"==typeof t){var r=this._updateUniformLocation(t,e,i);if(r){var o=this.getUniformLocationForName(t);n.uniform2f(o,e,i)}}else n.uniform2f(t,e,i)},setUniformLocationWith3f:function(t,e,i,n){var r=this._glContext;if("string"==typeof t){var o=this._updateUniformLocation(t,e,i,n);if(o){var s=this.getUniformLocationForName(t);r.uniform3f(s,e,i,n)}}else r.uniform3f(t,e,i,n)},setUniformLocationWith4f:function(t,e,i,n,r){var o=this._glContext;if("string"==typeof t){var s=this._updateUniformLocation(t,e,i,n,r);if(s){var c=this.getUniformLocationForName(t);o.uniform4f(c,e,i,n,r)}}else o.uniform4f(t,e,i,n,r)},setUniformLocationWith2fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform2fv(i,e)},setUniformLocationWith3fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform3fv(i,e)},setUniformLocationWith4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniform4fv(i,e)},setUniformLocationWithMatrix4fv:function(t,e){var i="string"==typeof t?this.getUniformLocationForName(t):t;this._glContext.uniformMatrix4fv(i,!1,e)},setUniformLocationF32:function(){if(!(arguments.length<2))switch(arguments.length){case 2:this.setUniformLocationWith1f(arguments[0],arguments[1]);break;case 3:this.setUniformLocationWith2f(arguments[0],arguments[1],arguments[2]);break;case 4:this.setUniformLocationWith3f(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:this.setUniformLocationWith4f(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}},setUniformsForBuiltins:function(){var t=new cc.math.Matrix4,e=new cc.math.Matrix4,i=new cc.math.Matrix4;if(cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,t),cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,e),cc.kmMat4Multiply(i,t,e),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],t.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime){var n=cc.director,r=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S],r/10,r,2*r,4*r),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S],r/8,r/4,r/2,Math.sin(r)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S],r/8,r/4,r/2,Math.cos(r))}this._uniforms[cc.UNIFORM_RANDOM01_S]!==-1&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(t){if(t&&t._renderCmd){var e=new cc.math.Matrix4,i=new cc.math.Matrix4;if(cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,e),cc.kmMat4Multiply(i,e,t._renderCmd._stackMatrix),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],e.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],t._renderCmd._stackMatrix.mat,1),this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],i.mat,1),this._usesTime){var n=cc.director,r=n.getTotalFrames()*n.getAnimationInterval();this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME_S],r/10,r,2*r,4*r),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME_S],r/8,r/4,r/2,Math.sin(r)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME_S],r/8,r/4,r/2,Math.cos(r))}this._uniforms[cc.UNIFORM_RANDOM01_S]!==-1&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01_S],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],!1,cc.getMat4MultiplyValue(cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(t){cc.kmMat4Multiply(t,cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX_S],!1,t.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],!1,cc.modelview_matrix_stack.top.mat),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],!1,cc.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(t){if(!t)throw new Error("modelView matrix is undefined.");this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX_S],!1,t.mat),this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],!1,cc.projection_matrix_stack.top.mat)},_updateProjectionUniform:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX_S],!1,cc.projection_matrix_stack.top.mat)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._vertShader=null,this._fragShader=null,this._uniforms.length=0,this._glContext.deleteProgram(this._programObj),this._programObj=null;for(var t in this._hashForUniforms)this._hashForUniforms[t].length=0,delete this._hashForUniforms[t]},getProgram:function(){return this._programObj},retain:function(){},release:function(){}}),cc.GLProgram.create=function(t,e){return new cc.GLProgram(t,e)},cc.GLProgram._highpSupported=null,cc.GLProgram._isHighpSupported=function(){if(null==cc.GLProgram._highpSupported){var t=cc._renderContext,e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);cc.GLProgram._highpSupported=0!==e.precision}return cc.GLProgram._highpSupported},cc.setProgram=function(t,e){t.shaderProgram=e;var i=t.children;if(i)for(var n=0;n<i.length;n++)cc.setProgram(i[n],e)},cc._currentProjectionMatrix=-1,cc.ENABLE_GL_STATE_CACHE){cc.MAX_ACTIVETEXTURE=16,cc._currentShaderProgram=-1,cc._currentBoundTexture=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0,cc.TEXTURE_ATLAS_USE_VAO&&(cc._uVAO=0);var _currBuffers={};WebGLRenderingContext.prototype.glBindBuffer=WebGLRenderingContext.prototype.bindBuffer,WebGLRenderingContext.prototype.bindBuffer=function(t,e){return _currBuffers[t]===e||(this.glBindBuffer(t,e),_currBuffers[t]=e,!1)},WebGLRenderingContext.prototype.glEnableVertexAttribArray=WebGLRenderingContext.prototype.enableVertexAttribArray,WebGLRenderingContext.prototype.enableVertexAttribArray=function(t){t===cc.VERTEX_ATTRIB_FLAG_POSITION?this._vertexAttribPosition||(this.glEnableVertexAttribArray(t),this._vertexAttribPosition=!0):t===cc.VERTEX_ATTRIB_FLAG_COLOR?this._vertexAttribColor||(this.glEnableVertexAttribArray(t),this._vertexAttribColor=!0):t===cc.VERTEX_ATTRIB_FLAG_TEX_COORDS?this._vertexAttribTexCoords||(this.glEnableVertexAttribArray(t),this._vertexAttribTexCoords=!0):this.glEnableVertexAttribArray(t)},WebGLRenderingContext.prototype.glDisableVertexAttribArray=WebGLRenderingContext.prototype.disableVertexAttribArray,WebGLRenderingContext.prototype.disableVertexAttribArray=function(t){t===cc.VERTEX_ATTRIB_FLAG_COLOR?this._vertexAttribColor&&(this.glDisableVertexAttribArray(t),this._vertexAttribColor=!1):t===cc.VERTEX_ATTRIB_FLAG_TEX_COORDS?this._vertexAttribTexCoords&&(this.glDisableVertexAttribArray(t),this._vertexAttribTexCoords=!1):0!==t&&this.glDisableVertexAttribArray(t)}}cc.glInvalidateStateCache=function(){if(cc.kmGLFreeAll(),cc._currentProjectionMatrix=-1,cc.ENABLE_GL_STATE_CACHE){cc._currentShaderProgram=-1;for(var t=0;t<cc.MAX_ACTIVETEXTURE;t++)cc._currentBoundTexture[t]=-1;cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0}},cc.glUseProgram=cc.ENABLE_GL_STATE_CACHE?function(t){t!==cc._currentShaderProgram&&(cc._currentShaderProgram=t,cc._renderContext.useProgram(t))}:function(t){cc._renderContext.useProgram(t)},cc.glDeleteProgram=function(t){cc.ENABLE_GL_STATE_CACHE&&t===cc._currentShaderProgram&&(cc._currentShaderProgram=-1),gl.deleteProgram(t)},cc.setBlending=function(t,e){var i=cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),cc._renderContext.blendFunc(t,e))},cc.glBlendFunc=cc.ENABLE_GL_STATE_CACHE?function(t,e){t===cc._blendingSource&&e===cc._blendingDest||(cc._blendingSource=t,cc._blendingDest=e,cc.setBlending(t,e))}:cc.setBlending,cc.glBlendFuncForParticle=function(t,e){if(t!==cc._blendingSource||e!==cc._blendingDest){cc._blendingSource=t,cc._blendingDest=e;var i=cc._renderContext;t===i.ONE&&e===i.ZERO?i.disable(i.BLEND):(i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,e,t,e))}},cc.glBlendResetToCache=function(){var t=cc._renderContext;t.blendEquation(t.FUNC_ADD),cc.ENABLE_GL_STATE_CACHE?cc.setBlending(cc._blendingSource,cc._blendingDest):cc.setBlending(t.BLEND_SRC,t.BLEND_DST)},cc.setProjectionMatrixDirty=function(){cc._currentProjectionMatrix=-1},cc.glBindTexture2D=function(t){cc.glBindTexture2DN(0,t)},cc.glBindTexture2DN=cc.ENABLE_GL_STATE_CACHE?function(t,e){if(cc._currentBoundTexture[t]!==e){cc._currentBoundTexture[t]=e;var i=cc._renderContext;i.activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)}}:function(t,e){var i=cc._renderContext;i.activeTexture(i.TEXTURE0+t),e?i.bindTexture(i.TEXTURE_2D,e._webTextureObj):i.bindTexture(i.TEXTURE_2D,null)},cc.glDeleteTexture=function(t){cc.glDeleteTextureN(0,t)},cc.glDeleteTextureN=function(t,e){cc.ENABLE_GL_STATE_CACHE&&e===cc._currentBoundTexture[t]&&(cc._currentBoundTexture[t]=-1),cc._renderContext.deleteTexture(e._webTextureObj)},cc.glBindVAO=function(t){cc.TEXTURE_ATLAS_USE_VAO&&cc.ENABLE_GL_STATE_CACHE&&cc._uVAO!==t&&(cc._uVAO=t)},cc.glEnable=function(t){cc.ENABLE_GL_STATE_CACHE};cc.IMAGE_FORMAT_JPEG=0,cc.IMAGE_FORMAT_PNG=1,cc.IMAGE_FORMAT_RAWDATA=9,cc.NextPOT=function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1},cc.RenderTexture=cc.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_texture:null,_pixelFormat:0,clearStencilVal:0,_clearColor:null,_className:"RenderTexture",ctor:function(t,e,i,n){cc.Node.prototype.ctor.call(this),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this._clearColor=new cc.Color(0,0,0,255),void 0!==t&&void 0!==e&&(i=i||cc.Texture2D.PIXEL_FORMAT_RGBA8888,n=n||0,this.initWithWidthAndHeight(t,e,i,n)),this.setAnchorPoint(0,0)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.RenderTexture.CanvasRenderCmd(this):new cc.RenderTexture.WebGLRenderCmd(this)},cleanup:function(){cc.Node.prototype.onExit.call(this),this._renderCmd.cleanup()},getSprite:function(){return this.sprite},setSprite:function(t){this.sprite=t},setVirtualViewport:function(t,e,i){this._renderCmd.setVirtualViewport(t,e,i)},initWithWidthAndHeight:function(t,e,i,n){return this._renderCmd.initWithWidthAndHeight(t,e,i,n)},begin:function(){cc.renderer._turnToCacheMode(this.__instanceId),this._renderCmd.begin()},beginWithClear:function(t,e,i,n,r,o){var s=cc._renderContext;r=r||s.COLOR_BUFFER_BIT,o=o||s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT,this._beginWithClear(t,e,i,n,r,o,s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT|s.STENCIL_BUFFER_BIT)},_beginWithClear:function(t,e,i,n,r,o,s){this.begin(),this._renderCmd._beginWithClear(t,e,i,n,r,o,s)},end:function(){this._renderCmd.end()},clear:function(t,e,i,n){this.beginWithClear(t,e,i,n),this.end()},clearRect:function(t,e,i,n){this._renderCmd.clearRect(t,e,i,n)},clearDepth:function(t){this._renderCmd.clearDepth(t)},clearStencil:function(t){this._renderCmd.clearStencil(t)},getClearFlags:function(){return this.clearFlags},setClearFlags:function(t){this.clearFlags=t},getClearColor:function(){return this._clearColor},setClearColor:function(t){var e=this._clearColor;e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,this._renderCmd.updateClearColor(t)},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(t){this.clearDepthVal=t},getClearStencil:function(){return this.clearStencilVal},setClearStencil:function(t){this.clearStencilVal=t},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(t){this.autoDraw=t},saveToFile:function(t,e){cc.log("saveToFile isn't supported on Cocos2d-Html5")},newCCImage:function(t){return cc.log("saveToFile isn't supported on cocos2d-html5"),null},listenToBackground:function(t){},listenToForeground:function(t){}});var _p=cc.RenderTexture.prototype;_p.clearColorVal,cc.defineGetterSetter(_p,"clearColorVal",_p.getClearColor,_p.setClearColor),cc.RenderTexture.create=function(t,e,i,n){return new cc.RenderTexture(t,e,i,n)},function(){cc.RenderTexture.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._clearColorStr="rgba(255,255,255,1)",this._cacheCanvas=document.createElement("canvas"),this._cacheContext=new cc.CanvasContextWrapper(this._cacheCanvas.getContext("2d"))};var t=cc.RenderTexture.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.RenderTexture.CanvasRenderCmd,t.cleanup=function(){this._cacheContext=null,this._cacheCanvas=null},t.clearStencil=function(t){},t.setVirtualViewport=function(t,e,i){},t.updateClearColor=function(t){this._clearColorStr="rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")"},t.initWithWidthAndHeight=function(t,e,i,n){var r=this._node,o=this._cacheCanvas,s=cc.contentScaleFactor();o.width=0|t*s,o.height=0|e*s;var c=new cc.Texture2D;c.initWithElement(o),c.handleLoadedTexture();var a=r.sprite=new cc.Sprite(c);return a.setBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA),r.autoDraw=!1,r.addChild(a),!0},t.begin=function(){},t._beginWithClear=function(t,e,i,n,r,o,s){t=t||0,e=e||0,i=i||0,n=isNaN(n)?255:n;var c=this._cacheContext.getContext(),a=this._cacheCanvas;c.setTransform(1,0,0,1,0,0),this._cacheContext.setFillStyle("rgba("+(0|t)+","+(0|e)+","+(0|i)+","+n/255+")"),c.clearRect(0,0,a.width,a.height),c.fillRect(0,0,a.width,a.height)},t.end=function(){var t=this._node,e=cc.contentScaleFactor();cc.renderer._renderingToCacheCanvas(this._cacheContext,t.__instanceId,e,e);var i=t.sprite._renderCmd;i._notifyRegionStatus&&i._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty)},t.clearRect=function(t,e,i,n){this._cacheContext.clearRect(t,e,i,-n)},t.clearDepth=function(t){cc.log("clearDepth isn't supported on Cocos2d-Html5")},t.visit=function(t){var e=this._node;this._syncStatus(t),e.sprite.visit(this),this._dirtyFlag=0}}();!function(){cc.RenderTexture.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._fBO=null,this._oldFBO=null,this._textureCopy=null,this._depthRenderBuffer=null,this._rtTextureRect=new cc.Rect,this._fullRect=new cc.Rect,this._fullViewport=new cc.Rect};var t=cc.RenderTexture.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.RenderTexture.WebGLRenderCmd,t.setVirtualViewport=function(t,e,i){this._rtTextureRect.x=t.x,this._rtTextureRect.y=t.y,this._fullRect=e,this._fullViewport=i},t.needDraw=function(){return this._needDraw&&this._node.autoDraw},t.rendering=function(t){var e=t||cc._renderContext,i=this._node;if(i.autoDraw){i.begin();var n=i.clearFlags;if(n){var r=[0,0,0,0],o=0,s=0;n&e.COLOR_BUFFER_BIT&&(r=e.getParameter(e.COLOR_CLEAR_VALUE),e.clearColor(i._clearColor.r/255,i._clearColor.g/255,i._clearColor.b/255,i._clearColor.a/255)),n&e.DEPTH_BUFFER_BIT&&(o=e.getParameter(e.DEPTH_CLEAR_VALUE),e.clearDepth(i.clearDepthVal)),n&e.STENCIL_BUFFER_BIT&&(s=e.getParameter(e.STENCIL_CLEAR_VALUE),e.clearStencil(i.clearStencilVal)),e.clear(n),n&e.COLOR_BUFFER_BIT&&e.clearColor(r[0],r[1],r[2],r[3]),n&e.DEPTH_BUFFER_BIT&&e.clearDepth(o),n&e.STENCIL_BUFFER_BIT&&e.clearStencil(s)}i.sortAllChildren();for(var c=i._children,a=0;a<c.length;a++){var l=c[a];l!==i.sprite&&l._renderCmd.visit(i.sprite._renderCmd)}i.end()}},t.clearStencil=function(t){var e=cc._renderContext,i=e.getParameter(e.STENCIL_CLEAR_VALUE);e.clearStencil(t),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(i)},t.cleanup=function(){this._node;this._textureCopy=null;var t=cc._renderContext;t.deleteFramebuffer(this._fBO),this._depthRenderBuffer&&t.deleteRenderbuffer(this._depthRenderBuffer)},t.updateClearColor=function(t){},t.initWithWidthAndHeight=function(t,e,i,n){var r=this._node;i===cc.Texture2D.PIXEL_FORMAT_A8&&cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;");var o=cc._renderContext,s=cc.contentScaleFactor();this._fullRect=new cc.Rect(0,0,t,e),this._fullViewport=new cc.Rect(0,0,t,e),t=0|t*s,e=0|e*s,this._oldFBO=o.getParameter(o.FRAMEBUFFER_BINDING);var c,a;cc.configuration.supportsNPOT()?(c=t,a=e):(c=cc.NextPOT(t),a=cc.NextPOT(e));for(var l=c*a*4,h=new Uint8Array(l),u=0;u<c*a*4;u++)h[u]=0;this._pixelFormat=i;var d=r._texture=new cc.Texture2D;if(!r._texture)return!1;d.initWithData(h,r._pixelFormat,c,a,cc.size(t,e));var _=o.getParameter(o.RENDERBUFFER_BINDING);if(cc.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=new cc.Texture2D,!this._textureCopy)return!1;this._textureCopy.initWithData(h,r._pixelFormat,c,a,cc.size(t,e))}this._fBO=o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,this._fBO),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,d._webTextureObj,0),0!==n&&(this._depthRenderBuffer=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,this._depthRenderBuffer),o.renderbufferStorage(o.RENDERBUFFER,n,c,a),n===o.DEPTH_STENCIL?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):n===o.STENCIL_INDEX||n===o.STENCIL_INDEX8?o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer):n===o.DEPTH_COMPONENT16&&o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this._depthRenderBuffer)),o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&cc.log("Could not attach texture to the framebuffer"),d.setAliasTexParameters();var p=r.sprite=new cc.Sprite(d);return p.scaleY=-1,p.setBlendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.bindRenderbuffer(o.RENDERBUFFER,_),o.bindFramebuffer(o.FRAMEBUFFER,this._oldFBO),r.autoDraw=!1,r.addChild(p),!0},t.begin=function(){var t=this._node;cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix();var e=cc._renderContext,i=cc.director;i.setProjection(i.getProjection());var n=t._texture.getContentSizeInPixels(),r=cc.director.getWinSizeInPixels(),o=r.width/n.width,s=r.height/n.height,c=cc.math.Matrix4.createOrthographicProjection(-1/o,1/o,-1/s,1/s,-1,1);cc.kmGLMultMatrix(c);var a=new cc.Rect(0,0,0,0);a.width=this._fullViewport.width,a.height=this._fullViewport.height;var l=a.width/this._fullRect.width,h=a.height/this._fullRect.height;a.x=(this._fullRect.x-this._rtTextureRect.x)*l,a.y=(this._fullRect.y-this._rtTextureRect.y)*h,e.viewport(a.x,a.y,a.width,a.height),this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this._fBO),cc.configuration.checkForGLExtension("GL_QCOM")&&(e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._textureCopy._webTextureObj,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t._texture._webTextureObj,0))},t._beginWithClear=function(t,e,i,n,r,o,s){t/=255,e/=255,i/=255,n/=255;var c=cc._renderContext,a=[0,0,0,0],l=0,h=0;s&c.COLOR_BUFFER_BIT&&(a=c.getParameter(c.COLOR_CLEAR_VALUE),c.clearColor(t,e,i,n)),s&c.DEPTH_BUFFER_BIT&&(l=c.getParameter(c.DEPTH_CLEAR_VALUE),c.clearDepth(r)),s&c.STENCIL_BUFFER_BIT&&(h=c.getParameter(c.STENCIL_CLEAR_VALUE),c.clearStencil(o)),c.clear(s),s&c.COLOR_BUFFER_BIT&&c.clearColor(a[0],a[1],a[2],a[3]),s&c.DEPTH_BUFFER_BIT&&c.clearDepth(l),s&c.STENCIL_BUFFER_BIT&&c.clearStencil(h)},t.end=function(){var t=this._node;cc.renderer._renderingToBuffer(t.__instanceId);var e=cc._renderContext,i=cc.director;e.bindFramebuffer(e.FRAMEBUFFER,this._oldFBO),i.setViewport(),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix()},t.clearRect=function(t,e,i,n){},t.clearDepth=function(t){var e=this._node;e.begin();var i=cc._renderContext,n=i.getParameter(i.DEPTH_CLEAR_VALUE);i.clearDepth(t),i.clear(i.DEPTH_BUFFER_BIT),i.clearDepth(n),e.end()},t.visit=function(t){var e=this._node;e._visible&&(cc.kmGLPushMatrix(),this._syncStatus(t),cc.renderer.pushRenderCommand(this),e.sprite.visit(this),this._dirtyFlag=0,cc.kmGLPopMatrix())}}();cc.SpriteBatchNode=cc.Node.extend({_blendFunc:null,_texture:null,_className:"SpriteBatchNode",ctor:function(t){cc.Node.prototype.ctor.call(this),this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);var e;cc.isString(t)?(e=cc.textureCache.getTextureForKey(t),e||(e=cc.textureCache.addImage(t))):t instanceof cc.Texture2D&&(e=t),e&&this.initWithTexture(e)},addSpriteWithoutQuad:function(t,e,i){return this.addChild(t,e,i),this},getTextureAtlas:function(){return null},setTextureAtlas:function(t){},getDescendants:function(){return this._children},initWithFile:function(t,e){var i=cc.textureCache.getTextureForKey(t);return i||(i=cc.textureCache.addImage(t)),this.initWithTexture(i,e)},init:function(t,e){var i=cc.textureCache.getTextureForKey(t);return i||(i=cc.textureCache.addImage(t)),this.initWithTexture(i,e)},increaseAtlasCapacity:function(){},removeChildAtIndex:function(t,e){this.removeChild(this._children[t],e)},rebuildIndexInOrder:function(t,e){return e},highestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.highestAtlasIndexInChild(e[e.length-1]):t.zIndex},lowestAtlasIndexInChild:function(t){var e=t.children;return e&&0!==e.length?this.lowestAtlasIndexInChild(e[e.length-1]):t.zIndex},atlasIndexForChild:function(t){return t.zIndex},reorderBatch:function(t){this._reorderChildDirty=t},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:this._blendFunc={src:t,dst:e}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},updateQuadFromSprite:function(t,e){return cc.assert(t,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),t instanceof cc.Sprite?(t.dirty=!0,void t._renderCmd.transform(this._renderCmd,!0)):void cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(t,e){this.addChild(t,e)},insertChild:function(t,e){this.addChild(t,e)},appendChild:function(t){this.sortAllChildren();this._children[this._children.length-1]._localZOrder;this.addChild(t.lastLocalZOrder+1)},removeSpriteFromAtlas:function(t,e){this.removeChild(t,e)},initWithTexture:function(t){return this.setTexture(t),!0},getTexture:function(){return this._texture},setTexture:function(t){if(this._texture=t,t._textureLoaded){var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setTexture(t)}else t.addEventListener("load",function(){var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setTexture(t)},this)},setShaderProgram:function(t){this._renderCmd.setShaderProgram(t);var e,i=this._children,n=i.length;for(e=0;e<n;++e)i[e].setShaderProgram(t)},addChild:function(t,e,i){cc.assert(void 0!==t,cc._LogInfos.CCSpriteBatchNode_addChild_3),this._isValidChild(t)&&(e=void 0===e?t.zIndex:e,i=void 0===i?t.tag:i,cc.Node.prototype.addChild.call(this,t,e,i),this._renderCmd._shaderProgram&&(t.shaderProgram=this._renderCmd._shaderProgram))},_isValidChild:function(t){return t instanceof cc.Sprite?t.texture===this._texture||(cc.log(cc._LogInfos.Sprite_addChild_5),!1):(cc.log(cc._LogInfos.Sprite_addChild_4),!1)}});var _p=cc.SpriteBatchNode.prototype;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.defineGetterSetter(_p,"shaderProgram",_p.getShaderProgram,_p.setShaderProgram),cc.SpriteBatchNode.create=function(t){return new cc.SpriteBatchNode(t)},cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create;cc.LabelAtlas=cc.AtlasNode.extend({_string:null,_mapStartChar:null,_textureLoaded:!1,_className:"LabelAtlas",ctor:function(t,e,i,n,r){cc.AtlasNode.prototype.ctor.call(this),this._renderCmd.setCascade(),e&&cc.LabelAtlas.prototype.initWithString.call(this,t,e,i,n,r)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.LabelAtlas.WebGLRenderCmd(this):new cc.LabelAtlas.CanvasRenderCmd(this)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},initWithString:function(t,e,i,n,r){var o,s,c,a,l=t+"";if(void 0===i){var h=cc.loader.getRes(e);if(1!==parseInt(h.version,10))return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;o=cc.path.changeBasename(e,h.textureFilename);var u=cc.contentScaleFactor();s=parseInt(h.itemWidth,10)/u,c=parseInt(h.itemHeight,10)/u,a=String.fromCharCode(parseInt(h.firstChar,10))}else o=e,s=i||0,c=n||0,a=r||" ";var d=null;d=o instanceof cc.Texture2D?o:cc.textureCache.addImage(o);var _=d.isLoaded();return this._textureLoaded=_,_||(this._string=l,d.addEventListener("load",function(t){this.initWithTexture(d,s,c,l.length),this.string=this._string,this.setColor(this._renderCmd._displayedColor),this.dispatchEvent("load")},this)),!!this.initWithTexture(d,s,c,l.length)&&(this._mapStartChar=a,this.string=l,!0)},setColor:function(t){cc.AtlasNode.prototype.setColor.call(this,t),this._renderCmd.updateAtlasValues()},getString:function(){return this._string},addChild:function(t,e,i){this._renderCmd._addChild(t),cc.Node.prototype.addChild.call(this,t,e,i)},updateAtlasValues:function(){this._renderCmd.updateAtlasValues()},setString:function(t){t=String(t);var e=t.length;this._string=t,this.setContentSize(e*this._itemWidth,this._itemHeight),this._renderCmd.setString(t),this._renderCmd.updateAtlasValues(),this.quadsToDraw=e}}),function(){var t=cc.LabelAtlas.prototype;cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity),cc.defineGetterSetter(t,"color",t.getColor,t.setColor),t.string,cc.defineGetterSetter(t,"string",t.getString,t.setString)}(),cc.LabelAtlas.create=function(t,e,i,n,r){return new cc.LabelAtlas(t,e,i,n,r)},function(){cc.LabelAtlas.CanvasRenderCmd=function(t){cc.AtlasNode.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=cc.LabelAtlas.CanvasRenderCmd.prototype=Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);t.constructor=cc.LabelAtlas.CanvasRenderCmd,t.setCascade=function(){var t=this._node;t._cascadeOpacityEnabled=!0,t._cascadeColorEnabled=!1},t.updateAtlasValues=function(){for(var t=this._node,e=t._string||"",i=e.length,n=this._textureToRender,r=t._itemWidth,o=t._itemHeight,s=0,c=-1;s<i;s++){var a=e.charCodeAt(s)-t._mapStartChar.charCodeAt(0),l=parseInt(a%t._itemsPerRow,10),h=parseInt(a/t._itemsPerRow,10);if(!(l<0||h<0)){var u=cc.rect(l*r,h*o,r,o),d=n._contentSize;if(!(u.x<0||u.y<0||u.x+u.width>d.width||u.y+u.height>d.height)){c++;var _=e.charCodeAt(s),p=t.getChildByTag(s);p?32===_?(p.init(),p.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(p.initWithTexture(n,u),p.visible=!0):(p=new cc.Sprite,32===_?(p.init(),p.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):p.initWithTexture(n,u),cc.Node.prototype.addChild.call(t,p,0,s)),p.setPosition(c*r+r/2,o/2)}}}this.updateContentSize(s,c+1)},t.updateContentSize=function(t,e){var i=this._node,n=i._contentSize;t!==e&&t*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(e*i._itemWidth,i._itemHeight)},t.setString=function(t){var e=this._node;if(e._children)for(var i=e._children,n=i.length,r=0;r<n;r++){var o=i[r];o&&!o._lateChild&&(o.visible=!1)}},t._addChild=function(){child._lateChild=!0}}(),cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.LabelBMFont.WebGLRenderCmd(this):new cc.LabelBMFont.CanvasRenderCmd(this)},_setString:function(t,e){e?this._initialString=t:this._string=t;var i=this._children;if(i)for(var n=0;n<i.length;n++){var r=i[n];r&&r.setVisible(!1)}this._textureLoaded&&(this.createFontChars(),e&&this.updateLabel())},ctor:function(t,e,i,n,r){cc.SpriteBatchNode.prototype.ctor.call(this),this._imageOffset=cc.p(0,0),this._cascadeColorEnabled=!0,this._cascadeOpacityEnabled=!0,this.initWithString(t,e,i,n,r)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(t){this._opacityModifyRGB=t;var e=this._children;if(e)for(var i=0;i<e.length;i++){var n=e[i];n&&(n.opacityModifyRGB=this._opacityModifyRGB)}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(t,e,i,n,r){var o=this,s=t||"";o._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");var c;if(e){var a=cc.loader.getRes(e);if(!a)return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1;o._config=a,o._fntFile=e,c=cc.textureCache.addImage(a.atlasName);var l=c.isLoaded();o._textureLoaded=l,l||c.addEventListener("load",function(t){var e=this;e._textureLoaded=!0,e.initWithTexture(t,e._initialString.length),e.setString(e._initialString,!0),e.dispatchEvent("load")},o)}else{c=new cc.Texture2D;var h=new Image;c.initWithElement(h),o._textureLoaded=!1}return!!o.initWithTexture(c,s.length)&&(o._alignment=n||cc.TEXT_ALIGNMENT_LEFT,o._imageOffset=r||cc.p(0,0),o._width=void 0===i?-1:i,o._realOpacity=255,o._realColor=cc.color(255,255,255,255),o._contentSize.width=0,o._contentSize.height=0,o.setAnchorPoint(.5,.5),o.setString(s,!0),!0)},createFontChars:function(){var t=this,e=this._renderCmd,i=e._texture||this._texture,n=0,r=cc.size(0,0),o=0,s=1,c=t._string,a=c?c.length:0;if(0!==a){var l,h=t._config,u=h.kerningDict,d=h.commonHeight,_=h.fontDefDictionary;for(l=0;l<a-1;l++)10===c.charCodeAt(l)&&s++;var p,f=d*s,m=-(d-d*s),g=-1;for(l=0;l<a;l++){var y=c.charCodeAt(l);if(0!==y)if(10!==y){var v=u[g<<16|65535&y]||0;p=_[y],p||(cc.log("cocos2d: LabelBMFont: character not found "+c[l]),p={rect:{x:0,y:0,width:0,height:0},xOffset:0,yOffset:0,xAdvance:0});var T=cc.rect(p.rect.x,p.rect.y,p.rect.width,p.rect.height);T=cc.rectPixelsToPoints(T),T.x+=t._imageOffset.x,T.y+=t._imageOffset.y;var C=t.getChildByTag(l);C?e._updateCharTexture(C,T,y):(C=new cc.Sprite,C.initWithTexture(i,T,!1),C._newTextureWhenChangeColor=!0,this.addChild(C,0,l)),C.opacityModifyRGB=this._opacityModifyRGB,e._updateCharColorAndOpacity(C);var S=h.commonHeight-p.yOffset,x=cc.p(n+p.xOffset+.5*p.rect.width+v,m+S-.5*T.height*cc.contentScaleFactor());C.setPosition(cc.pointPixelsToPoints(x)),n+=p.xAdvance+v,g=y,o<n&&(o=n)}else n=0,m-=h.commonHeight}p&&p.xAdvance<p.rect.width?r.width=o-p.xAdvance+p.rect.width:r.width=o,r.height=f,t.setContentSize(cc.sizePixelsToPoints(r))}},updateString:function(t){var e=this,i=e._children;if(i)for(var n=0,r=i.length;n<r;n++){var o=i[n];o&&(o.visible=!1)}e._config&&e.createFontChars(),t||e.updateLabel()},getString:function(){return this._initialString},setString:function(t,e){t=String(t),null==e&&(e=!0),null!=t&&cc.isString(t)||(t+=""),this._initialString=t,this._setString(t,e)},_setStringForSetter:function(t){this.setString(t,!1)},setCString:function(t){this.setString(t,!0)},_getCharsWidth:function(t,e){if(e<=0)return 0;var i=this.getChildByTag(t),n=this.getChildByTag(t+e);return this._getLetterPosXLeft(n)-this._getLetterPosXLeft(i)},_checkWarp:function(t,e,i,n){for(var r=this,o=t[e],s=0,c=0;c<e;c++)s+=t[c].length;s=s+e-n;var a=r._getCharsWidth(s,t[e].length-1);if(a>i&&o.length>1){for(var l,h=o.length*(i/a)|0,u=o.substr(h),d=a-this._getCharsWidth(s+h,u.length-1),_=0,p=0;d>i&&p++<100;)h*=i/d,h|=0,u=o.substr(h),d=a-this._getCharsWidth(s+h,u.length-1);for(p=0;d<i&&p++<100;){if(u){var f=cc.LabelTTF._wordRex.exec(u);_=f?f[0].length:1,l=u}r._lineBreakWithoutSpaces&&(_=0),h+=_,u=o.substr(h),d=a-this._getCharsWidth(s+h,u.length-1)}h-=_,0===h&&(h=1,l=l.substr(1));var m,g=o.substr(0,h);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(l||u)&&(m=cc.LabelTTF._lastWordRex.exec(g),_=m?m[0].length:0,r._lineBreakWithoutSpaces&&(_=0),h-=_,l=o.substr(h),g=o.substr(0,h)),cc.LabelTTF._firsrEnglish.test(l)&&(m=cc.LabelTTF._lastEnglish.exec(g),m&&g!==m[0]&&(_=m[0].length,r._lineBreakWithoutSpaces&&(_=0),h-=_,l=o.substr(h),g=o.substr(0,h))),t[e]=l||u,t.splice(e,0,g)}},updateLabel:function(){var t=this;t.string=t._initialString;var e,i,n;if(t._width>0){var r=t.string.split("\n"),o="",s=0,c=0;for(e=0;e<r.length;e++)c=r.length,this._checkWarp(r,e,t._width*this._scaleX,s),c<r.length&&s++,e>0&&(o+="\n"),o+=r[e];o+=String.fromCharCode(0),t._setString(o,!1)}if(t._alignment!==cc.TEXT_ALIGNMENT_LEFT){e=0;for(var a=0,l=t._string.length,h=[],u=0;u<l;u++)if(10!==t._string[u].charCodeAt(0)&&0!==t._string[u].charCodeAt(0))h.push(t._string[e]);else{var d=0,_=h.length;if(0===_){a++;continue}var p=e+_-1+a;if(p<0)continue;var f=t.getChildByTag(p);if(null==f)continue;d=f.getPositionX()+f._getWidth()/2;var m=0;switch(t._alignment){case cc.TEXT_ALIGNMENT_CENTER:m=t.width/2-d/2;break;case cc.TEXT_ALIGNMENT_RIGHT:m=t.width-d}if(0!==m)for(i=0;i<_;i++)p=e+i+a,p<0||(n=t.getChildByTag(p),n&&(n.x+=m));e+=_,a++,h.length=0}}},setAlignment:function(t){this._alignment=t,this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(t){this._width=t,this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(t){this._lineBreakWithoutSpaces=t,this.updateLabel()},setScale:function(t,e){cc.Node.prototype.setScale.call(this,t,e),this.updateLabel()},setScaleX:function(t){cc.Node.prototype.setScaleX.call(this,t),this.updateLabel()},setScaleY:function(t){cc.Node.prototype.setScaleY.call(this,t),this.updateLabel()},setFntFile:function(t){var e=this;if(null!=t&&t!==e._fntFile){var i=cc.loader.getRes(t);if(!i)return void cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file");e._fntFile=t,e._config=i;var n=cc.textureCache.addImage(i.atlasName),r=n.isLoaded();e._textureLoaded=r,r?(e.setTexture(n),e.createFontChars()):n.addEventListener("load",function(t){var e=this;e._textureLoaded=!0,e.setTexture(t),e.createFontChars(),e._changeTextureColor(),e.updateLabel(),e.dispatchEvent("load")},e)}},getFntFile:function(){return this._fntFile},setTexture:function(t){this._texture=t,this._renderCmd.setTexture(t)},setAnchorPoint:function(t,e){cc.Node.prototype.setAnchorPoint.call(this,t,e),this.updateLabel()},_setAnchorX:function(t){cc.Node.prototype._setAnchorX.call(this,t),this.updateLabel()},_setAnchorY:function(t){cc.Node.prototype._setAnchorY.call(this,t),this.updateLabel()},_atlasNameFromFntFile:function(t){},_kerningAmountForFirst:function(t,e){var i=0,n=t<<16|65535&e;if(this._configuration.kerningDictionary){var r=this._configuration.kerningDictionary[n.toString()];r&&(i=r.amount)}return i},_getLetterPosXLeft:function(t){return t.getPositionX()*this._scaleX-t._getWidth()*this._scaleX*t._getAnchorX()},_getLetterPosXRight:function(t){return t.getPositionX()*this._scaleX+t._getWidth()*this._scaleX*t._getAnchorX()},_isspace_unicode:function(t){return t=t.charCodeAt(0),t>=9&&t<=13||32===t||133===t||160===t||5760===t||t>=8192&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},_utf8_trim_ws:function(t){var e=t.length;if(!(e<=0)){var i=e-1;if(this._isspace_unicode(t[i])){for(var n=i-1;n>=0&&this._isspace_unicode(t[n]);--n)i=n;this._utf8_trim_from(t,i)}}},_utf8_trim_from:function(t,e){var i=t.length;e>=i||e<0||t.splice(e,i)}}),function(){var t=cc.LabelBMFont.prototype;cc.EventHelper.prototype.apply(t),t.string,cc.defineGetterSetter(t,"string",t.getString,t._setStringForSetter),t.boundingWidth,cc.defineGetterSetter(t,"boundingWidth",t._getBoundingWidth,t.setBoundingWidth),t.textAlign,cc.defineGetterSetter(t,"textAlign",t._getAlignment,t.setAlignment),cc.defineGetterSetter(t,"texture",t.getTexture,t.setTexture)}(),cc.LabelBMFont.create=function(t,e,i,n,r){return new cc.LabelBMFont(t,e,i,n,r)};var _fntLoader={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(t){var e=t.match(this.ITEM_EXP),i={};if(e)for(var n=0,r=e.length;n<r;n++){var o=e[n],s=o.indexOf("="),c=o.substring(0,s),a=o.substring(s+1);a.match(this.INT_EXP)?a=parseInt(a):'"'===a[0]&&(a=a.substring(1,a.length-1)),i[c]=a}return i},parseFnt:function(t,e){var i=this,n={},r=i._parseStrToObj(t.match(i.INFO_EXP)[0]),o=r.padding.split(","),s=({left:parseInt(o[0]),top:parseInt(o[1]),right:parseInt(o[2]),bottom:parseInt(o[3])},i._parseStrToObj(t.match(i.COMMON_EXP)[0]));if(n.commonHeight=s.lineHeight,cc._renderType===cc.game.RENDER_TYPE_WEBGL){var c=cc.configuration.getMaxTextureSize();(s.scaleW>c.width||s.scaleH>c.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==s.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");var a=i._parseStrToObj(t.match(i.PAGE_EXP)[0]);0!==a.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found"),n.atlasName=cc.path.changeBasename(e,a.file);for(var l=t.match(i.CHAR_EXP),h=n.fontDefDictionary={},u=0,d=l.length;u<d;u++){var _=i._parseStrToObj(l[u]),p=_.id;h[p]={rect:{x:_.x,y:_.y,width:_.width,height:_.height},xOffset:_.xoffset,yOffset:_.yoffset,xAdvance:_.xadvance}}var f=n.kerningDict={},m=t.match(i.KERNING_EXP);if(m)for(var u=0,d=m.length;u<d;u++){var g=i._parseStrToObj(m[u]);f[g.first<<16|65535&g.second]=g.amount}return n},load:function(t,e,i,n){var r=this;cc.loader.loadTxt(t,function(t,i){return t?n(t):void n(null,r.parseFnt(i,e))})}};cc.loader.register(["fnt"],_fntLoader),function(){cc.LabelBMFont.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t)};var t=cc.LabelBMFont.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.LabelBMFont.CanvasRenderCmd,t._updateCharTexture=function(t,e,i){32===i?t.setTextureRect(e,!1,cc.size(0,0)):(t.setTextureRect(e,!1),t.visible=!0)},t._updateCharColorAndOpacity=function(t){t._displayedColor=this._displayedColor,t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),t._displayedOpacity=this._displayedOpacity,t._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},t.setTexture=function(t){for(var e=this._node,i=e._children,n=this._displayedColor,r=0;r<i.length;r++){var o=i[r],s=o._renderCmd,c=s._displayedColor;(e._texture===s._texture||c.r===n.r&&c.g===n.g&&c.b===n.b)&&(o.texture=t)}e._texture=t},t._changeTextureColor=function(){var t=this._node,e=t._texture,i=e.getContentSize(),n=t._texture,r=n.getHtmlElementObj(),o=this._displayedColor,s=cc.rect(0,0,r.width,r.height);if(e&&i.width>0){if(!r)return;var c=n._generateColorTexture(o.r,o.g,o.b,s);t.setTexture(c)}},t._updateChildrenDisplayedOpacity=function(t){cc.Node.prototype.updateDisplayedOpacity.call(t,this._displayedOpacity)},t._updateChildrenDisplayedColor=function(t){cc.Node.prototype.updateDisplayedColor.call(t,this._displayedColor)}}();!function(){cc.LabelAtlas.WebGLRenderCmd=function(t){cc.AtlasNode.WebGLRenderCmd.call(this,t),this._needDraw=!0};var t=cc.LabelAtlas.WebGLRenderCmd.prototype=Object.create(cc.AtlasNode.WebGLRenderCmd.prototype);t.constructor=cc.LabelAtlas.WebGLRenderCmd,t._updateColor=function(){if(this._colorF32Array){var t=this._displayedColor,e=this._displayedOpacity/255;this._node._opacityModifyRGB?(this._colorF32Array[0]=t.r*e/255,this._colorF32Array[1]=t.g*e/255,this._colorF32Array[2]=t.b*e/255,this._colorF32Array[3]=e):(this._colorF32Array[0]=t.r/255,this._colorF32Array[1]=t.g/255,this._colorF32Array[2]=t.b/255,this._colorF32Array[3]=e)}},t.setCascade=function(){var t=this._node;t._cascadeOpacityEnabled=!0,t._cascadeColorEnabled=!0},t.rendering=function(t){if(cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this,t),cc.LABELATLAS_DEBUG_DRAW){var e=this._node,i=e.getContentSize(),n=e.getBoundingBoxToWorld(),r=n.x,o=n.y;i.width=n.width,i.height=n.height;var s=[cc.p(r,o),cc.p(r+i.width,o),cc.p(i.width+r,i.height+o),cc.p(r,o+i.height)];cc._drawingUtil.drawPoly(s,4,!0)}},t.updateAtlasValues=function(){var t=this._node,e=t._string,i=e.length,n=this._textureAtlas,r=n.texture,o=r.pixelsWidth,s=r.pixelsHeight,c=t._itemWidth,a=t._itemHeight;t._ignoreContentScaleFactor||(c=t._itemWidth*cc.contentScaleFactor(),a=t._itemHeight*cc.contentScaleFactor()),i>n.getCapacity()&&cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var l=n.quads,h=t._itemWidth,u=t._itemHeight,d=0,_=-1;d<i;d++){var p=e.charCodeAt(d)-t._mapStartChar.charCodeAt(0),f=p%t._itemsPerRow,m=0|p/t._itemsPerRow;if(!(f<0||m<0||f*h+h>o||m*u+u>s)){_++;var g,y,v,T;cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(g=(2*f*c+1)/(2*o),y=g+(2*c-2)/(2*o),v=(2*m*a+1)/(2*s),T=v+(2*a-2)/(2*s)):(g=f*c/o,y=g+c/o,v=m*a/s,T=v+a/s);var C=l[d],S=C.tl,x=C.tr,A=C.bl,E=C.br;S.texCoords.u=g,S.texCoords.v=v,x.texCoords.u=y,x.texCoords.v=v,A.texCoords.u=g,A.texCoords.v=T,E.texCoords.u=y,E.texCoords.v=T,A.vertices.x=_*h,A.vertices.y=0,A.vertices.z=0,E.vertices.x=_*h+h,E.vertices.y=0,E.vertices.z=0,S.vertices.x=_*h,S.vertices.y=t._itemHeight,S.vertices.z=0,x.vertices.x=_*h+h,x.vertices.y=t._itemHeight,x.vertices.z=0}}if(this._updateColor(),this.updateContentSize(d,_+1),i>0){n.dirty=!0;var b=n.totalQuads;i>b&&n.increaseTotalQuadsWith(i-b)}},t.updateContentSize=function(t,e){var i=this._node,n=i._contentSize;t!==e&&t*i._itemWidth===n.width&&i._itemHeight===n.height&&i.setContentSize(e*i._itemWidth,i._itemHeight)},t.setString=function(t){var e=t.length;e>this._textureAtlas.totalQuads&&this._textureAtlas.resizeCapacity(e)},t._addChild=function(){}}(),function(){cc.LabelBMFont.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t)};var t=cc.LabelBMFont.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.LabelBMFont.WebGLRenderCmd,t.setTexture=function(t){this._node.setOpacityModifyRGB(this._node._texture.hasPremultipliedAlpha())},t._updateCharTexture=function(t,e,i){t.setTextureRect(e,!1),t.visible=!0},t._changeTextureColor=function(){},t._updateCharColorAndOpacity=function(){}}();cc.MotionStreak=cc.Node.extend({texture:null,fastMode:!1,startingPositionInitialized:!1,_blendFunc:null,_stroke:0,_fadeDelta:0,_minSeg:0,_maxPoints:0,_nuPoints:0,_previousNuPoints:0,_pointVertexes:null,_pointState:null,_vertices:null,_colorPointer:null,_texCoords:null,_verticesBuffer:null,_colorPointerBuffer:null,_texCoordsBuffer:null,_className:"MotionStreak",ctor:function(t,e,i,n,r){cc.Node.prototype.ctor.call(this),this._positionR=cc.p(0,0),this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.fastMode=!1,this.startingPositionInitialized=!1,this.texture=null,this._stroke=0,this._fadeDelta=0,this._minSeg=0,this._maxPoints=0,this._nuPoints=0,this._previousNuPoints=0,this._pointVertexes=null,this._pointState=null,this._vertices=null,this._colorPointer=null,this._texCoords=null,this._verticesBuffer=null,this._colorPointerBuffer=null,this._texCoordsBuffer=null,void 0!==r&&this.initWithFade(t,e,i,n,r)},getTexture:function(){return this.texture},setTexture:function(t){this.texture!==t&&(this.texture=t)},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc=t:(this._blendFunc.src=t,this._blendFunc.dst=e)},getOpacity:function(){return cc.log("cc.MotionStreak.getOpacity has not been supported."),0},setOpacity:function(t){cc.log("cc.MotionStreak.setOpacity has not been supported.")},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},isFastMode:function(){return this.fastMode},setFastMode:function(t){this.fastMode=t},isStartingPositionInitialized:function(){return this.startingPositionInitialized},setStartingPositionInitialized:function(t){this.startingPositionInitialized=t},getStroke:function(){return this._stroke},setStroke:function(t){this._stroke=t},initWithFade:function(t,e,i,n,r){if(!r)throw new Error("cc.MotionStreak.initWithFade(): Invalid filename or texture");cc.isString(r)&&(r=cc.textureCache.addImage(r)),cc.Node.prototype.setPosition.call(this,cc.p(0,0)),this.anchorX=0,this.anchorY=0,this.ignoreAnchor=!0,this.startingPositionInitialized=!1,this.fastMode=!0,this._minSeg=e===-1?i/5:e,this._minSeg*=this._minSeg,this._stroke=i,this._fadeDelta=1/t;var o=(0|60*t)+2;return this._maxPoints=o,this._nuPoints=0,this._pointState=new Float32Array(o),this._pointVertexes=new Float32Array(2*o),this._vertices=new Float32Array(4*o),this._texCoords=new Float32Array(4*o),this._colorPointer=new Uint8Array(8*o),this._verticesBuffer=gl.createBuffer(),this._texCoordsBuffer=gl.createBuffer(),this._colorPointerBuffer=gl.createBuffer(),this._blendFunc.src=gl.SRC_ALPHA,this._blendFunc.dst=gl.ONE_MINUS_SRC_ALPHA,this.texture=r,this.color=n,this.scheduleUpdate(),gl.bindBuffer(gl.ARRAY_BUFFER,this._verticesBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._texCoordsBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._texCoords,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this._colorPointerBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._colorPointer,gl.DYNAMIC_DRAW),!0},tintWithColor:function(t){this.color=t;for(var e=this._colorPointer,i=0,n=2*this._nuPoints;i<n;i++)e[4*i]=t.r,e[4*i+1]=t.g,e[4*i+2]=t.b},reset:function(){this._nuPoints=0},setPosition:function(t,e){this.startingPositionInitialized=!0,void 0===e?(this._positionR.x=t.x,this._positionR.y=t.y):(this._positionR.x=t,this._positionR.y=e)},getPositionX:function(){return this._positionR.x},setPositionX:function(t){this._positionR.x=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},getPositionY:function(){return this._positionR.y},setPositionY:function(t){this._positionR.y=t,this.startingPositionInitialized||(this.startingPositionInitialized=!0)},update:function(t){if(this.startingPositionInitialized){this._renderCmd._updateDisplayColor(),t*=this._fadeDelta;var e,i,n,r,o=0,s=this._nuPoints,c=this._pointState,a=this._pointVertexes,l=this._vertices,h=this._colorPointer;for(n=0;n<s;n++)if(c[n]-=t,c[n]<=0)o++;else{e=n-o,o>0?(c[e]=c[n],a[2*e]=a[2*n],a[2*e+1]=a[2*n+1],r=2*n,i=2*e,l[2*i]=l[2*r],l[2*i+1]=l[2*r+1],l[2*(i+1)]=l[2*(r+1)],l[2*(i+1)+1]=l[2*(r+1)+1],r*=4,i*=4,h[i+0]=h[r+0],h[i+1]=h[r+1],h[i+2]=h[r+2],h[i+4]=h[r+4],h[i+5]=h[r+5],h[i+6]=h[r+6]):i=8*e;var u=255*c[e];h[i+3]=u,h[i+7]=u}s-=o;var d=!0;if(s>=this._maxPoints)d=!1;else if(s>0){var _=cc.pDistanceSQ(cc.p(a[2*(s-1)],a[2*(s-1)+1]),this._positionR)<this._minSeg,p=1!==s&&cc.pDistanceSQ(cc.p(a[2*(s-2)],a[2*(s-2)+1]),this._positionR)<2*this._minSeg;(_||p)&&(d=!1)}if(d){a[2*s]=this._positionR.x,a[2*s+1]=this._positionR.y,c[s]=1;var f=8*s,m=this.getDisplayedColor();h[f]=m.r,h[f+1]=m.g,h[f+2]=m.b,h[f+4]=m.r,h[f+5]=m.g,h[f+6]=m.b,h[f+3]=255,h[f+7]=255,s>0&&this.fastMode&&(s>1?cc.vertexLineToPolygon(a,this._stroke,this._vertices,s,1):cc.vertexLineToPolygon(a,this._stroke,this._vertices,0,2)),s++}if(this.fastMode||cc.vertexLineToPolygon(a,this._stroke,this._vertices,0,s),s&&this._previousNuPoints!==s){var g=1/s,y=this._texCoords;for(n=0;n<s;n++)y[4*n]=0,y[4*n+1]=g*n,y[2*(2*n+1)]=1,y[2*(2*n+1)+1]=g*n;this._previousNuPoints=s}this._nuPoints=s}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.MotionStreak.WebGLRenderCmd(this):null}}),cc.MotionStreak.create=function(t,e,i,n,r){return new cc.MotionStreak(t,e,i,n,r)},cc.MotionStreak.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},cc.MotionStreak.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.MotionStreak.WebGLRenderCmd.prototype.constructor=cc.Sprite.WebGLRenderCmd,cc.MotionStreak.WebGLRenderCmd.prototype.rendering=function(t){var e=this._node;if(!(e._nuPoints<=1)&&e.texture&&e.texture.isLoaded()){t=t||cc._renderContext;var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),cc.glBindTexture2D(e.texture),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.bindBuffer(t.ARRAY_BUFFER,e._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,e._vertices,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._texCoordsBuffer),t.bufferData(t.ARRAY_BUFFER,e._texCoords,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e._colorPointerBuffer),t.bufferData(t.ARRAY_BUFFER,e._colorPointer,t.DYNAMIC_DRAW),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,0,0),t.drawArrays(t.TRIANGLE_STRIP,0,2*e._nuPoints),cc.g_NumberOfDraws++}};cc.NodeGrid=cc.Node.extend({grid:null,_target:null,_gridRect:null,ctor:function(t){cc.Node.prototype.ctor.call(this),void 0===t&&(t=cc.rect()),this._gridRect=t},getGrid:function(){return this.grid},setGrid:function(t){this.grid=t},setGridRect:function(t){this._gridRect=t},getGridRect:function(){return this._gridRect},setTarget:function(t){this._target=t},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.NodeGrid.WebGLRenderCmd(this):new cc.Node.CanvasRenderCmd(this)}});var _p=cc.NodeGrid.prototype;_p.grid,_p.target,cc.defineGetterSetter(_p,"target",null,_p.setTarget),cc.NodeGrid.create=function(){return new cc.NodeGrid},function(){cc.NodeGrid.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!1,this._gridBeginCommand=new cc.CustomRenderCmd(this,this.onGridBeginDraw),this._gridEndCommand=new cc.CustomRenderCmd(this,this.onGridEndDraw)};var t=cc.NodeGrid.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.NodeGrid.WebGLRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){t=t||this.getParentRenderCmd(),e._parent&&e._parent._renderCmd&&(this._curLevel=e._parent._renderCmd._curLevel+1);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(t),i.top=this._stackMatrix,cc.renderer.pushRenderCommand(this._gridBeginCommand),e._target&&e._target.visit();var n=e._children;if(n&&n.length>0){var r=n.length;e.sortAllChildren();for(var o=0;o<r;o++){var s=n[o];s&&s.visit()}}cc.renderer.pushRenderCommand(this._gridEndCommand),this._dirtyFlag=0,i.top=i.stack.pop()}},t.onGridBeginDraw=function(){var t=this._node.grid;t&&t._active&&t.beforeDraw()},t.onGridEndDraw=function(){var t=this._node.grid;t&&t._active&&t.afterDraw(this._node)}}();cc.v2fzero=function(){return{x:0,y:0}},cc.v2f=function(t,e){return{x:t,y:e}},cc.v2fadd=function(t,e){return cc.v2f(t.x+e.x,t.y+e.y)},cc.v2fsub=function(t,e){return cc.v2f(t.x-e.x,t.y-e.y)},cc.v2fmult=function(t,e){return cc.v2f(t.x*e,t.y*e)},cc.v2fperp=function(t){return cc.v2f(-t.y,t.x)},cc.v2fneg=function(t){return cc.v2f(-t.x,-t.y)},cc.v2fdot=function(t,e){return t.x*e.x+t.y*e.y},cc.v2fforangle=function(t){return cc.v2f(Math.cos(t),Math.sin(t))},cc.v2fnormalize=function(t){var e=cc.pNormalize(cc.p(t.x,t.y));return cc.v2f(e.x,e.y)},cc.__v2f=function(t){return cc.v2f(t.x,t.y)},cc.__t=function(t){return{u:t.x,v:t.y}},cc.DrawNode=cc.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},setLineWidth:function(t){this._lineWidth=t},getLineWidth:function(){return this._lineWidth},setDrawColor:function(t){var e=this._drawColor;e.r=t.r,e.g=t.g,e.b=t.b,e.a=null==t.a?255:t.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)}}),cc.DrawNode.create=function(){return new cc.DrawNode},cc.DrawNode.TYPE_DOT=0,cc.DrawNode.TYPE_SEGMENT=1,cc.DrawNode.TYPE_POLY=2,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){cc._renderType===cc.game.RENDER_TYPE_CANVAS?(cc._DrawNodeElement=function(t,e,i,n,r,o,s,c,a){var l=this;l.type=t,l.verts=e||null,l.fillColor=i||null,l.lineWidth=n||0,l.lineColor=r||null,l.lineCap=o||"butt",l.isClosePolygon=s||!1,l.isFill=c||!1,l.isStroke=a||!1},cc.extend(cc.DrawNode.prototype,{_className:"DrawNodeCanvas",ctor:function(){cc.Node.prototype.ctor.call(this);var t=this._renderCmd;t._buffer=this._buffer=[],t._drawColor=this._drawColor=cc.color(255,255,255,255),t._blendFunc=this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this.init(),this._localBB=new cc.Rect},setLocalBB:function(t,e,i,n){var r=this._localBB;void 0===e?(r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height):(r.x=t,r.y=e,r.width=i,r.height=n)},drawRect:function(t,e,i,n,r){n=null==n?this._lineWidth:n,r=r||this.getDrawColor(),null==r.a&&(r.a=255);var o=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)],s=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);s.verts=o,s.lineWidth=n,s.lineColor=r,s.isClosePolygon=!0,s.isStroke=!0,s.lineCap="butt",s.fillColor=i,i&&(null==i.a&&(i.a=255),s.isFill=!0),this._buffer.push(s)},drawCircle:function(t,e,i,n,r,o,s){o=o||this._lineWidth,s=s||this.getDrawColor(),null==s.a&&(s.a=255);for(var c=2*Math.PI/n,a=[],l=0;l<=n;l++){var h=l*c,u=e*Math.cos(h+i)+t.x,d=e*Math.sin(h+i)+t.y;a.push(cc.p(u,d))}r&&a.push(cc.p(t.x,t.y));var _=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);_.verts=a,_.lineWidth=o,_.lineColor=s,_.isClosePolygon=!0,_.isStroke=!0,this._buffer.push(_)},drawQuadBezier:function(t,e,i,n,r,o){r=r||this._lineWidth,o=o||this.getDrawColor(),null==o.a&&(o.a=255);for(var s=[],c=0,a=0;a<n;a++){var l=Math.pow(1-c,2)*t.x+2*(1-c)*c*e.x+c*c*i.x,h=Math.pow(1-c,2)*t.y+2*(1-c)*c*e.y+c*c*i.y;s.push(cc.p(l,h)),c+=1/n}s.push(cc.p(i.x,i.y));var u=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);u.verts=s,u.lineWidth=r,u.lineColor=o,u.isStroke=!0,u.lineCap="round",this._buffer.push(u)},drawCubicBezier:function(t,e,i,n,r,o,s){o=o||this._lineWidth,s=s||this.getDrawColor(),null==s.a&&(s.a=255);for(var c=[],a=0,l=0;l<r;l++){var h=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*e.x+3*(1-a)*a*a*i.x+a*a*a*n.x,u=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*e.y+3*(1-a)*a*a*i.y+a*a*a*n.y;c.push(cc.p(h,u)),a+=1/r}c.push(cc.p(n.x,n.y));var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=c,d.lineWidth=o,d.lineColor=s,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},drawCatmullRom:function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},drawCardinalSpline:function(t,e,i,n,r){n=n||this._lineWidth,r=r||this.getDrawColor(),null==r.a&&(r.a=255);for(var o,s,c=[],a=1/t.length,l=0;l<i+1;l++){var h=l/i;1===h?(o=t.length-1,s=1):(o=0|h/a,s=(h-a*o)/a);var u=cc.cardinalSplineAt(cc.getControlPointAt(t,o-1),cc.getControlPointAt(t,o-0),cc.getControlPointAt(t,o+1),cc.getControlPointAt(t,o+2),e,s);c.push(u)}var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);d.verts=c,d.lineWidth=n,d.lineColor=r,d.isStroke=!0,d.lineCap="round",this._buffer.push(d)},drawDot:function(t,e,i){i=i||this.getDrawColor(),null==i.a&&(i.a=255);var n=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);n.verts=[t],n.lineWidth=e,n.fillColor=i,this._buffer.push(n)},drawDots:function(t,e,i){if(t&&0!=t.length){i=i||this.getDrawColor(),null==i.a&&(i.a=255);for(var n=0,r=t.length;n<r;n++)this.drawDot(t[n],e,i)}},drawSegment:function(t,e,i,n){i=i||this._lineWidth,n=n||this.getDrawColor(),null==n.a&&(n.a=255);var r=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);r.verts=[t,e],r.lineWidth=2*i,r.lineColor=n,r.isStroke=!0,r.lineCap="round",this._buffer.push(r)},drawPoly_:function(t,e,i,n){i=null==i?this._lineWidth:i,n=n||this.getDrawColor(),null==n.a&&(n.a=255);var r=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);r.verts=t,r.fillColor=e,r.lineWidth=i,r.lineColor=n,r.isClosePolygon=!0,r.isStroke=!0,r.lineCap="round",e&&(r.isFill=!0),this._buffer.push(r)},drawPoly:function(t,e,i,n){for(var r=[],o=0;o<t.length;o++)r.push(cc.p(t[o].x,t[o].y));return this.drawPoly_(r,e,i,n)},clear:function(){this._buffer.length=0},_createRenderCmd:function(){return new cc.DrawNode.CanvasRenderCmd(this)}})):cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.extend(cc.DrawNode.prototype,{_bufferCapacity:0,_trianglesArrayBuffer:null,_trianglesWebBuffer:null,_trianglesReader:null,_dirty:!1,_className:"DrawNodeWebGL",ctor:function(){cc.Node.prototype.ctor.call(this),this._buffer=[],this._blendFunc=new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),this._drawColor=cc.color(255,255,255,255),this.init()},init:function(){return!!cc.Node.prototype.init.call(this)&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0,!0)},drawRect:function(t,e,i,n,r){n=null==n?this._lineWidth:n,r=r||this.getDrawColor(),null==r.a&&(r.a=255);var o=[t,cc.p(e.x,t.y),e,cc.p(t.x,e.y)];null==i?this._drawSegments(o,n,r,!0):this.drawPoly(o,i,n,r)},drawCircle:function(t,e,i,n,r,o,s){o=o||this._lineWidth,s=s||this.getDrawColor(),null==s.a&&(s.a=255);var c,a,l=2*Math.PI/n,h=[];for(c=0;c<=n;c++){var u=c*l,d=e*Math.cos(u+i)+t.x,_=e*Math.sin(u+i)+t.y;h.push(cc.p(d,_))}for(r&&h.push(cc.p(t.x,t.y)),o*=.5,c=0,a=h.length;c<a-1;c++)this.drawSegment(h[c],h[c+1],o,s)},drawQuadBezier:function(t,e,i,n,r,o){r=r||this._lineWidth,o=o||this.getDrawColor(),null==o.a&&(o.a=255);for(var s=[],c=0,a=0;a<n;a++){var l=Math.pow(1-c,2)*t.x+2*(1-c)*c*e.x+c*c*i.x,h=Math.pow(1-c,2)*t.y+2*(1-c)*c*e.y+c*c*i.y;s.push(cc.p(l,h)),c+=1/n}s.push(cc.p(i.x,i.y)),this._drawSegments(s,r,o,!1)},drawCubicBezier:function(t,e,i,n,r,o,s){o=o||this._lineWidth,s=s||this.getDrawColor(),null==s.a&&(s.a=255);for(var c=[],a=0,l=0;l<r;l++){var h=Math.pow(1-a,3)*t.x+3*Math.pow(1-a,2)*a*e.x+3*(1-a)*a*a*i.x+a*a*a*n.x,u=Math.pow(1-a,3)*t.y+3*Math.pow(1-a,2)*a*e.y+3*(1-a)*a*a*i.y+a*a*a*n.y;c.push(cc.p(h,u)),a+=1/r}c.push(cc.p(n.x,n.y)),this._drawSegments(c,o,s,!1)},drawCatmullRom:function(t,e,i,n){this.drawCardinalSpline(t,.5,e,i,n)},drawCardinalSpline:function(t,e,i,n,r){n=n||this._lineWidth,r=r||this.getDrawColor(),null==r.a&&(r.a=255);for(var o,s,c=[],a=1/t.length,l=0;l<i+1;l++){var h=l/i;1===h?(o=t.length-1,s=1):(o=0|h/a,s=(h-a*o)/a);var u=cc.cardinalSplineAt(cc.getControlPointAt(t,o-1),cc.getControlPointAt(t,o-0),cc.getControlPointAt(t,o+1),cc.getControlPointAt(t,o+2),e,s);c.push(u)}n*=.5;for(var d=0,_=c.length;d<_-1;d++)this.drawSegment(c[d],c[d+1],n,r)},_render:function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._trianglesWebBuffer),this._dirty&&(t.bufferData(t.ARRAY_BUFFER,this._trianglesArrayBuffer,t.STREAM_DRAW),this._dirty=!1);var e=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;t.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),t.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),t.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,t.UNSIGNED_BYTE,!0,e,8),t.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,t.FLOAT,!1,e,12),t.drawArrays(t.TRIANGLES,0,3*this._buffer.length),cc.incrementGLDraws(1)},_ensureCapacity:function(t){var e=this,i=e._buffer;if(i.length+t>e._bufferCapacity){var n=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;if(e._bufferCapacity+=Math.max(e._bufferCapacity,t),null==i||0===i.length)e._buffer=[],e._trianglesArrayBuffer=new ArrayBuffer(n*e._bufferCapacity),e._trianglesReader=new Uint8Array(e._trianglesArrayBuffer);else{for(var r=[],o=new ArrayBuffer(n*e._bufferCapacity),s=0;s<i.length;s++)r[s]=new cc.V2F_C4B_T2F_Triangle(i[s].a,i[s].b,i[s].c,o,s*n);e._trianglesReader=new Uint8Array(o),e._trianglesArrayBuffer=o,e._buffer=r}}},drawDot:function(t,e,i){i=i||this.getDrawColor(),null==i.a&&(i.a=255);var n={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},r={vertices:{x:t.x-e,y:t.y-e},colors:n,texCoords:{u:-1,v:-1}},o={vertices:{x:t.x-e,y:t.y+e},colors:n,texCoords:{u:-1,v:1}},s={vertices:{x:t.x+e,y:t.y+e},colors:n,texCoords:{u:1,v:1}},c={vertices:{x:t.x+e,y:t.y-e},colors:n,texCoords:{u:1,v:-1}};this._ensureCapacity(6),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,o,s,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._buffer.push(new cc.V2F_C4B_T2F_Triangle(r,s,c,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT)),this._dirty=!0},drawDots:function(t,e,i){if(t&&0!==t.length){i=i||this.getDrawColor(),null==i.a&&(i.a=255);for(var n=0,r=t.length;n<r;n++)this.drawDot(t[n],e,i)}},drawSegment:function(t,e,i,n){n=n||this.getDrawColor(),null==n.a&&(n.a=255),i=i||.5*this._lineWidth;var r=18;this._ensureCapacity(r);var o={r:0|n.r,g:0|n.g,b:0|n.b,a:0|n.a},s=cc.__v2f(t),c=cc.__v2f(e),a=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(c,s))),l=cc.v2fperp(a),h=cc.v2fmult(a,i),u=cc.v2fmult(l,i),d=cc.v2fsub(c,cc.v2fadd(h,u)),_=cc.v2fadd(c,cc.v2fsub(h,u)),p=cc.v2fsub(c,h),f=cc.v2fadd(c,h),m=cc.v2fsub(s,h),g=cc.v2fadd(s,h),y=cc.v2fsub(s,cc.v2fsub(h,u)),v=cc.v2fadd(s,cc.v2fadd(h,u)),T=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,C=this._trianglesArrayBuffer,S=this._buffer;S.push(new cc.V2F_C4B_T2F_Triangle({vertices:d,colors:o,texCoords:cc.__t(cc.v2fneg(cc.v2fadd(a,l)))},{vertices:_,colors:o,texCoords:cc.__t(cc.v2fsub(a,l))},{vertices:p,colors:o,texCoords:cc.__t(cc.v2fneg(a))},C,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:o,texCoords:cc.__t(a)},{vertices:_,colors:o,texCoords:cc.__t(cc.v2fsub(a,l))},{vertices:p,colors:o,texCoords:cc.__t(cc.v2fneg(a))},C,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:o,texCoords:cc.__t(a)},{vertices:m,colors:o,texCoords:cc.__t(cc.v2fneg(a))},{vertices:p,colors:o,texCoords:cc.__t(cc.v2fneg(a))},C,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:o,texCoords:cc.__t(a)},{vertices:m,colors:o,texCoords:cc.__t(cc.v2fneg(a))},{vertices:g,colors:o,texCoords:cc.__t(a)},C,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:y,colors:o,texCoords:cc.__t(cc.v2fsub(l,a))},{vertices:m,colors:o,texCoords:cc.__t(cc.v2fneg(a))},{vertices:g,colors:o,texCoords:cc.__t(a)},C,S.length*T)),S.push(new cc.V2F_C4B_T2F_Triangle({vertices:y,colors:o,texCoords:cc.__t(cc.v2fsub(l,a))},{vertices:v,colors:o,texCoords:cc.__t(cc.v2fadd(a,l))},{vertices:g,colors:o,texCoords:cc.__t(a)},C,S.length*T)),this._dirty=!0},drawPoly:function(t,e,i,n){if(null==e)return void this._drawSegments(t,i,n,!0);null==e.a&&(e.a=255),null==n.a&&(n.a=255),i=null==i?this._lineWidth:i,i*=.5;var r,o,s,c,a={r:0|e.r,g:0|e.g,b:0|e.b,a:0|e.a},l={r:0|n.r,g:0|n.g,b:0|n.b,a:0|n.a},h=[],u=t.length;for(r=0;r<u;r++){o=cc.__v2f(t[(r-1+u)%u]),s=cc.__v2f(t[r]),c=cc.__v2f(t[(r+1)%u]);var d=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s,o))),_=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(c,s))),p=cc.v2fmult(cc.v2fadd(d,_),1/(cc.v2fdot(d,_)+1));h[r]={offset:p,n:_}}var f=i>0,m=3*u-2,g=3*m;this._ensureCapacity(g);var y=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,v=this._trianglesArrayBuffer,T=this._buffer,C=0==f?.5:0;for(r=0;r<u-2;r++)o=cc.v2fsub(cc.__v2f(t[0]),cc.v2fmult(h[0].offset,C)),s=cc.v2fsub(cc.__v2f(t[r+1]),cc.v2fmult(h[r+1].offset,C)),c=cc.v2fsub(cc.__v2f(t[r+2]),cc.v2fmult(h[r+2].offset,C)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:o,colors:a,texCoords:cc.__t(cc.v2fzero())},{vertices:s,colors:a,texCoords:cc.__t(cc.v2fzero())},{vertices:c,colors:a,texCoords:cc.__t(cc.v2fzero())},v,T.length*y));for(r=0;r<u;r++){var S=(r+1)%u;o=cc.__v2f(t[r]),s=cc.__v2f(t[S]);var x=h[r].n,A=h[r].offset,E=h[S].offset,b=f?cc.v2fsub(o,cc.v2fmult(A,i)):cc.v2fsub(o,cc.v2fmult(A,.5)),R=f?cc.v2fsub(s,cc.v2fmult(E,i)):cc.v2fsub(s,cc.v2fmult(E,.5)),P=f?cc.v2fadd(o,cc.v2fmult(A,i)):cc.v2fadd(o,cc.v2fmult(A,.5)),w=f?cc.v2fadd(s,cc.v2fmult(E,i)):cc.v2fadd(s,cc.v2fmult(E,.5));f?(T.push(new cc.V2F_C4B_T2F_Triangle({vertices:b,colors:l,texCoords:cc.__t(cc.v2fneg(x))},{vertices:R,colors:l,texCoords:cc.__t(cc.v2fneg(x))},{vertices:w,colors:l,texCoords:cc.__t(x)},v,T.length*y)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:b,colors:l,texCoords:cc.__t(cc.v2fneg(x))},{vertices:P,colors:l,texCoords:cc.__t(x)},{vertices:w,colors:l,texCoords:cc.__t(x)},v,T.length*y))):(T.push(new cc.V2F_C4B_T2F_Triangle({vertices:b,colors:a,texCoords:cc.__t(cc.v2fzero())},{vertices:R,colors:a,texCoords:cc.__t(cc.v2fzero())},{vertices:w,colors:a,texCoords:cc.__t(x)},v,T.length*y)),T.push(new cc.V2F_C4B_T2F_Triangle({vertices:b,colors:a,texCoords:cc.__t(cc.v2fzero())},{vertices:P,colors:a,texCoords:cc.__t(x)},{vertices:w,colors:a,texCoords:cc.__t(x)},v,T.length*y)))}h=null,this._dirty=!0},_drawSegments:function(t,e,i,n){if(e=null==e?this._lineWidth:e,i=i||this._drawColor,null==i.a&&(i.a=255),e*=.5,!(e<=0)){var r,o,s,c,a={r:0|i.r,g:0|i.g,b:0|i.b,a:0|i.a},l=[],h=t.length;for(r=0;r<h;r++){o=cc.__v2f(t[(r-1+h)%h]),s=cc.__v2f(t[r]),c=cc.__v2f(t[(r+1)%h]);var u=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(s,o))),d=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(c,s))),_=cc.v2fmult(cc.v2fadd(u,d),1/(cc.v2fdot(u,d)+1));l[r]={offset:_,n:d}}var p=3*h-2,f=3*p;this._ensureCapacity(f);var m=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,g=this._trianglesArrayBuffer,y=this._buffer,v=n?h:h-1;for(r=0;r<v;r++){var T=(r+1)%h;o=cc.__v2f(t[r]),s=cc.__v2f(t[T]);var C=l[r].n,S=l[r].offset,x=l[T].offset,A=cc.v2fsub(o,cc.v2fmult(S,e)),E=cc.v2fsub(s,cc.v2fmult(x,e)),b=cc.v2fadd(o,cc.v2fmult(S,e)),R=cc.v2fadd(s,cc.v2fmult(x,e));y.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:a,texCoords:cc.__t(cc.v2fneg(C))},{vertices:E,colors:a,texCoords:cc.__t(cc.v2fneg(C))},{vertices:R,colors:a,texCoords:cc.__t(C)},g,y.length*m)),y.push(new cc.V2F_C4B_T2F_Triangle({vertices:A,colors:a,texCoords:cc.__t(cc.v2fneg(C))},{vertices:b,colors:a,texCoords:cc.__t(C)},{vertices:R,colors:a,texCoords:cc.__t(C)},g,y.length*m))}l=null,this._dirty=!0}},clear:function(){this._buffer.length=0,this._dirty=!0},_createRenderCmd:function(){return new cc.DrawNode.WebGLRenderCmd(this)}})}),function(){cc.DrawNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._buffer=null,this._drawColor=null,this._blendFunc=null},cc.DrawNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype),cc.DrawNode.CanvasRenderCmd.prototype.constructor=cc.DrawNode.CanvasRenderCmd,cc.DrawNode.CanvasRenderCmd.prototype.getLocalBB=function(){var t=this._node;return t._localBB},cc.extend(cc.DrawNode.CanvasRenderCmd.prototype,{rendering:function(t,e,i){var n=t||cc._renderContext,r=(n.getContext(),this._node),o=r._displayedOpacity/255;if(0!==o){n.setTransform(this._worldTransform,e,i),n.setGlobalAlpha(o),this._blendFunc&&this._blendFunc.src===cc.SRC_ALPHA&&this._blendFunc.dst===cc.ONE&&n.setCompositeOperation("lighter");for(var s=this._buffer,c=0,a=s.length;c<a;c++){var l=s[c];switch(l.type){case cc.DrawNode.TYPE_DOT:this._drawDot(n,l,e,i);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(n,l,e,i);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(n,l,e,i)}}}},_drawDot:function(t,e){var i=e.fillColor,n=e.verts[0],r=e.lineWidth,o=t.getContext();t.setFillStyle("rgba("+(0|i.r)+","+(0|i.g)+","+(0|i.b)+","+i.a/255+")"),o.beginPath(),o.arc(n.x,-n.y,r,0,2*Math.PI,!1),o.closePath(),o.fill()},_drawSegment:function(t,e,i){var n=e.lineColor,r=e.verts[0],o=e.verts[1],s=e.lineWidth,c=e.lineCap,a=t.getContext();t.setStrokeStyle("rgba("+(0|n.r)+","+(0|n.g)+","+(0|n.b)+","+n.a/255+")"),a.lineWidth=s*i,a.beginPath(),a.lineCap=c,a.moveTo(r.x,-r.y),a.lineTo(o.x,-o.y),a.stroke()},_drawPoly:function(t,e,i){var n=e.verts,r=e.lineCap;if(null!=n){var o=e.fillColor,s=e.lineWidth,c=e.lineColor,a=e.isClosePolygon,l=e.isFill,h=e.isStroke,u=t.getContext(),d=n[0];u.lineCap=r,o&&t.setFillStyle("rgba("+(0|o.r)+","+(0|o.g)+","+(0|o.b)+","+o.a/255+")"),s&&(u.lineWidth=s*i),c&&t.setStrokeStyle("rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+","+c.a/255+")"),u.beginPath(),u.moveTo(d.x,-d.y);for(var _=1,p=n.length;_<p;_++)u.lineTo(n[_].x,-n[_].y);a&&u.closePath(),l&&u.fill(),h&&u.stroke()}}})}();!function(){cc.DrawNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()},cc.DrawNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd,cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(t){var e=this._node;if(e._buffer.length>0){var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e._render()}}}();cc.stencilBits=-1,cc.ClippingNode=cc.Node.extend({alphaThreshold:0,inverted:!1,_stencil:null,_className:"ClippingNode",ctor:function(t){t=t||null,cc.Node.prototype.ctor.call(this),this._stencil=t,this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits()},init:function(t){return this._stencil=t,this.alphaThreshold=1,this.inverted=!1,this._renderCmd.initStencilBits(),!0},onEnter:function(){cc.Node.prototype.onEnter.call(this),this._stencil.onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this),this._stencil.onEnterTransitionDidFinish()},onExitTransitionDidStart:function(){this._stencil.onExitTransitionDidStart(),cc.Node.prototype.onExitTransitionDidStart.call(this)},onExit:function(){this._stencil.onExit(),cc.Node.prototype.onExit.call(this)},getAlphaThreshold:function(){return this.alphaThreshold},setAlphaThreshold:function(t){this.alphaThreshold=t},isInverted:function(){return this.inverted},setInverted:function(t){this.inverted=t},getStencil:function(){return this._stencil},setStencil:function(t){this._stencil!==t&&this._renderCmd.setStencil(t)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ClippingNode.CanvasRenderCmd(this):new cc.ClippingNode.WebGLRenderCmd(this)}});var _p=cc.ClippingNode.prototype;cc.defineGetterSetter(_p,"stencil",_p.getStencil,_p.setStencil),_p.stencil,cc.ClippingNode.create=function(t){return new cc.ClippingNode(t)},function(){cc.ClippingNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!1,this._godhelpme=!1,this._clipElemType=!1,this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._saveCmdCallback),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._clipCmdCallback),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._restoreCmdCallback)};var t=cc.ClippingNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ClippingNode.CanvasRenderCmd,t.initStencilBits=function(){},t.setStencil=function(t){if(null!=t)if(this._node._stencil=t,t instanceof cc.DrawNode){if(t._buffer)for(var e=0;e<t._buffer.length;e++)t._buffer[e].isFill=!1,t._buffer[e].isStroke=!1;t._renderCmd.rendering=function(t,e,i){},t._renderCmd._canUseDirtyRegion=!0,this._rendererSaveCmd._canUseDirtyRegion=!0,this._rendererClipCmd._canUseDirtyRegion=!0,this._rendererRestoreCmd._canUseDirtyRegion=!0}else t._parent=this._node},t._saveCmdCallback=function(t,e,i){var n=t||cc._renderContext,r=n.getContext();if(this._clipElemType){var o=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),s=r.canvas;o.width=s.width,o.height=s.height;var c=o.getContext("2d");c.drawImage(s,0,0)}else n.save(),n.setTransform(this._worldTransform,e,i),this._node.inverted&&(r.beginPath(),r.rect(0,0,r.canvas.width,-r.canvas.height),r.clip())},t._setStencilCompositionOperation=function(t){if(t){var e=this._node;if(t._renderCmd&&t._renderCmd._blendFuncStr&&(t._renderCmd._blendFuncStr=e.inverted?"destination-out":"destination-in"),t._children)for(var i=t._children,n=0,r=i.length;n<r;n++)this._setStencilCompositionOperation(i[n])}},t._clipCmdCallback=function(t){var e=this._node,i=t||cc._renderContext,n=i.getContext();if(this._clipElemType)this._setStencilCompositionOperation(e._stencil);else{var r=this._node._stencil;if(r instanceof cc.DrawNode){n.beginPath();var o=r._renderCmd._transform;n.transform(o.a,o.b,o.c,o.d,o.tx,-o.ty);for(var s=0;s<r._buffer.length;s++){var c=r._buffer[s].verts,a=c[0];n.moveTo(a.x,-a.y);for(var l=c.length-1;l>0;l--)n.lineTo(c[l].x,-c[l].y)}}n.clip()}},t._restoreCmdCallback=function(t){var e=cc.ClippingNode.CanvasRenderCmd._getSharedCache(),i=t||cc._renderContext,n=i.getContext();this._clipElemType?(n.save(),n.setTransform(1,0,0,1,0,0),n.globalCompositeOperation="destination-over",n.drawImage(e,0,0),n.restore(),this._dirtyFlag=0):i.restore()},t.transform=function(t,e){cc.Node.CanvasRenderCmd.prototype.transform.call(this,t,e);var i=this._node;i._stencil&&i._stencil._renderCmd&&i._stencil._renderCmd.transform(this,e)},t._cangodhelpme=function(t){return t!==!0&&t!==!1||(cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme=t),cc.ClippingNode.CanvasRenderCmd.prototype._godhelpme},t.visit=function(t){var e=this._node;if(e._visible){t=t||this.getParentRenderCmd(),t&&(this._curLevel=t._curLevel+1);var i=this;if(this._clipElemType=!(!this._cangodhelpme()&&e._stencil instanceof cc.DrawNode),!e._stencil||!e._stencil.visible)return void(this.inverted&&this.originVisit(t));if(this._syncStatus(t),cc.renderer.pushRenderCommand(this._rendererSaveCmd),this._clipElemType?this.originVisit(t):e._stencil.visit(this),cc.renderer.pushRenderCommand(this._rendererClipCmd),this._clipElemType)e._stencil.visit(i);else{var n,r=e._children;this._cangodhelpme(!0);var o=r.length;if(o>0)for(e.sortAllChildren(),n=0;n<o;n++)r[n]._renderCmd.visit(this);this._cangodhelpme(!1)}cc.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}},cc.ClippingNode.CanvasRenderCmd._sharedCache=null,cc.ClippingNode.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode.CanvasRenderCmd._sharedCache||(cc.ClippingNode.CanvasRenderCmd._sharedCache=document.createElement("canvas"))}}();!function(){cc.ClippingNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!1,this._beforeVisitCmd=new cc.CustomRenderCmd(this,this._onBeforeVisit),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmd=new cc.CustomRenderCmd(this,this._onAfterVisit),this._currentStencilEnabled=null,this._mask_layer_le=null};var t=cc.ClippingNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ClippingNode.WebGLRenderCmd,cc.ClippingNode.WebGLRenderCmd._init_once=null,cc.ClippingNode.WebGLRenderCmd._visit_once=null,cc.ClippingNode.WebGLRenderCmd._layer=-1,t.initStencilBits=function(){cc.ClippingNode.WebGLRenderCmd._init_once=!0,cc.ClippingNode.WebGLRenderCmd._init_once&&(cc.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),cc.stencilBits<=0&&cc.log("Stencil buffer is not enabled."),cc.ClippingNode.WebGLRenderCmd._init_once=!1)},t.transform=function(t,e){var i=this._node;this.originTransform(t,e),i._stencil&&i._stencil._renderCmd.transform(this,e)},t.visit=function(t){var e=this._node;if(e._visible){if(e._parent&&e._parent._renderCmd&&(this._curLevel=e._parent._renderCmd._curLevel+1),cc.stencilBits<1)return void this.originVisit(t);if(!e._stencil||!e._stencil.visible)return void(e.inverted&&this.originVisit(t));if(cc.ClippingNode.WebGLRenderCmd._layer+1===cc.stencilBits)return cc.ClippingNode.WebGLRenderCmd._visit_once=!0,cc.ClippingNode.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its children."),cc.ClippingNode.WebGLRenderCmd._visit_once=!1),void this.originVisit(t);cc.renderer.pushRenderCommand(this._beforeVisitCmd);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(t),i.top=this._stackMatrix,e._stencil._renderCmd.visit(this),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);var n=e._children;if(n&&n.length>0){var r=n.length;e.sortAllChildren();for(var o=0;o<r;o++)n[o]._renderCmd.visit(this)}cc.renderer.pushRenderCommand(this._afterVisitCmd),this._dirtyFlag=0,i.top=i.stack.pop()}},t.setStencil=function(t){var e=this._node;e._stencil&&(e._stencil._parent=null),e._stencil=t,e._stencil&&(e._stencil._parent=e)},t._onBeforeVisit=function(t){var e=t||cc._renderContext,i=this._node;cc.ClippingNode.WebGLRenderCmd._layer++;var n=1<<cc.ClippingNode.WebGLRenderCmd._layer,r=n-1;if(this._mask_layer_le=n|r,this._currentStencilEnabled=e.isEnabled(e.STENCIL_TEST),e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.depthMask(!1),e.stencilFunc(e.NEVER,n,n),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.stencilMask(n),e.clear(e.STENCIL_BUFFER_BIT),i.alphaThreshold<1){var o=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST);cc.glUseProgram(o.getProgram()),o.setUniformLocationWith1f(cc.UNIFORM_ALPHA_TEST_VALUE_S,i.alphaThreshold),o.setUniformLocationWithMatrix4fv(cc.UNIFORM_MVMATRIX_S,cc.renderer.mat4Identity.mat),cc.setProgram(i._stencil,o)}},t._onAfterDrawStencil=function(t){var e=t||cc._renderContext;e.depthMask(!0),e.stencilFunc(this._node.inverted?e.NOTEQUAL:e.EQUAL,this._mask_layer_le,this._mask_layer_le),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t._onAfterVisit=function(t){var e=t||cc._renderContext;if(cc.ClippingNode.WebGLRenderCmd._layer--,this._currentStencilEnabled){var i=1<<cc.ClippingNode.WebGLRenderCmd._layer,n=i-1,r=i|n;e.stencilMask(i),e.stencilFunc(e.EQUAL,r,r)}else e.disable(e.STENCIL_TEST)}}();cc.GridBase=cc.Class.extend({_active:!1,_reuseGrid:0,_gridSize:null,_gridRect:null,_texture:null,_step:null,_grabber:null,_isTextureFlipped:!1,_shaderProgram:null,_directorProjection:0,_dirty:!1,ctor:function(t,e,i,n){cc.sys._checkWebGLRenderMode(),this._active=!1,this._reuseGrid=0,this._gridSize=null,this._gridRect=new cc.rect,this._texture=null,this._step=cc.p(0,0),this._grabber=null,this._isTextureFlipped=!1,this._shaderProgram=null,this._directorProjection=0,this._dirty=!1,void 0!==t&&this.initWithSize(t,e,i,n)},isActive:function(){return this._active},setActive:function(t){if(this._active=t,!t){var e=cc.director,i=e.getProjection();e.setProjection(i)}},getReuseGrid:function(){return this._reuseGrid},setReuseGrid:function(t){this._reuseGrid=t},getGridSize:function(){return cc.size(this._gridSize.width,this._gridSize.height)},setGridSize:function(t){this._gridSize.width=parseInt(t.width),this._gridSize.height=parseInt(t.height)},setGridRect:function(t){this._gridRect=t},getGridRect:function(){return this._gridRect},getStep:function(){return cc.p(this._step.x,this._step.y)},setStep:function(t){this._step.x=t.x,this._step.y=t.y},isTextureFlipped:function(){return this._isTextureFlipped},setTextureFlipped:function(t){this._isTextureFlipped!==t&&(this._isTextureFlipped=t,this.calculateVertexPoints())},initWithSize:function(t,e,i,n){if(!e){var r=cc.director,o=r.getWinSizeInPixels(),s=cc.NextPOT(o.width),c=cc.NextPOT(o.height),a=new Uint8Array(s*c*4);if(!a)return cc.log("cocos2d: CCGrid: not enough memory."),!1;if(e=new cc.Texture2D,e.initWithData(a,cc.Texture2D.PIXEL_FORMAT_RGBA8888,s,c,o),!e)return cc.log("cocos2d: CCGrid: error creating texture"),!1}if(i=i||!1,this._active=!1,this._reuseGrid=0,this._gridSize=t,this._texture=e,this._isTextureFlipped=i,void 0===n||cc._rectEqualToZero(n)){var l=this._texture.getContentSize();n=new cc.rect(0,0,l.width,l.height)}return this._gridRect=n,this._step.x=this._gridRect.width/t.width,this._step.y=this._gridRect.height/t.height,this._grabber=new cc.Grabber,!!this._grabber&&(this._grabber.grab(this._texture),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),this.calculateVertexPoints(),!0)},beforeDraw:function(){this._directorProjection=cc.director.getProjection();var t=cc.director.getWinSizeInPixels();gl.viewport(0,0,t.width,t.height),this._grabber.beforeRender(this._texture)},afterDraw:function(t){this._grabber.afterRender(this._texture),cc.director.setViewport(),cc.glBindTexture2D(this._texture),this.beforeBlit(),this.blit(t),this.afterBlit()},beforeBlit:function(){},afterBlit:function(){},blit:function(){cc.log("cc.GridBase.blit(): Shall be overridden in subclass.")},reuse:function(){cc.log("cc.GridBase.reuse(): Shall be overridden in subclass.")},calculateVertexPoints:function(){cc.log("cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.")},set2DProjection:function(){var t=cc.director.getWinSizeInPixels(),e=cc._renderContext;e.viewport(0,0,t.width,t.height),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity();var i=cc.math.Matrix4.createOrthographicProjection(0,t.width,0,t.height,-1,1);cc.kmGLMultMatrix(i),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity(),cc.setProjectionMatrixDirty()}}),cc.GridBase.create=function(t,e,i,n){return new cc.GridBase(t,e,i,n)},cc.Grid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,_needDepthTestForBlit:!1,_oldDepthTestValue:!1,_oldDepthWriteValue:!1,ctor:function(t,e,i,n){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),void 0!==t&&this.initWithSize(t,e,i,n)},vertex:function(t){return this.getVertex(t)},getVertex:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.vertex() : Numbers must be integers");var e=0|3*(t.x*(this._gridSize.height+1)+t.y),i=this._vertices;return new cc.Vertex3F(i[e],i[e+1],i[e+2])},originalVertex:function(t){return this.getOriginalVertex(t)},getOriginalVertex:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.originalVertex() : Numbers must be integers");var e=0|3*(t.x*(this._gridSize.height+1)+t.y),i=this._originalVertices;return new cc.Vertex3F(i[e],i[e+1],i[e+2])},setVertex:function(t,e){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.Grid3D.setVertex() : Numbers must be integers");var i=0|3*(t.x*(this._gridSize.height+1)+t.y),n=this._vertices;n[i]=e.x,n[i+1]=e.y,n[i+2]=e.z,this._dirty=!0},beforeBlit:function(){if(this._needDepthTestForBlit){var t=cc._renderContext;this._oldDepthTestValue=t.isEnabled(t.DEPTH_TEST),this._oldDepthWriteValue=t.getParameter(t.DEPTH_WRITEMASK),t.enable(t.DEPTH_TEST),t.depthMask(!0)}},afterBlit:function(){if(this._needDepthTestForBlit){var t=cc._renderContext;this._oldDepthTestValue?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),t.depthMask(this._oldDepthWriteValue)}},blit:function(t){var e=this._gridSize.width*this._gridSize.height,i=t._renderCmd._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix);var n=cc._renderContext,r=this._dirty;n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),n.bindBuffer(n.ARRAY_BUFFER,this._verticesBuffer),r&&n.bufferData(n.ARRAY_BUFFER,this._vertices,n.DYNAMIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this._texCoordinateBuffer),r&&n.bufferData(n.ARRAY_BUFFER,this._texCoordinates,n.DYNAMIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),r&&n.bufferData(n.ELEMENT_ARRAY_BUFFER,this._indices,n.STATIC_DRAW),n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,0),r&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var t=this._originalVertices,e=this._vertices,i=0,n=this._vertices.length;i<n;i++)t[i]=e[i];--this._reuseGrid}},calculateVertexPoints:function(){var t=cc._renderContext,e=this._texture.pixelsWidth,i=this._texture.pixelsHeight,n=this._texture.getContentSizeInPixels().height,r=this._gridSize,o=(r.width+1)*(r.height+1);this._vertices=new Float32Array(3*o),this._texCoordinates=new Float32Array(2*o),this._indices=new Uint16Array(r.width*r.height*6),this._verticesBuffer&&t.deleteBuffer(this._verticesBuffer),this._verticesBuffer=t.createBuffer(),this._texCoordinateBuffer&&t.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=t.createBuffer(),this._indicesBuffer&&t.deleteBuffer(this._indicesBuffer),this._indicesBuffer=t.createBuffer();var s,c,a,l=this._indices,h=this._texCoordinates,u=this._isTextureFlipped,d=this._vertices;for(s=0;s<r.width;++s)for(c=0;c<r.height;++c){var _=c*r.width+s,p=s*this._step.x+this._gridRect.x,f=p+this._step.x,m=c*this._step.y+this._gridRect.y,g=m+this._step.y,y=s*(r.height+1)+c,v=(s+1)*(r.height+1)+c,T=(s+1)*(r.height+1)+(c+1),C=s*(r.height+1)+(c+1);l[6*_]=y,l[6*_+1]=v,l[6*_+2]=C,l[6*_+3]=v,l[6*_+4]=T,l[6*_+5]=C;var S=[3*y,3*v,3*T,3*C],x={x:p,y:m,z:0},A={x:f,y:m,z:0},E={x:f,y:g,z:0},b={x:p,y:g,z:0},R=[x,A,E,b],P=[2*y,2*v,2*T,2*C],w=[cc.p(p,m),cc.p(f,m),cc.p(f,g),cc.p(p,g)];for(a=0;a<4;++a)d[S[a]]=R[a].x,d[S[a]+1]=R[a].y,d[S[a]+2]=R[a].z,h[P[a]]=w[a].x/e,u?h[P[a]+1]=(n-w[a].y)/i:h[P[a]+1]=w[a].y/i}this._originalVertices=new Float32Array(this._vertices),t.bindBuffer(t.ARRAY_BUFFER,this._verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._texCoordinateBuffer),t.bufferData(t.ARRAY_BUFFER,this._texCoordinates,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),this._dirty=!0},setNeedDepthTestForBlit:function(t){this._needDepthTestForBlit=t},getNeedDepthTestForBlit:function(){return this._needDepthTestForBlit}}),cc.Grid3D.create=function(t,e,i){return new cc.Grid3D(t,e,i)},cc.TiledGrid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(t,e,i,n){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),void 0!==t&&this.initWithSize(t,e,i,n)},tile:function(t){return this.getTile(t)},getTile:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.tile() : Numbers must be integers");var e=4*(this._gridSize.height*t.x+t.y)*3,i=this._vertices;return new cc.Quad3(new cc.Vertex3F(i[e],i[e+1],i[e+2]),new cc.Vertex3F(i[e+3],i[e+4],i[e+5]),new cc.Vertex3F(i[e+6],i[e+7],i[e+8]),new cc.Vertex3F(i[e+9],i[e+10],i[e+11]))},getOriginalTile:function(t){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.originalTile() : Numbers must be integers");var e=4*(this._gridSize.height*t.x+t.y)*3,i=this._originalVertices;return new cc.Quad3(new cc.Vertex3F(i[e],i[e+1],i[e+2]),new cc.Vertex3F(i[e+3],i[e+4],i[e+5]),new cc.Vertex3F(i[e+6],i[e+7],i[e+8]),new cc.Vertex3F(i[e+9],i[e+10],i[e+11]))},originalTile:function(t){return this.getOriginalTile(t)},setTile:function(t,e){t.x===(0|t.x)&&t.y===(0|t.y)||cc.log("cc.TiledGrid3D.setTile() : Numbers must be integers");var i=12*(this._gridSize.height*t.x+t.y),n=this._vertices;n[i]=e.bl.x,n[i+1]=e.bl.y,n[i+2]=e.bl.z,n[i+3]=e.br.x,n[i+4]=e.br.y,n[i+5]=e.br.z,n[i+6]=e.tl.x,n[i+7]=e.tl.y,n[i+8]=e.tl.z,n[i+9]=e.tr.x,n[i+10]=e.tr.y,n[i+11]=e.tr.z,this._dirty=!0},blit:function(t){var e=this._gridSize.width*this._gridSize.height,i=t._renderCmd._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix);var n=cc._renderContext,r=this._dirty;n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),n.bindBuffer(n.ARRAY_BUFFER,this._verticesBuffer),r&&n.bufferData(n.ARRAY_BUFFER,this._vertices,n.DYNAMIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,0,this._vertices),n.bindBuffer(n.ARRAY_BUFFER,this._texCoordinateBuffer),r&&n.bufferData(n.ARRAY_BUFFER,this._texCoordinates,n.DYNAMIC_DRAW),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,0,this._texCoordinates),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),r&&n.bufferData(n.ELEMENT_ARRAY_BUFFER,this._indices,n.STATIC_DRAW),n.drawElements(n.TRIANGLES,6*e,n.UNSIGNED_SHORT,0),r&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(this._reuseGrid>0){for(var t=this._vertices,e=this._originalVertices,i=0;i<t.length;i++)e[i]=t[i];--this._reuseGrid}},calculateVertexPoints:function(){var t=this._texture.pixelsWidth,e=this._texture.pixelsHeight,i=this._texture.getContentSizeInPixels().height,n=this._gridSize,r=n.width*n.height;this._vertices=new Float32Array(12*r),this._texCoordinates=new Float32Array(8*r),this._indices=new Uint16Array(6*r);var o=cc._renderContext;this._verticesBuffer&&o.deleteBuffer(this._verticesBuffer),this._verticesBuffer=o.createBuffer(),this._texCoordinateBuffer&&o.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=o.createBuffer(),this._indicesBuffer&&o.deleteBuffer(this._indicesBuffer),this._indicesBuffer=o.createBuffer();var s,c,a=0,l=this._step,h=this._vertices,u=this._texCoordinates,d=this._isTextureFlipped;for(s=0;s<n.width;s++)for(c=0;c<n.height;c++){var _=s*l.x,p=_+l.x,f=c*l.y,m=f+l.y;h[12*a]=_,h[12*a+1]=f,h[12*a+2]=0,h[12*a+3]=p,h[12*a+4]=f,h[12*a+5]=0,h[12*a+6]=_,h[12*a+7]=m,h[12*a+8]=0,h[12*a+9]=p,h[12*a+10]=m,h[12*a+11]=0;var g=f,y=m;d&&(g=i-f,y=i-m),u[8*a]=_/t,u[8*a+1]=g/e,u[8*a+2]=p/t,u[8*a+3]=g/e,u[8*a+4]=_/t,u[8*a+5]=y/e,u[8*a+6]=p/t,u[8*a+7]=y/e,a++}var v=this._indices;for(s=0;s<r;s++)v[6*s+0]=4*s+0,v[6*s+1]=4*s+1,v[6*s+2]=4*s+2,v[6*s+3]=4*s+1,v[6*s+4]=4*s+2,v[6*s+5]=4*s+3;this._originalVertices=new Float32Array(this._vertices),o.bindBuffer(o.ARRAY_BUFFER,this._verticesBuffer),o.bufferData(o.ARRAY_BUFFER,this._vertices,o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this._texCoordinateBuffer),o.bufferData(o.ARRAY_BUFFER,this._texCoordinates,o.DYNAMIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,this._indices,o.DYNAMIC_DRAW),this._dirty=!0}}),cc.TiledGrid3D.create=function(t,e,i){return new cc.TiledGrid3D(t,e,i)},cc.Grabber=cc.Class.extend({_FBO:null,_oldFBO:null,_oldClearColor:null,_gl:null,ctor:function(){cc.sys._checkWebGLRenderMode(),this._gl=cc._renderContext,this._oldClearColor=[0,0,0,0],this._oldFBO=null,this._FBO=this._gl.createFramebuffer()},grab:function(t){var e=this._gl;this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this._FBO),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t._webTextureObj,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER);i!==e.FRAMEBUFFER_COMPLETE&&cc.log("Frame Grabber: could not attach texture to frmaebuffer"),e.bindFramebuffer(e.FRAMEBUFFER,this._oldFBO)},beforeRender:function(t){var e=this._gl;this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this._FBO),this._oldClearColor=e.getParameter(e.COLOR_CLEAR_VALUE),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)},afterRender:function(t){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._oldFBO),e.colorMask(!0,!0,!0,!0)},destroy:function(){this._gl.deleteFramebuffer(this._FBO)}});cc.GridAction=cc.ActionInterval.extend({_gridSize:null,_gridNodeTarget:null,ctor:function(t,e){cc.sys._checkWebGLRenderMode(),cc.ActionInterval.prototype.ctor.call(this),this._gridSize=cc.size(0,0),e&&this.initWithDuration(t,e)},_cacheTargetAsGridNode:function(t){this._gridNodeTarget=t},clone:function(){var t=new cc.GridAction,e=this._gridSize;return t.initWithDuration(this._duration,cc.size(e.width,e.height)),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0,this._cacheTargetAsGridNode(t);var e=this.getGrid(),i=this._gridNodeTarget.getGrid();if(i&&i.getReuseGrid()>0){var n=i.getGridSize();i.isActive()&&n.width===this._gridSize.width&&n.height===this._gridSize.height&&i.reuse()}else i&&i.isActive()&&i.setActive(!1),this._gridNodeTarget.setGrid(e),this._gridNodeTarget.getGrid().setActive(!0)},reverse:function(){return new cc.ReverseTime(this)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._gridSize.width=e.width,this._gridSize.height=e.height,!0)},getGrid:function(){cc.log("cc.GridAction.getGrid(): it should be overridden in subclass.")}}),cc.gridAction=function(t,e){return new cc.GridAction(t,e)},cc.GridAction.create=cc.gridAction,cc.Grid3DAction=cc.GridAction.extend({getGrid:function(){return new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())},getGridRect:function(){return this._gridNodeTarget.getGridRect()},vertex:function(t){return this.getVertex(t)},getVertex:function(t){return this.target.grid.getVertex(t)},originalVertex:function(t){return this.getOriginalVertex(t)},getOriginalVertex:function(t){return this.target.grid.originalVertex(t)},setVertex:function(t,e){this.target.grid.setVertex(t,e)}}),cc.grid3DAction=function(t,e){return new cc.Grid3DAction(t,e)},cc.Grid3DAction.create=cc.grid3DAction,cc.TiledGrid3DAction=cc.GridAction.extend({tile:function(t){return this.getTile(t)},getTile:function(t){return this.target.grid.tile(t)},originalTile:function(t){return this.getOriginalTile(t)},getOriginalTile:function(t){return this.target.grid.originalTile(t)},setTile:function(t,e){this.target.grid.setTile(t,e)},getGrid:function(){return new cc.TiledGrid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())}}),cc.tiledGrid3DAction=function(t,e){return new cc.TiledGrid3DAction(t,e)},cc.TiledGrid3DAction.create=cc.tiledGrid3DAction,cc.StopGrid=cc.ActionInstant.extend({startWithTarget:function(t){cc.ActionInstant.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0;var e=this.target.grid;e&&e.isActive()&&e.setActive(!1)}}),cc.stopGrid=function(){return new cc.StopGrid},cc.StopGrid.create=cc.stopGrid,cc.ReuseGrid=cc.ActionInstant.extend({_times:null,ctor:function(t){cc.ActionInstant.prototype.ctor.call(this),void 0!==t&&this.initWithTimes(t)},initWithTimes:function(t){return this._times=t,!0},startWithTarget:function(t){cc.ActionInstant.prototype.startWithTarget.call(this,t),cc.renderer.childrenOrderDirty=!0,this.target.grid&&this.target.grid.isActive()&&this.target.grid.setReuseGrid(this.target.grid.getReuseGrid()+this._times)}}),cc.reuseGrid=function(t){return new cc.ReuseGrid(t)},cc.ReuseGrid.create=cc.reuseGrid,cc.Waves3D=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e=this._gridSize,i=this._amplitude,n=cc.p(0,0),r=this._amplitudeRate,o=this._waves,s=0;s<e.width+1;++s)for(var c=0;c<e.height+1;++c){n.x=s,n.y=c;var a=this.originalVertex(n);a.z+=Math.sin(Math.PI*t*o*2+.01*(a.y+a.x))*i*r,this.setVertex(n,a)}}}),cc.waves3D=function(t,e,i,n){return new cc.Waves3D(t,e,i,n)},cc.Waves3D.create=cc.waves3D,cc.FlipX3D=cc.Grid3DAction.extend({ctor:function(t){void 0!==t?cc.GridAction.prototype.ctor.call(this,t,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},initWithDuration:function(t){return cc.Grid3DAction.prototype.initWithDuration.call(this,t,cc.size(1,1))},initWithSize:function(t,e){return 1!==t.width||1!==t.height?(cc.log("Grid size must be (1,1)"),!1):cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)},update:function(t){var e=Math.PI*t,i=Math.sin(e);e/=2;var n=Math.cos(e),r=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var s=this.originalVertex(o);o.x=o.y=0;var c,a,l,h,u,d=this.originalVertex(o),_=s.x,p=d.x;_>p?(a=cc.p(0,0),l=cc.p(0,1),h=cc.p(1,0),u=cc.p(1,1),c=_):(h=cc.p(0,0),u=cc.p(0,1),a=cc.p(1,0),l=cc.p(1,1),c=p),r.x=c-c*n,r.z=Math.abs(parseFloat(c*i/4));var f=this.originalVertex(a);f.x=r.x,f.z+=r.z,this.setVertex(a,f),f=this.originalVertex(l),f.x=r.x,f.z+=r.z,this.setVertex(l,f),f=this.originalVertex(h),f.x-=r.x,f.z-=r.z,this.setVertex(h,f),f=this.originalVertex(u),f.x-=r.x,f.z-=r.z,this.setVertex(u,f)}}),cc.flipX3D=function(t){return new cc.FlipX3D(t)},cc.FlipX3D.create=cc.flipX3D,cc.FlipY3D=cc.FlipX3D.extend({ctor:function(t){void 0!==t?cc.GridAction.prototype.ctor.call(this,t,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},update:function(t){var e=Math.PI*t,i=Math.sin(e);e/=2;var n=Math.cos(e),r=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var s=this.originalVertex(o);o.x=o.y=0;var c,a,l,h,u,d=this.originalVertex(o),_=s.y,p=d.y;_>p?(a=cc.p(0,0),l=cc.p(0,1),h=cc.p(1,0),u=cc.p(1,1),c=_):(l=cc.p(0,0),a=cc.p(0,1),u=cc.p(1,0),h=cc.p(1,1),c=p),r.y=c-c*n,r.z=Math.abs(parseFloat(c*i)/4);var f=this.originalVertex(a);f.y=r.y,f.z+=r.z,this.setVertex(a,f),f=this.originalVertex(l),f.y-=r.y,f.z-=r.z,this.setVertex(l,f),f=this.originalVertex(h),f.y=r.y,f.z+=r.z,this.setVertex(h,f),f=this.originalVertex(u),f.y-=r.y,f.z-=r.z,this.setVertex(u,f)}}),cc.flipY3D=function(t){return new cc.FlipY3D(t)},cc.FlipY3D.create=cc.flipY3D,cc.Lens3D=cc.Grid3DAction.extend({_position:null,_radius:0,_lensEffect:0,_concave:!1,_dirty:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==n&&this.initWithDuration(t,e,i,n)},getLensEffect:function(){return this._lensEffect},setLensEffect:function(t){this._lensEffect=t},setConcave:function(t){this._concave=t},getPosition:function(){return this._position},setPosition:function(t){cc.pointEqualToPoint(t,this._position)||(this._position.x=t.x,this._position.y=t.y,this._dirty=!0)},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._radius=n,this._lensEffect=.7,this._dirty=!0,!0)},update:function(t){if(this._dirty){for(var e,i,n,r,o,s=this._gridSize.width,c=this._gridSize.height,a=this._radius,l=this._lensEffect,h=cc.p(0,0),u=cc.p(0,0),d=0;d<s+1;++d)for(var _=0;_<c+1;++_)h.x=d,h.y=_,e=this.originalVertex(h),u.x=this._position.x-e.x,u.y=this._position.y-e.y,i=cc.pLength(u),i<a&&(i=a-i,o=i/a,0===o&&(o=.001),n=Math.log(o)*l,r=Math.exp(n)*a,i=cc.pLength(u),i>0&&(u.x=u.x/i,u.y=u.y/i,u.x=u.x*r,u.y=u.y*r,e.z+=cc.pLength(u)*l)),this.setVertex(h,e);this._dirty=!1}}}),cc.lens3D=function(t,e,i,n){return new cc.Lens3D(t,e,i,n)},cc.Lens3D.create=cc.lens3D,cc.Ripple3D=cc.Grid3DAction.extend({_position:null,_radius:0,_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n,r,o){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==o&&this.initWithDuration(t,e,i,n,r,o)},getPosition:function(){return this._position},setPosition:function(t){this._position.x=t.x,this._position.y=t.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,r,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._radius=n,this._waves=r,this._amplitude=o,this._amplitudeRate=1,!0)},update:function(t){for(var e,i,n=this._gridSize.width,r=this._gridSize.height,o=cc.p(0,0),s=this._radius,c=this._waves,a=this._amplitude,l=this._amplitudeRate,h=cc.p(0,0),u=0;u<n+1;++u)for(var d=0;d<r+1;++d){if(o.x=u,o.y=d,e=this.originalVertex(o),h.x=this._position.x-e.x,h.y=this._position.y-e.y,i=cc.pLength(h),i<s){i=s-i;var _=Math.pow(i/s,2);e.z+=Math.sin(t*Math.PI*c*2+.1*i)*a*l*_}this.setVertex(o,e)}}}),cc.ripple3D=function(t,e,i,n,r,o){return new cc.Ripple3D(t,e,i,n,r,o)},cc.Ripple3D.create=cc.ripple3D,cc.Shaky3D=cc.Grid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(t){for(var e,i=this._gridSize.width,n=this._gridSize.height,r=this._randRange,o=this._shakeZ,s=cc.p(0,0),c=0;c<i+1;++c)for(var a=0;a<n+1;++a)s.x=c,s.y=a,e=this.originalVertex(s),e.x+=cc.rand()%(2*r)-r,e.y+=cc.rand()%(2*r)-r,o&&(e.z+=cc.rand()%(2*r)-r),this.setVertex(s,e)}}),cc.shaky3D=function(t,e,i,n){return new cc.Shaky3D(t,e,i,n)},cc.Shaky3D.create=cc.shaky3D,cc.Liquid=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e,i=this._gridSize.width,n=this._gridSize.height,r=cc.p(0,0),o=this._waves,s=this._amplitude,c=this._amplitudeRate,a=1;a<i;++a)for(var l=1;l<n;++l)r.x=a,r.y=l,e=this.originalVertex(r),e.x=e.x+Math.sin(t*Math.PI*o*2+.01*e.x)*s*c,e.y=e.y+Math.sin(t*Math.PI*o*2+.01*e.y)*s*c,this.setVertex(r,e)}}),cc.liquid=function(t,e,i,n){return new cc.Liquid(t,e,i,n)},cc.Liquid.create=cc.liquid,cc.Waves=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,_vertical:!1,_horizontal:!1,ctor:function(t,e,i,n,r,o){cc.GridAction.prototype.ctor.call(this),void 0!==o&&this.initWithDuration(t,e,i,n,r,o)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,r,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,this._horizontal=r,this._vertical=o,!0)},update:function(t){for(var e,i=this._gridSize.width,n=this._gridSize.height,r=cc.p(0,0),o=this._vertical,s=this._horizontal,c=this._waves,a=this._amplitude,l=this._amplitudeRate,h=0;h<i+1;++h)for(var u=0;u<n+1;++u)r.x=h,r.y=u,e=this.originalVertex(r),o&&(e.x=e.x+Math.sin(t*Math.PI*c*2+.01*e.y)*a*l),s&&(e.y=e.y+Math.sin(t*Math.PI*c*2+.01*e.x)*a*l),this.setVertex(r,e)}}),cc.waves=function(t,e,i,n,r,o){return new cc.Waves(t,e,i,n,r,o)},cc.Waves.create=cc.waves,cc.Twirl=cc.Grid3DAction.extend({_position:null,_twirls:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n,r){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==r&&this.initWithDuration(t,e,i,n,r)},getPosition:function(){return this._position},setPosition:function(t){this._position.x=t.x,this._position.y=t.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n,r){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)&&(this.setPosition(i),this._twirls=n,this._amplitude=r,this._amplitudeRate=1,!0)},update:function(t){for(var e,i,n,r,o=this._position,s=this._gridSize.width,c=this._gridSize.height,a=cc.p(0,0),l=.1*this._amplitude*this._amplitudeRate,h=this._twirls,u=cc.p(0,0),d=0;d<s+1;++d)for(var _=0;_<c+1;++_)a.x=d,a.y=_,e=this.originalVertex(a),u.x=d-s/2,u.y=_-c/2,i=cc.pLength(u)*Math.cos(Math.PI/2+t*Math.PI*h*2)*l,n=Math.sin(i)*(e.y-o.y)+Math.cos(i)*(e.x-o.x),r=Math.cos(i)*(e.y-o.y)-Math.sin(i)*(e.x-o.x),e.x=o.x+n,e.y=o.y+r,this.setVertex(a,e)}}),cc.twirl=function(t,e,i,n,r){return new cc.Twirl(t,e,i,n,r)},cc.Twirl.create=cc.twirl,cc.ShakyTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._randRange=i,this._shakeZ=n,!0)},update:function(t){for(var e=this._gridSize,i=this._randRange,n=cc.p(0,0),r=0;r<e.width;++r)for(var o=0;o<e.height;++o){n.x=r,n.y=o;var s=this.originalTile(n);s.bl.x+=cc.rand()%(2*i)-i,s.br.x+=cc.rand()%(2*i)-i,s.tl.x+=cc.rand()%(2*i)-i,s.tr.x+=cc.rand()%(2*i)-i,s.bl.y+=cc.rand()%(2*i)-i,s.br.y+=cc.rand()%(2*i)-i,s.tl.y+=cc.rand()%(2*i)-i,s.tr.y+=cc.rand()%(2*i)-i,this._shakeZ&&(s.bl.z+=cc.rand()%(2*i)-i,s.br.z+=cc.rand()%(2*i)-i,s.tl.z+=cc.rand()%(2*i)-i,s.tr.z+=cc.rand()%(2*i)-i),this.setTile(n,s)}}}),cc.shakyTiles3D=function(t,e,i,n){return new cc.ShakyTiles3D(t,e,i,n)},cc.ShakyTiles3D.create=cc.shakyTiles3D,cc.ShatteredTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_once:!1,_shatterZ:!1,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._once=!1,this._randRange=i,this._shatterZ=n,!0)},update:function(t){if(this._once===!1){for(var e,i=this._gridSize,n=this._randRange,r=cc.p(0,0),o=0;o<i.width;++o)for(var s=0;s<i.height;++s)r.x=o,r.y=s,e=this.originalTile(r),e.bl.x+=cc.rand()%(2*n)-n,e.br.x+=cc.rand()%(2*n)-n,e.tl.x+=cc.rand()%(2*n)-n,e.tr.x+=cc.rand()%(2*n)-n,e.bl.y+=cc.rand()%(2*n)-n,e.br.y+=cc.rand()%(2*n)-n,e.tl.y+=cc.rand()%(2*n)-n,e.tr.y+=cc.rand()%(2*n)-n,this._shatterZ&&(e.bl.z+=cc.rand()%(2*n)-n,e.br.z+=cc.rand()%(2*n)-n,e.tl.z+=cc.rand()%(2*n)-n,e.tr.z+=cc.rand()%(2*n)-n),this.setTile(r,e);this._once=!0}}}),cc.shatteredTiles3D=function(t,e,i,n){return new cc.ShatteredTiles3D(t,e,i,n)},cc.ShatteredTiles3D.create=cc.shatteredTiles3D,cc.Tile=function(t,e,i){this.position=t||cc.p(0,0),this.startPosition=e||cc.p(0,0),this.delta=i||cc.p(0,0)},cc.ShuffleTiles=cc.TiledGrid3DAction.extend({_seed:0,_tilesCount:0,_tilesOrder:null,_tiles:null,ctor:function(t,e,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],this._tiles=[],void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._seed=i,this._tilesOrder.length=0,this._tiles.length=0,!0)},shuffle:function(t,e){for(var i=e-1;i>=0;i--){var n=0|cc.rand()%(i+1),r=t[i];t[i]=t[n],t[n]=r}},getDelta:function(t){var e=this._gridSize,i=t.width*e.height+t.height;return cc.size(this._tilesOrder[i]/e.height-t.width,this._tilesOrder[i]%e.height-t.height)},placeTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep(),r=e.position;i.bl.x+=r.x*n.x,i.bl.y+=r.y*n.y,i.br.x+=r.x*n.x,i.br.y+=r.y*n.y,i.tl.x+=r.x*n.x,i.tl.y+=r.y*n.y,i.tr.x+=r.x*n.x,i.tr.y+=r.y*n.y,this.setTile(t,i)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t);var e=this._gridSize;this._tilesCount=e.width*e.height;var i=this._tilesOrder;i.length=0;for(var n=0;n<this._tilesCount;++n)i[n]=n;this.shuffle(i,this._tilesCount);var r=this._tiles;r.length=0;for(var o=0,s=cc.size(0,0),c=0;c<e.width;++c)for(var a=0;a<e.height;++a)r[o]=new cc.Tile,r[o].position=cc.p(c,a),r[o].startPosition=cc.p(c,a),s.width=c,s.height=a,r[o].delta=this.getDelta(s),++o},update:function(t){for(var e,i=0,n=this._gridSize,r=this._tiles,o=cc.p(0,0),s=0;s<n.width;++s)for(var c=0;c<n.height;++c)o.x=s,o.y=c,e=r[i],e.position.x=e.delta.width*t,e.position.y=e.delta.height*t,this.placeTile(o,e),++i}}),cc.shuffleTiles=function(t,e,i){return new cc.ShuffleTiles(t,e,i)},cc.ShuffleTiles.create=cc.shuffleTiles,cc.FadeOutTRTiles=cc.TiledGrid3DAction.extend({testFunc:function(t,e){var i=this._gridSize.width*e,n=this._gridSize.height*e;return i===this._gridSize.width&&n===this._gridSize.height?0:i+n===0?1:Math.pow((t.x+t.y)/(i+n),6)},turnOnTile:function(t){this.setTile(t,this.originalTile(t))},turnOffTile:function(t){this.setTile(t,new cc.Quad3)},transformTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep();i.bl.x+=n.x/2*(1-e),i.bl.y+=n.y/2*(1-e),i.br.x-=n.x/2*(1-e),i.br.y+=n.y/2*(1-e),i.tl.x+=n.x/2*(1-e),i.tl.y-=n.y/2*(1-e),i.tr.x-=n.x/2*(1-e),i.tr.y-=n.y/2*(1-e),this.setTile(t,i)},update:function(t){for(var e,i=this._gridSize,n=cc.p(0,0),r=0;r<i.width;++r)for(var o=0;o<i.height;++o)n.x=r,n.y=o,e=this.testFunc(n,t),0===e?this.turnOffTile(n):e<1?this.transformTile(n,e):this.turnOnTile(n)}}),cc.fadeOutTRTiles=function(t,e){return new cc.FadeOutTRTiles(t,e)},cc.FadeOutTRTiles.create=cc.fadeOutTRTiles,cc.FadeOutBLTiles=cc.FadeOutTRTiles.extend({testFunc:function(t,e){var i=this._gridSize.width*(1-e),n=this._gridSize.height*(1-e);return i+n===0?0:t.x+t.y===0?1:Math.pow((i+n)/(t.x+t.y),6)}}),cc.fadeOutBLTiles=function(t,e){return new cc.FadeOutBLTiles(t,e)},cc.FadeOutBLTiles.create=cc.fadeOutBLTiles,cc.FadeOutUpTiles=cc.FadeOutTRTiles.extend({testFunc:function(t,e){var i=this._gridSize.height*e;return i===this._gridSize.height?0:0===i?1:Math.pow(t.y/i,6)},transformTile:function(t,e){var i=this.originalTile(t),n=this.target.grid.getStep();i.bl.y+=n.y/2*(1-e),i.br.y+=n.y/2*(1-e),i.tl.y-=n.y/2*(1-e),i.tr.y-=n.y/2*(1-e),this.setTile(t,i)}}),cc.fadeOutUpTiles=function(t,e){return new cc.FadeOutUpTiles(t,e)},cc.FadeOutUpTiles.create=cc.fadeOutUpTiles,cc.FadeOutDownTiles=cc.FadeOutUpTiles.extend({testFunc:function(t,e){var i=this._gridSize.height*(1-e);return 0===i?0:0===t.y?1:Math.pow(i/t.y,6)}}),cc.fadeOutDownTiles=function(t,e){return new cc.FadeOutDownTiles(t,e)},cc.FadeOutDownTiles.create=cc.fadeOutDownTiles,cc.TurnOffTiles=cc.TiledGrid3DAction.extend({_seed:null,_tilesCount:0,_tilesOrder:null,ctor:function(t,e,i){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._seed=i||0,this._tilesOrder.length=0,!0)},shuffle:function(t,e){for(var i=e-1;i>=0;i--){var n=0|cc.rand()%(i+1),r=t[i];t[i]=t[n],t[n]=r}},turnOnTile:function(t){this.setTile(t,this.originalTile(t))},turnOffTile:function(t){this.setTile(t,new cc.Quad3)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._tilesCount=this._gridSize.width*this._gridSize.height;var e=this._tilesOrder;e.length=0;for(var i=0;i<this._tilesCount;++i)e[i]=i;this.shuffle(e,this._tilesCount)},update:function(t){for(var e,i=0|t*this._tilesCount,n=this._gridSize,r=cc.p(0,0),o=this._tilesOrder,s=0;s<this._tilesCount;s++)e=o[s],r.x=0|e/n.height,r.y=e%(0|n.height),s<i?this.turnOffTile(r):this.turnOnTile(r)}}),cc.turnOffTiles=function(t,e,i){return new cc.TurnOffTiles(t,e,i)},cc.TurnOffTiles.create=cc.turnOffTiles,cc.WavesTiles3D=cc.TiledGrid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._waves=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e,i=this._gridSize,n=this._waves,r=this._amplitude,o=this._amplitudeRate,s=cc.p(0,0),c=0;c<i.width;c++)for(var a=0;a<i.height;a++)s.x=c,s.y=a,e=this.originalTile(s),e.bl.z=Math.sin(t*Math.PI*n*2+.01*(e.bl.y+e.bl.x))*r*o,e.br.z=e.bl.z,e.tl.z=e.bl.z,e.tr.z=e.bl.z,this.setTile(s,e)}}),cc.wavesTiles3D=function(t,e,i,n){return new cc.WavesTiles3D(t,e,i,n)},cc.WavesTiles3D.create=cc.wavesTiles3D,cc.JumpTiles3D=cc.TiledGrid3DAction.extend({_jumps:0,_amplitude:0,_amplitudeRate:0,ctor:function(t,e,i,n){cc.GridAction.prototype.ctor.call(this),void 0!==n&&this.initWithDuration(t,e,i,n)},getAmplitude:function(){return this._amplitude},setAmplitude:function(t){this._amplitude=t},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(t){this._amplitudeRate=t},initWithDuration:function(t,e,i,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,e)&&(this._jumps=i,this._amplitude=n,this._amplitudeRate=1,!0)},update:function(t){for(var e,i=Math.sin(Math.PI*t*this._jumps*2)*this._amplitude*this._amplitudeRate,n=Math.sin(Math.PI*(t*this._jumps*2+1))*this._amplitude*this._amplitudeRate,r=this._gridSize,o=this.target.grid,s=cc.p(0,0),c=0;c<r.width;c++)for(var a=0;a<r.height;a++)s.x=c,s.y=a,e=o.originalTile(s),(c+a)%2===0?(e.bl.z+=i,e.br.z+=i,e.tl.z+=i,e.tr.z+=i):(e.bl.z+=n,e.br.z+=n,e.tl.z+=n,e.tr.z+=n),o.setTile(s,e)}}),cc.jumpTiles3D=function(t,e,i,n){return new cc.JumpTiles3D(t,e,i,n)},cc.JumpTiles3D.create=cc.jumpTiles3D,cc.SplitRows=cc.TiledGrid3DAction.extend({_rows:0,_winSize:null,ctor:function(t,e){cc.GridAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return this._rows=e,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,cc.size(1,e))},update:function(t){for(var e,i,n=this._gridSize,r=this._winSize.width,o=cc.p(0,0),s=0;s<n.height;++s)o.y=s,e=this.originalTile(o),i=1,s%2===0&&(i=-1),e.bl.x+=i*r*t,e.br.x+=i*r*t,e.tl.x+=i*r*t,e.tr.x+=i*r*t,this.setTile(o,e)},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitRows=function(t,e){return new cc.SplitRows(t,e)},cc.SplitRows.create=cc.splitRows,cc.SplitCols=cc.TiledGrid3DAction.extend({_cols:0,_winSize:null,ctor:function(t,e){cc.GridAction.prototype.ctor.call(this),void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return this._cols=e,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,t,cc.size(e,1))},update:function(t){for(var e,i,n=this._gridSize.width,r=this._winSize.height,o=cc.p(0,0),s=0;s<n;++s)o.x=s,e=this.originalTile(o),i=1,s%2===0&&(i=-1),e.bl.y+=i*r*t,e.br.y+=i*r*t,e.tl.y+=i*r*t,e.tr.y+=i*r*t,this.setTile(o,e);cc.renderer.childrenOrderDirty=!0},startWithTarget:function(t){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,t),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitCols=function(t,e){return new cc.SplitCols(t,e)},cc.SplitCols.create=cc.splitCols,cc.PageTurn3D=cc.Grid3DAction.extend({getGrid:function(){var t=new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect());return t.setNeedDepthTestForBlit(!0),t},clone:function(){var t=new cc.PageTurn3D;return t.initWithDuration(this._duration,this._gridSize),t},update:function(t){for(var e=Math.max(0,t-.25),i=e*e*500,n=-100-i,r=Math.sqrt(t),o=r>.5?Math.PI/2*r:Math.PI/2*(1-r),s=(2-t)*Math.PI,c=Math.sin(o),a=Math.cos(o),l=this._gridSize,h=cc.p(0,0),u=0;u<=l.width;++u)for(var d=0;d<=l.height;++d){h.x=u,h.y=d;var _=this.getOriginalVertex(h);_.x-=this.getGridRect().x;var p=Math.sqrt(_.x*_.x+(_.y-n)*(_.y-n)),f=p*c,m=Math.asin(_.x/p),g=m/c,y=Math.cos(g);g<=Math.PI?_.x=f*Math.sin(g):_.x=0,_.y=p+n-f*(1-y)*c,_.z=f*(1-y)*a,_.x=_.z*Math.sin(s)+_.x*Math.cos(s),_.z=_.z*Math.cos(s)-_.x*Math.cos(s),_.z/=7,_.z<.5&&(_.z=.5),_.x+=this.getGridRect().x,this.setVertex(h,_)}}}),cc.pageTurn3D=function(t,e){return new cc.PageTurn3D(t,e)},cc.PageTurn3D.create=cc.pageTurn3D;cc.ProgressTimer=cc.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",ctor:function(t){cc.Node.prototype.ctor.call(this),this._type=cc.ProgressTimer.TYPE_RADIAL,this._percentage=0,this._midPoint=cc.p(0,0),this._barChangeRate=cc.p(0,0),this._reverseDirection=!1,this._sprite=null,t&&this.initWithSprite(t)},onEnter:function(){this._super(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._renderCmd.initCmd(),this._renderCmd._updateProgress())},cleanup:function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&this._renderCmd.releaseData(),this._super()},getMidpoint:function(){return cc.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(t){this._midPoint=cc.pClamp(t,cc.p(0,0),cc.p(1,1))},getBarChangeRate:function(){return cc.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(t){this._barChangeRate=cc.pClamp(t,cc.p(0,0),cc.p(1,1))},getType:function(){return this._type},getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(t){this._percentage!==t&&(this._percentage=cc.clampf(t,0,100),this._renderCmd._updateProgress())},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},setColor:function(t){this._sprite.color=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setOpacity:function(t){this._sprite.opacity=t,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:function(t){this._reverseDirection!==t&&(this._reverseDirection=t,this._renderCmd.resetVertexData())},setSprite:function(t){this._sprite!==t&&(this._sprite=t,t?(this.setContentSize(t.width,t.height),t.ignoreAnchorPointForPosition(!0)):this.setContentSize(0,0),this._renderCmd.resetVertexData())},setType:function(t){t!==this._type&&(this._type=t,this._renderCmd.resetVertexData())},setReverseDirection:function(t){this._reverseDirection!==t&&(this._reverseDirection=t,this._renderCmd.resetVertexData())},initWithSprite:function(t){return this.percentage=0,this.setAnchorPoint(.5,.5),this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),this.barChangeRate=cc.p(1,1),this.setSprite(t),this._renderCmd.resetVertexData(),!0},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ProgressTimer.CanvasRenderCmd(this):new cc.ProgressTimer.WebGLRenderCmd(this)}});var _p=cc.ProgressTimer.prototype;_p.midPoint,cc.defineGetterSetter(_p,"midPoint",_p.getMidpoint,_p.setMidpoint),_p.barChangeRate,cc.defineGetterSetter(_p,"barChangeRate",_p.getBarChangeRate,_p.setBarChangeRate),_p.type,cc.defineGetterSetter(_p,"type",_p.getType,_p.setType),_p.percentage,cc.defineGetterSetter(_p,"percentage",_p.getPercentage,_p.setPercentage),_p.sprite,cc.defineGetterSetter(_p,"sprite",_p.getSprite,_p.setSprite),_p.reverseDir,cc.defineGetterSetter(_p,"reverseDir",_p.isReverseDirection,_p.setReverseDirection),cc.ProgressTimer.create=function(t){return new cc.ProgressTimer(t)},cc.ProgressTimer.TEXTURE_COORDS_COUNT=4,cc.ProgressTimer.TEXTURE_COORDS=75,cc.ProgressTimer.TYPE_RADIAL=0,cc.ProgressTimer.TYPE_BAR=1,function(){cc.ProgressTimer.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._PI180=Math.PI/180,this._barRect=cc.rect(0,0,0,0),this._origin=cc.p(0,0),this._radius=0,this._startAngle=270,this._endAngle=270,this._counterClockWise=!1,this._canUseDirtyRegion=!0};var t=cc.ProgressTimer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ProgressTimer.CanvasRenderCmd,t.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),o=this._node,s=o._sprite,c=s._renderCmd._textureCoord,a=s._renderCmd._displayedOpacity/255;if(0!==c.width&&0!==c.height&&s._texture&&c.validRect&&0!==a){n.setTransform(this._worldTransform,e,i),n.setCompositeOperation(s._blendFuncStr),n.setGlobalAlpha(a);var l=s._rect,h=s._offsetPosition,u=h.x,d=-h.y-l.height,_=l.width,p=l.height;if(n.save(),s._flippedX&&(u=-u-_,r.scale(-1,1)),s._flippedY&&(d=h.y,r.scale(1,-1)),o._type===cc.ProgressTimer.TYPE_BAR){var f=this._barRect;r.beginPath(),r.rect(f.x,f.y,f.width,f.height),r.clip(),r.closePath()}else if(o._type===cc.ProgressTimer.TYPE_RADIAL){var m=this._origin.x,g=this._origin.y;r.beginPath(),r.arc(m,g,this._radius,this._PI180*this._startAngle,this._PI180*this._endAngle,this._counterClockWise),r.lineTo(m,g),r.clip(),r.closePath()}var y=s._renderCmd._textureToRender||s._texture,v=y.getHtmlElementObj();s._renderCmd._colorized?r.drawImage(v,0,0,c.width,c.height,u,d,_,p):r.drawImage(v,c.renderX,c.renderY,c.width,c.height,u,d,_,p),n.restore(),cc.g_NumberOfDraws++}},t.releaseData=function(){},t.resetVertexData=function(){},t._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);var t=this._node,e=t._sprite,i=e.width,n=e.height,r=t._midPoint;if(t._type===cc.ProgressTimer.TYPE_RADIAL){this._radius=Math.round(Math.sqrt(i*i+n*n));var o,s,c=!1,a=this._origin;a.x=i*r.x,a.y=-n*r.y,t._reverseDirection?(s=270,o=270-3.6*t._percentage):(o=-90,s=-90+3.6*t._percentage),e._flippedX&&(a.x-=i*(2*t._midPoint.x),o=-o,s=-s,o-=180,s-=180,c=!c),e._flippedY&&(a.y+=n*(2*t._midPoint.y),c=!c,o=-o,s=-s),this._startAngle=o,this._endAngle=s,this._counterClockWise=c}else{var l=t._barChangeRate,h=t._percentage/100,u=this._barRect,d=cc.size(i*(1-l.x),n*(1-l.y)),_=cc.size((i-d.width)*h,(n-d.height)*h),p=cc.size(d.width+_.width,d.height+_.height),f=cc.p(i*r.x,n*r.y),m=f.x-p.width/2;r.x>.5&&p.width/2>=i-f.x&&(m=i-p.width);var g=f.y-p.height/2;r.y>.5&&p.height/2>=n-f.y&&(g=n-p.height),u.x=0;var y=1;e._flippedX&&(u.x-=p.width,y=-1),m>0&&(u.x+=m*y),u.y=0;var v=1;e._flippedY&&(u.y+=p.height,v=-1),g>0&&(u.y-=g*v),u.width=p.width,u.height=-p.height}},t._syncStatus=function(t){var e=this._node;if(e._sprite){var i=cc.Node._dirtyFlags,n=this._dirtyFlag,r=t?t._node:null;r&&r._cascadeColorEnabled&&t._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),r&&r._cascadeOpacityEnabled&&t._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),t&&t._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var o=e._sprite._renderCmd,s=o._dirtyFlag,c=s&i.colorDirty,a=s&i.opacityDirty;c&&(o._syncDisplayColor(),o._dirtyFlag=o._dirtyFlag&i.colorDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&i.colorDirty^this._dirtyFlag),a&&(o._syncDisplayOpacity(),o._dirtyFlag=o._dirtyFlag&i.opacityDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&i.opacityDirty^this._dirtyFlag),(c||a)&&o._updateColor(),n&i.transformDirty&&this.transform(t),n&i.orderDirty&&(this._dirtyFlag=this._dirtyFlag&i.orderDirty^this._dirtyFlag)}},t.updateStatus=function(){var t=this._node;if(t._sprite){var e=cc.Node._dirtyFlags,i=this._dirtyFlag,n=t._sprite._renderCmd,r=n._dirtyFlag,o=r&e.colorDirty,s=r&e.opacityDirty;o&&(n._updateDisplayColor(),n._dirtyFlag=n._dirtyFlag&e.colorDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&e.colorDirty^this._dirtyFlag),s&&(n._updateDisplayOpacity(),n._dirtyFlag=n._dirtyFlag&e.opacityDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&e.opacityDirty^this._dirtyFlag),(o||s)&&n._updateColor(),i&e.transformDirty&&this.transform(this.getParentRenderCmd(),!0),i&e.contentDirty&&this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag=0}}}(),cc.ProgressTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(t,e){cc.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=e,!0)},clone:function(){var t=new cc.ProgressTo;return t.initWithDuration(this._duration,this._to),t},reverse:function(){return cc.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=t.percentage},update:function(t){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*t)}}),cc.progressTo=function(t,e){return new cc.ProgressTo(t,e)},cc.ProgressTo.create=cc.progressTo,cc.ProgressFromTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(t,e,i){cc.ActionInterval.prototype.ctor.call(this),this._to=0,this._from=0,void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=i,this._from=e,!0)},clone:function(){var t=new cc.ProgressFromTo;return t.initWithDuration(this._duration,this._from,this._to),t},reverse:function(){return cc.progressFromTo(this._duration,this._to,this._from)},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t)},update:function(t){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*t)}}),cc.progressFromTo=function(t,e,i){return new cc.ProgressFromTo(t,e,i)},cc.ProgressFromTo.create=cc.progressFromTo;!function(){var t=8;cc.ProgressTimer.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._progressDirty=!0,this._bl=cc.p(),this._tr=cc.p(),this.initCmd()};var e=cc.ProgressTimer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ProgressTimer.WebGLRenderCmd,e.transform=function(t,e){this.originTransform(t,e);var i=this._node._sprite;i._renderCmd.transform(this,e);var n=i._offsetPosition.x,r=n+i._rect.width,o=i._offsetPosition.y,s=o+i._rect.height,c=this._worldTransform;this._bl.x=n*c.a+o*c.c+c.tx,this._bl.y=n*c.b+o*c.d+c.ty,this._tr.x=r*c.a+s*c.c+c.tx,this._tr.y=r*c.b+s*c.d+c.ty,this._updateProgressData()},e.rendering=function(t){var e=this._node,i=t||cc._renderContext;if(0!==this._vertexDataCount&&e._sprite){this._shaderProgram.use(),this._shaderProgram._updateProjectionUniform();var n=e._sprite._blendFunc;cc.glBlendFunc(n.src,n.dst),cc.glBindTexture2D(e._sprite.texture),i.bindBuffer(i.ARRAY_BUFFER,this._vertexWebGLBuffer),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),this._vertexDataDirty&&(i.bufferSubData(i.ARRAY_BUFFER,0,this._float32View),this._vertexDataDirty=!1);var r=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,r,0),i.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,r,12),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,r,16),e._type===cc.ProgressTimer.TYPE_RADIAL?i.drawArrays(i.TRIANGLE_FAN,0,this._vertexDataCount):e._type===cc.ProgressTimer.TYPE_BAR&&(e._reverseDirection?(i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount/2),i.drawArrays(i.TRIANGLE_STRIP,4,this._vertexDataCount/2),cc.g_NumberOfDraws++):i.drawArrays(i.TRIANGLE_STRIP,0,this._vertexDataCount)),cc.g_NumberOfDraws++}},e._syncStatus=function(t){var e=this._node;if(e._sprite){var i=cc.Node._dirtyFlags,n=this._dirtyFlag,r=t?t._node:null;r&&r._cascadeColorEnabled&&t._dirtyFlag&i.colorDirty&&(n|=i.colorDirty),r&&r._cascadeOpacityEnabled&&t._dirtyFlag&i.opacityDirty&&(n|=i.opacityDirty),t&&t._dirtyFlag&i.transformDirty&&(n|=i.transformDirty),this._dirtyFlag=n;var o=e._sprite._renderCmd,s=o._dirtyFlag,c=(n|s)&i.colorDirty,a=(n|s)&i.opacityDirty;c&&(o._syncDisplayColor(),o._dirtyFlag=o._dirtyFlag&i.colorDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&i.colorDirty^this._dirtyFlag),a&&(o._syncDisplayOpacity(),o._dirtyFlag=o._dirtyFlag&i.opacityDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&i.opacityDirty^this._dirtyFlag),(c||a)&&this._updateColor(),n&i.transformDirty&&this.transform(t),n&i.textureDirty&&(this._updateProgressData(),this._dirtyFlag=this._dirtyFlag&i.textureDirty^this._dirtyFlag),o._dirtyFlag=0}},e.updateStatus=function(){var t=this._node;if(t._sprite){var e=cc.Node._dirtyFlags,i=this._dirtyFlag,n=t._sprite._renderCmd,r=n._dirtyFlag,o=(i|r)&e.colorDirty,s=(i|r)&e.opacityDirty;o&&(n._updateDisplayColor(),n._dirtyFlag=n._dirtyFlag&e.colorDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&e.colorDirty^this._dirtyFlag),s&&(n._updateDisplayOpacity(),n._dirtyFlag=n._dirtyFlag&e.opacityDirty^n._dirtyFlag,this._dirtyFlag=this._dirtyFlag&e.opacityDirty^this._dirtyFlag),(o||s)&&this._updateColor(),i&e.transformDirty&&this.transform(this.getParentRenderCmd(),!0),i&e.orderDirty&&(this._dirtyFlag=this._dirtyFlag&e.orderDirty^this._dirtyFlag),i&e.textureDirty&&(this._updateProgressData(),this._dirtyFlag=this._dirtyFlag&e.textureDirty^this._dirtyFlag)}},e.releaseData=function(){if(this._vertexData){var t=this._vertexWebGLBuffer;setTimeout(function(){cc._renderContext.deleteBuffer(t)},.1),this._vertexWebGLBuffer=null,this._vertexData=null,this._float32View=null,this._vertexArrayBuffer=null,this._vertexDataCount=0}},e.initCmd=function(){if(!this._vertexData){this._vertexWebGLBuffer=cc._renderContext.createBuffer();var e=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(t*e),this._float32View=new Float32Array(this._vertexArrayBuffer),this._vertexData=[];for(var i=0;i<t;i++)this._vertexData[i]=new cc.V3F_C4B_T2F(null,null,null,this._vertexArrayBuffer,i*e);gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexWebGLBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._float32View,gl.DYNAMIC_DRAW),this._vertexDataCount=0,this._vertexDataDirty=!0,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)}},e.resetVertexData=function(){this._vertexDataCount=0},e._updateProgressData=function(){var t=this._node,e=t._type;e===cc.ProgressTimer.TYPE_RADIAL?this._updateRadial():e===cc.ProgressTimer.TYPE_BAR&&this._updateBar(),this._vertexDataDirty=!0},e._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.textureDirty)},e._updateBar=function(){var t=this._node;if(t._sprite){var e=t._percentage/100,i=t._barChangeRate,n=cc.pMult(cc.p(1-i.x+e*i.x,1-i.y+e*i.y),.5),r=cc.pSub(t._midPoint,n),o=cc.pAdd(t._midPoint,n);r.x<0&&(o.x+=-r.x,r.x=0),o.x>1&&(r.x-=o.x-1,o.x=1),r.y<0&&(o.y+=-r.y,r.y=0),o.y>1&&(r.y-=o.y-1,o.y=1);var s;this._reverseDirection?(s=this._vertexData,this._vertexDataCount||(this._vertexDataCount=8,this._textureCoordFromAlphaPoint(s[0].texCoords,0,1),this._vertexFromAlphaPoint(s[0].vertices,0,1),this._textureCoordFromAlphaPoint(s[1].texCoords,0,0),this._vertexFromAlphaPoint(s[1].vertices,0,0),this._textureCoordFromAlphaPoint(s[6].texCoords,1,1),this._vertexFromAlphaPoint(s[6].vertices,1,1),this._textureCoordFromAlphaPoint(s[7].texCoords,1,0),this._vertexFromAlphaPoint(s[7].vertices,1,0)),this._textureCoordFromAlphaPoint(s[2].texCoords,r.x,o.y),this._vertexFromAlphaPoint(s[2].vertices,r.x,o.y),this._textureCoordFromAlphaPoint(s[3].texCoords,r.x,r.y),this._vertexFromAlphaPoint(s[3].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(s[4].texCoords,o.x,o.y),this._vertexFromAlphaPoint(s[4].vertices,o.x,o.y),this._textureCoordFromAlphaPoint(s[5].texCoords,o.x,r.y),this._vertexFromAlphaPoint(s[5].vertices,o.x,r.y)):(this._vertexDataCount||(this._vertexDataCount=4),s=this._vertexData,this._textureCoordFromAlphaPoint(s[0].texCoords,r.x,o.y),this._vertexFromAlphaPoint(s[0].vertices,r.x,o.y),this._textureCoordFromAlphaPoint(s[1].texCoords,r.x,r.y),this._vertexFromAlphaPoint(s[1].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(s[2].texCoords,o.x,o.y),this._vertexFromAlphaPoint(s[2].vertices,o.x,o.y),this._textureCoordFromAlphaPoint(s[3].texCoords,o.x,r.y),this._vertexFromAlphaPoint(s[3].vertices,o.x,r.y)),this._updateColor()}},e._updateRadial=function(){var t=this._node;if(t._sprite){var e,i,n=t._midPoint,r=t._percentage/100,o=2*cc.PI*(t._reverseDirection?r:1-r),s=cc.p(n.x,1),c=cc.pRotateByAngle(s,n,o),a=0;if(0===r)i=s,a=0;else if(1===r)i=s,a=4;else{var l=cc.FLT_MAX,h=cc.ProgressTimer.TEXTURE_COORDS_COUNT;for(e=0;e<=h;++e){var u=(e+(h-1))%h,d=this._boundaryTexCoord(e%h),_=this._boundaryTexCoord(u);0===e?_=cc.pLerp(d,_,1-n.x):4===e&&(d=cc.pLerp(d,_,1-n.x));var p=cc.p(0,0);if(cc.pLineIntersect(d,_,n,c,p)){if(!(0!==e&&4!==e||0<=p.x&&p.x<=1))continue;p.y>=0&&p.y<l&&(l=p.y,a=e)}}i=cc.pAdd(n,cc.pMult(cc.pSub(c,n),l))}var f=!0;this._vertexDataCount!==a+3&&(f=!1,this._vertexDataCount=a+3),this._updateColor();var m=this._vertexData;if(!f)for(this._textureCoordFromAlphaPoint(m[0].texCoords,n.x,n.y),this._vertexFromAlphaPoint(m[0].vertices,n.x,n.y),this._textureCoordFromAlphaPoint(m[1].texCoords,s.x,s.y),this._vertexFromAlphaPoint(m[1].vertices,s.x,s.y),e=0;e<a;e++){var g=this._boundaryTexCoord(e);this._textureCoordFromAlphaPoint(m[e+2].texCoords,g.x,g.y),this._vertexFromAlphaPoint(m[e+2].vertices,g.x,g.y)}this._textureCoordFromAlphaPoint(m[this._vertexDataCount-1].texCoords,i.x,i.y),this._vertexFromAlphaPoint(m[this._vertexDataCount-1].vertices,i.x,i.y)}},e._boundaryTexCoord=function(t){if(t<cc.ProgressTimer.TEXTURE_COORDS_COUNT){var e=cc.ProgressTimer.TEXTURE_COORDS;return this._node._reverseDirection?cc.p(e>>7-(t<<1)&1,e>>7-((t<<1)+1)&1):cc.p(e>>(t<<1)+1&1,e>>(t<<1)&1)}return cc.p(0,0)},e._textureCoordFromAlphaPoint=function(t,e,i){var n=this._node._sprite;if(!n)return t.u=0,void(t.v=0);var r=n._renderCmd._vertices,o=r[1],s=r[2],c=cc.p(o.u,o.v),a=cc.p(s.u,s.v);if(n.textureRectRotated){var l=e;e=i,i=l}t.u=c.x*(1-e)+a.x*e,t.v=c.y*(1-i)+a.y*i},e._vertexFromAlphaPoint=function(t,e,i){t.x=this._bl.x*(1-e)+this._tr.x*e,t.y=this._bl.y*(1-i)+this._tr.y*i,t.z=this._node._vertexZ},e._updateColor=function(){var t=this._node._sprite;if(this._vertexDataCount&&t){var e=this._displayedColor,i=t._renderCmd._displayedColor,n=i.r,r=i.g,o=i.b,s=t._renderCmd._displayedOpacity/255;t._opacityModifyRGB&&(n*=s,r*=s,o*=s),e.r=n,e.g=r,e.b=o,e.a=t._renderCmd._displayedOpacity;for(var c=this._vertexData,a=0,l=this._vertexDataCount;a<l;++a)c[a].colors=e;this._vertexDataDirty=!0}}}();cc.SCENE_FADE=4208917214,cc.TRANSITION_ORIENTATION_LEFT_OVER=0,cc.TRANSITION_ORIENTATION_RIGHT_OVER=1,cc.TRANSITION_ORIENTATION_UP_OVER=0,cc.TRANSITION_ORIENTATION_DOWN_OVER=1,cc.TransitionScene=cc.Scene.extend({_inScene:null,_outScene:null,_duration:null,_isInSceneOnTop:!1,_isSendCleanupToScene:!1,_className:"TransitionScene",ctor:function(t,e){cc.Scene.prototype.ctor.call(this),void 0!==t&&void 0!==e&&this.initWithDuration(t,e)},_setNewScene:function(t){this.unschedule(this._setNewScene);var e=cc.director;this._isSendCleanupToScene=e.isSendCleanupToScene(),e.runScene(this._inScene),cc.eventManager.setEnabled(!0),this._outScene.visible=!0},_sceneOrder:function(){this._isInSceneOnTop=!0},visit:function(){this._isInSceneOnTop?(this._outScene.visit(),this._inScene.visit()):(this._inScene.visit(),this._outScene.visit()),cc.Node.prototype.visit.call(this)},onEnter:function(){cc.Node.prototype.onEnter.call(this),cc.eventManager.setEnabled(!1),this._outScene.onExitTransitionDidStart(),this._inScene.onEnter()},onExit:function(){cc.Node.prototype.onExit.call(this),cc.eventManager.setEnabled(!0),this._outScene.onExit(),this._inScene.onEnterTransitionDidFinish()},cleanup:function(){cc.Node.prototype.cleanup.call(this),this._isSendCleanupToScene&&this._outScene.cleanup()},initWithDuration:function(t,e){if(!e)throw new Error("cc.TransitionScene.initWithDuration(): Argument scene must be non-nil");if(this.init()){if(this._duration=t,this.attr({x:0,y:0,anchorX:0,anchorY:0}),this._inScene=e,this._outScene=cc.director.getRunningScene(),this._outScene||(this._outScene=new cc.Scene,this._outScene.init()),this._inScene===this._outScene)throw new Error("cc.TransitionScene.initWithDuration(): Incoming scene must be different from the outgoing scene");return this._sceneOrder(),!0}return!1},finish:function(){this._inScene.attr({visible:!0,x:0,y:0,scale:1,rotation:0}),this._outScene.attr({visible:!1,x:0,y:0,scale:1,rotation:0}),this.schedule(this._setNewScene,0)},hideOutShowIn:function(){this._inScene.visible=!0,this._outScene.visible=!1}}),cc.TransitionScene.create=function(t,e){return new cc.TransitionScene(t,e)},cc.TransitionSceneOriented=cc.TransitionScene.extend({_orientation:0,ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),void 0!=i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return cc.TransitionScene.prototype.initWithDuration.call(this,t,e)&&(this._orientation=i),!0}}),cc.TransitionSceneOriented.create=function(t,e,i){return new cc.TransitionSceneOriented(t,e,i)},cc.TransitionRotoZoom=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:.5,anchorY:.5}),this._outScene.attr({scale:1,anchorX:.5,anchorY:.5});var t=cc.sequence(cc.spawn(cc.scaleBy(this._duration/2,.001),cc.rotateBy(this._duration/2,720)),cc.delayTime(this._duration/2));this._outScene.runAction(t),this._inScene.runAction(cc.sequence(t.reverse(),cc.callFunc(this.finish,this)))}}),cc.TransitionRotoZoom.create=function(t,e){return new cc.TransitionRotoZoom(t,e)},cc.TransitionJumpZoom=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=cc.director.getWinSize();this._inScene.attr({scale:.5,x:t.width,y:0,anchorX:.5,anchorY:.5}),this._outScene.anchorX=.5,this._outScene.anchorY=.5;var e=cc.jumpBy(this._duration/4,cc.p(-t.width,0),t.width/4,2),i=cc.scaleTo(this._duration/4,1),n=cc.scaleTo(this._duration/4,.5),r=cc.sequence(n,e),o=cc.sequence(e,i),s=cc.delayTime(this._duration/2);this._outScene.runAction(r),this._inScene.runAction(cc.sequence(s,o,cc.callFunc(this.finish,this)))}}),cc.TransitionJumpZoom.create=function(t,e){return new cc.TransitionJumpZoom(t,e)},cc.TransitionMoveInL=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var t=this.action();this._inScene.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this)))},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width,0)},action:function(){return cc.moveTo(this._duration,cc.p(0,0))},easeActionWithAction:function(t){return new cc.EaseOut(t,2)}}),cc.TransitionMoveInL.create=function(t,e){return new cc.TransitionMoveInL(t,e)},cc.TransitionMoveInR=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width,0)}}),cc.TransitionMoveInR.create=function(t,e){return new cc.TransitionMoveInR(t,e)},cc.TransitionMoveInT=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height)}}),cc.TransitionMoveInT.create=function(t,e){return new cc.TransitionMoveInT(t,e)},cc.TransitionMoveInB=cc.TransitionMoveInL.extend({ctor:function(t,e){cc.TransitionMoveInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},initScenes:function(){this._inScene.setPosition(0,-cc.director.getWinSize().height)}}),cc.TransitionMoveInB.create=function(t,e){return new cc.TransitionMoveInB(t,e)},cc.ADJUST_FACTOR=.5,cc.TransitionSlideInL=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var t=this.action(),e=this.action(),i=cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this)),n=this.easeActionWithAction(e);this._inScene.runAction(i),this._outScene.runAction(n)},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width+cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0))},easeActionWithAction:function(t){return new cc.EaseInOut(t,2)}}),cc.TransitionSlideInL.create=function(t,e){return new cc.TransitionSlideInL(t,e)},cc.TransitionSlideInR=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(-(cc.director.getWinSize().width-cc.ADJUST_FACTOR),0))}}),cc.TransitionSlideInR.create=function(t,e){return new cc.TransitionSlideInR(t,e)},cc.TransitionSlideInB=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},initScenes:function(){this._inScene.setPosition(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR))},action:function(){return cc.moveBy(this._duration,cc.p(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR))}}),cc.TransitionSlideInB.create=function(t,e){return new cc.TransitionSlideInB(t,e)},cc.TransitionSlideInT=cc.TransitionSlideInL.extend({ctor:function(t,e){cc.TransitionSlideInL.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height-cc.ADJUST_FACTOR)},action:function(){return cc.moveBy(this._duration,cc.p(0,-(cc.director.getWinSize().height-cc.ADJUST_FACTOR)))}}),cc.TransitionSlideInT.create=function(t,e){return new cc.TransitionSlideInT(t,e)},cc.TransitionShrinkGrow=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:2/3,anchorY:.5}),this._outScene.attr({scale:1,anchorX:1/3,anchorY:.5});var t=cc.scaleTo(this._duration,.01),e=cc.scaleTo(this._duration,1);this._inScene.runAction(cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this))),this._outScene.runAction(this.easeActionWithAction(t))},easeActionWithAction:function(t){return new cc.EaseOut(t,2)}}),cc.TransitionShrinkGrow.create=function(t,e){return new cc.TransitionShrinkGrow(t,e)},cc.TransitionFade=cc.TransitionScene.extend({_color:null,ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),this._color=cc.color(),e&&this.initWithDuration(t,e,i)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=new cc.LayerColor(this._color);this._inScene.visible=!1,this.addChild(t,2,cc.SCENE_FADE);var e=this.getChildByTag(cc.SCENE_FADE),i=cc.sequence(cc.fadeIn(this._duration/2),cc.callFunc(this.hideOutShowIn,this),cc.fadeOut(this._duration/2),cc.callFunc(this.finish,this));e.runAction(i)},onExit:function(){cc.TransitionScene.prototype.onExit.call(this),this.removeChildByTag(cc.SCENE_FADE,!1)},initWithDuration:function(t,e,i){return i=i||cc.color.BLACK,cc.TransitionScene.prototype.initWithDuration.call(this,t,e)&&(this._color.r=i.r,this._color.g=i.g,this._color.b=i.b,this._color.a=0),!0}}),cc.TransitionFade.create=function(t,e,i){return new cc.TransitionFade(t,e,i)},cc.TransitionCrossFade=cc.TransitionScene.extend({ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t=cc.color(0,0,0,0),e=cc.director.getWinSize(),i=new cc.LayerColor(t),n=new cc.RenderTexture(e.width,e.height);n.sprite.anchorX=.5,n.sprite.anchorY=.5,n.attr({x:e.width/2,y:e.height/2,anchorX:.5,anchorY:.5}),n.begin(),this._inScene.visit(),n.end();var r=new cc.RenderTexture(e.width,e.height);r.setPosition(e.width/2,e.height/2),r.sprite.anchorX=r.anchorX=.5,r.sprite.anchorY=r.anchorY=.5,r.begin(),this._outScene.visit(),r.end(),n.sprite.setBlendFunc(cc.ONE,cc.ONE),r.sprite.setBlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),i.addChild(n),i.addChild(r),n.sprite.opacity=255,r.sprite.opacity=255;var o=cc.sequence(cc.fadeTo(this._duration,0),cc.callFunc(this.hideOutShowIn,this),cc.callFunc(this.finish,this));r.sprite.runAction(o),this.addChild(i,2,cc.SCENE_FADE)},onExit:function(){this.removeChildByTag(cc.SCENE_FADE,!1),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){cc.Node.prototype.visit.call(this)},draw:function(){}}),cc.TransitionCrossFade.create=function(t,e){return new cc.TransitionCrossFade(t,e)},cc.TransitionTurnOffTiles=cc.TransitionScene.extend({_gridProxy:null,ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var t=cc.director.getWinSize(),e=t.width/t.height,i=0|12*e,n=12,r=cc.turnOffTiles(this._duration,cc.size(i,n)),o=this.easeActionWithAction(r);this._gridProxy.runAction(cc.sequence(o,cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(t){return t}}),cc.TransitionTurnOffTiles.create=function(t,e){return new cc.TransitionTurnOffTiles(t,e)},cc.TransitionSplitCols=cc.TransitionScene.extend({_gridProxy:null,_switchTargetToInscene:function(){this._gridProxy.setTarget(this._inScene)},ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var t=this.action(),e=cc.sequence(t,cc.callFunc(this._switchTargetToInscene,this),t.reverse());this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this),cc.stopGrid()))},onExit:function(){this._gridProxy.setTarget(null),this._gridProxy.onExit(),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){this._gridProxy.visit()},easeActionWithAction:function(t){return new cc.EaseInOut(t,3)},action:function(){return cc.splitCols(this._duration/2,3)}}),cc.TransitionSplitCols.create=function(t,e){return new cc.TransitionSplitCols(t,e)},cc.TransitionSplitRows=cc.TransitionSplitCols.extend({ctor:function(t,e){cc.TransitionSplitCols.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},action:function(){return cc.splitRows(this._duration/2,3)}}),cc.TransitionSplitRows.create=function(t,e){return new cc.TransitionSplitRows(t,e)},cc.TransitionFadeTR=cc.TransitionScene.extend({_gridProxy:null,ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,e&&this.initWithDuration(t,e)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var t=cc.director.getWinSize(),e=t.width/t.height,i=0|12*e,n=12,r=this.actionWithSize(cc.size(i,n));this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(r),cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(t){return t},actionWithSize:function(t){return cc.fadeOutTRTiles(this._duration,t)}}),cc.TransitionFadeTR.create=function(t,e){return new cc.TransitionFadeTR(t,e)},cc.TransitionFadeBL=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return cc.fadeOutBLTiles(this._duration,t)}}),cc.TransitionFadeBL.create=function(t,e){return new cc.TransitionFadeBL(t,e)},cc.TransitionFadeUp=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return new cc.FadeOutUpTiles(this._duration,t)}}),cc.TransitionFadeUp.create=function(t,e){return new cc.TransitionFadeUp(t,e)},cc.TransitionFadeDown=cc.TransitionFadeTR.extend({ctor:function(t,e){cc.TransitionFadeTR.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},actionWithSize:function(t){return cc.fadeOutDownTiles(this._duration,t)}}),cc.TransitionFadeDown.create=function(t,e){return new cc.TransitionFadeDown(t,e)},cc.SCENE_RADIAL=49153,cc.TransitionProgress=cc.TransitionScene.extend({_to:0,_from:0,_sceneToBeModified:null,_className:"TransitionProgress",ctor:function(t,e){cc.TransitionScene.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_setAttrs:function(t,e,i){t.attr({x:e,y:i,anchorX:.5,anchorY:.5})},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._setupTransition();var t=cc.director.getWinSize(),e=new cc.RenderTexture(t.width,t.height);e.sprite.anchorX=.5,e.sprite.anchorY=.5,this._setAttrs(e,t.width/2,t.height/2),e.clear(0,0,0,1),e.begin(),this._sceneToBeModified.visit(),e.end(),this._sceneToBeModified===this._outScene&&this.hideOutShowIn();var i=this._progressTimerNodeWithRenderTexture(e),n=cc.sequence(cc.progressFromTo(this._duration,this._from,this._to),cc.callFunc(this.finish,this));i.runAction(n),this.addChild(i,2,cc.SCENE_RADIAL)},onExit:function(){this.removeChildByTag(cc.SCENE_RADIAL,!0),cc.TransitionScene.prototype.onExit.call(this)},_setupTransition:function(){this._sceneToBeModified=this._outScene,this._from=100,this._to=0},_progressTimerNodeWithRenderTexture:function(t){return cc.log("cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass"),null},_sceneOrder:function(){this._isInSceneOnTop=!1}}),cc.TransitionProgress.create=function(t,e){return new cc.TransitionProgress(t,e)},cc.TransitionProgressRadialCCW=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_RADIAL,i.reverseDir=!1,i.percentage=100,this._setAttrs(i,e.width/2,e.height/2),i}}),cc.TransitionProgressRadialCCW.create=function(t,e){return new cc.TransitionProgressRadialCCW(t,e)},cc.TransitionProgressRadialCW=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_RADIAL,i.reverseDir=!0,i.percentage=100,this._setAttrs(i,e.width/2,e.height/2),i}}),cc.TransitionProgressRadialCW.create=function(t,e){var i=new cc.TransitionProgressRadialCW;return null!==i&&i.initWithDuration(t,e)?i:new cc.TransitionProgressRadialCW(t,e)},cc.TransitionProgressHorizontal=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(1,0),i.barChangeRate=cc.p(1,0),i.percentage=100,this._setAttrs(i,e.width/2,e.height/2),i}}),cc.TransitionProgressHorizontal.create=function(t,e){return new cc.TransitionProgressHorizontal(t,e)},cc.TransitionProgressVertical=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(0,0),i.barChangeRate=cc.p(0,1),i.percentage=100,this._setAttrs(i,e.width/2,e.height/2),i}}),cc.TransitionProgressVertical.create=function(t,e){return new cc.TransitionProgressVertical(t,e)},cc.TransitionProgressInOut=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(.5,.5),i.barChangeRate=cc.p(1,1),i.percentage=0,this._setAttrs(i,e.width/2,e.height/2),i},_sceneOrder:function(){this._isInSceneOnTop=!1},_setupTransition:function(){this._sceneToBeModified=this._inScene,this._from=0,this._to=100}}),cc.TransitionProgressInOut.create=function(t,e){return new cc.TransitionProgressInOut(t,e)},cc.TransitionProgressOutIn=cc.TransitionProgress.extend({ctor:function(t,e){cc.TransitionProgress.prototype.ctor.call(this),e&&this.initWithDuration(t,e)},_progressTimerNodeWithRenderTexture:function(t){var e=cc.director.getWinSize(),i=new cc.ProgressTimer(t.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(i.sprite.flippedY=!0),i.type=cc.ProgressTimer.TYPE_BAR,i.midPoint=cc.p(.5,.5),i.barChangeRate=cc.p(1,1),i.percentage=100,this._setAttrs(i,e.width/2,e.height/2),i}}),cc.TransitionProgressOutIn.create=function(t,e){return new cc.TransitionProgressOutIn(t,e)},cc.TransitionPageTurn=cc.TransitionScene.extend({ctor:function(t,e,i){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,this.initWithDuration(t,e,i)},_back:!0,_gridProxy:null,_className:"TransitionPageTurn",initWithDuration:function(t,e,i){return this._back=i,cc.TransitionScene.prototype.initWithDuration.call(this,t,e),!0},actionWithSize:function(t){return this._back?cc.reverseTime(cc.pageTurn3D(this._duration,t)):cc.pageTurn3D(this._duration,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var t,e,i=cc.director.getWinSize();i.width>i.height?(t=16,e=12):(t=12,e=16);var n=this.actionWithSize(cc.size(t,e)),r=this._gridProxy;this._back?(r.setTarget(this._inScene),r.onEnter(),this._inScene.visible=!1,r.runAction(cc.sequence(n,cc.callFunc(this.finish,this),cc.stopGrid())),this._inScene.runAction(cc.show())):(r.setTarget(this._outScene),r.onEnter(),r.runAction(cc.sequence(n,cc.callFunc(this.finish,this),cc.stopGrid())))},visit:function(){this._back?this._outScene.visit():this._inScene.visit(),this._gridProxy.visit()},_sceneOrder:function(){this._isInSceneOnTop=this._back}}),cc.TransitionPageTurn.create=function(t,e,i){return new cc.TransitionPageTurn(t,e,i)};cc.Codec={name:"Jacob__Codec"},cc.unzip=function(){return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,arguments)},cc.unzipBase64=function(){var t=cc.Codec.Base64.decode.apply(cc.Codec.Base64,arguments);return cc.Codec.GZip.gunzip.apply(cc.Codec.GZip,[t])},cc.unzipBase64AsArray=function(t,e){e=e||1;var i,n,r,o=this.unzipBase64(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s},cc.unzipAsArray=function(t,e){e=e||1;var i,n,r,o=this.unzip(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s},cc.StringToArray=function(t){var e,i=t.split(","),n=[];for(e=0;e<i.length;e++)n.push(parseInt(i[e]));return n},cc.Codec.Base64={name:"Jacob__Codec__Base64"},cc.Codec.Base64._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cc.Codec.Base64.decode=function(t){var e,i,n,r,o,s,c,a=[],l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)r=this._keyStr.indexOf(t.charAt(l++)),o=this._keyStr.indexOf(t.charAt(l++)),s=this._keyStr.indexOf(t.charAt(l++)),c=this._keyStr.indexOf(t.charAt(l++)),e=r<<2|o>>4,i=(15&o)<<4|s>>2,n=(3&s)<<6|c,a.push(String.fromCharCode(e)),64!==s&&a.push(String.fromCharCode(i)),64!==c&&a.push(String.fromCharCode(n));return a=a.join("")},cc.Codec.Base64.decodeAsArray=function(t,e){var i,n,r,o=this.decode(t),s=[];for(i=0,r=o.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=o.charCodeAt(i*e+n)<<8*n;return s},cc.uint8ArrayToUint32Array=function(t){if(t.length%4!==0)return null;for(var e=t.length/4,i=window.Uint32Array?new Uint32Array(e):[],n=0;n<e;n++){var r=4*n;i[n]=t[r]+256*t[r+1]+65536*t[r+2]+t[r+3]*(1<<24)}return i},cc.Codec.GZip=function(t){this.data=t,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(cc.Codec.GZip.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0},cc.Codec.GZip.gunzip=function(t){t.constructor===Array||t.constructor===String;var e=new cc.Codec.GZip(t);return e.gunzip()[0][0]},cc.Codec.GZip.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},cc.Codec.GZip.LITERALS=288,cc.Codec.GZip.NAMEMAX=256,cc.Codec.GZip.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],cc.Codec.GZip.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],cc.Codec.GZip.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],cc.Codec.GZip.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cc.Codec.GZip.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],cc.Codec.GZip.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],cc.Codec.GZip.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},cc.Codec.GZip.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},cc.Codec.GZip.prototype.byteAlign=function(){this.bb=1},cc.Codec.GZip.prototype.readBit=function(){var t;return this.bits++,t=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},cc.Codec.GZip.prototype.readBits=function(t){for(var e=0,i=t;i--;)e=e<<1|this.readBit();return t&&(e=cc.Codec.GZip.bitReverse[e]>>8-t),e},cc.Codec.GZip.prototype.flushBuffer=function(){this.bIdx=0},cc.Codec.GZip.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768===this.bIdx&&(this.bIdx=0)},cc.Codec.GZip.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},cc.Codec.GZip.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,t=this.IsPat(),t>=0)e.b0=t;else if(e.b0=32768,this.Rec())return-1;if(t=this.IsPat(),t>=0)e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},cc.Codec.GZip.prototype.CreateTree=function(t,e,i,n){var r;for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,r=0;r<17;r++)this.fpos[r]=0;return this.len=0,this.Rec()?-1:0},cc.Codec.GZip.prototype.DecodeValue=function(t){for(var e,i,n,r=0,o=t[r];;)if(n=this.readBit()){if(!(32768&o.b1))return o.b1;for(o=o.jump,e=t.length,i=0;i<e;i++)if(t[i]===o){r=i;break}}else{if(!(32768&o.b0))return o.b0;r++,o=t[r]}return-1},cc.Codec.GZip.prototype.DeflateLoop=function(){var t,e,i,n,r;do{if(t=this.readBit(),i=this.readBits(2),0===i){var o,s;for(this.byteAlign(),o=this.readByte(),o|=this.readByte()<<8,s=this.readByte(),s|=this.readByte()<<8,65535&(o^~s)&&document.write("BlockLen checksum mismatch\n");o--;)e=this.readByte(),this.addBuffer(e)}else if(1===i)for(var c;;)if(c=cc.Codec.GZip.bitReverse[this.readBits(7)]>>1,c>23?(c=c<<1|this.readBit(),c>199?(c-=128,c=c<<1|this.readBit()):(c-=48,c>143&&(c+=136))):c+=256,c<256)this.addBuffer(c);else{if(256===c)break;var r,a;for(c-=257,r=this.readBits(cc.Codec.GZip.cplext[c])+cc.Codec.GZip.cplens[c],c=cc.Codec.GZip.bitReverse[this.readBits(5)]>>3,cc.Codec.GZip.cpdext[c]>8?(a=this.readBits(8),a|=this.readBits(cc.Codec.GZip.cpdext[c]-8)<<8):a=this.readBits(cc.Codec.GZip.cpdext[c]),a+=cc.Codec.GZip.cpdist[c],c=0;c<r;c++){var e=this.buf32k[this.bIdx-a&32767];this.addBuffer(e)}}else if(2===i){var c,l,h,u,d,_=new Array(320);for(h=257+this.readBits(5),u=1+this.readBits(5),d=4+this.readBits(4),c=0;c<19;c++)_[c]=0;for(c=0;c<d;c++)_[cc.Codec.GZip.border[c]]=this.readBits(3);for(r=this.distanceTree.length,n=0;n<r;n++)this.distanceTree[n]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.distanceTree,19,_,0))return this.flushBuffer(),1;l=h+u,n=0;for(var p=-1;n<l;)if(p++,c=this.DecodeValue(this.distanceTree),c<16)_[n++]=c;else if(16===c){var f;if(c=3+this.readBits(2),n+c>l)return this.flushBuffer(),1;for(f=n?_[n-1]:0;c--;)_[n++]=f}else{if(c=17===c?3+this.readBits(3):11+this.readBits(7),n+c>l)return this.flushBuffer(),1;for(;c--;)_[n++]=0}for(r=this.literalTree.length,n=0;n<r;n++)this.literalTree[n]=new cc.Codec.GZip.HufNode;if(this.CreateTree(this.literalTree,h,_,0))return this.flushBuffer(),1;for(r=this.literalTree.length,n=0;n<r;n++)this.distanceTree[n]=new cc.Codec.GZip.HufNode;var m=new Array;for(n=h;n<_.length;n++)m[n-h]=_[n];if(this.CreateTree(this.distanceTree,u,m,0))return this.flushBuffer(),1;for(;;)if(c=this.DecodeValue(this.literalTree),c>=256){var r,a;if(c-=256,0===c)break;for(c--,r=this.readBits(cc.Codec.GZip.cplext[c])+cc.Codec.GZip.cplens[c],c=this.DecodeValue(this.distanceTree),cc.Codec.GZip.cpdext[c]>8?(a=this.readBits(8),a|=this.readBits(cc.Codec.GZip.cpdext[c]-8)<<8):a=this.readBits(cc.Codec.GZip.cpdext[c]),a+=cc.Codec.GZip.cpdist[c];r--;){var e=this.buf32k[this.bIdx-a&32767];this.addBuffer(e)}}else this.addBuffer(c)}}while(!t);return this.flushBuffer(),this.byteAlign(),0},cc.Codec.GZip.prototype.unzipFile=function(t){var e;for(this.gunzip(),e=0;e<this.unzipped.length;e++)if(this.unzipped[e][1]===t)return this.unzipped[e][0]},cc.Codec.GZip.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var t=[];if(t[0]=this.readByte(),t[1]=this.readByte(),120===t[0]&&218===t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===t[0]&&139===t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===t[0]&&75===t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3===t[2]&&4===t[3])){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var e=this.readByte();e|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte();var i=this.readByte();i|=this.readByte()<<8,i|=this.readByte()<<16,i|=this.readByte()<<24;var n=this.readByte();n|=this.readByte()<<8,n|=this.readByte()<<16,n|=this.readByte()<<24;var r=this.readByte();r|=this.readByte()<<8;var o=this.readByte();for(o|=this.readByte()<<8,c=0,this.nameBuf=[];r--;){var s=this.readByte();"/"===s|":"===s?c=0:c<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[c++]=String.fromCharCode(s))}this.fileout||(this.fileout=this.nameBuf);for(var c=0;c<o;)s=this.readByte(),c++;8===e&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},cc.Codec.GZip.prototype.skipdir=function(){var t,e,i,n,r,o=[];if(8&this.gpflags&&(o[0]=this.readByte(),o[1]=this.readByte(),o[2]=this.readByte(),o[3]=this.readByte(),t=this.readByte(),t|=this.readByte()<<8,t|=this.readByte()<<16,t|=this.readByte()<<24,e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24),this.modeZIP&&this.nextFile(),o[0]=this.readByte(),8!==o[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),i=this.readByte(),4&this.gpflags)for(o[0]=this.readByte(),o[2]=this.readByte(),this.len=o[0]+256*o[1],n=0;n<this.len;n++)this.readByte();if(8&this.gpflags)for(n=0,this.nameBuf=[];r=this.readByte();)"7"!==r&&":"!==r||(n=0),n<cc.Codec.GZip.NAMEMAX-1&&(this.nameBuf[n++]=r);if(16&this.gpflags)for(;r=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),e=this.readByte(),e|=this.readByte()<<8,e|=this.readByte()<<16,e|=this.readByte()<<24,this.modeZIP&&this.nextFile()},function(){"use strict";function t(t){throw t}function e(t,e){var i=t.split("."),n=T;!(i[0]in n)&&n.execScript&&n.execScript("var "+i[0]);for(var r;i.length&&(r=i.shift());)i.length||e===y?n=n[r]?n[r]:n[r]={}:n[r]=e}function i(t){if("string"==typeof t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;t=n}for(var r,o=1,s=0,c=t.length,a=0;0<c;){r=1024<c?1024:c,c-=r;do{o+=t[a++],s+=o}while(--r);o%=65521,s%=65521}return(s<<16|o)>>>0}function n(e,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=e instanceof(C?Uint8Array:Array)?e:new(C?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(Error("invalid index")),this.buffer.length<=this.index&&this.f()}function r(t){this.buffer=new(C?Uint16Array:Array)(2*t),this.length=0}function o(t){var e,i,n,r,o,s,c,a,l,h=t.length,u=0,d=Number.POSITIVE_INFINITY;for(a=0;a<h;++a)t[a]>u&&(u=t[a]),t[a]<d&&(d=t[a]);for(e=1<<u,i=new(C?Uint32Array:Array)(e),n=1,r=0,o=2;n<=u;){for(a=0;a<h;++a)if(t[a]===n){for(s=0,c=r,l=0;l<n;++l)s=s<<1|1&c,c>>=1;for(l=s;l<e;l+=o)i[l]=n<<16|a;++r}++n,r<<=1,o<<=1}return[i,u,d]}function s(t,e){this.h=I,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=C&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(C?Uint8Array:Array)(32768))}function c(t,e){this.length=t,this.G=e}function a(){var e=O;switch(v){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}}function l(e,i){function n(e,i){var n,r=e.G,o=[],s=0;n=F[e.length],o[s++]=65535&n,o[s++]=n>>16&255,o[s++]=n>>24;var c;switch(v){case 1===r:c=[0,r-1,0];break;case 2===r:c=[1,r-2,0];break;case 3===r:c=[2,r-3,0];break;case 4===r:c=[3,r-4,0];break;case 6>=r:c=[4,r-5,1];break;case 8>=r:c=[5,r-7,1];break;case 12>=r:c=[6,r-9,2];break;case 16>=r:c=[7,r-13,2];break;case 24>=r:c=[8,r-17,3];break;case 32>=r:c=[9,r-25,3];break;case 48>=r:c=[10,r-33,4];break;case 64>=r:c=[11,r-49,4];break;case 96>=r:c=[12,r-65,5];break;case 128>=r:c=[13,r-97,5];break;case 192>=r:c=[14,r-129,6];break;case 256>=r:c=[15,r-193,6];break;case 384>=r:c=[16,r-257,7];break;case 512>=r:c=[17,r-385,7];break;case 768>=r:c=[18,r-513,8];break;case 1024>=r:c=[19,r-769,8];break;case 1536>=r:c=[20,r-1025,9];break;case 2048>=r:c=[21,r-1537,9];break;case 3072>=r:c=[22,r-2049,10];break;case 4096>=r:c=[23,r-3073,10];break;case 6144>=r:c=[24,r-4097,11];break;case 8192>=r:c=[25,r-6145,11];break;case 12288>=r:c=[26,r-8193,12];break;case 16384>=r:c=[27,r-12289,12];break;case 24576>=r:c=[28,r-16385,13];break;case 32768>=r:c=[29,r-24577,13];break;default:t("invalid distance")}n=c,o[s++]=n[0],o[s++]=n[1],o[s++]=n[2];var a,l;for(a=0,l=o.length;a<l;++a)f[m++]=o[a];T[o[0]]++,S[o[3]]++,g=e.length+i-1,d=null}var r,o,s,a,l,h,u,d,_,p={},f=C?new Uint16Array(2*i.length):[],m=0,g=0,T=new(C?Uint32Array:Array)(286),S=new(C?Uint32Array:Array)(30),x=e.w;if(!C){for(s=0;285>=s;)T[s++]=0;for(s=0;29>=s;)S[s++]=0}for(T[256]=1,r=0,o=i.length;r<o;++r){for(s=l=0,a=3;s<a&&r+s!==o;++s)l=l<<8|i[r+s];if(p[l]===y&&(p[l]=[]),h=p[l],!(0<g--)){for(;0<h.length&&32768<r-h[0];)h.shift();if(r+3>=o){for(d&&n(d,-1),s=0,a=o-r;s<a;++s)_=i[r+s],f[m++]=_,++T[_];break}if(0<h.length){var A=y,E=y,b=0,R=y,P=y,w=y,I=y,D=i.length,P=0,I=h.length;t:for(;P<I;P++){if(A=h[I-P-1],R=3,3<b){for(w=b;3<w;w--)if(i[A+w-1]!==i[r+w-1])continue t;R=b}for(;258>R&&r+R<D&&i[A+R]===i[r+R];)++R;if(R>b&&(E=A,b=R),258===R)break}u=new c(b,r-E),d?d.length<u.length?(_=i[r-1],f[m++]=_,++T[_],n(u,0)):n(d,-1):u.length<x?d=u:n(u,0)}else d?n(d,-1):(_=i[r],f[m++]=_,++T[_])}h.push(r)}return f[m++]=256,T[256]++,e.L=T,e.K=S,C?f.subarray(0,m):f}function h(t,e){function i(t){var e=x[t][A[t]];e===g?(i(t+1),i(t+1)):--T[e],++A[t]}var n,o,s,c,a,l=t.length,h=new r(572),u=new(C?Uint8Array:Array)(l);if(!C)for(c=0;c<l;c++)u[c]=0;for(c=0;c<l;++c)0<t[c]&&h.push(c,t[c]);if(n=Array(h.length/2),o=new(C?Uint32Array:Array)(h.length/2),1===n.length)return u[h.pop().index]=1,u;for(c=0,a=h.length/2;c<a;++c)n[c]=h.pop(),o[c]=n[c].value;var d,_,p,f,m,g=o.length,y=new(C?Uint16Array:Array)(e),v=new(C?Uint8Array:Array)(e),T=new(C?Uint8Array:Array)(g),S=Array(e),x=Array(e),A=Array(e),E=(1<<e)-g,b=1<<e-1;for(y[e-1]=g,_=0;_<e;++_)E<b?v[_]=0:(v[_]=1,E-=b),E<<=1,y[e-2-_]=(y[e-1-_]/2|0)+g;for(y[0]=v[0],S[0]=Array(y[0]),x[0]=Array(y[0]),_=1;_<e;++_)y[_]>2*y[_-1]+v[_]&&(y[_]=2*y[_-1]+v[_]),S[_]=Array(y[_]),x[_]=Array(y[_]);for(d=0;d<g;++d)T[d]=e;for(p=0;p<y[e-1];++p)S[e-1][p]=o[p],x[e-1][p]=p;for(d=0;d<e;++d)A[d]=0;for(1===v[e-1]&&(--T[0],++A[e-1]),_=e-2;0<=_;--_){for(f=d=0,m=A[_+1],p=0;p<y[_];p++)f=S[_+1][m]+S[_+1][m+1],f>o[d]?(S[_][p]=f,x[_][p]=g,m+=2):(S[_][p]=o[d],x[_][p]=d,++d);A[_]=0,1===v[_]&&i(_)}for(s=T,c=0,a=n.length;c<a;++c)u[n[c].index]=s[c];return u}function u(e){var i,n,r,o,s=new(C?Uint16Array:Array)(e.length),c=[],a=[],l=0;for(i=0,n=e.length;i<n;i++)c[e[i]]=(0|c[e[i]])+1;for(i=1,n=16;i<=n;i++)a[i]=l,l+=0|c[i],l>1<<i&&t("overcommitted"),l<<=1;for(65536>l&&t("undercommitted"),i=0,n=e.length;i<n;i++)for(l=a[e[i]],a[e[i]]+=1,r=s[i]=0,o=e[i];r<o;r++)s[i]=s[i]<<1|1&l,l>>>=1;return s}function d(t,e){this.input=t,this.a=new(C?Uint8Array:Array)(32768),this.h=M.j;var i,n={};!e&&(e={})||"number"!=typeof e.compressionType||(this.h=e.compressionType);for(i in e)n[i]=e[i];n.outputBuffer=this.a,this.z=new s(this.input,n)}function _(e,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=C?new Uint8Array(e):e,this.s=!1,this.m=k,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case V:this.b=32768,this.a=new(C?Uint8Array:Array)(32768+this.l+258);break;case k:this.b=0,this.a=new(C?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:t(Error("invalid inflate mode"))}}function p(e,i){for(var n,r=e.g,o=e.e,s=e.input,c=e.c;o<i;)n=s[c++],n===y&&t(Error("input buffer is broken")),r|=n<<o,o+=8;return n=r&(1<<i)-1,e.g=r>>>i,e.e=o-i,e.c=c,n}function f(e,i){for(var n,r,o,s=e.g,c=e.e,a=e.input,l=e.c,h=i[0],u=i[1];c<u;)n=a[l++],n===y&&t(Error("input buffer is broken")),s|=n<<c,c+=8;return r=h[s&(1<<u)-1],o=r>>>16,e.g=s>>o,e.e=c-o,e.c=l,65535&r}function m(t){function e(t,e,i){var n,r,o,s;for(s=0;s<t;)switch(n=f(this,e)){case 16:for(o=3+p(this,2);o--;)i[s++]=r;break;case 17:for(o=3+p(this,3);o--;)i[s++]=0;r=0;break;case 18:for(o=11+p(this,7);o--;)i[s++]=0;r=0;break;default:r=i[s++]=n}return i}var i,n,r,s,c=p(t,5)+257,a=p(t,5)+1,l=p(t,4)+4,h=new(C?Uint8Array:Array)(Y.length);for(s=0;s<l;++s)h[Y[s]]=p(t,3);i=o(h),n=new(C?Uint8Array:Array)(c),r=new(C?Uint8Array:Array)(a),t.o(o(e.call(t,c,i,n)),o(e.call(t,a,i,r)))}function g(e,i){var n,r;switch(this.input=e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=e[this.c++],r=e[this.c++],15&n){case mt:this.method=mt;break;default:t(Error("unsupported compression method"))}0!==((n<<8)+r)%31&&t(Error("invalid fcheck flag:"+((n<<8)+r)%31)),32&r&&t(Error("fdict flag is not supported")),this.A=new _(e,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}var y=void 0,v=!0,T=this,C="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;n.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(C?Uint8Array:Array)(i<<1);if(C)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},n.prototype.d=function(t,e,i){var n,r=this.buffer,o=this.index,s=this.i,c=r[o];if(i&&1<e&&(t=8<e?(R[255&t]<<24|R[t>>>8&255]<<16|R[t>>>16&255]<<8|R[t>>>24&255])>>32-e:R[t]>>8-e),8>e+s)c=c<<e|t,s+=e;else for(n=0;n<e;++n)c=c<<1|t>>e-n-1&1,8===++s&&(s=0,r[o++]=R[c],c=0,o===r.length&&(r=this.f()));r[o]=c,this.buffer=r,this.i=s,this.index=o},n.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.i&&(e[i]<<=8-this.i,e[i]=R[e[i]],i++),C?t=e.subarray(0,i):(e.length=i,t=e),t};var S,x=new(C?Uint8Array:Array)(256);for(S=0;256>S;++S){for(var A=S,E=A,b=7,A=A>>>1;A;A>>>=1)E<<=1,E|=1&A,--b;x[S]=(E<<b&255)>>>0}var R=x,P=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];C&&new Uint32Array(P),r.prototype.getParent=function(t){return 2*((t-2)/4|0)},r.prototype.push=function(t,e){var i,n,r,o=this.buffer;for(i=this.length,o[this.length++]=e,o[this.length++]=t;0<i&&(n=this.getParent(i),o[i]>o[n]);)r=o[i],o[i]=o[n],o[n]=r,r=o[i+1],o[i+1]=o[n+1],o[n+1]=r,i=n;return this.length},r.prototype.pop=function(){var t,e,i,n,r,o=this.buffer;for(e=o[0],t=o[1],this.length-=2,o[0]=o[this.length],o[1]=o[this.length+1],r=0;(n=2*r+2,!(n>=this.length))&&(n+2<this.length&&o[n+2]>o[n]&&(n+=2),o[n]>o[r]);)i=o[r],o[r]=o[n],o[n]=i,i=o[r+1],o[r+1]=o[n+1],o[n+1]=i,r=n;return{index:t,value:e,length:this.length}};var w,I=2,D={NONE:0,r:1,j:I,N:3},L=[];for(w=0;288>w;w++)switch(v){case 143>=w:L.push([w+48,8]);break;case 255>=w:L.push([w-144+400,9]);break;case 279>=w:L.push([w-256+0,7]);break;case 287>=w:L.push([w-280+192,8]);break;default:t("invalid literal: "+w)}s.prototype.n=function(){var e,i,r,o,s=this.input;switch(this.h){case 0:for(r=0,o=s.length;r<o;){i=C?s.subarray(r,r+65535):s.slice(r,r+65535),r+=i.length;var c=i,a=r===o,d=y,_=y,p=y,f=y,m=y,g=this.a,T=this.b;if(C){for(g=new Uint8Array(this.a.buffer);g.length<=T+c.length+5;)g=new Uint8Array(g.length<<1);g.set(this.a)}if(d=a?1:0,g[T++]=0|d,_=c.length,p=~_+65536&65535,g[T++]=255&_,g[T++]=_>>>8&255,g[T++]=255&p,g[T++]=p>>>8&255,C)g.set(c,T),T+=c.length,g=g.subarray(0,T);else{for(f=0,m=c.length;f<m;++f)g[T++]=c[f];g.length=T}this.b=T,this.a=g}break;case 1:var S=new n(new Uint8Array(this.a.buffer),this.b);S.d(1,1,v),S.d(1,2,v);var x,A,E,b=l(this,s);for(x=0,A=b.length;x<A;x++)if(E=b[x],n.prototype.d.apply(S,L[E]),256<E)S.d(b[++x],b[++x],v),S.d(b[++x],5),S.d(b[++x],b[++x],v);else if(256===E)break;this.a=S.finish(),this.b=this.a.length;break;case I:var R,P,w,D,O,B,N,F,M,V,k,G,W,z,U,Y=new n(new Uint8Array(this.a),this.b),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=Array(19);for(R=I,Y.d(1,1,v),Y.d(R,2,v),P=l(this,s),B=h(this.L,15),N=u(B),F=h(this.K,7),M=u(F),w=286;257<w&&0===B[w-1];w--);for(D=30;1<D&&0===F[D-1];D--);var j,q,Z,J,K,Q,$=w,tt=D,et=new(C?Uint32Array:Array)($+tt),it=new(C?Uint32Array:Array)(316),nt=new(C?Uint8Array:Array)(19);for(j=q=0;j<$;j++)et[q++]=B[j];for(j=0;j<tt;j++)et[q++]=F[j];if(!C)for(j=0,J=nt.length;j<J;++j)nt[j]=0;for(j=K=0,J=et.length;j<J;j+=q){for(q=1;j+q<J&&et[j+q]===et[j];++q);if(Z=q,0===et[j])if(3>Z)for(;0<Z--;)it[K++]=0,nt[0]++;else for(;0<Z;)Q=138>Z?Z:138,Q>Z-3&&Q<Z&&(Q=Z-3),10>=Q?(it[K++]=17,it[K++]=Q-3,nt[17]++):(it[K++]=18,it[K++]=Q-11,nt[18]++),Z-=Q;else if(it[K++]=et[j],nt[et[j]]++,Z--,3>Z)for(;0<Z--;)it[K++]=et[j],nt[et[j]]++;else for(;0<Z;)Q=6>Z?Z:6,Q>Z-3&&Q<Z&&(Q=Z-3),it[K++]=16,it[K++]=Q-3,nt[16]++,Z-=Q}for(e=C?it.subarray(0,K):it.slice(0,K),V=h(nt,7),z=0;19>z;z++)H[z]=V[X[z]];for(O=19;4<O&&0===H[O-1];O--);for(k=u(V),Y.d(w-257,5,v),Y.d(D-1,5,v),Y.d(O-4,4,v),z=0;z<O;z++)Y.d(H[z],3,v);for(z=0,U=e.length;z<U;z++)if(G=e[z],Y.d(k[G],V[G],v),16<=G){switch(z++,G){case 16:W=2;break;case 17:W=3;break;case 18:W=7;break;default:t("invalid code: "+G)}Y.d(e[z],W,v)}var rt,ot,st,ct,at,lt,ht,ut,dt=[N,B],_t=[M,F];for(at=dt[0],lt=dt[1],ht=_t[0],ut=_t[1],rt=0,ot=P.length;rt<ot;++rt)if(st=P[rt],Y.d(at[st],lt[st],v),256<st)Y.d(P[++rt],P[++rt],v),ct=P[++rt],Y.d(ht[ct],ut[ct],v),Y.d(P[++rt],P[++rt],v);else if(256===st)break;this.a=Y.finish(),this.b=this.a.length;break;default:t("invalid compression type")}return this.a};var O,B,N=[];for(O=3;258>=O;O++)B=a(),N[O]=B[2]<<24|B[1]<<16|B[0];var F=C?new Uint32Array(N):N,M=D;d.prototype.n=function(){var e,n,r,o,s,c,a,l=0;switch(a=this.a,e=mt){case mt:n=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}switch(r=n<<4|e,a[l++]=r,e){case mt:switch(this.h){case M.NONE:s=0;break;case M.r:s=1;break;case M.j:s=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return o=s<<6|0,a[l++]=o|31-(256*r+o)%31,c=i(this.input),this.z.b=l,a=this.z.n(),l=a.length,C&&(a=new Uint8Array(a.buffer),a.length<=l+4&&(this.a=new Uint8Array(a.length+4),this.a.set(a),a=this.a),a=a.subarray(0,l+4)),a[l++]=c>>24&255,a[l++]=c>>16&255,a[l++]=c>>8&255,a[l++]=255&c,a},e("Zlib.Deflate",d),e("Zlib.Deflate.compress",function(t,e){return new d(t,e).n()}),e("Zlib.Deflate.CompressionType",M),e("Zlib.Deflate.CompressionType.NONE",M.NONE),e("Zlib.Deflate.CompressionType.FIXED",M.r),e("Zlib.Deflate.CompressionType.DYNAMIC",M.j);var V=0,k=1,G={D:V,C:k};_.prototype.p=function(){for(;!this.s;){var e=p(this,3);switch(1&e&&(this.s=v),e>>>=1){case 0:var i=this.input,n=this.c,r=this.a,o=this.b,s=y,c=y,a=y,l=r.length,h=y;switch(this.e=this.g=0,s=i[n++],s===y&&t(Error("invalid uncompressed block header: LEN (first byte)")),c=s,s=i[n++],s===y&&t(Error("invalid uncompressed block header: LEN (second byte)")),c|=s<<8,s=i[n++],s===y&&t(Error("invalid uncompressed block header: NLEN (first byte)")),a=s,s=i[n++],s===y&&t(Error("invalid uncompressed block header: NLEN (second byte)")),a|=s<<8,c===~a&&t(Error("invalid uncompressed block header: length verify")),n+c>i.length&&t(Error("input buffer is broken")),this.m){case V:for(;o+c>r.length;){if(h=l-o,c-=h,C)r.set(i.subarray(n,n+h),o),o+=h,n+=h;else for(;h--;)r[o++]=i[n++];this.b=o,r=this.f(),o=this.b}break;case k:for(;o+c>r.length;)r=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(C)r.set(i.subarray(n,n+c),o),o+=c,n+=c;else for(;c--;)r[o++]=i[n++];this.c=n,this.b=o,this.a=r;break;case 1:this.o(it,rt);break;case 2:m(this);break;default:t(Error("unknown BTYPE: "+e))}}return this.t()};var W,z,U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=C?new Uint16Array(U):U,X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],H=C?new Uint16Array(X):X,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],q=C?new Uint8Array(j):j,Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],J=C?new Uint16Array(Z):Z,K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Q=C?new Uint8Array(K):K,$=new(C?Uint8Array:Array)(288);for(W=0,z=$.length;W<z;++W)$[W]=143>=W?8:255>=W?9:279>=W?7:8;var tt,et,it=o($),nt=new(C?Uint8Array:Array)(30);for(tt=0,et=nt.length;tt<et;++tt)nt[tt]=5;var rt=o(nt);_.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,o,s,c,a=i.length-258;256!==(r=f(this,t));)if(256>r)n>=a&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(o=r-257,c=H[o],0<q[o]&&(c+=p(this,q[o])),r=f(this,e),s=J[r],0<Q[r]&&(s+=p(this,Q[r])),n>=a&&(this.b=n,i=this.f(),n=this.b);c--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},_.prototype.I=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,o,s,c,a=i.length;256!==(r=f(this,t));)if(256>r)n>=a&&(i=this.f(),a=i.length),i[n++]=r;else for(o=r-257,c=H[o],0<q[o]&&(c+=p(this,q[o])),r=f(this,e),s=J[r],0<Q[r]&&(s+=p(this,Q[r])),n+c>a&&(i=this.f(),a=i.length);c--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},_.prototype.f=function(){var t,e,i=new(C?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(C)i.set(r.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=r[t+32768];if(this.k.push(i),this.q+=i.length,C)r.set(r.subarray(n,n+32768));else for(t=0;32768>t;++t)r[t]=r[n+t];return this.b=32768,r},_.prototype.J=function(t){var e,i,n,r,o=this.input.length/this.c+1|0,s=this.input,c=this.a;return t&&("number"==typeof t.v&&(o=t.v),"number"==typeof t.F&&(o+=t.F)),2>o?(i=(s.length-this.c)/this.u[2],r=258*(i/2)|0,n=r<c.length?c.length+r:c.length<<1):n=c.length*o,C?(e=new Uint8Array(n),e.set(c)):e=c,this.a=e},_.prototype.t=function(){var t,e,i,n,r,o=0,s=this.a,c=this.k,a=new(C?Uint8Array:Array)(this.q+(this.b-32768));if(0===c.length)return C?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=c.length;e<i;++e)for(t=c[e],n=0,r=t.length;n<r;++n)a[o++]=t[n];for(e=32768,i=this.b;e<i;++e)a[o++]=s[e];return this.k=[],this.buffer=a},_.prototype.H=function(){var t,e=this.b;return C?this.B?(t=new Uint8Array(e),t.set(this.a.subarray(0,e))):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},g.prototype.p=function(){var e,n,r=this.input;return e=this.A.p(),this.c=this.A.c,this.M&&(n=(r[this.c++]<<24|r[this.c++]<<16|r[this.c++]<<8|r[this.c++])>>>0,n!==i(e)&&t(Error("invalid adler-32 checksum"))),e},e("Zlib.Inflate",g),e("Zlib.Inflate.BufferType",G),G.ADAPTIVE=G.C,G.BLOCK=G.D,e("Zlib.Inflate.prototype.decompress",g.prototype.p);var ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];C&&new Uint16Array(ot);var st=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];C&&new Uint16Array(st);var ct=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];C&&new Uint8Array(ct);var at=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];C&&new Uint16Array(at);var lt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];C&&new Uint8Array(lt);var ht,ut,dt=new(C?Uint8Array:Array)(288);for(ht=0,ut=dt.length;ht<ut;++ht)dt[ht]=143>=ht?8:255>=ht?9:279>=ht?7:8;o(dt);var _t,pt,ft=new(C?Uint8Array:Array)(30);for(_t=0,pt=ft.length;_t<pt;++_t)ft[_t]=5;o(ft);var mt=8}.call(this);var _p=window;_p=_p.Zlib=_p.Zlib,_p.Deflate=_p.Deflate,_p.Deflate.compress=_p.Deflate.compress,_p.Inflate=_p.Inflate,_p.Inflate.BufferType=_p.Inflate.BufferType,_p.Inflate.prototype.decompress=_p.Inflate.prototype.decompress;cc.PNGReader=cc.Class.extend({ctor:function(t){var e,i,n,r,o,s,c,a,l,h,u,d,_,p;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},o=null;;){switch(e=this.readUInt32(),l=function(){var t,e;for(e=[],s=t=0;t<4;s=++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":o&&this.animation.frames.push(o),this.pos+=4,o={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},r=this.readUInt16(),n=this.readUInt16()||100,o.delay=1e3*r/n,o.disposeOp=this.data[this.pos++],o.blendOp=this.data[this.pos++],o.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,e-=4),t=(null!=o?o.data:void 0)||this.imgData,s=d=0;0<=e?d<e:d>e;s=0<=e?++d:--d)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),h=255-this.transparency.indexed.length,h>0)for(s=_=0;0<=h?_<h:_>h;s=0<=h?++_:--_)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":u=this.read(e),c=u.indexOf(0),a=String.fromCharCode.apply(String,u.slice(0,c)),this.text[a]=String.fromCharCode.apply(String,u.slice(c+1));break;case"IEND":return o&&this.animation.frames.push(o),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}},read:function(t){var e,i,n;for(n=[],e=i=0;0<=t?i<t:i>t;e=0<=t?++i:--i)n.push(this.data[this.pos++]);return n},readUInt32:function(){var t,e,i,n;return t=this.data[this.pos++]<<24,e=this.data[this.pos++]<<16,i=this.data[this.pos++]<<8,n=this.data[this.pos++],t|e|i|n},readUInt16:function(){var t,e;return t=this.data[this.pos++]<<8,e=this.data[this.pos++],t|e},decodePixels:function(t){var e,i,n,r,o,s,c,a,l,h,u,d,_,p,f,m,g,y,v,T,C,S,x;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);var A=new Zlib.Inflate(t,{index:0,verify:!1});for(t=A.decompress(),d=this.pixelBitlength/8,m=d*this.width,_=new Uint8Array(m*this.height),s=t.length,f=0,p=0,i=0;p<s;){switch(t[p++]){case 0:for(r=v=0;v<m;r=v+=1)_[i++]=t[p++];break;case 1:for(r=T=0;T<m;r=T+=1)e=t[p++],o=r<d?0:_[i-d],_[i++]=(e+o)%256;break;case 2:for(r=C=0;C<m;r=C+=1)e=t[p++],n=(r-r%d)/d,g=f&&_[(f-1)*m+n*d+r%d],_[i++]=(g+e)%256;break;case 3:for(r=S=0;S<m;r=S+=1)e=t[p++],n=(r-r%d)/d,o=r<d?0:_[i-d],g=f&&_[(f-1)*m+n*d+r%d],_[i++]=(e+Math.floor((o+g)/2))%256;break;case 4:for(r=x=0;x<m;r=x+=1)e=t[p++],n=(r-r%d)/d,o=r<d?0:_[i-d],0===f?g=y=0:(g=_[(f-1)*m+n*d+r%d],y=n&&_[(f-1)*m+(n-1)*d+r%d]),c=o+g-y,a=Math.abs(c-o),h=Math.abs(c-g),u=Math.abs(c-y),l=a<=h&&a<=u?o:h<=u?g:y,_[i++]=(e+l)%256;break;default:throw new Error("Invalid filter algorithm: "+t[p-1])}f++}return _},copyToImageData:function(t,e){var i,n,r,o,s,c,a,l,h,u,d;if(n=this.colors,h=null,i=this.hasAlphaChannel,this.palette.length&&(h=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),n=4,i=!0),r=t.data||t,l=r.length,s=h||e,o=c=0,1===n)for(;o<l;)a=h?4*e[o/4]:c,u=s[a++],r[o++]=u,r[o++]=u,r[o++]=u,r[o++]=i?s[a++]:255,c=a;else for(;o<l;)a=h?4*e[o/4]:c,r[o++]=s[a++],r[o++]=s[a++],r[o++]=s[a++],r[o++]=i?s[a++]:255,c=a},decodePalette:function(){var t,e,i,n,r,o,s,c,a;for(i=this.palette,o=this.transparency.indexed||[],r=new Uint8Array((o.length||0)+i.length),n=0,t=0,e=s=0,c=i.length;s<c;e=s+=3)r[n++]=i[e],r[n++]=i[e+1],r[n++]=i[e+2],r[n++]=null!=(a=o[t++])?a:255;return r},render:function(t){var e,i;return t.width=this.width,t.height=this.height,e=t.getContext("2d"),i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0)}}),cc.tiffReader={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(t){return this._tiffData[t]},getUint16:function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},getUint32:function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},checkLittleEndian:function(){var t=this.getUint16(0);if(18761===t)this.littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError("You forgot your towel!");return!0},getFieldTypeName:function(t){var e=this.fieldTypeNames;return t in e?e[t]:null},getFieldTagName:function(t){var e=this.fieldTagNames;return t in e?e[t]:(console.log("Unknown Field Tag:",t),"Tag"+t)},getFieldTypeLength:function(t){return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)!==-1?1:["SHORT","SSHORT"].indexOf(t)!==-1?2:["LONG","SLONG","FLOAT"].indexOf(t)!==-1?4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)!==-1?8:null},getFieldValues:function(t,e,i,n){var r=[],o=this.getFieldTypeLength(e),s=o*i;if(s<=4)this.littleEndian===!1?r.push(n>>>8*(4-o)):r.push(n);else for(var c=0;c<i;c++){var a=o*c;o>=8?["RATIONAL","SRATIONAL"].indexOf(e)!==-1?(r.push(this.getUint32(n+a)),r.push(this.getUint32(n+a+4))):cc.log("Can't handle this field type or size"):r.push(this.getBytes(o,n+a))}return"ASCII"===e&&r.forEach(function(t,e,i){i[e]=String.fromCharCode(t)}),r},getBytes:function(t,e){if(t<=0)cc.log("No bytes requested");else{if(t<=1)return this.getUint8(e);if(t<=2)return this.getUint16(e);if(t<=3)return this.getUint32(e)>>>8;if(t<=4)return this.getUint32(e);cc.log("Too many bytes requested")}},getBits:function(t,e,i){i=i||0;var n,r,o=Math.floor(i/8),s=e+o,c=i+t,a=32-t;return c<=0?console.log("No bits requested"):c<=8?(n=24+i,r=this.getUint8(s)):c<=16?(n=16+i,r=this.getUint16(s)):c<=32?(n=i,r=this.getUint32(s)):console.log("Too many bits requested"),{bits:r<<n>>>a,byteOffset:s+Math.floor(c/8),bitOffset:c%8}},parseFileDirectory:function(t){for(var e=this.getUint16(t),i=[],n=t+2,r=0;r<e;n+=12,r++){var o=this.getUint16(n),s=this.getUint16(n+2),c=this.getUint32(n+4),a=this.getUint32(n+8),l=this.getFieldTagName(o),h=this.getFieldTypeName(s),u=this.getFieldValues(l,h,c,a);i[l]={type:h,values:u}}this._fileDirectories.push(i);var d=this.getUint32(n);0!==d&&this.parseFileDirectory(d)},clampColorSample:function(t,e){var i=Math.pow(2,8-e);return Math.floor(t*i+(i-1))},parseTIFF:function(t,e){if(e=e||document.createElement("canvas"),this._tiffData=t,this.canvas=e,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var n=this._fileDirectories[0],r=n.ImageWidth.values[0],o=n.ImageLength.values[0];this.canvas.width=r,this.canvas.height=o;var s=[],c=n.Compression?n.Compression.values[0]:1,a=n.SamplesPerPixel.values[0],l=[],h=0,u=!1;if(n.BitsPerSample.values.forEach(function(t,e,i){l[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},t%8===0&&(l[e].hasBytesPerSample=!0,l[e].bytesPerSample=t/8),h+=t},this),h%8===0){u=!0;var d=h/8}var _=n.StripOffsets.values,p=_.length;if(n.StripByteCounts)var f=n.StripByteCounts.values;else{if(cc.log("Missing StripByteCounts!"),1!==p)throw Error("Cannot recover from missing StripByteCounts");var f=[Math.ceil(r*o*h/8)]}for(var m=0;m<p;m++){var g=_[m];s[m]=[];for(var y=f[m],v=0,T=0,C=1,S=!0,x=[],A=0,E=0,b=0;v<y;v+=C)switch(c){case 1:for(var R=0,x=[];R<a;R++){if(!l[R].hasBytesPerSample){var P=this.getBits(l[R].bitsPerSample,g+v,T);throw x.push(P.bits),v=P.byteOffset-g,T=P.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}var w=l[R].bytesPerSample*R;x.push(this.getBytes(l[R].bytesPerSample,g+v+w))}if(s[m].push(x),!u)throw C=0,RangeError("Cannot handle sub-byte bits per pixel");C=d;break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:break;case 7:break;case 32773:if(S){S=!1;var I=1,D=1,L=this.getInt8(g+v);L>=0&&L<=127?I=L+1:L>=-127&&L<=-1?D=-L+1:S=!0}else{for(var O=this.getUint8(g+v),R=0;R<D;R++){if(!l[E].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");b=b<<8*A|O,A++,A===l[E].bytesPerSample&&(x.push(b),b=A=0,E++),E===a&&(s[m].push(x),x=[],E=0)}I--,0===I&&(S=!0)}C=1}}if(e.getContext){var B=this.canvas.getContext("2d");B.fillStyle="rgba(255, 255, 255, 0)";var N=n.RowsPerStrip?n.RowsPerStrip.values[0]:o,F=s.length,M=o%N,V=0===M?N:M,k=N,G=0,W=n.PhotometricInterpretation.values[0],z=[],U=0;if(n.ExtraSamples&&(z=n.ExtraSamples.values,U=z.length),n.ColorMap)var Y=n.ColorMap.values,X=Math.pow(2,l[0].bitsPerSample);for(var m=0;m<F;m++){m+1===F&&(k=V);for(var H=s[m].length,j=G*m,q=0,Z=0;Z<H;q++)for(var J=0;J<r;J++,Z++){var K=s[m][Z],Q=0,$=0,tt=0,et=1;if(U>0)for(var it=0;it<U;it++)if(1===z[it]||2===z[it]){et=K[3+it]/256;break}switch(W){case 0:if(l[0].hasBytesPerSample)var nt=Math.pow(16,2*l[0].bytesPerSample);K.forEach(function(t,e,i){i[e]=nt-t});case 1:Q=$=tt=this.clampColorSample(K[0],l[0].bitsPerSample);break;case 2:Q=this.clampColorSample(K[0],l[0].bitsPerSample),$=this.clampColorSample(K[1],l[1].bitsPerSample),tt=this.clampColorSample(K[2],l[2].bitsPerSample);break;case 3:if(void 0===Y)throw Error("Palette image missing color map");var rt=K[0];Q=this.clampColorSample(Y[rt],16),$=this.clampColorSample(Y[X+rt],16),tt=this.clampColorSample(Y[2*X+rt],16);break;default:throw RangeError("Unknown Photometric Interpretation:",W)}B.fillStyle="rgba("+Q+", "+$+", "+tt+", "+et+")",B.fillRect(J,j+q,1,1)}G=k}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}},cc.Particle=function(t,e,i,n,r,o,s,c,a,l,h,u){this.pos=t?t:cc.p(0,0),this.startPos=e?e:cc.p(0,0),this.color=i?i:{r:0,g:0,b:0,a:255},this.deltaColor=n?n:{r:0,g:0,b:0,a:255},this.size=r||0,this.deltaSize=o||0,this.rotation=s||0,this.deltaRotation=c||0,this.timeToLive=a||0,this.atlasIndex=l||0,this.modeA=h?h:new cc.Particle.ModeA,this.modeB=u?u:new cc.Particle.ModeB,this.isChangeColor=!1,this.drawPos=cc.p(0,0)},cc.Particle.ModeA=function(t,e,i){this.dir=t?t:cc.p(0,0),this.radialAccel=e||0,this.tangentialAccel=i||0},cc.Particle.ModeB=function(t,e,i,n){this.angle=t||0,this.degreesPerSecond=e||0,this.radius=i||0,this.deltaRadius=n||0},cc.Particle.TemporaryPoints=[cc.p(),cc.p(),cc.p(),cc.p()],cc.ParticleSystem=cc.Node.extend({_className:"ParticleSystem",_plistFile:"",_elapsed:0,_dontTint:!1,modeA:null,modeB:null,_pointZeroForParticle:cc.p(0,0),_particles:null,_emitCounter:0,_particleIdx:0,_batchNode:null,atlasIndex:0,_transformSystemDirty:!1,_allocatedParticles:0,_isActive:!1,particleCount:0,duration:0,_sourcePosition:null,_posVar:null,life:0,lifeVar:0,angle:0,angleVar:0,startSize:0,startSizeVar:0,endSize:0,endSizeVar:0,_startColor:null,_startColorVar:null,_endColor:null,_endColorVar:null,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,emissionRate:0,_totalParticles:0,_texture:null,_blendFunc:null,_opacityModifyRGB:!1,positionType:null,autoRemoveOnFinish:!1,emitterMode:0,_textureLoaded:null,ctor:function(t){if(cc.Node.prototype.ctor.call(this),this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this.modeA=new cc.ParticleSystem.ModeA,this.modeB=new cc.ParticleSystem.ModeB,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this._particles=[],this._sourcePosition=cc.p(0,0),this._posVar=cc.p(0,0),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._endColorVar=cc.color(255,255,255,255),this._plistFile="",this._elapsed=0,this._dontTint=!1,this._pointZeroForParticle=cc.p(0,0),this._emitCounter=0,this._particleIdx=0,this._batchNode=null,this.atlasIndex=0,this._transformSystemDirty=!1,this._allocatedParticles=0,this._isActive=!1,this.particleCount=0,this.duration=0,this.life=0,this.lifeVar=0,this.angle=0,this.angleVar=0,this.startSize=0,this.startSizeVar=0,this.endSize=0,this.endSizeVar=0,this.startSpin=0,this.startSpinVar=0,this.endSpin=0,this.endSpinVar=0,this.emissionRate=0,this._totalParticles=0,this._texture=null,this._opacityModifyRGB=!1,this.positionType=cc.ParticleSystem.TYPE_FREE,this.autoRemoveOnFinish=!1,this._textureLoaded=!0,!t||cc.isNumber(t)){var e=t||100;this.setDrawMode(cc.ParticleSystem.TEXTURE_MODE),this.initWithTotalParticles(e)}else cc.isString(t)?this.initWithFile(t):cc.isObject(t)&&this.initWithDictionary(t,"")},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ParticleSystem.CanvasRenderCmd(this):new cc.ParticleSystem.WebGLRenderCmd(this)},ignoreColor:function(t){this._dontTint=t},initTexCoordsWithRect:function(t){this._renderCmd.initTexCoordsWithRect(t)},getBatchNode:function(){return this._batchNode},setBatchNode:function(t){this._renderCmd.setBatchNode(t)},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(t){this.atlasIndex=t},getDrawMode:function(){return this._renderCmd.getDrawMode()},setDrawMode:function(t){this._renderCmd.setDrawMode(t)},getShapeType:function(){return this._renderCmd.getShapeType()},setShapeType:function(t){this._renderCmd.setShapeType(t)},isActive:function(){return this._isActive},getParticleCount:function(){return this.particleCount},setParticleCount:function(t){this.particleCount=t},getDuration:function(){return this.duration},setDuration:function(t){this.duration=t},getSourcePosition:function(){return{x:this._sourcePosition.x,y:this._sourcePosition.y}},setSourcePosition:function(t){this._sourcePosition=t},getPosVar:function(){return{x:this._posVar.x,y:this._posVar.y}},setPosVar:function(t){this._posVar=t},getLife:function(){return this.life},setLife:function(t){this.life=t},getLifeVar:function(){return this.lifeVar},setLifeVar:function(t){this.lifeVar=t},getAngle:function(){return this.angle},setAngle:function(t){this.angle=t},getAngleVar:function(){return this.angleVar},setAngleVar:function(t){this.angleVar=t},getGravity:function(){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getGravity() : Particle Mode should be Gravity");var t=this.modeA.gravity;return cc.p(t.x,t.y)},setGravity:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setGravity() : Particle Mode should be Gravity"),this.modeA.gravity=t},getSpeed:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeed() : Particle Mode should be Gravity"),this.modeA.speed},setSpeed:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeed() : Particle Mode should be Gravity"),this.modeA.speed=t},getSpeedVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar},setSpeedVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setSpeedVar() : Particle Mode should be Gravity"),this.modeA.speedVar=t},getTangentialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel},setTangentialAccel:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccel() : Particle Mode should be Gravity"),this.modeA.tangentialAccel=t},getTangentialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar},setTangentialAccelVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setTangentialAccelVar() : Particle Mode should be Gravity"),this.modeA.tangentialAccelVar=t},getRadialAccel:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel},setRadialAccel:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccel() : Particle Mode should be Gravity"),this.modeA.radialAccel=t},getRadialAccelVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar},setRadialAccelVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRadialAccelVar() : Particle Mode should be Gravity"),this.modeA.radialAccelVar=t},getRotationIsDir:function(){return this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.getRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir},setRotationIsDir:function(t){this.emitterMode!==cc.ParticleSystem.MODE_GRAVITY&&cc.log("cc.ParticleBatchNode.setRotationIsDir() : Particle Mode should be Gravity"),this.modeA.rotationIsDir=t},getStartRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius},setStartRadius:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadius() : Particle Mode should be Radius"),this.modeB.startRadius=t},getStartRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar},setStartRadiusVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setStartRadiusVar() : Particle Mode should be Radius"),this.modeB.startRadiusVar=t},getEndRadius:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius},setEndRadius:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadius() : Particle Mode should be Radius"),this.modeB.endRadius=t},getEndRadiusVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar},setEndRadiusVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setEndRadiusVar() : Particle Mode should be Radius"),this.modeB.endRadiusVar=t},getRotatePerSecond:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond},setRotatePerSecond:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecond() : Particle Mode should be Radius"),this.modeB.rotatePerSecond=t},getRotatePerSecondVar:function(){return this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.getRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar},setRotatePerSecondVar:function(t){this.emitterMode!==cc.ParticleSystem.MODE_RADIUS&&cc.log("cc.ParticleBatchNode.setRotatePerSecondVar() : Particle Mode should be Radius"),this.modeB.rotatePerSecondVar=t},setScale:function(t,e){this._transformSystemDirty=!0,cc.Node.prototype.setScale.call(this,t,e)},setRotation:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setRotation.call(this,t)},setScaleX:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setScaleX.call(this,t)},setScaleY:function(t){this._transformSystemDirty=!0,cc.Node.prototype.setScaleY.call(this,t)},getStartSize:function(){return this.startSize},setStartSize:function(t){this.startSize=t},getStartSizeVar:function(){return this.startSizeVar},setStartSizeVar:function(t){this.startSizeVar=t},getEndSize:function(){return this.endSize},setEndSize:function(t){this.endSize=t},getEndSizeVar:function(){return this.endSizeVar},setEndSizeVar:function(t){this.endSizeVar=t},getStartColor:function(){return cc.color(this._startColor.r,this._startColor.g,this._startColor.b,this._startColor.a)},setStartColor:function(t){this._startColor=cc.color(t)},getStartColorVar:function(){return cc.color(this._startColorVar.r,this._startColorVar.g,this._startColorVar.b,this._startColorVar.a)},setStartColorVar:function(t){this._startColorVar=cc.color(t)},getEndColor:function(){return cc.color(this._endColor.r,this._endColor.g,this._endColor.b,this._endColor.a)},setEndColor:function(t){this._endColor=cc.color(t)},getEndColorVar:function(){return cc.color(this._endColorVar.r,this._endColorVar.g,this._endColorVar.b,this._endColorVar.a)},setEndColorVar:function(t){this._endColorVar=cc.color(t)},getStartSpin:function(){return this.startSpin},setStartSpin:function(t){this.startSpin=t},getStartSpinVar:function(){return this.startSpinVar},setStartSpinVar:function(t){this.startSpinVar=t},getEndSpin:function(){return this.endSpin},setEndSpin:function(t){this.endSpin=t},getEndSpinVar:function(){return this.endSpinVar},setEndSpinVar:function(t){this.endSpinVar=t},getEmissionRate:function(){return this.emissionRate},setEmissionRate:function(t){this.emissionRate=t},getTotalParticles:function(){return this._totalParticles},setTotalParticles:function(t){this._renderCmd.setTotalParticles(t)},getTexture:function(){return this._texture},setTexture:function(t){t&&(t.isLoaded()?this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height)):(this._textureLoaded=!1,t.addEventListener("load",function(t){this._textureLoaded=!0,this.setTextureWithRect(t,cc.rect(0,0,t.width,t.height))},this)))},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){void 0===e?this._blendFunc!==t&&(this._blendFunc=t,this._updateBlendFunc()):this._blendFunc.src===t&&this._blendFunc.dst===e||(this._blendFunc={src:t,dst:e},this._updateBlendFunc())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(t){this._opacityModifyRGB=t},isBlendAdditive:function(){return this._blendFunc.src===cc.SRC_ALPHA&&this._blendFunc.dst===cc.ONE||this._blendFunc.src===cc.ONE&&this._blendFunc.dst===cc.ONE},setBlendAdditive:function(t){var e=this._blendFunc;t?(e.src=cc.SRC_ALPHA,e.dst=cc.ONE):this._renderCmd._setBlendAdditive()},getPositionType:function(){return this.positionType},setPositionType:function(t){this.positionType=t},isAutoRemoveOnFinish:function(){return this.autoRemoveOnFinish},setAutoRemoveOnFinish:function(t){this.autoRemoveOnFinish=t},getEmitterMode:function(){return this.emitterMode},setEmitterMode:function(t){this.emitterMode=t},init:function(){return this.initWithTotalParticles(150)},initWithFile:function(t){this._plistFile=t;var e=cc.loader.getRes(t);return e?this.initWithDictionary(e,""):(cc.log("cc.ParticleSystem.initWithFile(): Particles: file not found"),!1)},getBoundingBoxToWorld:function(){return cc.rect(0,0,cc._canvas.width,cc._canvas.height)},initWithDictionary:function(t,e){var i=!1,n=null,r=this._valueForKey,o=parseInt(r("maxParticles",t));if(this.initWithTotalParticles(o)){this.angle=parseFloat(r("angle",t)),this.angleVar=parseFloat(r("angleVariance",t)),this.duration=parseFloat(r("duration",t)),this._blendFunc.src=parseInt(r("blendFuncSource",t)),this._blendFunc.dst=parseInt(r("blendFuncDestination",t));var s=this._startColor;s.r=255*parseFloat(r("startColorRed",t)),s.g=255*parseFloat(r("startColorGreen",t)),s.b=255*parseFloat(r("startColorBlue",t)),s.a=255*parseFloat(r("startColorAlpha",t));var c=this._startColorVar;c.r=255*parseFloat(r("startColorVarianceRed",t)),c.g=255*parseFloat(r("startColorVarianceGreen",t)),c.b=255*parseFloat(r("startColorVarianceBlue",t)),c.a=255*parseFloat(r("startColorVarianceAlpha",t));var a=this._endColor;a.r=255*parseFloat(r("finishColorRed",t)),a.g=255*parseFloat(r("finishColorGreen",t)),a.b=255*parseFloat(r("finishColorBlue",t)),a.a=255*parseFloat(r("finishColorAlpha",t));var l=this._endColorVar;if(l.r=255*parseFloat(r("finishColorVarianceRed",t)),l.g=255*parseFloat(r("finishColorVarianceGreen",t)),l.b=255*parseFloat(r("finishColorVarianceBlue",t)),l.a=255*parseFloat(r("finishColorVarianceAlpha",t)),this.startSize=parseFloat(r("startParticleSize",t)),this.startSizeVar=parseFloat(r("startParticleSizeVariance",t)),this.endSize=parseFloat(r("finishParticleSize",t)),this.endSizeVar=parseFloat(r("finishParticleSizeVariance",t)),this.setPosition(parseFloat(r("sourcePositionx",t)),parseFloat(r("sourcePositiony",t))),this._posVar.x=parseFloat(r("sourcePositionVariancex",t)),this._posVar.y=parseFloat(r("sourcePositionVariancey",t)),this.startSpin=parseFloat(r("rotationStart",t)),this.startSpinVar=parseFloat(r("rotationStartVariance",t)),this.endSpin=parseFloat(r("rotationEnd",t)),this.endSpinVar=parseFloat(r("rotationEndVariance",t)),this.emitterMode=parseInt(r("emitterType",t)),this.emitterMode===cc.ParticleSystem.MODE_GRAVITY){var h=this.modeA;h.gravity.x=parseFloat(r("gravityx",t)),h.gravity.y=parseFloat(r("gravityy",t)),h.speed=parseFloat(r("speed",t)),h.speedVar=parseFloat(r("speedVariance",t));var u=r("radialAcceleration",t);h.radialAccel=u?parseFloat(u):0,u=r("radialAccelVariance",t),h.radialAccelVar=u?parseFloat(u):0,u=r("tangentialAcceleration",t),h.tangentialAccel=u?parseFloat(u):0,u=r("tangentialAccelVariance",t),h.tangentialAccelVar=u?parseFloat(u):0;var d=r("rotationIsDir",t).toLowerCase();h.rotationIsDir=null!=d&&("true"===d||"1"===d)}else{if(this.emitterMode!==cc.ParticleSystem.MODE_RADIUS)return cc.log("cc.ParticleSystem.initWithDictionary(): Invalid emitterType in config file"),!1;var _=this.modeB;_.startRadius=parseFloat(r("maxRadius",t)),_.startRadiusVar=parseFloat(r("maxRadiusVariance",t)),_.endRadius=parseFloat(r("minRadius",t)),_.endRadiusVar=0,_.rotatePerSecond=parseFloat(r("rotatePerSecond",t)),_.rotatePerSecondVar=parseFloat(r("rotatePerSecondVariance",t))}if(this.life=parseFloat(r("particleLifespan",t)),this.lifeVar=parseFloat(r("particleLifespanVariance",t)),this.emissionRate=this._totalParticles/this.life,!this._batchNode){this._opacityModifyRGB=!1;var p=r("textureFileName",t),f=cc.path.changeBasename(this._plistFile,p),m=cc.textureCache.getTextureForKey(f);if(m)this.setTexture(m);else{var g=r("textureImageData",t);if(g&&0!==g.length){if(n=cc.unzipBase64AsArray(g,1),!n)return cc.log("cc.ParticleSystem: error decoding or ungzipping textureImageData"),!1;var y=cc.getImageFormatByData(n);if(y!==cc.FMT_TIFF&&y!==cc.FMT_PNG)return cc.log("cc.ParticleSystem: unknown image format with Data"),!1;var v=document.createElement("canvas");if(y===cc.FMT_PNG){var T=new cc.PNGReader(n);T.render(v)}else{var C=cc.tiffReader;C.parseTIFF(n,v)}cc.textureCache.cacheImage(f,v);var S=cc.textureCache.getTextureForKey(f);S||cc.log("cc.ParticleSystem.initWithDictionary() : error loading the texture"),this.setTexture(S)}else{if(m=cc.textureCache.addImage(f),!m)return!1;this.setTexture(m)}}}i=!0}return i},initWithTotalParticles:function(t){this._totalParticles=t;var e,i=this._particles;for(i.length=0,e=0;e<t;e++)i[e]=new cc.Particle;if(!i)return cc.log("Particle system: not enough memory"),!1;if(this._allocatedParticles=t,this._batchNode)for(e=0;e<this._totalParticles;e++)i[e].atlasIndex=e;return this._isActive=!0,this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.positionType=cc.ParticleSystem.TYPE_FREE,this.emitterMode=cc.ParticleSystem.MODE_GRAVITY,this.autoRemoveOnFinish=!1,this._transformSystemDirty=!1,this.scheduleUpdateWithPriority(1),this._renderCmd._initWithTotalParticles(t),!0},destroyParticleSystem:function(){this.unscheduleUpdate()},addParticle:function(){if(this.isFull())return!1;var t=this._renderCmd.addParticle();return this.initParticle(t),++this.particleCount,!0},initParticle:function(t){var e=cc.randomMinus1To1;t.timeToLive=this.life+this.lifeVar*e(),t.timeToLive=Math.max(0,t.timeToLive),t.pos.x=this._sourcePosition.x+this._posVar.x*e(),t.pos.y=this._sourcePosition.y+this._posVar.y*e();var i,n,r=this._startColor,o=this._startColorVar,s=this._endColor,c=this._endColorVar;i={r:cc.clampf(r.r+o.r*e(),0,255),g:cc.clampf(r.g+o.g*e(),0,255),b:cc.clampf(r.b+o.b*e(),0,255),a:cc.clampf(r.a+o.a*e(),0,255)},n={r:cc.clampf(s.r+c.r*e(),0,255),g:cc.clampf(s.g+c.g*e(),0,255),b:cc.clampf(s.b+c.b*e(),0,255),a:cc.clampf(s.a+c.a*e(),0,255)},t.color=i;var a=t.deltaColor,l=t.timeToLive;a.r=(n.r-i.r)/l,a.g=(n.g-i.g)/l,a.b=(n.b-i.b)/l,a.a=(n.a-i.a)/l;var h=this.startSize+this.startSizeVar*e();if(h=Math.max(0,h),t.size=h,this.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)t.deltaSize=0;else{var u=this.endSize+this.endSizeVar*e();u=Math.max(0,u),t.deltaSize=(u-h)/l}var d=this.startSpin+this.startSpinVar*e(),_=this.endSpin+this.endSpinVar*e();t.rotation=d,t.deltaRotation=(_-d)/l,this.positionType===cc.ParticleSystem.TYPE_FREE?t.startPos=this.convertToWorldSpace(this._pointZeroForParticle):this.positionType===cc.ParticleSystem.TYPE_RELATIVE&&(t.startPos.x=this._position.x,t.startPos.y=this._position.y);var p=cc.degreesToRadians(this.angle+this.angleVar*e());if(this.emitterMode===cc.ParticleSystem.MODE_GRAVITY){var f=this.modeA,m=t.modeA,g=f.speed+f.speedVar*e();m.dir.x=Math.cos(p),m.dir.y=Math.sin(p),cc.pMultIn(m.dir,g),m.radialAccel=f.radialAccel+f.radialAccelVar*e(),m.tangentialAccel=f.tangentialAccel+f.tangentialAccelVar*e(),f.rotationIsDir&&(t.rotation=-cc.radiansToDegrees(cc.pToAngle(m.dir)))}else{var y=this.modeB,v=t.modeB,T=y.startRadius+y.startRadiusVar*e(),C=y.endRadius+y.endRadiusVar*e();v.radius=T,v.deltaRadius=y.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(C-T)/l,v.angle=p,v.degreesPerSecond=cc.degreesToRadians(y.rotatePerSecond+y.rotatePerSecondVar*e())}},stopSystem:function(){this._isActive=!1,this._elapsed=this.duration,this._emitCounter=0},resetSystem:function(){this._isActive=!0,this._elapsed=0;var t=this._particles;for(this._particleIdx=0;this._particleIdx<this.particleCount;++this._particleIdx)t[this._particleIdx].timeToLive=0},isFull:function(){return this.particleCount>=this._totalParticles},updateQuadWithParticle:function(t,e){this._renderCmd.updateQuadWithParticle(t,e)},postStep:function(){this._renderCmd.postStep()},update:function(t){if(this._isActive&&this.emissionRate){var e=1/this.emissionRate;for(this.particleCount<this._totalParticles&&(this._emitCounter+=t);this.particleCount<this._totalParticles&&this._emitCounter>e;)this.addParticle(),this._emitCounter-=e;this._elapsed+=t,this.duration!==-1&&this.duration<this._elapsed&&this.stopSystem()}this._particleIdx=0;var i=cc.Particle.TemporaryPoints[0];if(this.positionType===cc.ParticleSystem.TYPE_FREE?cc.pIn(i,this.convertToWorldSpace(this._pointZeroForParticle)):this.positionType===cc.ParticleSystem.TYPE_RELATIVE&&(i.x=this._position.x,i.y=this._position.y),this._visible){for(var n=cc.Particle.TemporaryPoints[1],r=cc.Particle.TemporaryPoints[2],o=cc.Particle.TemporaryPoints[3],s=this._particles;this._particleIdx<this.particleCount;){cc.pZeroIn(n),cc.pZeroIn(r),cc.pZeroIn(o);var c=s[this._particleIdx];if(c.timeToLive-=t,c.timeToLive>0){if(this.emitterMode===cc.ParticleSystem.MODE_GRAVITY){var a=o,l=n,h=r;c.pos.x||c.pos.y?(cc.pIn(l,c.pos),cc.pNormalizeIn(l)):cc.pZeroIn(l),cc.pIn(h,l),cc.pMultIn(l,c.modeA.radialAccel);var u=h.x;h.x=-h.y,h.y=u,cc.pMultIn(h,c.modeA.tangentialAccel),cc.pIn(a,l),cc.pAddIn(a,h),cc.pAddIn(a,this.modeA.gravity),cc.pMultIn(a,t),cc.pAddIn(c.modeA.dir,a),cc.pIn(a,c.modeA.dir),cc.pMultIn(a,t),cc.pAddIn(c.pos,a)}else{var d=c.modeB;d.angle+=d.degreesPerSecond*t,d.radius+=d.deltaRadius*t,c.pos.x=-Math.cos(d.angle)*d.radius,c.pos.y=-Math.sin(d.angle)*d.radius}this._renderCmd._updateDeltaColor(c,t),c.size+=c.deltaSize*t,c.size=Math.max(0,c.size),c.rotation+=c.deltaRotation*t;var _=n;if(this.positionType===cc.ParticleSystem.TYPE_FREE||this.positionType===cc.ParticleSystem.TYPE_RELATIVE){var p=r;cc.pIn(p,i),cc.pSubIn(p,c.startPos),cc.pIn(_,c.pos),cc.pSubIn(_,p)}else cc.pIn(_,c.pos);this._batchNode&&(_.x+=this._position.x,_.y+=this._position.y),this._renderCmd.updateParticlePosition(c,_),++this._particleIdx}else{var f=c.atlasIndex;if(this._particleIdx!==this.particleCount-1){var m=s[this._particleIdx];s[this._particleIdx]=s[this.particleCount-1],s[this.particleCount-1]=m}if(this._batchNode&&(this._batchNode.disableParticle(this.atlasIndex+f),s[this.particleCount-1].atlasIndex=f),--this.particleCount,0===this.particleCount&&this.autoRemoveOnFinish)return this.unscheduleUpdate(),void this._parent.removeChild(this,!0)}}this._transformSystemDirty=!1}this._batchNode||this.postStep()},updateWithNoTime:function(){this.update(0)},_valueForKey:function(t,e){if(e){var i=e[t];return null!=i?i:""}return""},_updateBlendFunc:function(){if(this._batchNode)return void cc.log("Can't change blending functions when the particle is being batched");var t=this._texture;if(t&&t instanceof cc.Texture2D){this._opacityModifyRGB=!1;var e=this._blendFunc;e.src===cc.BLEND_SRC&&e.dst===cc.BLEND_DST&&(t.hasPremultipliedAlpha()?this._opacityModifyRGB=!0:(e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA))}},clone:function(){var t=new cc.ParticleSystem;if(t.initWithTotalParticles(this.getTotalParticles())){t.setAngle(this.getAngle()),t.setAngleVar(this.getAngleVar()),t.setDuration(this.getDuration());var e=this.getBlendFunc();if(t.setBlendFunc(e.src,e.dst),t.setStartColor(this.getStartColor()),t.setStartColorVar(this.getStartColorVar()),t.setEndColor(this.getEndColor()),t.setEndColorVar(this.getEndColorVar()),t.setStartSize(this.getStartSize()),t.setStartSizeVar(this.getStartSizeVar()),t.setEndSize(this.getEndSize()),t.setEndSizeVar(this.getEndSizeVar()),t.setPosition(cc.p(this.x,this.y)),t.setPosVar(cc.p(this.getPosVar().x,this.getPosVar().y)),t.setPositionType(this.getPositionType()),t.setStartSpin(this.getStartSpin()||0),t.setStartSpinVar(this.getStartSpinVar()||0),t.setEndSpin(this.getEndSpin()||0),t.setEndSpinVar(this.getEndSpinVar()||0),t.setEmitterMode(this.getEmitterMode()),this.getEmitterMode()===cc.ParticleSystem.MODE_GRAVITY){var i=this.getGravity();t.setGravity(cc.p(i.x,i.y)),t.setSpeed(this.getSpeed()),t.setSpeedVar(this.getSpeedVar()),t.setRadialAccel(this.getRadialAccel()),t.setRadialAccelVar(this.getRadialAccelVar()),t.setTangentialAccel(this.getTangentialAccel()),t.setTangentialAccelVar(this.getTangentialAccelVar())}else this.getEmitterMode()===cc.ParticleSystem.MODE_RADIUS&&(t.setStartRadius(this.getStartRadius()),t.setStartRadiusVar(this.getStartRadiusVar()),t.setEndRadius(this.getEndRadius()),t.setEndRadiusVar(this.getEndRadiusVar()),t.setRotatePerSecond(this.getRotatePerSecond()),t.setRotatePerSecondVar(this.getRotatePerSecondVar()));if(t.setLife(this.getLife()),t.setLifeVar(this.getLifeVar()),t.setEmissionRate(this.getEmissionRate()),!this.getBatchNode()){t.setOpacityModifyRGB(this.isOpacityModifyRGB());var n=this.getTexture();if(n){var r=n.getContentSize();t.setTextureWithRect(n,cc.rect(0,0,r.width,r.height))}}}return t},setDisplayFrame:function(t){if(t){var e=t.getOffsetInPixels();0===e.x&&0===e.y||cc.log("cc.ParticleSystem.setDisplayFrame(): QuadParticle only supports SpriteFrames with no offsets");var i=t.getTexture(),n=this._texture;n!==i&&this.setTexture(i)}},setTextureWithRect:function(t,e){var i=this._texture;i!==t&&(this._texture=t,this._updateBlendFunc()),this.initTexCoordsWithRect(e)},listenBackToForeground:function(t){}});var _p=cc.ParticleSystem.prototype;_p.opacityModifyRGB,cc.defineGetterSetter(_p,"opacityModifyRGB",_p.isOpacityModifyRGB,_p.setOpacityModifyRGB),_p.batchNode,cc.defineGetterSetter(_p,"batchNode",_p.getBatchNode,_p.setBatchNode),_p.drawMode,cc.defineGetterSetter(_p,"drawMode",_p.getDrawMode,_p.setDrawMode),_p.shapeType,cc.defineGetterSetter(_p,"shapeType",_p.getShapeType,_p.setShapeType),_p.active,cc.defineGetterSetter(_p,"active",_p.isActive),_p.sourcePos,cc.defineGetterSetter(_p,"sourcePos",_p.getSourcePosition,_p.setSourcePosition),_p.posVar,cc.defineGetterSetter(_p,"posVar",_p.getPosVar,_p.setPosVar),_p.gravity,cc.defineGetterSetter(_p,"gravity",_p.getGravity,_p.setGravity),_p.speed,cc.defineGetterSetter(_p,"speed",_p.getSpeed,_p.setSpeed),_p.speedVar,cc.defineGetterSetter(_p,"speedVar",_p.getSpeedVar,_p.setSpeedVar),_p.tangentialAccel,cc.defineGetterSetter(_p,"tangentialAccel",_p.getTangentialAccel,_p.setTangentialAccel),_p.tangentialAccelVar,cc.defineGetterSetter(_p,"tangentialAccelVar",_p.getTangentialAccelVar,_p.setTangentialAccelVar),_p.radialAccel,cc.defineGetterSetter(_p,"radialAccel",_p.getRadialAccel,_p.setRadialAccel),_p.radialAccelVar,cc.defineGetterSetter(_p,"radialAccelVar",_p.getRadialAccelVar,_p.setRadialAccelVar),_p.rotationIsDir,cc.defineGetterSetter(_p,"rotationIsDir",_p.getRotationIsDir,_p.setRotationIsDir),_p.startRadius,cc.defineGetterSetter(_p,"startRadius",_p.getStartRadius,_p.setStartRadius),_p.startRadiusVar,cc.defineGetterSetter(_p,"startRadiusVar",_p.getStartRadiusVar,_p.setStartRadiusVar),_p.endRadius,cc.defineGetterSetter(_p,"endRadius",_p.getEndRadius,_p.setEndRadius),_p.endRadiusVar,cc.defineGetterSetter(_p,"endRadiusVar",_p.getEndRadiusVar,_p.setEndRadiusVar),_p.rotatePerS,cc.defineGetterSetter(_p,"rotatePerS",_p.getRotatePerSecond,_p.setRotatePerSecond),_p.rotatePerSVar,cc.defineGetterSetter(_p,"rotatePerSVar",_p.getRotatePerSecondVar,_p.setRotatePerSecondVar),_p.startColor,cc.defineGetterSetter(_p,"startColor",_p.getStartColor,_p.setStartColor),_p.startColorVar,cc.defineGetterSetter(_p,"startColorVar",_p.getStartColorVar,_p.setStartColorVar),_p.endColor,cc.defineGetterSetter(_p,"endColor",_p.getEndColor,_p.setEndColor),_p.endColorVar,cc.defineGetterSetter(_p,"endColorVar",_p.getEndColorVar,_p.setEndColorVar),_p.totalParticles,cc.defineGetterSetter(_p,"totalParticles",_p.getTotalParticles,_p.setTotalParticles),_p.texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleSystem.create=function(t){return new cc.ParticleSystem(t)},cc.ParticleSystem.createWithTotalParticles=cc.ParticleSystem.create,cc.ParticleSystem.ModeA=function(t,e,i,n,r,o,s,c){this.gravity=t?t:cc.p(0,0),this.speed=e||0,this.speedVar=i||0,this.tangentialAccel=n||0,this.tangentialAccelVar=r||0,this.radialAccel=o||0,this.radialAccelVar=s||0,this.rotationIsDir=c||!1},cc.ParticleSystem.ModeB=function(t,e,i,n,r,o){this.startRadius=t||0,this.startRadiusVar=e||0,this.endRadius=i||0,this.endRadiusVar=n||0,this.rotatePerSecond=r||0,this.rotatePerSecondVar=o||0},cc.ParticleSystem.SHAPE_MODE=0,cc.ParticleSystem.TEXTURE_MODE=1,cc.ParticleSystem.STAR_SHAPE=0,cc.ParticleSystem.BALL_SHAPE=1,cc.ParticleSystem.DURATION_INFINITY=-1,cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE=-1,cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS=-1,cc.ParticleSystem.MODE_GRAVITY=0,cc.ParticleSystem.MODE_RADIUS=1,cc.ParticleSystem.TYPE_FREE=0,cc.ParticleSystem.TYPE_RELATIVE=1,cc.ParticleSystem.TYPE_GROUPED=2,function(){cc.ParticleSystem.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._drawMode=cc.ParticleSystem.TEXTURE_MODE,this._shapeType=cc.ParticleSystem.BALL_SHAPE,this._pointRect=cc.rect(0,0,0,0),this._tintCache=document.createElement("canvas")};var t=cc.ParticleSystem.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParticleSystem.CanvasRenderCmd,t.getDrawMode=function(){return this._drawMode},t.setDrawMode=function(t){this._drawMode=t},t.getShapeType=function(){return this._shapeType},t.setShapeType=function(t){this._shapeType=t},t.setBatchNode=function(t){this._batchNode!==t&&(this._node._batchNode=t)},t.updateQuadWithParticle=function(t,e){},t.updateParticlePosition=function(t,e){cc.pIn(t.drawPos,e)},t.rendering=function(t,e,i){var n=t||cc._renderContext,r=n.getContext(),o=this._node,s=this._pointRect;n.setTransform(this._worldTransform,e,i),n.save(),o.isBlendAdditive()?r.globalCompositeOperation="lighter":r.globalCompositeOperation="source-over";var c,a,l,h,u=this._node.particleCount,d=this._node._particles;if(o.drawMode!==cc.ParticleSystem.SHAPE_MODE&&o._texture){if(!o._texture._textureLoaded)return void n.restore();var _=o._texture.getHtmlElementObj();if(!_.width||!_.height)return void n.restore();var p=_;for(c=0;c<u;c++)if(a=d[c],l=0|.5*a.size,h=a.color.a/255,0!==h){r.globalAlpha=h,r.save(),r.translate(0|a.drawPos.x,-(0|a.drawPos.y));var f=4*Math.floor(a.size/4),m=s.width,g=s.height;r.scale(Math.max(1/m*f,1e-6),Math.max(1/g*f,1e-6)),a.rotation&&r.rotate(cc.degreesToRadians(a.rotation)),p=a.isChangeColor?this._changeTextureColor(o._texture,a.color,this._pointRect):_,r.drawImage(p,-(0|m/2),-(0|g/2)),r.restore()}}else{var y=cc._drawingUtil;for(c=0;c<u;c++)a=d[c],l=0|.5*a.size,h=a.color.a/255,0!==h&&(r.globalAlpha=h,r.save(),r.translate(0|a.drawPos.x,-(0|a.drawPos.y)),o.shapeType===cc.ParticleSystem.STAR_SHAPE?(a.rotation&&r.rotate(cc.degreesToRadians(a.rotation)),y.drawStar(n,l,a.color)):y.drawColorBall(n,l,a.color),r.restore())}n.restore(),cc.g_NumberOfDraws++},t._changeTextureColor=function(t,e,i){var n=this._tintCache,r=t.getContentSize();return n.width=r.width,n.height=r.height,t._generateColorTexture(e.r,e.g,e.b,i,n)},t.initTexCoordsWithRect=function(t){this._pointRect=t},t.setTotalParticles=function(t){this._node._totalParticles=t<200?t:200},t.addParticle=function(){var t,e=this._node,i=e._particles;return e.particleCount<i.length?t=i[e.particleCount]:(t=new cc.Particle,i.push(t)),t},t._setupVBO=function(){},t._allocMemory=function(){return!0},t.postStep=function(){},t._setBlendAdditive=function(){var t=this._node._blendFunc;t.src=cc.BLEND_SRC,t.dst=cc.BLEND_DST},t._initWithTotalParticles=function(t){},t._updateDeltaColor=function(t,e){this._node._dontTint||(t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0)}}(),cc.ParticleFire=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?300:150)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(60),this.setSpeedVar(20),this.setAngle(90),this.setAngleVar(10);var e=cc.director.getWinSize();return this.setPosition(e.width/2,60),this.setPosVar(cc.p(40,20)),this.setLife(3),this.setLifeVar(.25),this.setStartSize(54),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleFire.create=function(){return new cc.ParticleFire},cc.ParticleFireworks=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?1500:150)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-90)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(180),this.setSpeedVar(50);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setAngle(90),this.setAngleVar(20),this.setLife(3.5),this.setLifeVar(1),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,255)),this.setEndColor(cc.color(26,26,26,51)),this.setEndColorVar(cc.color(26,26,26,51)),this.setStartSize(8),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleFireworks.create=function(){return new cc.ParticleFireworks},cc.ParticleSun=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?350:150)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setBlendAdditive(!0),this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(20),this.setSpeedVar(5),this.setAngle(90),this.setAngleVar(360);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(1),this.setLifeVar(.5),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(194,64,31,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),!0}return!1}}),cc.ParticleSun.create=function(){return new cc.ParticleSun},cc.ParticleGalaxy=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(60),this.setSpeedVar(10),this.setRadialAccel(-80),this.setRadialAccelVar(0),this.setTangentialAccel(80),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(37),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(31,64,194,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleGalaxy.create=function(){return new cc.ParticleGalaxy},cc.ParticleFlower=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?250:100)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(80),this.setSpeedVar(10),this.setRadialAccel(-60),this.setRadialAccelVar(0),this.setTangentialAccel(15),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(30),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,128)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleFlower.create=function(){return new cc.ParticleFlower},cc.ParticleMeteor=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?150:100)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(-200,200)),this.setSpeed(15),this.setSpeedVar(5),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(2),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(51,102,179)),this.setStartColorVar(cc.color(0,0,51,26)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!0),!0}return!1}}),cc.ParticleMeteor.create=function(){return new cc.ParticleMeteor},cc.ParticleSpiral=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?500:100)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(150),this.setSpeedVar(0),this.setRadialAccel(-380),this.setRadialAccelVar(0),this.setTangentialAccel(45),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(0);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(12),this.setLifeVar(0),this.setStartSize(20),this.setStartSizeVar(0),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(128,128,128,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,255)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSpiral.create=function(){return new cc.ParticleSpiral},cc.ParticleExplosion=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?700:300)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(.1),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setSpeed(70),this.setSpeedVar(40),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setTangentialAccel(0),this.setTangentialAccelVar(0),this.setAngle(90),this.setAngleVar(360);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height/2),this.setPosVar(cc.p(0,0)),this.setLife(5),this.setLifeVar(2),this.setStartSize(15),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getDuration()),this.setStartColor(cc.color(179,26,51,255)),this.setStartColorVar(cc.color(128,128,128,0)),this.setEndColor(cc.color(128,128,128,0)),this.setEndColorVar(cc.color(128,128,128,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleExplosion.create=function(){return new cc.ParticleExplosion},cc.ParticleSmoke=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?200:100)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,0)),this.setRadialAccel(0),this.setRadialAccelVar(0),this.setSpeed(25),this.setSpeedVar(10),this.setAngle(90),this.setAngleVar(5);var e=cc.director.getWinSize();return this.setPosition(e.width/2,0),this.setPosVar(cc.p(20,0)),this.setLife(4),this.setLifeVar(1),this.setStartSize(60),this.setStartSizeVar(10),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(this.getTotalParticles()/this.getLife()),this.setStartColor(cc.color(204,204,204,255)),this.setStartColorVar(cc.color(5,5,5,0)),this.setEndColor(cc.color(0,0,0,255)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSmoke.create=function(){return new cc.ParticleSmoke},cc.ParticleSnow=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?700:250)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(0,-1)),this.setSpeed(5),this.setSpeedVar(1),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height+10),this.setPosVar(cc.p(e.width/2,0)),this.setAngle(-90),this.setAngleVar(5),this.setLife(45),this.setLifeVar(15),this.setStartSize(10),this.setStartSizeVar(5),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(10),this.setStartColor(cc.color(255,255,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(255,255,255,0)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleSnow.create=function(){return new cc.ParticleSnow},cc.ParticleRain=cc.ParticleSystem.extend({ctor:function(){cc.ParticleSystem.prototype.ctor.call(this,cc._renderType===cc.game.RENDER_TYPE_WEBGL?1e3:300)},initWithTotalParticles:function(t){if(cc.ParticleSystem.prototype.initWithTotalParticles.call(this,t)){this.setDuration(cc.ParticleSystem.DURATION_INFINITY),this.setEmitterMode(cc.ParticleSystem.MODE_GRAVITY),this.setGravity(cc.p(10,-10)),this.setRadialAccel(0),this.setRadialAccelVar(1),this.setTangentialAccel(0),this.setTangentialAccelVar(1),this.setSpeed(130),this.setSpeedVar(30),this.setAngle(-90),this.setAngleVar(5);var e=cc.director.getWinSize();return this.setPosition(e.width/2,e.height),this.setPosVar(cc.p(e.width/2,0)),this.setLife(4.5),this.setLifeVar(0),this.setStartSize(4),this.setStartSizeVar(2),this.setEndSize(cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE),this.setEmissionRate(20),this.setStartColor(cc.color(179,204,255,255)),this.setStartColorVar(cc.color(0,0,0,0)),this.setEndColor(cc.color(179,204,255,128)),this.setEndColorVar(cc.color(0,0,0,0)),this.setBlendAdditive(!1),!0}return!1}}),cc.ParticleRain.create=function(){return new cc.ParticleRain},cc.PARTICLE_DEFAULT_CAPACITY=500,cc.ParticleBatchNode=cc.Node.extend({textureAtlas:null,_blendFunc:null,_className:"ParticleBatchNode",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},cc.isString(t)?this.init(t,e):t instanceof cc.Texture2D&&this.initWithTexture(t,e)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ParticleBatchNode.CanvasRenderCmd(this):new cc.ParticleBatchNode.WebGLRenderCmd(this)},initWithTexture:function(t,e){return this.textureAtlas=new cc.TextureAtlas,this.textureAtlas.initWithTexture(t,e),this._children.length=0,this._renderCmd._initWithTexture(),!0},initWithFile:function(t,e){var i=cc.textureCache.addImage(t);return this.initWithTexture(i,e)},init:function(t,e){var i=cc.textureCache.addImage(t);return this.initWithTexture(i,e)},addChild:function(t,e,i){if(!t)throw new Error("cc.ParticleBatchNode.addChild() : child should be non-null");if(!(t instanceof cc.ParticleSystem))throw new Error("cc.ParticleBatchNode.addChild() : only supports cc.ParticleSystem as children");if(e=null==e?t.zIndex:e,i=null==i?t.tag:i,t.getTexture()!==this.textureAtlas.texture)throw new Error("cc.ParticleSystem.addChild() : the child is not using the same texture id");var n=t.getBlendFunc();if(0===this._children.length)this.setBlendFunc(n);else if(n.src!==this._blendFunc.src||n.dst!==this._blendFunc.dst)return void cc.log("cc.ParticleSystem.addChild() : Can't add a ParticleSystem that uses a different blending function");var r=this._addChildHelper(t,e,i),o=0;if(0!==r){var s=this._children[r-1];o=s.getAtlasIndex()+s.getTotalParticles()}else o=0;this.insertChild(t,o),t.setBatchNode(this)},insertChild:function(t,e){var i=t.getTotalParticles(),n=this.textureAtlas,r=n.totalQuads;t.setAtlasIndex(e),r+i>n.getCapacity()&&(this._increaseAtlasCapacityTo(r+i),n.fillWithEmptyQuadsFromIndex(n.getCapacity()-i,i)),t.getAtlasIndex()+i!==r&&n.moveQuadsFromIndex(e,e+i),n.increaseTotalQuadsWith(i),this._updateAllAtlasIndexes()},removeChild:function(t,e){if(null!=t){if(!(t instanceof cc.ParticleSystem))throw new Error("cc.ParticleBatchNode.removeChild(): only supports cc.ParticleSystem as children");if(this._children.indexOf(t)===-1)return void cc.log("cc.ParticleBatchNode.removeChild(): doesn't contain the sprite. Can't remove it");cc.Node.prototype.removeChild.call(this,t,e);var i=this.textureAtlas;i.removeQuadsAtIndex(t.getAtlasIndex(),t.getTotalParticles()),i.fillWithEmptyQuadsFromIndex(i.totalQuads,t.getTotalParticles()),t.setBatchNode(null),this._updateAllAtlasIndexes()}},reorderChild:function(t,e){if(!t)throw new Error("cc.ParticleBatchNode.reorderChild(): child should be non-null");if(!(t instanceof cc.ParticleSystem))throw new Error("cc.ParticleBatchNode.reorderChild(): only supports cc.QuadParticleSystems as children");if(this._children.indexOf(t)===-1)return void cc.log("cc.ParticleBatchNode.reorderChild(): Child doesn't belong to batch");if(e!==t.zIndex){if(this._children.length>1){var i=this._getCurrentIndex(t,e);if(i.oldIndex!==i.newIndex){this._children.splice(i.oldIndex,1),this._children.splice(i.newIndex,0,t);var n=t.getAtlasIndex();this._updateAllAtlasIndexes();for(var r=0,o=this._children,s=0;s<o.length;s++){var c=o[s];if(c===t){r=t.getAtlasIndex();break}}this.textureAtlas.moveQuadsFromIndex(n,t.getTotalParticles(),r),t.updateWithNoTime()}}t._setLocalZOrder(e)}},removeChildAtIndex:function(t,e){this.removeChild(this._children[i],e)},removeAllChildren:function(t){for(var e=this._children,i=0;i<e.length;i++)e[i].setBatchNode(null);cc.Node.prototype.removeAllChildren.call(this,t),this.textureAtlas.removeAllQuads()},disableParticle:function(t){var e=this.textureAtlas.quads[t];e.br.vertices.x=e.br.vertices.y=e.tr.vertices.x=e.tr.vertices.y=e.tl.vertices.x=e.tl.vertices.y=e.bl.vertices.x=e.bl.vertices.y=0,this.textureAtlas._setDirty(!0)},getTexture:function(){return this.textureAtlas.texture},setTexture:function(t){this.textureAtlas.texture=t;var e=this._blendFunc;t&&!t.hasPremultipliedAlpha()&&e.src===cc.BLEND_SRC&&e.dst===cc.BLEND_DST&&(e.src=cc.SRC_ALPHA,e.dst=cc.ONE_MINUS_SRC_ALPHA)},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.src=e)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},_updateAllAtlasIndexes:function(){for(var t=0,e=this._children,i=0;i<e.length;i++){var n=e[i];n.setAtlasIndex(t),t+=n.getTotalParticles()}},_increaseAtlasCapacityTo:function(t){cc.log("cocos2d: cc.ParticleBatchNode: resizing TextureAtlas capacity from ["+this.textureAtlas.getCapacity()+"] to ["+t+"]."),this.textureAtlas.resizeCapacity(t)||cc.log("cc.ParticleBatchNode._increaseAtlasCapacityTo() : WARNING: Not enough memory to resize the atlas")},_searchNewPositionInChildrenForZ:function(t){for(var e=this._children,i=e.length,n=0;n<i;n++)if(e[n].zIndex>t)return n;return i},_getCurrentIndex:function(t,e){for(var i=!1,n=!1,r=0,o=0,s=0,c=this._children,a=c.length,l=0;l<a;l++){var h=c[l];if(h.zIndex>e&&!n&&(r=l,n=!0,i&&n))break;if(t===h&&(o=l,i=!0,n||(s=-1),i&&n))break}return n||(r=a),r+=s,{newIndex:r,oldIndex:o}},_addChildHelper:function(t,e,i){if(!t)throw new Error("cc.ParticleBatchNode._addChildHelper(): child should be non-null");if(t.parent)return cc.log("cc.ParticleBatchNode._addChildHelper(): child already added. It can't be added again"),null;this._children||(this._children=[]);var n=this._searchNewPositionInChildrenForZ(e);return this._children.splice(n,0,t),t.tag=i,t._setLocalZOrder(e),t.parent=this,this._running&&(t.onEnter(),t.onEnterTransitionDidFinish()),n},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(t){this.textureAtlas=t}});var _p=cc.ParticleBatchNode.prototype;_p.texture,cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture),cc.ParticleBatchNode.create=function(t,e){return new cc.ParticleBatchNode(t,e)},function(){cc.ParticleBatchNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=cc.ParticleBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParticleBatchNode.CanvasRenderCmd,t._initWithTexture=function(){}}();!function(){cc.ParticleBatchNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()};var t=cc.ParticleBatchNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ParticleBatchNode.WebGLRenderCmd,t.rendering=function(t){var e=this._node;if(0!==e.textureAtlas.totalQuads){var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.glBlendFuncForParticle(e._blendFunc.src,e._blendFunc.dst),e.textureAtlas.drawQuads()}},t._initWithTexture=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)},t.visit=function(t){var e=this._node;e._visible&&(t=t||this.getParentRenderCmd(),t&&(this._curLevel=t._curLevel+1),this._syncStatus(t),cc.renderer.pushRenderCommand(this),this._dirtyFlag=0)}}(),function(){cc.ParticleSystem.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._buffersVBO=[0,0],this._quads=[],this._indices=[],this._quadsArrayBuffer=null};var t=cc.ParticleSystem.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ParticleSystem.WebGLRenderCmd,t.getDrawMode=function(){},t.setDrawMode=function(t){},t.getShapeType=function(){},t.setShapeType=function(t){},t.setBatchNode=function(t){var e=this._node;if(e._batchNode!==t){var i=e._batchNode;if(e._batchNode=t,t)for(var n=e._particles,r=0;r<e._totalParticles;r++)n[r].atlasIndex=r;t?i||(e._batchNode.textureAtlas._copyQuadsToTextureAtlas(this._quads,e.atlasIndex),cc._renderContext.deleteBuffer(this._buffersVBO[1])):(this._allocMemory(),this.initIndices(e._totalParticles),e.setTexture(i.getTexture()),this._setupVBO())}},t.initIndices=function(t){for(var e=this._indices,i=0,n=t;i<n;++i){var r=6*i,o=4*i;e[r+0]=o+0,e[r+1]=o+1,e[r+2]=o+2,e[r+5]=o+1,e[r+4]=o+2,e[r+3]=o+3}},t.isDifferentTexture=function(t,e){return t===e},t.updateParticlePosition=function(t,e){this.updateQuadWithParticle(t,e)},t.updateQuadWithParticle=function(t,e){var i=null,n=this._node;if(n._batchNode){var r=n._batchNode.textureAtlas.quads;i=r[n.atlasIndex+t.atlasIndex],n._batchNode.textureAtlas.dirty=!0}else i=this._quads[n._particleIdx];var o,s,c,a;n._opacityModifyRGB?(o=0|t.color.r*t.color.a/255,s=0|t.color.g*t.color.a/255,c=0|t.color.b*t.color.a/255):(o=0|t.color.r,s=0|t.color.g,c=0|t.color.b),a=0|t.color.a;var l=i.bl.colors,h=i.br.colors,u=i.tl.colors,d=i.tr.colors;l.r=h.r=u.r=d.r=o,l.g=h.g=u.g=d.g=s,l.b=h.b=u.b=d.b=c,l.a=h.a=u.a=d.a=a;var _=t.size/2;if(t.rotation){var p=-_,f=-_,m=_,g=_,y=e.x,v=e.y,T=-cc.degreesToRadians(t.rotation),C=Math.cos(T),S=Math.sin(T),x=p*C-f*S+y,A=p*S+f*C+v,E=m*C-f*S+y,b=m*S+f*C+v,R=m*C-g*S+y,P=m*S+g*C+v,w=p*C-g*S+y,I=p*S+g*C+v;i.bl.vertices.x=x,i.bl.vertices.y=A,i.br.vertices.x=E,i.br.vertices.y=b,i.tl.vertices.x=w,i.tl.vertices.y=I,i.tr.vertices.x=R,i.tr.vertices.y=P}else i.bl.vertices.x=e.x-_,i.bl.vertices.y=e.y-_,i.br.vertices.x=e.x+_,i.br.vertices.y=e.y-_,i.tl.vertices.x=e.x-_,i.tl.vertices.y=e.y+_,i.tr.vertices.x=e.x+_,i.tr.vertices.y=e.y+_},t.rendering=function(t){var e=this._node;if(e._texture){var i=t||cc._renderContext,n=this._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),cc.glBindTexture2D(e._texture),cc.glBlendFuncForParticle(e._blendFunc.src,e._blendFunc.dst),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),i.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),i.bindBuffer(i.ARRAY_BUFFER,this._buffersVBO[0]),i.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,i.FLOAT,!1,24,0),i.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,i.UNSIGNED_BYTE,!0,24,12),i.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,i.FLOAT,!1,24,16),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),i.drawElements(i.TRIANGLES,6*e._particleIdx,i.UNSIGNED_SHORT,0)}},t.initTexCoordsWithRect=function(t){var e=this._node,i=e.texture,n=cc.contentScaleFactor(),r=cc.rect(t.x*n,t.y*n,t.width*n,t.height*n),o=t.width,s=t.height;i&&(o=i.pixelsWidth,s=i.pixelsHeight);var c,a,l,h;cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(c=(2*r.x+1)/(2*o),a=(2*r.y+1)/(2*s),l=c+(2*r.width-2)/(2*o),h=a+(2*r.height-2)/(2*s)):(c=r.x/o,a=r.y/s,l=c+r.width/o,h=a+r.height/s);var u=h;h=a,a=u;var d,_=0,p=0;e._batchNode?(d=e._batchNode.textureAtlas.quads,_=e.atlasIndex,p=e.atlasIndex+e._totalParticles):(d=this._quads,_=0,p=e._totalParticles);for(var f=_;f<p;f++){d[f]||(d[f]=cc.V3F_C4B_T2F_QuadZero());var m=d[f];m.bl.texCoords.u=c,m.bl.texCoords.v=a,m.br.texCoords.u=l,m.br.texCoords.v=a,m.tl.texCoords.u=c,m.tl.texCoords.v=h,m.tr.texCoords.u=l,m.tr.texCoords.v=h}},t.setTotalParticles=function(t){var e=this._node;if(t>e._allocatedParticles){var i=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._indices=new Uint16Array(6*t);var n=new ArrayBuffer(t*i),r=e._particles;r.length=0;var o=this._quads;o.length=0;for(var s=0;s<t;s++)r[s]=new cc.Particle,o[s]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,s*i);if(e._allocatedParticles=t,e._totalParticles=t,e._batchNode)for(var c=0;c<t;c++)r[c].atlasIndex=c;this._quadsArrayBuffer=n,this.initIndices(t),this._setupVBO(),e._texture&&this.initTexCoordsWithRect(cc.rect(0,0,e._texture.width,e._texture.height))}else e._totalParticles=t;e.resetSystem()},t.addParticle=function(){var t=this._node,e=t._particles;return e[t.particleCount]},t._setupVBO=function(){var t=cc._renderContext;this._buffersVBO[0]=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferData(t.ARRAY_BUFFER,this._quadsArrayBuffer,t.DYNAMIC_DRAW),this._buffersVBO[1]=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW)},t._allocMemory=function(){var t=this._node;if(t._batchNode)return cc.log("cc.ParticleSystem._allocMemory(): Memory should not be allocated when not using batchNode"),!1;var e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,i=t._totalParticles,n=this._quads;n.length=0,this._indices=new Uint16Array(6*i);for(var r=new ArrayBuffer(e*i),o=0;o<i;o++)n[o]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,r,o*e);return n&&this._indices?(this._quadsArrayBuffer=r,!0):(cc.log("cocos2d: Particle system: not enough memory"),!1)},t.postStep=function(){var t=cc._renderContext;t.bindBuffer(t.ARRAY_BUFFER,this._buffersVBO[0]),t.bufferSubData(t.ARRAY_BUFFER,0,this._quadsArrayBuffer)},t._setBlendAdditive=function(){var t=this._node._blendFunc;this._texture&&!this._texture.hasPremultipliedAlpha()?(t.src=cc.SRC_ALPHA,t.dst=cc.ONE_MINUS_SRC_ALPHA):(t.src=cc.BLEND_SRC,t.dst=cc.BLEND_DST)},t._initWithTotalParticles=function(t){return!!this._allocMemory()&&(this.initIndices(t),this._setupVBO(),void(this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)))},t._updateDeltaColor=function(t,e){t.color.r+=t.deltaColor.r*e,t.color.g+=t.deltaColor.g*e,t.color.b+=t.deltaColor.b*e,t.color.a+=t.deltaColor.a*e,t.isChangeColor=!0}}();cc.IMEKeyboardNotificationInfo=function(t,e,i){this.begin=t||cc.rect(0,0,0,0),this.end=e||cc.rect(0,0,0,0),this.duration=i||0},cc.IMEDelegate=cc.Class.extend({ctor:function(){cc.imeDispatcher.addDelegate(this)},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!1},didAttachWithIME:function(){},canDetachWithIME:function(){return!1},didDetachWithIME:function(){},insertText:function(t,e){},deleteBackward:function(){},getContentText:function(){return""},keyboardWillShow:function(t){},keyboardDidShow:function(t){},keyboardWillHide:function(t){},keyboardDidHide:function(t){}}),cc.IMEDispatcher=cc.Class.extend({_domInputControl:null,impl:null,_currentInputString:"",_lastClickPosition:null,ctor:function(){this.impl=new cc.IMEDispatcher.Impl,this._lastClickPosition=cc.p(0,0)},init:function(){if(!cc.sys.isMobile){this._domInputControl=cc.$("#imeDispatcherInput"),this._domInputControl||(this._domInputControl=cc.$new("input"),this._domInputControl.setAttribute("type","text"),this._domInputControl.setAttribute("id","imeDispatcherInput"),this._domInputControl.resize(0,0),this._domInputControl.translates(0,0),this._domInputControl.style.opacity="0",this._domInputControl.style.fontSize="1px",this._domInputControl.setAttribute("tabindex",2),this._domInputControl.style.position="absolute",this._domInputControl.style.top=0,this._domInputControl.style.left=0,document.body.appendChild(this._domInputControl));var t=this;this._domInputControl.addEventListener("input",function(){t._processDomInputString(t._domInputControl.value)},!1),this._domInputControl.addEventListener("keydown",function(e){e.keyCode===cc.KEY.tab?(e.stopPropagation(),e.preventDefault()):e.keyCode===cc.KEY.enter&&(t.dispatchInsertText("\n",1),e.stopPropagation(),e.preventDefault())},!1),/msie/i.test(navigator.userAgent)&&this._domInputControl.addEventListener("keyup",function(e){e.keyCode===cc.KEY.backspace&&t._processDomInputString(t._domInputControl.value)},!1),window.addEventListener("mousedown",function(e){var i=e.pageX||0,n=e.pageY||0;t._lastClickPosition.x=i,t._lastClickPosition.y=n},!1)}},_processDomInputString:function(t){var e,i,n=this._currentInputString.length<t.length?this._currentInputString.length:t.length;for(i=0;i<n&&t[i]===this._currentInputString[i];i++);var r=this._currentInputString.length-i,o=t.length-i;for(e=0;e<r;e++)this.dispatchDeleteBackward();for(e=0;e<o;e++)this.dispatchInsertText(t[i+e],1);this._currentInputString=t},dispatchInsertText:function(t,e){!this.impl||!t||e<=0||this.impl._delegateWithIme&&this.impl._delegateWithIme.insertText(t,e)},dispatchDeleteBackward:function(){this.impl&&this.impl._delegateWithIme&&this.impl._delegateWithIme.deleteBackward()},getContentText:function(){if(this.impl&&this.impl._delegateWithIme){var t=this.impl._delegateWithIme.getContentText();return t?t:""}return""},dispatchKeyboardWillShow:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardWillShow(t)}},dispatchKeyboardDidShow:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardDidShow(t)}},dispatchKeyboardWillHide:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardWillHide(t)}},dispatchKeyboardDidHide:function(t){if(this.impl)for(var e=0;e<this.impl._delegateList.length;e++){var i=this.impl._delegateList[e];i&&i.keyboardDidHide(t)}},addDelegate:function(t){t&&this.impl&&(this.impl._delegateList.indexOf(t)>-1||this.impl._delegateList.splice(0,0,t))},attachDelegateWithIME:function(t){if(!this.impl||!t)return!1;if(this.impl._delegateList.indexOf(t)===-1)return!1;if(this.impl._delegateWithIme){if(!this.impl._delegateWithIme.canDetachWithIME()||!t.canAttachWithIME())return!1;var e=this.impl._delegateWithIme;return this.impl._delegateWithIme=null,e.didDetachWithIME(),this._focusDomInput(t),!0}return!!t.canAttachWithIME()&&(this._focusDomInput(t),!0)},_focusDomInput:function(t){if(cc.sys.isMobile){this.impl._delegateWithIme=t,t.didAttachWithIME(),this._currentInputString=t.string||"";var e,i=t.getTipMessage?t.getTipMessage():"please enter your word:",n=window.Window;e=n&&n.prototype.prompt&&n.prototype.prompt!=prompt?n.prototype.prompt.call(window,i,this._currentInputString):prompt(i,this._currentInputString),null!=e&&this._processDomInputString(e),this.dispatchInsertText("\n",1)}else this.impl._delegateWithIme=t,this._currentInputString=t.string||"",t.didAttachWithIME(),this._domInputControl.focus(),this._domInputControl.value=this._currentInputString,this._domInputControlTranslate()},_domInputControlTranslate:function(){/msie/i.test(navigator.userAgent)?(this._domInputControl.style.left=this._lastClickPosition.x+"px",this._domInputControl.style.top=this._lastClickPosition.y+"px"):this._domInputControl.translates(this._lastClickPosition.x,this._lastClickPosition.y)},detachDelegateWithIME:function(t){return!(!this.impl||!t)&&(this.impl._delegateWithIme===t&&(!!t.canDetachWithIME()&&(this.impl._delegateWithIme=null,t.didDetachWithIME(),cc._canvas.focus(),!0)))},removeDelegate:function(t){this.impl&&t&&this.impl._delegateList.indexOf(t)!==-1&&(this.impl._delegateWithIme&&t===this.impl._delegateWithIme&&(this.impl._delegateWithIme=null),cc.arrayRemoveObject(this.impl._delegateList,t))},processKeycode:function(t){t<32?t===cc.KEY.backspace?this.dispatchDeleteBackward():t===cc.KEY.enter?this.dispatchInsertText("\n",1):t===cc.KEY.tab||t===cc.KEY.escape:t<255&&this.dispatchInsertText(String.fromCharCode(t),1)}}),cc.IMEDispatcher.Impl=cc.Class.extend({_delegateWithIme:null,_delegateList:null,ctor:function(){this._delegateList=[]},findDelegate:function(t){for(var e=0;e<this._delegateList.length;e++)if(this._delegateList[e]===t)return e;return null}}),cc.imeDispatcher=new cc.IMEDispatcher,document.body?cc.imeDispatcher.init():window.addEventListener("load",function(){cc.imeDispatcher.init()},!1),cc.TextFieldDelegate=cc.Class.extend({onTextFieldAttachWithIME:function(t){return!1},onTextFieldDetachWithIME:function(t){return!1},onTextFieldInsertText:function(t,e,i){return!1},onTextFieldDeleteBackward:function(t,e,i){return!1},onDraw:function(t){return!1}}),cc.TextFieldTTF=cc.LabelTTF.extend({delegate:null,colorSpaceHolder:null,_colorText:null,_lens:null,_inputText:"",_placeHolder:"",_charCount:0,_className:"TextFieldTTF",ctor:function(t,e,i,n,r){this.colorSpaceHolder=cc.color(127,127,127),this._colorText=cc.color(255,255,255,255),cc.LabelTTF.prototype.ctor.call(this),void 0!==r?(this.initWithPlaceHolder("",e,i,n,r),t&&this.setPlaceHolder(t)):void 0===n&&void 0!==i&&(this.initWithString("",arguments[1],arguments[2]),t&&this.setPlaceHolder(t))},onEnter:function(){cc.LabelTTF.prototype.onEnter.call(this),cc.imeDispatcher.addDelegate(this)},onExit:function(){cc.LabelTTF.prototype.onExit.call(this),cc.imeDispatcher.removeDelegate(this)},getDelegate:function(){return this.delegate},setDelegate:function(t){this.delegate=t},getCharCount:function(){return this._charCount},getColorSpaceHolder:function(){return cc.color(this.colorSpaceHolder)},setColorSpaceHolder:function(t){this.colorSpaceHolder.r=t.r,this.colorSpaceHolder.g=t.g,this.colorSpaceHolder.b=t.b,this.colorSpaceHolder.a=cc.isUndefined(t.a)?255:t.a,this._inputText.length||this.setColor(this.colorSpaceHolder)},setTextColor:function(t){this._colorText.r=t.r,this._colorText.g=t.g,this._colorText.b=t.b,this._colorText.a=cc.isUndefined(t.a)?255:t.a,this._inputText.length&&this.setColor(this._colorText)},initWithPlaceHolder:function(t,e,i,n,r){switch(arguments.length){case 5:return t&&this.setPlaceHolder(t),this.initWithString(this._placeHolder,n,r,e,i);case 3:return t&&this.setPlaceHolder(t),this.initWithString(this._placeHolder,arguments[1],arguments[2]);default:throw new Error("Argument must be non-nil ")}},setString:function(t){t=String(t),this._inputText=t||"",this._inputText.length?(cc.LabelTTF.prototype.setString.call(this,this._inputText),this.setColor(this._colorText)):(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder)),cc._renderType===cc.game.RENDER_TYPE_CANVAS&&this._renderCmd._updateTexture(),this._charCount=this._inputText.length},getString:function(){return this._inputText},setPlaceHolder:function(t){this._placeHolder=t||"",this._inputText.length||(cc.LabelTTF.prototype.setString.call(this,this._placeHolder),this.setColor(this.colorSpaceHolder))},getPlaceHolder:function(){return this._placeHolder},draw:function(t){var e=t||cc._renderContext;this.delegate&&this.delegate.onDraw(this)||cc.LabelTTF.prototype.draw.call(this,e)},visit:function(t){this._super(t)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldAttachWithIME(this)},didAttachWithIME:function(){},canDetachWithIME:function(){return!this.delegate||!this.delegate.onTextFieldDetachWithIME(this)},didDetachWithIME:function(){},deleteBackward:function(){var t=this._inputText.length;if(0!==t){var e=1;if(!this.delegate||!this.delegate.onTextFieldDeleteBackward(this,this._inputText[t-e],e))return t<=e?(this._inputText="",this._charCount=0,cc.LabelTTF.prototype.setString.call(this,this._placeHolder),void this.setColor(this.colorSpaceHolder)):void(this.string=this._inputText.substring(0,t-e))}},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},_tipMessage:"please enter your word:",setTipMessage:function(t){null!=t&&(this._tipMessage=t)},getTipMessage:function(){return this._tipMessage},insertText:function(t,e){var i=t,n=i.indexOf("\n");if(n>-1&&(i=i.substring(0,n)),i.length>0){if(this.delegate&&this.delegate.onTextFieldInsertText(this,i,i.length))return;var r=this._inputText+i;this._charCount=r.length,this.string=r}n!==-1&&(this.delegate&&this.delegate.onTextFieldInsertText(this,"\n",1)||this.detachWithIME())},getContentText:function(){return this._inputText},keyboardWillShow:function(t){},keyboardDidShow:function(t){},keyboardWillHide:function(t){},keyboardDidHide:function(t){}});var _p=cc.TextFieldTTF.prototype;_p.charCount,cc.defineGetterSetter(_p,"charCount",_p.getCharCount),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),cc.TextFieldTTF.create=function(t,e,i,n,r){return new cc.TextFieldTTF(t,e,i,n,r)};cc.TGA_OK=0,cc.TGA_ERROR_FILE_OPEN=1,cc.TGA_ERROR_READING_FILE=2,cc.TGA_ERROR_INDEXED_COLOR=3,cc.TGA_ERROR_MEMORY=4,cc.TGA_ERROR_COMPRESSED_FILE=5,cc.ImageTGA=function(t,e,i,n,r,o,s){this.status=t||0,this.type=e||0,this.pixelDepth=i||0,this.width=n||0,this.height=r||0,this.imageData=o||[],this.flipped=s||0},cc.tgaLoadHeader=function(t,e,i){var n=2;if(n+1>e)return!1;var r=new cc.BinaryStreamReader(t);if(r.setOffset(n),i.type=r.readByte(),n+=10,n+4+1>e)return!1;if(r.setOffset(n),i.width=r.readUnsignedShort(),i.height=r.readUnsignedInteger(),i.pixelDepth=r.readByte(),n+=5,n+1>e)return!1;var o=r.readByte();return i.flipped=0,32&o&&(i.flipped=1),!0},cc.tgaLoadImageData=function(t,e,i){var n,r,o,s,c=18;if(n=0|i.pixelDepth/2,r=i.height*i.width*n,c+r>e)return!1;if(i.imageData=cc.__getSubArray(t,c,c+r),n>=3)for(o=0;o<r;o+=n)s=i.imageData[o],i.imageData[o]=i.imageData[o+2],i.imageData[o+2]=s;return!0},cc.tgaRGBtogreyscale=function(t){var e,i;if(8!==t.pixelDepth){var n=t.pixelDepth/8,r=new Uint8Array(t.height*t.width);if(null!==r){for(e=0,i=0;i<t.width*t.height;e+=n,i++)r[i]=.3*t.imageData[e]+.59*t.imageData[e+1]+.11*t.imageData[e+2];t.pixelDepth=8,t.type=3,t.imageData=r}}},cc.tgaDestroy=function(t){t&&(t.imageData=null,t=null)},cc.tgaLoadRLEImageData=function(t,e,i){var n,r,o,s=0,c=0,a=0,l=[],h=0,u=18;for(n=i.pixelDepth/8,r=i.height*i.width,o=0;o<r;o++){if(0!==h)h--,c=0!==a;else{if(u+1>e)break;h=t[u],u+=1,a=128&h,a&&(h-=128),c=0}if(!c){if(u+n>e)break;if(l=cc.__getSubArray(t,u,u+n),u+=n,n>=3){var d=l[0];l[0]=l[2],l[2]=d}}for(var _=0;_<n;_++)i.imageData[s+_]=l[_];s+=n}return!0},cc.tgaFlipImage=function(t){for(var e=t.pixelDepth/8,i=t.width*e,n=0;n<t.height/2;n++){var r=cc.__getSubArray(t.imageData,n*i,n*i+i);cc.__setDataToArray(cc.__getSubArray(t.imageData,(t.height-(n+1))*i,i),t.imageData,n*i),cc.__setDataToArray(r,t.imageData,(t.height-(n+1))*i)}t.flipped=0},cc.__getSubArray=function(t,e,i){return t instanceof Array?t.slice(e,i):t.subarray(e,i)},cc.__setDataToArray=function(t,e,i){for(var n=0;n<t.length;n++)e[i+n]=t[n]},cc.BinaryStreamReader=cc.Class.extend({_binaryData:null,_offset:0,ctor:function(t){this._binaryData=t},setBinaryData:function(t){this._binaryData=t,this._offset=0},getBinaryData:function(){return this._binaryData},_checkSize:function(t){if(!(this._offset+Math.ceil(t/8)<this._data.length))throw new Error("Index out of bound")},_decodeFloat:function(t,e){var i=t+e+1,n=i>>3;this._checkSize(i);var r=Math.pow(2,e-1)-1,o=this._readBits(t+e,1,n),s=this._readBits(t,e,n),c=0,a=2,l=0;do{for(var h=this._readByte(++l,n),u=t%8||8,d=1<<u;d>>=1;)h&d&&(c+=1/a),a*=2}while(t-=u);return this._offset+=n,s===(r<<1)+1?c?NaN:o?-(1/0):+(1/0):(1+o*-2)*(s||c?s?Math.pow(2,s-r)*(1+c):Math.pow(2,-r+1)*c:0)},_readByte:function(t,e){return this._data[this._offset+e-t-1]},_decodeInt:function(t,e){var i=this._readBits(0,t,t/8),n=Math.pow(2,t),r=e&&i>=n/2?i-n:i;return this._offset+=t/8,r},_shl:function(t,e){for(++e;--e;t=1073741824===(1073741824&(t%=2147483648))?2*t:2*(t-1073741824)+2147483647+1);return t},_readBits:function(t,e,i){var n=(t+e)%8,r=t%8,o=i-(t>>3)-1,s=i+(-(t+e)>>3),c=o-s,a=this._readByte(o,i)>>r&(1<<(c?8-r:e))-1;for(c&&n&&(a+=(this._readByte(s++,i)&(1<<n)-1)<<(c--<<3)-r);c;)a+=this._shl(this._readByte(s++,i),(c--<<3)-r);return a},readInteger:function(){return this._decodeInt(32,!0)},readUnsignedInteger:function(){return this._decodeInt(32,!1)},readSingle:function(){return this._decodeFloat(23,8)},readShort:function(){return this._decodeInt(16,!0)},readUnsignedShort:function(){return this._decodeInt(16,!1)},readByte:function(){var t=this._data[this._offset];return this._offset+=1,t},readData:function(t,e){return this._binaryData instanceof Array?this._binaryData.slice(t,e):this._binaryData.subarray(t,e)},setOffset:function(t){this._offset=t},getOffset:function(){return this._offset}}),cc.TMX_ORIENTATION_ORTHO=0,cc.TMX_ORIENTATION_HEX=1,cc.TMX_ORIENTATION_ISO=2,cc.TMXTiledMap=cc.Node.extend({properties:null,mapOrientation:null,objectGroups:null,_mapSize:null,_tileSize:null,_tileProperties:null,_className:"TMXTiledMap",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),void 0!==e?this.initWithXML(t,e):void 0!==t&&this.initWithTMXFile(t)},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(t){this._mapSize.width=t.width,this._mapSize.height=t.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(t){this._mapSize.width=t},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(t){this._mapSize.height=t},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(t){this._tileSize.width=t.width,this._tileSize.height=t.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(t){this._tileSize.width=t},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(t){this._tileSize.height=t},getMapOrientation:function(){return this.mapOrientation},setMapOrientation:function(t){this.mapOrientation=t},getObjectGroups:function(){return this.objectGroups},setObjectGroups:function(t){this.objectGroups=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},initWithTMXFile:function(t){if(!t||0===t.length)throw new Error("cc.TMXTiledMap.initWithTMXFile(): tmxFile should be non-null or non-empty string.");this.width=0,this.height=0;var e=new cc.TMXMapInfo(t);if(!e)return!1;var i=e.getTilesets();return i&&0!==i.length||cc.log("cc.TMXTiledMap.initWithTMXFile(): Map not found. Please check the filename."),this._buildWithMapInfo(e),!0},initWithXML:function(t,e){this.width=0,this.height=0;var i=new cc.TMXMapInfo(t,e),n=i.getTilesets();return n&&0!==n.length||cc.log("cc.TMXTiledMap.initWithXML(): Map not found. Please check the filename."),this._buildWithMapInfo(i),!0},_buildWithMapInfo:function(t){this._mapSize=t.getMapSize(),this._tileSize=t.getTileSize(),this.mapOrientation=t.orientation,this.objectGroups=t.getObjectGroups(),this.properties=t.properties,this._tileProperties=t.getTileProperties();var e=0,i=t.getLayers();if(i)for(var n=null,r=0,o=i.length;r<o;r++)if(n=i[r],n&&n.visible){var s=this._parseLayer(n,t);this.addChild(s,e,e),this.width=Math.max(this.width,s.width),this.height=Math.max(this.height,s.height),e++}},allLayers:function(){for(var t=[],e=this._children,i=0,n=e.length;i<n;i++){var r=e[i];r&&r instanceof cc.TMXLayer&&t.push(r)}return t},getLayer:function(t){if(!t||0===t.length)throw new Error("cc.TMXTiledMap.getLayer(): layerName should be non-null or non-empty string.");for(var e=this._children,i=0;i<e.length;i++){var n=e[i];if(n&&n.layerName===t)return n}return null},getObjectGroup:function(t){if(!t||0===t.length)throw new Error("cc.TMXTiledMap.getObjectGroup(): groupName should be non-null or non-empty string.");if(this.objectGroups)for(var e=0;e<this.objectGroups.length;e++){var i=this.objectGroups[e];if(i&&i.groupName===t)return i}return null},getProperty:function(t){return this.properties[t.toString()]},propertiesForGID:function(t){return cc.log("propertiesForGID is deprecated. Please use getPropertiesForGID instead."),this.getPropertiesForGID[t]},getPropertiesForGID:function(t){return this._tileProperties[t]},_parseLayer:function(t,e){var i=this._tilesetForLayer(t,e),n=new cc.TMXLayer(i,t,e);return t.ownTiles=!1,n},_tilesetForLayer:function(t,e){var i=t._layerSize,n=e.getTilesets();if(n)for(var r=n.length-1;r>=0;r--){var o=n[r];if(o)for(var s=0;s<i.height;s++)for(var c=0;c<i.width;c++){var a=c+i.width*s,l=t._tiles[a];if(0!==l&&(l&cc.TMX_TILE_FLIPPED_MASK)>>>0>=o.firstGid)return o}}return cc.log("cocos2d: Warning: TMX Layer "+t.name+" has no tiles"),null}});var _p=cc.TMXTiledMap.prototype;_p.mapWidth,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),_p.mapHeight,cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXTiledMap.create=function(t,e){return new cc.TMXTiledMap(t,e)},cc.TMX_PROPERTY_NONE=0,cc.TMX_PROPERTY_MAP=1,cc.TMX_PROPERTY_LAYER=2,cc.TMX_PROPERTY_OBJECTGROUP=3,cc.TMX_PROPERTY_OBJECT=4,cc.TMX_PROPERTY_TILE=5,cc.TMX_TILE_HORIZONTAL_FLAG=2147483648,cc.TMX_TILE_VERTICAL_FLAG=1073741824,cc.TMX_TILE_DIAGONAL_FLAG=536870912,cc.TMX_TILE_FLIPPED_ALL=(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_DIAGONAL_FLAG)>>>0,cc.TMX_TILE_FLIPPED_MASK=~cc.TMX_TILE_FLIPPED_ALL>>>0,cc.TMXLayerInfo=cc.Class.extend({properties:null,name:"",_layerSize:null,_tiles:null,visible:null,_opacity:null,ownTiles:!0,_minGID:1e5,_maxGID:0,offset:null,ctor:function(){this.properties=[],this.name="",this._layerSize=null,this._tiles=null,this.visible=!0,this._opacity=0,this.ownTiles=!0,this._minGID=1e5,this._maxGID=0,this.offset=cc.p(0,0)},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t}}),cc.TMXTilesetInfo=cc.Class.extend({name:"",firstGid:0,_tileSize:null,spacing:0,margin:0,sourceImage:"",imageSize:null,ctor:function(){this._tileSize=cc.size(0,0),this.imageSize=cc.size(0,0)},rectForGID:function(t,e){var i=e||cc.rect(0,0,0,0);i.width=this._tileSize.width,i.height=this._tileSize.height,t&=cc.TMX_TILE_FLIPPED_MASK,t-=parseInt(this.firstGid,10);var n=parseInt((this.imageSize.width-2*this.margin+this.spacing)/(this._tileSize.width+this.spacing),10);return i.x=parseInt(t%n*(this._tileSize.width+this.spacing)+this.margin,10),i.y=parseInt(parseInt(t/n,10)*(this._tileSize.height+this.spacing)+this.margin,10),i}}),cc.TMXMapInfo=cc.SAXParser.extend({properties:null,orientation:null,parentElement:null,parentGID:null,layerAttrs:0,storingCharacters:!1,tmxFileName:null,currentString:null,_objectGroups:null,_mapSize:null,_tileSize:null,_layers:null,_tilesets:null,_tileProperties:null,_resources:"",_currentFirstGID:0,ctor:function(t,e){cc.SAXParser.prototype.ctor.apply(this),this._mapSize=cc.size(0,0),this._tileSize=cc.size(0,0),this._layers=[],this._tilesets=[],this._objectGroups=[],this.properties=[],this._tileProperties={},this._currentFirstGID=0,void 0!==e?this.initWithXML(t,e):void 0!==t&&this.initWithTMXFile(t)},getOrientation:function(){return this.orientation},setOrientation:function(t){this.orientation=t},getMapSize:function(){return cc.size(this._mapSize.width,this._mapSize.height)},setMapSize:function(t){this._mapSize.width=t.width,this._mapSize.height=t.height},_getMapWidth:function(){return this._mapSize.width},_setMapWidth:function(t){this._mapSize.width=t},_getMapHeight:function(){return this._mapSize.height},_setMapHeight:function(t){this._mapSize.height=t},getTileSize:function(){return cc.size(this._tileSize.width,this._tileSize.height)},setTileSize:function(t){this._tileSize.width=t.width,this._tileSize.height=t.height},_getTileWidth:function(){return this._tileSize.width},_setTileWidth:function(t){this._tileSize.width=t},_getTileHeight:function(){return this._tileSize.height},_setTileHeight:function(t){this._tileSize.height=t},getLayers:function(){return this._layers},setLayers:function(t){this._layers.push(t)},getTilesets:function(){return this._tilesets},setTilesets:function(t){this._tilesets.push(t)},getObjectGroups:function(){return this._objectGroups},setObjectGroups:function(t){this._objectGroups.push(t)},getParentElement:function(){return this.parentElement},setParentElement:function(t){this.parentElement=t},getParentGID:function(){return this.parentGID},setParentGID:function(t){this.parentGID=t},getLayerAttribs:function(){return this.layerAttrs},setLayerAttribs:function(t){this.layerAttrs=t},getStoringCharacters:function(){return this.storingCharacters},setStoringCharacters:function(t){this.storingCharacters=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},initWithTMXFile:function(t){return this._internalInit(t,null),this.parseXMLFile(t)},initWithXML:function(t,e){return this._internalInit(null,e),this.parseXMLString(t)},parseXMLFile:function(t,e){e=e||!1;var i=e?t:cc.loader.getRes(t);if(!i)throw new Error("Please load the resource first : "+t);var n,r,o=this._parseXML(i),s=o.documentElement,c=s.getAttribute("version"),a=s.getAttribute("orientation");if("map"===s.nodeName){"1.0"!==c&&null!==c&&cc.log("cocos2d: TMXFormat: Unsupported TMX version:"+c),"orthogonal"===a?this.orientation=cc.TMX_ORIENTATION_ORTHO:"isometric"===a?this.orientation=cc.TMX_ORIENTATION_ISO:"hexagonal"===a?this.orientation=cc.TMX_ORIENTATION_HEX:null!==a&&cc.log("cocos2d: TMXFomat: Unsupported orientation:"+a);var l=cc.size(0,0);l.width=parseFloat(s.getAttribute("width")),l.height=parseFloat(s.getAttribute("height")),this.setMapSize(l),l=cc.size(0,0),l.width=parseFloat(s.getAttribute("tilewidth")),l.height=parseFloat(s.getAttribute("tileheight")),this.setTileSize(l);var h=s.querySelectorAll("map > properties >  property");if(h){var u={};for(n=0;n<h.length;n++)u[h[n].getAttribute("name")]=h[n].getAttribute("value");this.properties=u}}var d=s.getElementsByTagName("tileset");for("map"!==s.nodeName&&(d=[],d.push(s)),n=0;n<d.length;n++){var _=d[n],p=_.getAttribute("source");if(p){var f=e?cc.path.join(this._resources,p):cc.path.changeBasename(t,p);this.parseXMLFile(f)}else{var m=new cc.TMXTilesetInfo;m.name=_.getAttribute("name")||"",m.firstGid=parseInt(_.getAttribute("firstgid"))||0,m.spacing=parseInt(_.getAttribute("spacing"))||0,m.margin=parseInt(_.getAttribute("margin"))||0;var g=cc.size(0,0);g.width=parseFloat(_.getAttribute("tilewidth")),g.height=parseFloat(_.getAttribute("tileheight")),m._tileSize=g;var y=_.getElementsByTagName("image")[0],v=y.getAttribute("source"),T=-1;if(this.tmxFileName&&(T=this.tmxFileName.lastIndexOf("/")),T!==-1){var C=this.tmxFileName.substr(0,T+1);m.sourceImage=C+v}else m.sourceImage=this._resources+(this._resources?"/":"")+v;this.setTilesets(m);var S=_.getElementsByTagName("tile");if(S)for(var x=0;x<S.length;x++){var A=S[x];this.parentGID=parseInt(m.firstGid)+parseInt(A.getAttribute("id")||0);var E=A.querySelectorAll("properties > property");if(E){var b={};for(r=0;r<E.length;r++){var R=E[r].getAttribute("name");b[R]=E[r].getAttribute("value")}this._tileProperties[this.parentGID]=b}}}}var P=s.getElementsByTagName("layer");if(P)for(n=0;n<P.length;n++){var w=P[n],I=w.getElementsByTagName("data")[0],D=new cc.TMXLayerInfo;D.name=w.getAttribute("name");var L=cc.size(0,0);L.width=parseFloat(w.getAttribute("width")),L.height=parseFloat(w.getAttribute("height")),D._layerSize=L;var O=w.getAttribute("visible");D.visible=!("0"==O);var B=w.getAttribute("opacity")||1;B?D._opacity=parseInt(255*parseFloat(B)):D._opacity=255,D.offset=cc.p(parseFloat(w.getAttribute("x"))||0,parseFloat(w.getAttribute("y"))||0);var N="";for(r=0;r<I.childNodes.length;r++)N+=I.childNodes[r].nodeValue;N=N.trim();var F=I.getAttribute("compression"),M=I.getAttribute("encoding");if(F&&"gzip"!==F&&"zlib"!==F)return cc.log("cc.TMXMapInfo.parseXMLFile(): unsupported compression method"),null;var S;switch(F){case"gzip":S=cc.unzipBase64AsArray(N,4);break;case"zlib":var V=new Zlib.Inflate(cc.Codec.Base64.decodeAsArray(N,1));S=cc.uint8ArrayToUint32Array(V.decompress());break;case null:case"":if("base64"===M)S=cc.Codec.Base64.decodeAsArray(N,4);else if("csv"===M){S=[];for(var k=N.split(","),G=0;G<k.length;G++)S.push(parseInt(k[G]))}else{var W=I.getElementsByTagName("tile");S=[];for(var z=0;z<W.length;z++)S.push(parseInt(W[z].getAttribute("gid")))}break;default:this.layerAttrs===cc.TMXLayerInfo.ATTRIB_NONE&&cc.log("cc.TMXMapInfo.parseXMLFile(): Only base64 and/or gzip/zlib maps are supported")}S&&(D._tiles=new Uint32Array(S));var U=w.querySelectorAll("properties > property");if(U){var Y={};for(r=0;r<U.length;r++)Y[U[r].getAttribute("name")]=U[r].getAttribute("value");D.properties=Y}this.setLayers(D)}var X=s.getElementsByTagName("objectgroup");if(X)for(n=0;n<X.length;n++){var H=X[n],j=new cc.TMXObjectGroup;j.groupName=H.getAttribute("name"),j.setPositionOffset(cc.p(parseFloat(H.getAttribute("x"))*this.getTileSize().width||0,parseFloat(H.getAttribute("y"))*this.getTileSize().height||0));var q=H.querySelectorAll("objectgroup > properties > property");if(q)for(r=0;r<q.length;r++){var Z={};Z[q[r].getAttribute("name")]=q[r].getAttribute("value"),j.properties=Z}var J=H.querySelectorAll("object"),K=cc.director.getContentScaleFactor();if(J)for(r=0;r<J.length;r++){var Q=J[r],$={};$.name=Q.getAttribute("name")||"",$.type=Q.getAttribute("type")||"",$.width=parseInt(Q.getAttribute("width"))||0,$.height=parseInt(Q.getAttribute("height"))||0,$.x=((0|(Q.getAttribute("x")||0))+j.getPositionOffset().x)/K;var tt=(0|(Q.getAttribute("y")||0))+j.getPositionOffset().y/K;$.y=(parseInt(this.getMapSize().height*this.getTileSize().height)-tt-$.height)/cc.director.getContentScaleFactor(),$.rotation=parseInt(Q.getAttribute("rotation"))||0;var et=Q.querySelectorAll("properties > property");if(et)for(var it=0;it<et.length;it++)$[et[it].getAttribute("name")]=et[it].getAttribute("value");var nt=Q.querySelectorAll("polygon");if(nt&&nt.length>0){var rt=nt[0].getAttribute("points");rt&&($.points=this._parsePointsString(rt))}var ot=Q.querySelectorAll("polyline");if(ot&&ot.length>0){var st=ot[0].getAttribute("points");st&&($.polylinePoints=this._parsePointsString(st))}j.setObjects($)}this.setObjectGroups(j)}return s},_parsePointsString:function(t){if(!t)return null;for(var e=[],i=t.split(" "),n=0;n<i.length;n++){var r=i[n].split(",");e.push({x:r[0],y:r[1]})}return e},parseXMLString:function(t){return this.parseXMLFile(t,!0)},getTileProperties:function(){return this._tileProperties},setTileProperties:function(t){this._tileProperties.push(t)},getCurrentString:function(){return this.currentString},setCurrentString:function(t){this.currentString=t},getTMXFileName:function(){return this.tmxFileName},setTMXFileName:function(t){this.tmxFileName=t},_internalInit:function(t,e){this._tilesets.length=0,this._layers.length=0,this.tmxFileName=t,e&&(this._resources=e),this._objectGroups.length=0,this.properties.length=0,this._tileProperties.length=0,this.currentString="",this.storingCharacters=!1,this.layerAttrs=cc.TMXLayerInfo.ATTRIB_NONE,this.parentElement=cc.TMX_PROPERTY_NONE,this._currentFirstGID=0}});var _p=cc.TMXMapInfo.prototype;_p.mapWidth,cc.defineGetterSetter(_p,"mapWidth",_p._getMapWidth,_p._setMapWidth),_p.mapHeight,cc.defineGetterSetter(_p,"mapHeight",_p._getMapHeight,_p._setMapHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXMapInfo.create=function(t,e){return new cc.TMXMapInfo(t,e)},cc.loader.register(["tmx","tsx"],cc._txtLoader),cc.TMXLayerInfo.ATTRIB_NONE=1,cc.TMXLayerInfo.ATTRIB_BASE64=2,cc.TMXLayerInfo.ATTRIB_GZIP=4,cc.TMXLayerInfo.ATTRIB_ZLIB=8,cc.TMXObjectGroup=cc.Class.extend({properties:null,groupName:"",_positionOffset:null,_objects:null,ctor:function(){this.groupName="",this._positionOffset=cc.p(0,0),this.properties=[],this._objects=[]},getPositionOffset:function(){return cc.p(this._positionOffset)},setPositionOffset:function(t){this._positionOffset.x=t.x,this._positionOffset.y=t.y},getProperties:function(){return this.properties},setProperties:function(t){this.properties.push(t)},getGroupName:function(){return this.groupName.toString()},setGroupName:function(t){this.groupName=t},propertyNamed:function(t){return this.properties[t]},objectNamed:function(t){return this.getObject(t)},getObject:function(t){if(this._objects&&this._objects.length>0)for(var e=this._objects,i=0,n=e.length;i<n;i++){var r=e[i].name;if(r&&r===t)return e[i]}return null},getObjects:function(){return this._objects},setObjects:function(t){this._objects.push(t)}}),cc.TMXLayer=cc.SpriteBatchNode.extend({tiles:null,tileset:null,layerOrientation:null,properties:null,layerName:"",_textures:null,_texGrids:null,_spriteTiles:null,_layerSize:null,_mapTileSize:null,_opacity:255,_minGID:null,_maxGID:null,_vertexZvalue:null,_useAutomaticVertexZ:null,_reusedTile:null,_atlasIndexArray:null,_contentScaleFactor:null,_className:"TMXLayer",ctor:function(t,e,i){cc.SpriteBatchNode.prototype.ctor.call(this),this._descendants=[],this._layerSize=cc.size(0,0),this._mapTileSize=cc.size(0,0),this._spriteTiles={},void 0!==i&&this.initWithTilesetInfo(t,e,i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.TMXLayer.CanvasRenderCmd(this):new cc.TMXLayer.WebGLRenderCmd(this)},_fillTextureGrids:function(t,e){var i=this._textures[e];if(!i.isLoaded())return void i.addEventListener("load",function(){this._fillTextureGrids(t,e)},this);t.imageSize.width&&t.imageSize.height||(t.imageSize.width=i.width,t.imageSize.height=i.height);for(var n=t._tileSize.width,r=t._tileSize.height,o=i._contentSize.width,s=i._contentSize.height,c=t.spacing,a=t.margin,l=Math.floor((o-2*a+c)/(n+c)),h=Math.floor((s-2*a+c)/(r+c)),u=h*l,d=t.firstGid,_=t.firstGid+u,p=this._texGrids,f=null,m=!!p[d];d<_&&(m&&!p[d]&&(m=!1),m||!p[d]);++d)f={texId:e,x:0,y:0,width:n,height:r,t:0,l:0,r:0,b:0},t.rectForGID(d,f),f.t=f.y/s,f.l=f.x/o,f.r=(f.x+f.width)/o,f.b=(f.y+f.height)/s,p[d]=f},initWithTilesetInfo:function(t,e,i){var n=e._layerSize;parseInt(n.width*n.height);this.layerName=e.name,this.tiles=e._tiles,this.properties=e.properties,this._layerSize=n,this._minGID=e._minGID,this._maxGID=e._maxGID,this._opacity=e._opacity,this.tileset=t,this.layerOrientation=i.orientation,this._mapTileSize=i.getTileSize();var r=i._tilesets;if(r){this._textures=[],this._texGrids=[];var o,s,c,a=r.length;for(o=0;o<a;++o)s=r[o],c=cc.textureCache.addImage(s.sourceImage),this._textures.push(c),this._fillTextureGrids(s,o),s===t&&(this._texture=c)}var l=this._calculateLayerOffset(e.offset);return this.setPosition(cc.pointPixelsToPoints(l)),this._parseInternalProperties(),this.setContentSize(cc.sizePixelsToPoints(cc.size(this._layerSize.width*this._mapTileSize.width,this._layerSize.height*this._mapTileSize.height))),this._useAutomaticVertexZ=!1,this._vertexZvalue=0,!0},getLayerSize:function(){return cc.size(this._layerSize.width,this._layerSize.height)},setLayerSize:function(t){this._layerSize.width=t.width,this._layerSize.height=t.height},_getLayerWidth:function(){return this._layerSize.width},_setLayerWidth:function(t){this._layerSize.width=t},_getLayerHeight:function(){return this._layerSize.height},_setLayerHeight:function(t){this._layerSize.height=t},getMapTileSize:function(){return cc.size(this._mapTileSize.width,this._mapTileSize.height)},setMapTileSize:function(t){this._mapTileSize.width=t.width,this._mapTileSize.height=t.height},_getTileWidth:function(){return this._mapTileSize.width},_setTileWidth:function(t){this._mapTileSize.width=t},_getTileHeight:function(){return this._mapTileSize.height},_setTileHeight:function(t){this._mapTileSize.height=t},getTiles:function(){return this.tiles},setTiles:function(t){this.tiles=t},getTileset:function(){return this.tileset},setTileset:function(t){this.tileset=t},getLayerOrientation:function(){return this.layerOrientation},setLayerOrientation:function(t){this.layerOrientation=t},getProperties:function(){return this.properties},setProperties:function(t){this.properties=t},getProperty:function(t){return this.properties[t]},getLayerName:function(){return this.layerName},setLayerName:function(t){this.layerName=t},releaseMap:function(){this._spriteTiles={}},getTileAt:function(t,e){if(void 0===t)throw new Error("cc.TMXLayer.getTileAt(): pos should be non-null");var i=t;if(void 0===e&&(i=t.x,e=t.y),i>=this._layerSize.width||e>=this._layerSize.height||i<0||e<0)throw new Error("cc.TMXLayer.getTileAt(): invalid position");if(!this.tiles)return cc.log("cc.TMXLayer.getTileAt(): TMXLayer: the tiles map has been released"),null;var n=null,r=this.getTileGIDAt(i,e);if(0===r)return n;var o=0|i+e*this._layerSize.width;if(n=this._spriteTiles[o],!n){var s=this._texGrids[r],c=this._textures[s.texId];s=cc.rectPixelsToPoints(s),n=new cc.Sprite(c,s),n.setPosition(this.getPositionAt(i,e));var a=this._vertexZForPos(i,e);n.setVertexZ(a),n.setAnchorPoint(0,0),n.setOpacity(this._opacity),this.addChild(n,a,o)}return n},getTileGIDAt:function(t,e){if(void 0===t)throw new Error("cc.TMXLayer.getTileGIDAt(): pos should be non-null");var i=t;if(void 0===e&&(i=t.x,e=t.y),i>=this._layerSize.width||e>=this._layerSize.height||i<0||e<0)throw new Error("cc.TMXLayer.getTileGIDAt(): invalid position");if(!this.tiles)return cc.log("cc.TMXLayer.getTileGIDAt(): TMXLayer: the tiles map has been released"),null;var n=0|i+e*this._layerSize.width,r=this.tiles[n];return(r&cc.TMX_TILE_FLIPPED_MASK)>>>0},setTileGID:function(t,e,i,n){if(void 0===e)throw new Error("cc.TMXLayer.setTileGID(): pos should be non-null");var r;if(void 0!==n?r=cc.p(e,i):(r=e,n=i),r.x>=this._layerSize.width||r.y>=this._layerSize.height||r.x<0||r.y<0)throw new Error("cc.TMXLayer.setTileGID(): invalid position");if(!this.tiles)return void cc.log("cc.TMXLayer.setTileGID(): TMXLayer: the tiles map has been released");if(0!==t&&t<this.tileset.firstGid)return void cc.log("cc.TMXLayer.setTileGID(): invalid gid:"+t);n=n||0;var o=this.getTileFlagsAt(r),s=this.getTileGIDAt(r);if(s!==t||o!==n){var c=(t|n)>>>0;if(0===t)this.removeTileAt(r);else if(0===s)this._updateTileForGID(c,r);else{var a=r.x+r.y*this._layerSize.width,l=this.getChildByTag(a);if(l){var h=this._texGrids[t],u=this._textures[h.texId];h=cc.rectPixelsToPoints(h),l.setTexture(u),l.setTextureRect(h,!1),null!=n&&this._setupTileSprite(l,r,c),this.tiles[a]=c}else this._updateTileForGID(c,r)}}},addChild:function(t,e,i){cc.Node.prototype.addChild.call(this,t,e,i),void 0!==i&&(this._spriteTiles[i]=t,t._vertexZ=this._vertexZ+cc.renderer.assignedZStep*i/this.tiles.length)},removeChild:function(t,e){this._spriteTiles[t.tag]&&(this._spriteTiles[t.tag]=null),cc.Node.prototype.removeChild.call(this,t,e)},getTileFlagsAt:function(t,e){if(!t)throw new Error("cc.TMXLayer.getTileFlagsAt(): pos should be non-null");if(void 0!==e&&(t=cc.p(t,e)),t.x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw new Error("cc.TMXLayer.getTileFlagsAt(): invalid position");if(!this.tiles)return cc.log("cc.TMXLayer.getTileFlagsAt(): TMXLayer: the tiles map has been released"),null;var i=0|t.x+t.y*this._layerSize.width,n=this.tiles[i];return(n&cc.TMX_TILE_FLIPPED_ALL)>>>0},removeTileAt:function(t,e){if(!t)throw new Error("cc.TMXLayer.removeTileAt(): pos should be non-null");if(void 0!==e&&(t=cc.p(t,e)),t.x>=this._layerSize.width||t.y>=this._layerSize.height||t.x<0||t.y<0)throw new Error("cc.TMXLayer.removeTileAt(): invalid position");if(!this.tiles)return void cc.log("cc.TMXLayer.removeTileAt(): TMXLayer: the tiles map has been released");var i=this.getTileGIDAt(t);if(0!==i){var n=0|t.x+t.y*this._layerSize.width;this.tiles[n]=0;var r=this._spriteTiles[n];r&&this.removeChild(r,!0)}},getPositionAt:function(t,e){void 0!==e&&(t=cc.p(t,e));var i=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:i=this._positionForOrthoAt(t);break;case cc.TMX_ORIENTATION_ISO:i=this._positionForIsoAt(t);break;case cc.TMX_ORIENTATION_HEX:i=this._positionForHexAt(t)}return cc.pointPixelsToPoints(i)},_positionForIsoAt:function(t){return cc.p(this._mapTileSize.width/2*(this._layerSize.width+t.x-t.y-1),this._mapTileSize.height/2*(2*this._layerSize.height-t.x-t.y-2))},_positionForOrthoAt:function(t){return cc.p(t.x*this._mapTileSize.width,(this._layerSize.height-t.y-1)*this._mapTileSize.height)},_positionForHexAt:function(t){var e=t.x%2===1?-this._mapTileSize.height/2:0;return cc.p(t.x*this._mapTileSize.width*3/4,(this._layerSize.height-t.y-1)*this._mapTileSize.height+e)},_calculateLayerOffset:function(t){var e=cc.p(0,0);switch(this.layerOrientation){case cc.TMX_ORIENTATION_ORTHO:e=cc.p(t.x*this._mapTileSize.width,-t.y*this._mapTileSize.height);break;case cc.TMX_ORIENTATION_ISO:e=cc.p(this._mapTileSize.width/2*(t.x-t.y),this._mapTileSize.height/2*(-t.x-t.y));break;case cc.TMX_ORIENTATION_HEX:0===t.x&&0===t.y||cc.log("offset for hexagonal map not implemented yet")}return e},_updateTileForGID:function(t,e){if(this._texGrids[t]){var i=0|e.x+e.y*this._layerSize.width;i<this.tiles.length&&(this.tiles[i]=t)}},_parseInternalProperties:function(){var t=this.getProperty("cc_vertexz");if(t)if("automatic"===t){this._useAutomaticVertexZ=!0;var e=this.getProperty("cc_alpha_func"),i=0;e&&(i=parseFloat(e)),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST),this.shaderProgram.use(),this.shaderProgram.setUniformLocationWith1f(cc.UNIFORM_ALPHA_TEST_VALUE_S,i))}else this._vertexZvalue=parseInt(t,10)},_setupTileSprite:function(t,e,i){var n=(e.x+e.y*this._layerSize.width,this.getPositionAt(e));if(t.setPosition(n),t.setVertexZ(this._vertexZForPos(e)),t.setAnchorPoint(0,0),t.setOpacity(this._opacity),t.setFlippedX(!1),t.setFlippedY(!1),t.setRotation(0),(i&cc.TMX_TILE_DIAGONAL_FLAG)>>>0){t.setAnchorPoint(.5,.5),t.setPosition(n.x+t.width/2,n.y+t.height/2);var r=(i&(cc.TMX_TILE_HORIZONTAL_FLAG|cc.TMX_TILE_VERTICAL_FLAG)>>>0)>>>0;r===cc.TMX_TILE_HORIZONTAL_FLAG?t.setRotation(90):r===cc.TMX_TILE_VERTICAL_FLAG?t.setRotation(270):r===(cc.TMX_TILE_VERTICAL_FLAG|cc.TMX_TILE_HORIZONTAL_FLAG)>>>0?(t.setRotation(90),t.setFlippedX(!0)):(t.setRotation(270),t.setFlippedX(!0))}else(i&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0&&t.setFlippedX(!0),(i&cc.TMX_TILE_VERTICAL_FLAG)>>>0&&t.setFlippedY(!0)},_vertexZForPos:function(t,e){void 0===e&&(e=t.y,t=t.x);var i=0,n=0;if(this._useAutomaticVertexZ)switch(this.layerOrientation){case cc.TMX_ORIENTATION_ISO:n=this._layerSize.width+this._layerSize.height,i=-(n-(t+e));break;case cc.TMX_ORIENTATION_ORTHO:i=-(this._layerSize.height-e);break;case cc.TMX_ORIENTATION_HEX:cc.log("TMX Hexa zOrder not supported");break;default:cc.log("TMX invalid value")}else i=this._vertexZvalue;return i}});var _p=cc.TMXLayer.prototype;_p.layerWidth,cc.defineGetterSetter(_p,"layerWidth",_p._getLayerWidth,_p._setLayerWidth),_p.layerHeight,cc.defineGetterSetter(_p,"layerHeight",_p._getLayerHeight,_p._setLayerHeight),_p.tileWidth,cc.defineGetterSetter(_p,"tileWidth",_p._getTileWidth,_p._setTileWidth),_p.tileHeight,cc.defineGetterSetter(_p,"tileHeight",_p._getTileHeight,_p._setTileHeight),cc.TMXLayer.create=function(t,e,i){return new cc.TMXLayer(t,e,i)},function(){cc.TMXLayer.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0};var t=cc.TMXLayer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.TMXLayer.CanvasRenderCmd,t.visit=function(t){var e=this._node,i=cc.renderer;if(t=t||this.getParentRenderCmd(),t&&(this._curLevel=t._curLevel+1),e._visible){isNaN(e._customZ)&&(e._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),this._syncStatus(t);var n,r,o=e._children,s=e._spriteTiles,c=o.length;if(c>0){for(e.sortAllChildren(),r=0;r<c&&(n=o[r],n._localZOrder<0);r++)n._renderCmd.visit(this);for(i.pushRenderCommand(this);r<c;r++)n=o[r],0===n._localZOrder&&s[n.tag]?(isNaN(n._customZ)&&(n._vertexZ=i.assignedZ,i.assignedZ+=i.assignedZStep),n._renderCmd.updateStatus()):n._renderCmd.visit(this)}else i.pushRenderCommand(this);this._dirtyFlag=0}},t.rendering=function(t,e,i){var n=this._node,r=n._rotationX||n._rotationY,o=n.layerOrientation,s=n.tiles,c=n._opacity/255;if(s&&!(c<=0)){var a=n._mapTileSize.width,l=n._mapTileSize.height,h=n.tileset._tileSize.width/cc.director._contentScaleFactor,u=n.tileset._tileSize.height/cc.director._contentScaleFactor,d=h-a,_=u-l,p=cc.winSize.width,f=cc.winSize.height,m=n._layerSize.height,g=n._layerSize.width,y=n._texGrids,v=n._spriteTiles,T=this._worldTransform,C=-n._contentSize.width*n._anchorPoint.x,S=-n._contentSize.height*n._anchorPoint.y,x=T.a,A=T.b,E=T.c,b=T.d,R=C*x+S*E+T.tx,P=C*A+S*b+T.ty,w=t||cc._renderContext,I=w.getContext(),D=0,L=0,O=g,B=m;r||o!==cc.TMX_ORIENTATION_ORTHO||(D=Math.floor(-(R-d*x)/(a*x)),L=Math.floor((P-_*b+l*m*b-f)/(l*b)),O=Math.ceil((p-R+d*x)/(a*x)),B=m-Math.floor(-(P+_*b)/(l*b)),D<0&&(D=0),L<0&&(L=0),O>g&&(O=g),B>m&&(B=m));var N,F,M,V,k,G,W,z,U,Y,X,H,j,q,Z,J,K=L*g,Q=cc.TMX_TILE_FLIPPED_MASK,$=h,tt=u,et=h*x,it=u*b,nt=!1,rt=!1;V=K+D;for(N in v)if(N<V&&v[N])z=v[N]._renderCmd,0===v[N]._localZOrder&&z.rendering&&z.rendering(t,e,i);else if(N>=V)break;for(w.setTransform(T,e,i),w.setGlobalAlpha(c),F=L;F<B;++F){for(M=D;M<O;++M)if(V=K+M,v[V])z=v[V]._renderCmd,0===v[V]._localZOrder&&z.rendering&&(z.rendering(t,e,i),w.setTransform(T,e,i),w.setGlobalAlpha(c));else if(k=n.tiles[V],G=y[(k&Q)>>>0],G&&(W=n._textures[G.texId],W&&W._htmlElementObj)){switch(o){case cc.TMX_ORIENTATION_ORTHO:Y=M*a,X=-(m-F-1)*l;break;case cc.TMX_ORIENTATION_ISO:Y=a/2*(g+M-F-1),X=-l/2*(2*m-M-F-2);break;case cc.TMX_ORIENTATION_HEX:Y=M*a*3/4,X=-(m-F-1)*l+(M%2===1?-l/2:0)}if(H=Y+h,U=X-u,!r&&o===cc.TMX_ORIENTATION_ISO){if(Z=-P+X*b,Z<-f-it){M+=Math.floor(2*(-f-Z)/it)-1;continue}if(J=R+H*x,J<-et){M+=Math.floor(2*-J/et)-1;continue}if(q=R+Y*x,j=-P+U*b,q>p||j>0){M=O;continue}}k>cc.TMX_TILE_DIAGONAL_FLAG&&(nt=(k&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0,rt=(k&cc.TMX_TILE_VERTICAL_FLAG)>>>0),nt&&(Y=-H,I.scale(-1,1)),rt&&(U=-X,I.scale(1,-1)),I.drawImage(W._htmlElementObj,G.x,G.y,G.width,G.height,Y,U,$,tt),nt&&I.scale(-1,1),rt&&I.scale(1,-1),cc.g_NumberOfDraws++}K+=g}for(N in v)N>V&&v[N]&&(z=v[N]._renderCmd,0===v[N]._localZOrder&&z.rendering&&z.rendering(t,e,i))}}}();!function(){cc.TMXLayer.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._vertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._color=new Uint32Array(1),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLORALPHATEST);var e=90*Math.PI/180;this._sin90=Math.sin(e),this._cos90=Math.cos(e),e*=3,this._sin270=Math.sin(e),this._cos270=Math.cos(e)};var t=cc.TMXLayer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.TMXLayer.WebGLRenderCmd,t.uploadData=function(t,e,i){var n=this._node,r=n._rotationX||n._rotationY,o=n.layerOrientation,s=n.tiles;if(!s)return 0;var c=(cc.view._scaleX,cc.view._scaleY,n._mapTileSize.width),a=n._mapTileSize.height,l=n.tileset._tileSize.width/cc.director._contentScaleFactor,h=n.tileset._tileSize.height/cc.director._contentScaleFactor,u=l-c,d=h-a,_=cc.winSize.width,p=cc.winSize.height,f=n._layerSize.height,m=n._layerSize.width,g=n._texGrids,y=n._spriteTiles,v=this._worldTransform,T=v.a,C=v.b,S=v.c,x=v.d,A=v.tx,E=v.ty,b=-n._contentSize.width*n._anchorPoint.x,R=-n._contentSize.height*n._anchorPoint.y,P=b*T+R*S+A,w=b*C+R*x+E,I=n._opacity,D=this._displayedColor.r,L=this._displayedColor.g,O=this._displayedColor.b;if(n._opacityModifyRGB){var B=I/255;D*=B,L*=B,O*=B}this._color[0]=I<<24|O<<16|L<<8|D;var N=0,F=0,M=m,V=f;r||o!==cc.TMX_ORIENTATION_ORTHO||(N=Math.floor(-(P-u*T)/(c*T)),F=Math.floor((w-d*x+a*f*x-p)/(a*x)),M=Math.ceil((_-P+u*T)/(c*T)),V=f-Math.floor(-(w+d*x)/(a*x)),N<0&&(N=0),F<0&&(F=0),M>m&&(M=m),V>f&&(V=f));var k,G,W,z,U,Y,X,H,j,q,Z,J,K,Q,$=i,tt=F*m,et=cc.TMX_TILE_FLIPPED_MASK,it=l*T,nt=h*x,rt=T,ot=C,st=S,ct=x,at=A,lt=E,ht=!1,ut=!1,dt=!1,_t=this._vertices;for(k=F;k<V;++k){for(G=N;G<M;++G)if($+24>t.length&&(cc.renderer._increaseBatchingSize(($-i)/6),cc.renderer._batchRendering(),i=0,$=0),W=tt+G,!y[W]&&(z=n.tiles[W],U=g[(z&et)>>>0])){switch(o){case cc.TMX_ORIENTATION_ORTHO:H=G*c,j=(f-k-1)*a,W=n._vertexZ+cc.renderer.assignedZStep*W/s.length;break;case cc.TMX_ORIENTATION_ISO:H=c/2*(m+G-k-1),j=a/2*(2*f-G-k-2),W=n._vertexZ+cc.renderer.assignedZStep*(n.height-j)/n.height;break;case cc.TMX_ORIENTATION_HEX:H=G*c*3/4,j=(f-k-1)*a+(G%2===1?-a/2:0),W=n._vertexZ+cc.renderer.assignedZStep*(n.height-j)/n.height}if(q=H+l,X=j+h,!r&&o===cc.TMX_ORIENTATION_ISO){if(K=w+j*x,K>p+nt){G+=Math.floor(2*(K-p)/nt)-1;continue}if(Q=P+q*T,Q<-it){G+=Math.floor(2*-Q/it)-1;continue}if(J=P+H*T,Z=w+X*x,J>_||Z<0){G=M;continue}}for(z>cc.TMX_TILE_DIAGONAL_FLAG&&(ht=!0,ut=(z&cc.TMX_TILE_HORIZONTAL_FLAG)>>>0,dt=(z&cc.TMX_TILE_VERTICAL_FLAG)>>>0),_t[0].x=H*rt+X*st+at,_t[0].y=H*ot+X*ct+lt,_t[1].x=H*rt+j*st+at,_t[1].y=H*ot+j*ct+lt,_t[2].x=q*rt+X*st+at,_t[2].y=q*ot+X*ct+lt,_t[3].x=q*rt+j*st+at,_t[3].y=q*ot+j*ct+lt,Y=0;Y<4;++Y){switch(t[$]=_t[Y].x,t[$+1]=_t[Y].y,t[$+2]=W,e[$+3]=this._color[0],Y){case 0:t[$+4]=ut?U.r:U.l,t[$+5]=dt?U.b:U.t;break;case 1:t[$+4]=ut?U.r:U.l,t[$+5]=dt?U.t:U.b;break;case 2:t[$+4]=ut?U.l:U.r,t[$+5]=dt?U.b:U.t;break;case 3:t[$+4]=ut?U.l:U.r,t[$+5]=dt?U.t:U.b}$+=6}ht&&(rt=T,ot=C,st=S,ct=x,at=A,lt=E,ut=!1,dt=!1,ht=!1)}tt+=m}return($-i)/6}}();cc.PointObject=cc.Class.extend({_ratio:null,_offset:null,_child:null,ctor:function(t,e){this.initWithCCPoint(t,e)},getRatio:function(){return this._ratio},setRatio:function(t){this._ratio=t},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t},getChild:function(){return this._child},setChild:function(t){this._child=t},initWithCCPoint:function(t,e){return this._ratio=t,this._offset=e,this._child=null,!0}}),cc.PointObject.create=function(t,e){return new cc.PointObject(t,e)},cc.ParallaxNode=cc.Node.extend({parallaxArray:null,_lastPosition:null,_className:"ParallaxNode",getParallaxArray:function(){return this.parallaxArray},setParallaxArray:function(t){this.parallaxArray=t},ctor:function(){cc.Node.prototype.ctor.call(this),this.parallaxArray=[],this._lastPosition=cc.p(-100,-100)},addChild:function(t,e,i,n){if(3===arguments.length)return void cc.log("ParallaxNode: use addChild(child, z, ratio, offset) instead");if(!t)throw new Error("cc.ParallaxNode.addChild(): child should be non-null");var r=new cc.PointObject(i,n);r.setChild(t),this.parallaxArray.push(r),t.setPosition(this._position.x*i.x+n.x,this._position.y*i.y+n.y),cc.Node.prototype.addChild.call(this,t,e,t.tag)},removeChild:function(t,e){for(var i=this.parallaxArray,n=0;n<i.length;n++){var r=i[n];if(r.getChild()===t){i.splice(n,1);break}}cc.Node.prototype.removeChild.call(this,t,e)},removeAllChildren:function(t){this.parallaxArray.length=0,cc.Node.prototype.removeAllChildren.call(this,t)},_updateParallaxPosition:function(){var t=this._absolutePosition();if(!cc.pointEqualToPoint(t,this._lastPosition)){for(var e=this.parallaxArray,i=0,n=e.length;i<n;i++){var r=e[i],o=r.getChild();o.setPosition(-t.x+t.x*r.getRatio().x+r.getOffset().x,-t.y+t.y*r.getRatio().y+r.getOffset().y)}this._lastPosition=t}},_absolutePosition:function(){for(var t=this._position,e=this;null!==e.parent;)e=e.parent,t=cc.pAdd(t,e.getPosition());return t},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ParallaxNode.CanvasRenderCmd(this):new cc.ParallaxNode.WebGLRenderCmd(this)}}),cc.ParallaxNode.create=function(){return new cc.ParallaxNode},function(){cc.ParallaxNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=cc.ParallaxNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.ParallaxNode.CanvasRenderCmd,t.updateStatus=function(){this._node._updateParallaxPosition(),cc.Node.CanvasRenderCmd.prototype.updateStatus.call(this)},t._syncStatus=function(t){this._node._updateParallaxPosition(),cc.Node.CanvasRenderCmd.prototype._syncStatus.call(this,t)}}(),cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){cc.ParallaxNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!1};var t=cc.ParallaxNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=cc.ParallaxNode.WebGLRenderCmd,t.updateStatus=function(){this._node._updateParallaxPosition(),cc.Node.WebGLRenderCmd.prototype.updateStatus.call(this)},t._syncStatus=function(t){this._node._updateParallaxPosition(),cc.Node.WebGLRenderCmd.prototype._syncStatus.call(this,t)}}});cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(t){this._isOpacityModifyRGB=t;for(var e=this.getChildren(),i=0,n=e.length;i<n;i++){var r=e[i];r&&r.setOpacityModifyRGB(t)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(t){this._enabled=t,this._state=t?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED,this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(t){this._selected=t,this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(t){this._highlighted=t,this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var t=this.getParent(),e=t;null!=e;e=e.getParent())if(!e.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this),this._dispatchTable={},this._color=cc.color.WHITE},init:function(){if(cc.Layer.prototype.init.call(this)){this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._selected=!1,this._highlighted=!1;var t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0});return this.onTouchBegan&&(t.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(t.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(t.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(t.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=t,!0}return!1},onEnter:function(){var t=this._touchListener;t._isRegistered()||cc.eventManager.addListener(t,this),cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(t){for(var e=0,i=cc.CONTROL_EVENT_TOTAL_NUMBER;e<i;e++)if(t&1<<e)for(var n=this._dispatchListforControlEvent(1<<e),r=0,o=n.length;r<o;r++)n[r].invoke(this)},addTargetWithActionForControlEvents:function(t,e,i){for(var n=0,r=cc.CONTROL_EVENT_TOTAL_NUMBER;n<r;n++)i&1<<n&&this._addTargetWithActionForControlEvent(t,e,1<<n)},removeTargetWithActionForControlEvents:function(t,e,i){for(var n=0,r=cc.CONTROL_EVENT_TOTAL_NUMBER;n<r;n++)i&1<<n&&this._removeTargetWithActionForControlEvent(t,e,1<<n)},getTouchLocation:function(t){var e=t.getLocation();return this.convertToNodeSpace(e)},isTouchInside:function(t){var e=t.getLocation();return e=this.getParent().convertToNodeSpace(e),cc.rectContainsPoint(this.getBoundingBox(),e)},_invocationWithTargetAndActionForControlEvent:function(t,e,i){return null},_dispatchListforControlEvent:function(t){return t=t.toString(),this._dispatchTable[t]||(this._dispatchTable[t]=[]),this._dispatchTable[t]},_addTargetWithActionForControlEvent:function(t,e,i){var n=new cc.Invocation(t,e,i),r=this._dispatchListforControlEvent(i);r.push(n)},_removeTargetWithActionForControlEvent:function(t,e,i){var n=this._dispatchListforControlEvent(i);if(t||e)for(var r=0;r<n.length;){var o=n[r],s=!0;t&&(s=t===o.getTarget()),e&&(s=s&&e===o.getAction()),s?cc.arrayRemoveObject(n,o):r++}else n.length=0},needsLayout:function(){}});var _p=cc.Control.prototype;_p.state,cc.defineGetterSetter(_p,"state",_p.getState),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p.highlighted,cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted),_p=null,cc.Control.create=function(){var t=new cc.Control;return t&&t.init()?t:null},cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(t,e,i){cc.Control.prototype.ctor.call(this),this._preferredSize=cc.size(0,0),this._labelAnchorPoint=cc.p(0,0),this._currentTitle="",this._currentTitleColor=cc.color.WHITE,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},void 0!=i?this.initWithTitleAndFontNameAndFontSize(t,e,i):void 0!=e?this.initWithLabelAndBackgroundSprite(t,e):void 0!=t?this.initWithBackgroundSprite(t):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(new cc.LabelTTF("","Arial",12),new cc.Scale9Sprite)},needsLayout:function(){if(this._parentInited){this._titleLabel&&this._titleLabel.setVisible(!1),this._backgroundSprite&&this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this._labelAnchorPoint);var t=this._state;this._currentTitle=this.getTitleForState(t),this._currentTitleColor=this.getTitleColorForState(t),this._titleLabel=this.getTitleLabelForState(t);var e=this._titleLabel;e&&e.setString&&e.setString(this._currentTitle),e&&e.setColor(this._currentTitleColor);var i=this.getContentSize();e&&e.setPosition(i.width/2,i.height/2),this._backgroundSprite=this.getBackgroundSpriteForState(t);var n=this._backgroundSprite;n&&n.setPosition(i.width/2,i.height/2);var r=cc.size(0,0);if(e){var o=e.getBoundingBox();r.width=o.width,r.height=o.height}if(this._doesAdjustBackgroundImage)n&&n.setContentSize(r.width+2*this._marginH,r.height+2*this._marginV);else if(n){var s=n.getPreferredSize();s=cc.size(s.width,s.height),s.width<=0&&(s.width=r.width),s.height<=0&&(s.height=r.height),n.setContentSize(s)}var c=e?e.getBoundingBox():cc.rect(0,0,0,0),a=n?n.getBoundingBox():cc.rect(0,0,0,0),l=cc.rectUnion(c,a);this.setContentSize(l.width,l.height),i=this.getContentSize(),e&&(e.setPosition(i.width/2,i.height/2),e.setVisible(!0)),n&&(n.setPosition(i.width/2,i.height/2),n.setVisible(!0))}},initWithLabelAndBackgroundSprite:function(t,e){if(!t)throw new Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null");if(!e)throw new Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null");if(cc.Control.prototype.init.call(this,!0)){this._parentInited=!0,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this._isPushed=!1,this.zoomOnTouchDown=!0,this._currentTitle=null,this.setAdjustBackgroundImage(!0),this.setPreferredSize(cc.size(0,0)),this.zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this._titleLabel=t,this._backgroundSprite=e,this.setOpacity(255),this.setOpacityModifyRGB(!0);var i=t.getString();return this.setTitleForState(i,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(t.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(t,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(e,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(t,e,i){var n=new cc.LabelTTF(t,e,i);return this.initWithLabelAndBackgroundSprite(n,new cc.Scale9Sprite)},initWithBackgroundSprite:function(t){var e=new cc.LabelTTF("","Arial",30);return this.initWithLabelAndBackgroundSprite(e,t)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(t){this._doesAdjustBackgroundImage=t,this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(t){return this.zoomOnTouchDown=t},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(t){if(0===t.width&&0===t.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var e=this._backgroundSpriteDispatchTable;for(var i in e)e[i].setPreferredSize(t)}this._preferredSize=t,this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(t){this._labelAnchorPoint=t,this._titleLabel&&this._titleLabel.setAnchorPoint(t)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(t){cc.Control.prototype.setOpacity.call(this,t);var e=this._backgroundSpriteDispatchTable;for(var i in e)e[i].setOpacity(t)},setColor:function(t){cc.Control.prototype.setColor.call(this,t);var e=this._backgroundSpriteDispatchTable;for(var i in e)e[i].setColor(t)},getColor:function(){var t=this._realColor;return cc.color(t.r,t.g,t.b,t.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},setMargins:function(t,e){this._marginV=e,this._marginH=t,this.needsLayout()},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this.needsLayout()},setSelected:function(t){cc.Control.prototype.setSelected.call(this,t),this.needsLayout()},setHighlighted:function(t){this._state=t?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL,cc.Control.prototype.setHighlighted.call(this,t);var e=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);if(e&&this.stopAction(e),this.zoomOnTouchDown){var i=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,n=cc.scaleTo(.05,i);n.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(n)}},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents())&&(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0)},onTouchMoved:function(t,e){if(!this._enabled||!this._isPushed||this._selected)return void(this._highlighted&&this.setHighlighted(!1));var i=this.isTouchInside(t);i&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):i&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!i&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):i||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)},onTouchEnded:function(t,e){this._isPushed=!1,this.setHighlighted(!1),this.isTouchInside(t)?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_INSIDE):this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(t,e){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(t){var e=this._titleDispatchTable;return e?e[t]?e[t]:e[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(t,e){this._titleDispatchTable[e]=t||"",this.getState()===e&&this.needsLayout()},getTitleColorForState:function(t){var e=this._titleColorDispatchTable[t];return e?e:(e=this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL],e?e:cc.color.WHITE)},setTitleColorForState:function(t,e){this._titleColorDispatchTable[e]=t,this.getState()===e&&this.needsLayout()},getTitleLabelForState:function(t){var e=this._titleLabelDispatchTable;return e[t]?e[t]:e[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(t,e){var i=this._titleLabelDispatchTable;if(i[e]){var n=i[e];n&&this.removeChild(n,!0)}i[e]=t,t.setVisible(!1),t.setAnchorPoint(.5,.5),this.addChild(t,1),this.getState()===e&&this.needsLayout()},setTitleTTFForState:function(t,e){var i=this.getTitleForState(e);i||(i=""),this.setTitleLabelForState(new cc.LabelTTF(i,t,12),e)},getTitleTTFForState:function(t){var e=this.getTitleLabelForState(t);return null!=e&&e instanceof cc.LabelTTF?e.getFontName():""},setTitleTTFSizeForState:function(t,e){var i=this.getTitleLabelForState(e);null!=i&&i instanceof cc.LabelTTF&&i.setFontSize(t)},getTitleTTFSizeForState:function(t){var e=this.getTitleLabelForState(t);return null!=e&&e instanceof cc.LabelTTF?e.getFontSize():0},setTitleBMFontForState:function(t,e){var i=this.getTitleForState(e);i||(i=""),this.setTitleLabelForState(new cc.LabelBMFont(i,t),e)},getTitleBMFontForState:function(t){var e=this.getTitleLabelForState(t);return null!=e&&e instanceof cc.LabelBMFont?e.getFntFile():""},getBackgroundSpriteForState:function(t){var e=this._backgroundSpriteDispatchTable;return e[t]?e[t]:e[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(t,e){var i=this._backgroundSpriteDispatchTable;if(i[e]){var n=i[e];n&&this.removeChild(n,!0)}i[e]=t,t.setVisible(!1),t.setAnchorPoint(.5,.5),this.addChild(t);var r=this._preferredSize;0===r.width&&0===r.height||t.setPreferredSize(r),this._state===e&&this.needsLayout()},setBackgroundSpriteFrameForState:function(t,e){var i=cc.Scale9Sprite.createWithSpriteFrame(t);this.setBackgroundSpriteForState(i,e)}});var _p=cc.ControlButton.prototype;_p.adjustBackground,cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.labelAnchor,cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint),_p=null,cc.ControlButton.create=function(t,e,i){return new cc.ControlButton(t,e,i)},cc.RGBA=function(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n},cc.HSV=function(t,e,i){this.h=t,this.s=e,this.v=i},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(t,e,i,n){var r=new cc.Sprite("#"+t);return r?(r.setPosition(i),r.setAnchorPoint(n),e.addChild(r),r):null},cc.ControlUtils.HSVfromRGB=function(t){var e,i,n,r=new cc.HSV;return e=t.r<t.g?t.r:t.g,e=e<t.b?e:t.b,i=t.r>t.g?t.r:t.g,i=i>t.b?i:t.b,r.v=i,n=i-e,i>0?(r.s=n/i,t.r>=i?r.h=(t.g-t.b)/n:t.g>=i?r.h=2+(t.b-t.r)/n:r.h=4+(t.r-t.g)/n,r.h*=60,r.h<0&&(r.h+=360),r):(r.s=0,r.h=-1,r)},cc.ControlUtils.RGBfromHSV=function(t){var e,i,n,r,o,s,c=new cc.RGBA;if(c.a=1,t.s<=0)return t.h?(c.r=0,c.g=0,c.b=0,c):(c.r=t.v,c.g=t.v,c.b=t.v,c);switch(e=t.h,e>=360&&(e=0),e/=60,s=0|e,o=e-s,i=t.v*(1-t.s),n=t.v*(1-t.s*o),r=t.v*(1-t.s*(1-o)),s){case 0:c.r=t.v,c.g=r,c.b=i;break;case 1:c.r=n,c.g=t.v,c.b=i;break;case 2:c.r=i,c.g=t.v,c.b=r;break;case 3:c.r=i,c.g=n,c.b=t.v;break;case 4:c.r=r,c.g=i,c.b=t.v;break;default:c.r=t.v,c.g=i,c.b=n}return c},cc.ControlUtils.CCRectUnion=function(t,e){return cc.rectUnion(t,e)},cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(t,e,i){this._target=t,this._action=e,this._controlEvent=i},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(t){this._target&&this._action&&(cc.isString(this._action)?this._target[this._action](t,this._controlEvent):this._action.call(this._target,t,this._controlEvent))}}),cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(t){var e=new cc.Spacer;return e.init(),e.setContentSize(0,t),e},cc.Spacer.horizontalSpacer=function(t){var e=new cc.Spacer;return e.init(),e.setContentSize(t,0),e},cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},setColor:function(t){var e=this._color;if(e.r=t.r,e.g=t.g,e.b=t.b,this._children&&this._children.length>0)for(var i=0;i<this._children.length;i++)this._children[i]&&this._children[i].setColor(t);void 0===t.a||t.a_undefined||this.setOpacity(t.a)},getOpacity:function(){return this._opacity},setOpacity:function(t){if(this._opacity=t,this._children&&this._children.length>0)for(var e=0;e<this._children.length;e++)this._children[e]&&this._children[e].setOpacity(t);this._color.a=t},initWithItems:function(t,e){if(this.init()){var i=cc.director.getWinSize();this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(.5,.5),this.setContentSize(i),this.setPosition(i.width/2,i.height/2);var n=0;if(t){this.addChild(t,n);for(var r=0;r<e.length;r++)e[r]&&(n++,this.addChild(e[r],n))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(t){var e,i=-t;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(i+=this._children[e].getContentSize().height*this._children[e].getScaleY()+t);var n=0,r=i/2;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(n=Math.max(n,this._children[e].getContentSize().width),this._children[e].setPosition(0,r-this._children[e].getContentSize().height*this._children[e].getScaleY()/2),r-=this._children[e].getContentSize().height*this._children[e].getScaleY()+t);this.setContentSize(n,i)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(t){var e,i=-t;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(i+=this._children[e].getContentSize().width*this._children[e].getScaleX()+t);var n=0,r=-i/2;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(n=Math.max(n,this._children[e].getContentSize().height),this._children[e].setPosition(r+this._children[e].getContentSize().width*this._children[e].getScaleX()/2,0),r+=this._children[e].getContentSize().width*this._children[e].getScaleX()+t);this.setContentSize(i,n)},alignItemsInColumns:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var n,r,o=-5,s=0,c=0,a=0;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)if(this._children[e]){if(s>=i.length){cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index");continue}if(n=i[s],!n){cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row");continue}r=this._children[e].getContentSize().height,c=0|(c>=r||null==r?c:r),++a,a>=n&&(o+=c+5,a=0,c=0,++s)}var l=cc.director.getWinSize();s=0,c=0,n=0;var h=0,u=0,d=o/2;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(0===n&&(n=i[s],h=l.width/(1+n),u=h),r=this._children[e].getContentSize().height,c=0|(c>=r||null==r?c:r),this._children[e].setPosition(u-l.width/2,d-this._children[e].getContentSize().height/2),u+=h,++a,a>=n&&(d-=c+5,a=0,n=0,c=0,++s))},alignItemsInRows:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var n,r,o=[],s=[],c=-10,a=-5,l=0,h=0,u=0;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)if(this._children[e]){if(l>=i.length){cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index");continue}if(n=i[l],!n){cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column");continue}r=this._children[e].getContentSize().width,h=0|(h>=r||null==r?h:r),a+=0|this._children[e].getContentSize().height+5,++u,u>=n&&(o.push(h),s.push(a),c+=h+10,u=0,h=0,a=-5,++l)}var d=cc.director.getWinSize();l=0,h=0,n=null;var _=-c/2,p=0;if(this._children&&this._children.length>0)for(e=0;e<this._children.length;e++)this._children[e]&&(null==n&&(n=i[l],p=s[l]),r=this._children[e].getContentSize().width,h=0|(h>=r||null==r?h:r),this._children[e].setPosition(_+o[l]/2,p-d.height/2),p-=this._children[e].getContentSize().height+10,++u,u>=n&&(_+=h+5,u=0,n=0,h=0,++l))},setOpacityModifyRGB:function(t){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(t){t||(t=null);for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n=new cc.MenuPassive;return n&&n.initWithItems(t,e)?n:null},cc.MenuPassive.createWithItem=function(t){return cc.MenuPassive.create(t,null)},cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(t,e){cc.Control.prototype.ctor.call(this),e&&this.initWithTargetAndPos(t,e)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(t,e){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",t,e,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",t,e,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",t,e,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",t,e,cc.p(.5,.5)),this._startPos=e,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._slider&&this._slider.setOpacity(t?255:128)},updateWithHSV:function(t){var e=new cc.HSV;e.s=1,e.h=t.h,e.v=1;var i=cc.ControlUtils.RGBfromHSV(e);this._background.setColor(cc.color(0|255*i.r,0|255*i.g,0|255*i.b))},updateDraggerWithHSV:function(t){var e=cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-t.s),this._startPos.y+this._boxPos+this._boxSize*t.v);this._updateSliderPosition(e)},_updateSliderPosition:function(t){var e=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,n=t.x-e,r=t.y-i,o=Math.sqrt(n*n+r*r),s=Math.atan2(r,n),c=.5*this._background.getBoundingBox().width;o>c&&(t.x=e+c*Math.cos(s),t.y=i+c*Math.sin(s)),this._slider.setPosition(t),t.x<this._startPos.x+this._boxPos?t.x=this._startPos.x+this._boxPos:t.x>this._startPos.x+this._boxPos+this._boxSize-1&&(t.x=this._startPos.x+this._boxPos+this._boxSize-1),t.y<this._startPos.y+this._boxPos?t.y=this._startPos.y+this._boxPos:t.y>this._startPos.y+this._boxPos+this._boxSize&&(t.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-t.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-t.y)/this._boxSize)},_checkSliderPosition:function(t){var e=this._startPos.x+.5*this._background.getBoundingBox().width,i=this._startPos.y+.5*this._background.getBoundingBox().height,n=t.x-e,r=t.y-i,o=Math.sqrt(n*n+r*r);return o<=.5*this._background.getBoundingBox().width&&(this._updateSliderPosition(t),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0)},onTouchBegan:function(t,e){if(!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(t);return this._checkSliderPosition(i)},onTouchMoved:function(t,e){var i=this.getTouchLocation(t);this._checkSliderPosition(i)}});var _p=cc.ControlSaturationBrightnessPicker.prototype;_p.saturation,cc.defineGetterSetter(_p,"saturation",_p.getSaturation),_p.brightness,cc.defineGetterSetter(_p,"brightness",_p.getBrightness),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.overlay,cc.defineGetterSetter(_p,"overlay",_p.getOverlay),_p.shadow,cc.defineGetterSetter(_p,"shadow",_p.getShadow),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlSaturationBrightnessPicker.create=function(t,e){return new cc.ControlSaturationBrightnessPicker(t,e)},cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(t,e){cc.Control.prototype.ctor.call(this),e&&this.initWithTargetAndPos(t,e)},getHue:function(){return this._hue},setHue:function(t){this._hue=t,this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(t){this._huePercentage=t,this._hue=360*this._huePercentage;var e=this._background.getBoundingBox(),i=this._startPos.x+.5*e.width,n=this._startPos.y+.5*e.height,r=.5*e.width-15,o=360*this._huePercentage-180,s=cc.degreesToRadians(o),c=i+r*Math.cos(s),a=n+r*Math.sin(s);this._slider.setPosition(c,a)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._slider&&this._slider.setOpacity(t?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(t,e){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",t,e,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",t,e,cc.p(.5,.5)),this._slider.setPosition(e.x,e.y+.5*this._background.getBoundingBox().height),this._startPos=e,this._hue=0,this._huePercentage=0,!0)},_updateSliderPosition:function(t){var e=this._background.getBoundingBox(),i=this._startPos.x+.5*e.width,n=this._startPos.y+.5*e.height,r=t.x-i,o=t.y-n,s=Math.atan2(o,r),c=cc.radiansToDegrees(s)+180;this.setHue(c),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(t){var e=Math.sqrt(Math.pow(t.x+10,2)+Math.pow(t.y,2));return 80>e&&e>59&&(this._updateSliderPosition(t),!0)},onTouchBegan:function(t,e){if(!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(t);return this._checkSliderPosition(i)},onTouchMoved:function(t,e){var i=this.getTouchLocation(t);this._checkSliderPosition(i)}});var _p=cc.ControlHuePicker.prototype;_p.hue,cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue),_p.huePercent,cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlHuePicker.create=function(t,e){return new cc.ControlHuePicker(t,e)},cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this),this.init()},hueSliderValueChanged:function(t,e){this._hsv.h=t.getHue();var i=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*i.r,0|255*i.g,0|255*i.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(t,e){this._hsv.s=t.getSaturation(),this._hsv.v=t.getBrightness();var i=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*i.r,0|255*i.g,0|255*i.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(t){cc.Control.prototype.setColor.call(this,t);var e=new cc.RGBA;e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(e),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(cc.Control.prototype.init.call(this)){cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);var t=new cc.SpriteBatchNode(res.CCControlColourPickerSpriteSheet_png);this.addChild(t),this._hsv=new cc.HSV(0,0,0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",t,cc.p(0,0),cc.p(.5,.5));var e=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2)),i=8,n=28;return this._huePicker=new cc.ControlHuePicker(t,cc.p(e.x+i,e.y+i)),this._colourPicker=new cc.ControlSaturationBrightnessPicker(t,cc.p(e.x+n,e.y+n)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),null!==this._huePicker&&this._huePicker.setEnabled(t),this._colourPicker&&this._colourPicker.setEnabled(t)},onTouchBegan:function(){return!1}});var _p=cc.ControlColourPicker.prototype;_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p=null,cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker};var res=res||{};res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist",res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png",cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(t,e,i){if(cc.Control.prototype.ctor.call(this),void 0!=i){var n=new cc.Sprite(t),r=new cc.Sprite(e),o=new cc.Sprite(i);this.initWithSprites(n,r,o)}},getValue:function(){return this._value},setValue:function(t){t=Math.max(t,this._minimumValue),t=Math.min(t,this._maximumValue),this._value=t,this.needsLayout(),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(t){this._minimumValue=t,this._minimumAllowedValue=t,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(t){this._maximumValue=t,this._maximumAllowedValue=t,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},isTouchInside:function(t){var e=t.getLocation();e=this.getParent().convertToNodeSpace(e);var i=this.getBoundingBox();return i.width+=this._thumbSprite.getContentSize().width,i.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(i,e)},locationFromTouch:function(t){var e=t.getLocation();return e=this.convertToNodeSpace(e),e.x<0?e.x=0:e.x>this._backgroundSprite.getContentSize().width&&(e.x=this._backgroundSprite.getContentSize().width),e},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(t){this._minimumAllowedValue=t},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(t){this._maximumAllowedValue=t},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(t,e,i){if(cc.Control.prototype.init.call(this)){this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=t,this._progressSprite=e,this._thumbSprite=i;var n=cc.ControlUtils.CCRectUnion(t.getBoundingBox(),i.getBoundingBox());return this.setContentSize(n.width,n.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(n.width/2,n.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,n.height/2),this.addChild(this._progressSprite),this._thumbSprite.setPosition(0,n.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0}return!1},setEnabled:function(t){cc.Control.prototype.setEnabled.call(this,t),this._thumbSprite&&this._thumbSprite.setOpacity(t?255:128)},sliderBegan:function(t){this.setSelected(!0),this._thumbSprite.setColor(cc.color.GRAY),this.setValue(this.valueForLocation(t))},sliderMoved:function(t){this.setValue(this.valueForLocation(t))},sliderEnded:function(t){this.isSelected()&&this.setValue(this.valueForLocation(this._thumbSprite.getPosition())),this._thumbSprite.setColor(cc.color.WHITE),this.setSelected(!1)},getTouchLocationInControl:function(t){var e=t.getLocation();return e=this.convertToNodeSpace(e),e.x<0?e.x=0:e.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(e.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),e},onTouchBegan:function(t,e){if(!this.isTouchInside(t)||!this.isEnabled()||!this.isVisible())return!1;var i=this.locationFromTouch(t);return this.sliderBegan(i),!0},onTouchMoved:function(t,e){var i=this.locationFromTouch(t);this.sliderMoved(i)},onTouchEnded:function(t,e){this.sliderEnded(cc.p(0,0))},needsLayout:function(){var t=(this._value-this._minimumValue)/(this._maximumValue-this._minimumValue);this._thumbSprite.setPositionX(t*this._backgroundSprite.getContentSize().width);var e=this._progressSprite.getTextureRect();e=cc.rect(e.x,e.y,this._thumbSprite.getPositionX(),e.height),this._progressSprite.setTextureRect(e,this._progressSprite.isTextureRectRotated()),this._thumbSprite._renderCmd.transform(this._renderCmd)},valueForLocation:function(t){var e=t.x/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+e*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}});var _p=cc.ControlSlider.prototype;_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.minAllowedValue,cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue),_p.maxAllowedValue,cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite),_p.progressSprite,cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite),_p.backgroundSprite,cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite),_p=null,cc.ControlSlider.create=function(t,e,i){return new cc.ControlSlider(t,e,i)},cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(t,e,i,n,r,o){cc.Control.prototype.ctor.call(this),o&&this.initWithMaskSprite(t,e,i,n,r,o)},initWithMaskSprite:function(t,e,i,n,r,o){if(!t)throw new Error("cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.");if(!e)throw new Error("cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.");if(!i)throw new Error("cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.");if(!n)throw new Error("cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.");return!!this.init()&&(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(t,e,i,n,r,o),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0)},setOn:function(t,e){e=e||!1,this._on=t;var i=this._on?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();e?this._switchSprite.runAction(new cc.ActionTween(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),i)):this._switchSprite.setSliderXPosition(i),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(t){this._enabled=t,this._switchSprite.setOpacity(t?255:128)},locationFromTouch:function(t){var e=t.getLocation();return e=this.convertToNodeSpace(e)},onTouchBegan:function(t,e){if(!this.isTouchInside(t)||!this.isEnabled()||!this.isVisible())return!1;this._moved=!1;var i=this.locationFromTouch(t);return this._initialTouchXPosition=i.x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0},onTouchMoved:function(t,e){var i=this.locationFromTouch(t);i=cc.p(i.x-this._initialTouchXPosition,0),this._moved=!0,this._switchSprite.setSliderXPosition(i.x)},onTouchEnded:function(t,e){var i=this.locationFromTouch(t);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(i.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(t,e){var i=this.locationFromTouch(t);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(i.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(t,e,i,n,r,o){return new cc.ControlSwitch(t,e,i,n,r,o)},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this),this._sliderXPosition=0,this._onPosition=0,this._offPosition=0,this._maskLocation=0,this._maskSize=cc.size(0,0),this._onSprite=null,this._offSprite=null,this._thumbSprite=null,this._onLabel=null,this._offLabel=null},initWithMaskSprite:function(t,e,i,n,r,o){if(cc.Sprite.prototype.init.call(this)){this.setSpriteFrame(t.displayFrame()),this._onPosition=0,this._offPosition=-e.getContentSize().width+n.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(e),this.setOffSprite(i),this.setThumbSprite(n),this.setOnLabel(r),this.setOffLabel(o),this._stencil=t;var s=this._maskSize=this._stencil.getContentSize();return this._stencil.setPosition(0,0),this._clipper=new cc.ClippingNode,this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(s.width/2,s.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(e),this._clipper.addChild(i),this._clipper.addChild(r),this._clipper.addChild(o),this.addChild(this._thumbSprite),this.needsLayout(),!0}return!1},needsLayout:function(){var t=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-t.width/2,this._onSprite.getContentSize().height/2-t.height/2),this._offSprite.setPosition(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition-t.width/2,this._offSprite.getContentSize().height/2-t.height/2),this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-t.height/2),this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-t.height/2),this._thumbSprite.setPosition(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(t){t<=this._offPosition?t=this._offPosition:t>=this._onPosition&&(t=this._onPosition),this._sliderXPosition=t,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(t,e){"sliderXPosition"===e&&this.setSliderXPosition(t)},setOnPosition:function(t){this._onPosition=t},getOnPosition:function(){return this._onPosition},setOffPosition:function(t){this._offPosition=t},getOffPosition:function(){return this._offPosition},setMaskTexture:function(t){this._stencil.setTexture(t)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(t){this._textureLocation=t},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(t){this._maskLocation=t},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(t){this._onSprite=t},getOnSprite:function(){return this._onSprite},setOffSprite:function(t){this._offSprite=t},getOffSprite:function(){return this._offSprite},setThumbSprite:function(t){this._thumbSprite=t},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(t){this._onLabel=t},getOnLabel:function(){return this._onLabel},setOffLabel:function(t){this._offLabel=t},getOffLabel:function(){return this._offLabel}});var _p=cc.ControlSwitchSprite.prototype;_p.sliderX,cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition),_p.onPos,cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition),_p.offPos,cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition),_p.maskTexture,cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture),_p.maskPos,cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation),_p.onSprite,cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite),_p.offSprite,cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.onLabel,cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel),_p.offLabel,cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel),_p.onSideWidth,cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth),_p.offSideWidth,cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth),_p=null,cc.CONTROL_STEPPER_PARTMINUS=0,cc.CONTROL_STEPPER_PARTPLUS=1,cc.CONTROL_STEPPER_PARTNONE=2,cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55),cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147),cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT",cc.AUTOREPEAT_DELTATIME=.15,cc.AUTOREPEAT_INCREASETIME_INCREMENT=12,cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(t,e){cc.Control.prototype.ctor.call(this),this._minusSprite=null,this._plusSprite=null,this._minusLabel=null,this._plusLabel=null,this._value=0,this._continuous=!1,this._autorepeat=!1,this._wraps=!1,this._minimumValue=0,this._maximumValue=0,this._stepValue=0,this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._autorepeatCount=0,e&&this.initWithMinusSpriteAndPlusSprite(t,e)},initWithMinusSpriteAndPlusSprite:function(t,e){if(!t)throw new Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.");if(!e)throw new Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.");if(this.init()){this._autorepeat=!0,this._continuous=!0,this._minimumValue=0,this._maximumValue=100,this._value=0,this._stepValue=1,this._wraps=!1,this.ignoreAnchorPointForPosition(!1),this.setMinusSprite(t),this._minusSprite.setPosition(t.getContentSize().width/2,t.getContentSize().height/2),this.addChild(this._minusSprite),this.setMinusLabel(new cc.LabelTTF("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED),this._minusLabel.setPosition(this._minusSprite.getContentSize().width/2,this._minusSprite.getContentSize().height/2),this._minusSprite.addChild(this._minusLabel),this.setPlusSprite(e),this._plusSprite.setPosition(t.getContentSize().width+e.getContentSize().width/2,t.getContentSize().height/2),this.addChild(this._plusSprite),this.setPlusLabel(new cc.LabelTTF("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setPosition(this._plusSprite.getContentSize().width/2,this._plusSprite.getContentSize().height/2),this._plusSprite.addChild(this._plusLabel);var i=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox());return this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,i.height),!0}return!1},setWraps:function(t){this._wraps=t,this._wraps&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),this.setValue(this._value)},getWraps:function(){return this._wraps},setMinimumValue:function(t){if(t>=this._maximumValue)throw new Error("cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.");this._minimumValue=t,this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(t){if(t<=this._minimumValue)throw new Error("cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.");this._maximumValue=t,this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setValue:function(t){this.setValueWithSendingEvent(t,!0)},getValue:function(){return this._value},setStepValue:function(t){if(t<=0)throw new Error("cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.");this._stepValue=t},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(t,e){t<this._minimumValue?t=this._wraps?this._maximumValue:this._minimumValue:t>this._maximumValue&&(t=this._wraps?this._minimumValue:this._maximumValue),this._value=t,this._wraps||(this._minusLabel.setColor(t===this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(t===this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),e&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1,this.schedule(this.update,cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(t){this._autorepeatCount++,this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&this._autorepeatCount%3!==0||(this._touchedPart===cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart===cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},updateLayoutUsingTouchLocation:function(t){t.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):t.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(t,e){if(!this.isTouchInside(t)||!this.isEnabled()||!this.isVisible())return!1;var i=this.getTouchLocation(t);return this.updateLayoutUsingTouchLocation(i),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0},onTouchMoved:function(t,e){if(this.isTouchInside(t)){var i=this.getTouchLocation(t);this.updateLayoutUsingTouchLocation(i),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat())}else this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat()},onTouchEnded:function(t,e){if(this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(t)){var i=this.getTouchLocation(t);this.setValue(this._value+(i.x<this._minusSprite.getContentSize().width?0-this._stepValue:this._stepValue))}},setMinusSprite:function(t){this._minusSprite=t},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(t){this._plusSprite=t},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(t){this._minusLabel=t},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(t){this._plusLabel=t},getPlusLabel:function(){return this._plusLabel}});var _p=cc.ControlStepper.prototype;_p.wraps,cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps),_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.stepValue,cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue),_p.continuous,cc.defineGetterSetter(_p,"continuous",_p.isContinuous),_p.minusSprite,cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite),_p.plusSprite,cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite),_p.minusLabel,cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel),_p.plusLabel,cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel),_p=null,cc.ControlStepper.create=function(t,e){return new cc.ControlStepper(t,e)},cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(t,e,i){if(cc.Control.prototype.ctor.call(this),void 0!=i){var n=new cc.Sprite(t),r=new cc.Sprite(i),o=new cc.ProgressTimer(new cc.Sprite(e));this.initWithTrackSprite_ProgressTimer_ThumbSprite(n,o,r)}},initWithTrackSprite_ProgressTimer_ThumbSprite:function(t,e,i){return!!this.init()&&(this.setProgressTimer(e),this.setThumbSprite(i),this._thumbSprite.setPosition(e.getPosition()),this.addChild(i,2),this.addChild(e,1),this.addChild(t),this.setContentSize(t.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0)},setEnabled:function(t){this.setEnabled(t),null!==this._thumbSprite&&this._thumbSprite.setOpacity(t?255:128)},setValue:function(t){t<this._minimumValue&&(t=this._minimumValue),t>this._maximumValue&&(t=this._maximumValue),this._value=t;var e=(t-this._minimumValue)/(this._maximumValue-this._minimumValue);this._progressTimer.setPercentage(100*e),this._thumbSprite.setRotation(360*e),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(t){this._minimumValue=t,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(t){this._maximumValue=t,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(t){var e=this.getTouchLocation(t),i=this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),e);return i<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(t,e){return!!(this.isTouchInside(t)&&this.isEnabled()&&this.isVisible())&&(this._previousLocation=this.getTouchLocation(t),this.potentiometerBegan(this._previousLocation),!0)},onTouchMoved:function(t,e){var i=this.getTouchLocation(t);this.potentiometerMoved(i)},onTouchEnded:function(t,e){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,s=n.x-i.x,c=n.y-i.y,a=Math.atan2(r,o),l=Math.atan2(s,c);return 180*(a-l)/Math.PI},potentiometerBegan:function(t){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY)},potentiometerMoved:function(t){var e=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),t,this._progressTimer.getPosition(),this._previousLocation);e>180?e-=360:e<-180&&(e+=360),this.setValue(this._value+e/360*(this._maximumValue-this._minimumValue)),this._previousLocation=t},potentiometerEnded:function(t){this.getThumbSprite().setColor(cc.color.WHITE),this.setSelected(!1)},setThumbSprite:function(t){this._thumbSprite=t},getThumbSprite:function(){return this._thumbSprite},setProgressTimer:function(t){this._progressTimer=t},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(t){this._previousLocation=t},getPreviousLocation:function(){return this._previousLocation}});var _p=cc.ControlPotentiometer.prototype;_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.progressTimer,cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.prevLocation,cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation),_p=null,cc.ControlPotentiometer.create=function(t,e,i){return new cc.ControlPotentiometer(t,e,i)},cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=7/160,BOUNCE_BACK_FACTOR=.35;cc.convertDistanceFromPointToInch=function(t){var e=cc.view,i=(e.getScaleX()+e.getScaleY())/2;return t*i/160},cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(t){},scrollViewDidZoom:function(t){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",ctor:function(t,e){cc.Layer.prototype.ctor.call(this),this._contentOffset=cc.p(0,0),this._maxInset=cc.p(0,0),this._minInset=cc.p(0,0),this._scrollDistance=cc.p(0,0),this._touchPoint=cc.p(0,0),this._touches=[],this._viewSize=cc.size(0,0),this._parentScissorRect=new cc.Rect(0,0,0,0),this._tmpViewRect=new cc.Rect(0,0,0,0),void 0!=e?this.initWithViewSize(t,e):this.initWithViewSize(cc.size(200,200),null)},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(t,e){var i=cc.p(0,0);return!!cc.Layer.prototype.init.call(this)&&(e||this._container||(e=new cc.Layer),e&&this.setContainer(e),this.setViewSize(t),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(i),this._touchLength=0,this._minScale=this._maxScale=1,!0)},setContentOffset:function(t,e){if(e)return void this.setContentOffsetInDuration(t,BOUNCE_DURATION);if(!this._bounceable){var i=this.minContainerOffset(),n=this.maxContainerOffset();t.x=Math.max(i.x,Math.min(n.x,t.x)),t.y=Math.max(i.y,Math.min(n.y,t.y))}this._container.setPosition(t);var r=this._delegate;null!=r&&r.scrollViewDidScroll&&r.scrollViewDidScroll(this)},getContentOffset:function(){var t=this._container.getPosition();return cc.p(t.x,t.y)},setContentOffsetInDuration:function(t,e){var i=cc.moveTo(e,t),n=cc.callFunc(this._stoppedAnimatedScroll,this);this._container.runAction(cc.sequence(i,n)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(t,e){if(e)return void this.setZoomScaleInDuration(t,BOUNCE_DURATION);var i=this._container;if(i.getScale()!==t){var n,r,o;if(0===this._touchLength){var s=this._viewSize;o=cc.p(.5*s.width,.5*s.height),o=this.convertToWorldSpace(o)}else o=this._touchPoint;n=i.convertToNodeSpace(o),i.setScale(Math.max(this._minScale,Math.min(this._maxScale,t))),r=i.convertToWorldSpace(n);var c=cc.pSub(o,r);this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(i.getPosition(),c))}},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(t,e){if(e>0){var i=this._container.getScale();if(i!==t){var n=cc.actionTween(e,"zoomScale",i,t);this.runAction(n)}}else this.setZoomScale(t)},minContainerOffset:function(){var t=this._container,e=t.getContentSize(),i=this._viewSize;return cc.p(i.width-e.width*t.getScaleX(),i.height-e.height*t.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(t){var e=this.getContentOffset(),i=this.getViewSize(),n=this.getZoomScale(),r=cc.rect(-e.x/n,-e.y/n,i.width/n,i.height/n);return cc.rectIntersectsRect(r,t.getBoundingBox())},pause:function(t){this._container.pause();for(var e=this._container.getChildren(),i=0;i<e.length;i++)e[i].pause();this._super()},resume:function(t){for(var e=this._container.getChildren(),i=0,n=e.length;i<n;i++)e[i].resume();this._container.resume(),this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(t){this._bounceable=t},getViewSize:function(){return this._viewSize},setViewSize:function(t){this._viewSize=t,cc.Node.prototype.setContentSize.call(this,t)},getContainer:function(){return this._container},setContainer:function(t){t&&(this.removeAllChildren(!0),this._container=t,t.ignoreAnchorPointForPosition(!1),t.setAnchorPoint(0,0),this.addChild(t),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},setDirection:function(t){this._direction=t},getDelegate:function(){return this._delegate},setDelegate:function(t){this._delegate=t},onTouchBegan:function(t,e){for(var i=this;null!=i;i=i.parent)if(!i.isVisible())return!1;var n=this._getViewRect(),r=this._container,o=r.convertToWorldSpace(r.convertTouchToNodeSpace(t)),s=this._touches;return!(s.length>2||this._touchMoved||!cc.rectContainsPoint(n,o))&&(s.push(t),1===s.length?(this._touchPoint=this.convertTouchToNodeSpace(t),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=0,this._scrollDistance.y=0,this._touchLength=0):2===s.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(s[0]),this.convertTouchToNodeSpace(s[1])),this._touchLength=cc.pDistance(r.convertTouchToNodeSpace(s[0]),r.convertTouchToNodeSpace(s[1])),this._dragging=!1),!0)},onTouchMoved:function(t,e){if(this.isVisible())if(this.setNodeDirty(),1===this._touches.length&&this._dragging){this._touchMoved=!0;var i,n=(this._getViewRect(),this.convertTouchToNodeSpace(t)),r=cc.pSub(n,this._touchPoint),o=0,s=this._direction;if(s===cc.SCROLLVIEW_DIRECTION_VERTICAL)o=r.y,i=this._container.getPositionY(),this.minContainerOffset().y<=i&&i<=this.maxContainerOffset().y||(r.y*=BOUNCE_BACK_FACTOR);else if(s===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)o=r.x,i=this._container.getPositionX(),this.minContainerOffset().x<=i&&i<=this.maxContainerOffset().x||(r.x*=BOUNCE_BACK_FACTOR);else{o=Math.sqrt(r.x*r.x+r.y*r.y),i=this._container.getPositionY();var c=this.minContainerOffset(),a=this.maxContainerOffset();c.y<=i&&i<=a.y||(r.y*=BOUNCE_BACK_FACTOR),i=this._container.getPositionX(),c.x<=i&&i<=a.x||(r.x*=BOUNCE_BACK_FACTOR)}if(!this._touchMoved&&Math.abs(cc.convertDistanceFromPointToInch(o))<MOVE_INCH)return;if(this._touchMoved||(r.x=0,r.y=0),this._touchPoint=n,this._touchMoved=!0,this._dragging){switch(s){case cc.SCROLLVIEW_DIRECTION_VERTICAL:r.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:r.y=0}var l=this._container.getPosition(),h=l.x+r.x,u=l.y+r.y;this._scrollDistance=r,this.setContentOffset(cc.p(h,u))}}else if(2===this._touches.length&&!this._dragging){var d=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1]));this.setZoomScale(this.getZoomScale()*d/this._touchLength)}},onTouchEnded:function(t,e){this.isVisible()&&(1===this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},onTouchCancelled:function(t,e){this.isVisible()&&(this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},setContentSize:function(t,e){null!==this.getContainer()&&(void 0===e?this.getContainer().setContentSize(t):this.getContainer().setContentSize(t,e),this.updateInset())},_setWidth:function(t){var e=this.getContainer();null!==e&&(e._setWidth(t),this.updateInset())},_setHeight:function(t){var e=this.getContainer();null!==e&&(e._setHeight(t),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){if(null!==this.getContainer()){var t=this._viewSize,e=this.maxContainerOffset();this._maxInset.x=e.x+t.width*INSET_RATIO,this._maxInset.y=e.y+t.height*INSET_RATIO,e=this.minContainerOffset(),this._minInset.x=e.x-t.width*INSET_RATIO,this._minInset.y=e.y-t.height*INSET_RATIO}},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(t){this._clippingToBounds=t},addChild:function(t,e,i){if(!t)throw new Error("child must not nil!");e=e||t.getLocalZOrder(),i=i||t.getTag(),this._container!==t?this._container.addChild(t,e,i):cc.Layer.prototype.addChild.call(this,t,e,i)},isTouchEnabled:function(){return null!==this._touchListener},setTouchEnabled:function(t){if(this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,t){var e=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});this.onTouchBegan&&(e.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(e.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(e.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(e.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=e,cc.eventManager.addListener(e,this)}else this._dragging=!1,this._touchMoved=!1,this._touches.length=0},_initWithViewSize:function(t){return null},_relocateContainer:function(t){var e=this.minContainerOffset(),i=this.maxContainerOffset(),n=this._direction,r=this._container.getPosition(),o=r.x,s=r.y;n!==cc.SCROLLVIEW_DIRECTION_BOTH&&n!==cc.SCROLLVIEW_DIRECTION_HORIZONTAL||(o=Math.max(o,e.x),o=Math.min(o,i.x)),n!==cc.SCROLLVIEW_DIRECTION_BOTH&&n!==cc.SCROLLVIEW_DIRECTION_VERTICAL||(s=Math.min(s,i.y),s=Math.max(s,e.y)),s===r.y&&o===r.x||this.setContentOffset(cc.p(o,s),t)},_deaccelerateScrolling:function(t){if(this._dragging)return void this.unschedule(this._deaccelerateScrolling);var e,i,n=this._container.getPosition(),r=this._scrollDistance;this._container.setPosition(n.x+r.x,n.y+r.y),this._bounceable?(e=this._maxInset,i=this._minInset):(e=this.maxContainerOffset(),i=this.minContainerOffset());var o=this._container.getPositionX(),s=this._container.getPositionY();r.x=r.x*SCROLL_DEACCEL_RATE,r.y=r.y*SCROLL_DEACCEL_RATE,this.setContentOffset(cc.p(o,s)),(Math.abs(r.x)<=SCROLL_DEACCEL_DIST&&Math.abs(r.y)<=SCROLL_DEACCEL_DIST||s>e.y||s<i.y||o>e.x||o<i.x||o===e.x||o===i.x||s===e.y||s===i.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0))},_performedAnimatedScroll:function(t){return this._dragging?void this.unschedule(this._performedAnimatedScroll):void(this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this))},_stoppedAnimatedScroll:function(t){this.unschedule(this._performedAnimatedScroll),this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_handleZoom:function(){},_getViewRect:function(){for(var t=this.convertToWorldSpace(cc.p(0,0)),e=this._viewSize,i=this.getScaleX(),n=this.getScaleY(),r=this._parent;null!=r;r=r.getParent())i*=r.getScaleX(),n*=r.getScaleY();i<0&&(t.x+=e.width*i,i=-i),n<0&&(t.y+=e.height*n,n=-n);var o=this._tmpViewRect;return o.x=t.x,o.y=t.y,o.width=e.width*i,o.height=e.height*n,o},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ScrollView.CanvasRenderCmd(this):new cc.ScrollView.WebGLRenderCmd(this)}});var _p=cc.ScrollView.prototype;_p.minOffset,cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset),_p.maxOffset,cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset),_p.bounceable,cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable),_p.viewSize,cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize),_p.container,cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer),_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.clippingToBounds,cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds),_p=null,cc.ScrollView.create=function(t,e){return new cc.ScrollView(t,e)},function(){cc.ScrollView.CanvasRenderCmd=function(t){cc.Layer.CanvasRenderCmd.call(this,t),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.startCmd._canUseDirtyRegion=!0,this.endCmd=new cc.CustomRenderCmd(this,this._endCmd),this.endCmd._canUseDirtyRegion=!0};var t=cc.ScrollView.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);t.constructor=cc.ScrollView.CanvasRenderCmd,t._startCmd=function(t,e,i){var n=this._node,r=t||cc._renderContext,o=r.getContext();if(r.save(),n._clippingToBounds){this._scissorRestored=!1,r.setTransform(this._worldTransform,e,i);var s=n.getScaleX(),c=n.getScaleY(),a=n._viewSize.width*s,l=n._viewSize.height*c;o.beginPath(),o.rect(0,0,a,-l),o.closePath(),o.clip()}},t._endCmd=function(t){t=t||cc._renderContext,t.restore()},t.visit=function(t){var e=this._node;if(e._visible){var i,n,r=e._children;if(this._syncStatus(t),cc.renderer.pushRenderCommand(this.startCmd),r&&r.length>0)for(n=r.length,e.sortAllChildren(),i=0;i<n;i++)r[i]._renderCmd.visit(this);cc.renderer.pushRenderCommand(this.endCmd),this._dirtyFlag=0}}}(),cc.SortableObject=cc.Class.extend({setObjectID:function(t){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(t){this._objectID=t},getObjectID:function(){return this._objectID}});var _compareObject=function(t,e){return t.getObjectID()-e.getObjectID()};cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(t){if(!t)throw new Error("cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.");var e=this.indexOfSortedObject(t);this.insertObject(t,e)},removeSortedObject:function(t){if(0!==this.count()){var e=this.indexOfSortedObject(t);if(e<this.count()&&e!==cc.INVALID_INDEX){var i=this.objectAtIndex(e);i.getObjectID()===t.getObjectID()&&this.removeObjectAtIndex(e)}}},setObjectID_ofSortedObject:function(t,e){var i=this.indexOfSortedObject(e);if(i<this.count()&&i!==cc.INVALID_INDEX){var n=this.objectAtIndex(i);n.getObjectID()===e.getObjectID()&&(this.removeObjectAtIndex(i),n.setObjectID(t),this.insertSortedObject(n))}},objectWithObjectID:function(t){if(0===this.count())return null;var e=new cc.SortedObject;e.setObjectID(t);var i=this.indexOfSortedObject(e);return i<this.count()&&i!==cc.INVALID_INDEX&&(e=this.objectAtIndex(i),e.getObjectID()!==t&&(e=null)),e},getObjectWithObjectID:function(t){return null},indexOfSortedObject:function(t){var e=0;if(t)for(var i=0,n=t.getObjectID(),r=this._saveObjectArr,o=0;o<r.length;o++){var s=r[o],c=s.getObjectID();if(n===c||n>=i&&n<c)break;i=c,e++}else e=cc.INVALID_INDEX;return e},count:function(){return this._saveObjectArr.length},lastObject:function(){var t=this._saveObjectArr;return 0===t.length?null:t[t.length-1]},objectAtIndex:function(t){return this._saveObjectArr[t]},addObject:function(t){this._saveObjectArr.push(t),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(t){this._saveObjectArr.splice(t,1),this._saveObjectArr.sort(_compareObject)},insertObject:function(t,e){this._saveObjectArr.splice(e,0,t),this._saveObjectArr.sort(_compareObject)}}),cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",getIdx:function(){return this._idx},setIdx:function(t){this._idx=t},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(t){this._idx=t},getObjectID:function(){return this._idx}});var _p=cc.TableViewCell.prototype;_p.objectId,cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID),_p=null,cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(t,e){},tableCellHighlight:function(t,e){},tableCellUnhighlight:function(t,e){},tableCellWillRecycle:function(t,e){}}),cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(t,e){return this.cellSizeForTable(t)},cellSizeForTable:function(t){return cc.size(0,0)},tableCellAtIndex:function(t,e){return null},numberOfCellsInTableView:function(t){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(t,e,i){cc.ScrollView.prototype.ctor.call(this),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE,this._cellsPositions=[],this.initWithViewSize(e,i),this.setDataSource(t),this._updateCellPositions(),this._updateContentSize()},__indexFromOffset:function(t){var e,i=0,n=this._dataSource.numberOfCellsInTableView(this)-1;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:e=t.x;break;default:e=t.y}for(var r=this._cellsPositions;n>=i;){var o=0|i+(n-i)/2,s=r[o],c=r[o+1];if(e>=s&&e<=c)return o;e<s?n=o-1:i=o+1}return i<=0?0:-1},_indexFromOffset:function(t){var e={x:t.x,y:t.y},i=this._dataSource,n=i.numberOfCellsInTableView(this)-1;this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(e.y=this.getContainer().getContentSize().height-e.y);var r=this.__indexFromOffset(e);return r!==-1&&(r=Math.max(0,r),r>n&&(r=cc.INVALID_INDEX)),r},__offsetFromIndex:function(t){var e;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:e=cc.p(this._cellsPositions[t],0);break;default:e=cc.p(0,this._cellsPositions[t])}return e},_offsetFromIndex:function(t){var e=this.__offsetFromIndex(t),i=this._dataSource.tableCellSizeForIndex(this,t);return this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(e.y=this.getContainer().getContentSize().height-e.y-i.height),e},_updateCellPositions:function(){var t=this._dataSource.numberOfCellsInTableView(this),e=this._cellsPositions;if(t>0){for(var i,n=0,r=this._dataSource,o=0;o<t;o++)switch(e[o]=n,i=r.tableCellSizeForIndex(this,o),this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:n+=i.width;break;default:n+=i.height}this._cellsPositions[t]=n}},_updateContentSize:function(){var t=cc.size(0,0),e=this._dataSource.numberOfCellsInTableView(this);if(e>0){var i=this._cellsPositions[e];switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:t=cc.size(i,this._viewSize.height);break;default:t=cc.size(this._viewSize.width,i)}}this.setContentSize(t),this._oldDirection!==this._direction&&(this._direction===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?this.setContentOffset(cc.p(0,0)):this.setContentOffset(cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(t){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,t),this._cellsFreed.addObject(t),this._cellsUsed.removeSortedObject(t),cc.arrayRemoveObject(this._indices,t.getIdx()),t.reset(),t.getParent()===this.getContainer()&&this.getContainer().removeChild(t,!0)},_setIndexForCell:function(t,e){e.setAnchorPoint(0,0),e.setPosition(this._offsetFromIndex(t)),e.setIdx(t)},_addCellIfNecessary:function(t){t.getParent()!==this.getContainer()&&this.getContainer().addChild(t),this._cellsUsed.insertSortedObject(t);var e=this._indices,i=t.getIdx();e.indexOf(i)===-1&&(e.push(i),e.sort(function(t,e){return t-e}))},getDataSource:function(){return this._dataSource},setDataSource:function(t){this._dataSource=t},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(t){this._tableViewDelegate=t},setVerticalFillOrder:function(t){this._vOrdering!==t&&(this._vOrdering=t,this._cellsUsed.count()>0&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(t,e){return!!cc.ScrollView.prototype.initWithViewSize.call(this,t,e)&&(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0)},updateCellAtIndex:function(t){if(!(t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1)){var e=this.cellAtIndex(t);e&&this._moveCellOutOfSight(e),e=this._dataSource.tableCellAtIndex(this,t),this._setIndexForCell(t,e),this._addCellIfNecessary(e)}},insertCellAtIndex:function(t){if(!(t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1)){var e,i=this._cellsUsed,n=i.objectWithObjectID(t);if(n){e=i.indexOfSortedObject(n);for(var r=e;r<i.count();r++)n=i.objectAtIndex(r),this._setIndexForCell(n.getIdx()+1,n)}n=this._dataSource.tableCellAtIndex(this,t),this._setIndexForCell(t,n),this._addCellIfNecessary(n),this._updateCellPositions(),this._updateContentSize()}},removeCellAtIndex:function(t){if(!(t===cc.INVALID_INDEX||t>this._dataSource.numberOfCellsInTableView(this)-1)){var e=this.cellAtIndex(t);if(e){var i=this._cellsUsed,n=i.indexOfSortedObject(e);this._moveCellOutOfSight(e),cc.arrayRemoveObject(this._indices,t),this._updateCellPositions();for(var r=i.count()-1;r>n;r--)e=i.objectAtIndex(r),this._setIndexForCell(e.getIdx()-1,e)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var t=this._cellsUsed,e=this._cellsFreed,i=this.getContainer(),n=0,r=t.count();n<r;n++){var o=t.objectAtIndex(n);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,o),e.addObject(o),o.reset(),o.getParent()===i&&i.removeChild(o,!0)}this._indices=[],this._cellsUsed=new cc.ArrayForObjectSorting,this._updateCellPositions(),this._updateContentSize(),this._dataSource.numberOfCellsInTableView(this)>0&&this.scrollViewDidScroll(this),this.setNodeDirty()},dequeueCell:function(){if(0===this._cellsFreed.count())return null;var t=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),t},cellAtIndex:function(t){var e=this._indices.indexOf(t);return e===-1?null:this._cellsUsed.objectWithObjectID(t)},scrollViewDidScroll:function(t){var e=this._dataSource,i=e.numberOfCellsInTableView(this);if(0!==i){null!==this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var n=0,r=this._viewSize,o=this.getContainer(),s=this.getContentOffset();s.x*=-1,s.y*=-1;var c=Math.max(i-1,0);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(s.y=s.y+r.height/o.getScaleY());var a=this._indexFromOffset(s);a===cc.INVALID_INDEX&&(a=i-1),this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?s.y-=r.height/o.getScaleY():s.y+=r.height/o.getScaleY(),s.x+=r.width/o.getScaleX();var l=this._indexFromOffset(s);l===cc.INVALID_INDEX&&(l=i-1);var h,u=this._cellsUsed;if(u.count()>0)for(h=u.objectAtIndex(0),n=h.getIdx();n<a&&(this._moveCellOutOfSight(h),u.count()>0);)h=u.objectAtIndex(0),n=h.getIdx();if(u.count()>0)for(h=u.lastObject(),n=h.getIdx();n<=c&&n>l&&(this._moveCellOutOfSight(h),u.count()>0);)h=u.lastObject(),n=h.getIdx();for(var d=this._indices,_=a;_<=l;_++)d.indexOf(_)===-1&&this.updateCellAtIndex(_)}},scrollViewDidZoom:function(t){},onTouchEnded:function(t,e){if(this.isVisible()){if(this._touchedCell){var i=this.getBoundingBox(),n=cc.p(i.x,i.y);n=this._parent.convertToWorldSpace(n),i.x=n.x,i.y=n.y;var r=this._tableViewDelegate;cc.rectContainsPoint(i,t.getLocation())&&null!==r&&(r.tableCellUnhighlight&&r.tableCellUnhighlight(this,this._touchedCell),r.tableCellTouched&&r.tableCellTouched(this,this._touchedCell)),this._touchedCell=null}cc.ScrollView.prototype.onTouchEnded.call(this,t,e)}},onTouchBegan:function(t,e){for(var i=this;null!=i;i=i.parent)if(!i.isVisible())return!1;var n=cc.ScrollView.prototype.onTouchBegan.call(this,t,e);if(1===this._touches.length){var r,o;o=this.getContainer().convertTouchToNodeSpace(t),r=this._indexFromOffset(o),r===cc.INVALID_INDEX?this._touchedCell=null:this._touchedCell=this.cellAtIndex(r),this._touchedCell&&null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)}else this._touchedCell&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null);return n},onTouchMoved:function(t,e){cc.ScrollView.prototype.onTouchMoved.call(this,t,e),this._touchedCell&&this.isTouchMoved()&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},onTouchCancelled:function(t,e){cc.ScrollView.prototype.onTouchCancelled.call(this,t,e),this._touchedCell&&(null!==this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)}});var _p=cc.TableView.prototype;_p.dataSource,cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.verticalFillOrder,cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder),_p=null,cc.TableView.create=function(t,e,i){return new cc.TableView(t,e,i)};!function(){cc.ScrollView.WebGLRenderCmd=function(t){cc.Layer.WebGLRenderCmd.call(this,t),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.endCmd=new cc.CustomRenderCmd(this,this._endCmd)};var t=cc.ScrollView.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);t.constructor=cc.ScrollView.WebGLRenderCmd,t._startCmd=function(){var t=this._node,e=cc.view,i=t._getViewRect();if(e.isScissorEnabled()){if(t._scissorRestored=!0,t._parentScissorRect=e.getScissorRect(),cc.rectIntersection(i,t._parentScissorRect)){var n=t._parentScissorRect,r=Math.max(i.x,n.x),o=Math.max(i.y,n.y),s=Math.min(i.x+i.width,n.x+n.width),c=Math.min(i.y+i.height,n.y+n.height);e.setScissorInPoints(r,o,s-r,c-o)}}else{var a=cc._renderContext;a.enable(a.SCISSOR_TEST),e.setScissorInPoints(i.x,i.y,i.width,i.height)}},t._endCmd=function(){var t=this._node;if(t._scissorRestored){var e=t._parentScissorRect;cc.view.setScissorInPoints(e.x,e.y,e.width,e.height)}else{var i=cc._renderContext;i.disable(i.SCISSOR_TEST)}},t.visit=function(t){var e=this._node;if(e._visible){var i,n,r,o=e._children;if(this._syncStatus(t),e._clippingToBounds&&cc.renderer.pushRenderCommand(this.startCmd),o&&o.length>0){for(r=o.length,i=0;i<r&&(n=o[i],n&&n._localZOrder<0);i++)n._renderCmd.visit();for(;i<r;i++)o[i]._renderCmd.visit()}e._clippingToBounds&&cc.renderer.pushRenderCommand(this.endCmd),this._dirtyFlag=0}}}();function BlockData(t,e){this.selMenuHander=t,this.target=e}function BlockCCControlData(t,e,i){this.selCCControlHandler=t,this.target=e,this.controlEvents=i}var PROPERTY_POSITION="position",PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SKEW="skew",PROPERTY_ANCHORPOINT="anchorPoint",PROPERTY_SCALE="scale",PROPERTY_ROTATION="rotation",PROPERTY_TAG="tag",PROPERTY_IGNOREANCHORPOINTFORPOSITION="ignoreAnchorPointForPosition",PROPERTY_VISIBLE="visible",ASSERT_FAIL_UNEXPECTED_PROPERTY=function(t){cc.log("Unexpected property: '"+t+"'!")},ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE=function(t){cc.log("Unexpected property type: '"+t+"'!")};cc.NodeLoader=cc.Class.extend({_customProperties:null,ctor:function(){this._customProperties=new cc._Dictionary},loadCCNode:function(t,e){return this._createCCNode(t,e)},parseProperties:function(t,e,i){for(var n=i.readInt(!1),r=i.readInt(!1),o=n+r,s=0;s<o;s++){var c=s>=n,a=i.readInt(!1),l=i.readCachedString(),h=!1,u=i.readByte();if(u!==CCB_PLATFORM_ALL&&u!==CCB_PLATFORM_IOS&&u!==CCB_PLATFORM_MAC||(h=!0),t instanceof cc.BuilderFile){if(t.getCCBFileNode()&&c){t=t.getCCBFileNode();var d=t.userObject;h=d.indexOf(l)!==-1}}else if(c&&t===i.getAnimationManager().getRootNode()){var _=t.userObject;_||(_=[],t.userObject=_),_.push(l)}switch(a){case CCB_PROPTYPE_POSITION:var p=this.parsePropTypePosition(t,e,i,l);h&&this.onHandlePropTypePosition(t,e,l,p,i);break;case CCB_PROPTYPE_POINT:var f=this.parsePropTypePoint(t,e,i);h&&this.onHandlePropTypePoint(t,e,l,f,i);break;case CCB_PROPTYPE_POINTLOCK:var m=this.parsePropTypePointLock(t,e,i);h&&this.onHandlePropTypePointLock(t,e,l,m,i);break;case CCB_PROPTYPE_SIZE:var g=this.parsePropTypeSize(t,e,i);h&&this.onHandlePropTypeSize(t,e,l,g,i);break;case CCB_PROPTYPE_SCALELOCK:var y=this.parsePropTypeScaleLock(t,e,i,l);h&&this.onHandlePropTypeScaleLock(t,e,l,y,i);break;case CCB_PROPTYPE_FLOATXY:var v=this.parsePropTypeFloatXY(t,e,i);h&&this.onHandlePropTypeFloatXY(t,e,l,v,i);break;case CCB_PROPTYPE_FLOAT:var T=this.parsePropTypeFloat(t,e,i);h&&this.onHandlePropTypeFloat(t,e,l,T,i);break;case CCB_PROPTYPE_DEGREES:var C=this.parsePropTypeDegrees(t,e,i,l);h&&this.onHandlePropTypeDegrees(t,e,l,C,i);break;case CCB_PROPTYPE_FLOATSCALE:var S=this.parsePropTypeFloatScale(t,e,i);h&&this.onHandlePropTypeFloatScale(t,e,l,S,i);break;case CCB_PROPTYPE_INTEGER:var x=this.parsePropTypeInteger(t,e,i);h&&this.onHandlePropTypeInteger(t,e,l,x,i);break;case CCB_PROPTYPE_INTEGERLABELED:var A=this.parsePropTypeIntegerLabeled(t,e,i);h&&this.onHandlePropTypeIntegerLabeled(t,e,l,A,i);break;case CCB_PROPTYPE_FLOATVAR:var E=this.parsePropTypeFloatVar(t,e,i);h&&this.onHandlePropTypeFloatVar(t,e,l,E,i);break;case CCB_PROPTYPE_CHECK:var b=this.parsePropTypeCheck(t,e,i,l);h&&this.onHandlePropTypeCheck(t,e,l,b,i);break;case CCB_PROPTYPE_SPRITEFRAME:var R=this.parsePropTypeSpriteFrame(t,e,i,l);h&&this.onHandlePropTypeSpriteFrame(t,e,l,R,i);break;case CCB_PROPTYPE_ANIMATION:var P=this.parsePropTypeAnimation(t,e,i);h&&this.onHandlePropTypeAnimation(t,e,l,P,i);break;case CCB_PROPTYPE_TEXTURE:var w=this.parsePropTypeTexture(t,e,i);h&&this.onHandlePropTypeTexture(t,e,l,w,i);break;case CCB_PROPTYPE_BYTE:var I=this.parsePropTypeByte(t,e,i,l);h&&this.onHandlePropTypeByte(t,e,l,I,i);break;case CCB_PROPTYPE_COLOR3:var D=this.parsePropTypeColor3(t,e,i,l);h&&this.onHandlePropTypeColor3(t,e,l,D,i);break;case CCB_PROPTYPE_COLOR4VAR:var L=this.parsePropTypeColor4FVar(t,e,i);h&&this.onHandlePropTypeColor4FVar(t,e,l,L,i);break;case CCB_PROPTYPE_FLIP:var O=this.parsePropTypeFlip(t,e,i);h&&this.onHandlePropTypeFlip(t,e,l,O,i);break;case CCB_PROPTYPE_BLENDMODE:var B=this.parsePropTypeBlendFunc(t,e,i);h&&this.onHandlePropTypeBlendFunc(t,e,l,B,i);break;case CCB_PROPTYPE_FNTFILE:var N=i.getCCBRootPath()+this.parsePropTypeFntFile(t,e,i);h&&this.onHandlePropTypeFntFile(t,e,l,N,i);break;case CCB_PROPTYPE_FONTTTF:var F=this.parsePropTypeFontTTF(t,e,i);h&&this.onHandlePropTypeFontTTF(t,e,l,F,i);break;case CCB_PROPTYPE_STRING:var M=this.parsePropTypeString(t,e,i);h&&this.onHandlePropTypeString(t,e,l,M,i);break;case CCB_PROPTYPE_TEXT:var V=this.parsePropTypeText(t,e,i);h&&this.onHandlePropTypeText(t,e,l,V,i);break;case CCB_PROPTYPE_BLOCK:var k=this.parsePropTypeBlock(t,e,i);h&&this.onHandlePropTypeBlock(t,e,l,k,i);break;case CCB_PROPTYPE_BLOCKCCCONTROL:var G=this.parsePropTypeBlockCCControl(t,e,i);h&&null!=G&&this.onHandlePropTypeBlockCCControl(t,e,l,G,i);break;case CCB_PROPTYPE_CCBFILE:var W=this.parsePropTypeCCBFile(t,e,i);h&&this.onHandlePropTypeCCBFile(t,e,l,W,i);break;default:ASSERT_FAIL_UNEXPECTED_PROPERTYTYPE(a)}}},getCustomProperties:function(){return this._customProperties},_createCCNode:function(t,e){return new cc.Node},parsePropTypePosition:function(t,e,i,n){var r=i.readFloat(),o=i.readFloat(),s=i.readInt(!1),c=i.getAnimationManager().getContainerSize(e),a=cc._getAbsolutePosition(r,o,s,c,n);if(t.setPosition(cc.getAbsolutePosition(a,s,c,n)),i.getAnimatedProperties().indexOf(n)>-1){var l=[r,o,s];i.getAnimationManager().setBaseValue(l,t,n)}return a},parsePropTypePoint:function(t,e,i){var n=i.readFloat(),r=i.readFloat();return cc.p(n,r)},parsePropTypePointLock:function(t,e,i){var n=i.readFloat(),r=i.readFloat();return cc.p(n,r)},parsePropTypeSize:function(t,e,i){var n=i.readFloat(),r=i.readFloat(),o=i.readInt(!1),s=i.getAnimationManager().getContainerSize(e);switch(o){case CCB_SIZETYPE_ABSOLUTE:break;case CCB_SIZETYPE_RELATIVE_CONTAINER:n=s.width-n,r=s.height-r;break;case CCB_SIZETYPE_PERCENT:n=s.width*n/100,r=s.height*r/100;break;case CCB_SIZETYPE_HORIZONTAL_PERCENT:n=s.width*n/100;break;case CCB_SIZETYPE_VERTICAL_PERCENT:r=s.height*r/100;break;case CCB_SIZETYPE_MULTIPLY_RESOLUTION:var c=cc.BuilderReader.getResolutionScale();n*=c,r*=c;break;default:cc.log("Unknown CCB type.")}return cc.size(n,r)},parsePropTypeScaleLock:function(t,e,i,n){var r=i.readFloat(),o=i.readFloat(),s=i.readInt(!1);return cc.setRelativeScale(t,r,o,s,n),i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue([r,o,s],t,n),s===CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(r*=cc.BuilderReader.getResolutionScale(),o*=cc.BuilderReader.getResolutionScale()),[r,o]},parsePropTypeFloat:function(t,e,i){return i.readFloat()},parsePropTypeDegrees:function(t,e,i,n){var r=i.readFloat();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,t,n),r},parsePropTypeFloatScale:function(t,e,i){var n=i.readFloat(),r=i.readInt(!1);return r===CCB_SCALETYPE_MULTIPLY_RESOLUTION&&(n*=cc.BuilderReader.getResolutionScale()),n},parsePropTypeInteger:function(t,e,i){return i.readInt(!0)},parsePropTypeIntegerLabeled:function(t,e,i){return i.readInt(!0)},parsePropTypeFloatVar:function(t,e,i){var n=i.readFloat(),r=i.readFloat();return[n,r]},parsePropTypeCheck:function(t,e,i,n){var r=i.readBool();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,t,n),r},parsePropTypeSpriteFrame:function(t,e,i,n){var r,o=i.readCachedString(),s=i.readCachedString();if(null!=s&&0!==s.length){if(0===o.length){s=i.getCCBRootPath()+s;var c=cc.textureCache.addImage(s),a=c.getContentSize(),l=cc.rect(0,0,a.width,a.height);r=new cc.SpriteFrame(c,l)}else{var h=cc.spriteFrameCache;o=i.getCCBRootPath()+o,i.getLoadedSpriteSheet().indexOf(o)===-1&&(h.addSpriteFrames(o),i.getLoadedSpriteSheet().push(o)),r=h.getSpriteFrame(s)}i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,t,n)}return r},parsePropTypeAnimation:function(t,e,i){var n=i.getCCBRootPath()+i.readCachedString(),r=i.readCachedString(),o=null;if(r=cc.BuilderReader.lastPathComponent(r),n=cc.BuilderReader.lastPathComponent(n),null!=r&&""!==r){var s=cc.animationCache;s.addAnimations(n),o=s.getAnimation(r)}return o},parsePropTypeTexture:function(t,e,i){var n=i.getCCBRootPath()+i.readCachedString();return""!==n?cc.textureCache.addImage(n):null},parsePropTypeByte:function(t,e,i,n){var r=i.readByte();return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(r,t,n),r},parsePropTypeColor3:function(t,e,i,n){var r=i.readByte(),o=i.readByte(),s=i.readByte(),c={r:r,g:o,b:s};return i.getAnimatedProperties().indexOf(n)>-1&&i.getAnimationManager().setBaseValue(cc.Color3BWapper.create(c),t,n),c},parsePropTypeColor4FVar:function(t,e,i){var n=0|255*i.readFloat(),r=0|255*i.readFloat(),o=0|255*i.readFloat(),s=i.readFloat();s=s<=1?0|255*s:s;var c=0|255*i.readFloat(),a=0|255*i.readFloat(),l=0|255*i.readFloat(),h=i.readFloat();h=h<=1?0|255*h:h;var u=[];return u[0]={r:n,g:r,b:o,a:s},u[1]={r:c,g:a,b:l,a:h},u},parsePropTypeFlip:function(t,e,i){var n=i.readBool(),r=i.readBool();return[n,r]},parsePropTypeBlendFunc:function(t,e,i){var n=i.readInt(!1),r=i.readInt(!1);return new cc.BlendFunc(n,r)},parsePropTypeFntFile:function(t,e,i){return i.readCachedString()},parsePropTypeString:function(t,e,i){return i.readCachedString()},parsePropTypeText:function(t,e,i){return i.readCachedString()},parsePropTypeFontTTF:function(t,e,i){return i.readCachedString()},parsePropTypeBlock:function(t,e,i){var n=i.readCachedString(),r=i.readInt(!1);if(r!==CCB_TARGETTYPE_NONE){var o=null;if(i.isJSControlled())r===CCB_TARGETTYPE_DOCUMENTROOT?(i.addDocumentCallbackNode(t),i.addDocumentCallbackName(n),i.addDocumentCallbackControlEvents(0)):(i.addOwnerCallbackNode(t),i.addOwnerCallbackName(n),i.addOwnerCallbackControlEvents(0));else if(r===CCB_TARGETTYPE_DOCUMENTROOT?o=i.getAnimationManager().getRootNode():r===CCB_TARGETTYPE_OWNER&&(o=i.getOwner()),null!==o)if(n.length>0){var s=0;if(o.onResolveCCBCCMenuItemSelector&&(s=o.onResolveCCBCCMenuItemSelector(o,n)),0===s){var c=i.getCCBSelectorResolver();null!=c&&(s=c.onResolveCCBCCMenuItemSelector(o,n))}if(0!==s)return new BlockData(s,o);cc.log("Skipping selector '"+n+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeBlockCCControl:function(t,e,i){var n=i.readCachedString(),r=i.readInt(!1),o=i.readInt(!1);if(r!==CCB_TARGETTYPE_NONE)if(i.isJSControlled())r===CCB_TARGETTYPE_DOCUMENTROOT?(i.addDocumentCallbackNode(t),i.addDocumentCallbackName(n),i.addDocumentCallbackControlEvents(o)):(i.addOwnerCallbackNode(t),i.addOwnerCallbackName(n),i.addOwnerCallbackControlEvents(o));else{var s=null;if(r===CCB_TARGETTYPE_DOCUMENTROOT?s=i.getAnimationManager().getRootNode():r===CCB_TARGETTYPE_OWNER&&(s=i.getOwner()),null!==s)if(n.length>0){var c=0;if(s.onResolveCCBCCControlSelector&&(c=s.onResolveCCBCCControlSelector(s,n)),0===c){var a=i.getCCBSelectorResolver();null!=a&&(c=a.onResolveCCBCCControlSelector(s,n))}if(0!==c)return new BlockCCControlData(c,s,o);cc.log("Skipping selector '"+n+"' since no CCBSelectorResolver is present.")}else cc.log("Unexpected empty selector.");else cc.log("Unexpected NULL target for selector.")}return null},parsePropTypeCCBFile:function(t,e,i){var n=i.getCCBRootPath()+i.readCachedString(),r=cc.BuilderReader.deletePathExtension(n);n=r+".ccbi";var o=new cc.BuilderReader(i),s=cc.loader.getRes(n);if(!s){var c=cc.loader.getUrl(n);s=cc.loader.loadBinarySync(c),cc.loader.cache[n]=s}o.initWithData(s,i.getOwner()),o.getAnimationManager().setRootContainerSize(e.getContentSize()),o.setAnimationManagers(i.getAnimationManagers()),o.getAnimationManager().setOwner(i.getOwner());var a=o.readFileWithCleanUp(!1);return i.setAnimationManagers(o.getAnimationManagers()),a&&o.getAnimationManager().getAutoPlaySequenceId()!==-1&&o.getAnimationManager().runAnimations(o.getAnimationManager().getAutoPlaySequenceId(),0),a},parsePropTypeFloatXY:function(t,e,i){var n=i.readFloat(),r=i.readFloat();return[n,r]},onHandlePropTypePosition:function(t,e,i,n,r){i===PROPERTY_POSITION?t.setPosition(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypePoint:function(t,e,i,n,r){i===PROPERTY_ANCHORPOINT?t.setAnchorPoint(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypePointLock:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeSize:function(t,e,i,n,r){i===PROPERTY_CONTENTSIZE?t.setContentSize(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeScaleLock:function(t,e,i,n,r){i===PROPERTY_SCALE?(t.setScaleX(n[0]),t.setScaleY(n[1])):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatXY:function(t,e,i,n,r){if(i===PROPERTY_SKEW)t.setSkewX(n[0]),t.setSkewY(n[1]);else{var o=i+"X",s=i+"Y";t[o]&&t[s]||ASSERT_FAIL_UNEXPECTED_PROPERTY(i),t[o](n[0]),t[s](n[1])}},onHandlePropTypeFloat:function(t,e,i,n,r){this._customProperties.setObject(n,i)},onHandlePropTypeDegrees:function(t,e,i,n,r){i===PROPERTY_ROTATION?t.setRotation(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatScale:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeInteger:function(t,e,i,n,r){i===PROPERTY_TAG?t.setTag(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeIntegerLabeled:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFloatVar:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_VISIBLE?t.setVisible(n):i===PROPERTY_IGNOREANCHORPOINTFORPOSITION?t.ignoreAnchorPointForPosition(n):ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeSpriteFrame:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeAnimation:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeTexture:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeByte:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeColor3:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeColor4FVar:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFlip:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFntFile:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeString:function(t,e,i,n,r){this._customProperties.setObject(n,i)},onHandlePropTypeText:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeFontTTF:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlock:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeBlockCCControl:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)},onHandlePropTypeCCBFile:function(t,e,i,n,r){ASSERT_FAIL_UNEXPECTED_PROPERTY(i)}}),cc.NodeLoader.loader=function(){return new cc.NodeLoader},cc.NodeLoaderListener=cc.Class.extend({onNodeLoaded:function(t,e){}}),cc.BuilderSelectorResolver=cc.Class.extend({onResolveCCBCCMenuItemSelector:function(t,e){},onResolveCCBCCCallFuncSelector:function(t,e){},onResolveCCBCCControlSelector:function(t,e){}}),cc.BuilderScriptOwnerProtocol=cc.Class.extend({createNew:function(){}}),cc.BuilderMemberVariableAssigner=cc.Class.extend({onAssignCCBMemberVariable:function(t,e,i){return!1},onAssignCCBCustomProperty:function(t,e,i){return!1}});var PROPERTY_CCBFILE="ccbFile";cc.BuilderFileLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return cc.BuilderFile.create()},onHandlePropTypeCCBFile:function(t,e,i,n,r){i===PROPERTY_CCBFILE?t.setCCBFileNode(n):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,t,e,i,n,r)}}),cc.BuilderFileLoader.loader=function(){return new cc.BuilderFileLoader};var PROPERTY_ENABLED="enabled",PROPERTY_SELECTED="selected",PROPERTY_CCCONTROL="ccControl";cc.ControlLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){},onHandlePropTypeBlockCCControl:function(t,e,i,n,r){i===PROPERTY_CCCONTROL?t.addTargetWithActionForControlEvents(n.target,n.selCCControlHandler,n.controlEvents):cc.NodeLoader.prototype.onHandlePropTypeBlockCCControl.call(this,t,e,i,n,r)},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_ENABLED?t.setEnabled(n):i===PROPERTY_SELECTED?t.setSelected(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,t,e,i,n,r)}});var PROPERTY_ZOOMONTOUCHDOWN="zoomOnTouchDown",PROPERTY_TITLE_NORMAL="title|1",PROPERTY_TITLE_HIGHLIGHTED="title|2",PROPERTY_TITLE_DISABLED="title|3",PROPERTY_TITLECOLOR_NORMAL="titleColor|1",PROPERTY_TITLECOLOR_HIGHLIGHTED="titleColor|2",PROPERTY_TITLECOLOR_DISABLED="titleColor|3",PROPERTY_TITLETTF_NORMAL="titleTTF|1",PROPERTY_TITLETTF_HIGHLIGHTED="titleTTF|2",PROPERTY_TITLETTF_DISABLED="titleTTF|3",PROPERTY_TITLETTFSIZE_NORMAL="titleTTFSize|1",PROPERTY_TITLETTFSIZE_HIGHLIGHTED="titleTTFSize|2",PROPERTY_TITLETTFSIZE_DISABLED="titleTTFSize|4",PROPERTY_LABELANCHORPOINT="labelAnchorPoint",PROPERTY_PREFEREDSIZE="preferedSize",PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL="backgroundSpriteFrame|1",PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED="backgroundSpriteFrame|2",PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED="backgroundSpriteFrame|3";cc.ControlButtonLoader=cc.ControlLoader.extend({_createCCNode:function(t,e){return new cc.ControlButton},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_ZOOMONTOUCHDOWN?t.setZoomOnTouchDown(n):cc.ControlLoader.prototype.onHandlePropTypeCheck.call(this,t,e,i,n,r)},onHandlePropTypeString:function(t,e,i,n,r){i===PROPERTY_TITLE_NORMAL?t.setTitleForState(n,cc.CONTROL_STATE_NORMAL):i===PROPERTY_TITLE_HIGHLIGHTED?t.setTitleForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i===PROPERTY_TITLE_DISABLED?t.setTitleForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeString.call(this,t,e,i,n,r)},onHandlePropTypeFontTTF:function(t,e,i,n,r){i===PROPERTY_TITLETTF_NORMAL?t.setTitleTTFForState(n,cc.CONTROL_STATE_NORMAL):i===PROPERTY_TITLETTF_HIGHLIGHTED?t.setTitleTTFForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i===PROPERTY_TITLETTF_DISABLED?t.setTitleTTFForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFontTTF.call(this,t,e,i,n,r)},onHandlePropTypeFloatScale:function(t,e,i,n,r){i===PROPERTY_TITLETTFSIZE_NORMAL?t.setTitleTTFSizeForState(n,cc.CONTROL_STATE_NORMAL):i===PROPERTY_TITLETTFSIZE_HIGHLIGHTED?t.setTitleTTFSizeForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i===PROPERTY_TITLETTFSIZE_DISABLED?t.setTitleTTFSizeForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeFloatScale.call(this,t,e,i,n,r)},onHandlePropTypePoint:function(t,e,i,n,r){i===PROPERTY_LABELANCHORPOINT?t.setLabelAnchorPoint(n):cc.ControlLoader.prototype.onHandlePropTypePoint.call(this,t,e,i,n,r)},onHandlePropTypeSize:function(t,e,i,n,r){i===PROPERTY_PREFEREDSIZE?t.setPreferredSize(n):cc.ControlLoader.prototype.onHandlePropTypeSize.call(this,t,e,i,n,r)},onHandlePropTypeSpriteFrame:function(t,e,i,n,r){i===PROPERTY_BACKGROUNDSPRITEFRAME_NORMAL?null!=n&&t.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_NORMAL):i===PROPERTY_BACKGROUNDSPRITEFRAME_HIGHLIGHTED?null!=n&&t.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i===PROPERTY_BACKGROUNDSPRITEFRAME_DISABLED?null!=n&&t.setBackgroundSpriteFrameForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeSpriteFrame.call(this,t,e,i,n,r)},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_TITLECOLOR_NORMAL?t.setTitleColorForState(n,cc.CONTROL_STATE_NORMAL):i===PROPERTY_TITLECOLOR_HIGHLIGHTED?t.setTitleColorForState(n,cc.CONTROL_STATE_HIGHLIGHTED):i===PROPERTY_TITLECOLOR_DISABLED?t.setTitleColorForState(n,cc.CONTROL_STATE_DISABLED):cc.ControlLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)}}),cc.ControlButtonLoader.loader=function(){return new cc.ControlButtonLoader};var PROPERTY_CONTAINER="container",PROPERTY_DIRECTION="direction",PROPERTY_CLIPSTOBOUNDS="clipsToBounds",PROPERTY_BOUNCES="bounces",PROPERTY_SCALE="scale";cc.ScrollViewLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return new cc.ScrollView},onHandlePropTypeSize:function(t,e,i,n,r){i===PROPERTY_CONTENTSIZE?t.setViewSize(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,t,e,i,n,r)},onHandlePropTypeCCBFile:function(t,e,i,n,r){i===PROPERTY_CONTAINER?(t.setContainer(n),t.updateInset()):cc.NodeLoader.prototype.onHandlePropTypeCCBFile.call(this,t,e,i,n,r)},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_CLIPSTOBOUNDS?t.setClippingToBounds(n):i===PROPERTY_BOUNCES?t.setBounceable(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,t,e,i,n,r)},onHandlePropTypeFloat:function(t,e,i,n,r){i===PROPERTY_SCALE?t.setScale(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,t,e,i,n,r)},onHandlePropTypeIntegerLabeled:function(t,e,i,n,r){i===PROPERTY_DIRECTION?t.setDirection(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,t,e,i,n,r)}}),cc.ScrollViewLoader.loader=function(){return new cc.ScrollViewLoader};var PROPERTY_CONTENTSIZE="contentSize",PROPERTY_SPRITEFRAME="spriteFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc",PROPERTY_INSETLEFT="insetLeft",PROPERTY_INSETTOP="insetTop",PROPERTY_INSETRIGHT="insetRight",PROPERTY_INSETBOTTOM="insetBottom";cc.Scale9SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){var i=new cc.Scale9Sprite;return i.setAnchorPoint(0,0),i},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||t.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_OPACITY?t.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC||cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)},onHandlePropTypeSpriteFrame:function(t,e,i,n,r){i===PROPERTY_SPRITEFRAME?t.setSpriteFrame(n):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,t,e,i,n,r)},onHandlePropTypeSize:function(t,e,i,n,r){i===PROPERTY_CONTENTSIZE||(i===PROPERTY_PREFEREDSIZE?t.setPreferredSize(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,t,e,i,n,r))},onHandlePropTypeFloat:function(t,e,i,n,r){i===PROPERTY_INSETLEFT?t.setInsetLeft(n):i===PROPERTY_INSETTOP?t.setInsetTop(n):i===PROPERTY_INSETRIGHT?t.setInsetRight(n):i===PROPERTY_INSETBOTTOM?t.setInsetBottom(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,t,e,i,n,r)}}),cc.Scale9SpriteLoader.loader=function(){return new cc.Scale9SpriteLoader};var PROPERTY_FLIP="flip",PROPERTY_DISPLAYFRAME="displayFrame",PROPERTY_COLOR="color",PROPERTY_OPACITY="opacity",PROPERTY_BLENDFUNC="blendFunc";cc.SpriteLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return new cc.Sprite},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||t.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_OPACITY?t.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)},onHandlePropTypeSpriteFrame:function(t,e,i,n,r){i===PROPERTY_DISPLAYFRAME?n?t.setSpriteFrame(n):cc.log("ERROR: SpriteFrame is null"):cc.NodeLoader.prototype.onHandlePropTypeSpriteFrame.call(this,t,e,i,n,r)},onHandlePropTypeFlip:function(t,e,i,n,r){i===PROPERTY_FLIP?(t.setFlippedX(n[0]),t.setFlippedY(n[1])):cc.NodeLoader.prototype.onHandlePropTypeFlip.call(this,t,e,i,n,r)}}),cc.SpriteLoader.loader=function(){return new cc.SpriteLoader};var PROPERTY_TOUCH_ENABLED="touchEnabled",PROPERTY_IS_TOUCH_ENABLED="isTouchEnabled",PROPERTY_ACCELEROMETER_ENABLED="accelerometerEnabled",PROPERTY_IS_ACCELEROMETER_ENABLED="isAccelerometerEnabled",PROPERTY_IS_MOUSE_ENABLED="isMouseEnabled",PROPERTY_MOUSE_ENABLED="mouseEnabled",PROPERTY_KEYBOARD_ENABLED="keyboardEnabled",PROPERTY_IS_KEYBOARD_ENABLED="isKeyboardEnabled";cc.LayerLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){var i=new cc.Layer;return i.setContentSize(0,0),i},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_TOUCH_ENABLED||i===PROPERTY_IS_TOUCH_ENABLED||i===PROPERTY_ACCELEROMETER_ENABLED||i===PROPERTY_IS_ACCELEROMETER_ENABLED||i===PROPERTY_MOUSE_ENABLED||i===PROPERTY_IS_MOUSE_ENABLED||(i===PROPERTY_KEYBOARD_ENABLED||i===PROPERTY_IS_KEYBOARD_ENABLED?t.setKeyboardEnabled&&!cc.sys.isNative?t.setKeyboardEnabled(n):cc.log("The property '"+PROPERTY_IS_KEYBOARD_ENABLED+"' is not supported!"):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,t,e,i,n,r))}}),cc.LayerLoader.loader=function(){return new cc.LayerLoader},cc.LayerColorLoader=cc.LayerLoader.extend({_createCCNode:function(t,e){return new cc.LayerColor},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_COLOR?t.setColor(n):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_OPACITY?t.setOpacity(n):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)}}),cc.LayerColorLoader.loader=function(){return new cc.LayerColorLoader};var PROPERTY_STARTCOLOR="startColor",PROPERTY_ENDCOLOR="endColor",PROPERTY_STARTOPACITY="startOpacity",PROPERTY_ENDOPACITY="endOpacity",PROPERTY_VECTOR="vector";cc.LayerGradientLoader=cc.LayerLoader.extend({_createCCNode:function(t,e){return new cc.LayerGradient},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_STARTCOLOR?t.setStartColor(n):i===PROPERTY_ENDCOLOR?t.setEndColor(n):cc.LayerLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_STARTOPACITY?t.setStartOpacity(n):i===PROPERTY_ENDOPACITY?t.setEndOpacity(n):cc.LayerLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypePoint:function(t,e,i,n,r){i===PROPERTY_VECTOR?t.setVector(n):cc.LayerLoader.prototype.onHandlePropTypePoint.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.LayerLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)}}),cc.LayerGradientLoader.loader=function(){return new cc.LayerGradientLoader},cc.MenuLoader=cc.LayerLoader.extend({_createCCNode:function(t,e){var i=new cc.Menu;return i.setContentSize(0,0),i}}),cc.MenuLoader.loader=function(){return new cc.MenuLoader};var PROPERTY_BLOCK="block",PROPERTY_ISENABLED="isEnabled";cc.MenuItemLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return null},onHandlePropTypeBlock:function(t,e,i,n,r){i===PROPERTY_BLOCK?null!=n&&t.setTarget(n.selMenuHander,n.target):cc.NodeLoader.prototype.onHandlePropTypeBlock.call(this,t,e,i,n,r)},onHandlePropTypeCheck:function(t,e,i,n,r){i===PROPERTY_ISENABLED?t.setEnabled(n):cc.NodeLoader.prototype.onHandlePropTypeCheck.call(this,t,e,i,n,r)}});var PROPERTY_NORMALDISPLAYFRAME="normalSpriteFrame",PROPERTY_SELECTEDDISPLAYFRAME="selectedSpriteFrame",PROPERTY_DISABLEDDISPLAYFRAME="disabledSpriteFrame";cc.MenuItemImageLoader=cc.MenuItemLoader.extend({_createCCNode:function(t,e){return new cc.MenuItemImage},onHandlePropTypeSpriteFrame:function(t,e,i,n,r){i===PROPERTY_NORMALDISPLAYFRAME?null!=n&&t.setNormalSpriteFrame(n):i===PROPERTY_SELECTEDDISPLAYFRAME?null!=n&&t.setSelectedSpriteFrame(n):i===PROPERTY_DISABLEDDISPLAYFRAME?null!=n&&t.setDisabledSpriteFrame(n):cc.MenuItemLoader.prototype.onHandlePropTypeSpriteFrame.call(this,t,e,i,n,r)}}),cc.MenuItemImageLoader.loader=function(){return new cc.MenuItemImageLoader};var PROPERTY_FONTNAME="fontName",PROPERTY_FONTSIZE="fontSize",PROPERTY_HORIZONTALALIGNMENT="horizontalAlignment",PROPERTY_VERTICALALIGNMENT="verticalAlignment",PROPERTY_STRING="string",PROPERTY_DIMENSIONS="dimensions";cc.LabelTTFLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return new cc.LabelTTF},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||t.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_OPACITY?t.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)},onHandlePropTypeFontTTF:function(t,e,i,n,r){i===PROPERTY_FONTNAME?t.setFontName(n):cc.NodeLoader.prototype.onHandlePropTypeFontTTF.call(this,t,e,i,n,r)},onHandlePropTypeText:function(t,e,i,n,r){i===PROPERTY_STRING?t.setString(n):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,t,e,i,n,r)},onHandlePropTypeFloatScale:function(t,e,i,n,r){i===PROPERTY_FONTSIZE?t.setFontSize(n):cc.NodeLoader.prototype.onHandlePropTypeFloatScale.call(this,t,e,i,n,r)},onHandlePropTypeIntegerLabeled:function(t,e,i,n,r){i===PROPERTY_HORIZONTALALIGNMENT?t.setHorizontalAlignment(n):i===PROPERTY_VERTICALALIGNMENT?t.setVerticalAlignment(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,t,e,i,n,r)},onHandlePropTypeSize:function(t,e,i,n,r){i===PROPERTY_DIMENSIONS?t.setDimensions(n):cc.NodeLoader.prototype.onHandlePropTypeSize.call(this,t,e,i,n,r)}}),cc.LabelTTFLoader.loader=function(){return new cc.LabelTTFLoader};var PROPERTY_FNTFILE="fntFile";cc.LabelBMFontLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return new cc.LabelBMFont},onHandlePropTypeColor3:function(t,e,i,n,r){i===PROPERTY_COLOR?255===n.r&&255===n.g&&255===n.b||t.setColor(n):cc.NodeLoader.prototype.onHandlePropTypeColor3.call(this,t,e,i,n,r)},onHandlePropTypeByte:function(t,e,i,n,r){i===PROPERTY_OPACITY?t.setOpacity(n):cc.NodeLoader.prototype.onHandlePropTypeByte.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)},onHandlePropTypeFntFile:function(t,e,i,n,r){i===PROPERTY_FNTFILE?t.setFntFile(n):cc.NodeLoader.prototype.onHandlePropTypeFntFile.call(this,t,e,i,n,r)},onHandlePropTypeText:function(t,e,i,n,r){i===PROPERTY_STRING?t.setString(n):cc.NodeLoader.prototype.onHandlePropTypeText.call(this,t,e,i,n,r)}}),cc.LabelBMFontLoader.loader=function(){return new cc.LabelBMFontLoader};var PROPERTY_EMITERMODE="emitterMode",PROPERTY_POSVAR="posVar",PROPERTY_EMISSIONRATE="emissionRate",PROPERTY_DURATION="duration",PROPERTY_TOTALPARTICLES="totalParticles",PROPERTY_LIFE="life",PROPERTY_STARTSIZE="startSize",PROPERTY_ENDSIZE="endSize",PROPERTY_STARTSPIN="startSpin",PROPERTY_ENDSPIN="endSpin",PROPERTY_ANGLE="angle",PROPERTY_GRAVITY="gravity",PROPERTY_SPEED="speed",PROPERTY_TANGENTIALACCEL="tangentialAccel",PROPERTY_RADIALACCEL="radialAccel",PROPERTY_TEXTURE="texture",PROPERTY_STARTRADIUS="startRadius",PROPERTY_ENDRADIUS="endRadius",PROPERTY_ROTATEPERSECOND="rotatePerSecond";cc.ParticleSystemLoader=cc.NodeLoader.extend({_createCCNode:function(t,e){return new cc.ParticleSystem},onHandlePropTypeIntegerLabeled:function(t,e,i,n,r){i===PROPERTY_EMITERMODE?t.setEmitterMode(n):cc.NodeLoader.prototype.onHandlePropTypeIntegerLabeled.call(this,t,e,i,n,r)},onHandlePropTypePoint:function(t,e,i,n,r){i===PROPERTY_POSVAR?t.setPosVar(n):i===PROPERTY_GRAVITY?t.setGravity(n):cc.NodeLoader.prototype.onHandlePropTypePoint.call(this,t,e,i,n,r)},onHandlePropTypeFloat:function(t,e,i,n,r){i===PROPERTY_EMISSIONRATE?t.setEmissionRate(n):i===PROPERTY_DURATION?t.setDuration(n):cc.NodeLoader.prototype.onHandlePropTypeFloat.call(this,t,e,i,n,r)},onHandlePropTypeInteger:function(t,e,i,n,r){i===PROPERTY_TOTALPARTICLES?t.setTotalParticles(n):cc.NodeLoader.prototype.onHandlePropTypeInteger.call(this,t,e,i,n,r)},onHandlePropTypeFloatVar:function(t,e,i,n,r){i===PROPERTY_LIFE?(t.setLife(n[0]),t.setLifeVar(n[1])):i===PROPERTY_STARTSIZE?(t.setStartSize(n[0]),t.setStartSizeVar(n[1])):i===PROPERTY_ENDSIZE?(t.setEndSize(n[0]),t.setEndSizeVar(n[1])):i===PROPERTY_STARTSPIN?(t.setStartSpin(n[0]),t.setStartSpinVar(n[1])):i===PROPERTY_ENDSPIN?(t.setEndSpin(n[0]),t.setEndSpinVar(n[1])):i===PROPERTY_ANGLE?(t.setAngle(n[0]),t.setAngleVar(n[1])):i===PROPERTY_SPEED?(t.setSpeed(n[0]),t.setSpeedVar(n[1])):i===PROPERTY_TANGENTIALACCEL?(t.setTangentialAccel(n[0]),t.setTangentialAccelVar(n[1])):i===PROPERTY_RADIALACCEL?(t.setRadialAccel(n[0]),t.setRadialAccelVar(n[1])):i===PROPERTY_STARTRADIUS?(t.setStartRadius(n[0]),t.setStartRadiusVar(n[1])):i===PROPERTY_ENDRADIUS?(t.setEndRadius(n[0]),t.setEndRadiusVar(n[1])):i===PROPERTY_ROTATEPERSECOND?(t.setRotatePerSecond(n[0]),t.setRotatePerSecondVar(n[1])):cc.NodeLoader.prototype.onHandlePropTypeFloatVar.call(this,t,e,i,n,r)},onHandlePropTypeColor4FVar:function(t,e,i,n,r){i===PROPERTY_STARTCOLOR?(t.setStartColor(n[0]),t.setStartColorVar(n[1])):i===PROPERTY_ENDCOLOR?(t.setEndColor(n[0]),t.setEndColorVar(n[1])):cc.NodeLoader.prototype.onHandlePropTypeColor4FVar.call(this,t,e,i,n,r)},onHandlePropTypeBlendFunc:function(t,e,i,n,r){i===PROPERTY_BLENDFUNC?t.setBlendFunc(n):cc.NodeLoader.prototype.onHandlePropTypeBlendFunc.call(this,t,e,i,n,r)},onHandlePropTypeTexture:function(t,e,i,n,r){i===PROPERTY_TEXTURE?t.setTexture(n):cc.NodeLoader.prototype.onHandlePropTypeTexture.call(this,t,e,i,n,r)}}),cc.ParticleSystemLoader.loader=function(){return new cc.ParticleSystemLoader},cc.NodeLoaderLibrary=cc.Class.extend({_ccNodeLoaders:null,ctor:function(){this._ccNodeLoaders={}},registerDefaultCCNodeLoaders:function(){this.registerCCNodeLoader("CCNode",cc.NodeLoader.loader()),this.registerCCNodeLoader("CCLayer",cc.LayerLoader.loader()),this.registerCCNodeLoader("CCLayerColor",cc.LayerColorLoader.loader()),this.registerCCNodeLoader("CCLayerGradient",cc.LayerGradientLoader.loader()),this.registerCCNodeLoader("CCSprite",cc.SpriteLoader.loader()),this.registerCCNodeLoader("CCLabelBMFont",cc.LabelBMFontLoader.loader()),this.registerCCNodeLoader("CCLabelTTF",cc.LabelTTFLoader.loader()),this.registerCCNodeLoader("CCScale9Sprite",cc.Scale9SpriteLoader.loader()),this.registerCCNodeLoader("CCScrollView",cc.ScrollViewLoader.loader()),this.registerCCNodeLoader("CCBFile",cc.BuilderFileLoader.loader()),this.registerCCNodeLoader("CCMenu",cc.MenuLoader.loader()),this.registerCCNodeLoader("CCMenuItemImage",cc.MenuItemImageLoader.loader()),this.registerCCNodeLoader("CCControlButton",cc.ControlButtonLoader.loader()),this.registerCCNodeLoader("CCParticleSystemQuad",cc.ParticleSystemLoader.loader())},registerCCNodeLoader:function(t,e){this._ccNodeLoaders[t]=e},unregisterCCNodeLoader:function(t){this._ccNodeLoaders[t]&&delete this._ccNodeLoaders[t]},getCCNodeLoader:function(t){return this._ccNodeLoaders[t]?this._ccNodeLoaders[t]:null},purge:function(t){if(t)for(var e in this._ccNodeLoaders)delete this._ccNodeLoaders[e];this._ccNodeLoaders={}}}),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null,cc.NodeLoaderLibrary.library=function(){return new cc.NodeLoaderLibrary},cc.NodeLoaderLibrary.sharedCCNodeLoaderLibrary=function(){return null==cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary&&(cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=new cc.NodeLoaderLibrary,cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary.registerDefaultCCNodeLoaders()),cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary},cc.NodeLoaderLibrary.purgeSharedCCNodeLoaderLibrary=function(){cc.NodeLoaderLibrary.sSharedCCNodeLoaderLibrary=null},cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary=function(){var t=cc.NodeLoaderLibrary.library();return t.registerDefaultCCNodeLoaders(),t};var CCB_VERSION=5,CCB_PROPTYPE_POSITION=0,CCB_PROPTYPE_SIZE=1,CCB_PROPTYPE_POINT=2,CCB_PROPTYPE_POINTLOCK=3,CCB_PROPTYPE_SCALELOCK=4,CCB_PROPTYPE_DEGREES=5,CCB_PROPTYPE_INTEGER=6,CCB_PROPTYPE_FLOAT=7,CCB_PROPTYPE_FLOATVAR=8,CCB_PROPTYPE_CHECK=9,CCB_PROPTYPE_SPRITEFRAME=10,CCB_PROPTYPE_TEXTURE=11,CCB_PROPTYPE_BYTE=12,CCB_PROPTYPE_COLOR3=13,CCB_PROPTYPE_COLOR4VAR=14,CCB_PROPTYPE_FLIP=15,CCB_PROPTYPE_BLENDMODE=16,CCB_PROPTYPE_FNTFILE=17,CCB_PROPTYPE_TEXT=18,CCB_PROPTYPE_FONTTTF=19,CCB_PROPTYPE_INTEGERLABELED=20,CCB_PROPTYPE_BLOCK=21,CCB_PROPTYPE_ANIMATION=22,CCB_PROPTYPE_CCBFILE=23,CCB_PROPTYPE_STRING=24,CCB_PROPTYPE_BLOCKCCCONTROL=25,CCB_PROPTYPE_FLOATSCALE=26,CCB_PROPTYPE_FLOATXY=27,CCB_FLOAT0=0,CCB_FLOAT1=1,CCB_FLOAT_MINUS1=2,CCB_FLOAT05=3,CCB_FLOAT_INTEGER=4,CCB_FLOAT_FULL=5,CCB_PLATFORM_ALL=0,CCB_PLATFORM_IOS=1,CCB_PLATFORM_MAC=2,CCB_TARGETTYPE_NONE=0,CCB_TARGETTYPE_DOCUMENTROOT=1,CCB_TARGETTYPE_OWNER=2,CCB_KEYFRAME_EASING_INSTANT=0,CCB_KEYFRAME_EASING_LINEAR=1,CCB_KEYFRAME_EASING_CUBIC_IN=2,CCB_KEYFRAME_EASING_CUBIC_OUT=3,CCB_KEYFRAME_EASING_CUBIC_INOUT=4,CCB_KEYFRAME_EASING_ELASTIC_IN=5,CCB_KEYFRAME_EASING_ELASTIC_OUT=6,CCB_KEYFRAME_EASING_ELASTIC_INOUT=7,CCB_KEYFRAME_EASING_BOUNCE_IN=8,CCB_KEYFRAME_EASING_BOUNCE_OUT=9,CCB_KEYFRAME_EASING_BOUNCE_INOUT=10,CCB_KEYFRAME_EASING_BACK_IN=11,CCB_KEYFRAME_EASING_BACK_OUT=12,CCB_KEYFRAME_EASING_BACK_INOUT=13,CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT=0,CCB_POSITIONTYPE_RELATIVE_TOP_LEFT=1,CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT=2,CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT=3,CCB_POSITIONTYPE_PERCENT=4,CCB_POSITIONTYPE_MULTIPLY_RESOLUTION=5,CCB_SIZETYPE_ABSOLUTE=0,CCB_SIZETYPE_PERCENT=1,CCB_SIZETYPE_RELATIVE_CONTAINER=2,CCB_SIZETYPE_HORIZONTAL_PERCENT=3,CCB_SIZETYPE_VERTICAL_PERCENT=4,CCB_SIZETYPE_MULTIPLY_RESOLUTION=5,CCB_SCALETYPE_ABSOLUTE=0,CCB_SCALETYPE_MULTIPLY_RESOLUTION=1;cc.BuilderFile=cc.Node.extend({_ccbFileNode:null,getCCBFileNode:function(){return this._ccbFileNode},setCCBFileNode:function(t){this._ccbFileNode=t}}),cc.BuilderFile.create=function(){return new cc.BuilderFile},cc.BuilderReader=cc.Class.extend({_jsControlled:!1,_data:null,_ccbRootPath:"",_bytes:0,_currentByte:0,_currentBit:0,_stringCache:null,_loadedSpriteSheets:null,_owner:null,_animationManager:null,_animationManagers:null,_animatedProps:null,_ccNodeLoaderLibrary:null,_ccNodeLoaderListener:null,_ccbMemberVariableAssigner:null,_ccbSelectorResolver:null,_ownerOutletNames:null,_ownerOutletNodes:null,_nodesWithAnimationManagers:null,_animationManagerForNodes:null,_ownerCallbackNames:null,_ownerCallbackNodes:null,_ownerCallbackEvents:null,_readNodeGraphFromData:!1,ctor:function(t,e,i,n){if(this._stringCache=[],this._loadedSpriteSheets=[],this._currentBit=-1,this._currentByte=-1,0!==arguments.length)if(t instanceof cc.BuilderReader){var r=t;this._loadedSpriteSheets=r._loadedSpriteSheets,this._ccNodeLoaderLibrary=r._ccNodeLoaderLibrary,this._ccbMemberVariableAssigner=r._ccbMemberVariableAssigner,this._ccbSelectorResolver=r._ccbSelectorResolver,this._ccNodeLoaderListener=r._ccNodeLoaderListener,this._ownerCallbackNames=r._ownerCallbackNames,this._ownerCallbackNodes=r._ownerCallbackNodes,this._ownerCallbackEvents=r._ownerCallbackEvents,this._ownerOutletNames=r._ownerOutletNames,this._ownerOutletNodes=r._ownerOutletNodes,this._ccbRootPath=r._ccbRootPath}else this._ccNodeLoaderLibrary=t,this._ccbMemberVariableAssigner=e,this._ccbSelectorResolver=i,this._ccNodeLoaderListener=n},getCCBRootPath:function(){return this._ccbRootPath},setCCBRootPath:function(t){this._ccbRootPath=t},initWithData:function(t,e){return this._animationManager=new cc.BuilderAnimationManager,this._data=t,this._bytes=t.length,this._currentBit=0,this._currentByte=0,this._owner=e,this._animationManager.setRootContainerSize(cc.director.getWinSize()),!0},_loadBinarySync:function(t){var e=this.getXMLHttpRequest(),i="load "+t+" failed!";e.open("GET",t,!1);var n=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(e.setRequestHeader("Accept-Charset","x-user-defined"),e.send(null),200!==e.status)return cc.log(i),null;var r=cc._convertResponseBodyToText(e.responseBody);r&&(n=this._stringConvertToArray(r),this._fileDataCache[t]=n)}else{if(e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined"),e.send(null),200!==e.status)return cc.log(i),null;n=this._stringConvertToArray(e.responseText),this._fileDataCache[t]=n}return n},readNodeGraphFromFile:function(t,e,i,n){null==i?i=cc.director.getWinSize():i instanceof cc.BuilderAnimationManager&&(n=i,i=cc.director.getWinSize());var r=cc.loader.getRes(t);if(!r){var o=cc.loader.getUrl(t);r=cc.loader.loadBinarySync(o),cc.loader.cache[t]=r}return this.readNodeGraphFromData(r,e,i,n)},readNodeGraphFromData:function(t,e,i){this.initWithData(t,e);var n=this._animationManager;n.setRootContainerSize(i),n.setOwner(e),this._ownerOutletNames=[],this._ownerOutletNodes=[],this._ownerCallbackNames=[],this._ownerCallbackNodes=[],this._ownerCallbackEvents=[],this._animationManagers=new cc._Dictionary;var r=this.readFileWithCleanUp(!0);if(r&&n.getAutoPlaySequenceId()!==-1&&n.runAnimations(n.getAutoPlaySequenceId(),0),this._jsControlled){for(var o=[],s=[],c=this._animationManagers,a=c.allKeys(),l=0;l<a.length;l++)o.push(a[l]),s.push(c.objectForKey(a[l]));this._nodesWithAnimationManagers=o,this._animationManagerForNodes=s}return r},createSceneWithNodeGraphFromFile:function(t,e,i,n){var r=this.readNodeGraphFromFile(t,e,i,n),o=new cc.Scene;return o.addChild(r),o},getCCBMemberVariableAssigner:function(){return this._ccbMemberVariableAssigner},getCCBSelectorResolver:function(){return this._ccbSelectorResolver},getAnimationManager:function(){return this._animationManager},setAnimationManager:function(t){this._animationManager=t},getAnimatedProperties:function(){return this._animatedProps},getLoadedSpriteSheet:function(){return this._loadedSpriteSheets},getOwner:function(){return this._owner},readInt:function(t){for(var e=0;!this._getBit();)e++;for(var i=0,n=e-1;n>=0;n--)this._getBit()&&(i|=1<<n);i|=1<<e;var r;if(t){var o=i%2;r=o?0|i/2:0|-i/2}else r=i-1;return this._alignBits(),r},readByte:function(){var t=this._data[this._currentByte];return this._currentByte++,t},readBool:function(){return 0!==this.readByte()},readFloat:function(){var t=this.readByte();switch(t){case CCB_FLOAT0:return 0;case CCB_FLOAT1:return 1;case CCB_FLOAT_MINUS1:return-1;case CCB_FLOAT05:return.5;case CCB_FLOAT_INTEGER:return this.readInt(!0);default:var e=this._decodeFloat(23,8);return e}},_decodeFloat:function(t,e){var i=t+e+1,n=i>>3;this._checkSize(i);var r=Math.pow(2,e-1)-1,o=this._readBitsOnly(t+e,1,n),s=this._readBitsOnly(t,e,n),c=0,a=2,l=0;do{for(var h=this._readByteOnly(++l,n),u=t%8||8,d=1<<u;d>>=1;)h&d&&(c+=1/a),a*=2}while(t-=u);return this._currentByte+=n,s===(r<<1)+1?c?NaN:o?-(1/0):+(1/0):(1+o*-2)*(s||c?s?Math.pow(2,s-r)*(1+c):Math.pow(2,-r+1)*c:0)},_readBitsOnly:function(t,e,i){var n=(t+e)%8,r=t%8,o=i-(t>>3)-1,s=i+(-(t+e)>>3),c=o-s,a=this._readByteOnly(o,i)>>r&(1<<(c?8-r:e))-1;for(c&&n&&(a+=(this._readByteOnly(s++,i)&(1<<n)-1)<<(c--<<3)-r);c;)a+=this._shl(this._readByteOnly(s++,i),(c--<<3)-r);return a},_readByteOnly:function(t,e){return this._data[this._currentByte+e-t-1]},_shl:function(t,e){for(++e;--e;t=1073741824===(1073741824&(t%=2147483648))?2*t:2*(t-1073741824)+2147483647+1);return t},_checkSize:function(t){if(!(this._currentByte+Math.ceil(t/8)<this._data.length))throw new Error("Index out of bound")},readCachedString:function(){return this._stringCache[this.readInt(!1)]},isJSControlled:function(){return this._jsControlled},getOwnerCallbackNames:function(){return this._ownerCallbackNames},getOwnerCallbackNodes:function(){return this._ownerCallbackNodes},getOwnerCallbackControlEvents:function(){return this._ownerCallbackEvents},getOwnerOutletNames:function(){return this._ownerOutletNames},getOwnerOutletNodes:function(){return this._ownerOutletNodes},getNodesWithAnimationManagers:function(){return this._nodesWithAnimationManagers},getAnimationManagersForNodes:function(){return this._animationManagerForNodes},getAnimationManagers:function(){return this._animationManagers},setAnimationManagers:function(t){this._animationManagers=t},addOwnerCallbackName:function(t){this._ownerCallbackNames.push(t)},addOwnerCallbackNode:function(t){this._ownerCallbackNodes.push(t)},addOwnerCallbackControlEvents:function(t){this._ownerCallbackEvents.push(t)},addDocumentCallbackName:function(t){this._animationManager.addDocumentCallbackName(t)},addDocumentCallbackNode:function(t){this._animationManager.addDocumentCallbackNode(t)},addDocumentCallbackControlEvents:function(t){this._animationManager.addDocumentCallbackControlEvents(t)},readFileWithCleanUp:function(t){if(!this._readHeader())return null;if(!this._readStringCache())return null;if(!this._readSequences())return null;var e=this._readNodeGraph();return this._animationManagers.setObject(this._animationManager,e),t&&this._cleanUpNodeGraph(e),e},addOwnerOutletName:function(t){this._ownerOutletNames.push(t)},addOwnerOutletNode:function(t){null!=t&&this._ownerOutletNodes.push(t)},_cleanUpNodeGraph:function(t){t.userObject=null;for(var e=t.getChildren(),i=0,n=e.length;i<n;i++)this._cleanUpNodeGraph(e[i])},_readCallbackKeyframesForSeq:function(t){var e=this.readInt(!1);if(!e)return!0;for(var i=new cc.BuilderSequenceProperty,n=this._jsControlled,r=this._animationManager,o=i.getKeyframes(),s=0;s<e;s++){var c=this.readFloat(),a=this.readCachedString(),l=this.readInt(!1),h=[a,l],u=new cc.BuilderKeyframe;u.setTime(c),u.setValue(h),n&&r.getKeyframeCallbacks().push(l+":"+a),o.push(u)}return t.setCallbackChannel(i),!0},_readSoundKeyframesForSeq:function(t){var e=this.readInt(!1);if(!e)return!0;for(var i=new cc.BuilderSequenceProperty,n=i.getKeyframes(),r=0;r<e;r++){var o=this.readFloat(),s=this.readCachedString(),c=this.readFloat(),a=this.readFloat(),l=this.readFloat(),h=[s,c,a,l],u=new cc.BuilderKeyframe;u.setTime(o),u.setValue(h),n.push(u)}return t.setSoundChannel(i),!0},_readSequences:function(){for(var t=this._animationManager.getSequences(),e=this.readInt(!1),i=0;i<e;i++){var n=new cc.BuilderSequence;if(n.setDuration(this.readFloat()),n.setName(this.readCachedString()),n.setSequenceId(this.readInt(!1)),n.setChainedSequenceId(this.readInt(!0)),!this._readCallbackKeyframesForSeq(n))return!1;if(!this._readSoundKeyframesForSeq(n))return!1;t.push(n)}return this._animationManager.setAutoPlaySequenceId(this.readInt(!0)),!0},readKeyframe:function(t){var e=new cc.BuilderKeyframe;e.setTime(this.readFloat());var i=this.readInt(!1),n=0,r=null;if(i!==CCB_KEYFRAME_EASING_CUBIC_IN&&i!==CCB_KEYFRAME_EASING_CUBIC_OUT&&i!==CCB_KEYFRAME_EASING_CUBIC_INOUT&&i!==CCB_KEYFRAME_EASING_ELASTIC_IN&&i!==CCB_KEYFRAME_EASING_ELASTIC_OUT&&i!==CCB_KEYFRAME_EASING_ELASTIC_INOUT||(n=this.readFloat()),e.setEasingType(i),e.setEasingOpt(n),t===CCB_PROPTYPE_CHECK)r=this.readBool();else if(t===CCB_PROPTYPE_BYTE)r=this.readByte();else if(t===CCB_PROPTYPE_COLOR3){var o=cc.color(this.readByte(),this.readByte(),this.readByte());r=cc.Color3BWapper.create(o)}else if(t===CCB_PROPTYPE_FLOATXY)r=[this.readFloat(),this.readFloat()];else if(t===CCB_PROPTYPE_DEGREES)r=this.readFloat();else if(t===CCB_PROPTYPE_SCALELOCK||t===CCB_PROPTYPE_POSITION||t===CCB_PROPTYPE_FLOATXY)r=[this.readFloat(),this.readFloat()];else if(t===CCB_PROPTYPE_SPRITEFRAME){var s=this.readCachedString(),c=this.readCachedString();if(""===s){c=this._ccbRootPath+c;var a=cc.textureCache.addImage(c),l=a.getContentSize(),h=cc.rect(0,0,l.width,l.height);r=new cc.SpriteFrame(a,h)}else{s=this._ccbRootPath+s;var u=cc.spriteFrameCache;this._loadedSpriteSheets.indexOf(s)===-1&&(u.addSpriteFrames(s),this._loadedSpriteSheets.push(s)),r=u.getSpriteFrame(c)}}return e.setValue(r),e},_readHeader:function(){if(!this._data)return!1;var t=this._readStringFromBytes(this._currentByte,4,!0);if(this._currentByte+=4,"ccbi"!==t)return!1;var e=this.readInt(!1);return e!==CCB_VERSION?(cc.log("WARNING! Incompatible ccbi file version (file: "+e+" reader: "+CCB_VERSION+")"),!1):(this._jsControlled=this.readBool(),this._animationManager._jsControlled=this._jsControlled,!0)},_readStringFromBytes:function(t,e,i){i=i||!1;var n,r="",o=this._data,s=this._currentByte;if(i)for(n=e-1;n>=0;n--)r+=String.fromCharCode(o[s+n]);else for(n=0;n<e;n++)r+=String.fromCharCode(o[s+n]);return r},_readStringCache:function(){for(var t=this.readInt(!1),e=0;e<t;e++)this._readStringCacheEntry();return!0},_readStringCacheEntry:function(){for(var t=this.readByte(),e=this.readByte(),i=t<<8|e,n="",r=this._data,o=this._currentByte,s=0;s<i;s++){var c=r[o+s].toString("16").toUpperCase();c=c.length>1?c:"0"+c,n+="%"+c}n=decodeURIComponent(n),this._currentByte+=i,this._stringCache.push(n)},_readNodeGraph:function(t){var e,i=this.readCachedString(),n=this._jsControlled,r=this._animationManager;n&&(e=this.readCachedString());var o,s=this.readInt(!1);s!==CCB_TARGETTYPE_NONE&&(o=this.readCachedString());var c=this._ccNodeLoaderLibrary.getCCNodeLoader(i);c||(c=this._ccNodeLoaderLibrary.getCCNodeLoader("CCNode"));var a=c.loadCCNode(t,this);r.getRootNode()||r.setRootNode(a),n&&a===r.getRootNode()&&r.setDocumentControllerName(e);var l=new cc._Dictionary;this._animatedProps=[];var h,u=this._animatedProps,d=this.readInt(!1);for(h=0;h<d;++h){for(var _=this.readInt(!1),p=new cc._Dictionary,f=this.readInt(!1),m=0;m<f;++m){var g=new cc.BuilderSequenceProperty;g.setName(this.readCachedString()),g.setType(this.readInt(!1)),u.push(g.getName());for(var y=this.readInt(!1),v=g.getKeyframes(),T=0;T<y;++T){var C=this.readKeyframe(g.getType());v.push(C)}p.setObject(g,g.getName())}l.setObject(p,_)}l.count()>0&&r.addNode(a,l),c.parseProperties(a,t,this);var S=a instanceof cc.BuilderFile;if(S){var x=a.getCCBFileNode();x.setPosition(a.getPosition()),x.setRotation(a.getRotation()),x.setScaleX(a.getScaleX()),x.setScaleY(a.getScaleY()),x.setTag(a.getTag()),x.setVisible(!0),r.moveAnimationsFromNode(a,x),a.setCCBFileNode(null),a=x}var A=null,E=null;if(s!==CCB_TARGETTYPE_NONE)if(n)s===CCB_TARGETTYPE_DOCUMENTROOT?(r.addDocumentOutletName(o),r.addDocumentOutletNode(a)):(this._ownerOutletNames.push(o),this._ownerOutletNodes.push(a));else if(s===CCB_TARGETTYPE_DOCUMENTROOT?A=r.getRootNode():s===CCB_TARGETTYPE_OWNER&&(A=this._owner),!A){var b=!1;A.onAssignCCBMemberVariable&&(b=A.onAssignCCBMemberVariable(A,o,a)),E=this._ccbMemberVariableAssigner,!b&&null!=E&&E.onAssignCCBMemberVariable&&E.onAssignCCBMemberVariable(A,o,a)}if(c.getCustomProperties().length>0){var R=!1;if(!n&&(A=a,null!=A&&null!=A.onAssignCCBCustomProperty)){var P=c.getCustomProperties(),w=P.allKeys();for(h=0;h<w.length;h++){var I=P.objectForKey(w[h]);R=A.onAssignCCBCustomProperty(A,w[h],I),E=this._ccbMemberVariableAssigner,R||null==E||null==E.onAssignCCBCustomProperty||(R=E.onAssignCCBCustomProperty(A,w[h],I))}}}this._animatedProps=null;var D=this.readInt(!1);for(h=0;h<D;h++){var L=this._readNodeGraph(a);a.addChild(L)}return S||(null!=a&&a.onNodeLoaded?a.onNodeLoaded(a,c):null!=this._ccNodeLoaderListener&&this._ccNodeLoaderListener.onNodeLoaded(a,c)),a},_getBit:function(){var t=0!==(this._data[this._currentByte]&1<<this._currentBit);if(this._currentBit++,this._currentBit>=8&&(this._currentBit=0,this._currentByte++,this._currentByte>this._data.length))throw new Error("out of the data bound");return t},_alignBits:function(){this._currentBit&&(this._currentBit=0,this._currentByte++)},_readUTF8:function(){}}),cc.BuilderReader._ccbResolutionScale=1,cc.BuilderReader.setResolutionScale=function(t){cc.BuilderReader._ccbResolutionScale=t},cc.BuilderReader.getResolutionScale=function(){return cc.BuilderReader._ccbResolutionScale},cc.BuilderReader.loadAsScene=function(t,e,i,n){n=n||cc.BuilderReader.getResourcePath();var r=cc.BuilderReader.load(t,e,i,n),o=new cc.Scene;return o.addChild(r),o},cc.BuilderReader._controllerClassCache={},cc.BuilderReader.registerController=function(t,e){cc.BuilderReader._controllerClassCache[t]=cc.Class.extend(e)},cc.BuilderReader.load=function(t,e,i,n){n=n||cc.BuilderReader.getResourcePath();var r=new cc.BuilderReader(cc.NodeLoaderLibrary.newDefaultCCNodeLoaderLibrary());r.setCCBRootPath(n),(t.length<5||t.toLowerCase().lastIndexOf(".ccbi")!==t.length-5)&&(t+=".ccbi");var o,s,c,a,l,h,u=r.readNodeGraphFromFile(t,e,i);if(e){var d=r.getOwnerCallbackNames(),_=r.getOwnerCallbackNodes(),p=r.getOwnerCallbackControlEvents();for(o=0;o<d.length;o++)s=d[o],c=_[o],a=p[o],c instanceof cc.ControlButton?c.addTargetWithActionForControlEvents(e,e[s],a):c.setCallback(e[s],e);var f=r.getOwnerOutletNames(),m=r.getOwnerOutletNodes();for(o=0;o<f.length;o++)l=f[o],h=m[o],e[l]=h}var g=r.getNodesWithAnimationManagers(),y=r.getAnimationManagersForNodes();if(!g||!y)return u;var v=cc.BuilderReader._controllerClassCache;for(o=0;o<g.length;o++){var T,C=g[o],S=y[o];C.animationManager=S;var x=S.getDocumentControllerName();if(x){var A=v[x];if(!A)throw new Error("Can not find controller : "+x);var E=new A;E.controllerName=x,C.controller=E,E.rootNode=C;var b=S.getDocumentCallbackNames(),R=S.getDocumentCallbackNodes(),P=S.getDocumentCallbackControlEvents();for(T=0;T<b.length;T++)s=b[T],c=R[T],a=P[T],c instanceof cc.ControlButton?c.addTargetWithActionForControlEvents(E,E[s],a):c.setCallback(E[s],E);var w=S.getDocumentOutletNames(),I=S.getDocumentOutletNodes();for(T=0;T<w.length;T++)l=w[T],h=I[T],E[l]=h;E.onDidLoadFromCCB&&cc.isFunction(E.onDidLoadFromCCB)&&E.onDidLoadFromCCB();var D=S.getKeyframeCallbacks();for(T=0;T<D.length;T++){var L=D[T].split(":"),O=L[0],B=L[1];1==O?S.setCallFunc(cc.callFunc(E[B],E),D[T]):2==O&&e&&S.setCallFunc(cc.callFunc(e[B],e),D[T])}}}return S.runAnimations(S.getAutoPlaySequenceId(),0),u},cc.BuilderReader._resourcePath="",cc.BuilderReader.setResourcePath=function(t){cc.BuilderReader._resourcePath=t},cc.BuilderReader.getResourcePath=function(){return cc.BuilderReader._resourcePath},cc.BuilderReader.lastPathComponent=function(t){var e=t.lastIndexOf("/");return e!==-1?t.substring(e+1,t.length-e):t},cc.BuilderReader.deletePathExtension=function(t){var e=t.lastIndexOf(".");return e!==-1?t.substring(0,e):t},cc.BuilderReader.toLowerCase=function(t){return t.toLowerCase()},cc.BuilderReader.endsWith=function(t,e){return t.length>=e.length&&0===t.lastIndexOf(e)},cc.BuilderReader.concat=function(t,e){return t+e},cc.loader.register(["ccbi"],cc._binaryLoader),cc.INT_VALUE=0,cc.FLOAT_VALUE=1,cc.POINTER_VALUE=2,cc.BOOL_VALUE=3,cc.UNSIGNEDCHAR_VALUE=4,cc.Color3BWapper=cc.Class.extend({_color:null,ctor:function(){this._color=cc.color(0,0,0)},getColor:function(){return this._color}}),cc.Color3BWapper.create=function(t){var e=new cc.Color3BWapper;return e&&(e._color.r=t.r,e._color.g=t.g,e._color.b=t.b),e},cc.BuilderValue=cc.Class.extend({_value:null,_type:0,getIntValue:function(){},getFloatValue:function(){},getBoolValue:function(){},getByteValue:function(){},getPointer:function(){},getValue:function(){return this._value}}),cc.BuilderValue.create=function(t){return new cc.BuilderValue},cc.BuilderKeyframe=cc.Class.extend({_value:null,_time:0,_easingType:0,_easingOpt:0,getValue:function(){return this._value},setValue:function(t){this._value=t},getTime:function(){return this._time},setTime:function(t){this._time=t},getEasingType:function(){return this._easingType},setEasingType:function(t){this._easingType=t},getEasingOpt:function(){return this._easingOpt},setEasingOpt:function(t){this._easingOpt=t}}),cc.BuilderSequence=cc.Class.extend({_duration:0,_name:"",_sequenceId:0,_chainedSequenceId:0,_callbackChannel:null,_soundChannel:null,ctor:function(){this._name=""},getDuration:function(){return this._duration},setDuration:function(t){this._duration=t},getName:function(){return this._name},setName:function(t){this._name=t},getSequenceId:function(){return this._sequenceId},setSequenceId:function(t){this._sequenceId=t},getChainedSequenceId:function(){return this._chainedSequenceId},setChainedSequenceId:function(t){this._chainedSequenceId=t},getCallbackChannel:function(){return this._callbackChannel},setCallbackChannel:function(t){this._callbackChannel=t},getSoundChannel:function(){return this._soundChannel},setSoundChannel:function(t){this._soundChannel=t}}),cc.BuilderSequenceProperty=cc.Class.extend({_name:null,_type:0,_keyFrames:null,ctor:function(){this.init()},init:function(){this._keyFrames=[],this._name=""},getName:function(){return this._name},setName:function(t){this._name=t},getType:function(){return this._type},setType:function(t){this._type=t},getKeyframes:function(){return this._keyFrames}}),cc.getAbsolutePosition=function(t,e,i,n){var r=cc.p(0,0);if(e===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)r=t;else if(e===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)r.x=t.x,r.y=i.height-t.y;else if(e===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)r.x=i.width-t.x,r.y=i.height-t.y;else if(e===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)r.x=i.width-t.x,r.y=t.y;else if(e===CCB_POSITIONTYPE_PERCENT)r.x=i.width*t.x/100,r.y=i.height*t.y/100;else if(e===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var o=cc.BuilderReader.getResolutionScale();r.x=t.x*o,r.y=t.y*o}return r},cc._getAbsolutePosition=function(t,e,i,n,r){var o=cc.p(0,0);if(i===CCB_POSITIONTYPE_RELATIVE_BOTTOM_LEFT)o.x=t,o.y=e;else if(i===CCB_POSITIONTYPE_RELATIVE_TOP_LEFT)o.x=t,o.y=n.height-e;else if(i===CCB_POSITIONTYPE_RELATIVE_TOP_RIGHT)o.x=n.width-t,o.y=n.height-e;else if(i===CCB_POSITIONTYPE_RELATIVE_BOTTOM_RIGHT)o.x=n.width-t,o.y=e;else if(i===CCB_POSITIONTYPE_PERCENT)o.x=n.width*t/100,o.y=n.height*e/100;else if(i===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var s=cc.BuilderReader.getResolutionScale();o.x=t*s,o.y=e*s}return o},cc.setRelativeScale=function(t,e,i,n,r){if(!t)throw new Error("cc.setRelativeScale(): node should be non-null");if(n===CCB_POSITIONTYPE_MULTIPLY_RESOLUTION){var o=cc.BuilderReader.getResolutionScale();e*=o,i*=o}t.setScaleX(e),t.setScaleY(i)},cc.BuilderAnimationManagerDelegate=cc.Class.extend({completedAnimationSequenceNamed:function(t){}}),cc.BuilderAnimationManager=cc.Class.extend({_sequences:null,_nodeSequences:null,_baseValues:null,_autoPlaySequenceId:0,_rootNode:null,_owner:null,_rootContainerSize:null,_delegate:null,_runningSequence:null,_documentOutletNames:null,_documentOutletNodes:null,_documentCallbackNames:null,_documentCallbackNodes:null,_documentCallbackControlEvents:null,_documentControllerName:"",_lastCompletedSequenceName:"",_keyframeCallbacks:null,_keyframeCallFuncs:null,_animationCompleteCallbackFunc:null,_target:null,_jsControlled:!1,ctor:function(){this._rootContainerSize=cc.size(0,0),this.init()},init:function(){return this._sequences=[],this._nodeSequences=new cc._Dictionary,this._baseValues=new cc._Dictionary,this._documentOutletNames=[],this._documentOutletNodes=[],this._documentCallbackNames=[],this._documentCallbackNodes=[],this._documentCallbackControlEvents=[],this._keyframeCallbacks=[],this._keyframeCallFuncs={},!0},getSequences:function(){return this._sequences},setSequences:function(t){this._sequences=t},getAutoPlaySequenceId:function(){return this._autoPlaySequenceId},setAutoPlaySequenceId:function(t){this._autoPlaySequenceId=t},getRootNode:function(){return this._rootNode},setRootNode:function(t){this._rootNode=t},getOwner:function(){return this._owner},setOwner:function(t){this._owner=t},addDocumentCallbackNode:function(t){this._documentCallbackNodes.push(t)},addDocumentCallbackName:function(t){this._documentCallbackNames.push(t)},addDocumentCallbackControlEvents:function(t){this._documentCallbackControlEvents.push(t)},addDocumentOutletNode:function(t){this._documentOutletNodes.push(t)},addDocumentOutletName:function(t){this._documentOutletNames.push(t)},setDocumentControllerName:function(t){this._documentControllerName=t},getDocumentControllerName:function(){return this._documentControllerName},getDocumentCallbackNames:function(){return this._documentCallbackNames},getDocumentCallbackNodes:function(){return this._documentCallbackNodes},getDocumentCallbackControlEvents:function(){return this._documentCallbackControlEvents},getDocumentOutletNames:function(){return this._documentOutletNames},getDocumentOutletNodes:function(){return this._documentOutletNodes},getLastCompletedSequenceName:function(){return this._lastCompletedSequenceName},getKeyframeCallbacks:function(){return this._keyframeCallbacks},getRootContainerSize:function(){return this._rootContainerSize},setRootContainerSize:function(t){this._rootContainerSize=cc.size(t.width,t.height)},getDelegate:function(){return this._delegate},setDelegate:function(t){this._delegate=t},getRunningSequenceName:function(){return this._runningSequence?this._runningSequence.getName():null},getContainerSize:function(t){return t?t.getContentSize():this._rootContainerSize},addNode:function(t,e){this._nodeSequences.setObject(e,t)},setBaseValue:function(t,e,i){var n=this._baseValues.objectForKey(e);n||(n=new cc._Dictionary,this._baseValues.setObject(n,e)),n.setObject(t,i)},moveAnimationsFromNode:function(t,e){var i=this._baseValues,n=i.objectForKey(t);null!==n&&(i.setObject(n,e),i.removeObjectForKey(t));var r=this._nodeSequences,o=r.objectForKey(t);null!=o&&(r.setObject(o,e),r.removeObjectForKey(t))},getActionForCallbackChannel:function(t){for(var e=0,i=[],n=t.getKeyframes(),r=n.length,o=0;o<r;++o){var s=n[o],c=s.getTime()-e;e=s.getTime(),c>0&&i.push(cc.delayTime(c));var a=s.getValue(),l=a[0],h=a[1];if(this._jsControlled){var u=h+":"+l,d=this._keyframeCallFuncs[u];null!=d&&i.push(d)}else{var _;if(h===CCB_TARGETTYPE_DOCUMENTROOT?_=this._rootNode:h===CCB_TARGETTYPE_OWNER&&(_=this._owner),null!=_)if(l.length>0){var p=0;null!=_.onResolveCCBCCCallFuncSelector&&(p=_.onResolveCCBCCCallFuncSelector(_,l)),0===p?cc.log("Skipping selector '"+l+"' since no CCBSelectorResolver is present."):i.push(cc.callFunc(p,_))}else cc.log("Unexpected empty selector.")}}return i.length<1?null:cc.sequence(i)},getActionForSoundChannel:function(t){for(var e=0,i=[],n=t.getKeyframes(),r=n.length,o=0;o<r;++o){var s=n[o],c=s.getTime()-e;e=s.getTime(),c>0&&i.push(cc.delayTime(c));var a=s.getValue(),l=cc.BuilderReader.getResourcePath()+a[0],h=parseFloat(a[1]),u=parseFloat(a[2]),d=parseFloat(a[3]);i.push(cc.BuilderSoundEffect.create(l,h,u,d))}return i.length<1?null:cc.sequence(i)},runAnimationsForSequenceNamed:function(t){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(t),0)},runAnimationsForSequenceNamedTweenDuration:function(t,e){this.runAnimationsForSequenceIdTweenDuration(this._getSequenceId(t),e)},runAnimationsForSequenceIdTweenDuration:function(t,e){if(t===-1)throw new Error("cc.BuilderAnimationManager.runAnimationsForSequenceIdTweenDuration(): Sequence id should not be -1");e=e||0,this._rootNode.stopAllActions();for(var i=this._nodeSequences.allKeys(),n=0,r=i.length;n<r;n++){var o=i[n];o.stopAllActions();var s,c=this._nodeSequences.objectForKey(o),a=c.objectForKey(t),l=[];if(a){var h=a.allKeys();for(s=0;s<h.length;s++){var u=h[s],d=a.objectForKey(u);l.push(u),this._setFirstFrame(o,d,e),this._runAction(o,d,e)}}var _=this._baseValues.objectForKey(o);if(_){var p=_.allKeys();for(s=0;s<p.length;s++){var f=p[s];if(l.indexOf(f)===-1){var m=_.objectForKey(f);null!=m&&this._setAnimatedProperty(f,o,m,e)}}}}var g=this._getSequence(t),y=cc.sequence(cc.delayTime(g.getDuration()+e),cc.callFunc(this._sequenceCompleted,this));this._rootNode.runAction(y);var v;g.getCallbackChannel()&&(v=this.getActionForCallbackChannel(g.getCallbackChannel()),v&&this._rootNode.runAction(v)),g.getSoundChannel()&&(v=this.getActionForSoundChannel(g.getSoundChannel()),v&&this._rootNode.runAction(v)),this._runningSequence=this._getSequence(t)},runAnimations:function(t,e){e=e||0;var i;i=cc.isString(t)?this._getSequenceId(t):t,this.runAnimationsForSequenceIdTweenDuration(i,e)},setAnimationCompletedCallback:function(t,e){this._target=t,this._animationCompleteCallbackFunc=e},setCompletedAnimationCallback:function(t,e){this.setAnimationCompletedCallback(t,e)},setCallFunc:function(t,e){this._keyframeCallFuncs[e]=t},debug:function(){},_getBaseValue:function(t,e){var i=this._baseValues.objectForKey(t);return i?i.objectForKey(e):null},_getSequenceId:function(t){for(var e=null,i=this._sequences,n=0,r=i.length;n<r;n++)if(e=i[n],e&&e.getName()===t)return e.getSequenceId();return-1},_getSequence:function(t){for(var e=null,i=this._sequences,n=0,r=i.length;n<r;n++)if(e=i[n],e&&e.getSequenceId()===t)return e;return null},_getAction:function(t,e,i,n){var r,o,s,c,a,l=e.getTime()-(t?t.getTime():0);if("rotation"===i)return cc.BuilderRotateTo.create(l,e.getValue());if("rotationX"===i)return cc.BuilderRotateXTo.create(l,e.getValue());if("rotationY"===i)return cc.BuilderRotateYTo.create(l,e.getValue());if("opacity"===i)return cc.fadeTo(l,e.getValue());if("color"===i){var h=e.getValue().getColor();return cc.tintTo(l,h.r,h.g,h.b)}if("visible"===i){var u=e.getValue();return u?cc.sequence(cc.delayTime(l),cc.show()):cc.sequence(cc.delayTime(l),cc.hide())}if("displayFrame"===i)return cc.sequence(cc.delayTime(l),cc.BuilderSetSpriteFrame.create(e.getValue()));if("position"===i){r=this._getBaseValue(n,i),o=r[2],s=e.getValue(),c=s[0],a=s[1];var d=this.getContainerSize(n.getParent()),_=cc._getAbsolutePosition(c,a,o,d,i);return cc.moveTo(l,_)}if("scale"===i){if(r=this._getBaseValue(n,i),o=r[2],s=e.getValue(),c=s[0],a=s[1],o===CCB_SCALETYPE_MULTIPLY_RESOLUTION){var p=cc.BuilderReader.getResolutionScale();c*=p,a*=p}return cc.scaleTo(l,c,a)}return"skew"===i?(s=e.getValue(),c=s[0],a=s[1],cc.skewTo(l,c,a)):(cc.log("BuilderReader: Failed to create animation for property: "+i),null)},_setAnimatedProperty:function(t,e,i,n){if(n>0){var r=new cc.BuilderKeyframe;r.setValue(i),r.setTime(n),r.setEasingType(CCB_KEYFRAME_EASING_LINEAR);var o=this._getAction(null,r,t,e);e.runAction(o)}else{var s,c,a,l;if("position"===t)s=this._getBaseValue(e,t),c=s[2],a=i[0],l=i[1],e.setPosition(cc._getAbsolutePosition(a,l,c,this.getContainerSize(e.getParent()),t));else if("scale"===t)s=this._getBaseValue(e,t),c=s[2],a=i[0],l=i[1],cc.setRelativeScale(e,a,l,c,t);else if("skew"===t)a=i[0],l=i[1],e.setSkewX(a),e.setSkewY(l);else if("rotation"===t)e.setRotation(i);else if("rotationX"===t)e.setRotationSkewX(i);else if("rotationY"===t)e.setRotationSkewY(i);else if("opacity"===t)e.setOpacity(i);else if("displayFrame"===t)e.setSpriteFrame(i);else if("color"===t){var h=i.getColor();255===h.r&&255===h.g&&255===h.b||e.setColor(h)}else"visible"===t?(i=i||!1,e.setVisible(i)):cc.log("unsupported property name is "+t)}},_setFirstFrame:function(t,e,i){var n=e.getKeyframes();if(0===n.length){var r=this._getBaseValue(t,e.getName());r||cc.log("cc.BuilderAnimationManager._setFirstFrame(): No baseValue found for property"),this._setAnimatedProperty(e.getName(),t,r,i)}else{var o=n[0];this._setAnimatedProperty(e.getName(),t,o.getValue(),i)}},_getEaseAction:function(t,e,i){return e===CCB_KEYFRAME_EASING_LINEAR||e===CCB_KEYFRAME_EASING_INSTANT?t:e===CCB_KEYFRAME_EASING_CUBIC_IN?t.easing(cc.easeIn(i)):e===CCB_KEYFRAME_EASING_CUBIC_OUT?t.easing(cc.easeOut(i)):e===CCB_KEYFRAME_EASING_CUBIC_INOUT?t.easing(cc.easeInOut(i)):e===CCB_KEYFRAME_EASING_BACK_IN?t.easing(cc.easeBackIn()):e===CCB_KEYFRAME_EASING_BACK_OUT?t.easing(cc.easeBackOut()):e===CCB_KEYFRAME_EASING_BACK_INOUT?t.easing(cc.easeBackInOut()):e===CCB_KEYFRAME_EASING_BOUNCE_IN?t.easing(cc.easeBounceIn()):e===CCB_KEYFRAME_EASING_BOUNCE_OUT?t.easing(cc.easeBounceOut()):e===CCB_KEYFRAME_EASING_BOUNCE_INOUT?t.easing(cc.easeBounceInOut()):e===CCB_KEYFRAME_EASING_ELASTIC_IN?t.easing(cc.easeElasticIn(i)):e===CCB_KEYFRAME_EASING_ELASTIC_OUT?t.easing(cc.easeElasticOut(i)):e===CCB_KEYFRAME_EASING_ELASTIC_INOUT?t.easing(cc.easeElasticInOut(i)):(cc.log("BuilderReader: Unknown easing type "+e),t)},_runAction:function(t,e,i){var n=e.getKeyframes(),r=n.length;if(r>1){var o=[],s=n[0],c=s.getTime()+i;c>0&&o.push(cc.delayTime(c));for(var a=0;a<r-1;++a){var l=n[a],h=n[a+1],u=this._getAction(l,h,e.getName(),t);u&&(u=this._getEaseAction(u,l.getEasingType(),l.getEasingOpt()),o.push(u))}t.runAction(cc.sequence(o))}},_sequenceCompleted:function(){var t=this._runningSequence,e=t.getName();this._lastCompletedSequenceName!=t.getName()&&(this._lastCompletedSequenceName=t.getName());var i=t.getChainedSequenceId();this._runningSequence=null,i!==-1&&this.runAnimations(i,0),this._delegate&&this._delegate.completedAnimationSequenceNamed(e),this._target&&this._animationCompleteCallbackFunc&&this._animationCompleteCallbackFunc.call(this._target)}}),cc.BuilderSetSpriteFrame=cc.ActionInstant.extend({_spriteFrame:null,initWithSpriteFrame:function(t){return this._spriteFrame=t,!0},update:function(t){this.target.setSpriteFrame(this._spriteFrame)}}),cc.BuilderSetSpriteFrame.create=function(t){var e=new cc.BuilderSetSpriteFrame;return e&&e.initWithSpriteFrame(t)?e:null},cc.BuilderRotateTo=cc.ActionInterval.extend({_startAngle:0,_dstAngle:0,_diffAngle:0,initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngle=e,!0)},update:function(t){this.target.setRotation(this._startAngle+this._diffAngle*t)},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngle=this.target.getRotation(),this._diffAngle=this._dstAngle-this._startAngle}}),cc.BuilderRotateTo.create=function(t,e){var i=new cc.BuilderRotateTo;return i&&i.initWithDuration(t,e)?i:null},cc.BuilderRotateXTo=cc.ActionInterval.extend({}),cc.BuilderRotateXTo.create=function(t,e){throw new Error("rotationX has not been implemented in cocos2d-html5")},cc.BuilderRotateYTo=cc.ActionInterval.extend({}),cc.BuilderRotateYTo.create=function(t,e){throw new Error("rotationY has not been implemented in cocos2d-html5")},cc.BuilderSoundEffect=cc.ActionInstant.extend({init:function(t){return this._file=t,!0},update:function(t){cc.audioEngine.playEffect(this._file)}}),cc.BuilderSoundEffect.create=function(t,e,i,n){var r=new cc.BuilderSoundEffect;return r&&r.init(t)?r:null};cc.DOM={},cc.DOM._addMethods=function(t){for(var e in cc.DOM.methods)t[e]=cc.DOM.methods[e];cc.defineGetterSetter(t,"x",t.getPositionX,t.setPositionX),cc.defineGetterSetter(t,"y",t.getPositionY,t.setPositionY),cc.defineGetterSetter(t,"width",t._getWidth,t._setWidth),cc.defineGetterSetter(t,"height",t._getHeight,t._setHeight),cc.defineGetterSetter(t,"anchorX",t._getAnchorX,t._setAnchorX),cc.defineGetterSetter(t,"anchorY",t._getAnchorY,t._setAnchorY),cc.defineGetterSetter(t,"scale",t.getScale,t.setScale),cc.defineGetterSetter(t,"scaleX",t.getScaleX,t.setScaleX),cc.defineGetterSetter(t,"scaleY",t.getScaleY,t.setScaleY),cc.defineGetterSetter(t,"rotation",t.getRotation,t.setRotation),cc.defineGetterSetter(t,"skewX",t.getSkewX,t.setSkewX),cc.defineGetterSetter(t,"skewY",t.getSkewY,t.setSkewY),cc.defineGetterSetter(t,"visible",t.isVisible,t.setVisible),cc.defineGetterSetter(t,"parent",t.getParent,t.setParent),cc.defineGetterSetter(t,"opacity",t.getOpacity,t.setOpacity)},cc.DOM.methods={setPosition:function(t,e){void 0===e?(this._position.x=t.x,this._position.y=t.y):(this._position.x=t,this._position.y=e),this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setPositionY:function(t){this._position.y=t,this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setPositionX:function(t){this._position.x=t,this.setNodeDirty(),this.dom.translates(this._position.x,-this._position.y)},setScale:function(t,e){this._scaleX=t,this._scaleY=e||t,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setScaleX:function(t){this._scaleX=t,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setScaleY:function(t){this._scaleY=t,this.setNodeDirty(),this.dom.resize(this._scaleX,this._scaleY)},setAnchorPoint:function(t,e){var i=this._renderCmd,n=this._anchorPoint;void 0===e?(n.x=t.x,n.y=t.y):(n.x=t,n.y=e);var r=i._anchorPointInPoints,o=this._contentSize;r.x=o.width*n.x,r.y=o.height*n.y,this.dom.style[cc.$.pfx+"TransformOrigin"]=""+r.x+"px "+-r.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):(this.dom.style.marginLeft=this.isToggler?0:-r.x+"px",this.dom.style.marginBottom=-r.y+"px"),this.setNodeDirty()},_setAnchorX:function(t){var e=this._anchorPoint,i=this._renderCmd;if(t!==e.x){e.x=t;var n=i._anchorPointInPoints,r=this._contentSize;n.x=r.width*e.x,this.dom.style[cc.$.pfx+"TransformOrigin"]=""+n.x+"px "+-n.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):this.dom.style.marginLeft=this.isToggler?0:-n.x+"px",this.setNodeDirty()}},_setAnchorY:function(t){var e=this._anchorPoint,i=this._renderCmd;if(t!==e.y){e.y=t;var n=i._anchorPointInPoints,r=this._contentSize;n.y=r.height*e.y,this.dom.style[cc.$.pfx+"TransformOrigin"]=""+n.x+"px "+-n.y+"px",this.ignoreAnchor?(this.dom.style.marginLeft=0,this.dom.style.marginBottom=0):this.dom.style.marginBottom=-n.y+"px",this.setNodeDirty()}},setContentSize:function(t,e){var i=this._renderCmd,n=this._contentSize;void 0===e?(n.width=t.width,n.height=t.height):(n.width=t,n.height=e);var r=i._anchorPointInPoints,o=this._anchorPoint;r.x=n.width*o.x,r.y=n.height*o.y,this.dom.width=n.width,this.dom.height=n.height,this.setAnchorPoint(this.getAnchorPoint()),this.canvas&&(this.canvas.width=n.width,this.canvas.height=n.height),this.setNodeDirty(),this.redraw()},_setWidth:function(t){var e=this._contentSize,i=this._renderCmd;if(t!==e.width){e.width=t;var n=i._anchorPointInPoints,r=this._anchorPoint;n.x=e.width*r.x,this.dom.width=e.width,this.anchorX=r.x,this.canvas&&(this.canvas.width=e.width),this.setNodeDirty(),this.redraw()}},_setHeight:function(t){var e=this._contentSize,i=this._renderCmd;if(t!==e.height){e.height=t;var n=i._anchorPointInPoints,r=this._anchorPoint;n.y=e.height*r.y,this.dom.height=e.height,this.anchorY=r.y,this.canvas&&(this.canvas.height=e.height),this.setNodeDirty(),this.redraw()}},setRotation:function(t){this._rotation!==t&&(this._rotationX=this._rotationY=t,this.setNodeDirty(),this.dom.rotate(t))},setSkewX:function(t){this._skewX=t,this.setNodeDirty(),this.dom.setSkew(this._skewX,this._skewY)},setSkewY:function(t){this._skewY=t,this.setNodeDirty(),this.dom.setSkew(this._skewX,this._skewY)},setVisible:function(t){this._visible=t,this.setNodeDirty(),this.dom&&(this.dom.style.display=t?"block":"none")},_setLocalZOrder:function(t){this._localZOrder=t,this.setNodeDirty(),this.dom&&(this.dom.zIndex=t)},setParent:function(t){this._parent=t,null!==t&&(t.setAnchorPoint(t.getAnchorPoint()),this.setNodeDirty(),cc.DOM.parentDOM(this))},resume:function(){this.getScheduler().resumeTarget(this),this.getActionManager().resumeTarget(this),cc.eventManager.resumeTarget(this),this.dom&&!this.dom.parentNode&&(this.getParent()?cc.DOM.parentDOM(this):""===this.dom.id?cc.DOM._createEGLViewDiv(this):this.dom.appendTo(cc.container)),this.dom&&(this.dom.style.visibility="visible")},pause:function(){this.getScheduler().pauseTarget(this),this.getActionManager().pauseTarget(this),cc.eventManager.pauseTarget(this),this.dom&&(this.dom.style.visibility="hidden")},cleanup:function(){this.stopAllActions(),this.unscheduleAllCallbacks(),cc.eventManager.removeListeners(this),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup),this.dom&&this.dom.remove()},setOpacity:function(t){this._opacity=t,this.dom.style.opacity=t/255},redraw:function(){if(this.isSprite){var t=this._children;this._children=[],cc.Sprite.prototype.visit.call(this,this.ctx),this._children=t}else cc.Sprite.prototype.visit.call(this,this.ctx)}},cc.DOM._resetEGLViewDiv=function(){var t=cc.$("#EGLViewDiv");if(t){var e=cc.view,i=e.getDesignResolutionSize(),n=e.getViewPortRect(),r=e.getFrameSize(),o=e.getDevicePixelRatio(),s=i.width,c=i.height,a=parseInt(cc.container.style.paddingLeft),l=parseInt(cc.container.style.paddingBottom);0===i.width&&0===i.height&&(s=r.width,c=r.height);var h=n.width/o;0===n.width&&0===n.height&&(h=r.width),t.style.position="absolute",t.style.width=s+"px",t.style.maxHeight=c+"px",t.style.margin=0,t.resize(e.getScaleX()/o,e.getScaleY()/o),t.translates(a,-l),e.getResolutionPolicy()===e._rpNoBorder?(t.style.left=(e.getFrameSize().width-s)/2+"px",t.style.bottom=(e.getFrameSize().height-c*e.getScaleY()/o)/2+"px"):(t.style.left=(s*e.getScaleX()/o-s)/2+"px",t.style.bottom="0px")}},cc.DOM.parentDOM=function(t){var e=t.getParent();if(!e||!t.dom)return!1;if(e.dom||(cc.DOM.placeHolder(e),e.setParent=cc.DOM.methods.setParent),t.dom.appendTo(e.dom),e.setAnchorPoint(e.getAnchorPoint()),e.getParent())cc.DOM.parentDOM(e);else if(e.isRunning()){var i=cc.$("#EGLViewDiv");i?e.dom.appendTo(i):cc.DOM._createEGLViewDiv(e)}return!0},cc.DOM._createEGLViewDiv=function(t){var e=cc.$("#EGLViewDiv");e||(e=cc.$new("div"),e.id="EGLViewDiv");var i=cc.view,n=i.getDesignResolutionSize(),r=i.getViewPortRect(),o=i.getFrameSize(),s=i.getDevicePixelRatio(),c=n.width,a=n.height,l=parseInt(cc.container.style.paddingLeft),h=parseInt(cc.container.style.paddingBottom);0===n.width&&0===n.height&&(c=o.width,a=o.height);var u=r.width/s;0===r.width&&0===r.height&&(u=o.width),e.style.position="absolute",e.style.width=c+"px",e.style.maxHeight=a+"px",e.style.margin=0,e.resize(i.getScaleX()/s,i.getScaleY()/s),e.translates(l,-h),i.getResolutionPolicy()===i._rpNoBorder?(e.style.left=(o.width-c)/2+"px",e.style.bottom=(o.height-a*i.getScaleY()/s)/2+"px"):(e.style.left=(c*i.getScaleX()/s-c)/2+"px",e.style.bottom="0px"),t.dom.appendTo(e),e.appendTo(cc.container)},cc.DOM.setTransform=function(t){if(t.ctx)if(t.ctx.translate(t.getAnchorPointInPoints().x,t.getAnchorPointInPoints().y),t.isSprite){var e=t._children;t._children=[],cc.Sprite.prototype.visit.call(t),t._children=e}else cc.Sprite.prototype.visit.call(t);t.dom&&(t.dom.position.x=t.getPositionX(),t.dom.position.y=-t.getPositionY(),t.dom.rotation=t.getRotation(),t.dom.scale={x:t.getScaleX(),y:t.getScaleY()},t.dom.skew={x:t.getSkewX(),y:t.getSkewY()},t.setAnchorPoint&&t.setAnchorPoint(t.getAnchorPoint()),t.dom.transforms())},cc.DOM.forSprite=function(t){t.dom=cc.$new("div"),t.canvas=cc.$new("canvas");var e=t.getContentSize();t.canvas.width=e.width,t.canvas.height=e.height,t.dom.style.position="absolute",t.dom.style.bottom=0,t.ctx=t.canvas.getContext("2d"),t.dom.appendChild(t.canvas),t.getParent()&&cc.DOM.parentDOM(t),t.isSprite=!0},cc.DOM.placeHolder=function(t){t.dom=cc.$new("div"),t.placeholder=!0,t.dom.style.position="absolute",t.dom.style.bottom=0,t.dom.style.width=(t.getContentSize().width||cc.director.getWinSize().width)+"px",t.dom.style.maxHeight=(t.getContentSize().height||cc.director.getWinSize().height)+"px",t.dom.style.margin=0,cc.DOM.setTransform(t),t.dom.transforms(),cc.DOM._addMethods(t)},cc.DOM.convert=function(t){if(arguments.length>1)return void cc.DOM.convert(arguments);if(1===arguments.length&&!arguments[0].length)return void cc.DOM.convert([arguments[0]]);for(var e=arguments[0],i=0;i<e.length;i++)e[i]instanceof cc.Sprite?e[i].dom||cc.DOM.forSprite(e[i]):cc.log("DOM converter only supports sprite and menuitems yet"),cc.DOM._addMethods(e[i]),e[i].visit=function(){},e[i].transform=function(){},cc.DOM.setTransform(e[i]),e[i].setVisible(e[i].isVisible())},cc.KEYBOARD_RETURNTYPE_DEFAULT=0,cc.KEYBOARD_RETURNTYPE_DONE=1,cc.KEYBOARD_RETURNTYPE_SEND=2,cc.KEYBOARD_RETURNTYPE_SEARCH=3,cc.KEYBOARD_RETURNTYPE_GO=4,cc.EDITBOX_INPUT_MODE_ANY=0,cc.EDITBOX_INPUT_MODE_EMAILADDR=1,cc.EDITBOX_INPUT_MODE_NUMERIC=2,cc.EDITBOX_INPUT_MODE_PHONENUMBER=3,cc.EDITBOX_INPUT_MODE_URL=4,cc.EDITBOX_INPUT_MODE_DECIMAL=5,cc.EDITBOX_INPUT_MODE_SINGLELINE=6,cc.EDITBOX_INPUT_FLAG_PASSWORD=0,cc.EDITBOX_INPUT_FLAG_SENSITIVE=1,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD=2,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE=3,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS=4,cc.EditBoxDelegate=cc.Class.extend({editBoxEditingDidBegin:function(t){},editBoxEditingDidEnd:function(t){},editBoxTextChanged:function(t,e){},editBoxReturn:function(t){}}),cc.EditBox=cc.ControlButton.extend({_domInputSprite:null,_delegate:null,_editBoxInputMode:cc.EDITBOX_INPUT_MODE_ANY,_editBoxInputFlag:cc.EDITBOX_INPUT_FLAG_SENSITIVE,_keyboardReturnType:cc.KEYBOARD_RETURNTYPE_DEFAULT,_text:"",_placeholderText:"",_textColor:null,_placeholderColor:null,_maxLength:50,_adjustHeight:18,_edTxt:null,_edFontSize:14,_edFontName:"Arial",_placeholderFontName:"",_placeholderFontSize:14,_tooltip:!1,_className:"EditBox",_onCanvasClick:null,_inputEvent:null,_keyPressEvent:null,_focusEvent:null,_blurEvent:null,ctor:function(t,e,i,n){cc.ControlButton.prototype.ctor.call(this),this._textColor=cc.color.WHITE,this._placeholderColor=cc.color.GRAY,this.setContentSize(t);var r=this._domInputSprite=new cc.Sprite;r.draw=function(){},this.addChild(r);var o=this._edTxt=document.createElement("input");o.type="text",o.style.fontSize=this._edFontSize+"px",o.style.color="#000000",o.style.border=0,o.style.background="transparent",o.style.width="100%",o.style.height="100%",o.style.active=0,o.style.outline="medium",o.style.padding="0";var s=function(){this._edTxt.blur()};this._onCanvasClick=s.bind(this);var c=function(){this._delegate&&this._delegate.editBoxTextChanged&&this._delegate.editBoxTextChanged(this,this._edTxt.value)};this._inputEvent=c.bind(this);var a=function(t){t.keyCode===cc.KEY.enter&&(t.stopPropagation(),t.preventDefault(),this._delegate&&this._delegate.editBoxReturn&&this._delegate.editBoxReturn(this),cc._canvas.focus())};this._keyPressEvent=a.bind(this);var l=function(){this._edTxt.value===this._placeholderText&&(this._edTxt.value="",this._edTxt.style.fontSize=this._edFontSize+"px",this._edTxt.style.color=cc.colorToHex(this._textColor),this._editBoxInputFlag===cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"),this._delegate&&this._delegate.editBoxEditingDidBegin&&this._delegate.editBoxEditingDidBegin(this),cc._canvas.addEventListener("click",this._onCanvasClick)};this._focusEvent=l.bind(this);var h=function(){""===this._edTxt.value&&(this._edTxt.value=this._placeholderText,this._edTxt.style.fontSize=this._placeholderFontSize+"px",this._edTxt.style.color=cc.colorToHex(this._placeholderColor),this._edTxt.type="text"),this._delegate&&this._delegate.editBoxEditingDidEnd&&this._delegate.editBoxEditingDidEnd(this),cc._canvas.removeEventListener("click",this._onCanvasClick)};this._blurEvent=h.bind(this),o.addEventListener("input",this._inputEvent),o.addEventListener("keypress",this._keyPressEvent),o.addEventListener("focus",this._focusEvent),o.addEventListener("blur",this._blurEvent),cc.DOM.convert(r),r.dom.appendChild(o),r.dom.showTooltipDiv=!1,r.dom.style.width=t.width-6+"px",r.dom.style.height=t.height-6+"px",r.canvas.remove(),this.initWithSizeAndBackgroundSprite(t,e)&&(i&&this.setBackgroundSpriteForState(i,cc.CONTROL_STATE_HIGHLIGHTED),n&&this.setBackgroundSpriteForState(n,cc.CONTROL_STATE_DISABLED))},setFont:function(t,e){this._edFontSize=e,this._edFontName=t,this._setFontToEditBox()},_setFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._edFontSize=parseInt(e[1]),this._edFontName=e[2],this._setFontToEditBox())},setFontName:function(t){this._edFontName=t,this._setFontToEditBox()},setFontSize:function(t){this._edFontSize=t,this._setFontToEditBox()},_setFontToEditBox:function(){this._edTxt.value!==this._placeholderText&&(this._edTxt.style.fontFamily=this._edFontName,this._edTxt.style.fontSize=this._edFontSize+"px",this._editBoxInputFlag===cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text")},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){null!=t&&(""===t?(this._edTxt.value=this._placeholderText,this._edTxt.style.color=cc.colorToHex(this._placeholderColor),this._edTxt.type="text"):(this._edTxt.value=t,this._edTxt.style.color=cc.colorToHex(this._textColor),this._editBoxInputFlag===cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"))},setFontColor:function(t){this._textColor=t,this._edTxt.value!==this._placeholderText&&(this._edTxt.style.color=cc.colorToHex(t))},setMaxLength:function(t){!isNaN(t)&&t>0&&(this._maxLength=t,this._edTxt.maxLength=t)},getMaxLength:function(){return this._maxLength},setPlaceHolder:function(t){if(null!=t){var e=this._placeholderText;this._placeholderText=t,this._edTxt.value===e&&(this._edTxt.value=t,this._edTxt.style.color=cc.colorToHex(this._placeholderColor),this._setPlaceholderFontToEditText())}},setPlaceholderFont:function(t,e){this._placeholderFontName=t,this._placeholderFontSize=e,this._setPlaceholderFontToEditText()},_setPlaceholderFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._placeholderFontName=e[2],this._placeholderFontSize=parseInt(e[1]),this._setPlaceholderFontToEditText())},setPlaceholderFontName:function(t){this._placeholderFontName=t,this._setPlaceholderFontToEditText()},setPlaceholderFontSize:function(t){this._placeholderFontSize=t,this._setPlaceholderFontToEditText()},_setPlaceholderFontToEditText:function(){this._edTxt.value===this._placeholderText&&(this._edTxt.style.fontFamily=this._placeholderFontName,this._edTxt.style.fontSize=this._placeholderFontSize+"px",this._edTxt.type="text")},setPlaceholderFontColor:function(t){this._placeholderColor=t,this._edTxt.value===this._placeholderText&&(this._edTxt.style.color=cc.colorToHex(t))},setInputFlag:function(t){this._editBoxInputFlag=t,this._edTxt.value!==this._placeholderText&&t===cc.EDITBOX_INPUT_FLAG_PASSWORD?this._edTxt.type="password":this._edTxt.type="text"},getText:function(){return cc.log("Please use the getString"),this._edTxt.value},getString:function(){return this._edTxt.value===this._placeholderText?"":this._edTxt.value},initWithSizeAndBackgroundSprite:function(t,e){return!!this.initWithBackgroundSprite(e)&&(this._domInputSprite.x=3,this._domInputSprite.y=3,this.setZoomOnTouchDown(!1),this.setPreferredSize(t),this.x=0,this.y=0,this._addTargetWithActionForControlEvent(this,this.touchDownAction,cc.CONTROL_EVENT_TOUCH_UP_INSIDE),!0)},setDelegate:function(t){this._delegate=t},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(t){this._editBoxInputMode=t},setReturnType:function(t){this._keyboardReturnType=t},keyboardWillShow:function(t){var e=cc.EditBox.getRect(this);return e.y-=4,e.intersectsRect(t.end)?void(this._adjustHeight=t.end.getMaxY()-e.getMinY()):void cc.log("needn't to adjust view layout.")},keyboardDidShow:function(t){},keyboardWillHide:function(t){},keyboardDidHide:function(t){},touchDownAction:function(t,e){},initWithBackgroundColor:function(t,e){this._edWidth=t.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=t.height,this.dom.style.height=this._edHeight.toString()+"px",this.dom.style.backgroundColor=cc.colorToHex(e)},cleanup:function(){this._edTxt.removeEventListener("input",this._inputEvent),this._edTxt.removeEventListener("keypress",this._keyPressEvent),this._edTxt.removeEventListener("focus",this._focusEvent),this._edTxt.removeEventListener("blur",this._blurEvent),cc._canvas.removeEventListener("click",this._onCanvasClick),this._super()}});var _p=cc.EditBox.prototype;_p.font,cc.defineGetterSetter(_p,"font",null,_p._setFont),_p.fontName,cc.defineGetterSetter(_p,"fontName",null,_p.setFontName),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",null,_p.setFontSize),_p.fontColor,cc.defineGetterSetter(_p,"fontColor",null,_p.setFontColor),_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.maxLength,cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),_p.placeHolderFont,cc.defineGetterSetter(_p,"placeHolderFont",null,_p._setPlaceholderFont),_p.placeHolderFontName,cc.defineGetterSetter(_p,"placeHolderFontName",null,_p.setPlaceholderFontName),_p.placeHolderFontSize,cc.defineGetterSetter(_p,"placeHolderFontSize",null,_p.setPlaceholderFontSize),_p.placeHolderFontColor,cc.defineGetterSetter(_p,"placeHolderFontColor",null,_p.setPlaceholderFontColor),_p.inputFlag,cc.defineGetterSetter(_p,"inputFlag",null,_p.setInputFlag),_p.delegate,cc.defineGetterSetter(_p,"delegate",null,_p.setDelegate),_p.inputMode,cc.defineGetterSetter(_p,"inputMode",null,_p.setInputMode),_p.returnType,cc.defineGetterSetter(_p,"returnType",null,_p.setReturnType),_p=null,cc.EditBox.getRect=function(t){var e=t.getContentSize(),i=cc.rect(0,0,e.width,e.height);return cc.rectApplyAffineTransform(i,t.getNodeToWorldTransform())},cc.EditBox.create=function(t,e,i,n){return new cc.EditBox(t,e,i,n)};cc.ProtectedNode=cc.Node.extend({_protectedChildren:null,_reorderProtectedChildDirty:!1,_insertProtectedChild:function(t,e){this._reorderProtectedChildDirty=!0,this._protectedChildren.push(t),t._setLocalZOrder(e)},ctor:function(){cc.Node.prototype.ctor.call(this),this._protectedChildren=[]},addProtectedChild:function(t,e,i){cc.assert(null!=t,"child must be non-nil"),cc.assert(!t.parent,"child already added. It can't be added again"),e=e||t.getLocalZOrder(),i&&t.setTag(i),this._insertProtectedChild(t,e),t.setParent(this),t.setOrderOfArrival(cc.s_globalOrderOfArrival),this._running&&(t.onEnter(),this._isTransitionFinished&&t.onEnterTransitionDidFinish()),this._cascadeColorEnabled&&this._renderCmd.setCascadeColorEnabledDirty(),this._cascadeOpacityEnabled&&this._renderCmd.setCascadeOpacityEnabledDirty()},getProtectedChildByTag:function(t){cc.assert(t!==cc.NODE_TAG_INVALID,"Invalid tag");for(var e=this._protectedChildren,i=0,n=e.length;i<n;i++)if(e.getTag()===t)return e[i];return null},removeProtectedChild:function(t,e){null==e&&(e=!0);var i=this._protectedChildren;if(0!==i.length){var n=i.indexOf(t);n>-1&&(this._running&&(t.onExitTransitionDidStart(),t.onExit()),e&&t.cleanup(),t.setParent(null),i.splice(n,1))}},removeProtectedChildByTag:function(t,e){cc.assert(t!==cc.NODE_TAG_INVALID,"Invalid tag"),null==e&&(e=!0);var i=this.getProtectedChildByTag(t);null==i?cc.log("cocos2d: removeChildByTag(tag = %d): child not found!",t):this.removeProtectedChild(i,e)},removeAllProtectedChildren:function(){this.removeAllProtectedChildrenWithCleanup(!0)},removeAllProtectedChildrenWithCleanup:function(t){null==t&&(t=!0);for(var e=this._protectedChildren,i=0,n=e.length;i<n;i++){var r=e[i];this._running&&(r.onExitTransitionDidStart(),r.onExit()),t&&r.cleanup(),r.setParent(null)}e.length=0},reorderProtectedChild:function(t,e){cc.assert(null!=t,"Child must be non-nil"),this._reorderProtectedChildDirty=!0,t.setOrderOfArrival(cc.s_globalOrderOfArrival++),t._setLocalZOrder(e)},sortAllProtectedChildren:function(){if(this._reorderProtectedChildDirty){var t,e,i,n=this._protectedChildren,r=n.length;for(t=1;t<r;t++){for(i=n[t],e=t-1;e>=0;){if(i._localZOrder<n[e]._localZOrder)n[e+1]=n[e];else{if(!(i._localZOrder===n[e]._localZOrder&&i.arrivalOrder<n[e].arrivalOrder))break;n[e+1]=n[e]}e--}n[e+1]=i}this._reorderProtectedChildDirty=!1}},_changePosition:function(){},cleanup:function(){cc.Node.prototype.cleanup.call(this);for(var t=this._protectedChildren,e=0,i=t.length;e<i;e++)t[e].cleanup()},onEnter:function(){cc.Node.prototype.onEnter.call(this);for(var t=this._protectedChildren,e=0,i=t.length;e<i;e++)t[e].onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this);for(var t=this._protectedChildren,e=0,i=t.length;e<i;e++)t[e].onEnterTransitionDidFinish()},onExit:function(){cc.Node.prototype.onExit.call(this);for(var t=this._protectedChildren,e=0,i=t.length;e<i;e++)t[e].onExit()},onExitTransitionDidStart:function(){cc.Node.prototype.onExitTransitionDidStart.call(this);for(var t=this._protectedChildren,e=0,i=t.length;e<i;e++)t[e].onExitTransitionDidStart()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ProtectedNode.CanvasRenderCmd(this):new cc.ProtectedNode.WebGLRenderCmd(this)}}),cc.ProtectedNode.create=function(){return new cc.ProtectedNode},function(){cc.ProtectedNode.RenderCmd={_updateDisplayColor:function(t){var e,i,n,r,o=this._node,s=this._displayedColor,c=o._realColor;if(this._cascadeColorEnabledDirty&&!o._cascadeColorEnabled){s.r=c.r,s.g=c.g,s.b=c.b;var a=new cc.Color(255,255,255,255);for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&r._renderCmd._updateDisplayColor(a);this._cascadeColorEnabledDirty=!1}else{if(void 0===t){var l=o._parent;t=l&&l._cascadeColorEnabled?l.getDisplayedColor():cc.color.WHITE}if(s.r=0|c.r*t.r/255,s.g=0|c.g*t.g/255,s.b=0|c.b*t.b/255,o._cascadeColorEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor());for(n=o._protectedChildren,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayColor(s),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty^this._dirtyFlag},_updateDisplayOpacity:function(t){var e,i,n,r,o=this._node;if(this._cascadeOpacityEnabledDirty&&!o._cascadeOpacityEnabled){for(this._displayedOpacity=o._realOpacity,n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&r._renderCmd._updateDisplayOpacity(255);this._cascadeOpacityEnabledDirty=!1}else{if(void 0===t){var s=o._parent;t=255,s&&s._cascadeOpacityEnabled&&(t=s.getDisplayedOpacity())}if(this._displayedOpacity=o._realOpacity*t/255,o._cascadeOpacityEnabled)for(n=o._children,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor());for(n=o._protectedChildren,e=0,i=n.length;e<i;e++)r=n[e],r&&r._renderCmd&&(r._renderCmd._updateDisplayOpacity(this._displayedOpacity),r._renderCmd._updateColor())}this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty^this._dirtyFlag},_changeProtectedChild:function(t){var e=t._renderCmd,i=e._dirtyFlag,n=cc.Node._dirtyFlags;this._dirtyFlag&n.colorDirty&&(i|=n.colorDirty),this._dirtyFlag&n.opacityDirty&&(i|=n.opacityDirty);var r=i&n.colorDirty,o=i&n.opacityDirty;r&&e._updateDisplayColor(this._displayedColor),o&&e._updateDisplayOpacity(this._displayedOpacity),(r||o)&&e._updateColor()}},cc.ProtectedNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._cachedParent=null,this._cacheDirty=!1};var t=cc.ProtectedNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(cc.ProtectedNode.RenderCmd,t),t.constructor=cc.ProtectedNode.CanvasRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){var i,n,r,o=e._children,s=e._children,c=e._protectedChildren,a=s.length,l=c.length;this._syncStatus(t),e.sortAllChildren(),e.sortAllProtectedChildren();var h;for(i=0;i<a&&(r=o[i],r._localZOrder<0);i++)r.visit(this);for(n=0;n<l&&(h=c[n],h&&h._localZOrder<0);n++)this._changeProtectedChild(h),h.visit(this);for(cc.renderer.pushRenderCommand(this);i<a;i++)o[i]&&o[i].visit(this);for(;n<l;n++)h=c[n],h&&(this._changeProtectedChild(h),h.visit(this));this._dirtyFlag=0,this._cacheDirty=!1}},t.transform=function(t,e){var i=this._node;i._changePosition&&i._changePosition(),this.originTransform(t,e);var n,r,o=i._protectedChildren;if(e&&o&&0!==o.length)for(n=0,r=o.length;n<r;n++)o[n]._renderCmd.transform(this,e)},t.pNodeVisit=t.visit,t.pNodeTransform=t.transform}(),function(){if(cc.Node.WebGLRenderCmd){cc.ProtectedNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t)};var t=cc.ProtectedNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(cc.ProtectedNode.RenderCmd,t),t.constructor=cc.ProtectedNode.WebGLRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){var i,n;this._syncStatus(t);var r=e.grid;r&&r._active&&r.beforeDraw();var o=e._children,s=e._protectedChildren,c=o.length,a=s.length;e.sortAllChildren(),e.sortAllProtectedChildren();var l;for(i=0;i<c&&(o[i]&&o[i]._localZOrder<0);i++)o[i].visit(this);for(n=0;n<a&&(l=s[n],l&&l._localZOrder<0);n++)this._changeProtectedChild(l),l.visit(this);for(cc.renderer.pushRenderCommand(this);i<c;i++)o[i]&&o[i].visit(this);for(;n<a;n++)l=s[n],l&&(this._changeProtectedChild(l),l.visit(this));r&&r._active&&r.afterDraw(e),this._dirtyFlag=0}},t.transform=function(t,e){this.originTransform(t,e);var i,n,r=this._node._protectedChildren;if(e&&r&&0!==r.length)for(i=0,n=r.length;i<n;i++)r[i]._renderCmd.transform(this,e)},t.pNodeVisit=t.visit,t.pNodeTransform=t.transform}}();var ccui=ccui||{};ccui.Class=ccui.Class||cc.Class,ccui.Class.extend=ccui.Class.extend||cc.Class.extend,ccui.Node=ccui.Node||cc.Node,ccui.Node.extend=ccui.Node.extend||cc.Node.extend,ccui.ProtectedNode=ccui.ProtectedNode||cc.ProtectedNode,ccui.ProtectedNode.extend=ccui.ProtectedNode.extend||cc.ProtectedNode.extend,ccui.cocosGUIVersion="CocosGUI v1.0.0.0",ccui._FocusNavigationController=cc.Class.extend({_keyboardListener:null,_firstFocusedWidget:null,_enableFocusNavigation:!1,_keyboardEventPriority:1,enableFocusNavigation:function(t){this._enableFocusNavigation!==t&&(this._enableFocusNavigation=t,t?this._addKeyboardEventListener():this._removeKeyboardEventListener())},_setFirstFocsuedWidget:function(t){this._firstFocusedWidget=t},_onKeyPressed:function(t,e){this._enableFocusNavigation&&this._firstFocusedWidget&&(t===cc.KEY.dpadDown&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.DOWN,this._firstFocusedWidget)),t===cc.KEY.dpadUp&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.UP,this._firstFocusedWidget)),t===cc.KEY.dpadLeft&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.LEFT,this._firstFocusedWidget)),t===cc.KEY.dpadRight&&(this._firstFocusedWidget=this._firstFocusedWidget.findNextFocusedWidget(ccui.Widget.RIGHT,this._firstFocusedWidget)))},_addKeyboardEventListener:function(){this._keyboardListener||(this._keyboardListener=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyReleased:this._onKeyPressed.bind(this)}),cc.eventManager.addListener(this._keyboardListener,this._keyboardEventPriority))},_removeKeyboardEventListener:function(){this._keyboardListener&&(cc.eventManager.removeEventListener(this._keyboardListener),this._keyboardListener=null)}}),ccui.__LAYOUT_COMPONENT_NAME="__ui_layout",ccui.Widget=ccui.ProtectedNode.extend({_enabled:!0,_bright:!0,_touchEnabled:!1,_brightStyle:null,_touchBeganPosition:null,_touchMovePosition:null,_touchEndPosition:null,_touchEventListener:null,_touchEventSelector:null,_name:"default",_widgetType:null,_actionTag:0,_customSize:null,_layoutParameterDictionary:null,_layoutParameterType:0,_focused:!1,_focusEnabled:!0,_ignoreSize:!1,_affectByClipping:!1,_sizeType:null,_sizePercent:null,_positionType:null,_positionPercent:null,_hit:!1,_nodes:null,_touchListener:null,_className:"Widget",_flippedX:!1,_flippedY:!1,_opacity:255,_highlight:!1,_touchEventCallback:null,_clickEventListener:null,_propagateTouchEvents:!0,_unifySize:!1,_callbackName:null,_callbackType:null,_usingLayoutComponent:!1,_inViewRect:!0,ctor:function(){cc.ProtectedNode.prototype.ctor.call(this),this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._touchBeganPosition=cc.p(0,0),this._touchMovePosition=cc.p(0,0),this._touchEndPosition=cc.p(0,0),this._widgetType=ccui.Widget.TYPE_WIDGET,this._customSize=cc.size(0,0),this._layoutParameterDictionary={},this._sizeType=ccui.Widget.SIZE_ABSOLUTE,this._sizePercent=cc.p(0,0),this._positionType=ccui.Widget.POSITION_ABSOLUTE,this._positionPercent=cc.p(0,0),this._nodes=[],this._layoutParameterType=ccui.LayoutParameter.NONE,ccui.Widget.prototype.init.call(this)},init:function(){return!!cc.ProtectedNode.prototype.init.call(this)&&(this._layoutParameterDictionary={},this._initRenderer(),this.setBright(!0),this.onFocusChanged=this.onFocusChange,this.onNextFocusedWidget=null,this.setAnchorPoint(cc.p(.5,.5)),this.ignoreContentAdaptWithSize(!0),!0)},onEnter:function(){var t=this._touchListener;t&&!t._isRegistered()&&this._touchEnabled&&cc.eventManager.addListener(t,this),this._usingLayoutComponent||this.updateSizeAndPosition(),cc.ProtectedNode.prototype.onEnter.call(this)},onExit:function(){this.unscheduleUpdate(),cc.ProtectedNode.prototype.onExit.call(this)},_getOrCreateLayoutComponent:function(){var t=this.getComponent(ccui.__LAYOUT_COMPONENT_NAME);return null==t&&(t=new ccui.LayoutComponent,this.addComponent(t)),t},getWidgetParent:function(){var t=this.getParent();return t instanceof ccui.Widget?t:null},_updateContentSizeWithTextureSize:function(t){return this._unifySize?void this.setContentSize(t):void this.setContentSize(this._ignoreSize?t:this._customSize)},_isAncestorsEnabled:function(){var t=this._getAncensterWidget(this);return null==t||!(t&&!t.isEnabled())&&t._isAncestorsEnabled()},setPropagateTouchEvents:function(t){this._propagateTouchEvents=t},isPropagateTouchEvents:function(){return this._propagateTouchEvents},setSwallowTouches:function(t){this._touchListener&&this._touchListener.setSwallowTouches(t)},isSwallowTouches:function(){return!!this._touchListener&&this._touchListener.isSwallowTouches()},_getAncensterWidget:function(t){if(null==t)return null;var e=t.getParent();return null==e?null:e instanceof ccui.Widget?e:this._getAncensterWidget(e.getParent())},_isAncestorsVisible:function(t){if(null==t)return!0;var e=t.getParent();return!(e&&!e.isVisible())&&this._isAncestorsVisible(e)},_cleanupWidget:function(){this._eventDispatcher.removeEventListener(this._touchListener),this._touchEnabled=!1,this._touchListener=null,ccui.Widget._focusedWidget===this&&(ccui.Widget._focusedWidget=null,ccui.Widget._focusNavigationController=null)},setEnabled:function(t){this._enabled=t},_initRenderer:function(){},setContentSize:function(t,e){var i=void 0===e?t.width:t,n=void 0===e?t.height:e;if(cc.Node.prototype.setContentSize.call(this,i,n),this._customSize.width=i,this._customSize.height=n,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var r=this.getWidgetParent(),o=r?r.getContentSize():this._parent.getContentSize();this._sizePercent.x=o.width>0?i/o.width:0,this._sizePercent.y=o.height>0?n/o.height:0}this._onSizeChanged()},_setWidth:function(t){if(cc.Node.prototype._setWidth.call(this,t),this._customSize.width=t,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var e=this.getWidgetParent(),i=e?e.width:this._parent.width;this._sizePercent.x=i>0?this._customSize.width/i:0}this._onSizeChanged()},_setHeight:function(t){if(cc.Node.prototype._setHeight.call(this,t),this._customSize.height=t,this._unifySize||this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),!this._usingLayoutComponent&&this._running){var e=this.getWidgetParent(),i=e?e.height:this._parent.height;this._sizePercent.y=i>0?this._customSize.height/i:0}this._onSizeChanged()},setSizePercent:function(t){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();return e.setUsingPercentContentSize(!0),e.setPercentContentSize(t),void e.refreshLayout()}this._sizePercent.x=t.x,this._sizePercent.y=t.y;var i=this._customSize.width,n=this._customSize.height;if(this._running){var r=this.getWidgetParent();r?(i=r.width*t.x,n=r.height*t.y):(i=this._parent.width*t.x,n=this._parent.height*t.y)}this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(i,n),this._customSize.width=i,this._customSize.height=n},_setWidthPercent:function(t){this._sizePercent.x=t;var e=this._customSize.width;if(this._running){var i=this.getWidgetParent();e=(i?i.width:this._parent.width)*t}this._ignoreSize?this._setWidth(this.getVirtualRendererSize().width):this._setWidth(e),this._customSize.width=e},_setHeightPercent:function(t){this._sizePercent.y=t;var e=this._customSize.height;if(this._running){var i=this.getWidgetParent();e=(i?i.height:this._parent.height)*t}this._ignoreSize?this._setHeight(this.getVirtualRendererSize().height):this._setHeight(e),this._customSize.height=e},updateSizeAndPosition:function(t){if(!t){var e=this.getWidgetParent();t=e?e.getLayoutSize():this._parent.getContentSize()}switch(this._sizeType){case ccui.Widget.SIZE_ABSOLUTE:this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(this._customSize),this._sizePercent.x=t.width>0?this._customSize.width/t.width:0,this._sizePercent.y=t.height>0?this._customSize.height/t.height:0;break;case ccui.Widget.SIZE_PERCENT:var i=cc.size(t.width*this._sizePercent.x,t.height*this._sizePercent.y);this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(i),this._customSize.width=i.width,this._customSize.height=i.height}this._onSizeChanged();var n=this.getPosition();switch(this._positionType){case ccui.Widget.POSITION_ABSOLUTE:t.width<=0||t.height<=0?this._positionPercent.x=this._positionPercent.y=0:(this._positionPercent.x=n.x/t.width,this._positionPercent.y=n.y/t.height);break;case ccui.Widget.POSITION_PERCENT:n=cc.p(t.width*this._positionPercent.x,t.height*this._positionPercent.y)}if(this._parent instanceof ccui.ImageView){var r=this._parent._imageRenderer;if(r&&!r._textureLoaded)return}this.setPosition(n)},setSizeType:function(t){if(this._sizeType=t,this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();e.setUsingPercentContentSize(this._sizeType===ccui.SIZE_PERCENT)}},getSizeType:function(){return this._sizeType},ignoreContentAdaptWithSize:function(t){return this._unifySize?void this.setContentSize(this._customSize):void(this._ignoreSize!==t&&(this._ignoreSize=t,this.setContentSize(t?this.getVirtualRendererSize():this._customSize)))},isIgnoreContentAdaptWithSize:function(){return this._ignoreSize},getCustomSize:function(){return cc.size(this._customSize)},getLayoutSize:function(){return cc.size(this._contentSize)},getSizePercent:function(){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();this._sizePercent=t.getPercentContentSize()}return this._sizePercent},_getWidthPercent:function(){return this._sizePercent.x},_getHeightPercent:function(){return this._sizePercent.y},getWorldPosition:function(){return this.convertToWorldSpace(cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},getVirtualRenderer:function(){return this},getVirtualRendererSize:function(){return cc.size(this._contentSize)},_onSizeChanged:function(){if(!this._usingLayoutComponent)for(var t=this.getChildren(),e=0,i=t.length;e<i;e++){var n=t[e];n instanceof ccui.Widget&&n.updateSizeAndPosition()}},setTouchEnabled:function(t){this._touchEnabled!==t&&(this._touchEnabled=t,this._touchEnabled?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)})),cc.eventManager.addListener(this._touchListener,this)):cc.eventManager.removeListener(this._touchListener))},isTouchEnabled:function(){return this._touchEnabled},isHighlighted:function(){return this._highlight},setHighlighted:function(t){t!==this._highlight&&(this._highlight=t,this._bright?this._highlight?this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT):this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL):this._onPressStateChangedToDisabled())},isFocused:function(){return this._focused},setFocused:function(t){this._focused=t,t&&(ccui.Widget._focusedWidget=this,ccui.Widget._focusNavigationController&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(this))},isFocusEnabled:function(){return this._focusEnabled},setFocusEnabled:function(t){this._focusEnabled=t},findNextFocusedWidget:function(t,e){if(null===this.onNextFocusedWidget||null==this.onNextFocusedWidget(t)){var i=e instanceof ccui.Layout;if(this.isFocused()||i){var n=this.getParent();return null!==n&&n instanceof ccui.Layout?n.findNextFocusedWidget(t,e):i?e.findNextFocusedWidget(t,e):e}return e}var r=this.onNextFocusedWidget(t);return this.dispatchFocusEvent(this,r),r},requestFocus:function(){this!==ccui.Widget._focusedWidget&&this.dispatchFocusEvent(ccui.Widget._focusedWidget,this)},getCurrentFocusedWidget:function(){return ccui.Widget._focusedWidget},onFocusChanged:null,onNextFocusedWidget:null,interceptTouchEvent:function(t,e,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(t,e,i)},onFocusChange:function(t,e){t&&t.setFocused(!1),e&&e.setFocused(!0)},dispatchFocusEvent:function(t,e){t&&!t.isFocused()&&(t=ccui.Widget._focusedWidget),e!==t&&(e&&e.onFocusChanged&&e.onFocusChanged(t,e),t&&e.onFocusChanged&&t.onFocusChanged(t,e),cc.eventManager.dispatchEvent(new cc.EventFocus(t,e)))},setBright:function(t){this._bright=t,this._bright?(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)):this._onPressStateChangedToDisabled()},setBrightStyle:function(t){if(this._brightStyle!==t)switch(t=t||ccui.Widget.BRIGHT_STYLE_NORMAL,this._brightStyle=t,this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:this._onPressStateChangedToNormal();break;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:this._onPressStateChangedToPressed()}},_onPressStateChangedToNormal:function(){},_onPressStateChangedToPressed:function(){},_onPressStateChangedToDisabled:function(){},_updateChildrenDisplayedRGBA:function(){this.setColor(this.getColor()),this.setOpacity(this.getOpacity())},didNotSelectSelf:function(){},onTouchBegan:function(t,e){if(this._hit=!1,this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this)){var i=t.getLocation();this._touchBeganPosition.x=i.x,this._touchBeganPosition.y=i.y,this.hitTest(this._touchBeganPosition)&&this.isClippingParentContainsPoint(this._touchBeganPosition)&&(this._hit=!0)}return!!this._hit&&(this.setHighlighted(!0),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_BEGAN,this,t),this._pushDownEvent(),!0)},propagateTouchEvent:function(t,e,i){var n=this.getWidgetParent();n&&n.interceptTouchEvent(t,e,i)},onTouchMoved:function(t,e){var i=t.getLocation();this._touchMovePosition.x=i.x,this._touchMovePosition.y=i.y,this.setHighlighted(this.hitTest(i)),this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_MOVED,this,t),this._moveEvent()},onTouchEnded:function(t,e){var i=t.getLocation();this._touchEndPosition.x=i.x,this._touchEndPosition.y=i.y,this._propagateTouchEvents&&this.propagateTouchEvent(ccui.Widget.TOUCH_ENDED,this,t);var n=this._highlight;this.setHighlighted(!1),n?this._releaseUpEvent():this._cancelUpEvent()},onTouchCancelled:function(t){this.setHighlighted(!1),this._cancelUpEvent()},onTouchLongClicked:function(t){this.longClickEvent()},_pushDownEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_BEGAN),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_BEGAN)},_moveEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_MOVED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_MOVED)},_releaseUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_ENDED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_ENDED),this._clickEventListener&&this._clickEventListener(this)},_cancelUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_CANCELED),this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_CANCELED)},longClickEvent:function(){},addTouchEventListener:function(t,e){void 0===e?this._touchEventCallback=t:(this._touchEventSelector=t,this._touchEventListener=e)},addClickEventListener:function(t){this._clickEventListener=t},hitTest:function(t){var e=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc.rectContainsPoint(e,this.convertToNodeSpace(t))},isClippingParentContainsPoint:function(t){this._affectByClipping=!1;for(var e=this.getParent(),i=null;e;){if(e instanceof ccui.Layout&&e.isClippingEnabled()){this._affectByClipping=!0,i=e;break}e=e.getParent()}return!this._affectByClipping||(!i||!!i.hitTest(t)&&i.isClippingParentContainsPoint(t))},checkChildInfo:function(t,e,i){var n=this.getWidgetParent();n&&n.checkChildInfo(t,e,i)},setPosition:function(t,e){if(!this._usingLayoutComponent&&this._running){var i=this.getWidgetParent();if(i){var n=i.getContentSize();n.width<=0||n.height<=0?(this._positionPercent.x=0,this._positionPercent.y=0):void 0===e?(this._positionPercent.x=t.x/n.width,this._positionPercent.y=t.y/n.height):(this._positionPercent.x=t/n.width,this._positionPercent.y=e/n.height)}}cc.Node.prototype.setPosition.call(this,t,e)},setPositionX:function(t){if(this._running){var e=this.getWidgetParent();if(e){var i=e.width;i<=0?this._positionPercent.x=0:this._positionPercent.x=t/i}}cc.Node.prototype.setPositionX.call(this,t)},setPositionY:function(t){if(this._running){var e=this.getWidgetParent();if(e){var i=e.height;i<=0?this._positionPercent.y=0:this._positionPercent.y=t/i}}cc.Node.prototype.setPositionY.call(this,t)},setPositionPercent:function(t){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();return e.setPositionPercentX(t.x),e.setPositionPercentY(t.y),void e.refreshLayout()}this._setXPercent(t.x),this._setYPercent(t.y),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},_setXPercent:function(t){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();return e.setPositionPercentX(t.x),void e.refreshLayout()}this._positionPercent.x=t},_setYPercent:function(t){if(this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();return e.setPositionPercentY(t.x),void e.refreshLayout()}this._positionPercent.y=t},getPositionPercent:function(){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()}return cc.p(this._positionPercent)},_getXPercent:function(){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()}return this._positionPercent.x},_getYPercent:function(){if(this._usingLayoutComponent){var t=this._getOrCreateLayoutComponent();this._positionPercent.x=t.getPositionPercentX(),this._positionPercent.y=t.getPositionPercentY()}return this._positionPercent.y},setPositionType:function(t){if(this._positionType=t,this._usingLayoutComponent){var e=this._getOrCreateLayoutComponent();t===ccui.POSITION_ABSOLUTE?(e.setPositionPercentXEnabled(!1),e.setPositionPercentYEnabled(!1)):(e.setPositionPercentXEnabled(!0),e.setPositionPercentYEnabled(!0))}this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionType:function(){return this._positionType},setFlippedX:function(t){var e=this.getScaleX();this._flippedX=t,this.setScaleX(e)},isFlippedX:function(){return this._flippedX},setFlippedY:function(t){var e=this.getScaleY();this._flippedY=t,this.setScaleY(e)},isFlippedY:function(){return this._flippedY},_adaptRenderers:function(){},isBright:function(){return this._bright},isEnabled:function(){return this._enabled},getLeftBoundary:function(){return this.getPositionX()-this._getAnchorX()*this._contentSize.width},getBottomBoundary:function(){return this.getPositionY()-this._getAnchorY()*this._contentSize.height},getRightBoundary:function(){return this.getLeftBoundary()+this._contentSize.width},getTopBoundary:function(){return this.getBottomBoundary()+this._contentSize.height},getTouchBeganPosition:function(){return cc.p(this._touchBeganPosition)},getTouchMovePosition:function(){return cc.p(this._touchMovePosition)},getTouchEndPosition:function(){return cc.p(this._touchEndPosition)},getWidgetType:function(){return this._widgetType},setLayoutParameter:function(t){t&&(this._layoutParameterDictionary[t.getLayoutType()]=t,this._layoutParameterType=t.getLayoutType())},getLayoutParameter:function(t){return t=t||this._layoutParameterType,this._layoutParameterDictionary[t]},getDescription:function(){return"Widget"},clone:function(){var t=this._createCloneInstance();return t._copyProperties(this),t._copyClonedWidgetChildren(this),t},_createCloneInstance:function(){return new ccui.Widget},_copyClonedWidgetChildren:function(t){for(var e=t.getChildren(),i=0;i<e.length;i++){var n=e[i];n instanceof ccui.Widget&&this.addChild(n.clone())}},_copySpecialProperties:function(t){},_copyProperties:function(t){this.setEnabled(t.isEnabled()),this.setVisible(t.isVisible()),this.setBright(t.isBright()),this.setTouchEnabled(t.isTouchEnabled()),this.setLocalZOrder(t.getLocalZOrder()),this.setTag(t.getTag()),this.setName(t.getName()),this.setActionTag(t.getActionTag()),this._ignoreSize=t._ignoreSize,this.setContentSize(t._contentSize),this._customSize.width=t._customSize.width,this._customSize.height=t._customSize.height,this._copySpecialProperties(t),this._sizeType=t.getSizeType(),this._sizePercent.x=t._sizePercent.x,this._sizePercent.y=t._sizePercent.y,this._positionType=t._positionType,this._positionPercent.x=t._positionPercent.x,this._positionPercent.y=t._positionPercent.y,this.setPosition(t.getPosition()),this.setAnchorPoint(t.getAnchorPoint()),this.setScaleX(t.getScaleX()),this.setScaleY(t.getScaleY()),this.setRotation(t.getRotation()),this.setRotationX(t.getRotationX()),this.setRotationY(t.getRotationY()),this.setFlippedX(t.isFlippedX()),this.setFlippedY(t.isFlippedY()),this.setColor(t.getColor()),this.setOpacity(t.getOpacity()),this._touchEventCallback=t._touchEventCallback,this._touchEventListener=t._touchEventListener,this._touchEventSelector=t._touchEventSelector,this._clickEventListener=t._clickEventListener,this._focused=t._focused,this._focusEnabled=t._focusEnabled,this._propagateTouchEvents=t._propagateTouchEvents;for(var e in t._layoutParameterDictionary){var i=t._layoutParameterDictionary[e];i&&this.setLayoutParameter(i.clone())}this._onSizeChanged()},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},getLeftInParent:function(){return cc.log("getLeftInParent is deprecated. Please use getLeftBoundary instead."),this.getLeftBoundary()},getBottomInParent:function(){return cc.log("getBottomInParent is deprecated. Please use getBottomBoundary instead."),this.getBottomBoundary()},getRightInParent:function(){return cc.log("getRightInParent is deprecated. Please use getRightBoundary instead."),this.getRightBoundary()},getTopInParent:function(){return cc.log("getTopInParent is deprecated. Please use getTopBoundary instead."),this.getTopBoundary()},getTouchEndPos:function(){return cc.log("getTouchEndPos is deprecated. Please use getTouchEndPosition instead."),this.getTouchEndPosition()},getTouchMovePos:function(){return cc.log("getTouchMovePos is deprecated. Please use getTouchMovePosition instead."),this.getTouchMovePosition()},clippingParentAreaContainPoint:function(t){cc.log("clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead."),this.isClippingParentContainsPoint(t)},getTouchStartPos:function(){return cc.log("getTouchStartPos is deprecated. Please use getTouchBeganPosition instead."),this.getTouchBeganPosition()},setSize:function(t){this.setContentSize(t)},getSize:function(){return this.getContentSize()},addNode:function(t,e,i){return t instanceof ccui.Widget?void cc.log("Please use addChild to add a Widget."):(cc.Node.prototype.addChild.call(this,t,e,i),void this._nodes.push(t))},getNodeByTag:function(t){for(var e=this._nodes,i=0;i<e.length;i++){var n=e[i];if(n&&n.getTag()===t)return n}return null},getNodes:function(){return this._nodes},removeNode:function(t,e){cc.Node.prototype.removeChild.call(this,t,e),cc.arrayRemoveObject(this._nodes,t)},removeNodeByTag:function(t,e){var i=this.getChildByTag(t);i?this.removeChild(i,e):cc.log("cocos2d: removeNodeByTag(tag = %d): child not found!",t)},removeAllNodes:function(){for(var t=0;t<this._nodes.length;t++){var e=this._nodes[t];cc.Node.prototype.removeChild.call(this,e)}this._nodes.length=0},_findLayout:function(){cc.renderer.childrenOrderDirty=!0;for(var t=this._parent;t;){if(t._doLayout){t._doLayoutDirty=!0;break}t=t._parent}},isUnifySizeEnabled:function(){return this._unifySize},setUnifySizeEnabled:function(t){this._unifySize=t},_ccEventCallback:null,addCCSEventListener:function(t){this._ccEventCallback=t},setScaleX:function(t){this._flippedX&&(t*=-1),cc.Node.prototype.setScaleX.call(this,t)},setScaleY:function(t){this._flippedY&&(t*=-1),cc.Node.prototype.setScaleY.call(this,t)},setScale:function(t,e){void 0===e&&(e=t),this.setScaleX(t),this.setScaleY(e)},getScaleX:function(){var t=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(t*=-1),t},getScaleY:function(){var t=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(t*=-1),t},getScale:function(){return this.getScaleX()!==this.getScaleY()&&cc.log("Widget#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},setCallbackName:function(t){this._callbackName=t},getCallbackName:function(){return this._callbackName},setCallbackType:function(t){this._callbackType=t},getCallbackType:function(){return this._callbackType},setLayoutComponentEnabled:function(t){this._usingLayoutComponent=t},isLayoutComponentEnabled:function(){return this._usingLayoutComponent},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new ccui.Widget.WebGLRenderCmd(this):new ccui.Widget.CanvasRenderCmd(this)}});var _p=ccui.Widget.prototype;_p.xPercent,cc.defineGetterSetter(_p,"xPercent",_p._getXPercent,_p._setXPercent),_p.yPercent,cc.defineGetterSetter(_p,"yPercent",_p._getYPercent,_p._setYPercent),_p.widthPercent,cc.defineGetterSetter(_p,"widthPercent",_p._getWidthPercent,_p._setWidthPercent),_p.heightPercent,cc.defineGetterSetter(_p,"heightPercent",_p._getHeightPercent,_p._setHeightPercent),_p.widgetParent,cc.defineGetterSetter(_p,"widgetParent",_p.getWidgetParent),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.focused,cc.defineGetterSetter(_p,"focused",_p.isFocused,_p.setFocused),_p.sizeType,cc.defineGetterSetter(_p,"sizeType",_p.getSizeType,_p.setSizeType),_p.widgetType,cc.defineGetterSetter(_p,"widgetType",_p.getWidgetType),_p.touchEnabled,cc.defineGetterSetter(_p,"touchEnabled",_p.isTouchEnabled,_p.setTouchEnabled),_p.updateEnabled,cc.defineGetterSetter(_p,"updateEnabled",_p.isUpdateEnabled,_p.setUpdateEnabled),_p.bright,cc.defineGetterSetter(_p,"bright",_p.isBright,_p.setBright),_p.name,cc.defineGetterSetter(_p,"name",_p.getName,_p.setName),_p.actionTag,cc.defineGetterSetter(_p,"actionTag",_p.getActionTag,_p.setActionTag),_p.opacity,cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),_p=null,ccui.Widget.create=function(){return new ccui.Widget},ccui.Widget._focusedWidget=null,ccui.Widget._focusNavigationController=null,ccui.Widget.enableDpadNavigation=function(t){t?(null==ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController=new ccui._FocusNavigationController,ccui.Widget._focusedWidget&&ccui.Widget._focusNavigationController._setFirstFocsuedWidget(ccui.Widget._focusedWidget)),ccui.Widget._focusNavigationController.enableFocusNavigation(!0)):ccui.Widget._focusNavigationController&&(ccui.Widget._focusNavigationController.enableFocusNavigation(!1),ccui.Widget._focusNavigationController=null)},ccui.Widget.getCurrentFocusedWidget=function(){return ccui.Widget._focusedWidget},ccui.Widget.BRIGHT_STYLE_NONE=-1,ccui.Widget.BRIGHT_STYLE_NORMAL=0,ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT=1,ccui.Widget.TYPE_WIDGET=0,ccui.Widget.TYPE_CONTAINER=1,ccui.Widget.LEFT=0,ccui.Widget.RIGHT=1,ccui.Widget.UP=2,ccui.Widget.DOWN=3,ccui.Widget.LOCAL_TEXTURE=0,ccui.Widget.PLIST_TEXTURE=1,ccui.Widget.TOUCH_BEGAN=0,ccui.Widget.TOUCH_MOVED=1,ccui.Widget.TOUCH_ENDED=2,ccui.Widget.TOUCH_CANCELED=3,ccui.Widget.SIZE_ABSOLUTE=0,ccui.Widget.SIZE_PERCENT=1,ccui.Widget.POSITION_ABSOLUTE=0,ccui.Widget.POSITION_PERCENT=1,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){if(cc._renderType===cc.game.RENDER_TYPE_CANVAS){ccui.Widget.CanvasRenderCmd=function(t){cc.ProtectedNode.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=ccui.Widget.CanvasRenderCmd.prototype=Object.create(cc.ProtectedNode.CanvasRenderCmd.prototype);t.constructor=ccui.Widget.CanvasRenderCmd,t.visit=function(t){var e=this._node;e._visible&&(e._adaptRenderers(),this.pNodeVisit(t))},t.transform=function(t,e){var i=this._node;if(i._visible&&i._running){if(i._adaptRenderers(),!this._usingLayoutComponent){var n=i.getWidgetParent();if(n){var r=n.getContentSize();0!==r.width&&0!==r.height&&(i._position.x=r.width*i._positionPercent.x,i._position.y=r.height*i._positionPercent.y)}}this.pNodeTransform(t,e)}},t.widgetVisit=t.visit,t.widgetTransform=t.transform}else{ccui.Widget.WebGLRenderCmd=function(t){cc.ProtectedNode.WebGLRenderCmd.call(this,t),this._needDraw=!1};var t=ccui.Widget.WebGLRenderCmd.prototype=Object.create(cc.ProtectedNode.WebGLRenderCmd.prototype);t.constructor=ccui.Widget.WebGLRenderCmd,t.visit=function(t){var e=this._node;e._visible&&(e._adaptRenderers(),this.pNodeVisit(t))},t.transform=function(t,e){var i=this._node;if(i._visible&&i._running){if(i._adaptRenderers(),!this._usingLayoutComponent){var n=i.getWidgetParent();if(n){var r=n.getContentSize();0!==r.width&&0!==r.height&&(i._position.x=r.width*i._positionPercent.x,i._position.y=r.height*i._positionPercent.y)}}this.pNodeTransform(t,e)}},t.widgetVisit=t.visit,t.widgetTransform=t.transform}}),ccui.Scale9Sprite=cc.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_scale9Enabled:!0,_brightState:0,_renderers:null,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spriteFrameRotated:!1,_textureLoaded:!1,_className:"Scale9Sprite",_flippedX:!1,_flippedY:!1,textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(t,e){this.addEventListener("load",t,e)},_updateCapInset:function(){var t,e=this._insetLeft,i=this._insetTop,n=this._insetRight,r=this._spriteRect,o=this._insetBottom;t=0===e&&0===i&&0===n&&0===o?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(o,e,r.width-n-e,r.height-i-o):cc.rect(e,i,r.width-e-n,r.height-i-o),this.setCapInsets(t)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var t=this._contentSize,e=this._topLeft,i=this._topRight,n=this._bottomRight,r=this._bottomLeft,o=this._left,s=this._right,c=this._top,a=this._bottom,l=this._centre,h=this._centre.getContentSize(),u=e.getContentSize(),d=r.getContentSize(),_=t.width-u.width-i.getContentSize().width,p=t.height-u.height-n.getContentSize().height,f=_/h.width,m=p/h.height,g=h.width*f,y=h.height*m,v=d.width,T=d.height,C=cc.p(this._offset.x*f,this._offset.y*m);if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var S=Math.round(g);g!==S&&(g=S,f=g/h.width);var x=Math.round(y);y!==x&&(y=x,m=y/h.height)}l.setScaleX(f),l.setScaleY(m),r.setAnchorPoint(1,1),r.setPosition(v,T),n.setAnchorPoint(0,1),n.setPosition(v+g,T),e.setAnchorPoint(1,0),e.setPosition(v,T+y),i.setAnchorPoint(0,0),i.setPosition(v+g,T+y),o.setAnchorPoint(1,.5),o.setPosition(v,T+y/2+C.y),o.setScaleY(m),s.setAnchorPoint(0,.5),s.setPosition(v+g,T+y/2+C.y),s.setScaleY(m),c.setAnchorPoint(.5,0),c.setPosition(v+g/2+C.x,T+y),c.setScaleX(f),a.setAnchorPoint(.5,1),a.setPosition(v+g/2+C.x,T),a.setScaleX(f),l.setAnchorPoint(.5,.5),l.setPosition(v+g/2+C.x,T+y/2+C.y),l.setScaleX(f),l.setScaleY(m)}},ctor:function(t,e,i){if(cc.Node.prototype.ctor.call(this),this._loader=new cc.Sprite.LoadManager,this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),this._renderers=[],void 0!==t)if(t instanceof cc.SpriteFrame)this.initWithSpriteFrame(t,e);else{var n=cc.spriteFrameCache.getSpriteFrame(t);n?this.initWithSpriteFrame(n,e):this.initWithFile(t,e,i)}else this.init(),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,.5),this._positionsAreDirty=!0},getSprite:function(){return this._scale9Image},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},_asyncSetPreferredSize:function(){this.removeEventListener("load",this._asyncSetPreferredSize,this),this.setPreferredSize(this._cachePreferredSize),this._cachePreferredSize=null},setPreferredSize:function(t){if(t){if(!this._textureLoaded)return this._cachePreferredSize=t,this.removeEventListener("load",this._asyncSetPreferredSize,this),this.addEventListener("load",this._asyncSetPreferredSize,this),!1;this.setContentSize(t),this._preferredSize=t,this._positionsAreDirty&&(this._updatePositions(),this._positionsAreDirty=!1,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty))}},_setPreferredWidth:function(t){this._setWidth(t),this._preferredSize.width=t},_setPreferredHeight:function(t){this._setHeight(t),this._preferredSize.height=t},setOpacity:function(t){if(cc.Node.prototype.setOpacity.call(this,t),this._scale9Enabled)for(var e=this._renderers,i=0;i<e.length;i++)e[i].setOpacity(t);else this._scale9Image&&this._scale9Image.setOpacity(t);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},setColor:function(t){if(cc.Node.prototype.setColor.call(this,t),this._scale9Enabled)for(var e=this._renderers,i=0;i<e.length;i++){var n=e[i];n&&n.setColor(t)}else this._scale9Image&&this._scale9Image.setColor(t);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},getCapInsets:function(){return cc.rect(this._capInsets)},_asyncSetCapInsets:function(){this.removeEventListener("load",this._asyncSetCapInsets,this),this.setCapInsets(this._cacheCapInsets),this._cacheCapInsets=null},setCapInsets:function(t){var e=this._contentSize,i=e.width,n=e.height;return this._textureLoaded?(this.updateWithSprite(this._scale9Image,this._spriteRect,this._spriteFrameRotated,this._offset,this._originalSize,t),this._insetLeft=t.x,this._insetTop=t.y,this._insetRight=this._originalSize.width-this._insetLeft-t.width,this._insetBottom=this._originalSize.height-this._insetTop-t.height,void this.setContentSize(i,n)):(this._cacheCapInsets=t,this.removeEventListener("load",this._asyncSetCapInsets,this),this.addEventListener("load",this._asyncSetCapInsets,this),!1)},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(t){this._insetLeft=t,this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(t){this._insetTop=t,this._updateCapInset()},getInsetRight:function(){return this._insetRight},setInsetRight:function(t){this._insetRight=t,this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(t){this._insetBottom=t,this._updateCapInset()},setContentSize:function(t,e){cc.Node.prototype.setContentSize.call(this,t,e),this._positionsAreDirty=!0},setAnchorPoint:function(t,e){cc.Node.prototype.setAnchorPoint.call(this,t,e),this._scale9Enabled||this._scale9Image&&(this._scale9Image.setAnchorPoint(t,e),this._positionsAreDirty=!0)},_setWidth:function(t){cc.Node.prototype._setWidth.call(this,t),this._positionsAreDirty=!0},_setHeight:function(t){cc.Node.prototype._setHeight.call(this,t),this._positionsAreDirty=!0},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(t,e,i,n){return!!t&&(void 0===n&&(n=i,i=!1),this.updateWithBatchNode(t,e,i,n),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,.5),this._positionsAreDirty=!0,!0)},initWithFile:function(t,e,i){if(t instanceof cc.Rect?(t=arguments[1],i=arguments[0],e=cc.rect(0,0,0,0)):(e=e||cc.rect(0,0,0,0),i=i||cc.rect(0,0,0,0)),!t)throw new Error("ccui.Scale9Sprite.initWithFile(): file should be non-null");var n=cc.textureCache.getTextureForKey(t);n||(n=cc.textureCache.addImage(t));var r=n.isLoaded();return this._textureLoaded=r,this._loader.clear(),r?this.initWithBatchNode(new cc.SpriteBatchNode(t,9),e,!1,i):(this._loader.once(n,function(){this.initWithFile(t,e,i),this.dispatchEvent("load")},this),!1)},initWithSpriteFrame:function(t,e){if(!t||!t.getTexture())throw new Error("ccui.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null");e=e||cc.rect(0,0,0,0);var i=t.getTexture(),n=this._textureLoaded=i.isLoaded();if(this._loader.clear(),!n)return this._loader.once(i,function(){this.initWithSpriteFrame(t,e),this.dispatchEvent("load")},this),!1;var r=new cc.SpriteBatchNode(t.getTexture(),9);return this.initWithBatchNode(r,t.getRect(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&t.isRotated(),e),!0},initWithSpriteFrameName:function(t,e){if(!t)throw new Error("ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null");e=e||cc.rect(0,0,0,0);var i=cc.spriteFrameCache.getSpriteFrame(t);return null==i?(cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(i,e)},resizableSpriteWithCapInsets:function(t){var e=new ccui.Scale9Sprite;return e&&e.initWithBatchNode(this._scale9Image,this._spriteRect,!1,t)?e:null},setOpacityModifyRGB:function(t){if(this._scale9Image){this._opacityModifyRGB=t;var e=this._scale9Image.getChildren();if(e)for(var i=0,n=e.length;i<n;i++)e[i].setOpacityModifyRGB(t);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},createSlicedSprites:function(){var t=this._originalSize.width,e=this._originalSize.height,i=this._spriteRect,n=Math.floor(this._offset.x+(t-i.width)/2),r=Math.floor(this._offset.y+(e-i.height)/2),o=i.x,s=i.y,c=this._capInsetsInternal,a=this._scale9Image,l=a.getTexture(),h=this._spriteFrameRotated,u=cc.rect(i.x,i.y,i.width,i.height);cc._rectEqualToZero(c)&&(c=cc.rect(t/3,e/3,t/3,e/3)),this._spriteFrameRotated?(o-=r,s-=n):(o-=n,s-=r),i=cc.rect(o,s,t,e);var d=c.x,_=c.width,p=i.width-(d+_),f=c.y,m=c.height,g=i.height-(f+m),y=0,v=0,T=cc.rect(y+.5|0,v+.5|0,d+.5|0,f+.5|0),C=T;y+=d;var S=cc.rect(y+.5|0,v+.5|0,_+.5|0,f+.5|0),x=S;y+=_;var A=cc.rect(y+.5|0,v+.5|0,p+.5|0,f+.5|0),E=A;y=0,v=0,v+=f;var b=cc.rect(y+.5|0,v+.5|0,d+.5|0,m+.5|0);y+=d;var R=cc.rect(y+.5|0,v+.5|0,_+.5|0,m+.5|0),P=R;y+=_;var w=cc.rect(y+.5|0,v+.5|0,p+.5|0,m+.5|0);y=0,v=0,v+=f,v+=m;var I=cc.rect(y+.5|0,v+.5|0,d+.5|0,g+.5|0);y+=d;var D=cc.rect(y+.5|0,v+.5|0,_+.5|0,g+.5|0);y+=_;var L=cc.rect(y+.5|0,v+.5|0,p+.5|0,g+.5|0),O=L,B=T,N=R,F=L,M=P,V=O,k=I,G=E,W=C,z=w,U=b,Y=D,X=x,H=cc.affineTransformMakeIdentity();h?(H=cc.affineTransformTranslate(H,u.height+u.x,u.y),H=cc.affineTransformRotate(H,1.57079633),T=cc.rectApplyAffineTransform(T,H),R=cc.rectApplyAffineTransform(R,H),L=cc.rectApplyAffineTransform(L,H),P=cc.rectApplyAffineTransform(P,H),O=cc.rectApplyAffineTransform(O,H),I=cc.rectApplyAffineTransform(I,H),E=cc.rectApplyAffineTransform(E,H),C=cc.rectApplyAffineTransform(C,H),w=cc.rectApplyAffineTransform(w,H),b=cc.rectApplyAffineTransform(b,H),D=cc.rectApplyAffineTransform(D,H),x=cc.rectApplyAffineTransform(x,H),B.x=T.x,N.x=R.x,F.x=L.x,M.x=P.x,V.x=O.x,k.x=I.x,G.x=E.x,W.x=C.x,z.x=w.x,U.x=b.x,Y.x=D.x,X.x=x.x,B.y=T.y,N.y=R.y,F.y=L.y,M.y=P.y,V.y=O.y,k.y=I.y,G.y=E.y,W.y=C.y,z.y=w.y,U.y=b.y,Y.y=D.y,X.y=x.y):(H=cc.affineTransformTranslate(H,u.x,u.y),B=cc.rectApplyAffineTransform(B,H),N=cc.rectApplyAffineTransform(N,H),F=cc.rectApplyAffineTransform(F,H),M=cc.rectApplyAffineTransform(M,H),V=cc.rectApplyAffineTransform(V,H),k=cc.rectApplyAffineTransform(k,H),G=cc.rectApplyAffineTransform(G,H),W=cc.rectApplyAffineTransform(W,H),z=cc.rectApplyAffineTransform(z,H),U=cc.rectApplyAffineTransform(U,H),Y=cc.rectApplyAffineTransform(Y,H),X=cc.rectApplyAffineTransform(X,H)),this._centre||(this._centre=new cc.Sprite),this._centre.initWithTexture(l,M,h),M.width>0&&M.height>0&&this._renderers.push(this._centre),this._top||(this._top=new cc.Sprite),this._top.initWithTexture(l,X,h),X.width>0&&X.height>0&&this._renderers.push(this._top),this._bottom||(this._bottom=new cc.Sprite),this._bottom.initWithTexture(l,Y,h),Y.width>0&&Y.height>0&&this._renderers.push(this._bottom),this._left||(this._left=new cc.Sprite),this._left.initWithTexture(l,U,h),U.width>0&&U.height>0&&this._renderers.push(this._left),this._right||(this._right=new cc.Sprite),this._right.initWithTexture(l,z,h),z.width>0&&z.height>0&&this._renderers.push(this._right),this._topLeft||(this._topLeft=new cc.Sprite),this._topLeft.initWithTexture(l,W,h),W.width>0&&W.height>0&&this._renderers.push(this._topLeft),this._topRight||(this._topRight=new cc.Sprite),this._topRight.initWithTexture(l,G,h),G.width>0&&G.height>0&&this._renderers.push(this._topRight),this._bottomLeft||(this._bottomLeft=new cc.Sprite),this._bottomLeft.initWithTexture(l,k,h),k.width>0&&k.height>0&&this._renderers.push(this._bottomLeft),this._bottomRight||(this._bottomRight=new cc.Sprite),this._bottomRight.initWithTexture(l,V,h),V.width>0&&V.height>0&&this._renderers.push(this._bottomRight)},updateWithSprite:function(t,e,i,n,r,o){if(!t)return!1;if(this._loader.clear(),this._textureLoaded=t._textureLoaded,!t._textureLoaded)return this._loader.once(t,function(){this.updateWithSprite(t,e,i,n,r,o),this.dispatchEvent("load")},this),!1;if(this._scale9Image=t,!this._scale9Image)return!1;var s=this._scale9Image.getTexture();this._textureLoaded=s&&s.isLoaded();var c=t.getSpriteFrame();cc._renderType===cc.game.RENDER_TYPE_CANVAS&&c&&s._htmlElementObj instanceof window.HTMLCanvasElement&&(i=!1,e={x:0,y:0,height:e.height,width:e.width});var a=this.getOpacity(),l=this.getColor();this._renderers.length=0;var h=e,u=r;if(cc._rectEqualToZero(h)){var d=s.getContentSize();h=cc.rect(0,0,d.width,d.height)}return 0===u.width&&0===u.height&&(u=cc.size(h.width,h.height)),this._capInsets=o,this._spriteRect=h,this._offset=n,this._spriteFrameRotated=i,this._originalSize=u,this._preferredSize=u,this._capInsetsInternal=o,this._scale9Enabled?this.createSlicedSprites():this._scale9Image.initWithTexture(s,this._spriteRect,this._spriteFrameRotated),this.setState(this._brightState),this.setContentSize(u),this.setOpacity(a),this.setColor(l),!0},updateWithBatchNode:function(t,e,i,n){if(!t)return!1;var r=t.getTexture();this._loader.clear();var o=this._textureLoaded=r.isLoaded();if(!o)return this._loader.once(r,function(){this.updateWithBatchNode(t,e,i,n),this.dispatchEvent("load")},this),!1;var s=new cc.Sprite(r),c=cc.p(0,0),a=cc.size(e.width,e.height);return this.updateWithSprite(s,e,i,c,a,n)},setSpriteFrame:function(t,e){e=e||cc.rect();var i=t.getTexture();if(this._textureLoaded=i._textureLoaded,this._loader.clear(),!i._textureLoaded)return this._loader.once(t,function(){this.setSpriteFrame(t,e),this.dispatchEvent("load")},this),!1;var n=new cc.Sprite(t.getTexture());this.updateWithSprite(n,t.getRect(),t.isRotated(),t.getOffset(),t.getOriginalSize(),e),this._insetLeft=e.x,this._insetTop=e.y,this._insetRight=this._originalSize.width-this._insetLeft-e.width,this._insetBottom=this._originalSize.height-this._insetTop-e.height},setState:function(t){t!==ccui.Scale9Sprite.state.NORMAL&&t!==ccui.Scale9Sprite.state.GRAY||(this._brightState=t,this._renderCmd.setState(t))},setScale9Enabled:function(t){this._scale9Enabled!==t&&(this._scale9Enabled=t,this._renderers.length=0,cc.Node.transformDirty=!0,this._scale9Enabled&&this._scale9Image&&this.updateWithSprite(this._scale9Image,this._spriteRect,this._spriteFrameRotated,this._offset,this._originalSize,this._capInsets),this._positionsAreDirty=!0)},_setRenderersPosition:function(){this._positionsAreDirty&&(this._updatePositions(),this._adjustScale9ImagePosition(),this._positionsAreDirty=!1)},_adjustScale9ImagePosition:function(){var t=this._scale9Image,e=this._contentSize;t&&(t.x=e.width*t.getAnchorPoint().x,t.y=e.height*t.getAnchorPoint().y)},_adjustScale9ImageScale:function(){var t=this._scale9Image,e=this._contentSize;t&&t.setScale(e.width/t.width,e.height/t.height)},setFlippedX:function(t){var e=this.getScaleX();this._flippedX=t,this.setScaleX(e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},isFlippedX:function(){return this._flippedX},setFlippedY:function(t){var e=this.getScaleY();this._flippedY=t,this.setScaleY(e),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},isFlippedY:function(){return this._flippedY},setScaleX:function(t){this._flippedX&&(t*=-1),cc.Node.prototype.setScaleX.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},setScaleY:function(t){this._flippedY&&(t*=-1),cc.Node.prototype.setScaleY.call(this,t),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty)},setScale:function(t,e){void 0===e&&(e=t),this.setScaleX(t),this.setScaleY(e)},getScaleX:function(){var t=cc.Node.prototype.getScaleX.call(this);return this._flippedX&&(t*=-1),t},getScaleY:function(){var t=cc.Node.prototype.getScaleY.call(this);return this._flippedY&&(t*=-1),t},getScale:function(){return this.getScaleX()!==this.getScaleY()&&cc.log("Scale9Sprite#scale. ScaleX != ScaleY. Don't know which one to return"),this.getScaleX()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccui.Scale9Sprite.CanvasRenderCmd(this):new ccui.Scale9Sprite.WebGLRenderCmd(this)}});var _p=ccui.Scale9Sprite.prototype;cc.EventHelper.prototype.apply(_p),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.capInsets,cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets),_p.insetLeft,cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft),_p.insetTop,cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop),_p.insetRight,cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight),_p.insetBottom,cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom),_p=null,ccui.Scale9Sprite.create=function(t,e,i){return new ccui.Scale9Sprite(t,e,i)},ccui.Scale9Sprite.createWithSpriteFrame=function(t,e){return new ccui.Scale9Sprite(t,e)},ccui.Scale9Sprite.createWithSpriteFrameName=function(t,e){return new ccui.Scale9Sprite(t,e)},ccui.Scale9Sprite.POSITIONS_CENTRE=0,ccui.Scale9Sprite.POSITIONS_TOP=1,ccui.Scale9Sprite.POSITIONS_LEFT=2,ccui.Scale9Sprite.POSITIONS_RIGHT=3,ccui.Scale9Sprite.POSITIONS_BOTTOM=4,ccui.Scale9Sprite.POSITIONS_TOPRIGHT=5,ccui.Scale9Sprite.POSITIONS_TOPLEFT=6,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7,ccui.Scale9Sprite.state={NORMAL:0,GRAY:1},function(){ccui.Scale9Sprite.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._cachedParent=null,this._cacheDirty=!1,this._state=ccui.Scale9Sprite.state.NORMAL;var e=this._node,i=this._cacheCanvas=document.createElement("canvas");i.width=1,i.height=1,this._cacheContext=new cc.CanvasContextWrapper(i.getContext("2d"));var n=this._cacheTexture=new cc.Texture2D;n.initWithElement(i),n.handleLoadedTexture(),this._cacheSprite=new cc.Sprite(n),this._cacheSprite.setAnchorPoint(0,0),e.addChild(this._cacheSprite)};var t=ccui.Scale9Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=ccui.Scale9Sprite.CanvasRenderCmd,t.visit=function(t){var e=this._node;e._visible&&(e._positionsAreDirty&&(e._updatePositions(),e._positionsAreDirty=!1),this.originVisit(t))},t.transform=function(t){var e=this._node;cc.Node.CanvasRenderCmd.prototype.transform.call(this,t),e._positionsAreDirty&&(e._updatePositions(),e._positionsAreDirty=!1);for(var i=e._children,n=0;n<i.length;n++)i[n].transform(this,!0)},t._updateDisplayColor=function(t){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,t);var e=this._node;if(e){var i=e._renderers;if(e._scale9Enabled)for(var n=i.length,r=0;r<n;r++){var o=i[r];if(!o)break;o._renderCmd._updateDisplayColor(t),o._renderCmd._updateColor()}else e._scale9Image&&(e._scale9Image._renderCmd._updateDisplayColor(t),e._scale9Image._renderCmd._updateColor())}},t.updateStatus=function(){var t=cc.Node._dirtyFlags,e=this._dirtyFlag;cc.Node.RenderCmd.prototype.updateStatus.call(this),e&t.cacheDirty&&(this._cacheScale9Sprite(),this._dirtyFlag=this._dirtyFlag&t.cacheDirty^this._dirtyFlag)},t._syncStatus=function(t){var e=cc.Node._dirtyFlags,i=this._dirtyFlag;cc.Node.RenderCmd.prototype._syncStatus.call(this,t),i&e.cacheDirty&&(this._cacheScale9Sprite(),this._dirtyFlag=this._dirtyFlag&e.cacheDirty^this._dirtyFlag)},t._cacheScale9Sprite=function(){var t=this._node;if(t._scale9Image){var e=cc.contentScaleFactor(),i=t._contentSize,n=cc.size(i.width*e,i.height*e),r=this._cacheCanvas,o=this._cacheContext,s=o.getContext(),c=!1;if(r.width===n.width&&r.height===n.height||(r.width=n.width,r.height=n.height,c=!0),cc.renderer._turnToCacheMode(t.__instanceId),t._scale9Enabled){var a=t._renderers;t._setRenderersPosition();for(var l=a.length,h=0;h<l;h++){var u=a[h];if(!u)break;var d=u._renderCmd;d.updateStatus(),cc.renderer.pushRenderCommand(d)}}else{var d=t._scale9Image._renderCmd;t._adjustScale9ImagePosition(),t._adjustScale9ImageScale(),d.updateStatus(),cc.renderer.pushRenderCommand(t._scale9Image._renderCmd)}var _=t._scale9Image.getTexture();_&&this._state===ccui.Scale9Sprite.state.GRAY&&_._switchToGray(!0),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,n.width,n.height),cc.renderer._renderingToCacheCanvas(o,t.__instanceId,e,e),cc.renderer._turnToNormalMode(),_&&this._state===ccui.Scale9Sprite.state.GRAY&&_._switchToGray(!1),c&&this._cacheSprite.setTextureRect(cc.rect(0,0,i.width,i.height)),this._cacheSprite.getParent()||t.addChild(this._cacheSprite,-1),this._cacheSprite._renderCmd._updateColor()}},t.setState=function(t){var e=this._node._scale9Image;e&&(this._state=t,this.setDirtyFlag(cc.Node._dirtyFlags.cacheDirty))}}(),function(){if(cc.Node.WebGLRenderCmd){ccui.Scale9Sprite.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._cachedParent=null,this._cacheDirty=!1};var t=ccui.Scale9Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=ccui.Scale9Sprite.WebGLRenderCmd,t.setShaderProgram=function(t){var e=this._node;if(e._scale9Enabled)for(var i=e._renderers,n=i.length,r=0;r<n;r++)i[r]&&(i[r]._renderCmd._shaderProgram=t);else e._scale9Image._renderCmd._shaderProgram=t;this._shaderProgram=t},t.visit=function(t){var e=this._node;if(e._visible&&e._scale9Image){if(e._positionsAreDirty&&(e._updatePositions(),e._positionsAreDirty=!1),t=t||this.getParentRenderCmd(),e._parent&&e._parent._renderCmd&&(this._curLevel=e._parent._renderCmd._curLevel+1),this._syncStatus(t),e._scale9Enabled)for(var i=e._renderers,n=i.length,r=0;r<n;r++){var o=i[r];if(!o)break;var s=o._renderCmd;s.visit(this)}else e._adjustScale9ImageScale(),e._adjustScale9ImagePosition(),e._scale9Image._renderCmd.visit(this);this._dirtyFlag=0,this.originVisit(t)}},t.transform=function(t,e){var i=this._node;if(t=t||this.getParentRenderCmd(),this.originTransform(t,e),i._positionsAreDirty&&(i._updatePositions(),i._positionsAreDirty=!1),i._scale9Enabled)for(var n=i._renderers,r=n.length,o=cc.Node._dirtyFlags,s=0;s<r;s++){var c=n[s];if(!c)break;c._vertexZ=t._node._vertexZ;var a=c._renderCmd;a.transform(this,!0),a._dirtyFlag=a._dirtyFlag&o.transformDirty^a._dirtyFlag}else i._adjustScale9ImageScale(),i._adjustScale9ImagePosition(),i._scale9Image._renderCmd.transform(this,!0)},t.setDirtyFlag=function(t,e){t===cc.Node._dirtyFlags.cacheDirty&&(t=cc.Node._dirtyFlags.transformDirty),cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,t,e)},t._syncStatus=function(t){cc.Node.WebGLRenderCmd.prototype._syncStatus.call(this,t),this._updateDisplayColor(this._displayedColor),this._updateDisplayOpacity(this._displayedOpacity)},t._updateDisplayColor=function(t){cc.Node.WebGLRenderCmd.prototype._updateDisplayColor.call(this,t);var e=this._node,i=e._scale9Image;if(t=this._displayedColor,e._scale9Enabled)for(var n=e._renderers,r=0;r<n.length;r++)n[r]._renderCmd._updateDisplayColor(t),n[r]._renderCmd._updateColor();else i._renderCmd._updateDisplayColor(t),i._renderCmd._updateColor()},t._updateDisplayOpacity=function(t){cc.Node.WebGLRenderCmd.prototype._updateDisplayOpacity.call(this,t);var e=this._node,i=e._scale9Image;if(t=this._displayedOpacity,e._scale9Enabled)for(var n=e._renderers,r=0;r<n.length;r++)n[r]._renderCmd._updateDisplayOpacity(t),n[r]._renderCmd._updateColor();else i._renderCmd._updateDisplayOpacity(t),i._renderCmd._updateColor()},t.setState=function(t){t===ccui.Scale9Sprite.state.NORMAL?this.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)):t===ccui.Scale9Sprite.state.GRAY&&this.setShaderProgram(ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram())},ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=null,ccui.Scale9Sprite.WebGLRenderCmd._getGrayShaderProgram=function(){var t=ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram;return t?t:(t=new cc.GLProgram,t.initWithVertexShaderByteArray(cc.SHADER_SPRITE_POSITION_TEXTURE_COLOR_VERT,ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment),t.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),t.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),t.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),t.link(),t.updateUniforms(),ccui.Scale9Sprite.WebGLRenderCmd._grayShaderProgram=t,t)},ccui.Scale9Sprite.WebGLRenderCmd._grayShaderFragment="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    gl_FragColor.xyz = vec3(0.2126*c.r + 0.7152*c.g + 0.0722*c.b); \n     gl_FragColor.w = c.w ; \n}"}}(),ccui.Layout=ccui.Widget.extend({_clippingEnabled:!1,_backGroundScale9Enabled:null,_backGroundImage:null,_backGroundImageFileName:null,_backGroundImageCapInsets:null,_colorType:null,_bgImageTexType:ccui.Widget.LOCAL_TEXTURE,_colorRender:null,_gradientRender:null,_color:null,_startColor:null,_endColor:null,_alongVector:null,_opacity:255,_backGroundImageTextureSize:null,_layoutType:null,_doLayoutDirty:!0,_clippingRectDirty:!0,_clippingType:null,_clippingStencil:null,_scissorRectDirty:!1,_clippingRect:null,_clippingParent:null,_className:"Layout",_backGroundImageColor:null,_finalPositionX:0,_finalPositionY:0,_backGroundImageOpacity:0,_loopFocus:!1,__passFocusToChild:!0,_isFocusPassing:!1,_isInterceptTouch:!1,ctor:function(){this._layoutType=ccui.Layout.ABSOLUTE,this._widgetType=ccui.Widget.TYPE_CONTAINER,this._clippingType=ccui.Layout.CLIPPING_SCISSOR,this._colorType=ccui.Layout.BG_COLOR_NONE,ccui.Widget.prototype.ctor.call(this),this.ignoreContentAdaptWithSize(!1),this.setContentSize(cc.size(0,0)),this.setAnchorPoint(0,0),this.onPassFocusToChild=this._findNearestChildWidgetIndex.bind(this),this._backGroundImageCapInsets=cc.rect(0,0,0,0),this._color=cc.color(255,255,255,255),this._startColor=cc.color(255,255,255,255),this._endColor=cc.color(255,255,255,255),this._alongVector=cc.p(0,-1),this._backGroundImageTextureSize=cc.size(0,0),this._clippingRect=cc.rect(0,0,0,0),this._backGroundImageColor=cc.color(255,255,255,255)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this._clippingStencil&&this._clippingStencil.onEnter(),this._doLayoutDirty=!0,this._clippingRectDirty=!0},onExit:function(){ccui.Widget.prototype.onExit.call(this),this._clippingStencil&&this._clippingStencil.onExit()},setLoopFocus:function(t){this._loopFocus=t},isLoopFocus:function(){return this._loopFocus},setPassFocusToChild:function(t){this.__passFocusToChild=t},isPassFocusToChild:function(){return this.__passFocusToChild},findNextFocusedWidget:function(t,e){if(this._isFocusPassing||this.isFocused()){var i=this.getParent();if(this._isFocusPassing=!1,this.__passFocusToChild){var n=this._passFocusToChild(t,e);return n instanceof ccui.Layout&&i?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,this)):n}return null!=i&&i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,this)):this}if(!(e.isFocused()||e instanceof ccui.Layout))return e;if(this._layoutType===ccui.Layout.LINEAR_HORIZONTAL)switch(t){case ccui.Widget.LEFT:return this._getPreviousFocusedWidget(t,e);case ccui.Widget.RIGHT:return this._getNextFocusedWidget(t,e);case ccui.Widget.DOWN:case ccui.Widget.UP:return this._isLastWidgetInContainer(this,t)?this._isWidgetAncestorSupportLoopFocus(e,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e:ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this);default:return cc.assert(0,"Invalid Focus Direction"),e}else{if(this._layoutType!==ccui.Layout.LINEAR_VERTICAL)return cc.assert(0,"Un Supported Layout type, please use VBox and HBox instead!!!"),e;switch(t){case ccui.Widget.LEFT:case ccui.Widget.RIGHT:return this._isLastWidgetInContainer(this,t)?this._isWidgetAncestorSupportLoopFocus(e,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e:ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this);case ccui.Widget.DOWN:return this._getNextFocusedWidget(t,e);case ccui.Widget.UP:return this._getPreviousFocusedWidget(t,e);default:return cc.assert(0,"Invalid Focus Direction"),e}}},onPassFocusToChild:null,addChild:function(t,e,i){t instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(t),ccui.Widget.prototype.addChild.call(this,t,e,i),this._doLayoutDirty=!0},removeChild:function(t,e){ccui.Widget.prototype.removeChild.call(this,t,e),this._doLayoutDirty=!0},removeAllChildren:function(t){ccui.Widget.prototype.removeAllChildren.call(this,t),this._doLayoutDirty=!0},removeAllChildrenWithCleanup:function(t){ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this,t),this._doLayoutDirty=!0},isClippingEnabled:function(){return this._clippingEnabled},visit:function(t){if(this._visible)if(this._adaptRenderers(),this._doLayout(),this._clippingEnabled)switch(this._clippingType){case ccui.Layout.CLIPPING_STENCIL:this._renderCmd.stencilClippingVisit(t);break;case ccui.Layout.CLIPPING_SCISSOR:this._renderCmd.scissorClippingVisit(t)}else ccui.Widget.prototype.visit.call(this,t)},setClippingEnabled:function(t){if(t!==this._clippingEnabled)switch(this._clippingEnabled=t,this._clippingType){case ccui.Layout.CLIPPING_SCISSOR:case ccui.Layout.CLIPPING_STENCIL:t?(this._clippingStencil=new cc.DrawNode,this._renderCmd.rebindStencilRendering(this._clippingStencil),this._running&&this._clippingStencil.onEnter(),this._setStencilClippingSize(this._contentSize)):(this._running&&this._clippingStencil&&this._clippingStencil.onExit(),this._clippingStencil=null)}},setClippingType:function(t){if(t!==this._clippingType){var e=this.isClippingEnabled();this.setClippingEnabled(!1),this._clippingType=t,this.setClippingEnabled(e)}},getClippingType:function(){return this._clippingType},_setStencilClippingSize:function(t){if(this._clippingEnabled){var e=[];e[0]=cc.p(0,0),e[1]=cc.p(t.width,0),e[2]=cc.p(t.width,t.height),e[3]=cc.p(0,t.height);var i=cc.color.GREEN;this._clippingStencil.clear(),this._clippingStencil.setLocalBB&&this._clippingStencil.setLocalBB(0,0,t.width,t.height),this._clippingStencil.drawPoly(e,4,i,0,i)}},_getClippingRect:function(){if(this._clippingRectDirty){for(var t,e=this.convertToWorldSpace(cc.p(0,0)),i=this.getNodeToWorldTransform(),n=this._contentSize.width*i.a,r=this._contentSize.height*i.d,o=this;o;)if(o=o.getParent(),o&&o instanceof ccui.Layout&&o.isClippingEnabled()){this._clippingParent=o;break}if(this._clippingParent){t=this._clippingParent._getClippingRect(),this._clippingRect.x=Math.max(e.x,t.x),this._clippingRect.y=Math.max(e.y,t.y);var s=Math.min(e.x+n,t.x+t.width),c=Math.min(e.y+r,t.y+t.height);this._clippingRect.width=Math.max(0,s-this._clippingRect.x),this._clippingRect.height=Math.max(0,c-this._clippingRect.y)}else this._clippingRect.x=e.x,this._clippingRect.y=e.y,this._clippingRect.width=n,this._clippingRect.height=r;this._clippingRectDirty=!1}return this._clippingRect},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);var t=this._contentSize;this._setStencilClippingSize(t),this._doLayoutDirty=!0,this._clippingRectDirty=!0,this._backGroundImage&&(this._backGroundImage.setPosition(.5*t.width,.5*t.height),this._backGroundScale9Enabled&&this._backGroundImage instanceof ccui.Scale9Sprite&&this._backGroundImage.setPreferredSize(t)),this._colorRender&&this._colorRender.setContentSize(t),this._gradientRender&&this._gradientRender.setContentSize(t)},setBackGroundImageScale9Enabled:function(t){this._backGroundScale9Enabled!==t&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundScale9Enabled=t,this._addBackGroundImage(),this.setBackGroundImage(this._backGroundImageFileName,this._bgImageTexType),this.setBackGroundImageCapInsets(this._backGroundImageCapInsets))},isBackGroundImageScale9Enabled:function(){return this._backGroundScale9Enabled},setBackGroundImage:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,null===this._backGroundImage&&(this._addBackGroundImage(),this.setBackGroundImageScale9Enabled(this._backGroundScale9Enabled)),this._backGroundImageFileName=t,this._bgImageTexType=e;var i=this._backGroundImage;switch(this._bgImageTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._backGroundScale9Enabled&&i.setPreferredSize(this._contentSize),this._backGroundImageTextureSize=i.getContentSize(),i.setPosition(.5*this._contentSize.width,.5*this._contentSize.height),this._updateBackGroundImageColor()}},setBackGroundImageCapInsets:function(t){if(t){var e=this._backGroundImageCapInsets;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._backGroundScale9Enabled&&this._backGroundImage.setCapInsets(t)}},getBackGroundImageCapInsets:function(){return cc.rect(this._backGroundImageCapInsets)},_supplyTheLayoutParameterLackToChild:function(t){if(t)switch(this._layoutType){case ccui.Layout.ABSOLUTE:break;case ccui.Layout.LINEAR_HORIZONTAL:case ccui.Layout.LINEAR_VERTICAL:var e=t.getLayoutParameter(ccui.LayoutParameter.LINEAR);e||t.setLayoutParameter(new ccui.LinearLayoutParameter);break;case ccui.Layout.RELATIVE:var e=t.getLayoutParameter(ccui.LayoutParameter.RELATIVE);e||t.setLayoutParameter(new ccui.RelativeLayoutParameter)}},_addBackGroundImage:function(){var t=this._contentSize;this._backGroundScale9Enabled?(this._backGroundImage=new ccui.Scale9Sprite,this._backGroundImage.setPreferredSize(t)):this._backGroundImage=new cc.Sprite,this.addProtectedChild(this._backGroundImage,ccui.Layout.BACKGROUND_IMAGE_ZORDER,-1),this._backGroundImage.setPosition(.5*t.width,.5*t.height)},removeBackGroundImage:function(){this._backGroundImage&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundImageFileName="",this._backGroundImageTextureSize.width=0,this._backGroundImageTextureSize.height=0)},setBackGroundColorType:function(t){if(this._colorType!==t){switch(this._colorType){case ccui.Layout.BG_COLOR_NONE:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null),this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null);break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null)}switch(this._colorType=t,this._colorType){case ccui.Layout.BG_COLOR_NONE:break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender=new cc.LayerColor,this._colorRender.setContentSize(this._contentSize),this._colorRender.setOpacity(this._opacity),this._colorRender.setColor(this._color),this.addProtectedChild(this._colorRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender=new cc.LayerGradient(cc.color(255,0,0,255),cc.color(0,255,0,255)),this._gradientRender.setContentSize(this._contentSize),this._gradientRender.setOpacity(this._opacity),this._gradientRender.setStartColor(this._startColor),this._gradientRender.setEndColor(this._endColor),this._gradientRender.setVector(this._alongVector),this.addProtectedChild(this._gradientRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1)}}},getBackGroundColorType:function(){return this._colorType},setBackGroundColor:function(t,e){e?(this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._gradientRender&&this._gradientRender.setStartColor(t),this._endColor.r=e.r,this._endColor.g=e.g,this._endColor.b=e.b,this._gradientRender&&this._gradientRender.setEndColor(e)):(this._color.r=t.r,this._color.g=t.g,this._color.b=t.b,this._colorRender&&this._colorRender.setColor(t))},getBackGroundColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundStartColor:function(){var t=this._startColor;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundEndColor:function(){var t=this._endColor;return cc.color(t.r,t.g,t.b,t.a)},setBackGroundColorOpacity:function(t){switch(this._opacity=t,this._colorType){case ccui.Layout.BG_COLOR_NONE:break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender.setOpacity(t);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender.setOpacity(t)}},getBackGroundColorOpacity:function(){return this._opacity},setBackGroundColorVector:function(t){this._alongVector.x=t.x,this._alongVector.y=t.y,this._gradientRender&&this._gradientRender.setVector(t)},getBackGroundColorVector:function(){return this._alongVector},setBackGroundImageColor:function(t){this._backGroundImageColor.r=t.r,this._backGroundImageColor.g=t.g,this._backGroundImageColor.b=t.b,this._updateBackGroundImageColor()},setBackGroundImageOpacity:function(t){this._backGroundImageColor.a=t,this.getBackGroundImageColor()},getBackGroundImageColor:function(){var t=this._backGroundImageColor;return cc.color(t.r,t.g,t.b,t.a)},getBackGroundImageOpacity:function(){return this._backGroundImageColor.a},_updateBackGroundImageColor:function(){this._backGroundImage&&this._backGroundImage.setColor(this._backGroundImageColor)},getBackGroundImageTextureSize:function(){return this._backGroundImageTextureSize},setLayoutType:function(t){this._layoutType=t;for(var e=this._children,i=null,n=0;n<e.length;n++)i=e[n],i instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(i);this._doLayoutDirty=!0},getLayoutType:function(){return this._layoutType},requestDoLayout:function(){this._doLayoutDirty=!0},_doLayout:function(){if(this._doLayoutDirty){this.sortAllChildren();var t=ccui.getLayoutManager(this._layoutType);t&&t._doLayout(this),this._doLayoutDirty=!1}},_getLayoutContentSize:function(){return this.getContentSize()},_getLayoutElements:function(){return this.getChildren()},_updateBackGroundImageOpacity:function(){this._backGroundImage&&this._backGroundImage.setOpacity(this._backGroundImageOpacity)},_updateBackGroundImageRGBA:function(){this._backGroundImage&&(this._backGroundImage.setColor(this._backGroundImageColor),this._backGroundImage.setOpacity(this._backGroundImageOpacity))},_getLayoutAccumulatedSize:function(){for(var t,e=this.getChildren(),i=cc.size(0,0),n=0,r=0,o=e.length;r<o;r++){var s=e[r];if(null!==s&&s instanceof ccui.Layout)t=s._getLayoutAccumulatedSize(),i.width+=t.width,i.height+=t.height;else if(s instanceof ccui.Widget){n++;var c=s.getLayoutParameter().getMargin();t=s.getContentSize(),i.width+=t.width+.5*(c.right+c.left),i.height+=t.height+.5*(c.top+c.bottom)}}var a=this.getLayoutType();return a===ccui.Layout.LINEAR_HORIZONTAL&&(i.height=i.height-i.height/n*(n-1)),a===ccui.Layout.LINEAR_VERTICAL&&(i.width=i.width-i.width/n*(n-1)),i},_findNearestChildWidgetIndex:function(t,e){if(null==e||e===this)return this._findFirstFocusEnabledWidgetIndex();var i,n=0,r=this.getChildren(),o=r.length,s=cc.FLT_MAX,c=0;if(t===ccui.Widget.LEFT||t===ccui.Widget.RIGHT||t===ccui.Widget.DOWN||t===ccui.Widget.UP){for(i=this._getWorldCenterPoint(e);n<o;){var a=r[n];if(a&&a instanceof ccui.Widget&&a.isFocusEnabled()){var l=a instanceof ccui.Layout?a._calculateNearestDistance(e):cc.pLength(cc.pSub(this._getWorldCenterPoint(a),i));l<s&&(c=n,s=l)}n++}return c}return cc.log("invalid focus direction!"),0},_findFarthestChildWidgetIndex:function(t,e){if(null==e||e===this)return this._findFirstFocusEnabledWidgetIndex();var i=0,n=this.getChildren(),r=n.length,o=-cc.FLT_MAX,s=0;if(t===ccui.Widget.LEFT||t===ccui.Widget.RIGHT||t===ccui.Widget.DOWN||t===ccui.Widget.UP){for(var c=this._getWorldCenterPoint(e);i<r;){var a=n[i];if(a&&a instanceof ccui.Widget&&a.isFocusEnabled()){var l=a instanceof ccui.Layout?a._calculateFarthestDistance(e):cc.pLength(cc.pSub(this._getWorldCenterPoint(a),c));l>o&&(s=i,o=l)}i++}return s}return cc.log("invalid focus direction!!!"),0},_calculateNearestDistance:function(t){for(var e=cc.FLT_MAX,i=this._getWorldCenterPoint(t),n=this._children,r=0,o=n.length;r<o;r++){var s,c=n[r];if(c instanceof ccui.Layout)s=c._calculateNearestDistance(t);else{if(!(c instanceof ccui.Widget&&c.isFocusEnabled()))continue;s=cc.pLength(cc.pSub(this._getWorldCenterPoint(c),i))}s<e&&(e=s)}return e},_calculateFarthestDistance:function(t){for(var e=-cc.FLT_MAX,i=this._getWorldCenterPoint(t),n=this._children,r=0,o=n.length;r<o;r++){var s,c=n[r];if(c instanceof ccui.Layout)s=c._calculateFarthestDistance(t);else{if(!(c instanceof ccui.Widget&&c.isFocusEnabled()))continue;var a=this._getWorldCenterPoint(c);s=cc.pLength(cc.pSub(a,i))}s>e&&(e=s)}return e},_findProperSearchingFunctor:function(t,e){if(void 0!==e){var i=this._getWorldCenterPoint(e),n=this._getWorldCenterPoint(this._findFirstNonLayoutWidget());t===ccui.Widget.LEFT?this.onPassFocusToChild=i.x>n.x?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:t===ccui.Widget.RIGHT?this.onPassFocusToChild=i.x>n.x?this._findFarthestChildWidgetIndex:this._findNearestChildWidgetIndex:t===ccui.Widget.DOWN?this.onPassFocusToChild=i.y>n.y?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:t===ccui.Widget.UP?this.onPassFocusToChild=i.y<n.y?this._findNearestChildWidgetIndex:this._findFarthestChildWidgetIndex:cc.log("invalid direction!")}},_findFirstNonLayoutWidget:function(){for(var t=this._children,e=0,i=t.length;e<i;e++){var n=t[e];if(n instanceof ccui.Layout){var r=n._findFirstNonLayoutWidget();if(r)return r}else if(n instanceof ccui.Widget)return n}return null},_findFirstFocusEnabledWidgetIndex:function(){for(var t=0,e=this.getChildren(),i=e.length;t<i;){var n=e[t];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return t;t++}return 0},_findFocusEnabledChildWidgetByIndex:function(t){var e=this._getChildWidgetByIndex(t);return e?e.isFocusEnabled()?e:(t+=1,this._findFocusEnabledChildWidgetByIndex(t)):null},_getWorldCenterPoint:function(t){var e=t instanceof ccui.Layout?t._getLayoutAccumulatedSize():t.getContentSize();return t.convertToWorldSpace(cc.p(e.width/2,e.height/2))},_getNextFocusedWidget:function(t,e){var i=null,n=this._children,r=n.indexOf(e);return r+=1,r<n.length?(i=this._getChildWidgetByIndex(r),i?i.isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,i)):(this.dispatchFocusEvent(e,i),i):this._getNextFocusedWidget(t,i):e):this._loopFocus?this._checkFocusEnabledChild()?(r=0,i=this._getChildWidgetByIndex(r),i.isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,i)):(this.dispatchFocusEvent(e,i),i):this._getNextFocusedWidget(t,i)):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:this._isLastWidgetInContainer(e,t)?this._isWidgetAncestorSupportLoopFocus(this,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this)},_getPreviousFocusedWidget:function(t,e){var i=null,n=this._children,r=n.indexOf(e);return r-=1,r>=0?(i=this._getChildWidgetByIndex(r),i.isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,i)):(this.dispatchFocusEvent(e,i),i):this._getPreviousFocusedWidget(t,i)):this._loopFocus?this._checkFocusEnabledChild()?(r=n.length-1,i=this._getChildWidgetByIndex(r),i.isFocusEnabled()?i instanceof ccui.Layout?(i._isFocusPassing=!0,i.findNextFocusedWidget(t,i)):(this.dispatchFocusEvent(e,i),i):this._getPreviousFocusedWidget(t,i)):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:this._isLastWidgetInContainer(e,t)?this._isWidgetAncestorSupportLoopFocus(this,t)?ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this):e instanceof ccui.Layout?e:ccui.Widget._focusedWidget:ccui.Widget.prototype.findNextFocusedWidget.call(this,t,this)},_getChildWidgetByIndex:function(t){for(var e=this._children,i=e.length,n=0,r=t;t<i;){var o=e[t];if(o&&o instanceof ccui.Widget)return o;n++,t++}for(var s=0;s<r;){var c=e[s];if(c&&c instanceof ccui.Widget)return c;n++,s++}return null},_isLastWidgetInContainer:function(t,e){var i=t.getParent();if(null==i||!(i instanceof ccui.Layout))return!0;var n=i.getChildren(),r=n.indexOf(t);if(i.getLayoutType()===ccui.Layout.LINEAR_HORIZONTAL){if(e===ccui.Widget.LEFT)return 0===r&&this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.RIGHT)return r===n.length-1&&this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.DOWN)return this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.UP)return this._isLastWidgetInContainer(i,e)}else{if(i.getLayoutType()!==ccui.Layout.LINEAR_VERTICAL)return cc.log("invalid layout Type"),!1;if(e===ccui.Widget.UP)return 0===r&&this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.DOWN)return r===n.length-1&&this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.LEFT)return this._isLastWidgetInContainer(i,e);if(e===ccui.Widget.RIGHT)return this._isLastWidgetInContainer(i,e)}},_isWidgetAncestorSupportLoopFocus:function(t,e){var i=t.getParent();if(null==i||!(i instanceof ccui.Layout))return!1;if(i.isLoopFocus()){var n=i.getLayoutType();return n===ccui.Layout.LINEAR_HORIZONTAL?e===ccui.Widget.LEFT||e===ccui.Widget.RIGHT||this._isWidgetAncestorSupportLoopFocus(i,e):n===ccui.Layout.LINEAR_VERTICAL?e===ccui.Widget.DOWN||e===ccui.Widget.UP||this._isWidgetAncestorSupportLoopFocus(i,e):(cc.assert(0,"invalid layout type"),!1)}return this._isWidgetAncestorSupportLoopFocus(i,e)},_passFocusToChild:function(t,e){if(this._checkFocusEnabledChild()){var i=ccui.Widget.getCurrentFocusedWidget();this._findProperSearchingFunctor(t,i);var n=this.onPassFocusToChild(t,i),r=this._getChildWidgetByIndex(n);return r instanceof ccui.Layout?(r._isFocusPassing=!0,r.findNextFocusedWidget(t,r)):(this.dispatchFocusEvent(e,r),r)}return this},_checkFocusEnabledChild:function(){for(var t=this._children,e=0,i=t.length;e<i;e++){var n=t[e];if(n&&n instanceof ccui.Widget&&n.isFocusEnabled())return!0}return!1},getDescription:function(){return"Layout"},_createCloneInstance:function(){return new ccui.Layout},_copyClonedWidgetChildren:function(t){ccui.Widget.prototype._copyClonedWidgetChildren.call(this,t)},_copySpecialProperties:function(t){t instanceof ccui.Layout&&(this.setBackGroundImageScale9Enabled(t._backGroundScale9Enabled),this.setBackGroundImage(t._backGroundImageFileName,t._bgImageTexType),this.setBackGroundImageCapInsets(t._backGroundImageCapInsets),this.setBackGroundColorType(t._colorType),this.setBackGroundColor(t._color),this.setBackGroundColor(t._startColor,t._endColor),this.setBackGroundColorOpacity(t._opacity),this.setBackGroundColorVector(t._alongVector),this.setLayoutType(t._layoutType),this.setClippingEnabled(t._clippingEnabled),this.setClippingType(t._clippingType),this._loopFocus=t._loopFocus,this.__passFocusToChild=t.__passFocusToChild,this._isInterceptTouch=t._isInterceptTouch)},forceDoLayout:function(){this.requestDoLayout(),this._doLayout()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new ccui.Layout.WebGLRenderCmd(this):new ccui.Layout.CanvasRenderCmd(this)}});var _p=ccui.Layout.prototype;_p.clippingEnabled,cc.defineGetterSetter(_p,"clippingEnabled",_p.isClippingEnabled,_p.setClippingEnabled),_p.clippingType,cc.defineGetterSetter(_p,"clippingType",null,_p.setClippingType),_p.layoutType,cc.defineGetterSetter(_p,"layoutType",_p.getLayoutType,_p.setLayoutType),_p=null,ccui.Layout.create=function(){return new ccui.Layout},ccui.Layout.BG_COLOR_NONE=0,ccui.Layout.BG_COLOR_SOLID=1,ccui.Layout.BG_COLOR_GRADIENT=2,ccui.Layout.ABSOLUTE=0,ccui.Layout.LINEAR_VERTICAL=1,ccui.Layout.LINEAR_HORIZONTAL=2,ccui.Layout.RELATIVE=3,ccui.Layout.CLIPPING_STENCIL=0,ccui.Layout.CLIPPING_SCISSOR=1,ccui.Layout.BACKGROUND_IMAGE_ZORDER=-1,ccui.Layout.BACKGROUND_RENDERER_ZORDER=-2,function(){ccui.Layout.CanvasRenderCmd=function(t){ccui.ProtectedNode.CanvasRenderCmd.call(this,t),this._needDraw=!1,this._rendererSaveCmd=new cc.CustomRenderCmd(this,this._onRenderSaveCmd),this._rendererClipCmd=new cc.CustomRenderCmd(this,this._onRenderClipCmd),this._rendererRestoreCmd=new cc.CustomRenderCmd(this,this._onRenderRestoreCmd),this._rendererSaveCmd._canUseDirtyRegion=!0,this._rendererClipCmd._canUseDirtyRegion=!0,this._rendererRestoreCmd._canUseDirtyRegion=!0};var t=ccui.Layout.CanvasRenderCmd.prototype=Object.create(ccui.ProtectedNode.CanvasRenderCmd.prototype);t.constructor=ccui.Layout.CanvasRenderCmd,cc.game.addEventListener(cc.game.EVENT_RENDERER_INITED,function(){ccui.Widget.CanvasRenderCmd&&(ccui.Layout.CanvasRenderCmd.prototype.widgetVisit=ccui.Widget.CanvasRenderCmd.prototype.widgetVisit)}),t.visit=function(t){var e=this._node;if(e._visible)if(e._adaptRenderers(),e._doLayout(),e._clippingEnabled)switch(e._clippingType){case ccui.Layout.CLIPPING_STENCIL:this.stencilClippingVisit(t);break;case ccui.Layout.CLIPPING_SCISSOR:this.scissorClippingVisit(t)}else this.widgetVisit(t)},t.layoutVisit=t.visit,t._onRenderSaveCmd=function(t,e,i){var n=t||cc._renderContext,r=n.getContext();n.save(),n.save(),n.setTransform(this._worldTransform,e,i);for(var o=this._node._clippingStencil._renderCmd._buffer,s=0,c=o.length;s<c;s++){var a=o[s],l=a.verts,h=l[0];r.beginPath(),r.moveTo(h.x,-h.y);for(var u=1,d=l.length;u<d;u++)r.lineTo(l[u].x,-l[u].y);r.closePath()}},t._onRenderClipCmd=function(t){var e=t||cc._renderContext,i=e.getContext();e.restore(),i.clip()},t._onRenderRestoreCmd=function(t){var e=t||cc._renderContext;e.getContext();e.restore()},t.rebindStencilRendering=function(t){t._renderCmd.rendering=this.__stencilDraw,t._renderCmd._canUseDirtyRegion=!0},t.__stencilDraw=function(t,e,i){},t.stencilClippingVisit=t.scissorClippingVisit=function(t){var e=this._node;if(e._clippingStencil&&e._clippingStencil.isVisible()){this._syncStatus(t),cc.renderer.pushRenderCommand(this._rendererSaveCmd),e._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._rendererClipCmd),e.sortAllChildren(),e.sortAllProtectedChildren();for(var i,n=e._children,r=0,o=e._protectedChildren,s=0,c=n.length,a=o.length;s<c&&(i=n[s],i&&i.getLocalZOrder()<0);s++)i.visit(this);for(;r<a&&(i=o[r],i&&i.getLocalZOrder()<0);r++)i.visit(this);for(;s<c;s++)n[s].visit(this);for(;r<a;r++)o[r].visit(this);cc.renderer.pushRenderCommand(this._rendererRestoreCmd),this._dirtyFlag=0}},ccui.Layout.CanvasRenderCmd._getSharedCache=function(){return cc.ClippingNode._sharedCache||(cc.ClippingNode._sharedCache=document.createElement("canvas"))}}(),function(){if(ccui.ProtectedNode.WebGLRenderCmd){ccui.Layout.WebGLRenderCmd=function(t){ccui.ProtectedNode.WebGLRenderCmd.call(this,t),this._needDraw=!1,this._currentStencilEnabled=0,this._scissorOldState=!1,this._clippingOldRect=null,this._mask_layer_le=0,this._beforeVisitCmdStencil=new cc.CustomRenderCmd(this,this._onBeforeVisitStencil),this._afterDrawStencilCmd=new cc.CustomRenderCmd(this,this._onAfterDrawStencil),this._afterVisitCmdStencil=new cc.CustomRenderCmd(this,this._onAfterVisitStencil),this._beforeVisitCmdScissor=new cc.CustomRenderCmd(this,this._onBeforeVisitScissor),this._afterVisitCmdScissor=new cc.CustomRenderCmd(this,this._onAfterVisitScissor)};var t=ccui.Layout.WebGLRenderCmd.prototype=Object.create(ccui.ProtectedNode.WebGLRenderCmd.prototype);t.constructor=ccui.Layout.WebGLRenderCmd,t.visit=function(t){var e=this._node;if(e._visible)if(t&&t._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(e._clippingRectDirty=!0),e._adaptRenderers(),e._doLayout(),e._clippingEnabled)switch(e._clippingType){case ccui.Layout.CLIPPING_STENCIL:this.stencilClippingVisit(t);break;case ccui.Layout.CLIPPING_SCISSOR:this.scissorClippingVisit(t)}else this.pNodeVisit(t)},t.layoutVisit=t.visit,t._onBeforeVisitStencil=function(t){var e=t||cc._renderContext;ccui.Layout.WebGLRenderCmd._layer++;var i=1<<ccui.Layout.WebGLRenderCmd._layer,n=i-1;this._mask_layer_le=i|n,this._currentStencilEnabled=e.isEnabled(e.STENCIL_TEST),e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.depthMask(!1),e.stencilFunc(e.NEVER,i,i),e.stencilOp(e.REPLACE,e.KEEP,e.KEEP),e.stencilMask(i),e.clear(e.STENCIL_BUFFER_BIT)},t._onAfterDrawStencil=function(t){var e=t||cc._renderContext;e.depthMask(!0),e.stencilFunc(e.EQUAL,this._mask_layer_le,this._mask_layer_le),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t._onAfterVisitStencil=function(t){var e=t||cc._renderContext;if(ccui.Layout.WebGLRenderCmd._layer--,this._currentStencilEnabled){var i=1<<ccui.Layout.WebGLRenderCmd._layer,n=i-1,r=i|n;e.stencilMask(i),e.stencilFunc(e.EQUAL,r,r)}else e.disable(e.STENCIL_TEST)},t._onBeforeVisitScissor=function(t){this._node._clippingRectDirty=!0;var e=this._node._getClippingRect(),i=t||cc._renderContext;this._scissorOldState=i.isEnabled(i.SCISSOR_TEST),this._scissorOldState?(this._clippingOldRect=cc.view.getScissorRect(),cc.rectEqualToRect(this._clippingOldRect,e)||cc.view.setScissorInPoints(e.x,e.y,e.width,e.height)):(i.enable(i.SCISSOR_TEST),cc.view.setScissorInPoints(e.x,e.y,e.width,e.height))},t._onAfterVisitScissor=function(t){var e=t||cc._renderContext;this._scissorOldState?cc.rectEqualToRect(this._clippingOldRect,this._node._clippingRect)||cc.view.setScissorInPoints(this._clippingOldRect.x,this._clippingOldRect.y,this._clippingOldRect.width,this._clippingOldRect.height):e.disable(e.SCISSOR_TEST)},t.rebindStencilRendering=function(t){},t.transform=function(t,e){var i=this._node;this.pNodeTransform(t,e),i._clippingStencil&&i._clippingStencil._renderCmd.transform(this,e)},t.stencilClippingVisit=function(t){var e=this._node;if(e._clippingStencil&&e._clippingStencil.isVisible()){if(ccui.Layout.WebGLRenderCmd._layer+1===cc.stencilBits)return ccui.Layout.WebGLRenderCmd._visit_once=!0,ccui.Layout.WebGLRenderCmd._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its childs."),ccui.Layout.WebGLRenderCmd._visit_once=!1),void cc.Node.prototype.visit.call(e,t);cc.renderer.pushRenderCommand(this._beforeVisitCmdStencil);var i=cc.current_stack;i.stack.push(i.top),this._syncStatus(t),this._dirtyFlag=0,i.top=this._stackMatrix,e._clippingStencil.visit(this),cc.renderer.pushRenderCommand(this._afterDrawStencilCmd);var n=0,r=0;e.sortAllChildren(),e.sortAllProtectedChildren();for(var o,s=e._children,c=e._protectedChildren,a=s.length,l=c.length;n<a&&(o=s[n],o&&o.getLocalZOrder()<0);n++)o.visit(this);for(;r<l&&(o=c[r],o&&o.getLocalZOrder()<0);r++)o.visit(this);for(;n<a;n++)s[n].visit(this);for(;r<l;r++)c[r].visit(this);cc.renderer.pushRenderCommand(this._afterVisitCmdStencil),i.top=i.stack.pop()}},t.scissorClippingVisit=function(t){cc.renderer.pushRenderCommand(this._beforeVisitCmdScissor),this.pNodeVisit(t),cc.renderer.pushRenderCommand(this._afterVisitCmdScissor)},ccui.Layout.WebGLRenderCmd._layer=-1,ccui.Layout.WebGLRenderCmd._visit_once=null}}(),ccui.Margin=ccui.Class.extend({left:0,top:0,right:0,bottom:0,ctor:function(t,e,i,n){void 0!==t&&void 0===e&&(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom),void 0!==n&&(this.left=t,this.top=e,this.right=i,this.bottom=n)},setMargin:function(t,e,i,n){this.left=t,this.top=e,this.right=i,this.bottom=n},equals:function(t){return this.left===t.left&&this.top===t.top&&this.right===t.right&&this.bottom===t.bottom}}),ccui.MarginZero=function(){return new ccui.Margin(0,0,0,0)},ccui.LayoutParameter=ccui.Class.extend({_margin:null,_layoutParameterType:null,ctor:function(){this._margin=new ccui.Margin,this._layoutParameterType=ccui.LayoutParameter.NONE},setMargin:function(t){cc.isObject(t)?(this._margin.left=t.left,this._margin.top=t.top,this._margin.right=t.right,this._margin.bottom=t.bottom):(this._margin.left=arguments[0],this._margin.top=arguments[1],this._margin.right=arguments[2],this._margin.bottom=arguments[3])},getMargin:function(){return this._margin},getLayoutType:function(){return this._layoutParameterType},clone:function(){var t=this._createCloneInstance();return t._copyProperties(this),t},_createCloneInstance:function(){return new ccui.LayoutParameter},_copyProperties:function(t){this._margin.bottom=t._margin.bottom,this._margin.left=t._margin.left,this._margin.right=t._margin.right,this._margin.top=t._margin.top}}),ccui.LayoutParameter.create=function(){return new ccui.LayoutParameter},ccui.LayoutParameter.NONE=0,ccui.LayoutParameter.LINEAR=1,ccui.LayoutParameter.RELATIVE=2,ccui.LinearLayoutParameter=ccui.LayoutParameter.extend({_linearGravity:null,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._linearGravity=ccui.LinearLayoutParameter.NONE,this._layoutParameterType=ccui.LayoutParameter.LINEAR},setGravity:function(t){this._linearGravity=t},getGravity:function(){return this._linearGravity},_createCloneInstance:function(){return new ccui.LinearLayoutParameter},_copyProperties:function(t){ccui.LayoutParameter.prototype._copyProperties.call(this,t),t instanceof ccui.LinearLayoutParameter&&this.setGravity(t._linearGravity)}}),ccui.LinearLayoutParameter.create=function(){return new ccui.LinearLayoutParameter},ccui.LinearLayoutParameter.NONE=0,ccui.LinearLayoutParameter.LEFT=1,ccui.LinearLayoutParameter.TOP=2,ccui.LinearLayoutParameter.RIGHT=3,ccui.LinearLayoutParameter.BOTTOM=4,ccui.LinearLayoutParameter.CENTER_VERTICAL=5,ccui.LinearLayoutParameter.CENTER_HORIZONTAL=6,ccui.RelativeLayoutParameter=ccui.LayoutParameter.extend({_relativeAlign:null,_relativeWidgetName:"",_relativeLayoutName:"",_put:!1,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this),this._relativeAlign=ccui.RelativeLayoutParameter.NONE,this._relativeWidgetName="",this._relativeLayoutName="",this._put=!1,this._layoutParameterType=ccui.LayoutParameter.RELATIVE},setAlign:function(t){this._relativeAlign=t},getAlign:function(){return this._relativeAlign},setRelativeToWidgetName:function(t){this._relativeWidgetName=t},getRelativeToWidgetName:function(){return this._relativeWidgetName},setRelativeName:function(t){this._relativeLayoutName=t},getRelativeName:function(){return this._relativeLayoutName},_createCloneInstance:function(){return new ccui.RelativeLayoutParameter},_copyProperties:function(t){ccui.LayoutParameter.prototype._copyProperties.call(this,t),t instanceof ccui.RelativeLayoutParameter&&(this.setAlign(t._relativeAlign),this.setRelativeToWidgetName(t._relativeWidgetName),this.setRelativeName(t._relativeLayoutName))}}),ccui.RelativeLayoutParameter.create=function(){return new ccui.RelativeLayoutParameter},ccui.RelativeLayoutParameter.NONE=0,ccui.RelativeLayoutParameter.PARENT_TOP_LEFT=1,ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT=3,ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL=4,ccui.RelativeLayoutParameter.CENTER_IN_PARENT=5,ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM=7,ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM=9,ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN=10,ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER=11,ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN=12,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN=13,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER=14,ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN=15,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN=16,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER=17,ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN=18,ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN=19,ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER=20,ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN=21,ccui.LINEAR_GRAVITY_NONE=0,ccui.LINEAR_GRAVITY_LEFT=1,ccui.LINEAR_GRAVITY_TOP=2,ccui.LINEAR_GRAVITY_RIGHT=3,ccui.LINEAR_GRAVITY_BOTTOM=4,ccui.LINEAR_GRAVITY_CENTER_VERTICAL=5,ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL=6,ccui.RELATIVE_ALIGN_NONE=0,ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT=1,ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL=2,ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT=3,ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL=4,ccui.RELATIVE_ALIGN_PARENT_CENTER=5,ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL=6,ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM=7,ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL=8,ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM=9,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT=10,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER=11,ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT=12,ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP=13,ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER=14,ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM=15,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP=16,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER=17,ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM=18,ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP=19,ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER=20,ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM=21,ccui.getLayoutManager=function(t){switch(t){case ccui.Layout.LINEAR_VERTICAL:return ccui.linearVerticalLayoutManager;case ccui.Layout.LINEAR_HORIZONTAL:return ccui.linearHorizontalLayoutManager;case ccui.Layout.RELATIVE:return ccui.relativeLayoutManager}return null},ccui.linearVerticalLayoutManager={_doLayout:function(t){for(var e=t._getLayoutContentSize(),i=t._getLayoutElements(),n=e.height,r=0,o=i.length;r<o;r++){var s=i[r];if(s){var c=s.getLayoutParameter();if(c){var a=c.getGravity(),l=s.getAnchorPoint(),h=s.getContentSize(),u=l.x*h.width,d=n-(1-l.y)*h.height;switch(a){case ccui.LinearLayoutParameter.NONE:case ccui.LinearLayoutParameter.LEFT:break;case ccui.LinearLayoutParameter.RIGHT:u=e.width-(1-l.x)*h.width;break;case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:u=e.width/2-h.width*(.5-l.x)}var _=c.getMargin();u+=_.left,d-=_.top,s.setPosition(u,d),n=s.getPositionY()-l.y*h.height-_.bottom}}}}},ccui.linearHorizontalLayoutManager={_doLayout:function(t){for(var e=t._getLayoutContentSize(),i=t._getLayoutElements(),n=0,r=0,o=i.length;r<o;r++){var s=i[r];if(s){var c=s.getLayoutParameter();if(c){var a=c.getGravity(),l=s.getAnchorPoint(),h=s.getContentSize(),u=n+l.x*h.width,d=e.height-(1-l.y)*h.height;switch(a){case ccui.LinearLayoutParameter.NONE:case ccui.LinearLayoutParameter.TOP:break;case ccui.LinearLayoutParameter.BOTTOM:d=l.y*h.height;break;case ccui.LinearLayoutParameter.CENTER_VERTICAL:d=e.height/2-h.height*(.5-l.y)}var _=c.getMargin();u+=_.left,d-=_.top,s.setPosition(u,d),n=s.getRightBoundary()+_.right}}}}},ccui.relativeLayoutManager={_unlayoutChildCount:0,_widgetChildren:[],_widget:null,_finalPositionX:0,_finalPositionY:0,_relativeWidgetLP:null,_doLayout:function(t){this._widgetChildren=this._getAllWidgets(t);for(var e=this._widgetChildren;this._unlayoutChildCount>0;){for(var i=0,n=e.length;i<n;i++){this._widget=e[i];var r=this._widget.getLayoutParameter();if(r){if(r._put)continue;var o=this._calculateFinalPositionWithRelativeWidget(t);if(!o)continue;this._calculateFinalPositionWithRelativeAlign(),this._widget.setPosition(this._finalPositionX,this._finalPositionY),r._put=!0}}this._unlayoutChildCount--}this._widgetChildren.length=0},_getAllWidgets:function(t){var e=t._getLayoutElements(),i=this._widgetChildren;i.length=0;for(var n=0,r=e.length;n<r;n++){var o=e[n];if(o&&o instanceof ccui.Widget){var s=o.getLayoutParameter();s._put=!1,this._unlayoutChildCount++,i.push(o)}}return i},_getRelativeWidget:function(t){var e=null,i=t.getLayoutParameter(),n=i.getRelativeToWidgetName();if(n&&0!==n.length)for(var r=this._widgetChildren,o=0,s=r.length;o<s;o++){var c=r[o];if(c){var a=c.getLayoutParameter();if(a&&a.getRelativeName()===n){e=c,this._relativeWidgetLP=a;break}}}return e},_calculateFinalPositionWithRelativeWidget:function(t){var e=this._widget,i=e.getAnchorPoint(),n=e.getContentSize();this._finalPositionX=0,this._finalPositionY=0;var r=this._getRelativeWidget(e),o=e.getLayoutParameter(),s=o.getAlign(),c=t._getLayoutContentSize();switch(s){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX=i.x*n.width,this._finalPositionY=c.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionX=.5*c.width-n.width*(.5-i.x),this._finalPositionY=c.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX=c.width-(1-i.x)*n.width,this._finalPositionY=c.height-(1-i.y)*n.height;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX=i.x*n.width,this._finalPositionY=.5*c.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:this._finalPositionX=.5*c.width-n.width*(.5-i.x),this._finalPositionY=.5*c.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX=c.width-(1-i.x)*n.width,this._finalPositionY=.5*c.height-n.height*(.5-i.y);break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX=i.x*n.width,this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionX=.5*c.width-n.width*(.5-i.x),this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX=c.width-(1-i.x)*n.width,this._finalPositionY=i.y*n.height;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;var a=r.getContentSize();this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()+.5*a.width+i.x*n.width-.5*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()+i.y*n.height,this._finalPositionX=r.getRightBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;var a=r.getContentSize();this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width,this._finalPositionY=r.getBottomBoundary()+.5*a.height+i.y*n.height-.5*n.height}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()+i.y*n.height,this._finalPositionX=r.getLeftBoundary()-(1-i.x)*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getTopBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getRightBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;var a=r.getContentSize(),l=r.getRightBoundary();this._finalPositionX=l+i.x*n.width,this._finalPositionY=r.getBottomBoundary()+.5*a.height+i.y*n.height-.5*n.height}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()+i.y*n.height,this._finalPositionX=r.getRightBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()+i.x*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;var a=r.getContentSize();this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getLeftBoundary()+.5*a.width+i.x*n.width-.5*n.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:if(r){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=r.getBottomBoundary()-(1-i.y)*n.height,this._finalPositionX=r.getRightBoundary()-(1-i.x)*n.width}}return!0},_calculateFinalPositionWithRelativeAlign:function(){var t=this._widget.getLayoutParameter(),e=t.getMargin(),i=t.getAlign();switch(i){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX+=e.left,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX-=e.right,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX+=e.left,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX-=e.right,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:this._finalPositionY+=e.bottom,this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:this._finalPositionY+=e.bottom,this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:this._finalPositionX-=e.right,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:this._finalPositionX-=e.right,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:this._finalPositionX+=e.left,this._finalPositionY-=e.top;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:this._finalPositionX+=e.left,this._finalPositionY+=e.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:this._finalPositionY-=e.top,this._finalPositionX+=e.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:this._finalPositionY-=e.top,this._finalPositionX-=e.right;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:this._finalPositionY-=e.top}}},ccui.HBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL),t&&this.setContentSize(t)}}),ccui.HBox.create=function(t){return new ccui.HBox(t)},ccui.RelativeBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.RELATIVE),t&&this.setContentSize(t)}}),ccui.RelativeBox.create=function(t){return new ccui.RelativeBox(t)},ccui.VBox=ccui.Layout.extend({ctor:function(t){ccui.Layout.prototype.ctor.call(this),this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),t&&this.setContentSize(t)},initWithSize:function(t){return!!this.init()}}),ccui.VBox.create=function(t){return new ccui.VBox(t)},ccui.helper={seekWidgetByTag:function(t,e){if(!t)return null;if(t.getTag()===e)return t;for(var i=t.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=ccui.helper.seekWidgetByTag(o,e);if(null!==s)return s}return null},seekWidgetByName:function(t,e){if(!t)return null;if(t.getName()===e)return t;for(var i=t.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=ccui.helper.seekWidgetByName(o,e);if(null!==s)return s}return null},seekWidgetByRelativeName:function(t,e){if(!t)return null;for(var i=t.getChildren(),n=i.length,r=0;r<n;r++){var o=i[r],s=o.getLayoutParameter(ccui.LayoutParameter.RELATIVE);if(s&&s.getRelativeName()===e)return o}return null},seekActionWidgetByActionTag:function(t,e){if(!t)return null;if(t.getActionTag()===e)return t;for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n],o=ccui.helper.seekActionWidgetByActionTag(r,e);if(null!==o)return o}return null},_activeLayout:!0,doLayout:function(t){if(this._activeLayout)for(var e,i=t.getChildren(),n=0,r=i.length;n<r;n++){e=i[n];var o=e.getComponent(ccui.LayoutComponent.NAME),s=e.getParent();null!=o&&null!==s&&o.refreshLayout&&o.refreshLayout()}},changeLayoutSystemActiveState:function(t){this._activeLayout=t},restrictCapInsetRect:function(t,e){var i=t.x,n=t.y,r=t.width,o=t.height;return e.width<r&&(i=0,r=0),e.height<o&&(n=0,o=0),cc.rect(i,n,r,o)},_createSpriteFromBase64:function(t,e){var i=cc.textureCache.getTextureForKey(e);if(!i){var n=new Image;n.src=t,cc.textureCache.cacheImage(e,n),i=cc.textureCache.getTextureForKey(e)}var r=new cc.Sprite(i);return r}},ccui.Button=ccui.Widget.extend({_buttonNormalRenderer:null,_buttonClickedRenderer:null,_buttonDisableRenderer:null,_titleRenderer:null,_normalFileName:"",_clickedFileName:"",_disabledFileName:"",_prevIgnoreSize:!0,_scale9Enabled:!1,_capInsetsNormal:null,_capInsetsPressed:null,_capInsetsDisabled:null,_normalTexType:ccui.Widget.LOCAL_TEXTURE,_pressedTexType:ccui.Widget.LOCAL_TEXTURE,_disabledTexType:ccui.Widget.LOCAL_TEXTURE,_normalTextureSize:null,_pressedTextureSize:null,_disabledTextureSize:null,pressedActionEnabled:!1,_titleColor:null,_normalTextureScaleXInSize:1,_normalTextureScaleYInSize:1,_pressedTextureScaleXInSize:1,_pressedTextureScaleYInSize:1,_zoomScale:.1,_normalTextureLoaded:!1,_pressedTextureLoaded:!1,_disabledTextureLoaded:!1,_className:"Button",_normalTextureAdaptDirty:!0,_pressedTextureAdaptDirty:!0,_disabledTextureAdaptDirty:!0,_fontName:"Thonburi",_fontSize:12,_type:0,ctor:function(t,e,i,n){this._capInsetsNormal=cc.rect(0,0,0,0),this._capInsetsPressed=cc.rect(0,0,0,0),this._capInsetsDisabled=cc.rect(0,0,0,0),this._normalTextureSize=cc.size(0,0),this._pressedTextureSize=cc.size(0,0),this._disabledTextureSize=cc.size(0,0),this._titleColor=cc.color.WHITE,ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0),t&&this.loadTextures(t,e,i,n)},_initRenderer:function(){this._buttonNormalRenderer=new cc.Sprite,this._buttonClickedRenderer=new cc.Sprite,this._buttonDisableRenderer=new cc.Sprite,this._titleRenderer=new cc.LabelTTF(""),this._titleRenderer.setAnchorPoint(.5,.5),this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1),this.addProtectedChild(this._titleRenderer,ccui.Button.TITLE_RENDERER_ZORDER,-1)},setScale9Enabled:function(t){if(this._scale9Enabled!==t){if(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._scale9Enabled=t,this.removeProtectedChild(this._buttonNormalRenderer),this.removeProtectedChild(this._buttonClickedRenderer),this.removeProtectedChild(this._buttonDisableRenderer),this._scale9Enabled?(this._buttonNormalRenderer=new ccui.Scale9Sprite,this._buttonClickedRenderer=new ccui.Scale9Sprite,this._buttonDisableRenderer=new ccui.Scale9Sprite):(this._buttonNormalRenderer=new cc.Sprite,this._buttonClickedRenderer=new cc.Sprite,this._buttonDisableRenderer=new cc.Sprite),this._buttonClickedRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!1),this.loadTextureNormal(this._normalFileName,this._normalTexType),this.loadTexturePressed(this._clickedFileName,this._pressedTexType),this.loadTextureDisabled(this._disabledFileName,this._disabledTexType),this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1),this._scale9Enabled){var e=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=e}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsetsNormalRenderer(this._capInsetsNormal),this.setCapInsetsPressedRenderer(this._capInsetsPressed),this.setCapInsetsDisabledRenderer(this._capInsetsDisabled),this.setBright(this._bright),this._normalTextureAdaptDirty=!0,this._pressedTextureAdaptDirty=!0,this._disabledTextureAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){return this._unifySize?void this._updateContentSize():void((!this._scale9Enabled||this._scale9Enabled&&!t)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t))},getVirtualRendererSize:function(){return this._unifySize?this._getNormalSize():!this._normalTextureLoaded&&this._titleRenderer.getString().length>0?this._titleRenderer.getContentSize():cc.size(this._normalTextureSize)},loadTextures:function(t,e,i,n){this.loadTextureNormal(t,n),this.loadTexturePressed(e,n),this.loadTextureDisabled(i,n)},loadTextureNormal:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._normalFileName=t,this._normalTexType=e;var i=this,n=this._buttonNormalRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTextureNormal(i._normalFileName,i._normalTexType)}),this._normalTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(t)}this._normalTextureLoaded=n._textureLoaded,this._normalTextureSize=this._buttonNormalRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._unifySize?this._scale9Enabled&&(n.setCapInsets(this._capInsetsNormal),this._updateContentSizeWithTextureSize(this._getNormalSize())):this._updateContentSizeWithTextureSize(this._normalTextureSize),this._normalTextureAdaptDirty=!0,this._findLayout()}},loadTexturePressed:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._clickedFileName=t,this._pressedTexType=e;var i=this,n=this._buttonClickedRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTexturePressed(i._clickedFileName,i._pressedTexType)}),this._pressedTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(t)}this._scale9Enabled&&n.setCapInsets(this._capInsetsPressed),this._pressedTextureSize=this._buttonClickedRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._pressedTextureLoaded=!0,this._pressedTextureAdaptDirty=!0,this._findLayout()}},loadTextureDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._disabledFileName=t,this._disabledTexType=e;var i=this,n=this._buttonDisableRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTextureDisabled(i._disabledFileName,i._disabledTexType)}),this._disabledTexType){case ccui.Widget.LOCAL_TEXTURE:n.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:n.initWithSpriteFrameName(t)}this._scale9Enabled&&n.setCapInsets(this._capInsetsDisabled),this._disabledTextureSize=this._buttonDisableRenderer.getContentSize(),this._updateChildrenDisplayedRGBA(),this._disabledTextureLoaded=!0,this._disabledTextureAdaptDirty=!0,this._findLayout()}},setCapInsets:function(t){this.setCapInsetsNormalRenderer(t),this.setCapInsetsPressedRenderer(t),this.setCapInsetsDisabledRenderer(t)},setCapInsetsNormalRenderer:function(t){if(t){var e=t.x,i=t.y,n=t.width,r=t.height;this._normalTextureSize.width<n&&(e=0,n=0),this._normalTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsNormal;o.x=e,o.y=i,o.width=n,o.height=r,this._scale9Enabled&&this._buttonNormalRenderer.setCapInsets(o)}},getCapInsetsNormalRenderer:function(){return cc.rect(this._capInsetsNormal)},setCapInsetsPressedRenderer:function(t){if(t&&this._scale9Enabled){var e=t.x,i=t.y,n=t.width,r=t.height;this._pressedTextureSize.width<n&&(e=0,n=0),this._pressedTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsPressed;o.x=e,o.y=i,o.width=n,o.height=r,this._buttonClickedRenderer.setCapInsets(o)}},getCapInsetsPressedRenderer:function(){return cc.rect(this._capInsetsPressed)},setCapInsetsDisabledRenderer:function(t){if(t&&this._scale9Enabled){var e=t.x,i=t.y,n=t.width,r=t.height;this._disabledTextureSize.width<n&&(e=0,n=0),this._disabledTextureSize.height<r&&(i=0,r=0);var o=this._capInsetsDisabled;o.x=e,o.y=i,o.width=n,o.height=r,this._buttonDisableRenderer.setCapInsets(o)}},getCapInsetsDisabledRenderer:function(){return cc.rect(this._capInsetsDisabled)},_onPressStateChangedToNormal:function(){if(this._buttonNormalRenderer.setVisible(!0),this._buttonClickedRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!1),this._scale9Enabled&&this._buttonNormalRenderer.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded){if(this.pressedActionEnabled)if(this._buttonNormalRenderer.stopAllActions(),this._buttonClickedRenderer.stopAllActions(),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize),this._titleRenderer.stopAllActions(),this._unifySize){var t=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1,1);this._titleRenderer.runAction(t)}else this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1)}else this._buttonNormalRenderer.stopAllActions(),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._titleRenderer.stopAllActions(),this._scale9Enabled&&this._buttonNormalRenderer.setColor(cc.color.WHITE),this._titleRenderer.setScaleX(1),this._titleRenderer.setScaleY(1)},_onPressStateChangedToPressed:function(){var t=this._buttonNormalRenderer;if(this._scale9Enabled&&t.setState(ccui.Scale9Sprite.state.NORMAL),this._pressedTextureLoaded){if(t.setVisible(!1),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),this.pressedActionEnabled){t.stopAllActions(),this._buttonClickedRenderer.stopAllActions();var e=cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,this._pressedTextureScaleXInSize+this._zoomScale,this._pressedTextureScaleYInSize+this._zoomScale);this._buttonClickedRenderer.runAction(e),t.setScale(this._pressedTextureScaleXInSize+this._zoomScale,this._pressedTextureScaleYInSize+this._zoomScale),this._titleRenderer.stopAllActions(),this._titleRenderer.runAction(cc.scaleTo(ccui.Button.ZOOM_ACTION_TIME_STEP,1+this._zoomScale,1+this._zoomScale))}}else t.setVisible(!0),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),t.stopAllActions(),t.setScale(this._normalTextureScaleXInSize+this._zoomScale,this._normalTextureScaleYInSize+this._zoomScale),this._titleRenderer.stopAllActions(),this._titleRenderer.setScaleX(1+this._zoomScale),this._titleRenderer.setScaleY(1+this._zoomScale)},_onPressStateChangedToDisabled:function(){this._disabledTextureLoaded?(this._buttonNormalRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!0)):this._normalTextureLoaded&&this._scale9Enabled&&this._buttonNormalRenderer.setState(ccui.Scale9Sprite.state.GRAY),this._buttonClickedRenderer.setVisible(!1),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize),this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize)},_updateContentSize:function(){if(this._unifySize){if(this._scale9Enabled)ccui.ProtectedNode.setContentSize(this._customSize);else{var t=this._getNormalSize();ccui.ProtectedNode.setContentSize(t)}return void this._onSizeChanged()}this._ignoreSize&&this.setContentSize(this.getVirtualRendererSize())},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._updateTitleLocation(),this._normalTextureAdaptDirty=!0,this._pressedTextureAdaptDirty=!0,this._disabledTextureAdaptDirty=!0},getVirtualRenderer:function(){if(!this._bright)return this._buttonDisableRenderer;switch(this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:return this._buttonNormalRenderer;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:return this._buttonClickedRenderer;default:return null}},_normalTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled||(this._buttonNormalRenderer.setScale(1),this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonNormalRenderer.setPreferredSize(this._contentSize),this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1,this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize);else{var t=this._normalTextureSize;if(t.width<=0||t.height<=0)return void this._buttonNormalRenderer.setScale(1);var e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._buttonNormalRenderer.setScaleX(e),this._buttonNormalRenderer.setScaleY(i),this._normalTextureScaleXInSize=e,this._normalTextureScaleYInSize=i}this._buttonNormalRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_pressedTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled||(this._buttonClickedRenderer.setScale(1),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonClickedRenderer.setPreferredSize(this._contentSize),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1,this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize);else{var t=this._pressedTextureSize;if(t.width<=0||t.height<=0)return void this._buttonClickedRenderer.setScale(1);var e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._buttonClickedRenderer.setScaleX(e),this._buttonClickedRenderer.setScaleY(i),this._pressedTextureScaleXInSize=e,this._pressedTextureScaleYInSize=i}this._buttonClickedRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_disabledTextureScaleChangedWithSize:function(){if(this._ignoreSize&&!this._unifySize)this._scale9Enabled&&this._buttonDisableRenderer.setScale(1);else if(this._scale9Enabled)this._buttonDisableRenderer.setScale(1),this._buttonDisableRenderer.setPreferredSize(this._contentSize);else{var t=this._disabledTextureSize;if(t.width<=0||t.height<=0)return void this._buttonDisableRenderer.setScale(1);var e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._buttonDisableRenderer.setScaleX(e),this._buttonDisableRenderer.setScaleY(i)}this._buttonDisableRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_adaptRenderers:function(){this._normalTextureAdaptDirty&&(this._normalTextureScaleChangedWithSize(),this._normalTextureAdaptDirty=!1),this._pressedTextureAdaptDirty&&(this._pressedTextureScaleChangedWithSize(),this._pressedTextureAdaptDirty=!1),this._disabledTextureAdaptDirty&&(this._disabledTextureScaleChangedWithSize(),this._disabledTextureAdaptDirty=!1)},_updateTitleLocation:function(){this._titleRenderer.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},setPressedActionEnabled:function(t){this.pressedActionEnabled=t},setTitleText:function(t){if(t!==this.getTitleText())if(this._titleRenderer.setString(t),this._ignoreSize){var e=this.getVirtualRendererSize();this.setContentSize(e)}else this._titleRenderer._renderCmd._updateTTF()},getTitleText:function(){return this._titleRenderer.getString()},setTitleColor:function(t){this._titleRenderer.setFontFillColor(t)},getTitleColor:function(){return this._titleRenderer._getFillStyle()},setTitleFontSize:function(t){this._titleRenderer.setFontSize(t),this._fontSize=t},getTitleFontSize:function(){return this._titleRenderer.getFontSize()},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},getNormalTextureSize:function(){return this._normalTextureSize},setTitleFontName:function(t){this._titleRenderer.setFontName(t),this._fontName=t},getTitleRenderer:function(){return this._titleRenderer},getTitleFontName:function(){return this._titleRenderer.getFontName()},_setTitleFont:function(t){this._titleRenderer.font=t},_getTitleFont:function(){return this._titleRenderer.font},getDescription:function(){return"Button"},_createCloneInstance:function(){return new ccui.Button},_copySpecialProperties:function(t){this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadTextureNormal(t._normalFileName,t._normalTexType),this.loadTexturePressed(t._clickedFileName,t._pressedTexType),this.loadTextureDisabled(t._disabledFileName,t._disabledTexType),this.setCapInsetsNormalRenderer(t._capInsetsNormal),this.setCapInsetsPressedRenderer(t._capInsetsPressed),this.setCapInsetsDisabledRenderer(t._capInsetsDisabled),this.setTitleText(t.getTitleText()),this.setTitleFontName(t.getTitleFontName()),this.setTitleFontSize(t.getTitleFontSize()),this.setTitleColor(t.getTitleColor()),this.setPressedActionEnabled(t.pressedActionEnabled),this.setZoomScale(t._zoomScale)},_getNormalSize:function(){var t;null!==this._titleRenderer&&(t=this._titleRenderer.getContentSize());var e;null!==this._buttonNormalRenderer&&(e=this._buttonNormalRenderer.getContentSize());var i=t.width>e.width?t.width:e.width,n=t.height>e.height?t.height:e.height;return cc.size(i,n)}});var _p=ccui.Button.prototype;_p.titleText,cc.defineGetterSetter(_p,"titleText",_p.getTitleText,_p.setTitleText),_p.titleFont,cc.defineGetterSetter(_p,"titleFont",_p._getTitleFont,_p._setTitleFont),_p.titleFontSize,cc.defineGetterSetter(_p,"titleFontSize",_p.getTitleFontSize,_p.setTitleFontSize),_p.titleFontName,cc.defineGetterSetter(_p,"titleFontName",_p.getTitleFontName,_p.setTitleFontName),_p.titleColor,cc.defineGetterSetter(_p,"titleColor",_p.getTitleColor,_p.setTitleColor),_p=null,ccui.Button.create=function(t,e,i,n){return new ccui.Button(t,e,i,n)},ccui.Button.NORMAL_RENDERER_ZORDER=-2,ccui.Button.PRESSED_RENDERER_ZORDER=-2,ccui.Button.DISABLED_RENDERER_ZORDER=-2,ccui.Button.TITLE_RENDERER_ZORDER=-1,ccui.Button.ZOOM_ACTION_TIME_STEP=.05,ccui.Button.SYSTEM=0,ccui.Button.TTF=1,ccui.CheckBox=ccui.Widget.extend({_backGroundBoxRenderer:null,_backGroundSelectedBoxRenderer:null,_frontCrossRenderer:null,_backGroundBoxDisabledRenderer:null,_frontCrossDisabledRenderer:null,_isSelected:!0,_checkBoxEventListener:null,_checkBoxEventSelector:null,_backGroundTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundSelectedTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundFileName:"",_backGroundSelectedFileName:"",_frontCrossFileName:"",_backGroundDisabledFileName:"",_frontCrossDisabledFileName:"",_className:"CheckBox",_zoomScale:.1,_backgroundTextureScaleX:.1,_backgroundTextureScaleY:.1,_backGroundBoxRendererAdaptDirty:!0,_backGroundSelectedBoxRendererAdaptDirty:!0,_frontCrossRendererAdaptDirty:!0,_backGroundBoxDisabledRendererAdaptDirty:!0,_frontCrossDisabledRendererAdaptDirty:!0,ctor:function(t,e,i,n,r,o){ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0);for(var s=0,c=0;c<arguments.length;c++){var a=typeof arguments[c];"string"===a?isNaN(arguments[c]-0)?s++:(o=arguments[c],arguments[c]=void 0):"number"===a&&s++}switch(s){case 2:o=i,i=e,e=void 0}o=void 0===o?0:o,this._isSelected=!0,this.setSelected(!1),this.loadTextures(t,e,i,n,r,o)},_initRenderer:function(){this._backGroundBoxRenderer=new cc.Sprite,this._backGroundSelectedBoxRenderer=new cc.Sprite,this._frontCrossRenderer=new cc.Sprite,this._backGroundBoxDisabledRenderer=new cc.Sprite,this._frontCrossDisabledRenderer=new cc.Sprite,this.addProtectedChild(this._backGroundBoxRenderer,ccui.CheckBox.BOX_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundSelectedBoxRenderer,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossRenderer,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER,-1),this.addProtectedChild(this._backGroundBoxDisabledRenderer,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER,-1),this.addProtectedChild(this._frontCrossDisabledRenderer,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER,-1)},loadTextures:function(t,e,i,n,r,o){t&&this.loadTextureBackGround(t,o),e&&this.loadTextureBackGroundSelected(e,o),i&&this.loadTextureFrontCross(i,o),n&&this.loadTextureBackGroundDisabled(n,o),r&&this.loadTextureFrontCrossDisabled(r,o)},loadTextureBackGround:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundFileName=t,this._backGroundTexType=e;var i=this._backGroundBoxRenderer;switch(i._textureLoaded?this._backGroundBoxRenderer.setContentSize(this._customSize):i.addEventListener("load",function(){this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this.loadTextureBackGround(this._backGroundFileName,this._backGroundTexType)},this),this._backGroundTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize()),this._backGroundBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundSelected:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundSelectedFileName=t,this._backGroundSelectedTexType=e;var i=this._backGroundSelectedBoxRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundSelected(this._backGroundSelectedFileName,this._backGroundSelectedTexType)},this),this._backGroundSelectedTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._backGroundSelectedBoxRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCross:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._frontCrossFileName=t,this._frontCrossTexType=e;var i=this._frontCrossRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCross(this._frontCrossFileName,this._frontCrossTexType)},this),this._frontCrossTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._frontCrossRendererAdaptDirty=!0,this._findLayout()}},loadTextureBackGroundDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._backGroundDisabledFileName=t,this._backGroundDisabledTexType=e;var i=this._backGroundBoxDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureBackGroundDisabled(this._backGroundDisabledFileName,this._backGroundDisabledTexType)},this),this._backGroundDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._backGroundBoxDisabledRendererAdaptDirty=!0,this._findLayout()}},loadTextureFrontCrossDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._frontCrossDisabledFileName=t,this._frontCrossDisabledTexType=e;var i=this._frontCrossDisabledRenderer;switch(i._textureLoaded||i.addEventListener("load",function(){this.loadTextureFrontCrossDisabled(this._frontCrossDisabledFileName,this._frontCrossDisabledTexType)},this),this._frontCrossDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._frontCrossDisabledRendererAdaptDirty=!0,this._findLayout()}},_onPressStateChangedToNormal:function(){this._backGroundBoxRenderer.setVisible(!0),this._backGroundSelectedBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&(this._frontCrossRenderer.setVisible(!0),this._frontCrossRendererAdaptDirty=!0)},_onPressStateChangedToPressed:function(){this._backGroundSelectedFileName?(this._backGroundBoxRenderer.setVisible(!1),this._backGroundSelectedBoxRenderer.setVisible(!0),this._backGroundBoxDisabledRenderer.setVisible(!1),this._frontCrossDisabledRenderer.setVisible(!1)):(this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX+this._zoomScale,this._backgroundTextureScaleY+this._zoomScale))},_onPressStateChangedToDisabled:function(){this._backGroundDisabledFileName&&this._frontCrossDisabledFileName&&(this._backGroundBoxRenderer.setVisible(!1),this._backGroundBoxDisabledRenderer.setVisible(!0)),this._backGroundSelectedBoxRenderer.setVisible(!1),this._frontCrossRenderer.setVisible(!1),this._backGroundBoxRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._frontCrossRenderer.setScale(this._backgroundTextureScaleX,this._backgroundTextureScaleY),this._isSelected&&(this._frontCrossDisabledRenderer.setVisible(!0),this._frontCrossDisabledRendererAdaptDirty=!0)},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},setSelectedState:function(t){this.setSelected(t)},setSelected:function(t){t!==this._isSelected&&(this._isSelected=t,this._frontCrossRenderer.setVisible(this._isSelected))},getSelectedState:function(){return this.isSelected()},isSelected:function(){return this._isSelected},_selectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_SELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_SELECTED))},_unSelectedEvent:function(){this._checkBoxEventSelector&&(this._checkBoxEventListener?this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_UNSELECTED):this._checkBoxEventSelector(this,ccui.CheckBox.EVENT_UNSELECTED))},_releaseUpEvent:function(){ccui.Widget.prototype._releaseUpEvent.call(this),this._isSelected?(this.setSelected(!1),this._unSelectedEvent()):(this.setSelected(!0),this._selectedEvent())},addEventListenerCheckBox:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._checkBoxEventSelector=t,this._checkBoxEventListener=e},getVirtualRendererSize:function(){return this._backGroundBoxRenderer.getContentSize()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._backGroundBoxRendererAdaptDirty=!0,this._backGroundSelectedBoxRendererAdaptDirty=!0,this._frontCrossRendererAdaptDirty=!0,this._backGroundBoxDisabledRendererAdaptDirty=!0,this._frontCrossDisabledRendererAdaptDirty=!0},getVirtualRenderer:function(){return this._backGroundBoxRenderer},_backGroundTextureScaleChangedWithSize:function(){var t=this._backGroundBoxRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1),this._backgroundTextureScaleX=this._backgroundTextureScaleY=1;else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return t.setScale(1),void(this._backgroundTextureScaleX=this._backgroundTextureScaleY=1);var n=e.width/i.width,r=e.height/i.height;this._backgroundTextureScaleX=n,this._backgroundTextureScaleY=r,t.setScaleX(n),t.setScaleY(r)}t.setPosition(.5*e.width,.5*e.height)},_backGroundSelectedTextureScaleChangedWithSize:function(){var t=this._backGroundSelectedBoxRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.width/i.width,r=e.height/i.height;t.setScaleX(n),t.setScaleY(r)}t.setPosition(.5*e.width,.5*e.height)},_frontCrossTextureScaleChangedWithSize:function(){var t=this._frontCrossRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.width/i.width,r=e.height/i.height;t.setScaleX(n),t.setScaleY(r)}t.setPosition(.5*e.width,.5*e.height)},_backGroundDisabledTextureScaleChangedWithSize:function(){var t=this._backGroundBoxDisabledRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.width/i.width,r=e.height/i.height;t.setScaleX(n),t.setScaleY(r)}t.setPosition(.5*e.width,.5*e.height)},_frontCrossDisabledTextureScaleChangedWithSize:function(){var t=this._frontCrossDisabledRenderer,e=this._contentSize;if(this._ignoreSize)t.setScale(1);else{var i=t.getContentSize();if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.width/i.width,r=e.height/i.height;t.setScaleX(n),t.setScaleY(r)}t.setPosition(.5*e.width,.5*e.height)},getDescription:function(){return"CheckBox"},_createCloneInstance:function(){return new ccui.CheckBox},_copySpecialProperties:function(t){t instanceof ccui.CheckBox&&(this.loadTextureBackGround(t._backGroundFileName,t._backGroundTexType),this.loadTextureBackGroundSelected(t._backGroundSelectedFileName,t._backGroundSelectedTexType),this.loadTextureFrontCross(t._frontCrossFileName,t._frontCrossTexType),this.loadTextureBackGroundDisabled(t._backGroundDisabledFileName,t._backGroundDisabledTexType),this.loadTextureFrontCrossDisabled(t._frontCrossDisabledFileName,t._frontCrossDisabledTexType),this.setSelected(t._isSelected),this._checkBoxEventListener=t._checkBoxEventListener,this._checkBoxEventSelector=t._checkBoxEventSelector,this._ccEventCallback=t._ccEventCallback,this._zoomScale=t._zoomScale,this._backgroundTextureScaleX=t._backgroundTextureScaleX,this._backgroundTextureScaleY=t._backgroundTextureScaleY)},_adaptRenderers:function(){this._backGroundBoxRendererAdaptDirty&&(this._backGroundTextureScaleChangedWithSize(),this._backGroundBoxRendererAdaptDirty=!1),this._backGroundSelectedBoxRendererAdaptDirty&&(this._backGroundSelectedTextureScaleChangedWithSize(),this._backGroundSelectedBoxRendererAdaptDirty=!1),this._frontCrossRendererAdaptDirty&&(this._frontCrossTextureScaleChangedWithSize(),this._frontCrossRendererAdaptDirty=!1),this._backGroundBoxDisabledRendererAdaptDirty&&(this._backGroundDisabledTextureScaleChangedWithSize(),this._backGroundBoxDisabledRendererAdaptDirty=!1),this._frontCrossDisabledRendererAdaptDirty&&(this._frontCrossDisabledTextureScaleChangedWithSize(),this._frontCrossDisabledRendererAdaptDirty=!1)}});var _p=ccui.CheckBox.prototype;_p.selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p=null,ccui.CheckBox.create=function(t,e,i,n,r,o){return new ccui.CheckBox(t,e,i,n,r,o)},ccui.CheckBox.EVENT_SELECTED=0,ccui.CheckBox.EVENT_UNSELECTED=1,ccui.CheckBox.BOX_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER=-1,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER=-1,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER=-1,ccui.ImageView=ccui.Widget.extend({_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_imageRenderer:null,_textureFile:"",_imageTexType:ccui.Widget.LOCAL_TEXTURE,_imageTextureSize:null,_className:"ImageView",_imageRendererAdaptDirty:!0,ctor:function(t,e){this._capInsets=cc.rect(0,0,0,0),this._imageTextureSize=cc.size(this._capInsets.width,this._capInsets.height),ccui.Widget.prototype.ctor.call(this),e=void 0===e?0:e,t?this.loadTexture(t,e):this._imageTexType=ccui.Widget.LOCAL_TEXTURE},_initRenderer:function(){this._imageRenderer=new cc.Sprite,this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1)},loadTexture:function(t,e){if(t){var i=this;e=e||ccui.Widget.LOCAL_TEXTURE,this._textureFile=t,this._imageTexType=e;var n=i._imageRenderer;switch(n._textureLoaded||n.addEventListener("load",function(){i.loadTexture(i._textureFile,i._imageTexType)}),i._imageTexType){case ccui.Widget.LOCAL_TEXTURE:i._scale9Enabled?(n.initWithFile(t),n.setCapInsets(i._capInsets)):n.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i._scale9Enabled?(n.initWithSpriteFrameName(t),n.setCapInsets(i._capInsets)):n.initWithSpriteFrameName(t)}i._imageTextureSize=n.getContentSize(),this._updateChildrenDisplayedRGBA(),i._updateContentSizeWithTextureSize(i._imageTextureSize),i._imageRendererAdaptDirty=!0,i._findLayout()}},setTextureRect:function(t){this._scale9Enabled||this._imageRenderer.setTextureRect(t)},setScale9Enabled:function(t){if(this._scale9Enabled!==t){if(this._scale9Enabled=t,this.removeProtectedChild(this._imageRenderer),this._imageRenderer=null,this._scale9Enabled?this._imageRenderer=new ccui.Scale9Sprite:this._imageRenderer=new cc.Sprite,this.loadTexture(this._textureFile,this._imageTexType),this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1),this._scale9Enabled){var e=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=e}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsets(this._capInsets),this._imageRendererAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){(!this._scale9Enabled||this._scale9Enabled&&!t)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},setCapInsets:function(t){if(t){var e=this._capInsets;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled&&this._imageRenderer.setCapInsets(t)}},getCapInsets:function(){return cc.rect(this._capInsets)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._imageRendererAdaptDirty=!0},_adaptRenderers:function(){this._imageRendererAdaptDirty&&(this._imageTextureScaleChangedWithSize(),this._imageRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return cc.size(this._imageTextureSize)},getVirtualRenderer:function(){return this._imageRenderer},_imageTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||this._imageRenderer.setScale(1);else if(this._scale9Enabled)this._imageRenderer.setPreferredSize(this._contentSize),this._imageRenderer.setScale(1);else{var t=this._imageTextureSize;if(t.width<=0||t.height<=0)return void this._imageRenderer.setScale(1);this._imageRenderer.setScaleX(this._contentSize.width/t.width),this._imageRenderer.setScaleY(this._contentSize.height/t.height)}this._imageRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"ImageView"},_createCloneInstance:function(){return new ccui.ImageView},_copySpecialProperties:function(t){t instanceof ccui.ImageView&&(this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadTexture(t._textureFile,t._imageTexType),this.setCapInsets(t._capInsets))},setContentSize:function(t,e){if(null!=e&&(t=cc.size(t,e)),ccui.Widget.prototype.setContentSize.call(this,t),this._scale9Enabled)this._imageRenderer.setContentSize(t);else{var i=this._imageRenderer.getContentSize();this._imageRenderer.setScaleX(t.width/i.width),this._imageRenderer.setScaleY(t.height/i.height)}}}),ccui.ImageView.create=function(t,e){return new ccui.ImageView(t,e)},ccui.ImageView.RENDERER_ZORDER=-1,ccui.LoadingBar=ccui.Widget.extend({_direction:null,_percent:100,_totalLength:0,_barRenderer:null,_renderBarTexType:ccui.Widget.LOCAL_TEXTURE,_barRendererTextureSize:null,_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_textureFile:"",_isTextureLoaded:!1,_className:"LoadingBar",_barRendererAdaptDirty:!0,ctor:function(t,e){this._direction=ccui.LoadingBar.TYPE_LEFT,this._barRendererTextureSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),void 0!==t&&this.loadTexture(t),void 0!==e&&this.setPercent(e)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._barRenderer.setAnchorPoint(0,.5)},setDirection:function(t){if(this._direction!==t)switch(this._direction=t,this._direction){case ccui.LoadingBar.TYPE_LEFT:this._barRenderer.setAnchorPoint(0,.5),this._barRenderer.setPosition(0,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:this._barRenderer.setAnchorPoint(1,.5),this._barRenderer.setPosition(this._totalLength,.5*this._contentSize.height),this._scale9Enabled||this._barRenderer.setFlippedX(!0)}},getDirection:function(){return this._direction},loadTexture:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._renderBarTexType=e,this._textureFile=t;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadTexture(n._textureFile,n._renderBarTexType),n._setPercent(n._percent)}),this._renderBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}var r=i.getContentSize();switch(this._barRendererTextureSize.width=r.width,this._barRendererTextureSize.height=r.height,this._direction){case ccui.LoadingBar.TYPE_LEFT:i.setAnchorPoint(0,.5),this._scale9Enabled||i.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:i.setAnchorPoint(1,.5),this._scale9Enabled||i.setFlippedX(!0)}this._scale9Enabled&&i.setCapInsets(this._capInsets),this._updateChildrenDisplayedRGBA(),this._barRendererScaleChangedWithSize(),this._updateContentSizeWithTextureSize(this._barRendererTextureSize),this._barRendererAdaptDirty=!0,this._findLayout()}},setScale9Enabled:function(t){if(this._scale9Enabled!==t){if(this._scale9Enabled=t,this.removeProtectedChild(this._barRenderer),this._barRenderer=this._scale9Enabled?new ccui.Scale9Sprite:new cc.Sprite,this.loadTexture(this._textureFile,this._renderBarTexType),this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._scale9Enabled){var e=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=e}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsets(this._capInsets),this.setPercent(this._percent),this._barRendererAdaptDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},setCapInsets:function(t){if(t){var e=this._capInsets;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled&&this._barRenderer.setCapInsets(t)}},getCapInsets:function(){return cc.rect(this._capInsets)},setPercent:function(t){t>100&&(t=100),t<0&&(t=0),t!==this._percent&&(this._percent=t,this._setPercent(t))},_setPercent:function(){var t,e,i,n;this._totalLength<=0||(t=this._percent/100,this._scale9Enabled?this._setScale9Scale():(i=this._barRenderer,n=this._barRendererTextureSize,e=i.getTextureRect(),e.width=n.width*t,i.setTextureRect(cc.rect(e.x,e.y,n.width*t,n.height),i._rectRotated)))},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),this._totalLength=void 0===e?t.width:t},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1)},ignoreContentAdaptWithSize:function(t){(!this._scale9Enabled||this._scale9Enabled&&!t)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},getVirtualRendererSize:function(){return cc.size(this._barRendererTextureSize)},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){var t=this._barRenderer,e=this._contentSize;if(this._unifySize)this._totalLength=this._contentSize.width,this.setPercent(this._percent);else if(this._ignoreSize)this._scale9Enabled||(this._totalLength=this._barRendererTextureSize.width,t.setScale(1));else if(this._totalLength=e.width,this._scale9Enabled)this._setScale9Scale(),t.setScale(1);else{var i=this._barRendererTextureSize;if(i.width<=0||i.height<=0)return void t.setScale(1);var n=e.width/i.width,r=e.height/i.height;t.setScaleX(n),t.setScaleY(r)}switch(this._direction){case ccui.LoadingBar.TYPE_LEFT:t.setPosition(0,.5*e.height);break;case ccui.LoadingBar.TYPE_RIGHT:t.setPosition(this._totalLength,.5*e.height)}},_setScale9Scale:function(){var t=this._percent/100*this._totalLength;this._barRenderer.setPreferredSize(cc.size(t,this._contentSize.height))},getDescription:function(){return"LoadingBar"},_createCloneInstance:function(){return new ccui.LoadingBar},_copySpecialProperties:function(t){t instanceof ccui.LoadingBar&&(this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadTexture(t._textureFile,t._renderBarTexType),this.setCapInsets(t._capInsets),this.setPercent(t._percent),this.setDirection(t._direction))}});var _p=ccui.LoadingBar.prototype;_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.percent,cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.LoadingBar.create=function(t,e){return new ccui.LoadingBar(t,e)},ccui.LoadingBar.TYPE_LEFT=0,ccui.LoadingBar.TYPE_RIGHT=1,ccui.LoadingBar.RENDERER_ZORDER=-1,ccui.Slider=ccui.Widget.extend({_barRenderer:null,_progressBarRenderer:null,_barTextureSize:null,_progressBarTextureSize:null,_slidBallNormalRenderer:null,_slidBallPressedRenderer:null,_slidBallDisabledRenderer:null,_slidBallRenderer:null,_barLength:0,_percent:0,_scale9Enabled:!1,_prevIgnoreSize:!0,_textureFile:"",_progressBarTextureFile:"",_slidBallNormalTextureFile:"",_slidBallPressedTextureFile:"",_slidBallDisabledTextureFile:"",_capInsetsBarRenderer:null,_capInsetsProgressBarRenderer:null,_sliderEventListener:null,_sliderEventSelector:null,_barTexType:ccui.Widget.LOCAL_TEXTURE,_progressBarTexType:ccui.Widget.LOCAL_TEXTURE,_ballNTexType:ccui.Widget.LOCAL_TEXTURE,_ballPTexType:ccui.Widget.LOCAL_TEXTURE,_ballDTexType:ccui.Widget.LOCAL_TEXTURE,_isTextureLoaded:!1,_className:"Slider",_barRendererAdaptDirty:!0,_progressBarRendererDirty:!0,_unifySize:!1,_zoomScale:.1,_sliderBallNormalTextureScaleX:1,_sliderBallNormalTextureScaleY:1,ctor:function(t,e,i){this._barTextureSize=cc.size(0,0),this._progressBarTextureSize=cc.size(0,0),this._capInsetsBarRenderer=cc.rect(0,0,0,0),this._capInsetsProgressBarRenderer=cc.rect(0,0,0,0),ccui.Widget.prototype.ctor.call(this),i=i||0,this.setTouchEnabled(!0),t&&this.loadBarTexture(t,i),e&&this.loadSlidBallTextures(e,i)},_initRenderer:function(){this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite,this._progressBarRenderer.setAnchorPoint(0,.5),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._slidBallNormalRenderer=new cc.Sprite,this._slidBallPressedRenderer=new cc.Sprite,this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer=new cc.Sprite,this._slidBallDisabledRenderer.setVisible(!1),this._slidBallRenderer=new cc.Node,this._slidBallRenderer.addChild(this._slidBallNormalRenderer),this._slidBallRenderer.addChild(this._slidBallPressedRenderer),this._slidBallRenderer.addChild(this._slidBallDisabledRenderer),this._slidBallRenderer.setCascadeColorEnabled(!0),this._slidBallRenderer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._slidBallRenderer,ccui.Slider.BALL_RENDERER_ZORDER,-1)},loadBarTexture:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._textureFile=t,this._barTexType=e;var i=this._barRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadBarTexture(n._textureFile,n._barTexType)}),this._barTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0,this._updateContentSizeWithTextureSize(this._barRenderer.getContentSize()),this._findLayout(),this._barTextureSize=this._barRenderer.getContentSize()}},loadProgressBarTexture:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._progressBarTextureFile=t,this._progressBarTexType=e;var i=this._progressBarRenderer,n=this;switch(i._textureLoaded||i.addEventListener("load",function(){n.loadProgressBarTexture(n._progressBarTextureFile,n._progressBarTexType)}),this._progressBarTexType){case ccui.Widget.LOCAL_TEXTURE:i.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:i.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._progressBarRenderer.setAnchorPoint(cc.p(0,.5));var r=this._progressBarRenderer.getContentSize();this._progressBarTextureSize={width:r.width,height:r.height},this._progressBarRendererDirty=!0,this._findLayout()}},setScale9Enabled:function(t){if(this._scale9Enabled!==t){if(this._scale9Enabled=t,this.removeProtectedChild(this._barRenderer,!0),this.removeProtectedChild(this._progressBarRenderer,!0),this._barRenderer=null,this._progressBarRenderer=null,this._scale9Enabled?(this._barRenderer=new ccui.Scale9Sprite,this._progressBarRenderer=new ccui.Scale9Sprite):(this._barRenderer=new cc.Sprite,this._progressBarRenderer=new cc.Sprite),this.loadBarTexture(this._textureFile,this._barTexType),this.loadProgressBarTexture(this._progressBarTextureFile,this._progressBarTexType),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._scale9Enabled){var e=this._ignoreSize;this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=e}else this.ignoreContentAdaptWithSize(this._prevIgnoreSize);this.setCapInsetsBarRenderer(this._capInsetsBarRenderer),this.setCapInsetProgressBarRenderer(this._capInsetsProgressBarRenderer),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0}},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(t){(!this._scale9Enabled||this._scale9Enabled&&!t)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t),this._prevIgnoreSize=t)},setCapInsets:function(t){this.setCapInsetsBarRenderer(t),this.setCapInsetProgressBarRenderer(t)},setCapInsetsBarRenderer:function(t){if(t){var e=this._capInsetsBarRenderer;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled&&this._barRenderer.setCapInsets(t)}},getCapInsetsBarRenderer:function(){return cc.rect(this._capInsetsBarRenderer)},setCapInsetProgressBarRenderer:function(t){if(t){var e=this._capInsetsProgressBarRenderer;e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,this._scale9Enabled&&this._progressBarRenderer.setCapInsets(t)}},getCapInsetsProgressBarRenderer:function(){return cc.rect(this._capInsetsProgressBarRenderer)},loadSlidBallTextures:function(t,e,i,n){this.loadSlidBallTextureNormal(t,n),this.loadSlidBallTexturePressed(e,n),this.loadSlidBallTextureDisabled(i,n)},loadSlidBallTextureNormal:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallNormalTextureFile=t,this._ballNTexType=e;var i=this;switch(this._slidBallNormalRenderer._textureLoaded||this._slidBallNormalRenderer.addEventListener("load",function(){i.loadSlidBallTextureNormal(i._slidBallNormalTextureFile,i._ballNTexType)}),this._ballNTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallNormalRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallNormalRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTexturePressed:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallPressedTextureFile=t,this._ballPTexType=e;var i=this;switch(this._slidBallPressedRenderer._textureLoaded||this._slidBallPressedRenderer.addEventListener("load",function(){i.loadSlidBallTexturePressed(i._slidBallPressedTextureFile,i._ballPTexType)}),this._ballPTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallPressedRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallPressedRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},loadSlidBallTextureDisabled:function(t,e){if(t){e=e||ccui.Widget.LOCAL_TEXTURE,this._slidBallDisabledTextureFile=t,this._ballDTexType=e;var i=this;switch(this._slidBallDisabledRenderer._textureLoaded||this._slidBallDisabledRenderer.addEventListener("load",function(){i.loadSlidBallTextureDisabled(i._slidBallDisabledTextureFile,i._ballDTexType)}),this._ballDTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallDisabledRenderer.initWithFile(t);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallDisabledRenderer.initWithSpriteFrameName(t)}this._updateChildrenDisplayedRGBA(),this._findLayout()}},setPercent:function(t){t>100&&(t=100),t<0&&(t=0),this._percent=t;var e=t/100,i=this._barLength*e;if(this._slidBallRenderer.setPosition(i,this._contentSize.height/2),this._scale9Enabled)this._progressBarRenderer.setPreferredSize(cc.size(i,this._contentSize.height));else{var n=this._progressBarRenderer,r=n.getTextureRect();n.setTextureRect(cc.rect(r.x,r.y,i/n._scaleX,r.height),n.isTextureRectRotated())}},hitTest:function(t){var e=this._slidBallNormalRenderer.convertToNodeSpace(t),i=this._slidBallNormalRenderer.getContentSize(),n=cc.rect(0,0,i.width,i.height);return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height},onTouchBegan:function(t,e){var i=ccui.Widget.prototype.onTouchBegan.call(this,t,e);if(this._hit){var n=this.convertToNodeSpace(this._touchBeganPosition);this.setPercent(this._getPercentWithBallPos(n.x)),this._percentChangedEvent()}return i},onTouchMoved:function(t,e){var i=t.getLocation(),n=this.convertToNodeSpace(i);this.setPercent(this._getPercentWithBallPos(n.x)),this._percentChangedEvent()},onTouchEnded:function(t,e){ccui.Widget.prototype.onTouchEnded.call(this,t,e)},onTouchCancelled:function(t,e){ccui.Widget.prototype.onTouchCancelled.call(this,t,e)},_getPercentWithBallPos:function(t){return t/this._barLength*100},addEventListenerSlider:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._sliderEventSelector=t,this._sliderEventListener=e},_percentChangedEvent:function(){this._sliderEventSelector&&(this._sliderEventListener?this._sliderEventSelector.call(this._sliderEventListener,this,ccui.Slider.EVENT_PERCENT_CHANGED):this._sliderEventSelector(this,ccui.Slider.EVENT_PERCENT_CHANGED)),this._ccEventCallback&&this._ccEventCallback(this,ccui.Slider.EVENT_PERCENT_CHANGED)},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._barRendererAdaptDirty=!0,this._progressBarRendererDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1),this._progressBarRendererDirty&&(this._progressBarRendererScaleChangedWithSize(),this._progressBarRendererDirty=!1)},getVirtualRendererSize:function(){return this._barRenderer.getContentSize()},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){if(this._unifySize)this._barLength=this._contentSize.width,this._barRenderer.setPreferredSize(this._contentSize);else if(this._ignoreSize)this._barRenderer.setScale(1),this._barLength=this._contentSize.width;else if(this._barLength=this._contentSize.width,this._scale9Enabled)this._barRenderer.setPreferredSize(this._contentSize),this._barRenderer.setScale(1);else{var t=this._barTextureSize;if(t.width<=0||t.height<=0)this._barRenderer.setScale(1);else{var e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._barRenderer.setScaleX(e),this._barRenderer.setScaleY(i)}}this._barRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2),this.setPercent(this._percent)},_progressBarRendererScaleChangedWithSize:function(){if(this._unifySize)this._progressBarRenderer.setPreferredSize(this._contentSize);else if(this._ignoreSize){if(!this._scale9Enabled){var t=this._progressBarTextureSize,e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._progressBarRenderer.setScaleX(e),this._progressBarRenderer.setScaleY(i)}}else if(this._scale9Enabled)this._progressBarRenderer.setPreferredSize(this._contentSize),this._progressBarRenderer.setScale(1);else{var t=this._progressBarTextureSize;if(t.width<=0||t.height<=0)return void this._progressBarRenderer.setScale(1);var e=this._contentSize.width/t.width,i=this._contentSize.height/t.height;this._progressBarRenderer.setScaleX(e),this._progressBarRenderer.setScaleY(i)}this._progressBarRenderer.setPosition(0,this._contentSize.height/2),this.setPercent(this._percent)},_onPressStateChangedToNormal:function(){this._slidBallNormalRenderer.setVisible(!0),this._slidBallPressedRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!1),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY)},_onPressStateChangedToPressed:function(){this._slidBallPressedTextureFile?(this._slidBallNormalRenderer.setVisible(!1),this._slidBallPressedRenderer.setVisible(!0),this._slidBallDisabledRenderer.setVisible(!1)):this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX+this._zoomScale,this._sliderBallNormalTextureScaleY+this._zoomScale)},_onPressStateChangedToDisabled:function(){this._slidBallDisabledTextureFile&&(this._slidBallNormalRenderer.setVisible(!1),this._slidBallDisabledRenderer.setVisible(!0)),this._slidBallNormalRenderer.setScale(this._sliderBallNormalTextureScaleX,this._sliderBallNormalTextureScaleY),this._slidBallPressedRenderer.setVisible(!1)},setZoomScale:function(t){this._zoomScale=t},getZoomScale:function(){return this._zoomScale},getDescription:function(){return"Slider"},_createCloneInstance:function(){return new ccui.Slider},_copySpecialProperties:function(t){this._prevIgnoreSize=t._prevIgnoreSize,this.setScale9Enabled(t._scale9Enabled),this.loadBarTexture(t._textureFile,t._barTexType),this.loadProgressBarTexture(t._progressBarTextureFile,t._progressBarTexType),this.loadSlidBallTextureNormal(t._slidBallNormalTextureFile,t._ballNTexType),this.loadSlidBallTexturePressed(t._slidBallPressedTextureFile,t._ballPTexType),this.loadSlidBallTextureDisabled(t._slidBallDisabledTextureFile,t._ballDTexType),this.setPercent(t.getPercent()),this._sliderEventListener=t._sliderEventListener,this._sliderEventSelector=t._sliderEventSelector,this._zoomScale=t._zoomScale,this._ccEventCallback=t._ccEventCallback}});var _p=ccui.Slider.prototype;_p.percent,cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent),_p=null,ccui.Slider.create=function(t,e,i){return new ccui.Slider(t,e,i)},ccui.Slider.EVENT_PERCENT_CHANGED=0,ccui.Slider.BASEBAR_RENDERER_ZORDER=-3,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER=-2,ccui.Slider.BALL_RENDERER_ZORDER=-1,ccui.Text=ccui.Widget.extend({_touchScaleChangeEnabled:!1,_normalScaleValueX:1,_normalScaleValueY:1,_fontName:"Arial",_fontSize:16,_onSelectedScaleOffset:.5,_labelRenderer:null,_textAreaSize:null,_textVerticalAlignment:0,_textHorizontalAlignment:0,_className:"Text",_type:null,_labelRendererAdaptDirty:!0,ctor:function(t,e,i){this._type=ccui.Text.Type.SYSTEM,this._textAreaSize=cc.size(0,0),ccui.Widget.prototype.ctor.call(this),void 0!==i?(this.setFontName(e),this.setFontSize(i),this.setString(t)):this.setFontName(this._fontName)},_initRenderer:function(){this._labelRenderer=new cc.LabelTTF,this.addProtectedChild(this._labelRenderer,ccui.Text.RENDERER_ZORDER,-1)},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){t!==this._labelRenderer.getString()&&(this._labelRenderer.setString(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0)},getStringValue:function(){return cc.log("Please use the getString"),this._labelRenderer.getString()},getString:function(){return this._labelRenderer.getString()},getStringLength:function(){return this._labelRenderer.getStringLength()},setFontSize:function(t){this._labelRenderer.setFontSize(t),this._fontSize=t,this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getFontSize:function(){return this._fontSize},setFontName:function(t){this._fontName=t,this._labelRenderer.setFontName(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getFontName:function(){return this._fontName},_setFont:function(t){var e=cc.LabelTTF._fontStyleRE.exec(t);e&&(this._fontSize=parseInt(e[1]),this._fontName=e[2],this._labelRenderer._setFont(t),this._labelScaleChangedWithSize())},_getFont:function(){return this._labelRenderer._getFont()},getType:function(){return this._type},setTextAreaSize:function(t){this._labelRenderer.setDimensions(t),this._ignoreSize||(this._customSize=t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextAreaSize:function(){return this._labelRenderer.getDimensions()},setTextHorizontalAlignment:function(t){this._labelRenderer.setHorizontalAlignment(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextHorizontalAlignment:function(){return this._labelRenderer.getHorizontalAlignment()},setTextVerticalAlignment:function(t){this._labelRenderer.setVerticalAlignment(t),this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize()),this._labelRendererAdaptDirty=!0},getTextVerticalAlignment:function(){return this._labelRenderer.getVerticalAlignment()},setTouchScaleChangeEnabled:function(t){this._touchScaleChangeEnabled=t},isTouchScaleChangeEnabled:function(){return this._touchScaleChangeEnabled},_onPressStateChangedToNormal:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX),this._labelRenderer.setScaleY(this._normalScaleValueY))},_onPressStateChangedToPressed:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX+this._onSelectedScaleOffset),this._labelRenderer.setScaleY(this._normalScaleValueY+this._onSelectedScaleOffset))},_onPressStateChangedToDisabled:function(){},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelRendererAdaptDirty&&(this._labelScaleChangedWithSize(),this._labelRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelRenderer},getAutoRenderSize:function(){var t=this._labelRenderer.getContentSize();return this._ignoreSize||(this._labelRenderer.setDimensions(0,0),t=this._labelRenderer.getContentSize(),this._labelRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),t},_labelScaleChangedWithSize:function(){var t=this._contentSize;if(this._ignoreSize)this._labelRenderer.setDimensions(0,0),this._labelRenderer.setScale(1),this._normalScaleValueX=this._normalScaleValueY=1;else{this._labelRenderer.setDimensions(cc.size(t.width,t.height));var e=this._labelRenderer.getContentSize();if(e.width<=0||e.height<=0)return void this._labelRenderer.setScale(1);var i=t.width/e.width,n=t.height/e.height;this._labelRenderer.setScaleX(i),this._labelRenderer.setScaleY(n),this._normalScaleValueX=i,this._normalScaleValueY=n}this._labelRenderer.setPosition(t.width/2,t.height/2)},getDescription:function(){return"Label"},enableShadow:function(t,e,i){this._labelRenderer.enableShadow(t,e,i)},enableOutline:function(t,e){this._labelRenderer.enableStroke(t,e)},enableGlow:function(t){this._type===ccui.Text.Type.TTF&&this._labelRenderer.enableGlow(t)},disableEffect:function(){this._labelRenderer.disableEffect&&this._labelRenderer.disableEffect()},_createCloneInstance:function(){return new ccui.Text},_copySpecialProperties:function(t){t instanceof ccui.Text&&(this.setFontName(t._fontName),this.setFontSize(t.getFontSize()),this.setString(t.getString()),this.setTouchScaleChangeEnabled(t.touchScaleEnabled),this.setTextAreaSize(t._textAreaSize),this.setTextHorizontalAlignment(t._labelRenderer.getHorizontalAlignment()),this.setTextVerticalAlignment(t._labelRenderer.getVerticalAlignment()),this.setContentSize(t.getContentSize()),this.setTextColor(t.getTextColor()))},_setBoundingWidth:function(t){this._textAreaSize.width=t,this._labelRenderer._setBoundingWidth(t),this._labelScaleChangedWithSize()},_setBoundingHeight:function(t){this._textAreaSize.height=t,this._labelRenderer._setBoundingHeight(t),this._labelScaleChangedWithSize()},_getBoundingWidth:function(){return this._textAreaSize.width},_getBoundingHeight:function(){return this._textAreaSize.height},_changePosition:function(){this._adaptRenderers()},setColor:function(t){cc.ProtectedNode.prototype.setColor.call(this,t),this._labelRenderer.setColor(t)},setTextColor:function(t){this._labelRenderer.setFontFillColor(t)},getTextColor:function(){return this._labelRenderer._getFillStyle()}});var _p=ccui.Text.prototype;_p.boundingWidth,cc.defineGetterSetter(_p,"boundingWidth",_p._getBoundingWidth,_p._setBoundingWidth),_p.boundingHeight,cc.defineGetterSetter(_p,"boundingHeight",_p._getBoundingHeight,_p._setBoundingHeight),_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.stringLength,cc.defineGetterSetter(_p,"stringLength",_p.getStringLength),_p.font,cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),_p.textAlign,cc.defineGetterSetter(_p,"textAlign",_p.getTextHorizontalAlignment,_p.setTextHorizontalAlignment),_p.verticalAlign,cc.defineGetterSetter(_p,"verticalAlign",_p.getTextVerticalAlignment,_p.setTextVerticalAlignment),_p=null,ccui.Label=ccui.Text.create=function(t,e,i){return new ccui.Text(t,e,i)},ccui.Text.RENDERER_ZORDER=-1,ccui.Text.Type={SYSTEM:0,TTF:1},ccui.TextAtlas=ccui.Widget.extend({_labelAtlasRenderer:null,_stringValue:"",_charMapFileName:"",_itemWidth:0,_itemHeight:0,_startCharMap:"",_className:"TextAtlas",_labelAtlasRendererAdaptDirty:null,ctor:function(t,e,i,n,r){ccui.Widget.prototype.ctor.call(this),void 0!==r&&this.setProperty(t,e,i,n,r)},_initRenderer:function(){this._labelAtlasRenderer=new cc.LabelAtlas,this._labelAtlasRenderer.setAnchorPoint(cc.p(.5,.5)),this.addProtectedChild(this._labelAtlasRenderer,ccui.TextAtlas.RENDERER_ZORDER,-1)},setProperty:function(t,e,i,n,r){this._stringValue=t,this._charMapFileName=e,this._itemWidth=i,this._itemHeight=n,this._startCharMap=r,this._labelAtlasRenderer.initWithString(t,this._charMapFileName,this._itemWidth,this._itemHeight,this._startCharMap[0]),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0},setString:function(t){t!==this._labelAtlasRenderer.getString()&&(this._stringValue=t,this._labelAtlasRenderer.setString(t),this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize()),this._labelAtlasRendererAdaptDirty=!0)},setStringValue:function(t){cc.log("Please use the setString"),this.setString(t)},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._labelAtlasRenderer.getString()},getStringLength:function(){return this._labelAtlasRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelAtlasRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelAtlasRendererAdaptDirty&&(this._labelAtlasScaleChangedWithSize(),this._labelAtlasRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelAtlasRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelAtlasRenderer},_labelAtlasScaleChangedWithSize:function(){var t=this._labelAtlasRenderer;if(this._ignoreSize)t.setScale(1);else{var e=t.getContentSize();if(e.width<=0||e.height<=0)return void t.setScale(1);t.setScaleX(this._contentSize.width/e.width),t.setScaleY(this._contentSize.height/e.height)}t.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"LabelAtlas"},_copySpecialProperties:function(t){t&&this.setProperty(t._stringValue,t._charMapFileName,t._itemWidth,t._itemHeight,t._startCharMap)},_createCloneInstance:function(){return new ccui.TextAtlas}});var _p=ccui.TextAtlas.prototype;_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextAtlas.create=function(t,e,i,n,r){return new ccui.TextAtlas(t,e,i,n,r)},ccui.TextAtlas.RENDERER_ZORDER=-1,ccui.LabelBMFont=ccui.TextBMFont=ccui.Widget.extend({_labelBMFontRenderer:null,_fntFileHasInit:!1,_fntFileName:"",_stringValue:"",_className:"TextBMFont",_labelBMFontRendererAdaptDirty:!0,ctor:function(t,e){ccui.Widget.prototype.ctor.call(this),void 0!==e&&(this.setFntFile(e),this.setString(t))},_initRenderer:function(){this._labelBMFontRenderer=new cc.LabelBMFont,this.addProtectedChild(this._labelBMFontRenderer,ccui.TextBMFont.RENDERER_ZORDER,-1)},setFntFile:function(t){if(t){this._fntFileName=t,this._fntFileHasInit=!0,this._labelBMFontRenderer.initWithString(this._stringValue,t),this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0;var e=this,i=e._labelBMFontRenderer;i._textureLoaded||i.addEventListener("load",function(){e.setFntFile(e._fntFileName);for(var t=e.parent;t;){if(t.requestDoLayout){t.requestDoLayout();break}t=t.parent}})}},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){t!==this._labelBMFontRenderer.getString()&&(this._stringValue=t,this._labelBMFontRenderer.setString(t),this._fntFileHasInit&&(this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0))},getString:function(){return this._stringValue},getStringLength:function(){return this._labelBMFontRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._labelBMFontRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelBMFontRendererAdaptDirty&&(this._labelBMFontScaleChangedWithSize(),this._labelBMFontRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelBMFontRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelBMFontRenderer},_labelBMFontScaleChangedWithSize:function(){var t=this._labelBMFontRenderer;if(this._ignoreSize)t.setScale(1);else{var e=t.getContentSize();if(e.width<=0||e.height<=0)return void t.setScale(1);t.setScaleX(this._contentSize.width/e.width),t.setScaleY(this._contentSize.height/e.height)}t.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"TextBMFont"},_createCloneInstance:function(){return new ccui.TextBMFont},_copySpecialProperties:function(t){this.setFntFile(t._fntFileName),this.setString(t._stringValue)}});var _p=ccui.TextBMFont.prototype;_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p=null,ccui.TextBMFont.create=function(t,e){return new ccui.TextBMFont(t,e)},ccui.TextBMFont.RENDERER_ZORDER=-1,ccui._TextFieldRenderer=cc.TextFieldTTF.extend({_maxLengthEnabled:!1,_maxLength:0,_passwordEnabled:!1,_passwordStyleText:"",_attachWithIME:!1,_detachWithIME:!1,_insertText:!1,_deleteBackward:!1,_className:"_TextFieldRenderer",ctor:function(){cc.TextFieldTTF.prototype.ctor.call(this),this._maxLengthEnabled=!1,this._maxLength=0,this._passwordEnabled=!1,this._passwordStyleText="*",this._attachWithIME=!1,this._detachWithIME=!1,this._insertText=!1,this._deleteBackward=!1},onEnter:function(){cc.TextFieldTTF.prototype.onEnter.call(this),cc.TextFieldTTF.prototype.setDelegate.call(this,this)},onTextFieldAttachWithIME:function(t){return this.setAttachWithIME(!0),!1},onTextFieldInsertText:function(t,e,i){return(1!==i||"\n"!==e)&&(this.setInsertText(!0),this._maxLengthEnabled&&cc.TextFieldTTF.prototype.getCharCount.call(this)>=this._maxLength)},onTextFieldDeleteBackward:function(t,e,i){return this.setDeleteBackward(!0),!1},onTextFieldDetachWithIME:function(t){return this.setDetachWithIME(!0),!1},insertText:function(t,e){var i=t;if("\n"!==t&&this._maxLengthEnabled){var n=this.getString().length;if(n>=this._maxLength)return void(this._passwordEnabled&&this.setPasswordText(this.getString()))}cc.TextFieldTTF.prototype.insertText.call(this,i,e),this._passwordEnabled&&cc.TextFieldTTF.prototype.getCharCount.call(this)>0&&this.setPasswordText(this.getString())},deleteBackward:function(){cc.TextFieldTTF.prototype.deleteBackward.call(this),cc.TextFieldTTF.prototype.getCharCount.call(this)>0&&this._passwordEnabled&&this.setPasswordText(this._inputText)},openIME:function(){cc.TextFieldTTF.prototype.attachWithIME.call(this)},closeIME:function(){cc.TextFieldTTF.prototype.detachWithIME.call(this)},setMaxLengthEnabled:function(t){this._maxLengthEnabled=t},isMaxLengthEnabled:function(){return this._maxLengthEnabled},setMaxLength:function(t){this._maxLength=t},getMaxLength:function(){return this._maxLength},getCharCount:function(){return cc.TextFieldTTF.prototype.getCharCount.call(this)},setPasswordEnabled:function(t){this._passwordEnabled=t},isPasswordEnabled:function(){return this._passwordEnabled},setPasswordStyleText:function(t){if(!(t.length>1)){var e=t.charCodeAt(0);e<33||e>126||(this._passwordStyleText=t)}},setPasswordText:function(t){var e="",i=t.length,n=i;this._maxLengthEnabled&&i>this._maxLength&&(n=this._maxLength);for(var r=0;r<n;++r)e+=this._passwordStyleText;cc.LabelTTF.prototype.setString.call(this,e)},setAttachWithIME:function(t){this._attachWithIME=t},getAttachWithIME:function(){return this._attachWithIME},setDetachWithIME:function(t){this._detachWithIME=t},getDetachWithIME:function(){return this._detachWithIME},setInsertText:function(t){this._insertText=t},getInsertText:function(){return this._insertText},setDeleteBackward:function(t){this._deleteBackward=t},getDeleteBackward:function(){return this._deleteBackward},onDraw:function(t){return!1}}),ccui._TextFieldRenderer.create=function(t,e,i){var n=new ccui._TextFieldRenderer;return n&&n.initWithString("",e,i)?(t&&n.setPlaceHolder(t),n):null},ccui.TextField=ccui.Widget.extend({_textFieldRenderer:null,_touchWidth:0,_touchHeight:0,_useTouchArea:!1,_textFieldEventListener:null,_textFieldEventSelector:null,_passwordStyleText:"",_textFieldRendererAdaptDirty:!0,_fontName:"",_fontSize:12,_ccEventCallback:null,ctor:function(t,e,i){ccui.Widget.prototype.ctor.call(this),this.setTouchEnabled(!0),e&&this.setFontName(e),i&&this.setFontSize(i),t&&this.setPlaceHolder(t)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this),this.scheduleUpdate()},_initRenderer:function(){this._textFieldRenderer=ccui._TextFieldRenderer.create("input words here","Thonburi",20),this.addProtectedChild(this._textFieldRenderer,ccui.TextField.RENDERER_ZORDER,-1)},setTouchSize:function(t){this._touchWidth=t.width,this._touchHeight=t.height},setTouchAreaEnabled:function(t){this._useTouchArea=t},hitTest:function(t){if(this._useTouchArea){var e=this.convertToNodeSpace(t),i=cc.rect(-this._touchWidth*this._anchorPoint.x,-this._touchHeight*this._anchorPoint.y,this._touchWidth,this._touchHeight);return e.x>=i.x&&e.x<=i.x+i.width&&e.y>=i.y&&e.y<=i.y+i.height}return ccui.Widget.prototype.hitTest.call(this,t)},getTouchSize:function(){return cc.size(this._touchWidth,this._touchHeight)},setText:function(t){cc.log("Please use the setString"),this.setString(t)},setString:function(t){null!=t&&(t=String(t),this.isMaxLengthEnabled()&&(t=t.substr(0,this.getMaxLength())),this.isPasswordEnabled()?(this._textFieldRenderer.setPasswordText(t),this._textFieldRenderer.setString(""),this._textFieldRenderer.insertText(t,t.length)):this._textFieldRenderer.setString(t),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))},setPlaceHolder:function(t){this._textFieldRenderer.setPlaceHolder(t),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getPlaceHolder:function(){return this._textFieldRenderer.getPlaceHolder()},getPlaceHolderColor:function(){return this._textFieldRenderer.getPlaceHolderColor()},setPlaceHolderColor:function(t){this._textFieldRenderer.setColorSpaceHolder(t)},setTextColor:function(t){this._textFieldRenderer.setTextColor(t)},setFontSize:function(t){this._textFieldRenderer.setFontSize(t),this._fontSize=t,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontSize:function(){return this._fontSize},setFontName:function(t){this._textFieldRenderer.setFontName(t),this._fontName=t,this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontName:function(){return this._fontName},didNotSelectSelf:function(){this._textFieldRenderer.detachWithIME()},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._textFieldRenderer.getString()},getStringLength:function(){return this._textFieldRenderer.getStringLength()},onTouchBegan:function(t,e){var i=this,n=ccui.Widget.prototype.onTouchBegan.call(i,t,e);return i._hit?setTimeout(function(){i._textFieldRenderer.attachWithIME()},0):setTimeout(function(){i._textFieldRenderer.detachWithIME()},0),n},setMaxLengthEnabled:function(t){this._textFieldRenderer.setMaxLengthEnabled(t)},isMaxLengthEnabled:function(){return this._textFieldRenderer.isMaxLengthEnabled()},setMaxLength:function(t){this._textFieldRenderer.setMaxLength(t),this.setString(this.getString())},getMaxLength:function(){return this._textFieldRenderer.getMaxLength()},setPasswordEnabled:function(t){this._textFieldRenderer.setPasswordEnabled(t)},isPasswordEnabled:function(){return this._textFieldRenderer.isPasswordEnabled()},setPasswordStyleText:function(t){this._textFieldRenderer.setPasswordStyleText(t),this._passwordStyleText=t,this.setString(this.getString())},getPasswordStyleText:function(){return this._passwordStyleText},update:function(t){this.getDetachWithIME()&&(this._detachWithIMEEvent(),this.setDetachWithIME(!1)),this.getAttachWithIME()&&(this._attachWithIMEEvent(),this.setAttachWithIME(!1)),this.getInsertText()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._insertTextEvent(),this.setInsertText(!1)),this.getDeleteBackward()&&(this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()),this._deleteBackwardEvent(),this.setDeleteBackward(!1))},getAttachWithIME:function(){return this._textFieldRenderer.getAttachWithIME()},setAttachWithIME:function(t){this._textFieldRenderer.setAttachWithIME(t)},getDetachWithIME:function(){return this._textFieldRenderer.getDetachWithIME()},setDetachWithIME:function(t){this._textFieldRenderer.setDetachWithIME(t)},getInsertText:function(){return this._textFieldRenderer.getInsertText()},setInsertText:function(t){this._textFieldRenderer.setInsertText(t)},getDeleteBackward:function(){return this._textFieldRenderer.getDeleteBackward()},setDeleteBackward:function(t){this._textFieldRenderer.setDeleteBackward(t)},_attachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_ATTACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_ATTACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_ATTACH_WITH_IME)},_detachWithIMEEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DETACH_WITH_IME):this._textFieldEventSelector(this,ccui.TextField.EVENT_DETACH_WITH_IME)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DETACH_WITH_IME)},_insertTextEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_INSERT_TEXT):this._textFieldEventSelector(this,ccui.TextField.EVENT_INSERT_TEXT)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_INSERT_TEXT)},_deleteBackwardEvent:function(){this._textFieldEventSelector&&(this._textFieldEventListener?this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_DELETE_BACKWARD):this._textFieldEventSelector(this,ccui.TextField.EVENT_DELETE_BACKWARD)),this._ccEventCallback&&this._ccEventCallback(this,ccui.TextField.EVENT_DELETE_BACKWARD)},addEventListenerTextField:function(t,e){this.addEventListener(t,e)},addEventListener:function(t,e){this._textFieldEventSelector=t,this._textFieldEventListener=e},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this),this._textFieldRendererAdaptDirty=!0},_adaptRenderers:function(){this._textFieldRendererAdaptDirty&&(this._textfieldRendererScaleChangedWithSize(),this._textFieldRendererAdaptDirty=!1)},_textfieldRendererScaleChangedWithSize:function(){this._ignoreSize||this._textFieldRenderer.setDimensions(this._contentSize),this._textFieldRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getAutoRenderSize:function(){var t=this._textFieldRenderer.getContentSize();return this._ignoreSize||(this._textFieldRenderer.setDimensions(0,0),t=this._textFieldRenderer.getContentSize(),this._textFieldRenderer.setDimensions(this._contentSize.width,this._contentSize.height)),t},getVirtualRendererSize:function(){return this._textFieldRenderer.getContentSize()},getVirtualRenderer:function(){return this._textFieldRenderer},getDescription:function(){return"TextField"},attachWithIME:function(){this._textFieldRenderer.attachWithIME()},_createCloneInstance:function(){return new ccui.TextField},_copySpecialProperties:function(t){this.setString(t._textFieldRenderer.getString()),this.setPlaceHolder(t.getString()),this.setFontSize(t._textFieldRenderer.getFontSize()),this.setFontName(t._textFieldRenderer.getFontName()),this.setMaxLengthEnabled(t.isMaxLengthEnabled()),this.setMaxLength(t.getMaxLength()),this.setPasswordEnabled(t.isPasswordEnabled()),this.setPasswordStyleText(t._passwordStyleText),this.setAttachWithIME(t.getAttachWithIME()),this.setDetachWithIME(t.getDetachWithIME()),this.setInsertText(t.getInsertText()),this.setDeleteBackward(t.getDeleteBackward()),this._ccEventCallback=t._ccEventCallback,this._textFieldEventListener=t._textFieldEventListener,this._textFieldEventSelector=t._textFieldEventSelector},setTextAreaSize:function(t){this.setContentSize(t)},setTextHorizontalAlignment:function(t){this._textFieldRenderer.setHorizontalAlignment(t)},setTextVerticalAlignment:function(t){this._textFieldRenderer.setVerticalAlignment(t)},_setFont:function(t){this._textFieldRenderer._setFont(t),this._textFieldRendererAdaptDirty=!0},_getFont:function(){return this._textFieldRenderer._getFont()},_changePosition:function(){this._adaptRenderers()}}),ccui.TextField.create=function(t,e,i){return new ccui.TextField(t,e,i)};var _p=ccui.TextField.prototype;_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.placeHolder,cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder),_p.font,cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize),_p.fontName,cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName),_p.maxLengthEnabled,cc.defineGetterSetter(_p,"maxLengthEnabled",_p.isMaxLengthEnabled,_p.setMaxLengthEnabled),_p.maxLength,cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),_p.passwordEnabled,cc.defineGetterSetter(_p,"passwordEnabled",_p.isPasswordEnabled,_p.setPasswordEnabled),_p=null,ccui.TextField.EVENT_ATTACH_WITH_IME=0,ccui.TextField.EVENT_DETACH_WITH_IME=1,ccui.TextField.EVENT_INSERT_TEXT=2,ccui.TextField.EVENT_DELETE_BACKWARD=3,ccui.TextField.RENDERER_ZORDER=-1,ccui.RichElement=ccui.Class.extend({_type:0,_tag:0,_color:null,_opacity:0,ctor:function(t,e,i){this._type=0,this._tag=t||0,this._color=cc.color(255,255,255,255),e&&(this._color.r=e.r,this._color.g=e.g,this._color.b=e.b),this._opacity=i||0,void 0===i?this._color.a=e.a:this._color.a=i}}),ccui.RichElementText=ccui.RichElement.extend({_text:"",_fontName:"",_fontSize:0,_fontDefinition:null,ctor:function(t,e,i,n,r,o){var s=e;e&&e instanceof cc.FontDefinition&&(s=e.fillStyle,r=e.fontName,o=e.fontSize,this._fontDefinition=e),ccui.RichElement.prototype.ctor.call(this,t,s,i),this._type=ccui.RichElement.TEXT,this._text=n,this._fontName=r,this._fontSize=o}}),ccui.RichElementText.create=function(t,e,i,n,r,o){return new ccui.RichElementText(t,e,i,n,r,o)},ccui.RichElementImage=ccui.RichElement.extend({_filePath:"",_textureRect:null,_textureType:0,ctor:function(t,e,i,n){ccui.RichElement.prototype.ctor.call(this,t,e,i),this._type=ccui.RichElement.IMAGE,this._filePath=n||"",this._textureRect=cc.rect(0,0,0,0),this._textureType=0}}),ccui.RichElementImage.create=function(t,e,i,n){return new ccui.RichElementImage(t,e,i,n)},ccui.RichElementCustomNode=ccui.RichElement.extend({_customNode:null,ctor:function(t,e,i,n){ccui.RichElement.prototype.ctor.call(this,t,e,i),this._type=ccui.RichElement.CUSTOM,this._customNode=n||null}}),ccui.RichElementCustomNode.create=function(t,e,i,n){return new ccui.RichElementCustomNode(t,e,i,n)},ccui.RichText=ccui.Widget.extend({_formatTextDirty:!1,_richElements:null,_elementRenders:null,_leftSpaceWidth:0,_verticalSpace:0,_elementRenderersContainer:null,_lineBreakOnSpace:!1,_textHorizontalAlignment:null,_textVerticalAlignment:null,ctor:function(){ccui.Widget.prototype.ctor.call(this),this._formatTextDirty=!1,this._richElements=[],this._elementRenders=[],this._leftSpaceWidth=0,this._verticalSpace=0,this._textHorizontalAlignment=cc.TEXT_ALIGNMENT_LEFT,this._textVerticalAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP},_initRenderer:function(){this._elementRenderersContainer=new cc.Node,this._elementRenderersContainer.setAnchorPoint(.5,.5),this.addProtectedChild(this._elementRenderersContainer,0,-1)},insertElement:function(t,e){this._richElements.splice(e,0,t),this._formatTextDirty=!0},pushBackElement:function(t){this._richElements.push(t),this._formatTextDirty=!0},removeElement:function(t){cc.isNumber(t)?this._richElements.splice(t,1):cc.arrayRemoveObject(this._richElements,t),this._formatTextDirty=!0},formatText:function(){if(this._formatTextDirty){this._elementRenderersContainer.removeAllChildren(),this._elementRenders.length=0;var t,e,i=this._richElements;if(this._ignoreSize)for(this._addNewLine(),t=0;t<i.length;t++){e=i[t];var n=null;switch(e._type){case ccui.RichElement.TEXT:n=e._fontDefinition?new cc.LabelTTF(e._text,e._fontDefinition):new cc.LabelTTF(e._text,e._fontName,e._fontSize);break;case ccui.RichElement.IMAGE:n=new cc.Sprite(e._filePath);break;case ccui.RichElement.CUSTOM:n=e._customNode}n.setColor(e._color),n.setOpacity(e._color.a),this._pushToContainer(n)}else for(this._addNewLine(),t=0;t<i.length;t++)switch(e=i[t],e._type){case ccui.RichElement.TEXT:e._fontDefinition?this._handleTextRenderer(e._text,e._fontDefinition,e._fontDefinition.fontSize,e._fontDefinition.fillStyle):this._handleTextRenderer(e._text,e._fontName,e._fontSize,e._color);break;case ccui.RichElement.IMAGE:this._handleImageRenderer(e._filePath,e._color,e._color.a);break;case ccui.RichElement.CUSTOM:this._handleCustomRenderer(e._customNode)}this.formatRenderers(),this._formatTextDirty=!1}},_handleTextRenderer:function(t,e,i,n){if(""!==t){if("\n"===t)return void this._addNewLine();var r=e instanceof cc.FontDefinition?new cc.LabelTTF(t,e):new cc.LabelTTF(t,e,i),o=r.getContentSize().width;if(this._leftSpaceWidth-=o,this._leftSpaceWidth<0){var s=-this._leftSpaceWidth/o,c=t,a=c.length,l=a*(1-s),h=c.substr(0,l),u=c.substr(l,c.length-1),d=l>0;if(this._lineBreakOnSpace){var _=h.lastIndexOf(" ");l=_===-1?l:_+1,u=c.substr(l,c.length-1),d=l>0&&" "!==u}if(d){var p=null;e instanceof cc.FontDefinition?(p=new cc.LabelTTF(h.substr(0,l),e),p.setOpacity(e.fillStyle.a)):(p=new cc.LabelTTF(h.substr(0,l),e,i),p.setColor(n),p.setOpacity(n.a)),this._pushToContainer(p)}this._addNewLine(),this._handleTextRenderer(u,e,i,n)}else e instanceof cc.FontDefinition?r.setOpacity(e.fillStyle.a):(r.setColor(n),r.setOpacity(n.a)),this._pushToContainer(r)}},_handleImageRenderer:function(t,e,i){var n=new cc.Sprite(t);this._handleCustomRenderer(n)},_handleCustomRenderer:function(t){var e=t.getContentSize();this._leftSpaceWidth-=e.width,this._leftSpaceWidth<0?(this._addNewLine(),this._pushToContainer(t),this._leftSpaceWidth-=e.width):this._pushToContainer(t)},_addNewLine:function(){this._leftSpaceWidth=this._customSize.width,this._elementRenders.push([])},formatRenderers:function(){var t,e,i,n,r,o,s,c=0,a=this._elementRenderersContainer,l=this._elementRenders;if(this._ignoreSize){var h=0;for(i=l[0],n=0,e=0;e<i.length;e++){r=i[e],r.setAnchorPoint(cc.p(0,0)),r.setPosition(n,0),a.addChild(r,1,e),o=r.getLineHeight?r.getLineHeight():c;var u=r.getContentSize();h+=u.width,c=Math.max(Math.min(c,o),u.height),n+=u.width}if(this._textHorizontalAlignment!==cc.TEXT_ALIGNMENT_LEFT)for(s=0,this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_RIGHT?s=this._contentSize.width-n:this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_CENTER&&(s=(this._contentSize.width-n)/2),e=0;e<i.length;e++)i[e].x+=s;a.setContentSize(h,c)}else{var d=[];for(t=0;t<l.length;t++){i=l[t];var _=0;for(e=0;e<i.length;e++)r=i[e],o=r.getLineHeight?r.getLineHeight():r.getContentSize().height,_=Math.max(Math.min(r.getContentSize().height,o),_);d[t]=_,c+=d[t]}var p=this._customSize.height;for(t=0;t<l.length;t++){for(i=l[t],n=0,p-=d[t]+this._verticalSpace,e=0;e<i.length;e++)r=i[e],r.setAnchorPoint(cc.p(0,0)),r.setPosition(cc.p(n,p)),a.addChild(r,1),n+=r.getContentSize().width;if(this._textHorizontalAlignment!==cc.TEXT_ALIGNMENT_LEFT||this._textVerticalAlignment!==cc.VERTICAL_TEXT_ALIGNMENT_TOP){s=0,this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_RIGHT?s=this._contentSize.width-n:this._textHorizontalAlignment===cc.TEXT_ALIGNMENT_CENTER&&(s=(this._contentSize.width-n)/2);var f=0;for(this._textVerticalAlignment===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?f=this._customSize.height-c:this._textVerticalAlignment===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(f=(this._customSize.height-c)/2),e=0;e<i.length;e++)r=i[e],r.x+=s,r.y-=f}}a.setContentSize(this._contentSize)}var m=l.length;for(t=0;t<m;t++)l[t].length=0;this._elementRenders.length=0,this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():this._customSize),this._updateContentSizeWithTextureSize(this._contentSize),a.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},_pushToContainer:function(t){this._elementRenders.length<=0||this._elementRenders[this._elementRenders.length-1].push(t)},_adaptRenderers:function(){this.formatText()},setVerticalSpace:function(t){this._verticalSpace=t},setAnchorPoint:function(t){ccui.Widget.prototype.setAnchorPoint.call(this,t),this._elementRenderersContainer.setAnchorPoint(t)},_setAnchorX:function(t){ccui.Widget.prototype._setAnchorX.call(this,t),this._elementRenderersContainer._setAnchorX(t)},_setAnchorY:function(t){ccui.Widget.prototype._setAnchorY.call(this,t),this._elementRenderersContainer._setAnchorY(t)},getVirtualRendererSize:function(){return this._elementRenderersContainer.getContentSize()},ignoreContentAdaptWithSize:function(t){this._ignoreSize!==t&&(this._formatTextDirty=!0,ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,t))},getContentSize:function(){return this.formatText(),cc.Node.prototype.getContentSize.call(this)},_getWidth:function(){return this.formatText(),cc.Node.prototype._getWidth.call(this)},_getHeight:function(){return this.formatText(),cc.Node.prototype._getHeight.call(this)},setContentSize:function(t,e){var i=void 0===e?t.width:t,n=void 0===e?t.height:e;ccui.Widget.prototype.setContentSize.call(this,i,n),this._formatTextDirty=!0},getDescription:function(){return"RichText"},setCascadeOpacityEnabled:function(t){this._super(t),this._elementRenderersContainer.setCascadeOpacityEnabled(t)},setLineBreakOnSpace:function(t){this._lineBreakOnSpace=t,this._formatTextDirty=!0,this.formatText()},setTextHorizontalAlignment:function(t){t!==this._textHorizontalAlignment&&(this._textHorizontalAlignment=t,this.formatText())},setTextVerticalAlignment:function(t){t!==this._textVerticalAlignment&&(this._textVerticalAlignment=t,this.formatText())}}),ccui.RichText.create=function(){return new ccui.RichText},ccui.RichElement.TEXT=0,ccui.RichElement.IMAGE=1,ccui.RichElement.CUSTOM=2,ccui.ScrollViewBar=ccui.ProtectedNode.extend({_parentScroll:null,_direction:null,_upperHalfCircle:null,_lowerHalfCircle:null,_body:null,_opacity:255,_marginFromBoundary:0,_marginForLength:0,_touching:!1,_autoHideEnabled:!0,autoHideTime:0,_autoHideRemainingTime:0,_className:"ScrollViewBar",ctor:function(t,e){cc.ProtectedNode.prototype.ctor.call(this),this._direction=e,this._parentScroll=t,this._marginFromBoundary=ccui.ScrollViewBar.DEFAULT_MARGIN,this._marginForLength=ccui.ScrollViewBar.DEFAULT_MARGIN,this.opacity=255*ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY,this.autoHideTime=ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME,this._autoHideEnabled=!0,ccui.ScrollViewBar.prototype.init.call(this),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0)},init:function(){this._upperHalfCircle=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY),this._upperHalfCircle.setAnchorPoint(cc.p(.5,0)),this._lowerHalfCircle=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY),this._lowerHalfCircle.setAnchorPoint(cc.p(.5,0)),this._lowerHalfCircle.setScaleY(-1),this.addProtectedChild(this._upperHalfCircle),this.addProtectedChild(this._lowerHalfCircle),this._body=ccui.helper._createSpriteFromBase64(ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT,ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY),this._body.setAnchorPoint(cc.p(.5,0)),this.addProtectedChild(this._body),this.setColor(ccui.ScrollViewBar.DEFAULT_COLOR),this.onScrolled(cc.p(0,0)),cc.ProtectedNode.prototype.setOpacity.call(this,0),this._autoHideRemainingTime=0,this._direction===ccui.ScrollView.DIR_HORIZONTAL&&this.setRotation(90)},setPositionFromCorner:function(t){this._direction===ccui.ScrollView.DIR_VERTICAL?(this._marginForLength=t.y,this._marginFromBoundary=t.x):(this._marginForLength=t.x,this._marginFromBoundary=t.y)},onEnter:function(){cc.ProtectedNode.prototype.onEnter.call(this),this.scheduleUpdate()},getPositionFromCorner:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?cc.p(this._marginFromBoundary,this._marginForLength):cc.p(this._marginForLength,this._marginFromBoundary)},setWidth:function(t){var e=t/this._body.width;this._body.setScaleX(e),this._upperHalfCircle.setScale(e),this._lowerHalfCircle.setScale(-e)},getWidth:function(){return this._body.getBoundingBox().width},setAutoHideEnabled:function(t){this._autoHideEnabled=t,!this._autoHideEnabled&&!this._touching&&this._autoHideRemainingTime<=0?cc.ProtectedNode.prototype.setOpacity.call(this,this.opacity):cc.ProtectedNode.prototype.setOpacity.call(this,0)},isAutoHideEnabled:function(){return this._autoHideEnabled},setOpacity:function(t){this._opacity=t},getOpacity:function(){return this._opacity},_updateLength:function(t){var e=t/this._body.getTextureRect().height;this._body.setScaleY(e),this._upperHalfCircle.setPositionY(this._body.getPositionY()+t)},_processAutoHide:function(t){!this._autoHideEnabled||this._autoHideRemainingTime<=0||this._touching||(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime&&(this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime),cc.ProtectedNode.prototype.setOpacity.call(this,this._opacity*(this._autoHideRemainingTime/this.autoHideTime))))},update:function(t){this._processAutoHide(t)},onTouchBegan:function(){this._autoHideEnabled&&(this._touching=!0)},onTouchEnded:function(){this._autoHideEnabled&&(this._touching=!1,this._autoHideRemainingTime<=0||(this._autoHideRemainingTime=this.autoHideTime))},onScrolled:function(t){this._autoHideEnabled&&(this._autoHideRemainingTime=this.autoHideTime,cc.ProtectedNode.prototype.setOpacity.call(this,this.opacity));var e=this._parentScroll.getInnerContainer(),i=0,n=0,r=0,o=0;this._direction===ccui.ScrollView.DIR_VERTICAL?(i=e.height,n=this._parentScroll.height,r=t.y,o=-e.getPositionY()):this._direction===ccui.ScrollView.DIR_HORIZONTAL&&(i=e.width,n=this._parentScroll.width,r=t.x,o=-e.getPositionX());var s=this._calculateLength(i,n,r),c=this._calculatePosition(i,n,o,r,s);this._updateLength(s),this.setPosition(c)},_calculateLength:function(t,e,i){var n=t;if(0!==i){var r=20;n+=(i>0?i:-i)*r}var o=e/n;return Math.abs(e-2*this._marginForLength)*o},_calculatePosition:function(t,e,i,n,r){var o=t-e;0!==n&&(o+=Math.abs(n));var s=0;0!==o&&(s=i/o,s=Math.max(s,0),s=Math.min(s,1));var c=(e-r-2*this._marginForLength)*s+this._marginForLength;return this._direction===ccui.ScrollView.DIR_VERTICAL?cc.p(this._parentScroll.width-this._marginFromBoundary,c):cc.p(c,this._marginFromBoundary)}});var _p=ccui.ScrollViewBar.prototype;_p.opacity,cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity),_p.autoHideEnabled,cc.defineGetterSetter(_p,"autoHideEnabled",_p.isAutoHideEnabled,_p.setAutoHideEnabled),ccui.ScrollViewBar.DEFAULT_COLOR=cc.color(52,65,87),ccui.ScrollViewBar.DEFAULT_MARGIN=20,ccui.ScrollViewBar.DEFAULT_AUTO_HIDE_TIME=.2,ccui.ScrollViewBar.DEFAULT_SCROLLBAR_OPACITY=.4,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY="/__half_circle_image",ccui.ScrollViewBar.HALF_CIRCLE_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAGCAMAAADAMI+zAAAAJ1BMVEX///////////////////////////////////////////////////9Ruv0SAAAADHRSTlMABgcbbW7Hz9Dz+PmlcJP5AAAAMElEQVR4AUXHwQ2AQAhFwYcLH1H6r1djzDK3ASxUpTBeK/uTCyz7dx54b44m4p5cD1MwAooEJyk3AAAAAElFTkSuQmCC",ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY="/__body_image_height",ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAABCAMAAADdNb8LAAAAA1BMVEX///+nxBvIAAAACklEQVR4AWNABgAADQABYc2cpAAAAABJRU5ErkJggg==",ccui.ScrollView=ccui.Layout.extend({_innerContainer:null,_direction:null,_topBoundary:0,_bottomBoundary:0,_leftBoundary:0,_rightBoundary:0,_touchMoveDisplacements:null,_touchMoveTimeDeltas:null,_touchMovePreviousTimestamp:0,_touchTotalTimeThreshold:.5,_autoScrolling:!1,_autoScrollTargetDelta:null,_autoScrollAttenuate:!0,_autoScrollStartPosition:null,_autoScrollTotalTime:0,_autoScrollAccumulatedTime:0,_autoScrollCurrentlyOutOfBoundary:!1,_autoScrollBraking:!1,_autoScrollBrakingStartPosition:null,_bePressed:!1,_childFocusCancelOffset:0,bounceEnabled:!1,_outOfBoundaryAmount:null,_outOfBoundaryAmountDirty:!0,inertiaScrollEnabled:!1,_scrollBarEnabled:!0,_verticalScrollBar:null,_horizontalScrollBar:null,_scrollViewEventListener:null,_scrollViewEventSelector:null,_className:"ScrollView",ctor:function(){ccui.Layout.prototype.ctor.call(this),this.setClippingEnabled(!0),this._innerContainer.setTouchEnabled(!1),this._direction=ccui.ScrollView.DIR_NONE,this._childFocusCancelOffset=5,this.inertiaScrollEnabled=!0,this._outOfBoundaryAmount=cc.p(0,0),this._autoScrollTargetDelta=cc.p(0,0),this._autoScrollStartPosition=cc.p(0,0),this._autoScrollBrakingStartPosition=cc.p(0,0),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._scrollBarEnabled=!0,this._initScrollBar(),this.setTouchEnabled(!0)},init:function(){return!!ccui.Layout.prototype.init.call(this)},onEnter:function(){ccui.Layout.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.renderer._removeCache(this.__instanceId),ccui.Layout.prototype.onExit.call(this)},findNextFocusedWidget:function(t,e){return this.getLayoutType()===ccui.Layout.LINEAR_VERTICAL||this.getLayoutType()===ccui.Layout.LINEAR_HORIZONTAL?this._innerContainer.findNextFocusedWidget(t,e):ccui.Widget.prototype.findNextFocusedWidget.call(this,t,e)},_initRenderer:function(){ccui.Layout.prototype._initRenderer.call(this),this._innerContainer=new ccui.Layout,this._innerContainer.setColor(cc.color(255,255,255)),this._innerContainer.setOpacity(255),this._innerContainer.setCascadeColorEnabled(!0),this._innerContainer.setCascadeOpacityEnabled(!0),this.addProtectedChild(this._innerContainer,1,1)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new ccui.ScrollView.WebGLRenderCmd(this):new ccui.ScrollView.CanvasRenderCmd(this)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this);var t=this._contentSize;this._topBoundary=t.height,this._rightBoundary=t.width;var e=this._innerContainer.getContentSize();this._innerContainer.setContentSize(cc.size(Math.max(e.width,t.width),Math.max(e.height,t.height))),this._innerContainer.setPosition(0,t.height-this._innerContainer.getContentSize().height),this._verticalScrollBar&&this._verticalScrollBar.onScrolled(this._getHowMuchOutOfBoundary()),this._horizontalScrollBar&&this._horizontalScrollBar.onScrolled(this._getHowMuchOutOfBoundary())},setInnerContainerSize:function(t){var e=this._innerContainer,i=this._contentSize,n=i.width,r=i.height;t.width<i.width?cc.log("Inner width <= ScrollView width, it will be force sized!"):n=t.width,t.height<i.height?cc.log("Inner height <= ScrollView height, it will be force sized!"):r=t.height,e.setContentSize(cc.size(n,r));var o=this._innerContainer.getPosition(),s=this._innerContainer.getAnchorPoint();0!=this._innerContainer.getLeftBoundary()&&(o.x=s.x*n),this._innerContainer.getTopBoundary()!=this._contentSize.height&&(o.y=this._contentSize.height-(1-s.y)*r),this.setInnerContainerPosition(o),this._updateScrollBar(cc.p(0,0))},_setInnerWidth:function(t){var e=this._contentSize.width,i=e,n=this._innerContainer,r=n.width;switch(t<e?cc.log("Inner width <= scrollview width, it will be force sized!"):i=t,n.width=i,this._direction){case ccui.ScrollView.DIR_HORIZONTAL:case ccui.ScrollView.DIR_BOTH:if(n.getRightBoundary()<=e){var o=n.width,s=r-o;this._scrollChildren(s,0)}}var c=n.anchorX;n.getLeftBoundary()>0&&(n.x=c*i),n.getRightBoundary()<e&&(n.x=e-(1-c)*i)},_setInnerHeight:function(t){var e=this._contentSize.height,i=e,n=this._innerContainer,r=n.height;switch(t<e?cc.log("Inner height <= scrollview height, it will be force sized!"):i=t,n.height=i,this._direction){case ccui.ScrollView.DIR_VERTICAL:case ccui.ScrollView.DIR_BOTH:var o=i,s=r-o;this._scrollChildren(0,s)}var c=n.anchorY;n.getLeftBoundary()>0&&(n.y=c*i),n.getRightBoundary()<e&&(n.y=e-(1-c)*i)},setInnerContainerPosition:function(t){if(t.x!==this._innerContainer.getPositionX()||t.y!==this._innerContainer.getPositionY()){if(this._innerContainer.setPosition(t),this._outOfBoundaryAmountDirty=!0,this.bounceEnabled)for(var e=ccui.ScrollView.MOVEDIR_TOP;e<ccui.ScrollView.MOVEDIR_RIGHT;++e)this._isOutOfBoundary(e)&&this._processScrollEvent(e,!0);this._dispatchEvent(ccui.ScrollView.EVENT_CONTAINER_MOVED)}},getInnerContainerPosition:function(){return this._innerContainer.getPosition()},getInnerContainerSize:function(){return this._innerContainer.getContentSize()},_getInnerWidth:function(){return this._innerContainer.width},_getInnerHeight:function(){return this._innerContainer.height},_isInContainer:function(t){if(!this._clippingEnabled)return!0;var e=t._position,i=t._contentSize,n=t._anchorPoint,r=this._customSize,o=this._innerContainer._position,s=0,c=0;return!((s=e.y-n.y*i.height)>=r.height-o.y||s+i.height<=-o.y||(c=e.x-n.x*i.width)>=r.width-o.x||c+i.width<=-o.x)},updateChildren:function(){var t,e,i,n=this._innerContainer._children;for(e=0,i=n.length;e<i;e++)t=n[e],t._inViewRect===!0&&this._isInContainer(t)===!1?t._inViewRect=!1:t._inViewRect===!1&&this._isInContainer(t)===!0&&(t._inViewRect=!0)},addChild:function(t,e,i){return!!t&&(this._isInContainer(t)===!1&&(t._inViewRect=!1),e=e||t.getLocalZOrder(),i=i||t.getTag(),this._innerContainer.addChild(t,e,i))},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(t){this._innerContainer.removeAllChildrenWithCleanup(t)},removeChild:function(t,e){return this._innerContainer.removeChild(t,e)},getChildren:function(){return this._innerContainer.getChildren()},getChildrenCount:function(){return this._innerContainer.getChildrenCount()},getChildByTag:function(t){return this._innerContainer.getChildByTag(t)},getChildByName:function(t){return this._innerContainer.getChildByName(t)},_flattenVectorByDirection:function(t){var e=cc.p(0,0);return e.x=this._direction===ccui.ScrollView.DIR_VERTICAL?0:t.x,e.y=this._direction===ccui.ScrollView.DIR_HORIZONTAL?0:t.y,e},_getHowMuchOutOfBoundary:function(t){if(void 0===t&&(t=cc.p(0,0)),0===t.x&&0===t.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.p(0,0);return this._innerContainer.getLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._innerContainer.getLeftBoundary()+t.x):this._innerContainer.getRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._innerContainer.getRightBoundary()+t.x)),this._innerContainer.getTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._innerContainer.getTopBoundary()+t.y):this._innerContainer.getBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._innerContainer.getBottomBoundary()+t.y)),0===t.x&&0===t.y&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),e},_isOutOfBoundary:function(t){var e=this._getHowMuchOutOfBoundary();if(void 0===t)return!this._fltEqualZero(e);switch(t){case ccui.ScrollView.MOVEDIR_TOP:return e.y>0;case ccui.ScrollView.MOVEDIR_BOTTOM:return e.y<0;case ccui.ScrollView.MOVEDIR_LEFT:return e.x<0;case ccui.ScrollView.MOVEDIR_RIGHT:return e.x>0}return!1},_moveInnerContainer:function(t,e){var i=this._flattenVectorByDirection(t);this.setInnerContainerPosition(cc.pAdd(this.getInnerContainerPosition(),i));var n=this._getHowMuchOutOfBoundary();this._updateScrollBar(n),this.bounceEnabled&&e&&this._startBounceBackIfNeeded()},_updateScrollBar:function(t){this._verticalScrollBar&&this._verticalScrollBar.onScrolled(t),this._horizontalScrollBar&&this._horizontalScrollBar.onScrolled(t)},_calculateTouchMoveVelocity:function(){for(var t=0,e=0;e<this._touchMoveTimeDeltas.length;++e)t+=this._touchMoveTimeDeltas[e];if(0==t||t>=this._touchTotalTimeThreshold)return cc.p(0,0);for(var i=cc.p(0,0),e=0;e<this._touchMoveDisplacements.length;++e)i.x+=this._touchMoveDisplacements[e].x,i.y+=this._touchMoveDisplacements[e].y;return cc.pMult(i,1/t)},setTouchTotalTimeThreshold:function(t){this._touchTotalTimeThreshold=t},getTouchTotalTimeThreshold:function(){return this._touchTotalTimeThreshold},_startInertiaScroll:function(t){var e=.7,i=cc.pMult(t,e);this._startAttenuatingAutoScroll(i,t)},_startBounceBackIfNeeded:function(){if(!this.bounceEnabled)return!1;var t=this._getHowMuchOutOfBoundary();if(this._fltEqualZero(t))return!1;var e=1;return this._startAutoScroll(t,e,!0),!0},_startAutoScrollToDestination:function(t,e,i){this._startAutoScroll(cc.pSub(t,this._innerContainer.getPosition()),e,i)},_calculateAutoScrollTimeByInitialSpeed:function(t){return Math.sqrt(Math.sqrt(t/5))},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));this._startAutoScroll(t,i,!0)},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this._innerContainer.getPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var r=this._getHowMuchOutOfBoundary();if(!this._fltEqualZero(r)){this._autoScrollCurrentlyOutOfBoundary=!0;var o=this._getHowMuchOutOfBoundary(n);(r.x*o.x>0||r.y*o.y>0)&&(this._autoScrollBraking=!0)}},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAttenuate=!0,this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getInnerContainerPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},_getAutoScrollStopEpsilon:function(){return 1e-4},_fltEqualZero:function(t){return Math.abs(t.x)<=1e-4&&Math.abs(t.y)<=1e-4},_processAutoScrolling:function(t){var e=.05,i=this._isNecessaryAutoScrollBrake()?e:1;this._autoScrollAccumulatedTime+=t*(1/i);var n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n-=1,n=n*n*n*n*n+1);var r=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n)),o=Math.abs(n-1)<=this._getAutoScrollStopEpsilon();if(this.bounceEnabled)r=cc.pAdd(this._autoScrollBrakingStartPosition,cc.pMult(cc.pSub(r,this._autoScrollBrakingStartPosition),i));else{var s=cc.pSub(r,this.getInnerContainerPosition()),c=this._getHowMuchOutOfBoundary(s);this._fltEqualZero(c)||(r.x+=c.x,r.y+=c.y,o=!0)}o&&(this._autoScrolling=!1,this._dispatchEvent(ccui.ScrollView.EVENT_AUTOSCROLL_ENDED)),this._moveInnerContainer(cc.pSub(r,this.getInnerContainerPosition()),o)},_jumpToDestination:function(t,e){void 0===t.x&&(t=cc.p(t,e)),this._autoScrolling=!1,this._moveInnerContainer(cc.pSub(t,this.getInnerContainerPosition()),!0)},_scrollChildren:function(t){var e=t;if(this.bounceEnabled){var i=this._getHowMuchOutOfBoundary();e.x*=0==i.x?1:.5,e.y*=0==i.y?1:.5}if(!this.bounceEnabled){var i=this._getHowMuchOutOfBoundary(e);e.x+=i.x,e.y+=i.y}var n=!1,r=!1,o=!1,s=!1;if(e.y>0){var c=this._innerContainer.getBottomBoundary();c+e.y>=this._bottomBoundary&&(s=!0)}else if(e.y<0){var a=this._innerContainer.getTopBoundary();a+e.y<=this._topBoundary&&(o=!0)}if(e.x<0){var l=this._innerContainer.getRightBoundary();l+e.x<=this._rightBoundary&&(r=!0)}else if(e.x>0){var h=this._innerContainer.getLeftBoundary();h+e.x>=this._leftBoundary&&(n=!0)}this._moveInnerContainer(e,!1),0==e.x&&0==e.y||this._processScrollingEvent(),s&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_BOTTOM,!1),o&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_TOP,!1),n&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_LEFT,!1),r&&this._processScrollEvent(ccui.ScrollView.MOVEDIR_RIGHT,!1)},scrollToBottom:function(t,e){this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),0),t,e)},scrollToTop:function(t,e){this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height),t,e)},scrollToLeft:function(t,e){this._startAutoScrollToDestination(cc.p(0,this._innerContainer.getPositionY()),t,e)},scrollToRight:function(t,e){this._startAutoScrollToDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY()),t,e)},scrollToTopLeft:function(t,e){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollToDestination(cc.p(0,this._contentSize.height-this._innerContainer.getContentSize().height),t,e)},scrollToTopRight:function(t,e){if(this._direction!==ccui.ScrollView.DIR_BOTH)return void cc.log("Scroll direction is not both!");var i=this._innerContainer.getContentSize();this._startAutoScrollToDestination(cc.p(this._contentSize.width-i.width,this._contentSize.height-i.height),t,e)},scrollToBottomLeft:function(t,e){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollToDestination(cc.p(0,0),t,e)},scrollToBottomRight:function(t,e){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollToDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,0),t,e)},scrollToPercentVertical:function(t,e,i){var n=this._contentSize.height-this._innerContainer.getContentSize().height,r=-n;this._startAutoScrollToDestination(cc.p(this._innerContainer.getPositionX(),n+t*r/100),e,i)},scrollToPercentHorizontal:function(t,e,i){var n=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollToDestination(cc.p(-(t*n/100),this._innerContainer.getPositionY()),e,i)},scrollToPercentBothDirection:function(t,e,i){if(this._direction===ccui.ScrollView.DIR_BOTH){var n=this._contentSize.height-this._innerContainer.getContentSize().height,r=-n,o=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollToDestination(cc.p(-(t.x*o/100),n+t.y*r/100),e,i)}},jumpToBottom:function(){this._jumpToDestination(this._innerContainer.getPositionX(),0)},jumpToTop:function(){this._jumpToDestination(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToLeft:function(){this._jumpToDestination(0,this._innerContainer.getPositionY())},jumpToRight:function(){this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY())},jumpToTopLeft:function(){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll _direction is not both!"):void this._jumpToDestination(0,this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToTopRight:function(){if(this._direction!==ccui.ScrollView.DIR_BOTH)return void cc.log("Scroll _direction is not both!");var t=this._innerContainer.getContentSize();this._jumpToDestination(this._contentSize.width-t.width,this._contentSize.height-t.height)},jumpToBottomLeft:function(){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll _direction is not both!"):void this._jumpToDestination(0,0)},jumpToBottomRight:function(){return this._direction!==ccui.ScrollView.DIR_BOTH?void cc.log("Scroll _direction is not both!"):void this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,0)},jumpToPercentVertical:function(t){var e=this._contentSize.height-this._innerContainer.getContentSize().height,i=-e;this._jumpToDestination(this._innerContainer.getPositionX(),e+t*i/100)},jumpToPercentHorizontal:function(t){var e=this._innerContainer.getContentSize().width-this._contentSize.width;this._jumpToDestination(-(t*e/100),this._innerContainer.getPositionY())},jumpToPercentBothDirection:function(t){if(this._direction===ccui.ScrollView.DIR_BOTH){var e=this._innerContainer.getContentSize(),i=this._contentSize.height-e.height,n=-i,r=e.width-this._contentSize.width;this._jumpToDestination(-(t.x*r/100),i+t.y*n/100)}},_gatherTouchMove:function(t){for(var e=5;this._touchMoveDisplacements.length>=e;)this._touchMoveDisplacements.splice(0,1),this._touchMoveTimeDeltas.splice(0,1);this._touchMoveDisplacements.push(t);var i=(new Date).getTime();this._touchMoveTimeDeltas.push((i-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=i},_handlePressLogic:function(t){this._bePressed=!0,this._autoScrolling=!1,this._touchMovePreviousTimestamp=(new Date).getTime(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._verticalScrollBar&&this._verticalScrollBar.onTouchBegan(),this._horizontalScrollBar&&this._horizontalScrollBar.onTouchBegan()},_handleMoveLogic:function(t){var e=this.convertToNodeSpace(t.getLocation()),i=this.convertToNodeSpace(t.getPreviousLocation()),n=cc.pSub(e,i);this._scrollChildren(n),this._gatherTouchMove(n)},_handleReleaseLogic:function(t){var e=this.convertToNodeSpace(t.getLocation()),i=this.convertToNodeSpace(t.getPreviousLocation()),n=cc.pSub(e,i);this._gatherTouchMove(n),this._bePressed=!1;var r=this._startBounceBackIfNeeded();if(!r&&this.inertiaScrollEnabled){var o=this._calculateTouchMoveVelocity();0===o.x&&0===o.y||this._startInertiaScroll(o)}this._verticalScrollBar&&this._verticalScrollBar.onTouchEnded(),this._horizontalScrollBar&&this._horizontalScrollBar.onTouchEnded()},onTouchBegan:function(t,e){var i=ccui.Layout.prototype.onTouchBegan.call(this,t,e);return this._isInterceptTouch||this._hit&&this._handlePressLogic(t),i},onTouchMoved:function(t,e){ccui.Layout.prototype.onTouchMoved.call(this,t,e),this._isInterceptTouch||this._handleMoveLogic(t)},onTouchEnded:function(t,e){ccui.Layout.prototype.onTouchEnded.call(this,t,e),this._isInterceptTouch||this._handleReleaseLogic(t),this._isInterceptTouch=!1},onTouchCancelled:function(t,e){ccui.Layout.prototype.onTouchCancelled.call(this,t,e),this._isInterceptTouch||this._handleReleaseLogic(t),this._isInterceptTouch=!1},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)},interceptTouchEvent:function(t,e,i){if(!this._touchEnabled)return void ccui.Layout.prototype.interceptTouchEvent.call(this,t,e,i);if(this._direction!==ccui.ScrollView.DIR_NONE){var n=i.getLocation();switch(t){case ccui.Widget.TOUCH_BEGAN:this._isInterceptTouch=!0,this._touchBeganPosition.x=n.x,this._touchBeganPosition.y=n.y,this._handlePressLogic(i);break;case ccui.Widget.TOUCH_MOVED:var r=cc.pLength(cc.pSub(e.getTouchBeganPosition(),n));this._touchMovePosition.x=n.x,this._touchMovePosition.y=n.y,r>this._childFocusCancelOffset&&(e.setHighlighted(!1),this._handleMoveLogic(i));break;case ccui.Widget.TOUCH_CANCELED:case ccui.Widget.TOUCH_ENDED:this._touchEndPosition.x=n.x,this._touchEndPosition.y=n.y,this._handleReleaseLogic(i),e.isSwallowTouches()&&(this._isInterceptTouch=!1)}}},_processScrollEvent:function(t,e){var i=0;switch(t){case ccui.ScrollView.MOVEDIR_TOP:i=e?ccui.ScrollView.EVENT_BOUNCE_TOP:ccui.ScrollView.EVENT_SCROLL_TO_TOP;break;case ccui.ScrollView.MOVEDIR_BOTTOM:i=e?ccui.ScrollView.EVENT_BOUNCE_BOTTOM:ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM;break;case ccui.ScrollView.MOVEDIR_LEFT:i=e?ccui.ScrollView.EVENT_BOUNCE_LEFT:ccui.ScrollView.EVENT_SCROLL_TO_LEFT;break;case ccui.ScrollView.MOVEDIR_RIGHT:i=e?ccui.ScrollView.EVENT_BOUNCE_RIGHT:ccui.ScrollView.EVENT_SCROLL_TO_RIGHT}this._dispatchEvent(i)},_processScrollingEvent:function(){this._dispatchEvent(ccui.ScrollView.EVENT_SCROLLING)},_dispatchEvent:function(t){this._scrollViewEventSelector&&(this._scrollViewEventListener?this._scrollViewEventSelector.call(this._scrollViewEventListener,this,t):this._scrollViewEventSelector(this,t)),this._ccEventCallback&&this._ccEventCallback(this,t)},addEventListenerScrollView:function(t,e){this._scrollViewEventSelector=t,this._scrollViewEventListener=e},addEventListener:function(t){this._ccEventCallback=t},setDirection:function(t){this._direction=t,this._scrollBarEnabled&&(this._removeScrollBar(),this._initScrollBar())},getDirection:function(){return this._direction},setBounceEnabled:function(t){this.bounceEnabled=t},isBounceEnabled:function(){return this.bounceEnabled},setInertiaScrollEnabled:function(t){this.inertiaScrollEnabled=t},isInertiaScrollEnabled:function(){return this.inertiaScrollEnabled},setScrollBarEnabled:function(t){this._scrollBarEnabled!==t&&(this._scrollBarEnabled&&this._removeScrollBar(),this._scrollBarEnabled=t,this._scrollBarEnabled&&this._initScrollBar())},isScrollBarEnabled:function(){return this._scrollBarEnabled},setScrollBarPositionFromCorner:function(t){this._direction!==ccui.ScrollView.DIR_HORIZONTAL&&this.setScrollBarPositionFromCornerForVertical(t),this._direction!==ccui.ScrollView.DIR_VERTICAL&&this.setScrollBarPositionFromCornerForHorizontal(t)},setScrollBarPositionFromCornerForVertical:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_HORIZONTAL,"Scroll view doesn't have a vertical scroll bar!"),this._verticalScrollBar.setPositionFromCorner(t)},getScrollBarPositionFromCornerForVertical:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_HORIZONTAL,"Scroll view doesn't have a vertical scroll bar!"),this._verticalScrollBar.getPositionFromCorner()},setScrollBarPositionFromCornerForHorizontal:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_VERTICAL,"Scroll view doesn't have a horizontal scroll bar!"),this._horizontalScrollBar.setPositionFromCorner(t)},getScrollBarPositionFromCornerForHorizontal:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),cc.assert(this._direction!==ccui.ScrollView.DIR_VERTICAL,"Scroll view doesn't have a horizontal scroll bar!"),this._horizontalScrollBar.getPositionFromCorner()},setScrollBarWidth:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.setWidth(t),this._horizontalScrollBar&&this._horizontalScrollBar.setWidth(t)},getScrollBarWidth:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.getWidth():this._horizontalScrollBar?this._horizontalScrollBar.getWidth():0},setScrollBarColor:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.setColor(t),this._horizontalScrollBar&&this._horizontalScrollBar.setColor(t)},getScrollBarColor:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&this._verticalScrollBar.getColor(),this._horizontalScrollBar&&this._horizontalScrollBar.getColor(),cc.color.WHITE},setScrollBarOpacity:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.opacity=t),this._horizontalScrollBar&&(this._horizontalScrollBar.opacity=t)},getScrollBarOpacity:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.opacity:this._horizontalScrollBar?this._horizontalScrollBar.opacity:-1},setScrollBarAutoHideEnabled:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.autoHideEnabled=t),this._horizontalScrollBar&&(this._horizontalScrollBar.autoHideEnabled=t)},isScrollBarAutoHideEnabled:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.autoHideEnabled:!!this._horizontalScrollBar&&this._horizontalScrollBar.autoHideEnabled},setScrollBarAutoHideTime:function(t){cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar&&(this._verticalScrollBar.autoHideTime=t),this._horizontalScrollBar&&(this._horizontalScrollBar.autoHideTime=t)},getScrollBarAutoHideTime:function(){return cc.assert(this._scrollBarEnabled,"Scroll bar should be enabled!"),this._verticalScrollBar?this._verticalScrollBar.autoHideTime:this._horizontalScrollBar?this._horizontalScrollBar.autoHideTime:0},getInnerContainer:function(){return this._innerContainer},setLayoutType:function(t){this._innerContainer.setLayoutType(t)},getLayoutType:function(){return this._innerContainer.getLayoutType()},_doLayout:function(){this._doLayoutDirty&&(this._doLayoutDirty=!1)},getDescription:function(){return"ScrollView"},_createCloneInstance:function(){return new ccui.ScrollView},_copyClonedWidgetChildren:function(t){ccui.Layout.prototype._copyClonedWidgetChildren.call(this,t)},_copySpecialProperties:function(t){t instanceof ccui.ScrollView&&(ccui.Layout.prototype._copySpecialProperties.call(this,t),this.setInnerContainerSize(t.getInnerContainerSize()),this.setInnerContainerPosition(t.getInnerContainerPosition()),this.setDirection(t._direction),this._topBoundary=t._topBoundary,this._bottomBoundary=t._bottomBoundary,this._leftBoundary=t._leftBoundary,this._rightBoundary=t._rightBoundary,this._bePressed=t._bePressed,this._childFocusCancelOffset=t._childFocusCancelOffset,this._touchMoveDisplacements=t._touchMoveDisplacements,this._touchMoveTimeDeltas=t._touchMoveTimeDeltas,this._touchMovePreviousTimestamp=t._touchMovePreviousTimestamp,this._autoScrolling=t._autoScrolling,this._autoScrollAttenuate=t._autoScrollAttenuate,this._autoScrollStartPosition=t._autoScrollStartPosition,this._autoScrollTargetDelta=t._autoScrollTargetDelta,this._autoScrollTotalTime=t._autoScrollTotalTime,this._autoScrollAccumulatedTime=t._autoScrollAccumulatedTime,this._autoScrollCurrentlyOutOfBoundary=t._autoScrollCurrentlyOutOfBoundary,this._autoScrollBraking=t._autoScrollBraking,this._autoScrollBrakingStartPosition=t._autoScrollBrakingStartPosition,this.setBounceEnabled(t.bounceEnabled),this.setInertiaScrollEnabled(t.inertiaScrollEnabled),this._scrollViewEventListener=t._scrollViewEventListener,this._scrollViewEventSelector=t._scrollViewEventSelector,this._ccEventCallback=t._ccEventCallback,this.setScrollBarEnabled(t.isScrollBarEnabled()),this.isScrollBarEnabled()&&(this._direction!==ccui.ScrollView.DIR_HORIZONTAL&&this.setScrollBarPositionFromCornerForVertical(t.getScrollBarPositionFromCornerForVertical()),this._direction!==ccui.ScrollView.DIR_VERTICAL&&this.setScrollBarPositionFromCornerForHorizontal(t.getScrollBarPositionFromCornerForHorizontal()),this.setScrollBarWidth(t.getScrollBarWidth()),this.setScrollBarColor(t.getScrollBarColor()),this.setScrollBarAutoHideEnabled(t.isScrollBarAutoHideEnabled()),this.setScrollBarAutoHideTime(t.getScrollBarAutoHideTime())))},_initScrollBar:function(){this._direction===ccui.ScrollView.DIR_HORIZONTAL||this._verticalScrollBar||(this._verticalScrollBar=new ccui.ScrollViewBar(this,ccui.ScrollView.DIR_VERTICAL),this.addProtectedChild(this._verticalScrollBar,2)),this._direction===ccui.ScrollView.DIR_VERTICAL||this._horizontalScrollBar||(this._horizontalScrollBar=new ccui.ScrollViewBar(this,ccui.ScrollView.DIR_HORIZONTAL),this.addProtectedChild(this._horizontalScrollBar,2))},_removeScrollBar:function(){this._verticalScrollBar&&(this.removeProtectedChild(this._verticalScrollBar),this._verticalScrollBar=null),this._horizontalScrollBar&&(this.removeProtectedChild(this._horizontalScrollBar),this._horizontalScrollBar=null)},getNodeByTag:function(t){return this._innerContainer.getNodeByTag(t)},getNodes:function(){return this._innerContainer.getNodes()},removeNode:function(t){this._innerContainer.removeNode(t)},removeNodeByTag:function(t){this._innerContainer.removeNodeByTag(t)},removeAllNodes:function(){this._innerContainer.removeAllNodes()},addNode:function(t,e,i){this._innerContainer.addNode(t,e,i)}});var _p=ccui.ScrollView.prototype;_p.innerWidth,cc.defineGetterSetter(_p,"innerWidth",_p._getInnerWidth,_p._setInnerWidth),_p.innerHeight,cc.defineGetterSetter(_p,"innerHeight",_p._getInnerHeight,_p._setInnerHeight),_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.touchTotalTimeThreshold,cc.defineGetterSetter(_p,"touchTotalTimeThreshold",_p.getTouchTotalTimeThreshold,_p.setTouchTotalTimeThreshold),_p=null,ccui.ScrollView.create=function(){return new ccui.ScrollView},ccui.ScrollView.DIR_NONE=0,ccui.ScrollView.DIR_VERTICAL=1,ccui.ScrollView.DIR_HORIZONTAL=2,ccui.ScrollView.DIR_BOTH=3,ccui.ScrollView.EVENT_SCROLL_TO_TOP=0,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM=1,ccui.ScrollView.EVENT_SCROLL_TO_LEFT=2,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT=3,ccui.ScrollView.EVENT_SCROLLING=4,ccui.ScrollView.EVENT_BOUNCE_TOP=5,ccui.ScrollView.EVENT_BOUNCE_BOTTOM=6,ccui.ScrollView.EVENT_BOUNCE_LEFT=7,ccui.ScrollView.EVENT_BOUNCE_RIGHT=8,ccui.ScrollView.EVENT_CONTAINER_MOVED=9,ccui.ScrollView.EVENT_AUTOSCROLL_ENDED=10,ccui.ScrollView.MOVEDIR_TOP=0,ccui.ScrollView.MOVEDIR_BOTTOM=1,ccui.ScrollView.MOVEDIR_LEFT=2,ccui.ScrollView.MOVEDIR_RIGHT=3,function(){if(ccui.ProtectedNode.CanvasRenderCmd){ccui.ScrollView.CanvasRenderCmd=function(t){ccui.Layout.CanvasRenderCmd.call(this,t),this._dirty=!1};var t=ccui.ScrollView.CanvasRenderCmd.prototype=Object.create(ccui.Layout.CanvasRenderCmd.prototype);t.constructor=ccui.ScrollView.CanvasRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){e.__instanceId;cc.renderer.pushRenderCommand(this),this.layoutVisit(t),this._dirtyFlag=0}},t.rendering=function(t){var e,i,n=this._node.__instanceId,r=cc.renderer._cacheToCanvasCmds[n],o=cc.view.getScaleX(),s=cc.view.getScaleY(),c=t||cc._renderContext;for(c.computeRealOffsetY(),this._node.updateChildren(),e=0,i=r.length;e<i;e++){var a=r[e]._node;a instanceof ccui.ScrollView||a&&a._parent&&a._parent._inViewRect===!1||r[e].rendering(c,o,s)}}}}(),function(){if(ccui.ProtectedNode.WebGLRenderCmd){ccui.ScrollView.WebGLRenderCmd=function(t){ccui.Layout.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._dirty=!1};var t=ccui.ScrollView.WebGLRenderCmd.prototype=Object.create(ccui.Layout.WebGLRenderCmd.prototype);t.constructor=ccui.ScrollView.WebGLRenderCmd,t.visit=function(t){var e=this._node;if(e._visible){var i=this._node.__instanceId;cc.renderer.pushRenderCommand(this),cc.renderer._turnToCacheMode(i),this.layoutVisit(t),e.updateChildren(),this._dirtyFlag=0,cc.renderer._turnToNormalMode()}},t.rendering=function(t){var e,i,n,r,o=this._node.__instanceId,s=cc.renderer._cacheToBufferCmds[o],c=t||cc._renderContext;if(s)for(this._node.updateChildren(),c.bindBuffer(gl.ARRAY_BUFFER,null),e=0,i=s.length;e<i;e++)r=s[e],n=r._node,n instanceof ccui.ScrollView||n&&n._parent&&n._parent._inViewRect===!1||(r.uploadData?cc.renderer._uploadBufferData(r):(r._batchingSize>0&&cc.renderer._batchRendering(),r.rendering(c)),cc.renderer._batchRendering())}}}(),ccui.ListView=ccui.ScrollView.extend({_model:null,_items:null,_gravity:null,_itemsMargin:0,_curSelectedIndex:0,_refreshViewDirty:!0,_listViewEventListener:null,_listViewEventSelector:null,_ccListViewEventCallback:null,_magneticAllowedOutOfBoundary:!0,_magneticType:0,_className:"ListView",ctor:function(){this._items=[],ccui.ScrollView.prototype.ctor.call(this),this._gravity=ccui.ListView.GRAVITY_CENTER_VERTICAL,this.setTouchEnabled(!0),this.setDirection(ccui.ScrollView.DIR_VERTICAL)},setItemModel:function(t){return t?void(this._model=t):void cc.log("Can't set a null to item model!")},_handleReleaseLogic:function(t){ccui.ScrollView.prototype._handleReleaseLogic.call(this,t),this._autoScrolling||this._startMagneticScroll()},_onItemListChanged:function(){this._outOfBoundaryAmountDirty=!0},_updateInnerContainerSize:function(){var t,e,i=this._items;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:t=i.length;var n=(t-1)*this._itemsMargin;for(e=0;e<t;e++)n+=i[e].getContentSize().height;this.setInnerContainerSize(cc.size(this._contentSize.width,n));break;case ccui.ScrollView.DIR_HORIZONTAL:t=i.length;var r=(t-1)*this._itemsMargin;for(e=0;e<t;e++)r+=i[e].getContentSize().width;this.setInnerContainerSize(cc.size(r,this._contentSize.height))}},_remedyLayoutParameter:function(t){cc.assert(null!=t,"ListView Item can't be nil!");var e=t.getLayoutParameter(ccui.LayoutParameter.LINEAR),i=!0;e||(e=new ccui.LinearLayoutParameter,i=!1);var n=this.getIndex(t);switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._remedyVerticalLayoutParameter(e,n);break;case ccui.ScrollView.DIR_HORIZONTAL:this._remedyHorizontalLayoutParameter(e,n)}i||t.setLayoutParameter(e)},_remedyVerticalLayoutParameter:function(t,e){switch(cc.assert(null!=t,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_LEFT:t.setGravity(ccui.LinearLayoutParameter.LEFT);break;case ccui.ListView.GRAVITY_RIGHT:t.setGravity(ccui.LinearLayoutParameter.RIGHT);break;case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:t.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL)}0===e?t.setMargin(ccui.MarginZero()):t.setMargin(new ccui.Margin(0,this._itemsMargin,0,0))},_remedyHorizontalLayoutParameter:function(t,e){switch(cc.assert(null!=t,"Layout parameter can't be nil!"),this._gravity){case ccui.ListView.GRAVITY_TOP:t.setGravity(ccui.LinearLayoutParameter.TOP);break;case ccui.ListView.GRAVITY_BOTTOM:t.setGravity(ccui.LinearLayoutParameter.BOTTOM);break;case ccui.ListView.GRAVITY_CENTER_VERTICAL:t.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL)}0===e?t.setMargin(ccui.MarginZero()):t.setMargin(new ccui.Margin(this._itemsMargin,0,0,0))},pushBackDefaultItem:function(){if(null!=this._model){var t=this._model.clone();this._remedyLayoutParameter(t),this.addChild(t),this._refreshViewDirty=!0}},insertDefaultItem:function(t){if(null!=this._model){var e=this._model.clone();this._items.splice(t,0,e),ccui.ScrollView.prototype.addChild.call(this,e),this._remedyLayoutParameter(e),this._refreshViewDirty=!0}},pushBackCustomItem:function(t){this._remedyLayoutParameter(t),this.addChild(t),this._refreshViewDirty=!0},addChild:function(t,e,i){t&&(e=e||t.getLocalZOrder(),i=i||t.getName(),ccui.ScrollView.prototype.addChild.call(this,t,e,i),t instanceof ccui.Widget&&(this._items.push(t),this._onItemListChanged()))},removeChild:function(t,e){if(t){var i=this._items.indexOf(t);i>-1&&this._items.splice(i,1),this._onItemListChanged(),ccui.ScrollView.prototype.removeChild.call(this,t,e)}},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(t){ccui.ScrollView.prototype.removeAllChildrenWithCleanup.call(this,t),this._items=[],this._onItemListChanged()},insertCustomItem:function(t,e){this._items.splice(e,0,t),this._onItemListChanged(),ccui.ScrollView.prototype.addChild.call(this,t),this._remedyLayoutParameter(t),this._refreshViewDirty=!0},removeItem:function(t){var e=this.getItem(t);null!=e&&(this.removeChild(e,!0),this._refreshViewDirty=!0)},removeLastItem:function(){this.removeItem(this._items.length-1)},removeAllItems:function(){this.removeAllChildren()},getItem:function(t){return t<0||t>=this._items.length?null:this._items[t]},getItems:function(){return this._items},getIndex:function(t){return null==t?-1:this._items.indexOf(t)},setGravity:function(t){this._gravity!==t&&(this._gravity=t,this._refreshViewDirty=!0)},setMagneticType:function(t){this._magneticType=t,this._onItemListChanged(),this._startMagneticScroll()},getMagneticType:function(){return this._magneticType},setMagneticAllowedOutOfBoundary:function(t){this._magneticAllowedOutOfBoundary=t},getMagneticAllowedOutOfBoundary:function(){return this._magneticAllowedOutOfBoundary},setItemsMargin:function(t){this._itemsMargin!==t&&(this._itemsMargin=t,this._refreshViewDirty=!0)},getItemsMargin:function(){return this._itemsMargin},setDirection:function(t){switch(t){case ccui.ScrollView.DIR_VERTICAL:this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);break;case ccui.ScrollView.DIR_HORIZONTAL:this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);break;case ccui.ScrollView.DIR_BOTH:return;default:return}ccui.ScrollView.prototype.setDirection.call(this,t)},_getHowMuchOutOfBoundary:function(t){if(void 0===t&&(t=cc.p(0,0)),!this._magneticAllowedOutOfBoundary||0===this._items.length)return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(this,t);if(this._magneticType===ccui.ListView.MAGNETIC_NONE||this._magneticType===ccui.ListView.MAGNETIC_BOTH_END)return ccui.ScrollView.prototype._getHowMuchOutOfBoundary.call(this,t);if(0===t.x&&0===t.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=this._leftBoundary,i=this._rightBoundary,n=this._topBoundary,r=this._bottomBoundary,o=this._items.length-1,s=this.getContentSize(),c=cc.p(0,0),a=cc.p(0,0);switch(this._magneticType){case ccui.ListView.MAGNETIC_CENTER:c.x=(s.width-this._items[0].width)/2,c.y=(s.height-this._items[0].height)/2,a.x=(s.width-this._items[o].width)/2,a.y=(s.height-this._items[o].height)/2;break;case ccui.ListView.MAGNETIC_LEFT:case ccui.ListView.MAGNETIC_TOP:a.x=s.width-this._items[o].width,a.y=s.height-this._items[o].height;break;case ccui.ListView.MAGNETIC_RIGHT:case ccui.ListView.MAGNETIC_BOTTOM:c.x=s.width-this._items[0].width,c.y=s.height-this._items[0].height}e+=c.x,i-=a.x,n-=c.y,r+=a.y;var l=cc.p(0,0);return this._innerContainer.getLeftBoundary()+t.x>e?l.x=e-(this._innerContainer.getLeftBoundary()+t.x):this._innerContainer.getRightBoundary()+t.x<i&&(l.x=i-(this._innerContainer.getRightBoundary()+t.x)),this._innerContainer.getTopBoundary()+t.y<n?l.y=n-(this._innerContainer.getTopBoundary()+t.y):this._innerContainer.getBottomBoundary()+t.y>r&&(l.y=r-(this._innerContainer.getBottomBoundary()+t.y)),0===t.x&&0===t.y&&(this._outOfBoundaryAmount=l,this._outOfBoundaryAmountDirty=!1),l},_calculateItemPositionWithAnchor:function(t,e){var i=cc.p(t.getLeftBoundary(),t.getBottomBoundary()),n=t.getContentSize();return cc.p(i.x+n.width*e.x,i.y+n.height*e.y)},_findClosestItem:function(t,e,i,n,r,o,s){if(cc.assert(n>=0&&o<e.length&&n<=o,""),n===o)return e[n];if(o-n===1)return r<=s?e[n]:e[o];var c=Math.floor((n+o)/2),a=this._calculateItemPositionWithAnchor(e[c],i),l=cc.pLength(cc.pSub(t,a));return r<=s?this._findClosestItem(t,e,i,n,r,c,l):this._findClosestItem(t,e,i,c,l,o,s)},getClosestItemToPosition:function(t,e){if(0===this._items.length)return null;var i=0,n=this._calculateItemPositionWithAnchor(this._items[i],e),r=cc.pLength(cc.pSub(t,n)),o=this._items.length-1,s=this._calculateItemPositionWithAnchor(this._items[o],e),c=cc.pLength(cc.pSub(t,s));return this._findClosestItem(t,this._items,e,i,r,o,c)},getClosestItemToPositionInCurrentView:function(t,e){var i=this.getContentSize(),n=cc.pMult(this._innerContainer.getPosition(),-1);return n.x+=i.width*t.x,n.y+=i.height*t.y,this.getClosestItemToPosition(n,e)},getCenterItemInCurrentView:function(){return this.getClosestItemToPositionInCurrentView(cc.p(.5,.5),cc.p(.5,.5))},getLeftmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_HORIZONTAL?this.getClosestItemToPositionInCurrentView(cc.p(0,.5),cc.p(.5,.5)):null},getRightmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_HORIZONTAL?this.getClosestItemToPositionInCurrentView(cc.p(1,.5),cc.p(.5,.5)):null},getTopmostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?this.getClosestItemToPositionInCurrentView(cc.p(.5,1),cc.p(.5,.5)):null},getBottommostItemInCurrentView:function(){return this._direction===ccui.ScrollView.DIR_VERTICAL?this.getClosestItemToPositionInCurrentView(cc.p(.5,0),cc.p(.5,.5)):null},_calculateItemDestination:function(t,e,i){var n=this.getContentSize(),r=cc.p(0,0);r.x+=n.width*t.x,r.y+=n.height*t.y;var o=this._calculateItemPositionWithAnchor(e,i);return cc.pMult(cc.pSub(o,r),-1)},jumpToBottom:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottom.call(this)},jumpToTop:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTop.call(this)},jumpToLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToLeft.call(this)},jumpToRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToRight.call(this)},jumpToTopLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTopLeft.call(this)},jumpToTopRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToTopRight.call(this)},jumpToBottomLeft:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottomLeft.call(this)},jumpToBottomRight:function(){this.doLayout(),ccui.ScrollView.prototype.jumpToBottomRight.call(this)},jumpToPercentVertical:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentVertical.call(this,t)},jumpToPercentHorizontal:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentHorizontal.call(this,t)},jumpToPercentBothDirection:function(t){this.doLayout(),ccui.ScrollView.prototype.jumpToPercentBothDirection.call(this,t)},jumpToItem:function(t,e,i){var n=this.getItem(t);if(n){this.doLayout();var r=this._calculateItemDestination(e,n,i);if(!this.bounceEnabled){var o=cc.pSub(r,this._innerContainer.getPosition()),s=this._getHowMuchOutOfBoundary(o);r.x+=s.x,r.y+=s.y}this._jumpToDestination(r)}},scrollToItem:function(t,e,i,n){void 0===n&&(n=1);var r=this.getItem(t);if(r){var o=this._calculateItemDestination(e,r,i);this._startAutoScrollToDestination(o,n,!0)}},requestRefreshView:function(){this._refreshViewDirty=!0},refreshView:function(){this.forceDoLayout()},doLayout:function(){this._doLayout()},requestDoLayout:function(){this._refreshViewDirty=!0},_doLayout:function(){if(this._refreshViewDirty){for(var t=this._items,e=0;e<t.length;e++){var i=t[e];i.setLocalZOrder(e),this._remedyLayoutParameter(i)}this._updateInnerContainerSize(),this._innerContainer.forceDoLayout(),this._refreshViewDirty=!1}},addEventListenerListView:function(t,e){this._listViewEventListener=e,this._listViewEventSelector=t},addEventListener:function(t){this._ccListViewEventCallback=t},_selectedItemEvent:function(t){var e=t===ccui.Widget.TOUCH_BEGAN?ccui.ListView.ON_SELECTED_ITEM_START:ccui.ListView.ON_SELECTED_ITEM_END;this._listViewEventSelector&&(this._listViewEventListener?this._listViewEventSelector.call(this._listViewEventListener,this,e):this._listViewEventSelector(this,e)),this._ccListViewEventCallback&&this._ccListViewEventCallback(this,e)},interceptTouchEvent:function(t,e,i){if(ccui.ScrollView.prototype.interceptTouchEvent.call(this,t,e,i),this._touchEnabled&&t!==ccui.Widget.TOUCH_MOVED){for(var n=e;n;){if(n&&n.getParent()===this._innerContainer){this._curSelectedIndex=this.getIndex(n);break}n=n.getParent()}e.isHighlighted()&&this._selectedItemEvent(t)}},getCurSelectedIndex:function(){return this._curSelectedIndex},_onSizeChanged:function(){ccui.ScrollView.prototype._onSizeChanged.call(this),this._refreshViewDirty=!0},getDescription:function(){return"ListView"},_createCloneInstance:function(){return new ccui.ListView},_copyClonedWidgetChildren:function(t){for(var e=t.getItems(),i=0;i<e.length;i++){var n=e[i];this.pushBackCustomItem(n.clone())}},_copySpecialProperties:function(t){t instanceof ccui.ListView&&(ccui.ScrollView.prototype._copySpecialProperties.call(this,t),this.setItemModel(t._model),this.setItemsMargin(t._itemsMargin),this.setGravity(t._gravity),this._listViewEventListener=t._listViewEventListener,this._listViewEventSelector=t._listViewEventSelector)},_startAttenuatingAutoScroll:function(t,e){var i=t;if(0!==this._items.length&&this._magneticType!==ccui.ListView.MAGNETIC_NONE){i=this._flattenVectorByDirection(i);var n=this._getHowMuchOutOfBoundary(i);if(0===n.x&&0===n.y){var r=this._magneticType;r===ccui.ListView.MAGNETIC_BOTH_END&&(this._direction===ccui.ScrollView.DIR_HORIZONTAL?r=i.x>0?ccui.ListView.MAGNETIC_LEFT:ccui.ListView.MAGNETIC_RIGHT:this._direction===ccui.ScrollView.DIR_VERTICAL&&(r=i.y>0?ccui.ListView.MAGNETIC_BOTTOM:ccui.ListView.MAGNETIC_TOP));var o=this._getAnchorPointByMagneticType(r),s=cc.pMult(this._innerContainer.getPosition(),-1);s.x+=this.width*o.x,s.y+=this.height*o.y;var c=this.getClosestItemToPosition(cc.pSub(s,i),o),a=this._calculateItemPositionWithAnchor(c,o);i=cc.pSub(s,a)}}ccui.ScrollView.prototype._startAttenuatingAutoScroll.call(this,i,e)},_getAnchorPointByMagneticType:function(t){switch(t){case ccui.ListView.MAGNETIC_NONE:return cc.p(0,0);case ccui.ListView.MAGNETIC_BOTH_END:return cc.p(0,1);case ccui.ListView.MAGNETIC_CENTER:return cc.p(.5,.5);case ccui.ListView.MAGNETIC_LEFT:return cc.p(0,.5);case ccui.ListView.MAGNETIC_RIGHT:return cc.p(1,.5);case ccui.ListView.MAGNETIC_TOP:return cc.p(.5,1);case ccui.ListView.MAGNETIC_BOTTOM:return cc.p(.5,0)}return cc.p(0,0)},_startMagneticScroll:function(){if(0!==this._items.length&&this._magneticType!==ccui.ListView.MAGNETIC_NONE){var t=this._getAnchorPointByMagneticType(this._magneticType),e=cc.pMult(this._innerContainer.getPosition(),-1);e.x+=this.width*t.x,e.y+=this.height*t.y;var i=this.getClosestItemToPosition(e,t);this.scrollToItem(this.getIndex(i),t,t)}}}),ccui.ListView.create=function(){return new ccui.ListView},ccui.ListView.EVENT_SELECTED_ITEM=0,ccui.ListView.ON_SELECTED_ITEM_START=0,ccui.ListView.ON_SELECTED_ITEM_END=1,ccui.ListView.GRAVITY_LEFT=0,ccui.ListView.GRAVITY_RIGHT=1,ccui.ListView.GRAVITY_CENTER_HORIZONTAL=2,ccui.ListView.GRAVITY_TOP=3,ccui.ListView.GRAVITY_BOTTOM=4,ccui.ListView.GRAVITY_CENTER_VERTICAL=5,ccui.ListView.MAGNETIC_NONE=0,ccui.ListView.MAGNETIC_CENTER=1,ccui.ListView.MAGNETIC_BOTH_END=2,ccui.ListView.MAGNETIC_LEFT=3,ccui.ListView.MAGNETIC_RIGHT=4,ccui.ListView.MAGNETIC_TOP=5,ccui.ListView.MAGNETIC_BOTTOM=6,ccui.PageView=ccui.ListView.extend({_curPageIdx:0,_childFocusCancelOffset:0,_pageViewEventListener:null,_pageViewEventSelector:null,_className:"PageView",_indicator:null,_indicatorPositionAsAnchorPoint:null,ctor:function(){ccui.ListView.prototype.ctor.call(this),this._childFocusCancelOffset=5,this._indicatorPositionAsAnchorPoint=cc.p(.5,.1),this._pageViewEventListener=null,this._pageViewEventSelector=null,this.setDirection(ccui.ScrollView.DIR_HORIZONTAL),this.setMagneticType(ccui.ListView.MAGNETIC_CENTER),this.setScrollBarEnabled(!1)},addWidgetToPage:function(t,e,i){this.insertCustomItem(t,e)},addPage:function(t){this.pushBackCustomItem(t)},insertPage:function(t,e){this.insertCustomItem(t,e)},removePage:function(t){this.removeItem(this.getIndex(t))},removePageAtIndex:function(t){this.removeItem(t)},removeAllPages:function(){this.removeAllItems()},scrollToItem:function(t){ccui.ListView.prototype.scrollToItem.call(this,t,cc.p(.5,.5),cc.p(.5,.5))},scrollToPage:function(t){this.scrollToItem(t)},_doLayout:function(){if(this._refreshViewDirty){if(ccui.ListView.prototype._doLayout.call(this),this._indicator){var t=this.getIndex(this.getCenterItemInCurrentView());this._indicator.indicate(t)}this._refreshViewDirty=!1}},setDirection:function(t){ccui.ListView.prototype.setDirection.call(this,t),t===ccui.ScrollView.DIR_HORIZONTAL?this._indicatorPositionAsAnchorPoint=cc.p(.5,.1):t===ccui.ScrollView.DIR_VERTICAL&&(this._indicatorPositionAsAnchorPoint=cc.p(.1,.5)),this._indicator&&(this._indicator.setDirection(t),this._refreshIndicatorPosition())},setCustomScrollThreshold:function(t){},getCustomScrollThreshold:function(){return 0},setUsingCustomScrollThreshold:function(t){},isUsingCustomScrollThreshold:function(){return!1},_moveInnerContainer:function(t,e){ccui.ListView.prototype._moveInnerContainer.call(this,t,e),this._curPageIdx=this.getIndex(this.getCenterItemInCurrentView()),this._indicator&&this._indicator.indicate(this._curPageIdx)},_onItemListChanged:function(){ccui.ListView.prototype._onItemListChanged.call(this),this._indicator&&this._indicator.reset(this._items.length)},_onSizeChanged:function(){ccui.ListView.prototype._onSizeChanged.call(this),this._refreshIndicatorPosition()},_remedyLayoutParameter:function(t){t.setContentSize(this.getContentSize()),ccui.ListView.prototype._remedyLayoutParameter.call(this,t)},_refreshIndicatorPosition:function(){if(this._indicator){var t=this.getContentSize(),e=t.width*this._indicatorPositionAsAnchorPoint.x,i=t.height*this._indicatorPositionAsAnchorPoint.y;this._indicator.setPosition(cc.p(e,i))}},_handleReleaseLogic:function(t){if(ccui.ScrollView.prototype._handleReleaseLogic.call(this,t),!(this._items.length<=0)){var e=this._flattenVectorByDirection(this._calculateTouchMoveVelocity()),i=500;if(cc.pLength(e)<i)this._startMagneticScroll();else{var n=this.getItem(this._curPageIdx),r=this._calculateItemDestination(cc.p(.5,.5),n,cc.p(.5,.5)),o=cc.pSub(r,this.getInnerContainerPosition());o=this._flattenVectorByDirection(o),e.x*o.x>0||e.y*o.y>0?this._startMagneticScroll():(e.x<0||e.y>0?++this._curPageIdx:--this._curPageIdx,this._curPageIdx=Math.min(this._curPageIdx,this._items.length),this._curPageIdx=Math.max(this._curPageIdx,0),this.scrollToItem(this._curPageIdx))}}},_getAutoScrollStopEpsilon:function(){return.001},_pageTurningEvent:function(){this._pageViewEventSelector&&(this._pageViewEventListener?this._pageViewEventSelector.call(this._pageViewEventListener,this,ccui.PageView.EVENT_TURNING):this._pageViewEventSelector(this,ccui.PageView.EVENT_TURNING)),this._ccEventCallback&&this._ccEventCallback(this,ccui.PageView.EVENT_TURNING)},addEventListenerPageView:function(t,e){this._pageViewEventSelector=t,this._pageViewEventListener=e},addEventListener:function(t){this._ccEventCallback=function(e,i){i==ccui.ScrollView.EVENT_AUTOSCROLL_ENDED&&t(this,i)}},setCurrentPageIndex:function(t){this.jumpToItem(t,cc.p(.5,.5),cc.p(.5,.5))},setCurPageIndex:function(t){this.setCurrentPageIndex(t)},getCurrentPageIndex:function(){return this._curPageIdx},getCurPageIndex:function(){var t=this.getCenterItemInCurrentView();return this.getIndex(t)},getPages:function(){return this.getItems()},getPage:function(t){return this.getItem(t)},getDescription:function(){return"PageView"},_createCloneInstance:function(){return new ccui.PageView},_copyClonedWidgetChildren:function(t){for(var e=t.getPages(),i=0;i<e.length;i++){var n=e[i];this.addPage(n.clone())}},_copySpecialProperties:function(t){ccui.ListView.prototype._copySpecialProperties.call(this,t),this._ccEventCallback=t._ccEventCallback,this._pageViewEventListener=t._pageViewEventListener,this._pageViewEventSelector=t._pageViewEventSelector,this._customScrollThreshold=t._customScrollThreshold},setIndicatorEnabled:function(t){t!=(null!==this._indicator)&&(t?(this._indicator=new ccui.PageViewIndicator,this._indicator.setDirection(this.getDirection()),this.addProtectedChild(this._indicator,1e4),this.setIndicatorSelectedIndexColor(cc.color(100,100,255)),this._refreshIndicatorPosition()):(this.removeProtectedChild(this._indicator),this._indicator=null))},getIndicatorEnabled:function(){return null!==this._indicator},setIndicatorPositionAsAnchorPoint:function(t){this._indicatorPositionAsAnchorPoint=t,this._refreshIndicatorPosition()},getIndicatorPositionAsAnchorPoint:function(){return this._indicatorPositionAsAnchorPoint},setIndicatorPosition:function(t){if(this._indicator){var e=this.getContentSize();this._indicatorPositionAsAnchorPoint.x=t.x/e.width,this._indicatorPositionAsAnchorPoint.y=t.y/e.height,this._indicator.setPosition(t)}},getIndicatorPosition:function(){return cc.assert(null!==this._indicator,""),this._indicator.getPosition()},setIndicatorSpaceBetweenIndexNodes:function(t){this._indicator&&this._indicator.setSpaceBetweenIndexNodes(t)},getIndicatorSpaceBetweenIndexNodes:function(){return cc.assert(null!==this._indicator,""),this._indicator.getSpaceBetweenIndexNodes()},setIndicatorSelectedIndexColor:function(t){this._indicator&&this._indicator.setSelectedIndexColor(t)},getIndicatorSelectedIndexColor:function(){return cc.assert(null!==this._indicator,""),this._indicator.getSelectedIndexColor()},setIndicatorIndexNodesColor:function(t){this._indicator&&this._indicator.setIndexNodesColor(t)},getIndicatorIndexNodesColor:function(){return cc.assert(null!==this._indicator,""),this._indicator.getIndexNodesColor()},setIndicatorIndexNodesScale:function(t){this._indicator&&(this._indicator.setIndexNodesScale(t),this._indicator.indicate(this._curPageIdx))},getIndicatorIndexNodesScale:function(){return cc.assert(null!==this._indicator,""),this._indicator.getIndexNodesScale()},setIndicatorIndexNodesTexture:function(t,e){this._indicator&&(this._indicator.setIndexNodesTexture(t,e),this._indicator.indicate(this._curPageIdx))}}),ccui.PageView.create=function(){return new ccui.PageView},ccui.PageView.EVENT_TURNING=0,ccui.PageView.TOUCH_DIR_LEFT=0,ccui.PageView.TOUCH_DIR_RIGHT=1,ccui.PageView.DIRECTION_LEFT=0,ccui.PageView.DIRECTION_RIGHT=1,ccui.PageViewIndicator=ccui.ProtectedNode.extend({_direction:null,_indexNodes:null,_currentIndexNode:null,_spaceBetweenIndexNodes:0,_indexNodesScale:1,_indexNodesColor:null,_useDefaultTexture:!0,_indexNodesTextureFile:"",_indexNodesTexType:ccui.Widget.LOCAL_TEXTURE,_className:"PageViewIndicator",ctor:function(){cc.ProtectedNode.prototype.ctor.call(this),this._direction=ccui.ScrollView.DIR_HORIZONTAL,this._indexNodes=[],this._spaceBetweenIndexNodes=ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT,this._indexNodesColor=cc.color.WHITE,this._currentIndexNode=ccui.helper._createSpriteFromBase64(ccui.PageViewIndicator.CIRCLE_IMAGE,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY),this._currentIndexNode.setVisible(!1),this.addProtectedChild(this._currentIndexNode,1)},setDirection:function(t){this._direction=t,this._rearrange()},reset:function(t){for(;this._indexNodes.length<t;)this._increaseNumberOfPages();for(;this._indexNodes.length>t;)this._decreaseNumberOfPages();this._rearrange(),this._currentIndexNode.setVisible(this._indexNodes.length>0)},indicate:function(t){t<0||t>=this._indexNodes.length||this._currentIndexNode.setPosition(this._indexNodes[t].getPosition())},_rearrange:function(){if(0!==this._indexNodes.length)for(var t=this._direction===ccui.ScrollView.DIR_HORIZONTAL,e=this._indexNodes[0].getContentSize(),i=t?e.width:e.height,n=this._indexNodes.length,r=i*n+this._spaceBetweenIndexNodes*(n-1),o=-(r/2)+i/2,s=0;s<this._indexNodes.length;++s){var c;c=t?cc.p(o,e.height/2):cc.p(e.width/2,-o),this._indexNodes[s].setPosition(c),o+=i+this._spaceBetweenIndexNodes}},setSpaceBetweenIndexNodes:function(t){this._spaceBetweenIndexNodes!==t&&(this._spaceBetweenIndexNodes=t,this._rearrange())},getSpaceBetweenIndexNodes:function(){return this._spaceBetweenIndexNodes},setSelectedIndexColor:function(t){this._currentIndexNode.setColor(t)},getSelectedIndexColor:function(){return this._currentIndexNode.getColor()},setIndexNodesColor:function(t){this._indexNodesColor=t;for(var e=0;e<this._indexNodes.length;++e)this._indexNodes[e].setColor(t)},getIndexNodesColor:function(){var t=this._indexNodesColor;return cc.color(t.r,t.g,t.b,t.a)},setIndexNodesScale:function(t){if(this._indexNodesScale!==t){this._indexNodesScale=t,this._currentIndexNode.setScale(t);for(var e=0;e<this._indexNodes.length;++e)this._indexNodes[e].setScale(this,_indexNodesScale);this._rearrange()}},getIndexNodesScale:function(){return this._indexNodesScale},setIndexNodesTexture:function(t,e){switch(void 0===e&&(e=ccui.Widget.LOCAL_TEXTURE),this._useDefaultTexture=!1,this._indexNodesTextureFile=t,this._indexNodesTexType=e,e){case ccui.Widget.LOCAL_TEXTURE:this._currentIndexNode.setTexture(t);for(var i=0;i<this._indexNodes.length;++i)this._indexNodes[i].setTexture(t);break;case ccui.Widget.PLIST_TEXTURE:this._currentIndexNode.setSpriteFrame(t);for(var i=0;i<this._indexNodes.length;++i)this._indexNodes[i].setSpriteFrame(t)}this._rearrange()},_increaseNumberOfPages:function(){var t;if(this._useDefaultTexture)t=ccui.helper._createSpriteFromBase64(ccui.PageViewIndicator.CIRCLE_IMAGE,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY);else switch(t=new cc.Sprite,this._indexNodesTexType){case ccui.Widget.LOCAL_TEXTURE:t.initWithFile(this._indexNodesTextureFile);break;case ccui.Widget.PLIST_TEXTURE:t.initWithSpriteFrameName(this._indexNodesTextureFile)}t.setColor(this._indexNodesColor),t.setScale(this._indexNodesScale),this.addProtectedChild(t),this._indexNodes.push(t)},_decreaseNumberOfPages:function(){0!==this._indexNodes.length&&(this.removeProtectedChild(this._indexNodes[0]),this._indexNodes.splice(0,1))},clear:function(){for(var t=0;t<this._indexNodes.length;++t)this.removeProtectedChild(this._indexNodes[t]);this._indexNodes.length=0,this._currentIndexNode.setVisible(!1)}});var _p=ccui.PageViewIndicator.prototype;_p.spaceBetweenIndexNodes,cc.defineGetterSetter(_p,"spaceBetweenIndexNodes",_p.getSpaceBetweenIndexNodes,_p.setSpaceBetweenIndexNodes),ccui.PageViewIndicator.SPACE_BETWEEN_INDEX_NODES_DEFAULT=23,ccui.PageViewIndicator.CIRCLE_IMAGE_KEY="/__circle_image",ccui.PageViewIndicator.CIRCLE_IMAGE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAA8ElEQVRIx62VyRGCQBBF+6gWRCEmYDIQkhiBCgHhSclC8YqWzOV5oVzKAYZp3r1/9fpbxAIBMTsKrjx5cqVgR0wgLhCRUWOjJiPqD56xoaGPhpRZV/iSEy6crHmw5oIrF9b/lVeMofrJgjlnxlIy/wik+JB+mme8BExbBhm+5CJC2LE2LtSEQoyGWDioBA5CoRIohJtK4CYDxzNEM4GAugR1E9VjVC+SZpXvhCJCrjomESLvc17pDGX7bWmlh6UtpjPVCWy9zaJ0TD7qfm3pwERMz2trRVZk3K3BD/L34AY+dEDCniMVBkPFkT2J/b2/AIV+dRpFLOYoAAAAAElFTkSuQmCC",ccui.VideoPlayer=ccui.Widget.extend({_played:!1,_playing:!1,_stopped:!0,ctor:function(t){ccui.Widget.prototype.ctor.call(this),this._EventList={},t&&this.setURL(t)},_createRenderCmd:function(){return new ccui.VideoPlayer.RenderCmd(this)},setURL:function(t){this._renderCmd.updateURL(t)},getURL:function(){return this._renderCmd._url},play:function(){var t=this,e=this._renderCmd._video;e&&(this._played=!0,e.pause(),this._stopped===!1&&this._playing===!1&&this._played===!0||(e.currentTime=0),ccui.VideoPlayer._polyfill.autoplayAfterOperation?setTimeout(function(){e.play(),t._playing=!0,t._stopped=!1},20):(e.play(),this._playing=!0,this._stopped=!1))},pause:function(){var t=this._renderCmd._video;t&&this._playing===!0&&this._stopped===!1&&(t.pause(),this._playing=!1)},resume:function(){this._stopped===!1&&this._playing===!1&&this._played===!0&&this.play()},stop:function(){var t=this,e=this._renderCmd._video;e&&(e.pause(),e.currentTime=0,this._playing=!1,this._stopped=!0),setTimeout(function(){t._dispatchEvent(ccui.VideoPlayer.EventType.STOPPED)},0)},seekTo:function(t){var e=this._renderCmd._video;e&&(e.currentTime=t,ccui.VideoPlayer._polyfill.autoplayAfterOperation&&this.isPlaying()&&setTimeout(function(){e.play()},20))},isPlaying:function(){return ccui.VideoPlayer._polyfill.autoplayAfterOperation&&this._playing&&setTimeout(function(){video.play()},20),this._playing},setKeepAspectRatioEnabled:function(t){cc.log("On the web is always keep the aspect ratio")},isKeepAspectRatioEnabled:function(){return!1},setFullScreenEnabled:function(t){var e=this._renderCmd._video;e&&(t?cc.screen.requestFullScreen(e):cc.screen.exitFullScreen(e))},isFullScreenEnabled:function(){cc.log("Can't know status")},setEventListener:function(t,e){this._EventList[t]=e},removeEventListener:function(t){this._EventList[t]=null},_dispatchEvent:function(t){var e=this._EventList[t];e&&e.call(this,this,this._renderCmd._video.src)},onPlayEvent:function(){var t=this._EventList[ccui.VideoPlayer.EventType.PLAYING];if(t)for(var e=0;e<t.length;e++)t[e].call(this,this,this._renderCmd._video.src)},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),void 0===e&&(e=t.height,t=t.width),this._renderCmd.changeSize(t,e)},cleanup:function(){this._renderCmd.removeDom(),this.stopAllActions(),this.unscheduleAllCallbacks()},onEnter:function(){ccui.Widget.prototype.onEnter.call(this);var t=ccui.VideoPlayer.elements;t.indexOf(this)===-1&&t.push(this)},onExit:function(){ccui.Widget.prototype.onExit.call(this);var t=ccui.VideoPlayer.elements,e=t.indexOf(this);e!==-1&&t.splice(e,1)}}),ccui.VideoPlayer.elements=[],ccui.VideoPlayer.pauseElements=[],cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){for(var t,e=ccui.VideoPlayer.elements,i=0;i<e.length;i++)t=e[i],e[i]._playing&&(t.pause(),ccui.VideoPlayer.pauseElements.push(t))}),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){for(var t=ccui.VideoPlayer.pauseElements,e=t.pop();e;)e.play(),e=t.pop()}),ccui.VideoPlayer.EventType={PLAYING:"play",PAUSED:"pause",STOPPED:"stop",COMPLETED:"complete"},function(t){t._polyfill={devicePixelRatio:!1,event:"canplay",canPlayType:[]},function(){var e=document.createElement("video");e.canPlayType("video/ogg")&&(t._polyfill.canPlayType.push(".ogg"),t._polyfill.canPlayType.push(".ogv")),e.canPlayType("video/mp4")&&t._polyfill.canPlayType.push(".mp4"),e.canPlayType("video/webm")&&t._polyfill.canPlayType.push(".webm")}(),cc.sys.OS_IOS===cc.sys.os&&(t._polyfill.devicePixelRatio=!0,t._polyfill.event="progress"),cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX&&(t._polyfill.autoplayAfterOperation=!0);var e=document.createElement("style");e.innerHTML=".cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}",document.head.appendChild(e)}(ccui.VideoPlayer),function(t){var e=null;e=cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.Node.WebGLRenderCmd:cc.Node.CanvasRenderCmd,ccui.VideoPlayer.RenderCmd=function(t){e.call(this,t),this._listener=null,this._url="",this.initStyle()};var i=ccui.VideoPlayer.RenderCmd.prototype=Object.create(e.prototype);i.constructor=ccui.VideoPlayer.RenderCmd,i.visit=function(){var t=this,e=cc.container,i=cc.eventManager;if(this._node._visible)e.appendChild(this._video),null===this._listener&&(this._listener=cc.eventManager.addCustomListener(cc.game.EVENT_RESIZE,function(){t.resize()}));else{var n=!1;n="contains"in e?e.contains(this._video):e.compareDocumentPosition(this._video)%16,n&&e.removeChild(this._video),i.removeListener(this._listener),this._listener=null}this.updateStatus()},i.transform=function(t,e){this.originTransform(t,e),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY)},i.updateStatus=function(){t.devicePixelRatio=cc.view.isRetinaEnabled();var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag),i&e.orderDirty&&(this._dirtyFlag=this._dirtyFlag&e.orderDirty^this._dirtyFlag)},i.resize=function(t){t=t||cc.view;var e=this._node,i=cc.eventManager;e._parent&&e._visible?this.updateMatrix(this._worldTransform,t._scaleX,t._scaleY):(i.removeListener(this._listener),this._listener=null)},i.updateMatrix=function(e,i,n){var r=this._node;if(t.devicePixelRatio){var o=cc.view.getDevicePixelRatio();i/=o,n/=o}if(this._loaded!==!1){var s=r._contentSize.width,c=r._contentSize.height,a=e.a*i,l=e.b,h=e.c,u=e.d*n,d=e.tx*i-s/2+s*r._scaleX/2*i,_=e.ty*n-c/2+c*r._scaleY/2*n,p="matrix("+a+","+l+","+h+","+u+","+d+","+-_+")";this._video.style.transform=p,this._video.style["-webkit-transform"]=p}},i.updateURL=function(e){var i,n,r,o,s,c=this._node;if(this._url!=e){this._url=e,cc.loader.resPath&&!/^http/.test(e)&&(e=cc.path.join(cc.loader.resPath,e)),r=!1,o=cc.container,r="contains"in o?o.contains(this._video):o.compareDocumentPosition(this._video)%16,r&&o.removeChild(this._video),this._video=document.createElement("video"),n=this._video,this.bindEvent();var a=this,l=function(){1!=a._loaded&&(a._loaded=!0,a.changeSize(),a.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),n.removeEventListener(t.event,l),n.currentTime=0,n.style.visibility="visible",n.play(),c._played||(n.pause(),n.currentTime=0))};n.addEventListener(t.event,l),n.preload="metadata",n.style.visibility="hidden",this._loaded=!1,c._played=!1,c._playing=!1,c._stopped=!0,this.initStyle(),this.visit(),i=document.createElement("source"),i.src=e,n.appendChild(i),s=cc.path.extname(e);for(var h=0;h<t.canPlayType.length;h++)s!==t.canPlayType[h]&&(i=document.createElement("source"),i.src=e.replace(s,t.canPlayType[h]),n.appendChild(i))}},i.bindEvent=function(){var t=this,e=this._node,i=this._video;i.addEventListener("ended",function(){e._renderCmd.updateMatrix(t._worldTransform,cc.view._scaleX,cc.view._scaleY),e._playing=!1,e._dispatchEvent(ccui.VideoPlayer.EventType.COMPLETED)}),i.addEventListener("play",function(){e._dispatchEvent(ccui.VideoPlayer.EventType.PLAYING)}),i.addEventListener("pause",function(){e._dispatchEvent(ccui.VideoPlayer.EventType.PAUSED)})},i.initStyle=function(){if(this._video){var t=this._video;t.style.position="absolute",t.style.bottom="0px",t.style.left="0px",t.className="cocosVideo"}},i.changeSize=function(t,e){var i=this._node._contentSize;t=t||i.width,e=e||i.height;var n=this._video;n&&(0!==t&&(n.width=t),0!==e&&(n.height=e))},i.removeDom=function(){var t=this._video;if(t){var e=!1;e="contains"in cc.container?cc.container.contains(t):cc.container.compareDocumentPosition(t)%16,e&&cc.container.removeChild(t)}}}(ccui.VideoPlayer._polyfill),ccui.WebView=ccui.Widget.extend({ctor:function(t){ccui.Widget.prototype.ctor.call(this),this._EventList={},t&&this.loadURL(t)},setJavascriptInterfaceScheme:function(t){},loadData:function(t,e,i,n){},loadHTMLString:function(t,e){},loadURL:function(t){this._renderCmd.updateURL(t),this._dispatchEvent(ccui.WebView.EventType.LOADING)},stopLoading:function(){cc.log("Web does not support loading")},reload:function(){var t=this._renderCmd._iframe;if(t){var e=t.contentWindow;e&&e.location&&e.location.reload()}},canGoBack:function(){return cc.log("Web does not support query history"),!0},canGoForward:function(){return cc.log("Web does not support query history"),!0},goBack:function(){try{if(ccui.WebView._polyfill.closeHistory)return cc.log("The current browser does not support the GoBack");var t=this._renderCmd._iframe;if(t){var e=t.contentWindow;if(e&&e.location)try{e.history.back.call(e)}catch(t){e.history.back()}}}catch(t){cc.log(t)}},goForward:function(){try{if(ccui.WebView._polyfill.closeHistory)return cc.log("The current browser does not support the GoForward");var t=this._renderCmd._iframe;if(t){var e=t.contentWindow;if(e&&e.location)try{e.history.forward.call(e)}catch(t){e.history.forward()}}}catch(t){cc.log(t)}},evaluateJS:function(t){var e=this._renderCmd._iframe;if(e){var i=e.contentWindow;try{i.eval(t),this._dispatchEvent(ccui.WebView.EventType.JS_EVALUATED)}catch(t){console.error(t)}}},setScalesPageToFit:function(){cc.log("Web does not support zoom")},setEventListener:function(t,e){this._EventList[t]=e},removeEventListener:function(t){this._EventList[t]=null},_dispatchEvent:function(t){var e=this._EventList[t];e&&e.call(this,this,this._renderCmd._iframe.src)},_createRenderCmd:function(){return new ccui.WebView.RenderCmd(this)},setContentSize:function(t,e){ccui.Widget.prototype.setContentSize.call(this,t,e),void 0===e&&(e=t.height,t=t.width),this._renderCmd.changeSize(t,e)},cleanup:function(){this._renderCmd.removeDom(),this.stopAllActions(),this.unscheduleAllCallbacks()}}),ccui.WebView.EventType={LOADING:"loading",LOADED:"load",ERROR:"error",JS_EVALUATED:"js"},function(){var t=ccui.WebView._polyfill={devicePixelRatio:!1,enableDiv:!1};cc.sys.os===cc.sys.OS_IOS&&(t.enableDiv=!0),cc.sys.isMobile?cc.sys.browserType===cc.sys.BROWSER_TYPE_FIREFOX&&(t.enableBG=!0):cc.sys.browserType===cc.sys.BROWSER_TYPE_IE&&(t.closeHistory=!0)}(),function(t){var e=null;e=cc._renderType===cc.game.RENDER_TYPE_WEBGL?cc.Node.WebGLRenderCmd:cc.Node.CanvasRenderCmd,ccui.WebView.RenderCmd=function(i){e.call(this,i),this._div=null,this._iframe=null,t.enableDiv?(this._div=document.createElement("div"),this._div.style["-webkit-overflow"]="auto",this._div.style["-webkit-overflow-scrolling"]="touch",this._iframe=document.createElement("iframe"),this._iframe.style.width="100%",this._iframe.style.height="100%",this._div.appendChild(this._iframe)):this._div=this._iframe=document.createElement("iframe"),t.enableBG&&(this._div.style.background="#FFF"),this._iframe.addEventListener("load",function(){i._dispatchEvent(ccui.WebView.EventType.LOADED)}),this._iframe.addEventListener("error",function(){i._dispatchEvent(ccui.WebView.EventType.ERROR)}),this._div.style.background="#FFF",this._div.style.height="200px",this._div.style.width="300px",this._div.style.overflow="scroll",this._listener=null,this.initStyle()};var i=ccui.WebView.RenderCmd.prototype=Object.create(e.prototype);i.constructor=ccui.WebView.RenderCmd,i.transform=function(t,e){this.originTransform(t,e),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY)},i.updateStatus=function(){t.devicePixelRatio=cc.view.isRetinaEnabled();var e=cc.Node._dirtyFlags,i=this._dirtyFlag;i&e.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this.updateMatrix(this._worldTransform,cc.view._scaleX,cc.view._scaleY),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag),i&e.orderDirty&&(this._dirtyFlag=this._dirtyFlag&e.orderDirty^this._dirtyFlag)},i.visit=function(){var t=this,e=cc.container,i=cc.eventManager;if(this._node._visible)e.appendChild(this._div),null===this._listener&&(this._listener=i.addCustomListener(cc.game.EVENT_RESIZE,function(){t.resize()}));else{var n=!1;n="contains"in e?e.contains(this._div):e.compareDocumentPosition(this._div)%16,n&&e.removeChild(this._div);var r=i._listenersMap[cc.game.EVENT_RESIZE].getFixedPriorityListeners();i._removeListenerInVector(r,this._listener),this._listener=null}this.updateStatus(),this.resize(cc.view)},i.resize=function(t){t=t||cc.view;var e=this._node,i=cc.eventManager;if(e._parent&&e._visible)this.updateMatrix(this._worldTransform,t._scaleX,t._scaleY);else{var n=i._listenersMap[cc.game.EVENT_RESIZE].getFixedPriorityListeners();i._removeListenerInVector(n,this._listener),this._listener=null}},i.updateMatrix=function(e,i,n){var r=this._node;if(t.devicePixelRatio&&1!==i&&1!==i){var o=cc.view.getDevicePixelRatio();i/=o,n/=o}if(this._loaded!==!1){var s=r._contentSize.width,c=r._contentSize.height,a=e.a*i,l=e.b,h=e.c,u=e.d*n,d=e.tx*i-s/2+s*r._scaleX/2*i,_=e.ty*n-c/2+c*r._scaleY/2*n,p="matrix("+a+","+l+","+h+","+u+","+d+","+-_+")";this._div.style.transform=p,this._div.style["-webkit-transform"]=p}},i.initStyle=function(){if(this._div){var t=this._div;t.style.position="absolute",t.style.bottom="0px",t.style.left="0px"}},i.updateURL=function(t){var e=this._iframe;e.src=t;var i=this,n=function(){i._loaded=!0,e.removeEventListener("load",n)};e.addEventListener("load",n)},i.changeSize=function(t,e){var i=this._div;i&&(i.style.width=t+"px",i.style.height=e+"px")},i.removeDom=function(){var t=this._div;if(t){var e=!1;e="contains"in cc.container?cc.container.contains(t):cc.container.compareDocumentPosition(t)%16,e&&cc.container.removeChild(t)}}}(ccui.WebView._polyfill);cc.Component=cc.Class.extend({_owner:null,_name:"",_enabled:!0,ctor:function(){this._owner=null,this._name="",this._enabled=!0},init:function(){return!0},onEnter:function(){},onExit:function(){},update:function(t){},serialize:function(t){},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t},getName:function(){return this._name},setName:function(t){this._name=t},setOwner:function(t){this._owner=t},getOwner:function(){return this._owner}}),cc.Component.create=function(){return new cc.Component},ccui.LayoutComponent_ReferencePoint={BOTTOM_LEFT:0,TOP_LEFT:1,BOTTOM_RIGHT:2,TOP_RIGHT:3},ccui.LayoutComponent_PositionType={Position:0,RelativePosition:1,PreRelativePosition:2,PreRelativePositionEnable:3},ccui.LayoutComponent_SizeType={Size:0,PreSize:1,PreSizeEnable:2},ccui.LayoutComponent=cc.Component.extend({_horizontalEdge:0,_verticalEdge:0,_leftMargin:0,_rightMargin:0,_bottomMargin:0,_topMargin:0,_usingPositionPercentX:!1,_positionPercentX:0,_usingPositionPercentY:!1,_positionPercentY:0,_usingStretchWidth:!1,_usingStretchHeight:!1,_percentWidth:0,_usingPercentWidth:!1,_percentHeight:0,_usingPercentHeight:!1,_actived:!0,_isPercentOnly:!1,ctor:function(){this._name=ccui.LayoutComponent.NAME},init:function(){var t=!0;return!!cc.Component.prototype.init.call(this)&&t},getPercentContentSize:function(){return cc.p(this._percentWidth,this._percentHeight)},setPercentContentSize:function(t){this.setPercentWidth(t.x),this.setPercentHeight(t.y)},setUsingPercentContentSize:function(t){this._usingPercentWidth=this._usingPercentHeight=t},SetActiveEnable:function(t){this._actived=t},getUsingPercentContentSize:function(){return this._usingPercentWidth&&this._usingPercentHeight},getAnchorPosition:function(){return this._owner.getAnchorPoint()},setAnchorPosition:function(t,e){var i=this._owner.getBoundingBox();this._owner.setAnchorPoint(t,e);var n=this._owner.getBoundingBox(),r=i.x-n.x,o=i.y-n.y,s=this._owner.getPosition();s.x+=r,s.y+=o,this.setPosition(s)},getPosition:function(){return this._owner.getPosition()},setPosition:function(t,e){var i,n=this._getOwnerParent();if(null!=n){void 0===e?(i=t.x,e=t.y):i=t;var r=n.getContentSize();0!==r.width?this._positionPercentX=i/r.width:(this._positionPercentX=0,this._usingPositionPercentX&&(i=0)),0!==r.height?this._positionPercentY=e/r.height:(this._positionPercentY=0,this._usingPositionPercentY&&(e=0)),this._owner.setPosition(i,e),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setPosition(t,e)},isPositionPercentXEnabled:function(){return this._usingPositionPercentX},setPositionPercentXEnabled:function(t){this._usingPositionPercentX=t,this._usingPositionPercentX&&(this._horizontalEdge=ccui.LayoutComponent.horizontalEdge.NONE)},getPositionPercentX:function(){return this._positionPercentX},setPositionPercentX:function(t){this._positionPercentX=t;var e=this._getOwnerParent();null!==e&&(this._owner.setPositionX(e.width*this._positionPercentX),this._refreshHorizontalMargin())},isPositionPercentYEnabled:function(){return this._usingPositionPercentY},setPositionPercentYEnabled:function(t){this._usingPositionPercentY=t,this._usingPositionPercentY&&(this._verticalEdge=ccui.LayoutComponent.verticalEdge.NONE)},getPositionPercentY:function(){return this._positionPercentY},setPositionPercentY:function(t){this._positionPercentY=t;var e=this._getOwnerParent();null!==e&&(this._owner.setPositionY(e.height*this._positionPercentY),this._refreshVerticalMargin())},getHorizontalEdge:function(){return this._horizontalEdge},setHorizontalEdge:function(t){this._horizontalEdge=t,this._horizontalEdge!==ccui.LayoutComponent.horizontalEdge.NONE&&(this._usingPositionPercentX=!1);var e=this._getOwnerParent();if(null!==e){var i=this._owner.getPosition(),n=e.getContentSize();0!==n.width?this._positionPercentX=i.x/n.width:(this._positionPercentX=0,i.x=0,this._usingPositionPercentX&&this._owner.setPosition(i)),this._refreshHorizontalMargin()}},getVerticalEdge:function(){return this._verticalEdge},setVerticalEdge:function(t){this._verticalEdge=t,this._verticalEdge!==ccui.LayoutComponent.verticalEdge.NONE&&(this._usingPositionPercentY=!1);var e=this._getOwnerParent();if(null!==e){var i=this._owner.getPosition(),n=e.getContentSize();0!==n.height?this._positionPercentY=i.y/n.height:(this._positionPercentY=0,i.y=0,this._usingPositionPercentY&&this._owner.setPosition(i)),this._refreshVerticalMargin()}},getLeftMargin:function(){return this._leftMargin},setLeftMargin:function(t){this._leftMargin=t},getRightMargin:function(){return this._rightMargin},setRightMargin:function(t){this._rightMargin=t},getTopMargin:function(){return this._topMargin},setTopMargin:function(t){this._topMargin=t},getBottomMargin:function(){return this._bottomMargin},setBottomMargin:function(t){this._bottomMargin=t},getSize:function(){return this.getOwner().getContentSize()},setSize:function(t){var e=this._getOwnerParent();if(null!==e){var i=t,n=e.getContentSize();0!==n.width?this._percentWidth=i.width/n.width:(this._percentWidth=0,this._usingPercentWidth&&(i.width=0)),0!==n.height?this._percentHeight=i.height/n.height:(this._percentHeight=0,this._usingPercentHeight&&(i.height=0)),this._owner.setContentSize(i),this._refreshHorizontalMargin(),this._refreshVerticalMargin()}else this._owner.setContentSize(t)},isPercentWidthEnabled:function(){return this._usingPercentWidth},setPercentWidthEnabled:function(t){this._usingPercentWidth=t,this._usingPercentWidth&&(this._usingStretchWidth=!1)},getSizeWidth:function(){return this._owner.width},setSizeWidth:function(t){var e=this._owner.getContentSize();e.width=t;var i=this._getOwnerParent();if(null!==i){var n=i.getContentSize();0!==n.width?this._percentWidth=e.width/n.width:(this._percentWidth=0,this._usingPercentWidth&&(e.width=0)),this._owner.setContentSize(e),this._refreshHorizontalMargin()}else this._owner.setContentSize(e)},getPercentWidth:function(){return this._percentWidth},setPercentWidth:function(t){this._percentWidth=t;var e=this._getOwnerParent();if(null!==e){var i=this._owner.getContentSize();i.width=e.width*this._percentWidth,this._owner.setContentSize(i),this._refreshHorizontalMargin()}},isPercentHeightEnabled:function(){return this._usingPercentHeight},setPercentHeightEnabled:function(t){this._usingPercentHeight=t,this._usingPercentHeight&&(this._usingStretchHeight=!1)},getSizeHeight:function(){return this._owner.height},setSizeHeight:function(t){var e=this._owner.getContentSize();e.height=t;var i=this._getOwnerParent();if(null!==i){var n=i.getContentSize();0!==n.height?this._percentHeight=e.height/n.height:(this._percentHeight=0,this._usingPercentHeight&&(e.height=0)),this._owner.setContentSize(e),this._refreshVerticalMargin()}else this._owner.setContentSize(e)},getPercentHeight:function(){return this._percentHeight},setPercentHeight:function(t){this._percentHeight=t;var e=this._getOwnerParent();if(null!==e){var i=this._owner.getContentSize();i.height=e.height*this._percentHeight,this._owner.setContentSize(i),this._refreshVerticalMargin()}},isStretchWidthEnabled:function(){return this._usingStretchWidth},setStretchWidthEnabled:function(t){this._usingStretchWidth=t,this._usingStretchWidth&&(this._usingPercentWidth=!1)},isStretchHeightEnabled:function(){return this._usingStretchHeight},setStretchHeightEnabled:function(t){this._usingStretchHeight=t,this._usingStretchHeight&&(this._usingPercentHeight=!1)},setPercentOnlyEnabled:function(t){this._isPercentOnly=t},setActiveEnabled:function(t){this._actived=t},refreshLayout:function(){if(this._actived){var t=this._getOwnerParent();if(null!==t){var e=t.getContentSize(),i=this._owner,n=i.getAnchorPoint(),r=i.getContentSize(),o=i.getPosition();switch(this._horizontalEdge){case ccui.LayoutComponent.horizontalEdge.NONE:this._usingStretchWidth&&!this._isPercentOnly?(r.width=e.width*this._percentWidth,o.x=this._leftMargin+n.x*r.width):(this._usingPositionPercentX&&(o.x=e.width*this._positionPercentX),this._usingPercentWidth&&(r.width=e.width*this._percentWidth));break;case ccui.LayoutComponent.horizontalEdge.LEFT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(r.width=e.width*this._percentWidth),o.x=this._leftMargin+n.x*r.width;break;case ccui.LayoutComponent.horizontalEdge.RIGHT:if(this._isPercentOnly)break;(this._usingPercentWidth||this._usingStretchWidth)&&(r.width=e.width*this._percentWidth),o.x=e.width-(this._rightMargin+(1-n.x)*r.width);break;case ccui.LayoutComponent.horizontalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchWidth?(r.width=e.width-this._leftMargin-this._rightMargin,r.width<0&&(r.width=0),o.x=this._leftMargin+n.x*r.width):(this._usingPercentWidth&&(r.width=e.width*this._percentWidth),o.x=e.width*this._positionPercentX)}switch(this._verticalEdge){case ccui.LayoutComponent.verticalEdge.NONE:this._usingStretchHeight&&!this._isPercentOnly?(r.height=e.height*this._percentHeight,o.y=this._bottomMargin+n.y*r.height):(this._usingPositionPercentY&&(o.y=e.height*this._positionPercentY),this._usingPercentHeight&&(r.height=e.height*this._percentHeight));break;case ccui.LayoutComponent.verticalEdge.BOTTOM:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(r.height=e.height*this._percentHeight),o.y=this._bottomMargin+n.y*r.height;break;case ccui.LayoutComponent.verticalEdge.TOP:if(this._isPercentOnly)break;(this._usingPercentHeight||this._usingStretchHeight)&&(r.height=e.height*this._percentHeight),o.y=e.height-(this._topMargin+(1-n.y)*r.height);break;case ccui.LayoutComponent.verticalEdge.CENTER:if(this._isPercentOnly)break;this._usingStretchHeight?(r.height=e.height-this._topMargin-this._bottomMargin,r.height<0&&(r.height=0),o.y=this._bottomMargin+n.y*r.height):(this._usingPercentHeight&&(r.height=e.height*this._percentHeight),o.y=e.height*this._positionPercentY)}if(i.setPosition(o),i.setContentSize(r),i instanceof ccui.PageView){i.forceDoLayout();for(var s=i.getPages(),c=0;c<s.length;c++)ccui.helper.doLayout(s[c])}else ccui.helper.doLayout(i)}}},_getOwnerParent:function(){return this._owner?this._owner.getParent():null},_refreshHorizontalMargin:function(){var t=this._getOwnerParent();if(null!==t){var e=this._owner.getPosition(),i=this._owner.getAnchorPoint(),n=this._owner.getContentSize(),r=t.getContentSize();this._leftMargin=e.x-i.x*n.width,this._rightMargin=r.width-(e.x+(1-i.x)*n.width)}},_refreshVerticalMargin:function(){var t=this._getOwnerParent();if(null!==t){var e=this._owner.getPosition(),i=this._owner.getAnchorPoint(),n=this._owner.getContentSize(),r=t.getContentSize();this._bottomMargin=e.y-i.y*n.height,this._topMargin=r.height-(e.y+(1-i.y)*n.height)}}}),ccui.LayoutComponent.horizontalEdge={NONE:0,LEFT:1,RIGHT:2,CENTER:3},ccui.LayoutComponent.verticalEdge={NONE:0,BOTTOM:1,TOP:2,CENTER:3},ccui.LayoutComponent.NAME="__ui_layout",ccui.LayoutComponent.bindLayoutComponent=function(t){var e=t.getComponent(ccui.LayoutComponent.NAME);return void 0!==e?e:(e=new ccui.LayoutComponent,e.init(),t.addComponent(e),t instanceof ccui.Widget||t.addEventListener&&t.addEventListener("load",function(){e.refreshLayout()},this),e)},cc.ComponentContainer=cc.Class.extend({_components:null,_owner:null,ctor:function(t){this._components=null,this._owner=t},getComponent:function(t){if(!t)throw new Error("cc.ComponentContainer.getComponent(): name should be non-null");return t=t.trim(),this._components||(this._components={}),this._components[t]},add:function(t){if(!t)throw new Error("cc.ComponentContainer.add(): component should be non-null");if(t.getOwner())return cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1;null==this._components&&(this._components={},this._owner.scheduleUpdate());var e=this._components[t.getName()];return e?(cc.log("cc.ComponentContainer.add(): Component already added. It can't be added again"),!1):(t.setOwner(this._owner),this._components[t.getName()]=t,t.onEnter(),!0)},remove:function(t){if(!t)throw new Error("cc.ComponentContainer.remove(): name should be non-null");return!!this._components&&(t instanceof cc.Component?this._removeByComponent(t):(t=t.trim(),this._removeByComponent(this._components[t])))},_removeByComponent:function(t){return!!t&&(t.onExit(),t.setOwner(null),delete this._components[t.getName()],!0)},removeAll:function(){if(this._components){var t=this._components;for(var e in t){var i=t[e];i.onExit(),i.setOwner(null),delete t[e]}this._owner.unscheduleUpdate(),this._components=null}},_alloc:function(){this._components={}},visit:function(t){if(this._components){var e=this._components;for(var i in e)e[i].update(t)}},isEmpty:function(){return!this._components||0===this._components.length}});var ccs=ccs||{};ccs.Class=ccs.Class||cc.Class,ccs.Class.extend=ccs.Class.extend||cc.Class.extend,ccs.Node=ccs.Node||cc.Node,ccs.Node.extend=ccs.Node.extend||cc.Node.extend,ccs.Sprite=ccs.Sprite||cc.Sprite,ccs.Sprite.extend=ccs.Sprite.extend||cc.Sprite.extend,ccs.Component=ccs.Component||cc.Component,ccs.Component.extend=ccs.Component.extend||cc.Component.extend,ccs.cocostudioVersion="v1.3.0.0",ccs.VERSION_COMBINED=.3,ccs.VERSION_CHANGE_ROTATION_RANGE=1,ccs.VERSION_COLOR_READING=1.1,ccs.MAX_VERTEXZ_VALUE=5e6,ccs.ARMATURE_MAX_CHILD=50,ccs.ARMATURE_MAX_ZORDER=100,ccs.ARMATURE_MAX_COUNT=ccs.MAX_VERTEXZ_VALUE/ccs.ARMATURE_MAX_CHILD/ccs.ARMATURE_MAX_ZORDER,ccs.AUTO_ADD_SPRITE_FRAME_NAME_PREFIX=!1,ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT=!1,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX=!1,ccs.armatureVersion=function(){return"v1.1.0.0"},ccs.CONST_VERSION="version",ccs.CONST_VERSION_2_0=2,ccs.CONST_VERSION_COMBINED=.3,ccs.CONST_ARMATURES="armatures",ccs.CONST_ARMATURE="armature",ccs.CONST_BONE="b",ccs.CONST_DISPLAY="d",ccs.CONST_ANIMATIONS="animations",ccs.CONST_ANIMATION="animation",ccs.CONST_MOVEMENT="mov",ccs.CONST_FRAME="f",ccs.CONST_TEXTURE_ATLAS="TextureAtlas",ccs.CONST_SUB_TEXTURE="SubTexture",ccs.CONST_SKELETON="skeleton",ccs.CONST_A_NAME="name",ccs.CONST_A_DURATION="dr",ccs.CONST_A_FRAME_INDEX="fi",ccs.CONST_A_DURATION_TO="to",ccs.CONST_A_DURATION_TWEEN="drTW",ccs.CONST_A_LOOP="lp",ccs.CONST_A_MOVEMENT_SCALE="sc",ccs.CONST_A_MOVEMENT_DELAY="dl",ccs.CONST_A_DISPLAY_INDEX="dI",ccs.CONST_A_PLIST="plist",ccs.CONST_A_PARENT="parent",ccs.CONST_A_SKEW_X="kX",ccs.CONST_A_SKEW_Y="kY",ccs.CONST_A_SCALE_X="cX",ccs.CONST_A_SCALE_Y="cY",ccs.CONST_A_Z="z",ccs.CONST_A_EVENT="evt",ccs.CONST_A_SOUND="sd",ccs.CONST_A_SOUND_EFFECT="sdE",ccs.CONST_A_TWEEN_EASING="twE",ccs.CONST_A_EASING_PARAM="twEP",ccs.CONST_A_TWEEN_ROTATE="twR",ccs.CONST_A_IS_ARMATURE="isArmature",ccs.CONST_A_DISPLAY_TYPE="displayType",ccs.CONST_A_MOVEMENT="mov",ccs.CONST_A_X="x",ccs.CONST_A_Y="y",ccs.CONST_A_COCOS2DX_X="cocos2d_x",ccs.CONST_A_COCOS2DX_Y="cocos2d_y",ccs.CONST_A_WIDTH="width",ccs.CONST_A_HEIGHT="height",ccs.CONST_A_PIVOT_X="pX",ccs.CONST_A_PIVOT_Y="pY",ccs.CONST_A_COCOS2D_PIVOT_X="cocos2d_pX",ccs.CONST_A_COCOS2D_PIVOT_Y="cocos2d_pY",ccs.CONST_A_BLEND_TYPE="bd",ccs.CONST_A_BLEND_SRC="bd_src",ccs.CONST_A_BLEND_DST="bd_dst",ccs.CONST_A_ALPHA="a",ccs.CONST_A_RED="r",ccs.CONST_A_GREEN="g",ccs.CONST_A_BLUE="b",ccs.CONST_A_ALPHA_OFFSET="aM",ccs.CONST_A_RED_OFFSET="rM",ccs.CONST_A_GREEN_OFFSET="gM",ccs.CONST_A_BLUE_OFFSET="bM",ccs.CONST_A_COLOR_TRANSFORM="colorTransform",ccs.CONST_A_TWEEN_FRAME="tweenFrame",ccs.CONST_CONTOUR="con",ccs.CONST_CONTOUR_VERTEX="con_vt",ccs.CONST_FL_NAN="NaN",ccs.CONST_FRAME_DATA="frame_data",ccs.CONST_MOVEMENT_BONE_DATA="mov_bone_data",ccs.CONST_MOVEMENT_DATA="mov_data",ccs.CONST_ANIMATION_DATA="animation_data",ccs.CONST_DISPLAY_DATA="display_data",ccs.CONST_SKIN_DATA="skin_data",ccs.CONST_BONE_DATA="bone_data",ccs.CONST_ARMATURE_DATA="armature_data",ccs.CONST_CONTOUR_DATA="contour_data",ccs.CONST_TEXTURE_DATA="texture_data",ccs.CONST_VERTEX_POINT="vertex",ccs.CONST_COLOR_INFO="color",ccs.CONST_CONFIG_FILE_PATH="config_file_path",ccs.CONST_CONTENT_SCALE="content_scale",ccs.DataInfo=function(){this.asyncStruct=null,this.configFileQueue=[],this.contentScale=1,this.filename="",this.baseFilePath="",this.flashToolVersion=0,this.cocoStudioVersion=0},ccs.dataReaderHelper={ConfigType:{DragonBone_XML:0,CocoStudio_JSON:1,CocoStudio_Binary:2},_configFileList:[],_flashToolVersion:ccs.CONST_VERSION_2_0,_positionReadScale:1,_asyncRefCount:0,_asyncRefTotalCount:0,_dataQueue:null,setPositionReadScale:function(t){this._positionReadScale=t},getPositionReadScale:function(){return this._positionReadScale},addDataFromFile:function(t){if(this._configFileList.indexOf(t)===-1){this._configFileList.push(t);var e=this._initBaseFilePath(t),i=cc.path.extname(t).toLowerCase(),n=new ccs.DataInfo;n.filename=t,n.basefilePath=e,".xml"===i?ccs.dataReaderHelper.addDataFromXML(t,n):".json"===i||".exportjson"===i?ccs.dataReaderHelper.addDataFromJson(t,n):".csb"===i&&ccs.dataReaderHelper.addDataFromBinaryCache(t,n)}},addDataFromFileAsync:function(t,e,i,n,r){if(this._configFileList.indexOf(i)!==-1)return void(r&&n&&(0===this._asyncRefTotalCount&&0===this._asyncRefCount?this._asyncCallBack(n,r,1):this._asyncCallBack(n,r,(this._asyncRefTotalCount-this._asyncRefCount)/this._asyncRefTotalCount)));this._asyncRefTotalCount++,this._asyncRefCount++;var o=this,s=function(){o.addDataFromFile(i),o._asyncRefCount--,o._asyncCallBack(n,r,(o._asyncRefTotalCount-o._asyncRefCount)/o._asyncRefTotalCount)};cc.director.getScheduler().schedule(s,this,.1,!1,0,!1,"armatrueDataHelper")},removeConfigFile:function(t){for(var e=this._configFileList,i=e.length,n=e[i],r=0;r<i;r++)e[r]===t&&(n=r);n!==e[i]&&cc.arrayRemoveObject(e,t)},addDataFromCache:function(t,e){if(!t)return void cc.log("XML error  or  XML is empty.");e.flashToolVersion=parseFloat(t.getAttribute(ccs.CONST_VERSION));var i,n=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ARMATURES+" >  "+ccs.CONST_ARMATURE),r=ccs.armatureDataManager;for(i=0;i<n.length;i++){var o=this.decodeArmature(n[i],e);r.addArmatureData(o.name,o,e.filename)}var s=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_ANIMATIONS+" >  "+ccs.CONST_ANIMATION);for(i=0;i<s.length;i++){var c=this.decodeAnimation(s[i],e);r.addAnimationData(c.name,c,e.filename)}var a=t.querySelectorAll(ccs.CONST_SKELETON+" > "+ccs.CONST_TEXTURE_ATLAS+" >  "+ccs.CONST_SUB_TEXTURE);for(i=0;i<a.length;i++){var l=this.decodeTexture(a[i],e);r.addTextureData(l.name,l,e.filename)}},decodeArmature:function(t,e){var i=new ccs.ArmatureData;i.init(),i.name=t.getAttribute(ccs.CONST_A_NAME);for(var n=t.querySelectorAll(ccs.CONST_ARMATURE+" > "+ccs.CONST_BONE),r=0;r<n.length;r++){var o=n[r],s=o.getAttribute(ccs.CONST_A_PARENT),c=null;if(s)for(var a=0;a<n.length&&(c=n[a],s!=n[a].getAttribute(ccs.CONST_A_NAME));a++);var l=this.decodeBone(o,c,e);i.addBoneData(l)}return i},decodeArmatureFromJSON:function(t,e){var i=new ccs.ArmatureData;i.init();var n=t[ccs.CONST_A_NAME];n&&(i.name=n),e.cocoStudioVersion=i.dataVersion=t[ccs.CONST_VERSION]||.1;for(var r=t[ccs.CONST_BONE_DATA],o=0;o<r.length;o++){var s=this.decodeBoneFromJson(r[o],e);i.addBoneData(s)}return i},decodeBone:function(t,e,i){var n=new ccs.BoneData;n.init(),n.name=t.getAttribute(ccs.CONST_A_NAME),n.parentName=t.getAttribute(ccs.CONST_A_PARENT)||"",n.zOrder=parseInt(t.getAttribute(ccs.CONST_A_Z))||0;for(var r=t.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_DISPLAY),o=0;o<r.length;o++){var s=r[o],c=this.decodeBoneDisplay(s,i);n.addDisplayData(c)}return n},decodeBoneFromJson:function(t,e){var i=new ccs.BoneData;i.init(),this.decodeNodeFromJson(i,t,e),i.name=t[ccs.CONST_A_NAME]||"",i.parentName=t[ccs.CONST_A_PARENT]||"";for(var n=t[ccs.CONST_DISPLAY_DATA]||[],r=0;r<n.length;r++){var o=this.decodeBoneDisplayFromJson(n[r],e);i.addDisplayData(o)}return i},decodeBoneDisplay:function(t,e){var i=parseFloat(t.getAttribute(ccs.CONST_A_IS_ARMATURE))||0,n=null;1===i?(n=new ccs.ArmatureDisplayData,n.displayType=ccs.DISPLAY_TYPE_ARMATURE):(n=new ccs.SpriteDisplayData,n.displayType=ccs.DISPLAY_TYPE_SPRITE);var r=t.getAttribute(ccs.CONST_A_NAME)||"";return r&&(n.displayName=r),n},decodeBoneDisplayFromJson:function(t,e){var i=t[ccs.CONST_A_DISPLAY_TYPE]||ccs.DISPLAY_TYPE_SPRITE,n=null;switch(i){case ccs.DISPLAY_TYPE_SPRITE:n=new ccs.SpriteDisplayData;var r=t[ccs.CONST_A_NAME];null!=r&&(n.displayName=r);var o=t[ccs.CONST_SKIN_DATA]||[],s=o[0];if(s){var c=n.skinData;c.x=s[ccs.CONST_A_X]*this._positionReadScale,c.y=s[ccs.CONST_A_Y]*this._positionReadScale,c.scaleX=null==s[ccs.CONST_A_SCALE_X]?1:s[ccs.CONST_A_SCALE_X],c.scaleY=null==s[ccs.CONST_A_SCALE_Y]?1:s[ccs.CONST_A_SCALE_Y],c.skewX=null==s[ccs.CONST_A_SKEW_X]?1:s[ccs.CONST_A_SKEW_X],c.skewY=null==s[ccs.CONST_A_SKEW_Y]?1:s[ccs.CONST_A_SKEW_Y],c.x*=e.contentScale,c.y*=e.contentScale}break;case ccs.DISPLAY_TYPE_ARMATURE:n=new ccs.ArmatureDisplayData;var r=t[ccs.CONST_A_NAME];null!=r&&(n.displayName=t[ccs.CONST_A_NAME]);break;case ccs.DISPLAY_TYPE_PARTICLE:n=new ccs.ParticleDisplayData;var a=t[ccs.CONST_A_PLIST];null!=a&&(e.asyncStruct?n.displayName=e.asyncStruct.basefilePath+a:n.displayName=e.basefilePath+a);break;default:n=new ccs.SpriteDisplayData}return n.displayType=i,n},decodeAnimation:function(t,e){var i=new ccs.AnimationData,n=t.getAttribute(ccs.CONST_A_NAME),r=ccs.armatureDataManager.getArmatureData(n);i.name=n;for(var o=t.querySelectorAll(ccs.CONST_ANIMATION+" > "+ccs.CONST_MOVEMENT),s=null,c=0;c<o.length;c++){s=o[c];var a=this.decodeMovement(s,r,e);i.addMovement(a)}return i},decodeAnimationFromJson:function(t,e){var i=new ccs.AnimationData,n=t[ccs.CONST_A_NAME];n&&(i.name=t[ccs.CONST_A_NAME]);for(var r=t[ccs.CONST_MOVEMENT_DATA]||[],o=0;o<r.length;o++){var s=this.decodeMovementFromJson(r[o],e);i.addMovement(s)}return i},decodeMovement:function(t,e,i){var n=new ccs.MovementData;n.name=t.getAttribute(ccs.CONST_A_NAME);var r,o,s,c,a=0;r=t.getAttribute(ccs.CONST_A_DURATION),n.duration=null==r?0:parseFloat(r),o=t.getAttribute(ccs.CONST_A_DURATION_TO),n.durationTo=null==o?0:parseFloat(o),s=t.getAttribute(ccs.CONST_A_DURATION_TWEEN),n.durationTween=null==s?0:parseFloat(s),c=t.getAttribute(ccs.CONST_A_LOOP),n.loop=!c||Boolean(parseFloat(c));var l=t.getAttribute(ccs.CONST_A_TWEEN_EASING);l&&(l!=ccs.CONST_FL_NAN?(a=null==l?0:parseFloat(l),n.tweenEasing=2===a?ccs.TweenType.SINE_EASEINOUT:a):n.tweenEasing=ccs.TweenType.LINEAR);for(var h=t.querySelectorAll(ccs.CONST_MOVEMENT+" > "+ccs.CONST_BONE),u=null,d=0;d<h.length;d++){u=h[d];var _=u.getAttribute(ccs.CONST_A_NAME);if(!n.getMovementBoneData(_)){var p=e.getBoneData(_),f=p.parentName,m=null;if(""!==f)for(var g=0;g<h.length&&(m=h[g],f!==m.getAttribute(ccs.CONST_A_NAME));g++);var y=this.decodeMovementBone(u,m,p,i);n.addMovementBoneData(y)}}return n},decodeMovementFromJson:function(t,e){var i=new ccs.MovementData;i.loop=null!=t[ccs.CONST_A_LOOP]&&t[ccs.CONST_A_LOOP],i.durationTween=t[ccs.CONST_A_DURATION_TWEEN]||0,i.durationTo=t[ccs.CONST_A_DURATION_TO]||0,i.duration=t[ccs.CONST_A_DURATION]||0,null==t[ccs.CONST_A_DURATION]?i.scale=1:i.scale=null==t[ccs.CONST_A_MOVEMENT_SCALE]?1:t[ccs.CONST_A_MOVEMENT_SCALE],i.tweenEasing=null==t[ccs.CONST_A_TWEEN_EASING]?ccs.TweenType.LINEAR:t[ccs.CONST_A_TWEEN_EASING];var n=t[ccs.CONST_A_NAME];n&&(i.name=n);for(var r=t[ccs.CONST_MOVEMENT_BONE_DATA]||[],o=0;o<r.length;o++){var s=this.decodeMovementBoneFromJson(r[o],e);i.addMovementBoneData(s)}return i},decodeMovementBone:function(t,e,i,n){var r=new ccs.MovementBoneData;r.init();var o,s;t&&(o=parseFloat(t.getAttribute(ccs.CONST_A_MOVEMENT_SCALE))||0,r.scale=o,s=parseFloat(t.getAttribute(ccs.CONST_A_MOVEMENT_DELAY))||0,s>0&&(s-=1),r.delay=s);var c=0,a=0,l=0,h=null,u=[];if(null!=e){for(var d=e.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),_=0;_<d.length;_++)u.push(d[_]);c=u.length}r.name=t.getAttribute(ccs.CONST_A_NAME);for(var p=t.querySelectorAll(ccs.CONST_BONE+" > "+ccs.CONST_FRAME),f=0,m=0,g=0;g<p.length;g++){var y=p[g];if(e)for(;f<c&&(!h||(m<a||m>=a+l));)h=u[f],a+=l,l=parseFloat(h.getAttribute(ccs.CONST_A_DURATION)),f++;var v=this.decodeFrame(y,h,i,n);r.addFrameData(v),v.frameID=m,m+=v.duration,r.duration=m}for(var T=r.frameList,C=Math.PI,_=T.length-1;_>=0;_--)if(_>0){var S=T[_].skewX-T[_-1].skewX,x=T[_].skewY-T[_-1].skewY;(S<-C||S>C)&&(T[_-1].skewX=S<0?T[_-1].skewX-2*C:T[_-1].skewX+2*C),(x<-C||x>C)&&(T[_-1].skewY=x<0?T[_-1].skewY-2*C:T[_-1].skewY+2*C)}var A=new ccs.FrameData;return A.copy(r.frameList[r.frameList.length-1]),A.frameID=r.duration,r.addFrameData(A),r},decodeMovementBoneFromJson:function(t,e){var i=new ccs.MovementBoneData;i.init(),i.delay=t[ccs.CONST_A_MOVEMENT_DELAY]||0;var n=t[ccs.CONST_A_NAME];n&&(i.name=n);for(var r=t[ccs.CONST_FRAME_DATA]||[],o=r.length,s=0;s<o;s++){var c=t[ccs.CONST_FRAME_DATA][s],a=this.decodeFrameFromJson(c,e);i.addFrameData(a),e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&(a.frameID=i.duration,i.duration+=a.duration)}if(e.cocoStudioVersion<ccs.VERSION_CHANGE_ROTATION_RANGE)for(var l=i.frameList,h=Math.PI,s=l.length-1;s>=0;s--)if(s>0){var u=l[s].skewX-l[s-1].skewX,d=l[s].skewY-l[s-1].skewY;(u<-h||u>h)&&(l[s-1].skewX=u<0?l[s-1].skewX-2*h:l[s-1].skewX+2*h),(d<-h||d>h)&&(l[s-1].skewY=d<0?l[s-1].skewY-2*h:l[s-1].skewY+2*h)}if(e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED&&i.frameList.length>0){var a=new ccs.FrameData;a.copy(i.frameList[i.frameList.length-1]),i.addFrameData(a),a.frameID=i.duration}return i},decodeFrame:function(t,e,i,n){var r=0,o=0,s=0,c=0,a=0,l=0,h=0,u=0,d=0,_=0,p=0,f=0,m=new ccs.FrameData;m.strMovement=t.getAttribute(ccs.CONST_A_MOVEMENT)||"",m.movement=m.strMovement,m.strEvent=t.getAttribute(ccs.CONST_A_EVENT)||"",m.event=m.strEvent,m.strSound=t.getAttribute(ccs.CONST_A_SOUND)||"",m.sound=m.strSound,m.strSoundEffect=t.getAttribute(ccs.CONST_A_SOUND_EFFECT)||"",m.soundEffect=m.strSoundEffect;var g=t.getAttribute(ccs.CONST_A_TWEEN_FRAME);if(m.isTween=!(void 0!==g&&("false"===g||"0"===g)),n.flashToolVersion>=ccs.CONST_VERSION_2_0?(r=t.getAttribute(ccs.CONST_A_COCOS2DX_X),r&&(m.x=parseFloat(r),m.x*=this._positionReadScale),o=t.getAttribute(ccs.CONST_A_COCOS2DX_Y),o&&(m.y=-parseFloat(o),m.y*=this._positionReadScale)):(r=t.getAttribute(ccs.CONST_A_X),r&&(m.x=parseFloat(r),m.x*=this._positionReadScale),o=t.getAttribute(ccs.CONST_A_Y),o&&(m.y=-parseFloat(o),m.y*=this._positionReadScale)),s=t.getAttribute(ccs.CONST_A_SCALE_X),null!=s&&(m.scaleX=parseFloat(s)),c=t.getAttribute(ccs.CONST_A_SCALE_Y),null!=c&&(m.scaleY=parseFloat(c)),a=t.getAttribute(ccs.CONST_A_SKEW_X),null!=a&&(m.skewX=cc.degreesToRadians(parseFloat(a))),l=t.getAttribute(ccs.CONST_A_SKEW_Y),null!=l&&(m.skewY=cc.degreesToRadians(-parseFloat(l))),u=t.getAttribute(ccs.CONST_A_DURATION),null!=u&&(m.duration=parseFloat(u)),d=t.getAttribute(ccs.CONST_A_DISPLAY_INDEX),null!=d&&(m.displayIndex=parseFloat(d)),_=t.getAttribute(ccs.CONST_A_Z),null!=_&&(m.zOrder=parseInt(_)),h=t.getAttribute(ccs.CONST_A_TWEEN_ROTATE),null!=h&&(m.tweenRotate=parseFloat(h)),f=t.getAttribute(ccs.CONST_A_BLEND_TYPE),null!=f){var y=m.blendFunc;switch(f){case ccs.BLEND_TYPE_NORMAL:y.src=cc.BLEND_SRC,y.dst=cc.BLEND_DST;break;case ccs.BLEND_TYPE_ADD:y.src=cc.SRC_ALPHA,y.dst=cc.ONE;break;case ccs.BLEND_TYPE_MULTIPLY:y.src=cc.DST_COLOR,y.dst=cc.ONE_MINUS_SRC_ALPHA;break;case ccs.BLEND_TYPE_SCREEN:y.src=cc.ONE,y.dst=cc.ONE_MINUS_DST_COLOR;break;default:m.blendFunc.src=cc.BLEND_SRC,m.blendFunc.dst=cc.BLEND_DST}}var v=t.querySelectorAll(ccs.CONST_FRAME+" > "+ccs.CONST_A_COLOR_TRANSFORM);if(v&&v.length>0){v=v[0];var T,C,S,x,A,E,b,R;T=parseFloat(v.getAttribute(ccs.CONST_A_ALPHA))||0,C=parseFloat(v.getAttribute(ccs.CONST_A_RED))||0,S=parseFloat(v.getAttribute(ccs.CONST_A_GREEN))||0,x=parseFloat(v.getAttribute(ccs.CONST_A_BLUE))||0,A=parseFloat(v.getAttribute(ccs.CONST_A_ALPHA_OFFSET))||0,E=parseFloat(v.getAttribute(ccs.CONST_A_RED_OFFSET))||0,b=parseFloat(v.getAttribute(ccs.CONST_A_GREEN_OFFSET))||0,R=parseFloat(v.getAttribute(ccs.CONST_A_BLUE_OFFSET))||0,m.a=2.55*A+T,m.r=2.55*E+C,m.g=2.55*b+S,m.b=2.55*R+x,m.isUseColorInfo=!0}var P=t.getAttribute(ccs.CONST_A_TWEEN_EASING);if(null!=P&&(P!=ccs.CONST_FL_NAN?(p=t.getAttribute(ccs.CONST_A_TWEEN_EASING),p&&(m.tweenEasing=2===p?ccs.TweenType.SINE_EASEINOUT:p)):m.tweenEasing=ccs.TweenType.LINEAR),e){var w=new ccs.BaseData;n.flashToolVersion>=ccs.CONST_VERSION_2_0?(w.x=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2DX_X)),w.y=parseFloat(e.getAttribute(ccs.CONST_A_COCOS2DX_Y))):(w.x=parseFloat(e.getAttribute(ccs.CONST_A_X)),w.y=parseFloat(e.getAttribute(ccs.CONST_A_Y))),w.skewX=parseFloat(e.getAttribute(ccs.CONST_A_SKEW_X)),w.skewY=parseFloat(e.getAttribute(ccs.CONST_A_SKEW_Y)),w.y=-w.y,w.skewX=cc.degreesToRadians(w.skewX),w.skewY=cc.degreesToRadians(-w.skewY),ccs.TransformHelp.transformFromParent(m,w)}return m},decodeFrameFromJson:function(t,e){var i=new ccs.FrameData;this.decodeNodeFromJson(i,t,e),i.tweenEasing=t[ccs.CONST_A_TWEEN_EASING]||ccs.TweenType.LINEAR,i.displayIndex=t[ccs.CONST_A_DISPLAY_INDEX];var n=null==t[ccs.CONST_A_BLEND_SRC]?cc.BLEND_SRC:t[ccs.CONST_A_BLEND_SRC],r=null==t[ccs.CONST_A_BLEND_DST]?cc.BLEND_DST:t[ccs.CONST_A_BLEND_DST];i.blendFunc.src=n,i.blendFunc.dst=r,i.isTween=null==t[ccs.CONST_A_TWEEN_FRAME]||t[ccs.CONST_A_TWEEN_FRAME];var o=t[ccs.CONST_A_EVENT];null!=o&&(i.strEvent=o,i.event=o),e.cocoStudioVersion<ccs.CONST_VERSION_COMBINED?i.duration=null==t[ccs.CONST_A_DURATION]?1:t[ccs.CONST_A_DURATION]:i.frameID=t[ccs.CONST_A_FRAME_INDEX];for(var s=t[ccs.CONST_A_EASING_PARAM]||[],c=0;c<s.length;c++)i.easingParams[c]=s[c];return i},decodeTexture:function(t,e){var i=new ccs.TextureData;i.init(),t.getAttribute(ccs.CONST_A_NAME)&&(i.name=t.getAttribute(ccs.CONST_A_NAME));var n,r;e.flashToolVersion>=ccs.CONST_VERSION_2_0?(n=parseFloat(t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_X))||0,r=parseFloat(t.getAttribute(ccs.CONST_A_COCOS2D_PIVOT_Y))||0):(n=parseFloat(t.getAttribute(ccs.CONST_A_PIVOT_X))||0,r=parseFloat(t.getAttribute(ccs.CONST_A_PIVOT_Y))||0);var o=parseFloat(t.getAttribute(ccs.CONST_A_WIDTH))||0,s=parseFloat(t.getAttribute(ccs.CONST_A_HEIGHT))||0,c=n/o,a=(s-r)/s;i.pivotX=c,i.pivotY=a;for(var l=t.querySelectorAll(ccs.CONST_SUB_TEXTURE+" > "+ccs.CONST_CONTOUR),h=0;h<l.length;h++)i.addContourData(this.decodeContour(l[h],e));return i},decodeTextureFromJson:function(t){var e=new ccs.TextureData;e.init();var i=t[ccs.CONST_A_NAME];null!=i&&(e.name=i),e.width=t[ccs.CONST_A_WIDTH]||0,e.height=t[ccs.CONST_A_HEIGHT]||0,e.pivotX=t[ccs.CONST_A_PIVOT_X]||0,e.pivotY=t[ccs.CONST_A_PIVOT_Y]||0;for(var n=t[ccs.CONST_CONTOUR_DATA]||[],r=0;r<n.length;r++)e.contourDataList.push(this.decodeContourFromJson(n[r]));return e},decodeContour:function(t,e){var i=new ccs.ContourData;i.init();for(var n,r=t.querySelectorAll(ccs.CONST_CONTOUR+" > "+ccs.CONST_CONTOUR_VERTEX),o=0;o<r.length;o++){n=r[o];var s=cc.p(0,0);s.x=parseFloat(n.getAttribute(ccs.CONST_A_X))||0,s.y=parseFloat(n.getAttribute(ccs.CONST_A_Y))||0,s.y=-s.y,i.vertexList.push(s)}return i},decodeContourFromJson:function(t){var e=new ccs.ContourData;e.init();for(var i=t[ccs.CONST_VERTEX_POINT]||[],n=i.length,r=0;r<n;r++){var o=i[r],s=cc.p(0,0);s.x=o[ccs.CONST_A_X]||0,s.y=o[ccs.CONST_A_Y]||0,e.vertexList.push(s)}return e},addDataFromJsonCache:function(t,e){e.contentScale=null==t[ccs.CONST_CONTENT_SCALE]?1:t[ccs.CONST_CONTENT_SCALE];var i,n,r=t[ccs.CONST_ARMATURE_DATA]||[];for(i=0;i<r.length;i++)n=this.decodeArmatureFromJSON(r[i],e),ccs.armatureDataManager.addArmatureData(n.name,n,e.filename);var o,s=t[ccs.CONST_ANIMATION_DATA]||[];for(i=0;i<s.length;i++)o=this.decodeAnimationFromJson(s[i],e),ccs.armatureDataManager.addAnimationData(o.name,o,e.filename);var c,a=t[ccs.CONST_TEXTURE_DATA]||[];for(i=0;i<a.length;i++)c=this.decodeTextureFromJson(a[i],e),ccs.armatureDataManager.addTextureData(c.name,c,e.filename);var l=null==e.asyncStruct?ccs.armatureDataManager.isAutoLoadSpriteFile():e.asyncStruct.autoLoadSpriteFile;if(l){var h,u,d,_,p=t[ccs.CONST_CONFIG_FILE_PATH]||[];for(i=0;i<p.length;i++)h=p[i],u=h.lastIndexOf("."),h=h.substring(0,u),d=e.basefilePath+h+".plist",_=e.basefilePath+h+".png",ccs.armatureDataManager.addSpriteFrameFromFile(d,_,e.filename)}n=null,o=null},decodeNodeFromJson:function(t,e,i){t.x=e[ccs.CONST_A_X]*this._positionReadScale,t.y=e[ccs.CONST_A_Y]*this._positionReadScale,t.x*=i.contentScale,t.y*=i.contentScale,t.zOrder=e[ccs.CONST_A_Z],t.skewX=e[ccs.CONST_A_SKEW_X]||0,t.skewY=e[ccs.CONST_A_SKEW_Y]||0,t.scaleX=null==e[ccs.CONST_A_SCALE_X]?1:e[ccs.CONST_A_SCALE_X],t.scaleY=null==e[ccs.CONST_A_SCALE_Y]?1:e[ccs.CONST_A_SCALE_Y];var n;i.cocoStudioVersion<ccs.VERSION_COLOR_READING?(n=e[0],n&&(t.a=null==n[ccs.CONST_A_ALPHA]?255:n[ccs.CONST_A_ALPHA],t.r=null==n[ccs.CONST_A_RED]?255:n[ccs.CONST_A_RED],t.g=null==n[ccs.CONST_A_GREEN]?255:n[ccs.CONST_A_GREEN],t.b=null==n[ccs.CONST_A_BLUE]?255:n[ccs.CONST_A_BLUE],t.isUseColorInfo=!0)):(n=e[ccs.CONST_COLOR_INFO]||null,n&&(t.a=null==n[ccs.CONST_A_ALPHA]?255:n[ccs.CONST_A_ALPHA],t.r=null==n[ccs.CONST_A_RED]?255:n[ccs.CONST_A_RED],t.g=null==n[ccs.CONST_A_GREEN]?255:n[ccs.CONST_A_GREEN],t.b=null==n[ccs.CONST_A_BLUE]?255:n[ccs.CONST_A_BLUE],t.isUseColorInfo=!0))},clear:function(){this._configFileList=[],this._asyncRefCount=0,this._asyncRefTotalCount=0},_asyncCallBack:function(t,e,i){t&&cc.isFunction(t)&&t.call(e,i),e&&t&&"string"==typeof t&&e[t](i)},_initBaseFilePath:function(t){var e=t,i=e.lastIndexOf("/");return e=i>-1?e.substr(0,i+1):""},addDataFromXML:function(t,e){var i=cc.loader.getRes(t);if(!i)throw new Error("Please load the resource first : "+t);var n=cc.saxParser.parse(i),r=n.documentElement;r&&this.addDataFromCache(r,e)},addDataFromJson:function(t,e){var i=cc.loader.getRes(t);this.addDataFromJsonCache(i,e)}},ccs.spriteFrameCacheHelper={_textureAtlasDic:{},_imagePaths:[],addSpriteFrameFromFile:function(t,e){cc.spriteFrameCache.addSpriteFrames(t,e)},getTextureAtlasWithTexture:function(t){return null},clear:function(){this._textureAtlasDic={},this._imagePaths=[]}},ccs.TransformHelp=ccs.TransformHelp||ccs.Class.extend({}),ccs.TransformHelp.helpMatrix1=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpMatrix2=cc.affineTransformMake(1,0,0,1,0,0),ccs.TransformHelp.helpPoint1=cc.p(0,0),ccs.TransformHelp.helpPoint2=cc.p(0,0),ccs.TransformHelp.helpParentNode={},ccs.TransformHelp.transformFromParent=function(t,e){this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(e,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformToParent=function(t,e){this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(e,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformFromParentWithoutScale=function(t,e){for(var i in e)this.helpParentNode[i]=e[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix2=cc.affineTransformInvert(this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.transformToParentWithoutScale=function(t,e){for(var i in e)this.helpParentNode[i]=e[i];this.helpParentNode.scaleX=1,this.helpParentNode.scaleY=1,this.nodeToMatrix(t,this.helpMatrix1),this.nodeToMatrix(this.helpParentNode,this.helpMatrix2),this.helpMatrix1=cc.affineTransformConcat(this.helpMatrix1,this.helpMatrix2),this.matrixToNode(this.helpMatrix1,t)},ccs.TransformHelp.nodeToMatrix=function(t,e){if(t.skewX===-t.skewY){var i=Math.sin(t.skewX),n=Math.cos(t.skewX);e.a=t.scaleX*n,e.b=t.scaleX*-i,e.c=t.scaleY*i,e.d=t.scaleY*n}else e.a=t.scaleX*Math.cos(t.skewY),e.b=t.scaleX*Math.sin(t.skewY),e.c=t.scaleY*Math.sin(t.skewX),e.d=t.scaleY*Math.cos(t.skewX);e.tx=t.x,e.ty=t.y},ccs.TransformHelp.matrixToNode=function(t,e){this.helpPoint1.x=0,this.helpPoint1.y=1,this.helpPoint1=cc.pointApplyAffineTransform(this.helpPoint1,t),this.helpPoint1.x-=t.tx,this.helpPoint1.y-=t.ty,this.helpPoint2.x=1,this.helpPoint2.y=0,this.helpPoint2=cc.pointApplyAffineTransform(this.helpPoint2,t),this.helpPoint2.x-=t.tx,this.helpPoint2.y-=t.ty,e.skewX=-(Math.atan2(this.helpPoint1.y,this.helpPoint1.x)-1.5707964),e.skewY=Math.atan2(this.helpPoint2.y,this.helpPoint2.x),e.scaleX=Math.sqrt(t.a*t.a+t.b*t.b),e.scaleY=Math.sqrt(t.c*t.c+t.d*t.d),e.x=t.tx,e.y=t.ty},ccs.TransformHelp.nodeConcat=function(t,e){t.x+=e.x,t.y+=e.y,t.skewX+=e.skewX,t.skewY+=e.skewY,t.scaleX+=e.scaleX,t.scaleY+=e.scaleY},ccs.TransformHelp.nodeSub=function(t,e){t.x-=e.x,t.y-=e.y,t.skewX-=e.skewX,t.skewY-=e.skewY,t.scaleX-=e.scaleX,t.scaleY-=e.scaleY},ccs.TweenType={CUSTOM_EASING:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e4},ccs.TweenFunction=ccs.TweenFunction||ccs.Class.extend({}),ccs.DOUBLE_PI=ccs.M_PI_X_2=2*Math.PI,ccs.HALF_PI=ccs.M_PI_2=Math.PI/2,ccs.M_PI=Math.PI,ccs.TweenFunction.tweenTo=function(t,e,i){var n=0;switch(e){case ccs.TweenType.CUSTOM_EASING:n=this.customEase(t,i);break;case ccs.TweenType.LINEAR:n=this.linear(t);break;case ccs.TweenType.SINE_EASEIN:n=this.sineEaseIn(t);break;case ccs.TweenType.SINE_EASEOUT:n=this.sineEaseOut(t);break;case ccs.TweenType.SINE_EASEINOUT:n=this.sineEaseInOut(t);break;case ccs.TweenType.QUAD_EASEIN:n=this.quadEaseIn(t);break;case ccs.TweenType.QUAD_EASEOUT:n=this.quadEaseOut(t);break;case ccs.TweenType.QUAD_EASEINOUT:n=this.quadEaseInOut(t);break;case ccs.TweenType.CUBIC_EASEIN:n=this.cubicEaseIn(t);break;case ccs.TweenType.CUBIC_EASEOUT:n=this.cubicEaseOut(t);break;case ccs.TweenType.CUBIC_EASEINOUT:n=this.cubicEaseInOut(t);break;case ccs.TweenType.QUART_EASEIN:n=this.quartEaseIn(t);break;case ccs.TweenType.QUART_EASEOUT:n=this.quartEaseOut(t);break;case ccs.TweenType.QUART_EASEINOUT:n=this.quartEaseInOut(t);break;case ccs.TweenType.QUINT_EASEIN:n=this.quintEaseIn(t);break;case ccs.TweenType.QUINT_EASEOUT:n=this.quintEaseOut(t);break;case ccs.TweenType.QUINT_EASEINOUT:n=this.quintEaseInOut(t);break;case ccs.TweenType.EXPO_EASEIN:n=this.expoEaseIn(t);break;case ccs.TweenType.EXPO_EASEOUT:n=this.expoEaseOut(t);break;case ccs.TweenType.EXPO_EASEINOUT:n=this.expoEaseInOut(t);break;case ccs.TweenType.CIRC_EASEIN:n=this.circEaseIn(t);break;case ccs.TweenType.CIRC_EASEOUT:n=this.circEaseOut(t);break;case ccs.TweenType.CIRC_EASEINOUT:n=this.circEaseInOut(t);break;case ccs.TweenType.ELASTIC_EASEIN:var r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseIn(t,r);break;case ccs.TweenType.ELASTIC_EASEOUT:var r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseOut(t,r);break;case ccs.TweenType.ELASTIC_EASEINOUT:var r=.3;null!=i&&i.length>0&&(r=i[0]),n=this.elasticEaseInOut(t,r);break;case ccs.TweenType.BACK_EASEIN:n=this.backEaseIn(t);break;case ccs.TweenType.BACK_EASEOUT:n=this.backEaseOut(t);break;case ccs.TweenType.BACK_EASEINOUT:n=this.backEaseInOut(t);break;case ccs.TweenType.BOUNCE_EASEIN:n=this.bounceEaseIn(t);break;case ccs.TweenType.BOUNCE_EASEOUT:n=this.bounceEaseOut(t);break;case ccs.TweenType.BOUNCE_EASEINOUT:n=this.bounceEaseInOut(t);break;default:n=this.sineEaseInOut(t)}return n},ccs.TweenFunction.linear=function(t){return t},ccs.TweenFunction.sineEaseIn=function(t){return-1*Math.cos(t*ccs.HALF_PI)+1},ccs.TweenFunction.sineEaseOut=function(t){return Math.sin(t*ccs.HALF_PI)},ccs.TweenFunction.sineEaseInOut=function(t){return-.5*(Math.cos(ccs.M_PI*t)-1)},ccs.TweenFunction.quadEaseIn=function(t){return t*t},ccs.TweenFunction.quadEaseOut=function(t){return-1*t*(t-2)},ccs.TweenFunction.quadEaseInOut=function(t){return t*=2,t<1?.5*t*t:(--t,-.5*(t*(t-2)-1))},ccs.TweenFunction.cubicEaseIn=function(t){return t*t*t},ccs.TweenFunction.cubicEaseOut=function(t){return t-=1,t*t*t+1},ccs.TweenFunction.cubicEaseInOut=function(t){return t*=2,t<1?.5*t*t*t:(t-=2,.5*(t*t*t+2))},ccs.TweenFunction.quartEaseIn=function(t){return t*t*t*t},ccs.TweenFunction.quartEaseOut=function(t){return t-=1,-(t*t*t*t-1)},ccs.TweenFunction.quartEaseInOut=function(t){return t*=2,t<1?.5*t*t*t*t:(t-=2,-.5*(t*t*t*t-2))},ccs.TweenFunction.quintEaseIn=function(t){return t*t*t*t*t},ccs.TweenFunction.quintEaseOut=function(t){return t-=1,t*t*t*t*t+1},ccs.TweenFunction.quintEaseInOut=function(t){return t*=2,t<1?.5*t*t*t*t*t:(t-=2,.5*(t*t*t*t*t+2))},ccs.TweenFunction.expoEaseIn=function(t){return 0===t?0:Math.pow(2,10*(t-1))-.001},ccs.TweenFunction.expoEaseOut=function(t){return 1===t?1:-Math.pow(2,-10*t)+1},ccs.TweenFunction.expoEaseInOut=function(t){return t/=.5,t=t<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)},ccs.TweenFunction.circEaseIn=function(t){return-1*(Math.sqrt(1-t*t)-1)},ccs.TweenFunction.circEaseOut=function(t){return t-=1,Math.sqrt(1-t*t)},ccs.TweenFunction.circEaseInOut=function(t){return t*=2,t<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},ccs.TweenFunction.elasticEaseIn=function(t,e){var i=.3;e.length>0&&(i=e[0]);var n=0;if(0===t||1===t)n=t;else{var r=i/4;t-=1,n=-Math.pow(2,10*t)*Math.sin((t-r)*ccs.DOUBLE_PI/i)}return n},ccs.TweenFunction.elasticEaseOut=function(t,e){var i=.3;e.length>0&&(i=e[0]);var n=0;if(0===t||1===t)n=t;else{var r=i/4;n=Math.pow(2,-10*t)*Math.sin((t-r)*ccs.DOUBLE_PI/i)+1}return n},ccs.TweenFunction.elasticEaseInOut=function(t,e){var i=.3;e.length>0&&(i=e[0]);var n=0;if(0===t||1===t)n=t;else{t*=2,i||(i=.3*1.5);var r=i/4;t-=1,n=t<0?-.5*Math.pow(2,10*t)*Math.sin((t-r)*ccs.DOUBLE_PI/i):Math.pow(2,-10*t)*Math.sin((t-r)*ccs.DOUBLE_PI/i)*.5+1}return n},ccs.TweenFunction.backEaseIn=function(t){var e=1.70158;return t*t*((e+1)*t-e)},ccs.TweenFunction.backEaseOut=function(t){var e=1.70158;return t-=1,t*t*((e+1)*t+e)+1},ccs.TweenFunction.backEaseInOut=function(t){var e=2.5949095;return t*=2,t<1?t*t*((e+1)*t-e)/2:(t-=2,t*t*((e+1)*t+e)/2+1)},ccs.bounceTime=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?(t-=1.5/2.75,7.5625*t*t+.75):t<2.5/2.75?(t-=2.25/2.75,7.5625*t*t+.9375):(t-=2.625/2.75,7.5625*t*t+.984375)},ccs.TweenFunction.bounceEaseIn=function(t){return 1-ccs.bounceTime(1-t)},ccs.TweenFunction.bounceEaseOut=function(t){return ccs.bounceTime(t)},ccs.TweenFunction.bounceEaseInOut=function(t){var e=0;return t<.5?(t*=2,e=.5*(1-ccs.bounceTime(1-t))):e=.5*ccs.bounceTime(2*t-1)+.5,e},ccs.TweenFunction.customEase=function(t,e){if(e.length>0){var i=1-t;return e[1]*i*i*i+3*e[3]*t*i*i+3*e[5]*t*t*i+e[7]*t*t*t}return t},ccs.TweenFunction.easeIn=function(t,e){return Math.pow(t,e)},ccs.TweenFunction.easeOut=function(t,e){return Math.pow(t,1/e)},ccs.TweenFunction.easeInOut=function(t,e){return t*=2,t<1?.5*Math.pow(t,e):1-.5*Math.pow(2-t,e)},ccs.TweenFunction.quadraticIn=function(t){return Math.pow(t,2)},ccs.TweenFunction.quadraticOut=function(t){return-t*(t-2)},ccs.TweenFunction.bezieratFunction=function(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n};var ENABLE_PHYSICS_DETECT=!1;ccs.fmodf=function(t,e){for(;t>e;)t-=e;return t};var CC_SAFE_RELEASE=function(t){t&&t.release&&t.release()};ccs.isSpriteContainPoint=function(t,e,i){var n=t.convertToNodeSpace(e);i&&(i.x=n.x,i.y=n.y);var r=t.getContentSize();return cc.rectContainsPoint(cc.rect(0,0,r.width,r.height),n)},ccs.SPRITE_CONTAIN_POINT=ccs.isSpriteContainPoint,ccs.SPRITE_CONTAIN_POINT_WITH_RETURN=ccs.isSpriteContainPoint,ccs.extBezierTo=function(t,e,i,n,r){var o=cc.p(0,0);return n&&!r&&(o.x=Math.pow(1-t,2)*e.x+2*t*(1-t)*i.x+Math.pow(t,2)*n.x,o.y=Math.pow(1-t,2)*e.y+2*t*(1-t)*i.y+Math.pow(t,2)*n.y),r&&(o.x=e.x*Math.pow(1-t,3)+3*t*i.x*Math.pow(1-t,2)+3*n.x*Math.pow(t,2)*(1-t)+r.x*Math.pow(t,3),o.y=e.y*Math.pow(1-t,3)+3*t*i.y*Math.pow(1-t,2)+3*n.y*Math.pow(t,2)*(1-t)+r.y*Math.pow(t,3)),o},ccs.extCircleTo=function(t,e,i,n,r){var o=cc.p(0,0);return o.x=e.x+i*Math.cos(n+r*t),o.y=e.y+i*Math.sin(n+r*t),o},ccs.RelativeData=function(){this.plistFiles=[],this.armatures=[],this.animations=[],this.textures=[]},ccs.armatureDataManager={_animationDatas:{},_armatureDatas:{},_textureDatas:{},_autoLoadSpriteFile:!1,_relativeDatas:{},s_sharedArmatureDataManager:null,removeArmatureFileInfo:function(t){var e=this.getRelativeData(t);if(e){var i,n;for(i=0;i<e.armatures.length;i++)n=e.armatures[i],this.removeArmatureData(n);for(i=0;i<e.animations.length;i++)n=e.animations[i],this.removeAnimationData(n);for(i=0;i<e.textures.length;i++)n=e.textures[i],this.removeTextureData(n);for(i=0;i<e.plistFiles.length;i++)n=e.plistFiles[i],cc.spriteFrameCache.removeSpriteFramesFromFile(n);delete this._relativeDatas[t],ccs.dataReaderHelper.removeConfigFile(t)}},addArmatureData:function(t,e,i){var n=this.getRelativeData(i);n&&n.armatures.push(t),this._armatureDatas[t]=e},getArmatureData:function(t){var e=null;return this._armatureDatas&&(e=this._armatureDatas[t]),e},removeArmatureData:function(t){this._armatureDatas[t]&&delete this._armatureDatas[t]},addAnimationData:function(t,e,i){var n=this.getRelativeData(i);n&&n.animations.push(t),this._animationDatas[t]=e},getAnimationData:function(t){var e=null;return this._animationDatas[t]&&(e=this._animationDatas[t]),e},removeAnimationData:function(t){this._animationDatas[t]&&delete this._animationDatas[t]},addTextureData:function(t,e,i){var n=this.getRelativeData(i);n&&n.textures.push(t),this._textureDatas[t]=e},getTextureData:function(t){var e=null;return this._textureDatas&&(e=this._textureDatas[t]),e},removeTextureData:function(t){this._textureDatas[t]&&delete this._textureDatas[t]},addArmatureFileInfo:function(){var t,e,i;switch(arguments.length){case 1:i=arguments[0],this.addRelativeData(i),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFile(i);break;case 3:t=arguments[0],e=arguments[1],i=arguments[2],this.addRelativeData(i),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFile(i),this.addSpriteFrameFromFile(e,t)}},addArmatureFileInfoAsync:function(){var t,e,i,n,r;switch(arguments.length){case 3:i=arguments[0],n=arguments[2],r=arguments[1],this.addRelativeData(i),this._autoLoadSpriteFile=!0,ccs.dataReaderHelper.addDataFromFileAsync("","",i,r,n);break;case 5:t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[4],r=arguments[3],this.addRelativeData(i),this._autoLoadSpriteFile=!1,ccs.dataReaderHelper.addDataFromFileAsync(t,e,i,r,n),this.addSpriteFrameFromFile(e,t)}},addSpriteFrameFromFile:function(t,e,i){var n=this.getRelativeData(i);n&&n.plistFiles.push(t),ccs.spriteFrameCacheHelper.addSpriteFrameFromFile(t,e)},isAutoLoadSpriteFile:function(){return this._autoLoadSpriteFile},getArmatureDatas:function(){return this._armatureDatas},getAnimationDatas:function(){return this._animationDatas},getTextureDatas:function(){return this._textureDatas},addRelativeData:function(t){this._relativeDatas[t]||(this._relativeDatas[t]=new ccs.RelativeData)},getRelativeData:function(t){return this._relativeDatas[t]},clear:function(){for(var t in this._relativeDatas)this.removeArmatureFileInfo(t);this._animationDatas={},this._armatureDatas={},this._textureDatas={},this._relativeDatas={},ccs.spriteFrameCacheHelper.clear(),ccs.dataReaderHelper.clear()}},ccs.BLEND_TYPE_NORMAL=0,ccs.BLEND_TYPE_LAYER=1,ccs.BLEND_TYPE_DARKEN=2,ccs.BLEND_TYPE_MULTIPLY=3,ccs.BLEND_TYPE_LIGHTEN=4,ccs.BLEND_TYPE_SCREEN=5,ccs.BLEND_TYPE_OVERLAY=6,ccs.BLEND_TYPE_HIGHLIGHT=7,ccs.BLEND_TYPE_ADD=8,ccs.BLEND_TYPE_SUBTRACT=9,ccs.BLEND_TYPE_DIFFERENCE=10,ccs.BLEND_TYPE_INVERT=11,ccs.BLEND_TYPE_ALPHA=12,ccs.BLEND_TYPE_ERASE=13,ccs.DISPLAY_TYPE_SPRITE=0,ccs.DISPLAY_TYPE_ARMATURE=1,ccs.DISPLAY_TYPE_PARTICLE=2,ccs.DISPLAY_TYPE_MAX=3,ccs.BaseData=ccs.Class.extend({x:0,y:0,zOrder:0,skewX:0,skewY:0,scaleX:1,scaleY:1,tweenRotate:0,isUseColorInfo:!1,r:255,g:255,b:255,a:255,ctor:function(){this.x=0,this.y=0,this.zOrder=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1,this.tweenRotate=0,this.isUseColorInfo=!1,this.r=255,this.g=255,this.b=255,this.a=255},copy:function(t){this.x=t.x,this.y=t.y,this.zOrder=t.zOrder,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.skewX=t.skewX,this.skewY=t.skewY,this.tweenRotate=t.tweenRotate,this.isUseColorInfo=t.isUseColorInfo,this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},setColor:function(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a},getColor:function(){return cc.color(this.r,this.g,this.b,this.a)},subtract:function(t,e,i){this.x=e.x-t.x,this.y=e.y-t.y,this.scaleX=e.scaleX-t.scaleX,this.scaleY=e.scaleY-t.scaleY,this.skewX=e.skewX-t.skewX,this.skewY=e.skewY-t.skewY,this.isUseColorInfo||t.isUseColorInfo||e.isUseColorInfo?(this.a=e.a-t.a,this.r=e.r-t.r,this.g=e.g-t.g,this.b=e.b-t.b,this.isUseColorInfo=!0):(this.a=this.r=this.g=this.b=0,this.isUseColorInfo=!1),i&&(this.skewX>ccs.M_PI&&(this.skewX-=ccs.DOUBLE_PI),this.skewX<-ccs.M_PI&&(this.skewX+=ccs.DOUBLE_PI),this.skewY>ccs.M_PI&&(this.skewY-=ccs.DOUBLE_PI),this.skewY<-ccs.M_PI&&(this.skewY+=ccs.DOUBLE_PI)),e.tweenRotate&&(this.skewX+=e.tweenRotate*ccs.PI*2,this.skewY-=e.tweenRotate*ccs.PI*2)}}),ccs.DisplayData=ccs.Class.extend({displayType:ccs.DISPLAY_TYPE_MAX,displayName:"",ctor:function(){this.displayType=ccs.DISPLAY_TYPE_MAX},changeDisplayToTexture:function(t){var e=t,i=e.lastIndexOf(".");return i!==-1&&(e=e.substring(0,i)),e},copy:function(t){this.displayName=t.displayName,this.displayType=t.displayType}}),ccs.SpriteDisplayData=ccs.DisplayData.extend({skinData:null,ctor:function(){this.skinData=new ccs.BaseData,this.displayType=ccs.DISPLAY_TYPE_SPRITE},copy:function(t){ccs.DisplayData.prototype.copy.call(this,t),this.skinData=t.skinData}}),ccs.ArmatureDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayName="",this.displayType=ccs.DISPLAY_TYPE_ARMATURE}}),ccs.ParticleDisplayData=ccs.DisplayData.extend({ctor:function(){this.displayType=ccs.DISPLAY_TYPE_PARTICLE}}),ccs.BoneData=ccs.BaseData.extend({displayDataList:null,name:"",parentName:"",boneDataTransform:null,ctor:function(){this.displayDataList=[],this.name="",this.parentName="",this.boneDataTransform=null},init:function(){return this.displayDataList.length=0,!0},addDisplayData:function(t){this.displayDataList.push(t)},getDisplayData:function(t){return this.displayDataList[t]}}),ccs.ArmatureData=ccs.Class.extend({boneDataDic:null,name:"",dataVersion:.1,ctor:function(){this.boneDataDic={},this.name="",this.dataVersion=.1},init:function(){return!0},addBoneData:function(t){this.boneDataDic[t.name]=t},getBoneDataDic:function(){return this.boneDataDic},getBoneData:function(t){return this.boneDataDic[t]}}),ccs.FrameData=ccs.BaseData.extend({duration:0,tweenEasing:0,easingParamNumber:0,easingParams:null,displayIndex:-1,movement:"",event:"",sound:"",soundEffect:"",blendFunc:null,frameID:0,isTween:!0,ctor:function(){ccs.BaseData.prototype.ctor.call(this),this.duration=1,this.tweenEasing=ccs.TweenType.LINEAR,this.easingParamNumber=0,this.easingParams=[],this.displayIndex=0,this.movement="",this.event="",this.sound="",this.soundEffect="",this.blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.frameID=0,this.isTween=!0},copy:function(t){if(ccs.BaseData.prototype.copy.call(this,t),this.duration=t.duration,this.displayIndex=t.displayIndex,this.tweenEasing=t.tweenEasing,this.easingParamNumber=t.easingParamNumber,0!==this.easingParamNumber){this.easingParams.length=0;for(var e=0;e<this.easingParamNumber;e++)this.easingParams[e]=t.easingParams[e]}this.blendFunc=t.blendFunc,this.isTween=t.isTween}}),ccs.MovementBoneData=ccs.Class.extend({delay:0,scale:1,duration:0,frameList:null,name:"",ctor:function(){this.delay=0,this.scale=1,this.duration=0,this.frameList=[],this.name=""},init:function(){return!0},addFrameData:function(t){this.frameList.push(t)},getFrameData:function(t){return this.frameList[t]}}),ccs.MovementData=function(){this.name="",this.duration=0,this.scale=1,this.durationTo=0,this.durationTween=0,this.loop=!0,this.tweenEasing=ccs.TweenType.LINEAR,this.movBoneDataDic={}},ccs.MovementData.prototype.addMovementBoneData=function(t){this.movBoneDataDic[t.name]=t},ccs.MovementData.prototype.getMovementBoneData=function(t){return this.movBoneDataDic[t]},ccs.AnimationData=function(){this.movementDataDic={},this.movementNames=[],this.name=""},ccs.AnimationData.prototype.addMovement=function(t){this.movementDataDic[t.name]=t,this.movementNames.push(t.name)},ccs.AnimationData.prototype.getMovement=function(t){return this.movementDataDic[t]},ccs.AnimationData.prototype.getMovementCount=function(){return Object.keys(this.movementDataDic).length},ccs.ContourVertex2=function(t,e){this.x=t||0,this.y=e||0},ccs.ContourData=function(){this.vertexList=[]},ccs.ContourData.prototype.init=function(){return this.vertexList.length=0,!0},ccs.ContourData.prototype.addVertex=function(t){this.vertexList.push(t)},ccs.TextureData=function(){this.height=0,this.width=0,this.pivotX=.5,this.pivotY=.5,this.name="",this.contourDataList=[]},ccs.TextureData.prototype.init=function(){this.contourDataList.length=0},ccs.TextureData.prototype.addContourData=function(t){this.contourDataList.push(t)},ccs.TextureData.prototype.getContourData=function(t){return this.contourDataList[t]},ccs.DecorativeDisplay=ccs.Class.extend({_display:null,_colliderDetector:null,_displayData:null,ctor:function(){this._display=null,this._colliderDetector=null,this._displayData=null},init:function(){return!0},setDisplay:function(t){t._parent&&(t._parent.removeChild(t),delete t._parent),this._display=t},getDisplay:function(){return this._display},setColliderDetector:function(t){this._colliderDetector=t},getColliderDetector:function(){return this._colliderDetector},setDisplayData:function(t){this._displayData=t},getDisplayData:function(){return this._displayData},release:function(){this._display=null,this._displayData=null,this._colliderDetector=null}}),ccs.DecorativeDisplay.create=function(){return new ccs.DecorativeDisplay},ccs.displayFactory={addDisplay:function(t,e,i){switch(i.displayType){case ccs.DISPLAY_TYPE_SPRITE:this.addSpriteDisplay(t,e,i);break;case ccs.DISPLAY_TYPE_PARTICLE:this.addParticleDisplay(t,e,i);break;case ccs.DISPLAY_TYPE_ARMATURE:this.addArmatureDisplay(t,e,i)}},createDisplay:function(t,e){switch(e.getDisplayData().displayType){case ccs.DISPLAY_TYPE_SPRITE:this.createSpriteDisplay(t,e);break;case ccs.DISPLAY_TYPE_PARTICLE:this.createParticleDisplay(t,e);break;case ccs.DISPLAY_TYPE_ARMATURE:this.createArmatureDisplay(t,e)}},_helpTransform:{a:1,b:0,c:0,d:1,tx:0,ty:0},updateDisplay:function(t,e,i){var n=t.getDisplayRenderNode();if(n){switch(t.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:i&&(n._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),n.updateArmatureTransform());break;case ccs.DISPLAY_TYPE_PARTICLE:this.updateParticleDisplay(t,n,e);break;case ccs.DISPLAY_TYPE_ARMATURE:this.updateArmatureDisplay(t,n,e);break;default:var r=t.getNodeToArmatureTransform();n.setAdditionalTransform(r)}if((ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&i){var o=t.getDisplayManager().getCurrentDecorativeDisplay(),s=o.getColliderDetector();if(s){var c=o.getDisplay(),a=c.getNodeToParentTransform(),l=this._helpTransform;l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l.tx=a.tx,l.ty=a.ty;var h=cc.pointApplyAffineTransform(c.getAnchorPointInPoints(),l);l.tx=h.x,l.ty=h.y;var u=cc.affineTransformConcat(l,t.getArmature().getNodeToParentTransform());s.updateTransform(u)}}}},addSpriteDisplay:function(t,e,i){var n=new ccs.SpriteDisplayData;n.copy(i),e.setDisplayData(n),this.createSpriteDisplay(t,e)},createSpriteDisplay:function(t,e){var i=null,n=e.getDisplayData(),r=n.displayName,o=r.lastIndexOf(".");o!==-1&&(r=r.substring(0,o)),i=""===r?new ccs.Skin:new ccs.Skin("#"+r+".png"),e.setDisplay(i),i.setBone(t),this.initSpriteDisplay(t,e,n.displayName,i);var s=t.getArmature();s&&(s.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?i.setSkinData(n.skinData):i.setSkinData(t.boneData))},initSpriteDisplay:function(t,e,i,n){var r=i,o=r.lastIndexOf(".");o!==-1&&(r=r.substring(0,o));var s=ccs.armatureDataManager.getTextureData(r);if(s&&n.setAnchorPoint(cc.p(s.pivotX,s.pivotY)),(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&s&&s.contourDataList.length>0){var c=new ccs.ColliderDetector(t);c.addContourDataList(s.contourDataList),e.setColliderDetector(c)}},addArmatureDisplay:function(t,e,i){var n=new ccs.ArmatureDisplayData;n.copy(i),e.setDisplayData(n),this.createArmatureDisplay(t,e)},createArmatureDisplay:function(t,e){var i=e.getDisplayData(),n=new ccs.Armature(i.displayName,t);e.setDisplay(n)},updateArmatureDisplay:function(t,e,i){e&&(e.sortAllChildren(),e.update(i))},addParticleDisplay:function(t,e,i){var n=new ccs.ParticleDisplayData;n.copy(i),e.setDisplayData(n),this.createParticleDisplay(t,e)},createParticleDisplay:function(t,e){var i=e.getDisplayData(),n=new cc.ParticleSystem(i.displayName);n.removeFromParent(),n.cleanup();var r=t.getArmature();r&&n.setParent(t.getArmature()),e.setDisplay(n)},updateParticleDisplay:function(t,e,i){var n=new ccs.BaseData;ccs.TransformHelp.matrixToNode(t.nodeToArmatureTransform(),n),e.setPosition(n.x,n.y),e.setScaleX(n.scaleX),e.setScaleY(n.scaleY),e.update(i)}},ccs.DisplayManager=ccs.Class.extend({_decoDisplayList:null,_currentDecoDisplay:null,_displayRenderNode:null,_displayIndex:null,_forceChangeDisplay:!1,_bone:null,_visible:!0,_displayType:null,ctor:function(t){this._decoDisplayList=[],this._currentDecoDisplay=null,this._displayRenderNode=null,this._displayIndex=null,this._forceChangeDisplay=!1,this._bone=null,this._visible=!0,this._displayType=ccs.DISPLAY_TYPE_MAX,t&&ccs.DisplayManager.prototype.init.call(this,t)},init:function(t){return this._bone=t,this.initDisplayList(t.getBoneData()),!0},addDisplay:function(t,e){var i,n=this._decoDisplayList;if(e>=0&&e<n.length?i=n[e]:(i=new ccs.DecorativeDisplay,n.push(i)),t instanceof ccs.DisplayData)return ccs.displayFactory.addDisplay(this._bone,i,t),void(e===this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(e,!1)));var r=null;if(t instanceof ccs.Skin){t.setBone(this._bone),r=new ccs.SpriteDisplayData,ccs.displayFactory.initSpriteDisplay(this._bone,i,t.getDisplayName(),t);var o=i.getDisplayData();if(o instanceof ccs.SpriteDisplayData)t.setSkinData(o.skinData),r.skinData=o.skinData;else{for(var s=!1,c=n.length-2;c>=0;c--){var a=n[c],l=a.getDisplayData();if(l instanceof ccs.SpriteDisplayData){s=!0,t.setSkinData(l.skinData),r.skinData=l.skinData;break}}s||t.setSkinData(new ccs.BaseData)}}else if(t instanceof cc.ParticleSystem){r=new ccs.ParticleDisplayData,t.removeFromParent(),t.cleanup();var h=this._bone.getArmature();h&&t.setParent(h)}else t instanceof ccs.Armature?(r=new ccs.ArmatureDisplayData,r.displayName=t.getName(),t.setParentBone(this._bone)):r=new ccs.DisplayData;i.setDisplay(t),i.setDisplayData(r),e===this._displayIndex&&(this._displayIndex=-1,this.changeDisplayWithIndex(e,!1))},_addDisplayOther:function(t,e){var i=null;if(e instanceof ccs.Skin){var n=e;n.setBone(this._bone),i=new ccs.SpriteDisplayData,i.displayName=n.getDisplayName(),ccs.displayFactory.initSpriteDisplay(this._bone,t,n.getDisplayName(),n);var r=t.getDisplayData();if(r instanceof ccs.SpriteDisplayData)n.setSkinData(r.skinData);else{for(var o=!1,s=this._decoDisplayList.length-2;s>=0;s--){var c=this._decoDisplayList[s],a=c.getDisplayData();if(a){o=!0,n.setSkinData(a.skinData),i.skinData=a.skinData;break}}o||n.setSkinData(new ccs.BaseData),n.setSkinData(new ccs.BaseData)}}else e instanceof cc.ParticleSystem?(i=new ccs.ParticleDisplayData,i.displayName=e._plistFile):e instanceof ccs.Armature?(i=new ccs.ArmatureDisplayData,i.displayName=e.getName(),e.setParentBone(this._bone)):i=new ccs.DisplayData;t.setDisplay(e),t.setDisplayData(i)},removeDisplay:function(t){this._decoDisplayList.splice(t,1),t===this._displayIndex&&(this.setCurrentDecorativeDisplay(null),this._displayIndex=-1)},getDecorativeDisplayList:function(){return this._decoDisplayList},changeDisplayWithIndex:function(t,e){return t>=this._decoDisplayList.length?void cc.log("the index value is out of range"):(this._forceChangeDisplay=e,this._displayIndex!==t?(this._displayIndex=t,t<0?void(this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this.setCurrentDecorativeDisplay(null))):void this.setCurrentDecorativeDisplay(this._decoDisplayList[t])):void 0)},changeDisplayWithName:function(t,e){for(var i=this._decoDisplayList,n=0;n<i.length;n++)if(i[n].getDisplayData().displayName===t){this.changeDisplayWithIndex(n,e);break}},setCurrentDecorativeDisplay:function(t){var e=this._currentDecoDisplay;(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&e&&e.getColliderDetector()&&e.getColliderDetector().setActive(!1),this._currentDecoDisplay=t,e=this._currentDecoDisplay,(ccs.ENABLE_PHYSICS_CHIPMUNK_DETECT||ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)&&e&&e.getColliderDetector()&&e.getColliderDetector().setActive(!0);var i=e?e.getDisplay():null,n=this._displayRenderNode,r=this._bone;n&&(n instanceof ccs.Armature&&r.setChildArmature(null),n.removeFromParent(!0)),this._displayRenderNode=i,i?(i instanceof ccs.Armature?(this._bone.setChildArmature(i),i.setParentBone(this._bone)):i instanceof cc.ParticleSystem&&(i instanceof ccs.Armature?(r.setChildArmature(i),i.setParentBone(r)):i instanceof cc.ParticleSystem&&i.resetSystem()),i.setColor(r.getDisplayedColor()),i.setOpacity(r.getDisplayedOpacity()),this._displayRenderNode.setVisible(this._visible),this._displayType=this._currentDecoDisplay.getDisplayData().displayType):this._displayType=ccs.DISPLAY_TYPE_MAX,cc.renderer.childrenOrderDirty=!0},getDisplayRenderNode:function(){return this._displayRenderNode},getDisplayRenderNodeType:function(){return this._displayType},getCurrentDisplayIndex:function(){return this._displayIndex},getCurrentDecorativeDisplay:function(){return this._currentDecoDisplay},getDecorativeDisplayByIndex:function(t){return this._decoDisplayList[t]},initDisplayList:function(t){if(this._decoDisplayList.length=0,t)for(var e=t.displayDataList,i=this._decoDisplayList,n=this._bone,r=0;r<e.length;r++){var o=e[r],s=new ccs.DecorativeDisplay;s.setDisplayData(o),ccs.displayFactory.createDisplay(n,s),i.push(s)}},containPoint:function(t,e){if(!this._visible||this._displayIndex<0)return!1;if(void 0!==e&&(t=cc.p(t,e)),this._currentDecoDisplay.getDisplayData().displayType===ccs.DISPLAY_TYPE_SPRITE){var i=this._currentDecoDisplay.getDisplay();return i=i.getChildByTag(0),ccs.SPRITE_CONTAIN_POINT_WITH_RETURN(i,t)}return!1},setVisible:function(t){this._displayRenderNode&&(this._visible=t,this._displayRenderNode.setVisible(t))},isVisible:function(){return this._visible},getContentSize:function(){return this._displayRenderNode?this._displayRenderNode.getContentSize():cc.size(0,0)},getBoundingBox:function(){return this._displayRenderNode?this._displayRenderNode.getBoundingBox():cc.rect(0,0,0,0)},getAnchorPoint:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPoint():cc.p(0,0)},getAnchorPointInPoints:function(){return this._displayRenderNode?this._displayRenderNode.getAnchorPointInPoints():cc.p(0,0)},getForceChangeDisplay:function(){return this._forceChangeDisplay},release:function(){this._decoDisplayList=null,this._displayRenderNode&&(this._displayRenderNode.removeFromParent(!0),this._displayRenderNode=null)}}),ccs.DisplayManager.create=function(t){return new ccs.DisplayManager(t)},ccs.Skin=ccs.Sprite.extend({_skinData:null,bone:null,_skinTransform:null,_displayName:"",_armature:null,_className:"Skin",ctor:function(t,e){cc.Sprite.prototype.ctor.call(this),this._skinData=null,this.bone=null,this._displayName="",this._skinTransform=cc.affineTransformIdentity(),this._armature=null,null==t||""===t?ccs.Skin.prototype.init.call(this):"#"===t[0]?ccs.Skin.prototype.initWithSpriteFrameName.call(this,t.substr(1)):ccs.Skin.prototype.initWithFile.call(this,t,e)},initWithSpriteFrameName:function(t){if(""===t)return!1;var e=cc.spriteFrameCache.getSpriteFrame(t),i=!0;return e?this.initWithSpriteFrame(e):(cc.log("Can't find CCSpriteFrame with %s. Please check your .plist file",t),i=!1),this._displayName=t,i},initWithFile:function(t,e){var i=e?cc.Sprite.prototype.initWithFile.call(this,t,e):cc.Sprite.prototype.initWithFile.call(this,t);return this._displayName=t,i},setSkinData:function(t){this._skinData=t,this.setScaleX(t.scaleX),this.setScaleY(t.scaleY),this.setRotationX(cc.radiansToDegrees(t.skewX)),this.setRotationY(cc.radiansToDegrees(-t.skewY)),this.setPosition(t.x,t.y),this._renderCmd.transform()},getSkinData:function(){return this._skinData},updateArmatureTransform:function(){this._renderCmd.transform()},getNodeToWorldTransform:function(){return this._renderCmd.getNodeToWorldTransform()},getNodeToWorldTransformAR:function(){return this._renderCmd.getNodeToWorldTransformAR()},setBone:function(t){this.bone=t;var e=this.bone.getArmature();e&&(this._armature=e)},getBone:function(){return this.bone},getDisplayName:function(){return this._displayName},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Skin.CanvasRenderCmd(this):new ccs.Skin.WebGLRenderCmd(this)}});var _p=ccs.Skin.prototype;_p.skinData,cc.defineGetterSetter(_p,"skinData",_p.getSkinData,_p.setSkinData),_p.displayName,cc.defineGetterSetter(_p,"displayName",_p.getDisplayName),_p=null,ccs.Skin.create=function(t,e){return new ccs.Skin(t,e)},ccs.Skin.createWithSpriteFrameName=function(t){return new ccs.Skin("#"+t)},function(){ccs.Skin.RenderCmd={_realWorldTM:null,transform:function(t,e){var i=this._node,n=t?t._worldTransform:null,r=this._transform,o=this._worldTransform,s=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty;if((s||n)&&(this.originTransform(),cc.affineTransformConcatIn(r,i.bone.getNodeToArmatureTransform()),this._dirtyFlag=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty^this._dirtyFlag),n){o.a=r.a*n.a+r.b*n.c,o.b=r.a*n.b+r.b*n.d,o.c=r.c*n.a+r.d*n.c,o.d=r.c*n.b+r.d*n.d,o.tx=r.tx*n.a+r.ty*n.c+n.tx,o.ty=r.tx*n.b+r.ty*n.d+n.ty;var c=this._vertices;if(c){var a=i._offsetPosition.x,l=a+i._rect.width,h=i._offsetPosition.y,u=h+i._rect.height;c[0].x=a*o.a+u*o.c+o.tx,c[0].y=a*o.b+u*o.d+o.ty,c[1].x=a*o.a+h*o.c+o.tx,c[1].y=a*o.b+h*o.d+o.ty,c[2].x=l*o.a+u*o.c+o.tx,c[2].y=l*o.b+u*o.d+o.ty,c[3].x=l*o.a+h*o.c+o.tx,c[3].y=l*o.b+h*o.d+o.ty}}else o.a=r.a,o.b=r.b,o.c=r.c,o.d=r.d,o.tx=r.tx,o.ty=r.ty;var d=this._realWorldTM;d&&(d.a=r.a,d.b=r.b,d.c=r.c,d.d=r.d,d.tx=r.tx,d.ty=r.ty,cc.affineTransformConcatIn(d,this._node.bone.getArmature()._renderCmd._worldTransform))},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._transform,this._node.bone.getArmature().getNodeToWorldTransform())},getNodeToWorldTransformAR:function(){var t=this._transform,e=this._node;return this._anchorPointInPoints=cc.pointApplyAffineTransform(this._anchorPointInPoints,t),t.tx=this._anchorPointInPoints.x,t.ty=this._anchorPointInPoints.y,cc.affineTransformConcat(t,e.bone.getArmature().getNodeToWorldTransform())}},ccs.Skin.CanvasRenderCmd=function(t){cc.Sprite.CanvasRenderCmd.call(this,t),this._realWorldTM={a:1,b:0,c:0,d:1,tx:0,ty:0}};var t=ccs.Skin.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(ccs.Skin.RenderCmd,t),t.constructor=ccs.Skin.CanvasRenderCmd,t._updateCurrentRegions=function(){var t=this._currentRegion;this._currentRegion=this._oldRegion,this._oldRegion=t,cc.Node.CanvasRenderCmd.RegionStatus.DirtyDouble!==this._regionFlag||this._currentRegion.isEmpty()||this._oldRegion.union(this._currentRegion),this._currentRegion.updateRegion(this.getLocalBB(),this._realWorldTM)},ccs.Skin.WebGLRenderCmd=function(t){cc.Sprite.WebGLRenderCmd.call(this,t)},t=ccs.Skin.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype),cc.inject(ccs.Skin.RenderCmd,t),t.constructor=ccs.Skin.WebGLRenderCmd}(),ccs.ANIMATION_TYPE_SINGLE_FRAME=-4,ccs.ANIMATION_TYPE_NO_LOOP=-3,ccs.ANIMATION_TYPE_TO_LOOP_FRONT=-2,ccs.ANIMATION_TYPE_TO_LOOP_BACK=-1,ccs.ANIMATION_TYPE_LOOP_FRONT=0,ccs.ANIMATION_TYPE_LOOP_BACK=1,ccs.ANIMATION_TYPE_MAX=2,ccs.ProcessBase=ccs.Class.extend({_processScale:1,_isComplete:!0,_isPause:!0,_isPlaying:!1,_currentPercent:0,_rawDuration:0,_loopType:0,_tweenEasing:0,animationInternal:null,_currentFrame:0,_durationTween:0,_nextFrameIndex:0,_curFrameIndex:null,_isLoopBack:!1,ctor:function(){this._processScale=1,this._isComplete=!0,this._isPause=!0,this._isPlaying=!1,this._currentFrame=0,this._currentPercent=0,this._durationTween=0,this._rawDuration=0,this._loopType=ccs.ANIMATION_TYPE_LOOP_BACK,this._tweenEasing=ccs.TweenType.LINEAR,this.animationInternal=1/60,this._curFrameIndex=0,this._durationTween=0,this._isLoopBack=!1},pause:function(){this._isPause=!0,this._isPlaying=!1},resume:function(){this._isPause=!1,this._isPlaying=!0},stop:function(){this._isComplete=!0,this._isPlaying=!1},play:function(t,e,i,n){this._isComplete=!1,this._isPause=!1,this._isPlaying=!0,this._currentFrame=0,this._nextFrameIndex=t,this._tweenEasing=n},update:function(t){if(!this._isComplete&&!this._isPause&&!(this._rawDuration<=0||t>1)){var e=void 0===this._nextFrameIndex?0:this._nextFrameIndex,i=this._currentFrame;e<=0?(this._currentPercent=1,i=0):(i+=this._processScale*(t/this.animationInternal),this._currentPercent=i/e,i=ccs.fmodf(i,e)),this._currentFrame=i,this.updateHandler()}},gotoFrame:function(t){var e=this._loopType;e===ccs.ANIMATION_TYPE_NO_LOOP?e=ccs.ANIMATION_TYPE_MAX:e===ccs.ANIMATION_TYPE_TO_LOOP_FRONT&&(e=ccs.ANIMATION_TYPE_LOOP_FRONT),this._loopType=e,this._curFrameIndex=t,this._nextFrameIndex=this._durationTween},getCurrentFrameIndex:function(){return this._curFrameIndex=(this._rawDuration-1)*this._currentPercent,this._curFrameIndex},updateHandler:function(){},isPause:function(){return this._isPause},isComplete:function(){return this._isComplete},getCurrentPercent:function(){return this._currentPercent},getRawDuration:function(){return this._rawDuration},getLoop:function(){return this._loopType},getTweenEasing:function(){return this._tweenEasing},getAnimationInternal:function(){return this.animationInternal},setAnimationInternal:function(t){this.animationInternal=t},getProcessScale:function(){return this._processScale},setProcessScale:function(t){this._processScale=t},isPlaying:function(){return this._isPlaying}});var _p=ccs.ProcessBase.prototype;_p.currentFrameIndex,cc.defineGetterSetter(_p,"currentFrameIndex",_p.getCurrentFrameIndex),_p.paused,cc.defineGetterSetter(_p,"paused",_p.isPause),_p.completed,cc.defineGetterSetter(_p,"completed",_p.isComplete),_p.currentPercent,cc.defineGetterSetter(_p,"currentPercent",_p.getCurrentPercent),_p.rawDuration,cc.defineGetterSetter(_p,"rawDuration",_p.getRawDuration),_p.loop,cc.defineGetterSetter(_p,"loop",_p.getLoop),_p.tweenEasing,cc.defineGetterSetter(_p,"tweenEasing",_p.getTweenEasing),_p.playing,cc.defineGetterSetter(_p,"playing",_p.isPlaying),_p=null,ccs.MovementEventType={start:0,complete:1,loopComplete:2},ccs.AnimationEvent=ccs.Class.extend({_arguments:null,_callFunc:null,_selectorTarget:null,ctor:function(t,e,i){this._data=i,this._callFunc=t,this._selectorTarget=e},call:function(){this._callFunc&&this._callFunc.apply(this._selectorTarget,this._arguments)},setArguments:function(t){this._arguments=t}}),ccs.MovementEvent=function(){this.armature=null,this.movementType=ccs.MovementEventType.start,this.movementID=""},ccs.FrameEvent=function(){this.bone=null,this.frameEventName="",this.originFrameIndex=0,this.currentFrameIndex=0},ccs.ArmatureAnimation=ccs.ProcessBase.extend({_animationData:null,_movementData:null,_armature:null,_movementID:"",_toIndex:0,_tweenList:null,_speedScale:1,_ignoreFrameEvent:!1,_frameEventQueue:null,_movementEventQueue:null,_movementList:null,_onMovementList:!1,_movementListLoop:!1,_movementIndex:0,_movementListDurationTo:-1,_movementEventCallFunc:null,_frameEventCallFunc:null,_movementEventTarget:null,_frameEventTarget:null,_movementEventListener:null,_frameEventListener:null,ctor:function(t){ccs.ProcessBase.prototype.ctor.call(this),this._tweenList=[],this._movementList=[],this._frameEventQueue=[],this._movementEventQueue=[],this._armature=null,t&&ccs.ArmatureAnimation.prototype.init.call(this,t)},init:function(t){return this._armature=t,this._tweenList.length=0,!0},pause:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].pause();ccs.ProcessBase.prototype.pause.call(this)},resume:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].resume();ccs.ProcessBase.prototype.resume.call(this)},stop:function(){for(var t=this._tweenList,e=0;e<t.length;e++)t[e].stop();t.length=0,ccs.ProcessBase.prototype.stop.call(this)},setAnimationScale:function(t){this.setSpeedScale(t)},getAnimationScale:function(){return this.getSpeedScale()},setSpeedScale:function(t){if(t!==this._speedScale){this._speedScale=t,this._processScale=this._movementData?this._speedScale*this._movementData.scale:this._speedScale;var e=this._armature.getBoneDic();for(var i in e){var n=e[i];n.getTween().setProcessScale(this._processScale),n.getChildArmature()&&n.getChildArmature().getAnimation().setSpeedScale(this._processScale)}}},getSpeedScale:function(){return this._speedScale},play:function(t,e,i){cc.assert(this._animationData,"this.animationData can not be null"),this._movementData=this._animationData.getMovement(t),cc.assert(this._movementData,"this._movementData can not be null"),e=void 0===e?-1:e,i=void 0===i?-1:i,this._rawDuration=this._movementData.duration,this._movementID=t,this._processScale=this._speedScale*this._movementData.scale,e=e===-1?this._movementData.durationTo:e;var n=0===this._movementData.durationTween?this._rawDuration:this._movementData.durationTween,r=this._movementData.tweenEasing;i=i<0?this._movementData.loop:i,this._onMovementList=!1,ccs.ProcessBase.prototype.play.call(this,e,n,i,r),0===this._rawDuration?this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME:(this._loopType=i?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._durationTween=n),this._tweenList.length=0;var o,s=this._armature.getBoneDic();for(var c in s){var a=s[c];o=this._movementData.movBoneDataDic[a.getName()];var l=a.getTween();o&&o.frameList.length>0?(this._tweenList.push(l),o.duration=this._movementData.duration,l.play(o,e,n,i,r),l.setProcessScale(this._processScale),a.getChildArmature()&&(a.getChildArmature().getAnimation().setSpeedScale(this._processScale),a.getChildArmature().getAnimation().isPlaying()||a.getChildArmature().getAnimation().playWithIndex(0))):a.isIgnoreMovementBoneData()||(a.getDisplayManager().changeDisplayWithIndex(-1,!1),l.stop())}this._armature.update(0)},playByIndex:function(t,e,i,n,r){cc.log("playByIndex is deprecated. Use playWithIndex instead."),this.playWithIndex(t,e,n)},playWithIndex:function(t,e,i){var n=this._animationData.movementNames;cc.assert(t>-1&&t<n.length);var r=n[t];this.play(r,e,i)},playWithNames:function(t,e,i){e=void 0===e?-1:e,i=void 0===i||i,this._movementListLoop=i,this._movementListDurationTo=e,this._onMovementList=!0,this._movementIndex=0,t instanceof Array?this._movementList=t:this._movementList.length=0,this.updateMovementList()},playWithIndexes:function(t,e,i){e=void 0===e?-1:e,i=void 0===i||i,this._movementList.length=0,this._movementListLoop=i,this._movementListDurationTo=e,this._onMovementList=!0,this._movementIndex=0;for(var n=this._animationData.movementNames,r=0;r<t.length;r++){var o=n[t[r]];this._movementList.push(o)}this.updateMovementList()},gotoAndPlay:function(t){if(!this._movementData||t<0||t>=this._movementData.duration)return void cc.log("Please ensure you have played a movement, and the frameIndex is in the range.");var e=this._ignoreFrameEvent;this._ignoreFrameEvent=!0,this._isPlaying=!0,this._isComplete=this._isPause=!1,ccs.ProcessBase.prototype.gotoFrame.call(this,t),this._currentPercent=this._curFrameIndex/(this._movementData.duration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent;for(var i=this._tweenList,n=0;n<i.length;n++)i[n].gotoAndPlay(t);this._armature.update(0),this._ignoreFrameEvent=e},gotoAndPause:function(t){this.gotoAndPlay(t),this.pause()},getMovementCount:function(){return this._animationData.getMovementCount()},update:function(t){ccs.ProcessBase.prototype.update.call(this,t);for(var e=this._tweenList,i=0;i<e.length;i++)e[i].update(t);for(var n,r=this._frameEventQueue;r.length>0;)n=r.shift(),this._ignoreFrameEvent=!0,this._frameEventCallFunc&&this._frameEventCallFunc.call(this._frameEventTarget,n.bone,n.frameEventName,n.originFrameIndex,n.currentFrameIndex),this._frameEventListener&&this._frameEventListener(n.bone,n.frameEventName,n.originFrameIndex,n.currentFrameIndex),this._ignoreFrameEvent=!1;for(var o=this._movementEventQueue;o.length>0;)n=o.shift(),this._movementEventCallFunc&&this._movementEventCallFunc.call(this._movementEventTarget,n.armature,n.movementType,n.movementID),this._movementEventListener&&this._movementEventListener(n.armature,n.movementType,n.movementID)},updateHandler:function(){var t=this._currentPercent;if(t>=1){switch(this._loopType){case ccs.ANIMATION_TYPE_NO_LOOP:if(this._loopType=ccs.ANIMATION_TYPE_MAX,this._currentFrame=(t-1)*this._nextFrameIndex,t=this._currentFrame/this._durationTween,t<1){this._nextFrameIndex=this._durationTween,this.movementEvent(this._armature,ccs.MovementEventType.start,this._movementID);break}break;case ccs.ANIMATION_TYPE_MAX:case ccs.ANIMATION_TYPE_SINGLE_FRAME:t=1,this._isComplete=!0,this._isPlaying=!1,this.movementEvent(this._armature,ccs.MovementEventType.complete,this._movementID),this.updateMovementList();break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:this._loopType=ccs.ANIMATION_TYPE_LOOP_FRONT,t=ccs.fmodf(t,1),this._currentFrame=0===this._nextFrameIndex?0:ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._nextFrameIndex=this._durationTween>0?this._durationTween:1,this.movementEvent(this,ccs.MovementEventType.start,this._movementID);break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex),this._toIndex=0,this.movementEvent(this._armature,ccs.MovementEventType.loopComplete,this._movementID)}this._currentPercent=t}},getCurrentMovementID:function(){return this._isComplete?"":this._movementID},setMovementEventCallFunc:function(t,e){1===arguments.length?this._movementEventListener=t:2===arguments.length&&(this._movementEventTarget=e,this._movementEventCallFunc=t)},setFrameEventCallFunc:function(t,e){1===arguments.length?this._frameEventListener=t:2===arguments.length&&(this._frameEventTarget=e,this._frameEventCallFunc=t)},setUserObject:function(t){this._userObject=t},frameEvent:function(t,e,i,n){if(this._frameEventTarget&&this._frameEventCallFunc||this._frameEventListener){var r=new ccs.FrameEvent;r.bone=t,r.frameEventName=e,r.originFrameIndex=i,r.currentFrameIndex=n,this._frameEventQueue.push(r)}},movementEvent:function(t,e,i){if(this._movementEventTarget&&this._movementEventCallFunc||this._movementEventListener){var n=new ccs.MovementEvent;n.armature=t,n.movementType=e,n.movementID=i,this._movementEventQueue.push(n)}},updateMovementList:function(){if(this._onMovementList){var t,e=this._movementList;this._movementListLoop?(t=e[this._movementIndex],this.play(t,t.durationTo,0),this._movementIndex++,this._movementIndex>=e.length&&(this._movementIndex=0)):this._movementIndex<e.length?(t=e[this._movementIndex],this.play(t,t.durationTo,0),this._movementIndex++):this._onMovementList=!1,this._onMovementList=!0}},setAnimationData:function(t){this._animationData!==t&&(this._animationData=t)},getAnimationData:function(){return this._animationData},getUserObject:function(){return this._userObject},isIgnoreFrameEvent:function(){return this._ignoreFrameEvent}});var _p=ccs.ArmatureAnimation.prototype;_p.speedScale,cc.defineGetterSetter(_p,"speedScale",_p.getSpeedScale,_p.setSpeedScale),_p.animationScale,cc.defineGetterSetter(_p,"animationScale",_p.getAnimationScale,_p.setAnimationScale),_p=null,ccs.ArmatureAnimation.create=function(t){return new ccs.ArmatureAnimation(t)},ccs.Tween=ccs.ProcessBase.extend({_tweenData:null,_to:null,_from:null,_between:null,_movementBoneData:null,_bone:null,_frameTweenEasing:0,_betweenDuration:0,_totalDuration:0,_toIndex:0,_fromIndex:0,_animation:null,_passLastFrame:!1,ctor:function(t){ccs.ProcessBase.prototype.ctor.call(this),this._frameTweenEasing=ccs.TweenType.LINEAR,ccs.Tween.prototype.init.call(this,t)},init:function(t){return this._from=new ccs.FrameData,this._between=new ccs.FrameData,this._bone=t,this._tweenData=this._bone.getTweenData(),this._tweenData.displayIndex=-1,this._animation=null!==this._bone&&null!==this._bone.getArmature()?this._bone.getArmature().getAnimation():null,!0},play:function(t,e,i,n,r){ccs.ProcessBase.prototype.play.call(this,e,i,n,r),this._loopType=n?ccs.ANIMATION_TYPE_TO_LOOP_FRONT:ccs.ANIMATION_TYPE_NO_LOOP,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;var o=t!==this._movementBoneData;this.setMovementBoneData(t),this._rawDuration=this._movementBoneData.duration;var s=this._movementBoneData.getFrameData(0);this._tweenData.displayIndex=s.displayIndex,this._bone.getArmature().getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeSub(this._tweenData,this._bone.getBoneData()),this._tweenData.scaleX+=1,this._tweenData.scaleY+=1),0===this._rawDuration?(this._loopType=ccs.ANIMATION_TYPE_SINGLE_FRAME,0===e?this.setBetween(s,s):this.setBetween(this._tweenData,s),this._frameTweenEasing=ccs.TweenType.LINEAR):this._movementBoneData.frameList.length>1&&(this._durationTween=i*this._movementBoneData.scale,n&&0!==this._movementBoneData.delay?this.setBetween(this._tweenData,this.tweenNodeTo(this.updateFrameData(1-this._movementBoneData.delay),this._between)):o&&0!==e?this.setBetween(this._tweenData,s):this.setBetween(s,s)),this.tweenNodeTo(0)},gotoAndPlay:function(t){ccs.ProcessBase.prototype.gotoFrame.call(this,t),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0,this._isPlaying=!0,this._isComplete=this._isPause=!1,this._currentPercent=this._curFrameIndex/(this._rawDuration-1),this._currentFrame=this._nextFrameIndex*this._currentPercent},gotoAndPause:function(t){this.gotoAndPlay(t),this.pause()},updateHandler:function(){var t=null==this._currentPercent?1:this._currentPercent,e=this._loopType;if(t>=1)switch(e){case ccs.ANIMATION_TYPE_SINGLE_FRAME:t=1,this._isComplete=!0,this._isPlaying=!1;break;case ccs.ANIMATION_TYPE_NO_LOOP:if(e=ccs.ANIMATION_TYPE_MAX,t=this._durationTween<=0?1:(t-1)*this._nextFrameIndex/this._durationTween,t>=1){t=1,this._isComplete=!0,this._isPlaying=!1;break}this._nextFrameIndex=this._durationTween,this._currentFrame=t*this._nextFrameIndex,this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_TO_LOOP_FRONT:e=ccs.ANIMATION_TYPE_LOOP_FRONT,this._nextFrameIndex=this._durationTween>0?this._durationTween:1,0!==this._movementBoneData.delay?(this._currentFrame=(1-this._movementBoneData.delay)*this._nextFrameIndex,t=this._currentFrame/this._nextFrameIndex):(t=0,this._currentFrame=0),this._totalDuration=0,this._betweenDuration=0,this._fromIndex=this._toIndex=0;break;case ccs.ANIMATION_TYPE_MAX:t=1,this._isComplete=!0,this._isPlaying=!1;break;default:this._currentFrame=ccs.fmodf(this._currentFrame,this._nextFrameIndex)}t<1&&e<ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(t=Math.sin(t*cc.PI/2)),this._currentPercent=t,this._loopType=e,e>ccs.ANIMATION_TYPE_TO_LOOP_BACK&&(t=this.updateFrameData(t)),this._frameTweenEasing!==ccs.TweenType.TWEEN_EASING_MAX&&this.tweenNodeTo(t)},setBetween:function(t,e,i){void 0===i&&(i=!0);do{if(t.displayIndex<0&&e.displayIndex>=0){this._from.copy(e),this._between.subtract(e,e,i);break}if(e.displayIndex<0&&t.displayIndex>=0){this._from.copy(t),this._between.subtract(e,e,i);break}this._from.copy(t),this._between.subtract(t,e,i)}while(0);t.isTween||(this._tweenData.copy(t),this._tweenData.isTween=!0),this.arriveKeyFrame(t)},arriveKeyFrame:function(t){if(t){var e=this._bone,i=e.getDisplayManager(),n=t.displayIndex;i.getForceChangeDisplay()||i.changeDisplayWithIndex(n,!1),this._tweenData.zOrder=t.zOrder,e.updateZOrder(),this._bone.setBlendFunc(t.blendFunc);var r=e.getChildArmature();r&&""!==t.movement&&r.getAnimation().play(t.movement)}},tweenNodeTo:function(t,e){e||(e=this._tweenData);var i=this._from,n=this._between;return i.isTween||(t=0),e.x=i.x+t*n.x,e.y=i.y+t*n.y,e.scaleX=i.scaleX+t*n.scaleX,e.scaleY=i.scaleY+t*n.scaleY,e.skewX=i.skewX+t*n.skewX,e.skewY=i.skewY+t*n.skewY,this._bone.setTransformDirty(!0),e&&n.isUseColorInfo&&this.tweenColorTo(t,e),e},tweenColorTo:function(t,e){var i=this._from,n=this._between;e.a=i.a+t*n.a,e.r=i.r+t*n.r,e.g=i.g+t*n.g,e.b=i.b+t*n.b,this._bone.updateColor()},updateFrameData:function(t){t>1&&0!==this._movementBoneData.delay&&(t=ccs.fmodf(t,1));var e,i,n=(this._rawDuration-1)*t,r=this._totalDuration,o=this._betweenDuration,s=this._toIndex;if(n<r||n>=r+o){var c=this._movementBoneData.frameList,a=c.length;if(n<c[0].frameID)return e=i=c[0],this.setBetween(e,i),this._currentPercent;if(n>=c[a-1].frameID){if(this._passLastFrame)return e=i=c[a-1],this.setBetween(e,i),this._currentPercent;this._passLastFrame=!0}else this._passLastFrame=!1;do{if(this._fromIndex=s,e=c[this._fromIndex],r=e.frameID,s=this._fromIndex+1,s>=a&&(s=0),i=c[s],e.strEvent&&!this._animation.isIgnoreFrameEvent()&&this._animation.frameEvent(this._bone,e.strEvent,e.frameID,n),n===e.frameID||this._passLastFrame&&this._fromIndex===a-1)break}while(n<e.frameID||n>=i.frameID);o=i.frameID-e.frameID,this._frameTweenEasing=e.tweenEasing,this.setBetween(e,i,!1),this._totalDuration=r,this._betweenDuration=o,this._toIndex=s}t=0===o?0:(n-this._totalDuration)/this._betweenDuration;var l=this._frameTweenEasing!==ccs.TweenType.LINEAR?this._frameTweenEasing:this._tweenEasing;return l===ccs.TweenType.TWEEN_EASING_MAX||l===ccs.TweenType.LINEAR||this._passLastFrame||(t=ccs.TweenFunction.tweenTo(t,l,this._from.easingParams)),t},setAnimation:function(t){this._animation=t},getAnimation:function(){return this._animation},setMovementBoneData:function(t){this._movementBoneData=t}});var _p=ccs.Tween.prototype;_p.animation,cc.defineGetterSetter(_p,"animation",_p.getAnimation,_p.setAnimation),_p=null,ccs.Tween.create=function(t){return new ccs.Tween(t)},ccs.PT_RATIO=32,ccs.ColliderFilter=ccs.Class.extend({_collisionType:0,_group:0,_categoryBits:0,_groupIndex:0,_maskBits:0,ctor:function(t,e){this._collisionType=t||0,this._group=e||0},updateShape:function(t){if(t instanceof cp.Shape)t.collision_type=this._collisionType,t.group=this._group;else if(t instanceof Box2D.b2FilterData){var e=new Box2D.b2FilterData;e.categoryBits=this._categoryBits,e.groupIndex=this._groupIndex,e.maskBits=this._maskBits,t.SetFilterData(e)}}}),ccs.ColliderBody=ccs.Class.extend({shape:null,coutourData:null,colliderFilter:null,_calculatedVertexList:null,ctor:function(t){this.shape=null,this.coutourData=t,this.colliderFilter=new ccs.ColliderFilter,ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX&&(this._calculatedVertexList=[])},getContourData:function(){return this.coutourData},setColliderFilter:function(t){this.colliderFilter=t},getCalculatedVertexList:function(){return this._calculatedVertexList},setB2Fixture:function(t){this._fixture=t},getB2Fixture:function(){return this._fixture},setShape:function(t){this.shape=t},getShape:function(){return this.shape},setContourData:function(t){this.coutourData=t},getColliderFilter:function(){return this.colliderFilter}}),ccs.ColliderDetector=ccs.Class.extend({_colliderBodyList:null,_bone:null,_body:null,_active:!1,_filter:null,helpPoint:cc.p(0,0),ctor:function(t){this._colliderBodyList=[],this._bone=null,this._body=null,this._active=!1,this._filter=null,ccs.ColliderDetector.prototype.init.call(this,t)},init:function(t){return this._colliderBodyList.length=0,t&&(this._bone=t),this._filter=new ccs.ColliderFilter,!0},addContourData:function(t){var e=new ccs.ColliderBody(t);if(this._colliderBodyList.push(e),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX)for(var i=e.getCalculatedVertexList(),n=t.vertexList,r=0;r<n.length;r++){var o=new ccs.ContourVertex2(0,0);i.push(o)}},addContourDataList:function(t){for(var e=0;e<t.length;e++)this.addContourData(t[e])},removeContourData:function(t){var e,i=[],n=this._colliderBodyList;for(e=0;e<n.length;e++){var r=n[e];r&&r.getContourData()===t&&i.push(r)}for(e=0;e<i.length;e++)cc.arrayRemoveObject(n,i[e])},removeAll:function(){this._colliderBodyList.length=0},setActive:function(t){if(this._active!==t){this._active=t;var e,i=this._body;if(i){var n=null;if(this._active)for(var r=0;r<this._colliderBodyList.length;r++)n=this._colliderBodyList[r],e=n.getShape(),i.space.addShape(e);else for(var r=0;r<this._colliderBodyList.length;r++)n=this._colliderBodyList[r],e=n.getShape(),i.space.removeShape(e)}}},getActive:function(){return this._active},getColliderBodyList:function(){return this._colliderBodyList},setColliderFilter:function(t){this._filter=t;for(var e=this._colliderBodyList,i=0;i<e.length;i++){var n=e[i];n.setColliderFilter(t),n.getShape()&&n.getColliderFilter().updateShape(n.getShape())}},getColliderFilter:function(){return this._filter},updateTransform:function(t){if(this._active)for(var e=null,i=this._body,n=this.helpPoint,r=0;r<this._colliderBodyList.length;r++){e=this._colliderBodyList[r];var o=e.getContourData(),s=null;i&&(s=e.getShape());for(var c=o.vertexList,a=e.getCalculatedVertexList(),l=0;l<c.length;l++){if(n.x=c[l].x,n.y=c[l].y,n=cc.pointApplyAffineTransform(n,t),ccs.ENABLE_PHYSICS_SAVE_CALCULATED_VERTEX){var h=cc.p(0,0);h.x=n.x,h.y=n.y,a[l]=h}s&&(s.verts[2*l]=n.x,s.verts[2*l+1]=n.y)}if(s)for(var l=0;l<c.length;l++){var u=s.verts[(l+1)%s.verts.length],d=cp.v.normalize(cp.v.perp(cp.v.sub(u,s.verts[l])));s.planes&&(s.planes[l].n=d,s.planes[l].d=cp.v.dot(d,s.verts[l]))}}},setBody:function(t){this._body=t;for(var e,i=this._colliderBodyList,n=0;n<i.length;n++){e=i[n];for(var r=e.getContourData(),o=[],s=r.vertexList,c=0;c<s.length;c++){var a=s[c];o.push(a.x),o.push(a.y)}var l=new cp.PolyShape(this._body,o,cp.vzero);l.sensor=!0,l.data=this._bone,this._active&&this._body.space.addShape(l),e.setShape(l),e.getColliderFilter().updateShape(l)}},getBody:function(){return this._body}});var _p=ccs.ColliderDetector.prototype;_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p.active,cc.defineGetterSetter(_p,"active",_p.getActive,_p.setActive),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p=null,ccs.ColliderDetector.create=function(t){return new ccs.ColliderDetector(t)},ccs.Armature=ccs.Node.extend({animation:null,armatureData:null,batchNode:null,_textureAtlas:null,_parentBone:null,_boneDic:null,_topBoneList:null,_armatureIndexDic:null,_offsetPoint:null,version:0,_armatureTransformDirty:!0,_body:null,_blendFunc:null,_className:"Armature",ctor:function(t,e){cc.Node.prototype.ctor.call(this),this._name="",this._topBoneList=[],this._armatureIndexDic={},this._offsetPoint=cc.p(0,0),this._armatureTransformDirty=!0,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},t&&ccs.Armature.prototype.init.call(this,t,e)},init:function(t,e){cc.Node.prototype.init.call(this),e&&(this._parentBone=e),this.removeAllChildren(),this.animation=new ccs.ArmatureAnimation,this.animation.init(this),this._boneDic={},this._topBoneList.length=0;var i,n=ccs.armatureDataManager;if(""!==t){i=n.getAnimationData(t),cc.assert(i,"AnimationData not exist!"),this.animation.setAnimationData(i);var r=n.getArmatureData(t);cc.assert(r,"ArmatureData not exist!"),this.armatureData=r;var o=r.getBoneDataDic();for(var s in o){var c=this.createBone(String(s));do{var a=i.getMovement(i.movementNames[0]);if(!a)break;var l=a.getMovementBoneData(c.getName());if(!l||l.frameList.length<=0)break;var h=l.getFrameData(0);if(!h)break;c.getTweenData().copy(h),c.changeDisplayWithIndex(h.displayIndex,!1)}while(0)}this.update(0),this.updateOffsetPoint()}else t="new_armature",this.armatureData=new ccs.ArmatureData,this.armatureData.name=t,i=new ccs.AnimationData,i.name=t,n.addArmatureData(t,this.armatureData),n.addAnimationData(t,i),this.animation.setAnimationData(i);return this._renderCmd.initShaderCache(),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),!0},addChild:function(t,e,i){return t instanceof ccui.Widget?void cc.log("Armature doesn't support to add Widget as its child, it will be fix soon."):void cc.Node.prototype.addChild.call(this,t,e,i)},createBone:function(t){var e=this.getBone(t);if(e)return e;var i=this.armatureData.getBoneData(t),n=i.parentName,r=null;return n?(this.createBone(n),r=new ccs.Bone(t),this.addBone(r,n)):(r=new ccs.Bone(t),this.addBone(r,"")),r.setBoneData(i),r.getDisplayManager().changeDisplayWithIndex(-1,!1),r},addBone:function(t,e){cc.assert(t,"Argument must be non-nil");var i=this._boneDic;if(t.getName()&&cc.assert(!i[t.getName()],"bone already added. It can't be added again"),e){var n=i[e];n?n.addChildBone(t):this._topBoneList.push(t)}else this._topBoneList.push(t);t.setArmature(this),i[t.getName()]=t,this.addChild(t)},removeBone:function(t,e){cc.assert(t,"bone must be added to the bone dictionary!"),t.setArmature(null),t.removeFromParent(e),cc.arrayRemoveObject(this._topBoneList,t),delete this._boneDic[t.getName()],this.removeChild(t,!0)},getBone:function(t){return this._boneDic[t]},changeBoneParent:function(t,e){cc.assert(t,"bone must be added to the bone dictionary!");var i=t.getParentBone();if(i&&(cc.arrayRemoveObject(i.getChildren(),t),t.setParentBone(null)),e){var n=this._boneDic[e];n?(n.addChildBone(t),cc.arrayRemoveObject(this._topBoneList,t)):this._topBoneList.push(t)}},getBoneDic:function(){return this._boneDic},updateOffsetPoint:function(){var t=this.getBoundingBox();this.setContentSize(t);var e=this._offsetPoint;e.x=-t.x,e.y=-t.y,0!==t.width&&0!==t.height&&this.setAnchorPoint(e.x/t.width,e.y/t.height)},getOffsetPoints:function(){return{x:this._offsetPoint.x,y:this._offsetPoint.y}},setAnimation:function(t){this.animation=t},getAnimation:function(){return this.animation},getArmatureTransformDirty:function(){return this._armatureTransformDirty},update:function(t){this.animation.update(t);for(var e=this._topBoneList,i=0;i<e.length;i++)e[i].update(t);this._armatureTransformDirty=!1},onEnter:function(){cc.Node.prototype.onEnter.call(this),this.scheduleUpdate()},onExit:function(){cc.Node.prototype.onExit.call(this),this.unscheduleUpdate()},getBoundingBox:function(){for(var t,e,i,n=0,r=!0,o=cc.rect(0,0,0,0),s=this._children,c=s.length,a=0;a<c;a++){var l=s[a];if(l){var h=l.getDisplayManager().getBoundingBox();if(0===h.x&&0===h.y&&0===h.width&&0===h.height)continue;r?(t=h.x,e=h.y,i=h.x+h.width,n=h.y+h.height,r=!1):(t=h.x<o.x?h.x:o.x,e=h.y<o.y?h.y:o.y,i=h.x+h.width>o.x+o.width?h.x+h.width:o.x+o.width,n=h.y+h.height>o.y+o.height?h.y+h.height:o.y+o.height),o.x=t,o.y=e,o.width=i-t,o.height=n-e}}return cc.rectApplyAffineTransform(o,this.getNodeToParentTransform())},getBoneAtPoint:function(t,e){for(var i=this._children,n=i.length-1;n>=0;n--){var r=i[n];if(r instanceof ccs.Bone&&r.getDisplayManager().containPoint(t,e))return r}return null},setParentBone:function(t){this._parentBone=t;var e=this._boneDic;for(var i in e)e[i].setArmature(this)},getParentBone:function(){return this._parentBone},drawContour:function(){cc._drawingUtil.setDrawColor(255,255,255,255),cc._drawingUtil.setLineWidth(1);var t=this._boneDic;for(var e in t){var i=t[e],n=i.getColliderDetector();if(n)for(var r=n.getColliderBodyList(),o=0;o<r.length;o++){var s=r[o],c=s.getCalculatedVertexList();cc._drawingUtil.drawPoly(c,c.length,!0)}}},setBody:function(t){if(this._body!==t){this._body=t,this._body.data=this;for(var e,i,n=this._children,r=0;r<n.length;r++)if(e=n[r],e instanceof ccs.Bone)for(var o=e.getDisplayManager().getDecorativeDisplayList(),s=0;s<o.length;s++){i=o[s];var c=i.getColliderDetector();c&&c.setBody(this._body)}}},getShapeList:function(){return this._body?this._body.shapeList:null},getBody:function(){return this._body},setBlendFunc:function(t,e){void 0===e?(this._blendFunc.src=t.src,this._blendFunc.dst=t.dst):(this._blendFunc.src=t,this._blendFunc.dst=e)},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setColliderFilter:function(t){var e=this._boneDic;for(var i in e)e[i].setColliderFilter(t)},getArmatureData:function(){return this.armatureData},setArmatureData:function(t){this.armatureData=t},getBatchNode:function(){return this.batchNode},setBatchNode:function(t){this.batchNode=t},getVersion:function(){return this.version},setVersion:function(t){this.version=t},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Armature.CanvasRenderCmd(this):new ccs.Armature.WebGLRenderCmd(this)}});var _p=ccs.Armature.prototype;_p.parentBone,cc.defineGetterSetter(_p,"parentBone",_p.getParentBone,_p.setParentBone),_p.body,cc.defineGetterSetter(_p,"body",_p.getBody,_p.setBody),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",null,_p.setColliderFilter),_p=null,ccs.Armature.create=function(t,e){return new ccs.Armature(t,e)},function(){ccs.Armature.RenderCmd={_updateAnchorPointInPoint:function(){var t=this._node,e=t._contentSize,i=t._anchorPoint,n=t._offsetPoint;this._anchorPointInPoints.x=e.width*i.x-n.x,this._anchorPointInPoints.y=e.height*i.y-n.y,this._realAnchorPointInPoints.x=e.width*i.x,this._realAnchorPointInPoints.y=e.height*i.y,this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getAnchorPointInPoints:function(){return cc.p(this._realAnchorPointInPoints)}}}(),function(){ccs.Armature.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0,this._realAnchorPointInPoints=new cc.Point(0,0),this._canUseDirtyRegion=!0,this._startRenderCmd=new cc.CustomRenderCmd(this,this._startCmdCallback),this._RestoreRenderCmd=new cc.CustomRenderCmd(this,this._RestoreCmdCallback),this._startRenderCmd._canUseDirtyRegion=!0,this._RestoreRenderCmd._canUseDirtyRegion=!0};var t=ccs.Armature.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,t),t.constructor=ccs.Armature.CanvasRenderCmd,t._startCmdCallback=function(t,e,i){var n=this._node,r=n._parent;this.transform(r?r._renderCmd:null);var o=t||cc._renderContext;o.save(),o._switchToArmatureMode(!0,this._worldTransform,e,i)},t.transform=function(t,e){ccs.Node.CanvasRenderCmd.prototype.transform.call(this,t,e);for(var i=this._node._children,n=0,r=i.length;n<r;n++){var o=i[n],s=o._renderCmd;if(o&&o.getDisplayRenderNode){var c=o.getDisplayRenderNodeType(),a=o.getDisplayRenderNode();if(a&&a._renderCmd){var l=a._renderCmd;l.transform(null),c!==ccs.DISPLAY_TYPE_ARMATURE&&c!==ccs.DISPLAY_TYPE_SPRITE&&cc.affineTransformConcatIn(l._worldTransform,o._worldTransform);var h=cc.Node._dirtyFlags,u=l._dirtyFlag,d=s._dirtyFlag,_=d&h.colorDirty,p=d&h.opacityDirty;_&&s._updateDisplayColor(),p&&s._updateDisplayOpacity(),(_||p)&&s._updateColor();var f=o._renderCmd._displayedColor,m=o._renderCmd._displayedOpacity;_=u&h.colorDirty,p=u&h.opacityDirty,_&&l._updateDisplayColor(f),p&&l._updateDisplayOpacity(m),(_||p)&&l._updateColor()}}}},t._RestoreCmdCallback=function(t){this._cacheDirty=!1,t._switchToArmatureMode(!1),t.restore()},t.initShaderCache=function(){},t.setShaderProgram=function(){},t.updateChildPosition=function(t,e){t.visit()},t.rendering=function(t,e,i){for(var n=this._node,r=n._children,o=(cc.BlendFunc.ALPHA_PREMULTIPLIED,cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,0),s=r.length;o<s;o++){var c=r[o];if(c&&c.getDisplayRenderNode){var a=c.getDisplayRenderNode();if(null===a)continue;var l=c._renderCmd;switch(l._syncStatus(this),c.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:a._renderCmd.visit(l);break;case ccs.DISPLAY_TYPE_ARMATURE:a._renderCmd.rendering(t,e,i);break;default:a._renderCmd.visit(l)}}else c instanceof cc.Node&&this._visitNormalChild(c)}},t._visitNormalChild=function(t){if(t){var e=t._renderCmd;if(t._visible){e._curLevel=this._curLevel+1;var i,n,r=t._children;e._syncStatus(this),e.transform(null);var o=r.length;if(o>0){for(t.sortAllChildren(),i=0;i<o&&(n=r[i],n._localZOrder<0);i++)n._renderCmd.visit(e);for(cc.renderer.pushRenderCommand(e);i<o;i++)r[i]._renderCmd.visit(e)}else cc.renderer.pushRenderCommand(e);this._dirtyFlag=0}}},t.visit=function(t){var e=this._node;e._visible&&(this._syncStatus(t),e.sortAllChildren(),cc.renderer.pushRenderCommand(this._startRenderCmd),this.rendering(),cc.renderer.pushRenderCommand(this._RestoreRenderCmd),this._cacheDirty=!1)}}(),ccs.Bone=ccs.Node.extend({_boneData:null,_armature:null,_childArmature:null,_displayManager:null,ignoreMovementBoneData:!1,_tween:null,_tweenData:null,_parentBone:null,_boneTransformDirty:!1,_worldTransform:null,_blendFunc:null,blendDirty:!1,_worldInfo:null,_armatureParentBone:null,_dataVersion:0,_className:"Bone",ctor:function(t){cc.Node.prototype.ctor.call(this),this._tweenData=null,this._parentBone=null,this._armature=null,this._childArmature=null,this._boneData=null,this._tween=null,this._displayManager=null,this.ignoreMovementBoneData=!1,this._worldTransform=cc.affineTransformMake(1,0,0,1,0,0),this._boneTransformDirty=!0,this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this.blendDirty=!1,this._worldInfo=null,this._armatureParentBone=null,this._dataVersion=0,ccs.Bone.prototype.init.call(this,t)},init:function(t){return t&&(this._name=t),this._tweenData=new ccs.FrameData,this._tween=new ccs.Tween(this),this._displayManager=new ccs.DisplayManager(this),this._worldInfo=new ccs.BaseData,this._boneData=new ccs.BaseData,!0},setBoneData:function(t){cc.assert(t,"_boneData must not be null"),this._boneData!==t&&(this._boneData=t),this.setName(this._boneData.name),this._localZOrder=this._boneData.zOrder,this._displayManager.initDisplayList(t)},getBoneData:function(){return this._boneData},setArmature:function(t){this._armature=t,t?(this._tween.setAnimation(this._armature.getAnimation()),this._dataVersion=this._armature.getArmatureData().dataVersion,this._armatureParentBone=this._armature.getParentBone()):this._armatureParentBone=null},getArmature:function(){return this._armature},update:function(t){if(this._parentBone&&(this._boneTransformDirty=this._boneTransformDirty||this._parentBone.isTransformDirty()),this._armatureParentBone&&!this._boneTransformDirty&&(this._boneTransformDirty=this._armatureParentBone.isTransformDirty()),this._boneTransformDirty){var e=this._tweenData;this._dataVersion>=ccs.CONST_VERSION_COMBINED&&(ccs.TransformHelp.nodeConcat(e,this._boneData),e.scaleX-=1,e.scaleY-=1);var i=this._worldInfo;i.copy(e),i.x=e.x+this._position.x,i.y=e.y+this._position.y,i.scaleX=e.scaleX*this._scaleX,i.scaleY=e.scaleY*this._scaleY,i.skewX=e.skewX+this._skewX+cc.degreesToRadians(this._rotationX),i.skewY=e.skewY+this._skewY-cc.degreesToRadians(this._rotationY),this._parentBone?this._applyParentTransform(this._parentBone):this._armatureParentBone&&this._applyParentTransform(this._armatureParentBone),ccs.TransformHelp.nodeToMatrix(i,this._worldTransform),this._armatureParentBone&&cc.affineTransformConcatIn(this._worldTransform,this._armature.getNodeToParentTransform())}ccs.displayFactory.updateDisplay(this,t,this._boneTransformDirty||this._armature.getArmatureTransformDirty());for(var n=0;n<this._children.length;n++){var r=this._children[n];r.update(t)}this._boneTransformDirty=!1},_applyParentTransform:function(t){var e=this._worldInfo,i=t._worldTransform,n=t._worldInfo,r=e.x,o=e.y;e.x=r*i.a+o*i.c+n.x,e.y=r*i.b+o*i.d+n.y,e.scaleX=e.scaleX*n.scaleX,e.scaleY=e.scaleY*n.scaleY,e.skewX=e.skewX+n.skewX,e.skewY=e.skewY+n.skewY},setBlendFunc:function(t,e){var i,n,r=this._blendFunc;void 0===e?(i=t.src,n=t.dst):(i=t,n=e),r.src===i&&r.dst===n||(r.src=i,r.dst=n,this.blendDirty=!0)},updateColor:function(){var t=this._displayManager.getDisplayRenderNode();if(null!==t){var e=this._renderCmd;t.setColor(cc.color(e._displayedColor.r*this._tweenData.r/255,e._displayedColor.g*this._tweenData.g/255,e._displayedColor.b*this._tweenData.b/255)),t.setOpacity(e._displayedOpacity*this._tweenData.a/255)}},updateZOrder:function(){this._armature.getArmatureData().dataVersion>=ccs.CONST_VERSION_COMBINED?this.setLocalZOrder(this._tweenData.zOrder+this._boneData.zOrder):this.setLocalZOrder(this._tweenData.zOrder)},addChildBone:function(t){cc.assert(t,"Argument must be non-nil"),cc.assert(!t.parentBone,"child already added. It can't be added again"),this._children.indexOf(t)<0&&(this._children.push(t),t.setParentBone(this))},removeChildBone:function(t,e){if(this._children.length>0&&this._children.getIndex(t)!==-1){if(e)for(var i=t._children,n=0;n<i.length;n++){var r=i[n];t.removeChildBone(r,e)}t.setParentBone(null),t.getDisplayManager().setCurrentDecorativeDisplay(null),cc.arrayRemoveObject(this._children,t)}},removeFromParent:function(t){this._parentBone&&this._parentBone.removeChildBone(this,t)},setParentBone:function(t){this._parentBone=t},getParentBone:function(){return this._parentBone},setChildArmature:function(t){this._childArmature!==t&&(null==t&&this._childArmature&&this._childArmature.setParentBone(null),this._childArmature=t)},getChildArmature:function(){return this._childArmature},getTween:function(){return this._tween},setLocalZOrder:function(t){this._localZOrder!==t&&cc.Node.prototype.setLocalZOrder.call(this,t)},getNodeToArmatureTransform:function(){return this._worldTransform},getNodeToWorldTransform:function(){return cc.affineTransformConcat(this._worldTransform,this._armature.getNodeToWorldTransform())},getDisplayRenderNode:function(){return this._displayManager.getDisplayRenderNode()},getDisplayRenderNodeType:function(){return this._displayManager.getDisplayRenderNodeType()},addDisplay:function(t,e){return e=e||0,this._displayManager.addDisplay(t,e)},removeDisplay:function(t){this._displayManager.removeDisplay(t)},changeDisplayByIndex:function(t,e){cc.log("changeDisplayByIndex is deprecated. Use changeDisplayWithIndex instead."),this.changeDisplayWithIndex(t,e)},changeDisplayByName:function(t,e){cc.log("changeDisplayByName is deprecated. Use changeDisplayWithName instead."),this.changeDisplayWithName(t,e)},changeDisplayWithIndex:function(t,e){this._displayManager.changeDisplayWithIndex(t,e)},changeDisplayWithName:function(t,e){this._displayManager.changeDisplayWithName(t,e)},getColliderDetector:function(){var t=this._displayManager.getCurrentDecorativeDisplay();if(t){var e=t.getColliderDetector();if(e)return e}return null},setColliderFilter:function(t){for(var e=this._displayManager.getDecorativeDisplayList(),i=0;i<e.length;i++){var n=e[i],r=n.getColliderDetector();r&&r.setColliderFilter(t)}},getColliderFilter:function(){var t=this.displayManager.getCurrentDecorativeDisplay();if(t){var e=t.getColliderDetector();if(e)return e.getColliderFilter()}return null},setTransformDirty:function(t){this._boneTransformDirty=t},isTransformDirty:function(){return this._boneTransformDirty},getDisplayManager:function(){return this._displayManager},setIgnoreMovementBoneData:function(t){this._ignoreMovementBoneData=t},isIgnoreMovementBoneData:function(){return this._ignoreMovementBoneData},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},setBlendDirty:function(t){this._blendDirty=t},isBlendDirty:function(){return this._blendDirty},getTweenData:function(){return this._tweenData},getWorldInfo:function(){return this._worldInfo},getChildrenBone:function(){return this._children},nodeToArmatureTransform:function(){return this.getNodeToArmatureTransform()},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getColliderBodyList:function(){var t=this.getColliderDetector();return t?t.getColliderBodyList():null},getIgnoreMovementBoneData:function(){return this.isIgnoreMovementBoneData()},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new ccs.Bone.CanvasRenderCmd(this):new ccs.Bone.WebGLRenderCmd(this)}});var _p=ccs.Bone.prototype;_p.boneData,cc.defineGetterSetter(_p,"boneData",_p.getBoneData,_p.setBoneData),_p.armature,cc.defineGetterSetter(_p,"armature",_p.getArmature,_p.setArmature),_p.childArmature,cc.defineGetterSetter(_p,"childArmature",_p.getChildArmature,_p.setChildArmature),_p.childrenBone,cc.defineGetterSetter(_p,"childrenBone",_p.getChildrenBone),_p.tween,cc.defineGetterSetter(_p,"tween",_p.getTween),_p.tweenData,cc.defineGetterSetter(_p,"tweenData",_p.getTweenData),_p.colliderFilter,cc.defineGetterSetter(_p,"colliderFilter",_p.getColliderFilter,_p.setColliderFilter),_p=null,ccs.Bone.create=function(t){return new ccs.Bone(t)},ccs.Bone.RenderCmd={_updateColor:function(){var t=this._node,e=t._displayManager.getDisplayRenderNode();if(null!==e){var i=e._renderCmd;e.setColor(this._displayedColor),e.setOpacity(this._displayedOpacity),i._syncDisplayColor(t._tweenData),i._syncDisplayOpacity(t._tweenData.a),i._updateColor()}},transform:function(t,e){var i=this._node,n=this._transform,r=this._worldTransform,o=t?t._worldTransform:null;o&&(this.originTransform(),cc.affineTransformConcatIn(n,i._worldTransform)),o?(r.a=n.a*o.a+n.b*o.c,r.b=n.a*o.b+n.b*o.d,r.c=n.c*o.a+n.d*o.c,r.d=n.c*o.b+n.d*o.d,r.tx=n.tx*o.a+n.ty*o.c+o.tx,r.ty=n.tx*o.b+n.ty*o.d+o.ty):(r.a=n.a,r.b=n.b,r.c=n.c,r.d=n.d,r.tx=n.tx,r.ty=n.ty)}},function(){ccs.Bone.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!1};var t=ccs.Bone.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,t),t.constructor=ccs.Bone.CanvasRenderCmd}(),function(){if(cc.Node.WebGLRenderCmd){ccs.Bone.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!1};var t=ccs.Bone.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Bone.RenderCmd,t),t.constructor=ccs.Bone.WebGLRenderCmd}}(),ccs.FRAME_TYPE_MOVE=0,ccs.FRAME_TYPE_SCALE=1,ccs.FRAME_TYPE_ROTATE=2,ccs.FRAME_TYPE_TINT=3,ccs.FRAME_TYPE_FADE=4,ccs.FRAME_TYPE_MAX=5,ccs.FrameEaseType={CUSTOM:-1,LINEAR:0,SINE_EASEIN:1,SINE_EASEOUT:2,SINE_EASEINOUT:3,QUAD_EASEIN:4,QUAD_EASEOUT:5,QUAD_EASEINOUT:6,CUBIC_EASEIN:7,CUBIC_EASEOUT:8,CUBIC_EASEINOUT:9,QUART_EASEIN:10,QUART_EASEOUT:11,QUART_EASEINOUT:12,QUINT_EASEIN:13,QUINT_EASEOUT:14,QUINT_EASEINOUT:15,EXPO_EASEIN:16,EXPO_EASEOUT:17,EXPO_EASEINOUT:18,CIRC_EASEIN:19,CIRC_EASEOUT:20,CIRC_EASEINOUT:21,ELASTIC_EASEIN:22,ELASTIC_EASEOUT:23,ELASTIC_EASEINOUT:24,BACK_EASEIN:25,BACK_EASEOUT:26,BACK_EASEINOUT:27,BOUNCE_EASEIN:28,BOUNCE_EASEOUT:29,BOUNCE_EASEINOUT:30,TWEEN_EASING_MAX:1e3},ccs.ActionFrame=ccs.Class.extend({frameType:0,easingType:0,frameIndex:0,_Parameter:null,time:0,ctor:function(){this.frameType=0,this.easingType=ccs.FrameEaseType.LINEAR,this.frameIndex=0,this.time=0},getAction:function(t,e){return cc.log("Need a definition of <getAction> for ActionFrame"),null},_getEasingAction:function(t){if(null===t)return console.error("Action cannot be null!"),null;var e;switch(this.easingType){case ccs.FrameEaseType.CUSTOM:break;case ccs.FrameEaseType.LINEAR:e=t;break;case ccs.FrameEaseType.SINE_EASEIN:e=t.easing(cc.easeSineIn());break;case ccs.FrameEaseType.SINE_EASEOUT:e=t.easing(cc.easeSineOut());break;case ccs.FrameEaseType.SINE_EASEINOUT:e=t.easing(cc.easeSineInOut());break;case ccs.FrameEaseType.QUAD_EASEIN:e=t.easing(cc.easeQuadraticActionIn());break;case ccs.FrameEaseType.QUAD_EASEOUT:e=t.easing(cc.easeQuadraticActionOut());break;case ccs.FrameEaseType.QUAD_EASEINOUT:e=t.easing(cc.easeQuadraticActionInOut());break;case ccs.FrameEaseType.CUBIC_EASEIN:e=t.easing(cc.easeCubicActionIn());break;case ccs.FrameEaseType.CUBIC_EASEOUT:e=t.easing(cc.easeCubicActionOut());break;case ccs.FrameEaseType.CUBIC_EASEINOUT:e=t.easing(cc.easeCubicActionInOut());break;case ccs.FrameEaseType.QUART_EASEIN:e=t.easing(cc.easeQuarticActionIn());break;case ccs.FrameEaseType.QUART_EASEOUT:e=t.easing(cc.easeQuarticActionOut());break;case ccs.FrameEaseType.QUART_EASEINOUT:e=t.easing(cc.easeQuarticActionInOut());break;case ccs.FrameEaseType.QUINT_EASEIN:e=t.easing(cc.easeQuinticActionIn());break;case ccs.FrameEaseType.QUINT_EASEOUT:e=t.easing(cc.easeQuinticActionOut());break;case ccs.FrameEaseType.QUINT_EASEINOUT:e=t.easing(cc.easeQuinticActionInOut());break;case ccs.FrameEaseType.EXPO_EASEIN:e=t.easing(cc.easeExponentialIn());break;case ccs.FrameEaseType.EXPO_EASEOUT:e=t.easing(cc.easeExponentialOut());break;case ccs.FrameEaseType.EXPO_EASEINOUT:e=t.easing(cc.easeExponentialInOut());break;case ccs.FrameEaseType.CIRC_EASEIN:e=t.easing(cc.easeCircleActionIn());break;case ccs.FrameEaseType.CIRC_EASEOUT:e=t.easing(cc.easeCircleActionOut());break;case ccs.FrameEaseType.CIRC_EASEINOUT:e=t.easing(cc.easeCircleActionInOut());break;case ccs.FrameEaseType.ELASTIC_EASEIN:e=t.easing(cc.easeElasticIn());break;case ccs.FrameEaseType.ELASTIC_EASEOUT:e=t.easing(cc.easeElasticOut());break;case ccs.FrameEaseType.ELASTIC_EASEINOUT:e=t.easing(cc.easeElasticInOut());break;case ccs.FrameEaseType.BACK_EASEIN:e=t.easing(cc.easeBackIn());break;case ccs.FrameEaseType.BACK_EASEOUT:e=t.easing(cc.easeBackOut());break;case ccs.FrameEaseType.BACK_EASEINOUT:e=t.easing(cc.easeBackInOut());break;case ccs.FrameEaseType.BOUNCE_EASEIN:e=t.easing(cc.easeBounceIn());break;case ccs.FrameEaseType.BOUNCE_EASEOUT:e=t.easing(cc.easeBounceOut());break;case ccs.FrameEaseType.BOUNCE_EASEINOUT:e=t.easing(cc.easeBounceInOut())}return e},setEasingParameter:function(t){this._Parameter=[];for(var e=0;e<t.length;e++)this._Parameter.push(t[e])},setEasingType:function(t){this.easingType=t}}),ccs.ActionMoveFrame=ccs.ActionFrame.extend({_position:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._position=cc.p(0,0),this.frameType=ccs.FRAME_TYPE_MOVE},setPosition:function(t,e){void 0===e?(this._position.x=t.x,this._position.y=t.y):(this._position.x=t,this._position.y=e)},getPosition:function(){return this._position},getAction:function(t){return this._getEasingAction(cc.moveTo(t,this._position))}}),ccs.ActionScaleFrame=ccs.ActionFrame.extend({_scaleX:1,_scaleY:1,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1,this.frameType=ccs.FRAME_TYPE_SCALE},setScaleX:function(t){this._scaleX=t},getScaleX:function(){return this._scaleX},setScaleY:function(t){this._scaleY=t},getScaleY:function(){return this._scaleY},getAction:function(t){return this._getEasingAction(cc.scaleTo(t,this._scaleX,this._scaleY))}}),ccs.ActionRotationFrame=ccs.ActionFrame.extend({_rotation:0,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._rotation=0,this.frameType=ccs.FRAME_TYPE_ROTATE},setRotation:function(t){this._rotation=t},getRotation:function(){return this._rotation},getAction:function(t,e){if(void 0===e)return this._getEasingAction(cc.rotateTo(t,this._rotation));if(e instanceof cc.ActionRotationFrame){var i=this._rotation-e._rotation;return this._getEasingAction(cc.rotateBy(t,i))}return this.getAction(t)}}),ccs.ActionFadeFrame=ccs.ActionFrame.extend({_opacity:255,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._opacity=255,this.frameType=ccs.FRAME_TYPE_FADE},setOpacity:function(t){this._opacity=t},getOpacity:function(){return this._opacity},getAction:function(t){return this._getEasingAction(cc.fadeTo(t,this._opacity))}}),ccs.ActionTintFrame=ccs.ActionFrame.extend({_color:null,ctor:function(){ccs.ActionFrame.prototype.ctor.call(this),this._color=cc.color(255,255,255,255),this.frameType=ccs.FRAME_TYPE_TINT},setColor:function(t){var e=this._color;e.r=t.r,e.g=t.g,e.b=t.b},getColor:function(){var t=this._color;return cc.color(t.r,t.g,t.b,t.a)},getAction:function(t){return this._getEasingAction(cc.tintTo(t,this._color.r,this._color.g,this._color.b))}}),ccs.actionManager={_actionDic:{},initWithDictionary:function(t,e,i){for(var n=t,r=n.lastIndexOf("/"),o=n.substr(r+1,n.length),s=e.actionlist,c=[],a=0;a<s.length;a++){var l=new ccs.ActionObject,h=s[a];l.initWithDictionary(h,i),c.push(l)}this._actionDic[o]=c},getActionByName:function(t,e){var i=t,n=i.lastIndexOf("/"),r=i.substr(n+1,i.length),o=this._actionDic[r];if(!o)return null;for(var s=0;s<o.length;s++){var c=o[s];if(e===c.getName())return c}return null},playActionByName:function(t,e,i){var n=this.getActionByName(t,e);n&&n.play(i)},stopActionByName:function(t,e){var i=this.getActionByName(t,e);i&&i.stop()},releaseActions:function(){this._actionDic={}},clear:function(){this._actionDic={}}},ccs.ActionNode=ccs.Class.extend({_currentFrameIndex:0,_destFrameIndex:0,_unitTime:0,_actionTag:0,_object:null,_actionSpawn:null,_action:null,_frameArray:null,_frameArrayNum:0,ctor:function(){this._currentFrameIndex=0,this._destFrameIndex=0,this._unitTime=.1,this._actionTag=0,this._object=null,this._actionSpawn=null,this._action=null,this._frameArray=[],this._frameArrayNum=ccs.FRAME_TYPE_MAX;for(var t=0;t<this._frameArrayNum;t++)this._frameArray.push([])},initWithDictionary:function(t,e){this.setActionTag(t.ActionTag);for(var i=t.actionframelist,n=ccui.helper.seekActionWidgetByActionTag(e,t.ActionTag),r=n instanceof ccui.Widget&&!(n instanceof ccui.Layout),o=0;o<i.length;o++){var s=i[o],c=s.frameid,a=s.tweenType;null==a&&(a=0);for(var l=s.tweenParameter,h=[],u=0;u<l;u++){var d=s.tweenParameter[u];h.push(d)}var _,p;if(void 0!==s.positionx){var f=s.positionx,m=s.positiony;if(r&&n.parent){var g=n.parent.getAnchorPointInPoints();f+=g.x,m+=g.y}_=new ccs.ActionMoveFrame,_.frameIndex=c,_.setEasingType(a),_.setEasingParameter(h),_.setPosition(f,m),p=this._frameArray[ccs.FRAME_TYPE_MOVE],p.push(_)}if(void 0!==s.scalex){var y=s.scalex,v=s.scaley;_=new ccs.ActionScaleFrame,_.frameIndex=c,_.setEasingType(a),_.setEasingParameter(h),_.setScaleX(y),_.setScaleY(v),p=this._frameArray[ccs.FRAME_TYPE_SCALE],p.push(_)}if(void 0!==s.rotation){var T=s.rotation;_=new ccs.ActionRotationFrame,_.frameIndex=c,_.setEasingType(a),_.setEasingParameter(h),_.setRotation(T),p=this._frameArray[ccs.FRAME_TYPE_ROTATE],p.push(_)}if(void 0!==s.opacity){var C=s.opacity;_=new ccs.ActionFadeFrame,_.frameIndex=c,_.setEasingType(a),_.setEasingParameter(h),_.setOpacity(C),p=this._frameArray[ccs.FRAME_TYPE_FADE],p.push(_)}if(void 0!==s.colorr){var S=s.colorr,x=s.colorg,A=s.colorb;_=new ccs.ActionTintFrame,_.frameIndex=c,_.setEasingType(a),_.setEasingParameter(h),_.setColor(cc.color(S,x,A)),p=this._frameArray[ccs.FRAME_TYPE_TINT],p.push(_)}s=null}this._initActionNodeFromRoot(e)},_initActionNodeFromRoot:function(t){if(t instanceof ccui.Widget){var e=ccui.helper.seekActionWidgetByActionTag(t,this.getActionTag());e&&this.setObject(e)}},setUnitTime:function(t){this._unitTime=t,this._refreshActionProperty()},getUnitTime:function(){return this._unitTime},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},setObject:function(t){this._object=t},getObject:function(){return this._object},getActionNode:function(){return this._object instanceof cc.Node?this._object:null},insertFrame:function(t,e){if(null!=e){var i=e.frameType,n=this._frameArray[i];n.splice(t,0,e)}},addFrame:function(t){if(t){var e=t.frameType,i=this._frameArray[e];i.push(t)}},deleteFrame:function(t){if(null!=t){var e=t.frameType,i=this._frameArray[e];cc.arrayRemoveObject(i,t)}},clearAllFrame:function(){for(var t=0;t<this._frameArrayNum;t++)this._frameArray[t].length=0},_refreshActionProperty:function(){if(null===this._object)return null;for(var t=[],e=0;e<this._frameArrayNum;e++){var i=this._frameArray[e];if(!(i.length<=0)){for(var n=[],r=0;r<i.length;r++){var o=i[r],s=null;if(0!==r){var c=i[r-1],a=(o.frameIndex-c.frameIndex)*this.getUnitTime();s=o.getAction(a)}else s=o.getAction(0);s&&n.push(s)}if(n){var l=cc.sequence(n);null!==l&&t.push(l)}}}return this._action=null,this._actionSpawn=cc.spawn(t),this._actionSpawn},playAction:function(t){null!==this._object&&null!==this._actionSpawn&&(t?this._action=cc.sequence(this._actionSpawn,t):this._action=cc.sequence(this._actionSpawn),this._runAction())},_runAction:function(){var t=this.getActionNode();null!==t&&null!==this._action&&t.runAction(this._action)},stopAction:function(){var t=this.getActionNode();null!==t&&null!==this._action&&(this._action.isDone()||t.stopAction(this._action))},getFirstFrameIndex:function(){for(var t=99999,e=!1,i=this._frameArray,n=0,r=this._frameArrayNum;n<r;n++){var o=i[n];if(!(o.length<=0)){e=!0;var s=o[0].frameIndex;t=t>s?s:t}}return e||(t=0),t},getLastFrameIndex:function(){for(var t=-1,e=!1,i=this._frameArray,n=0,r=this._frameArrayNum;n<r;n++){var o=i[n];if(!(o.length<=0)){e=!0;var s=o[o.length-1],c=s.frameIndex;t=t<c?c:t}}return e||(t=0),t},updateActionToTimeLine:function(t){for(var e=!1,i=this.getUnitTime(),n=0;n<this._frameArrayNum;n++){var r=this._frameArray[n];if(null!==r)for(var o=0;o<r.length;o++){var s=r[o];if(s.frameIndex*i===t){this._easingToFrame(1,1,s),e=!0;break}if(s.frameIndex*i>t){if(0===o)this._easingToFrame(1,1,s),e=!1;else{var c=r[o-1],a=(s.frameIndex-c.frameIndex)*i,l=t-c.frameIndex*i;this._easingToFrame(a,1,c),this._easingToFrame(a,l/a,s),e=!0}break}}}return e},_easingToFrame:function(t,e,i){var n=i.getAction(t),r=this.getActionNode();null!=n&&null!=r&&(n.startWithTarget(r),n.update(e))},isActionDoneOnce:function(){return null===this._action||this._action.isDone()}}),ccs.ActionObject=ccs.Class.extend({_actionNodeList:null,_name:"",_loop:!1,_pause:!1,_playing:!1,_unitTime:0,_currentTime:0,_scheduler:null,_callback:null,_fTotalTime:0,ctor:function(){this._actionNodeList=[],this._name="",this._loop=!1,this._pause=!1,this._playing=!1,this._unitTime=.1,this._currentTime=0,this._fTotalTime=0,this._scheduler=cc.director.getScheduler()},setName:function(t){this._name=t},getName:function(){return this._name},setLoop:function(t){this._loop=t},getLoop:function(){return this._loop},setUnitTime:function(t){this._unitTime=t;for(var e=this._actionNodeList.length,i=0;i<e;i++){var n=this._actionNodeList[i];n.setUnitTime(this._unitTime)}},getUnitTime:function(){return this._unitTime},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(t){this._currentTime=t},getTotalTime:function(){return this._fTotalTime},isPlaying:function(){return this._playing},initWithDictionary:function(t,e){this.setName(t.name),this.setLoop(t.loop),this.setUnitTime(t.unittime);for(var i=t.actionnodelist,n=0,r=0;r<i.length;r++){var o=new ccs.ActionNode,s=i[r];o.initWithDictionary(s,e),o.setUnitTime(this.getUnitTime()),this._actionNodeList.push(o);var c=o.getLastFrameIndex()-o.getFirstFrameIndex();c>n&&(n=c)}this._fTotalTime=n*this._unitTime},addActionNode:function(t){t&&(this._actionNodeList.push(t),t.setUnitTime(this._unitTime))},removeActionNode:function(t){null!=t&&cc.arrayRemoveObject(this._actionNodeList,t)},play:function(t){this.stop(),this.updateToFrameByTime(0);for(var e=this._actionNodeList,i=e.length,n=0;n<i;n++)e[n].playAction(t);this._loop&&this._scheduler.schedule(this.simulationActionUpdate,this,0,cc.REPEAT_FOREVER,0,!1,this.__instanceId+""),void 0!==t&&(this._callback=t)},pause:function(){this._pause=!0,this._playing=!1},stop:function(){for(var t=this._actionNodeList,e=0;e<t.length;e++)t[e].stopAction();this._scheduler.unschedule(this.simulationActionUpdate,this),this._pause=!1,this._playing=!1},updateToFrameByTime:function(t){this._currentTime=t;for(var e=0;e<this._actionNodeList.length;e++){var i=this._actionNodeList[e];i.updateActionToTimeLine(t)}},simulationActionUpdate:function(t){for(var e=!0,i=this._actionNodeList,n=0,r=i.length;n<r;n++)if(!i[n].isActionDoneOnce()){e=!1;break}e&&(null!==this._callback&&this._callback.execute(),this._loop?this.play():(this._playing=!1,this._scheduler.unschedule(this.simulationActionUpdate,this)))}}),ccs.ComAttribute=ccs.Component.extend({_jsonDict:null,_filePath:"",ctor:function(){cc.Component.prototype.ctor.call(this),this._jsonDict={},this._filePath="",this._name="CCComAttribute",ccs.ComAttribute.prototype.init.call(this)},init:function(){return this._jsonDict={},!0},setInt:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},setDouble:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},setFloat:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},setBool:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},setString:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},setObject:function(t,e){return t?void(this._jsonDict[t]=e):void cc.log("Argument must be non-nil")},getInt:function(t){var e=this._jsonDict[t];return parseInt(e||0)},getDouble:function(t){var e=this._jsonDict[t];return parseFloat(e||0)},getFloat:function(t){var e=this._jsonDict[t];return parseFloat(e||0)},getBool:function(t){var e=this._jsonDict[t];return Boolean(e||!1)},getString:function(t){var e=this._jsonDict[t];return e||""},getObject:function(t){return this._jsonDict[t]},parse:function(t){this._jsonDict=cc.loader.getRes(t)}}),ccs.ComAttribute.create=function(){return new ccs.ComAttribute},ccs.ComAudio=ccs.Component.extend({_filePath:"",_loop:!1,ctor:function(){cc.Component.prototype.ctor.call(this),this._name="Audio",ccs.ComAudio.prototype.init.call(this)},init:function(){return!0},onExit:function(){this.stopBackgroundMusic(!0),this.stopAllEffects()},end:function(){cc.audioEngine.end()},preloadBackgroundMusic:function(t){cc.loader.load(t)},playBackgroundMusic:function(t,e){t?cc.audioEngine.playMusic(t,e):cc.audioEngine.playMusic(this._filePath,this._loop)},stopBackgroundMusic:function(t){cc.audioEngine.stopMusic(t)},pauseBackgroundMusic:function(){cc.audioEngine.pauseMusic()},resumeBackgroundMusic:function(){cc.audioEngine.resumeMusic()},rewindBackgroundMusic:function(){cc.audioEngine.rewindMusic()},willPlayBackgroundMusic:function(){return cc.audioEngine.willPlayMusic()},isBackgroundMusicPlaying:function(){return cc.audioEngine.isMusicPlaying()},getBackgroundMusicVolume:function(){return cc.audioEngine.getMusicVolume()},setBackgroundMusicVolume:function(t){cc.audioEngine.setMusicVolume(t)},getEffectsVolume:function(){return cc.audioEngine.getEffectsVolume()},setEffectsVolume:function(t){cc.audioEngine.setEffectsVolume(t)},playEffect:function(t,e){return t?cc.audioEngine.playEffect(t,e):cc.audioEngine.playEffect(this._filePath,this._loop)},pauseEffect:function(t){cc.audioEngine.pauseEffect(t)},pauseAllEffects:function(){cc.audioEngine.pauseAllEffects()},resumeEffect:function(t){cc.audioEngine.resumeEffect(t)},resumeAllEffects:function(){cc.audioEngine.resumeAllEffects()},stopEffect:function(t){cc.audioEngine.stopEffect(t)},stopAllEffects:function(){cc.audioEngine.stopAllEffects()},preloadEffect:function(t){cc.loader.getRes(t),this.setFile(t),this.setLoop(!1)},unloadEffect:function(t){cc.audioEngine.unloadEffect(t)},setFile:function(t){this._filePath=t},setLoop:function(t){this._loop=t},getFile:function(){return this._filePath},isLoop:function(){return this._loop}}),ccs.ComAudio.create=function(){return new ccs.ComAudio},ccs.ComController=ccs.Component.extend({ctor:function(){cc.Component.prototype.ctor.call(this),this._name="ComController",ccs.ComController.prototype.init.call(this)},onEnter:function(){null!==this._owner&&this._owner.scheduleUpdate()},isEnabled:function(){return this._enabled},setEnabled:function(t){this._enabled=t}}),ccs.ComController.create=function(){return new ccs.ComController},ccs.ComRender=ccs.Component.extend({_render:null,ctor:function(t,e){cc.Component.prototype.ctor.call(this),this._render=t,this._name=e,this.isRenderer=!0,ccs.ComRender.prototype.init.call(this)},onEnter:function(){this._owner&&this._owner.addChild(this._render)},onExit:function(){this._owner&&(this._owner.removeChild(this._render,!0),this._render=null)},getNode:function(){return this._render},setNode:function(t){this._render=t}}),ccs.ComRender.create=function(t,e){return new ccs.ComRender(t,e)},ccs.objectFactory={_typeMap:{},createObject:function(t){var e=null,i=this._typeMap[t];return i&&(e=cc.isFunction(i._fun)?new i._fun:i._fun),e},registerType:function(t){this._typeMap[t._className]=t},createGUI:function(t){var e=null;"Panel"===t?t="Layout":"TextArea"===t?t="Label":"TextButton"===t&&(t="Button");var i=this._typeMap[t];return i&&i._fun&&(e=i._fun),e},removeAll:function(){this._typeMap={}}},ccs.TInfo=ccs.Class.extend({_className:"",_fun:null,ctor:function(t,e){e?(this._className=t,this._fun=e):(this._className=t._className,this._fun=t._fun),ccs.objectFactory.registerType(this)}}),ccs.sendEvent=function(t){var e=ccs.triggerManager.get(t);if(null!=e)for(var i=0;i<e.length;i++){var n=e[i];null!=n&&n.detect()&&n.done()}},ccs.registerTriggerClass=function(t,e){new ccs.TInfo(t,e)},ccs.triggerManager={_eventTriggers:{},_triggerObjs:{},_movementDispatches:[],parse:function(t){for(var e=0;e<t.length;++e){var i=t[e],n=new ccs.TriggerObj;n.serialize(i);for(var r=n.getEvents(),o=0;o<r.length;o++){var s=r[o];this.add(s,n)}this._triggerObjs[n.getId()]=n}},get:function(t){return this._eventTriggers[t]},getTriggerObj:function(t){return this._triggerObjs[t]},add:function(t,e){var i=this._eventTriggers[t];i||(i=[]),i.indexOf(e)===-1&&(i.push(e),this._eventTriggers[t]=i)},removeAll:function(){for(var t in this._eventTriggers)for(var e=this._eventTriggers[t],i=0;i<e.length;i++){var n=e[i];n.removeAll()}this._eventTriggers={}},remove:function(t,e){if(e)return this._removeObj(t,e);var i=!1;do{var n=this._eventTriggers[t];if(!n)break;for(var r=0;r<n.length;r++){var o=n[r];o&&o.removeAll()}delete this._eventTriggers[t],i=!0}while(0);return i},_removeObj:function(t,e){var i=!1;do{var n=this._eventTriggers[t];if(!n)break;for(var r=0;r<n.length;r++){var o=n[r];if(o&&o==e){o.removeAll(),n.splice(r,1);break}}i=!0}while(0);return i},removeTriggerObj:function(t){var e=this.getTriggerObj(t);if(!e)return!1;for(var i=e.getEvents(),n=0;n<i.length;n++){var r=i[n];this.remove(r,e)}return!0},isEmpty:function(){return!this._eventTriggers||this._eventTriggers.length<=0},addArmatureMovementCallBack:function(t,e,i){if(null!=t&&null!=i&&null!=e){for(var n,r=!1,o=0;o<this._movementDispatches.length;o++)n=this._movementDispatches[o],n&&n[0]===t&&(n.addAnimationEventCallBack(e,i),r=!0);if(!r){var s=new ccs.ArmatureMovementDispatcher;t.getAnimation().setMovementEventCallFunc(s.animationEvent,s),s.addAnimationEventCallBack(e,i),this._movementDispatches.push([t,s])}}},removeArmatureMovementCallBack:function(t,e,i){if(null!=t&&null!=e&&null!=i)for(var n,r=0;r<this._movementDispatches.length;r++)n=this._movementDispatches[r],n&&n[0]===t&&n.removeAnimationEventCallBack(i,e)},removeArmatureAllMovementCallBack:function(t){if(null!=t)for(var e,i=0;i<this._movementDispatches.length;i++)if(e=this._movementDispatches[i],e&&e[0]===t){this._movementDispatches.splice(i,1);break}},removeAllArmatureMovementCallBack:function(){this._movementDispatches.length=0},version:function(){return"1.2.0.0"}},ccs.ArmatureMovementDispatcher=ccs.Class.extend({_mapEventAnimation:null,ctor:function(){this._mapEventAnimation=[]},animationEvent:function(t,e,i){for(var n,r,o,s=0;s<this._mapEventAnimation.length;s++)n=this._mapEventAnimation[s],r=n[0],o=n[1],o&&o.call(r,t,e,i)},addAnimationEventCallBack:function(t,e){this._mapEventAnimation.push([e,t])},removeAnimationEventCallBack:function(t,e){for(var i,n=0;n<this._mapEventAnimation.length;n++)i=this._mapEventAnimation[n],i[0]===e&&this._mapEventAnimation.splice(n,1)}}),ccs.BaseTriggerCondition=ccs.Class.extend({ctor:function(){},init:function(){return!0},detect:function(){return!0},serialize:function(t){},removeAll:function(){}}),ccs.BaseTriggerAction=ccs.Class.extend({ctor:function(){},init:function(){return!0},done:function(){},serialize:function(t){},removeAll:function(){}}),ccs.TriggerObj=ccs.Class.extend({_cons:null,_acts:null,_id:0,_enable:!0,_vInt:null,ctor:function(){this._id=0,this._enable=!0,ccs.TriggerObj.prototype.init.call(this)},init:function(){return this._cons=[],this._acts=[],this._vInt=[],!0},detect:function(){if(!this._enable||0===this._cons.length)return!0;for(var t=!0,e=null,i=0;i<this._cons.length;i++)e=this._cons[i],e&&e.detect&&(t=t&&e.detect());return t},done:function(){if(this._enable&&0!==this._acts.length)for(var t,e=0;e<this._acts.length;e++)t=this._acts[e],t&&t.done&&t.done()},removeAll:function(){for(var t=null,e=0;e<this._cons.length;e++)t=this._cons[e],t&&t.removeAll();this._cons=[];for(var e=0;e<this._acts.length;e++)t=this._acts[e],t&&t.removeAll();this._acts=[]},serialize:function(t){this._id=t.id||0;for(var e=t.conditions||[],i=0;i<e.length;i++){var n=e[i],r=n.classname,o=ccs.objectFactory.createObject(r);o?(o.serialize(n),o.init(),this._cons.push(o)):cc.log("class named classname("+r+") can not implement!")}for(var s=t.actions||[],i=0;i<s.length;i++){var n=s[i],r=n.classname,c=ccs.objectFactory.createObject(r);c?(c.serialize(n),c.init(),this._acts.push(c)):cc.log("class named classname("+r+") can not implement!")}for(var a=t.events||[],i=0;i<a.length;i++){var n=a[i],l=n.id;l<0||this._vInt.push(l)}},getId:function(){return this._id},setEnable:function(t){this._enable=t},getEvents:function(){return this._vInt}}),ccs.TriggerObj.create=function(){return new ccs.TriggerObj},ccs.ActionTimelineData=ccs.Class.extend({_actionTag:0,ctor:function(t){this._init(t)},_init:function(t){return this._actionTag=t,!0},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag}}),ccs.AnimationInfo=function(t,e,i){this.name=t,this.startIndex=e,this.endIndex=i},ccs.ComExtensionData=ccs.Component.extend({_customProperty:null,_timelineData:null,_name:"ComExtensionData",ctor:function(){return this._customProperty="",this._timelineData=new ccs.ActionTimelineData(0),!0},setActionTag:function(t){this._timelineData.setActionTag(t)},getActionTag:function(){return this._timelineData.getActionTag()},setCustomProperty:function(t){this._customProperty=t},getCustomProperty:function(){return this._customProperty}}),ccs.ComExtensionData.create=function(){return new ccs.ComExtensionData},ccs.ActionTimelineData.create=function(t){return new ccs.ActionTimelineData(t)},ccs.ActionTimeline=cc.Action.extend({_timelineMap:null,_timelineList:null,_duration:0,_time:null,_timeSpeed:1,_frameInternal:1/60,_playing:!1,_currentFrame:0,_startFrame:0,_endFrame:0,_loop:null,_frameEventListener:null,_animationInfos:null,_lastFrameListener:null,ctor:function(){cc.Action.prototype.ctor.call(this),this._timelineMap={},this._timelineList=[],this._animationInfos={},this.init()},_gotoFrame:function(t){for(var e=this._timelineList.length,i=0;i<e;i++)this._timelineList[i]._gotoFrame(t)},_stepToFrame:function(t){for(var e=this._timelineList.length,i=0;i<e;i++)this._timelineList[i]._stepToFrame(t)},_emitFrameEvent:function(t){this._frameEventListener&&this._frameEventListener(t)},init:function(){return!0},gotoFrameAndPlay:function(t,e,i,n){var r,o=0,s=arguments.length,c=[];for(o;o<s;o++)"boolean"==typeof arguments[o]?r=arguments[o]:c.push(arguments[o]);t=c[0],e=void 0!==c[1]?c[1]:this._duration,i=c[2]||t,n=null==r||r,this._startFrame=t,this._endFrame=e,this._currentFrame=i,this._loop=n,this._time=this._currentFrame*this._frameInternal,this.resume(),this._gotoFrame(this._currentFrame)},gotoFrameAndPause:function(t){this._startFrame=this._currentFrame=t,this._time=this._currentFrame*this._frameInternal,this.pause(),this._gotoFrame(this._currentFrame)},pause:function(){this._playing=!1},resume:function(){this._playing=!0},isPlaying:function(){return this._playing},setTimeSpeed:function(t){this._timeSpeed=t},getTimeSpeed:function(){return this._timeSpeed},setDuration:function(t){this._duration=t},getDuration:function(){return this._duration},getStartFrame:function(){return this._startFrame},getEndFrame:function(){return this._endFrame},setCurrentFrame:function(t){t>=this._startFrame&&t<=this._endFrame?(this._currentFrame=t,this._time=this._currentFrame*this._frameInternal):cc.log("frame index is not between start frame and end frame")},getCurrentFrame:function(){return this._currentFrame},addTimeline:function(t){var e=t.getActionTag();this._timelineMap[e]||(this._timelineMap[e]=[]),this._timelineMap[e].indexOf(t)===-1&&(this._timelineList.push(t),this._timelineMap[e].push(t),t.setActionTimeline(this))},removeTimeline:function(t){var e=t.getActionTag();this._timelineMap[e]&&this._timelineMap[e].some(function(e){if(e===t)return!0})&&(cc.arrayRemoveObject(this._timelineMap[e],t),cc.arrayRemoveObject(this._timelineList,t),t.setActionTimeline(null))},getTimelines:function(){return this._timelineList},setFrameEventCallFunc:function(t){this._frameEventListener=t},clearFrameEventCallFunc:function(){this._frameEventListener=null},clone:function(){var t=new ccs.ActionTimeline;t.setDuration(this._duration),t.setTimeSpeed(this._timeSpeed);for(var e in this._timelineMap){var i=this._timelineMap[e];for(var n in i){var r=i[n],o=r.clone();t.addTimeline(o)}}return t},reverse:function(){return null},step:function(t){if(this._playing&&0!==this._timelineMap.length&&0!==this._duration){this._time+=t*this._timeSpeed;var e=this._time-this._endFrame*this._frameInternal;e<this._frameInternal?(this._currentFrame=Math.floor(this._time/this._frameInternal),this._stepToFrame(this._currentFrame),e>=0&&this._lastFrameListener&&this._lastFrameListener()):(this._playing=this._loop,this._playing?this.gotoFrameAndPlay(this._startFrame,this._endFrame,this._loop):(this._time=this._endFrame*this._frameInternal,this._currentFrame!=this._endFrame&&(this._currentFrame=this._endFrame,this._stepToFrame(this._currentFrame),this._lastFrameListener&&this._lastFrameListener())))}},_foreachNodeDescendant:function(t,e){e(t);for(var i=t.getChildren(),n=0;n<i.length;n++){var r=i[n];this._foreachNodeDescendant(r,e)}},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t);var e=this,i=function(t){var i=t.getComponent("ComExtensionData");if(i){var n=i.getActionTag();if(e._timelineMap[n])for(var r=e._timelineMap[n],o=0;o<r.length;o++){var s=r[o];s.setNode(t)}}};this._foreachNodeDescendant(t,i)},isDone:function(){return!1},play:function(t,e){var i=this._animationInfos[t];return i?void this.gotoFrameAndPlay(i.startIndex,i.endIndex,e):cc.log("Can't find animation info for %s",t)},addAnimationInfo:function(t){this._animationInfos[t.name]=t},removeAnimationInfo:function(t){delete this._animationInfos[t]},isAnimationInfoExists:function(t){return this._animationInfos[t]},getAnimationInfo:function(t){return this._animationInfos[t]},setLastFrameCallFunc:function(t){this._lastFrameListener=t},clearLastFrameCallFunc:function(){this._lastFrameListener=null}}),ccs.ActionTimeline.create=function(){return new ccs.ActionTimeline},ccs.Frame=ccs.Class.extend({_frameIndex:null,_tween:null,_timeline:null,_node:null,_tweenType:null,_easingParam:null,_enterWhenPassed:null,ctor:function(){this._frameIndex=0,this._tween=!0,this._timeline=null,this._node=null,this._enterWhenPassed=!1,this._easingParam=[]},_emitEvent:function(){this._timeline&&this._timeline.getActionTimeline()._emitFrameEvent(this)},_cloneProperty:function(t){this._frameIndex=t.getFrameIndex(),this._tween=t.isTween(),this._tweenType=t.getTweenType(),this.setEasingParams(t.getEasingParams())},setFrameIndex:function(t){this._frameIndex=t},getFrameIndex:function(){return this._frameIndex},setTimeline:function(t){this._timeline=t},getTimeline:function(t){return this._timeline},setNode:function(t){this._node=t},getNode:function(){return this._node},setTween:function(t){this._tween=t},isTween:function(){return this._tween},onEnter:function(t){},apply:function(t){this._tween&&(this._tweenType!==ccs.FrameEaseType.TWEEN_EASING_MAX&&this._tweenType!==ccs.FrameEaseType.LINEAR&&(t=this.tweenPercent(t)),this._onApply(t))},_onApply:function(t){},clone:function(){},tweenPercent:function(t){var e=ccs.Frame.tweenToMap[this._tweenType];return e?e(t,this._easingParam):t},setEasingParams:function(t){if(t){this._easingParam.length=0;for(var e=0;e<t.length;e++)this._easingParam[e]=t[e]}},getEasingParams:function(){return this._easingParam},setTweenType:function(t){this._tweenType=t},getTweenType:function(){return this._tweenType},isEnterWhenPassed:function(){return this._enterWhenPassed}}),ccs.Frame.tweenToMap={"-1":function(t,e){if(e){var i=1-t;return e[1]*i*i*i+3*e[3]*t*i*i+3*e[5]*t*t*i+e[7]*t*t*t}return t},1:cc._easeSineInObj.easing,2:cc._easeSineOutObj.easing,3:cc._easeSineInOutObj.easing,4:cc._easeQuadraticActionIn.easing,5:cc._easeQuadraticActionOut.easing,6:cc._easeQuadraticActionInOut.easing,7:cc._easeCubicActionIn.easing,8:cc._easeCubicActionOut.easing,9:cc._easeCubicActionInOut.easing,10:cc._easeCubicActionIn.easing,11:cc._easeCubicActionOut.easing,12:cc._easeCubicActionInOut.easing,13:cc._easeQuinticActionIn.easing,14:cc._easeQuinticActionOut.easing,15:cc._easeQuinticActionInOut.easing,16:cc._easeExponentialInObj.easing,17:cc._easeExponentialOutObj.easing,18:cc._easeExponentialInOutObj.easing,19:cc._easeCircleActionIn.easing,20:cc._easeCircleActionOut.easing,21:cc._easeCircleActionInOut.easing,22:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticIn(i).easing(t)},23:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticOut(i).easing(t)},24:function(t,e){var i=.3;return null!=e&&(i=e[0]),cc.easeElasticInOut(i).easing(t)},25:cc._easeBackInObj.easing,26:cc._easeBackOutObj.easing,27:cc._easeBackInOutObj.easing,28:cc._easeBounceInObj.easing,29:cc._easeBounceOutObj.easing,30:cc._easeBounceInOutObj.easing},ccs.VisibleFrame=ccs.Frame.extend({_visible:!0,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._visible=!0},onEnter:function(t){this._node&&this._node.setVisible(this._visible)},clone:function(){var t=new ccs.VisibleFrame;return t.setVisible(this._visible),t._cloneProperty(this),t},setVisible:function(t){this._visible=t},isVisible:function(){return this._visible}}),ccs.VisibleFrame.create=function(){return new ccs.VisibleFrame},ccs.TextureFrame=ccs.Frame.extend({_sprite:null,_textureName:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._textureName=""},setNode:function(t){ccs.Frame.prototype.setNode.call(this,t),this._sprite=t},onEnter:function(t){if(this._sprite){var e=this._sprite.getBlendFunc(),i=cc.spriteFrameCache._spriteFrames[this._textureName];null!=i?this._sprite.setSpriteFrame(i):this._sprite.setTexture(this._textureName),this._sprite.getBlendFunc()!==e&&this._sprite.setBlendFunc(e)}},clone:function(){var t=new ccs.TextureFrame;return t.setTextureName(this._textureName),t._cloneProperty(this),t},setTextureName:function(t){this._textureName=t},getTextureName:function(){return this._textureName}}),ccs.TextureFrame.create=function(){return new ccs.TextureFrame},ccs.RotationFrame=ccs.Frame.extend({_rotation:null,_betwennRotation:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._rotation=0},onEnter:function(t){this._node&&(this._node.setRotation(this._rotation),this._tween&&(this._betwennRotation=t._rotation-this._rotation))},_onApply:function(t){if(0!==this._betwennRotation){var e=this._rotation+t*this._betwennRotation;this._node.setRotation(e)}},clone:function(){var t=new ccs.RotationFrame;return t.setRotation(this._rotation),t._cloneProperty(this),t},setRotation:function(t){this._rotation=t},getRotation:function(){return this._rotation}}),ccs.RotationFrame.create=function(){return new ccs.RotationFrame},ccs.SkewFrame=ccs.Frame.extend({_skewX:null,_skewY:null,_betweenSkewX:null,_betweenSkewY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._skewX=0,this._skewY=0},onEnter:function(t){this._node&&(this._node.setSkewX(this._skewX),this._node.setSkewY(this._skewY),this._tween&&(this._betweenSkewX=t._skewX-this._skewX,this._betweenSkewY=t._skewY-this._skewY))},_onApply:function(t){if(0!==this._betweenSkewX||0!==this._betweenSkewY){var e=this._skewX+t*this._betweenSkewX,i=this._skewY+t*this._betweenSkewY;this._node.setSkewX(e),this._node.setSkewY(i)}},clone:function(){var t=new ccs.SkewFrame;return t.setSkewX(this._skewX),t.setSkewY(this._skewY),t._cloneProperty(this),t},setSkewX:function(t){this._skewX=t},getSkewX:function(){return this._skewX},setSkewY:function(t){this._skewY=t},getSkewY:function(){return this._skewY}}),ccs.SkewFrame.create=function(){return new ccs.SkewFrame},ccs.RotationSkewFrame=ccs.SkewFrame.extend({onEnter:function(t){this._node&&(this._node.setRotationX(this._skewX),this._node.setRotationY(this._skewY),this._tween&&(this._betweenSkewX=t._skewX-this._skewX,this._betweenSkewY=t._skewY-this._skewY))},_onApply:function(t){if(this._node&&(0!==this._betweenSkewX||0!==this._betweenSkewY)){var e=this._skewX+t*this._betweenSkewX,i=this._skewY+t*this._betweenSkewY;this._node.setRotationX(e),this._node.setRotationY(i)}},clone:function(){var t=new ccs.RotationSkewFrame;return t.setSkewX(this._skewX),t.setSkewY(this._skewY),t._cloneProperty(this),t}}),ccs.RotationSkewFrame.create=function(){return new ccs.RotationSkewFrame},ccs.PositionFrame=ccs.Frame.extend({_position:null,_betweenX:null,_betweenY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._position=cc.p(0,0)},onEnter:function(t){this._node&&(this._node.setPosition(this._position),this._tween&&(this._betweenX=t._position.x-this._position.x,this._betweenY=t._position.y-this._position.y))},_onApply:function(t){if(this._node&&(0!==this._betweenX||0!==this._betweenY)){var e=cc.p(0,0);e.x=this._position.x+this._betweenX*t,e.y=this._position.y+this._betweenY*t,this._node.setPosition(e)}},clone:function(){var t=new ccs.PositionFrame;return t.setPosition(this._position),t._cloneProperty(this),t},setPosition:function(t){this._position=t},getPosition:function(){return this._position},setX:function(t){this._position.x=t},getX:function(){return this._position.x},setY:function(t){this._position.y=t},getY:function(){return this._position.y}}),ccs.PositionFrame.create=function(){return new ccs.PositionFrame},ccs.ScaleFrame=ccs.Frame.extend({_scaleX:null,_scaleY:null,_betweenScaleX:null,_betweenScaleY:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._scaleX=1,this._scaleY=1},onEnter:function(t){this._node&&(this._node.setScaleX(this._scaleX),this._node.setScaleY(this._scaleY),this._tween&&(this._betweenScaleX=t._scaleX-this._scaleX,this._betweenScaleY=t._scaleY-this._scaleY))},_onApply:function(t){if(this._node&&(0!==this._betweenScaleX||0!==this._betweenScaleY)){var e=this._scaleX+this._betweenScaleX*t,i=this._scaleY+this._betweenScaleY*t;this._node.setScaleX(e),this._node.setScaleY(i)}},clone:function(){var t=new ccs.ScaleFrame;return t.setScaleX(this._scaleX),t.setScaleY(this._scaleY),t._cloneProperty(this),t},setScale:function(t){this._scaleX=t,this._scaleY=t},setScaleX:function(t){this._scaleX=t},getScaleX:function(){return this._scaleX},setScaleY:function(t){this._scaleY=t},getScaleY:function(){return this._scaleY}}),ccs.ScaleFrame.create=function(){return new ccs.ScaleFrame},ccs.AnchorPointFrame=ccs.Frame.extend({_anchorPoint:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._anchorPoint=cc.p(0,0)},onEnter:function(t){this._node&&this._node.setAnchorPoint(this._anchorPoint)},clone:function(){var t=new ccs.AnchorPointFrame;return t.setAnchorPoint(this._anchorPoint),t._cloneProperty(this),t},setAnchorPoint:function(t){this._anchorPoint=t},getAnchorPoint:function(){return this._anchorPoint}}),ccs.AnchorPointFrame.create=function(){return new ccs.AnchorPointFrame},ccs.InnerActionType={LoopAction:0,NoLoopAction:1,SingleFrame:2},ccs.InnerActionFrame=ccs.Frame.extend({_innerActionType:null,_startFrameIndex:null,_endFrameIndex:0,_singleFrameIndex:0,_enterWithName:null,_animationName:"",ctor:function(){ccs.Frame.prototype.ctor.call(this),this._enterWithName=!1,this._innerActionType=ccs.InnerActionType.LoopAction,this._startFrameIndex=0},onEnter:function(t){if(this._node){var e=this._node.getActionByTag(this._node.getTag());if(e){if(ccs.InnerActionType.SingleFrame===this._innerActionType)return void e.gotoFrameAndPause(this._singleFrameIndex);var i=this._startFrameIndex,n=this._endFrameIndex;if(this._enterWithName)if("-- ALL --"===this._animationName)i=0,n=e.getDuration();else if(e.isAnimationInfoExists(this._animationName)){var r=e.getAnimationInfo(this._animationName);i=r.startIndex,n=r.endIndex}else cc.log("Animation %s not exists!",this._animationName);var o=this._timeline.getActionTimeline().getDuration(),s=o-this._frameIndex-n+i;s<0&&(n+=s),ccs.InnerActionType.NoLoopAction===this._innerActionType?e.gotoFrameAndPlay(i,n,!1):ccs.InnerActionType.LoopAction===this._innerActionType&&e.gotoFrameAndPlay(i,n,!0)}}},setAnimationName:function(t){this._animationName=t},setSingleFrameIndex:function(t){this._singleFrameIndex=t},getSingleFrameIndex:function(){return this._startFrameIndex},setEnterWithName:function(t){this._enterWithName=t},getEnterWithName:function(){return this._enterWithName},clone:function(){var t=new ccs.InnerActionFrame;return t.setInnerActionType(this._innerActionType),t.setStartFrameIndex(this._startFrameIndex),t.setEnterWithName(this._enterWithName),t.setAnimationName(this._animationName),t.setSingleFrameIndex(this._singleFrameIndex),t._cloneProperty(this),t},setInnerActionType:function(t){this._innerActionType=t},getInnerActionType:function(){return this._innerActionType},setStartFrameIndex:function(t){this._startFrameIndex=t},getStartFrameIndex:function(){return this._startFrameIndex}}),ccs.InnerActionFrame.create=function(){return new ccs.InnerActionFrame},ccs.ColorFrame=ccs.Frame.extend({_alpha:null,_color:null,_betweenAlpha:null,_betweenRed:null,_betweenGreen:null,_betweenBlue:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._color=cc.color(255,255,255)},onEnter:function(t){if(this._node&&(this._node.setColor(this._color),this._tween)){var e=t._color;this._betweenRed=e.r-this._color.r,this._betweenGreen=e.g-this._color.g,this._betweenBlue=e.b-this._color.b}},_onApply:function(t){if(this._node&&this._tween&&(0!==this._betweenAlpha||0!==this._betweenRed||0!==this._betweenGreen||0!==this._betweenBlue)){var e=cc.color(255,255,255);if(e.r=this._color.r+this._betweenRed*t,e.g=this._color.g+this._betweenGreen*t,e.b=this._color.b+this._betweenBlue*t,this._node.setColor(e),null!==this._alpha){var i=this._alpha+this._betweenAlpha*t;this._node.setOpacity(i)}}},clone:function(){var t=new ccs.ColorFrame;return t.setColor(this._color),t._cloneProperty(this),t},setColor:function(t){this._color=t},getColor:function(){return this._color}}),ccs.ColorFrame.create=function(){return new ccs.ColorFrame},ccs.AlphaFrame=ccs.Frame.extend({_alpha:null,_betweenAlpha:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._alpha=255},onEnter:function(t){this._node&&(this._node.setOpacity(this._alpha),this._tween&&(this._betweenAlpha=t._alpha-this._alpha))},_onApply:function(t){if(this._node){var e=this._alpha+this._betweenAlpha*t;this._node.setOpacity(e)}},setAlpha:function(t){this._alpha=t},getAlpha:function(){return this._alpha},clone:function(){var t=new ccs.AlphaFrame;return t.setAlpha(this._alpha),t._cloneProperty(this),t}}),ccs.EventFrame=ccs.Frame.extend({_event:null,ctor:function(){ccs.Frame.prototype.ctor.call(this),this._event="",this._enterWhenPassed=!0},onEnter:function(t){this._emitEvent()},clone:function(){var t=new ccs.EventFrame;return t.setEvent(this._event),t._cloneProperty(this),t},setEvent:function(t){this._event=t},getEvent:function(){return this._event}}),ccs.EventFrame.create=function(){return new ccs.EventFrame},ccs.ZOrderFrame=ccs.Frame.extend({_zorder:0,onEnter:function(t){this._node&&this._node.setLocalZOrder(this._zorder)},clone:function(){var t=new ccs.ZOrderFrame;return t.setZOrder(this._zorder),t._cloneProperty(this),t},setZOrder:function(t){this._zorder=t},getZOrder:function(){return this._zorder}}),ccs.ZOrderFrame.create=function(){return new ccs.ZOrderFrame},ccs.BlendFuncFrame=ccs.Frame.extend({ctor:function(){this._super(),this._blendFunc=null},onEnter:function(t,e){this._node&&this._blendFunc&&this._node.setBlendFunc(this._blendFunc)},clone:function(){var t=new ccs.BlendFuncFrame;return t.setBlendFunc(this._blendFunc),t._cloneProperty(this),t},setBlendFunc:function(t){t&&t.src&&t.dst&&(this._blendFunc=t)},getBlendFunc:function(){return this._blendFunc}}),ccs.BlendFuncFrame.create=function(){return new ccs.BlendFuncFrame},ccs.Timeline=ccs.Class.extend({_frames:null,_currentKeyFrame:null,_currentKeyFrameIndex:null,_fromIndex:null,_toIndex:null,_betweenDuration:null,_actionTag:null,_ActionTimeline:null,_node:null,ctor:function(){this._frames=[],this._currentKeyFrame=null,this._currentKeyFrameIndex=0,this._fromIndex=0,this._toIndex=0,this._betweenDuration=0,this._actionTag=0,this._ActionTimeline=null,this._node=null},_gotoFrame:function(t){0!==this._frames.length&&(this._binarySearchKeyFrame(t),this._apply(t))},_stepToFrame:function(t){0!==this._frames.length&&(this._updateCurrentKeyFrame(t),this._apply(t))},getFrames:function(){return this._frames},addFrame:function(t){this._frames.push(t),t.setTimeline(this)},insertFrame:function(t,e){this._frames.splice(e,0,t),t.setTimeline(this)},removeFrame:function(t){cc.arrayRemoveObject(this._frames,t),t.setTimeline(null)},setActionTag:function(t){this._actionTag=t},getActionTag:function(){return this._actionTag},setNode:function(t){for(var e=0;e<this._frames.length;e++){var i=this._frames[e];i.setNode(t)}},getNode:function(){return this._node},setActionTimeline:function(t){this._ActionTimeline=t},getActionTimeline:function(){return this._ActionTimeline},clone:function(){var t=new ccs.Timeline;t._actionTag=this._actionTag;for(var e=0;e<this._frames.length;e++){var i=this._frames[e],n=i.clone();t.addFrame(n)}return t},_apply:function(t){if(this._currentKeyFrame){var e=this._betweenDuration<=0?0:(t-this._currentKeyFrameIndex)/this._betweenDuration;this._currentKeyFrame.apply(e)}},_binarySearchKeyFrame:function(t){var e=null,i=null,n=this._frames.length,r=!1;do{if(t<this._frames[0].getFrameIndex()){this._currentKeyFrameIndex>=this._frames[0].getFrameIndex()&&(r=!0),this._fromIndex=0,this._toIndex=0,e=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(t>=this._frames[n-1].getFrameIndex()){this._fromIndex=n-1,this._toIndex=0,e=i=this._frames[n-1],this._currentKeyFrameIndex=this._frames[n-1].getFrameIndex(),this._betweenDuration=0;break}for(var o=-1,s=0,c=n-1,a=0;s<=c;){if(a=Math.ceil((s+c)/2),t>=this._frames[a].getFrameIndex()&&t<this._frames[a+1].getFrameIndex()){o=a;break}this._frames[a].getFrameIndex()>t?c=a-1:s=a+1}this._fromIndex=o,n>1?this._toIndex=o+1|0:this._toIndex=0|o,e=this._frames[this._fromIndex],i=this._frames[this._toIndex],e=this._frames[o],i=this._frames[o+1],0===o&&this._currentKeyFrameIndex<e.getFrameIndex()&&(r=!0),this._currentKeyFrameIndex=e.getFrameIndex(),this._betweenDuration=i.getFrameIndex()-e.getFrameIndex()}while(0);(r||this._currentKeyFrame!=e)&&(this._currentKeyFrame=e,this._currentKeyFrame.onEnter(i))},_updateCurrentKeyFrame:function(t){if(t>60);if(t<this._currentKeyFrameIndex||t>=this._currentKeyFrameIndex+this._betweenDuration){var e=null,i=null;do{var n=this._frames.length;if(t<this._frames[0].getFrameIndex()){e=i=this._frames[0],this._currentKeyFrameIndex=0,this._betweenDuration=this._frames[0].getFrameIndex();break}if(t>=this._frames[n-1].getFrameIndex()){var r=this._frames[n-1].getFrameIndex();if(this._currentKeyFrameIndex>=r)return;t=r}for(;;){if(this._fromIndex=this._toIndex,e=this._frames[this._fromIndex],this._currentKeyFrameIndex=e.getFrameIndex(),this._toIndex=this._fromIndex+1,this._toIndex>=n&&(this._toIndex=0),i=this._frames[this._toIndex],t===e.getFrameIndex())break;if(t>e.getFrameIndex()&&t<i.getFrameIndex())break;e.isEnterWhenPassed()&&e.onEnter(i)}this._betweenDuration=i.getFrameIndex()-e.getFrameIndex()}while(0);this._currentKeyFrame=e,this._currentKeyFrame.onEnter(i)}}}),ccs.Timeline.create=function(){return new ccs.Timeline},ccs.SkinNode=function(){var t=cc.Node,e={},i=t.extend(e);return i.create=function(){},i}(),ccs.BoneNode=function(){var t=cc.Node,e=ccs.SkinNode,i=cc.BlendFunc,n={p:cc.p,size:cc.size,rect:cc.rect},r={log:cc.log,assert:cc.assert},o=t.extend({_customCommand:null,_blendFunc:null,_rackColor:null,_rackLength:null,_rackWidth:null,_childBones:null,_boneSkins:null,_rootSkeleton:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,ctor:function(e){t.prototype.ctor.call(this),null===this._squareVertices&&(this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]),this._rackColor=cc.color.WHITE,this._blendFunc=i.ALPHA_NON_PREMULTIPLIED,this._childBones=[],this._boneSkins=[],this._rackLength=void 0===e?50:e,this._rackWidth=20,this._updateVertices()},addSkin:function(e,i,n){var o=this._boneSkins;if(r.assert(null!=e,"Argument must be non-nil"),n)for(var s=0;s<o.length;s++)o[s].setVisible(!1);t.prototype.addChild.call(this,e),this._boneSkins.push(e),e.setVisible(i)},getChildBones:function(){return this._childBones},getSkins:function(){return this._boneSkins},displaySkin:function(t,e){var i,n,r=this._boneSkins;if("string"==typeof t)for(n=0;n<r.length;n++)i=r[n],t==i.getName()?i.setVisible(!0):e&&i.setVisible(!1);else for(n=0;n<r.length;n++)i=r[n],i==t?i.setVisible(!0):e&&i.setVisible(!1)},getVisibleSkins:function(){for(var t,e=[],i=this._boneSkins,n=0;n<i.length;n++)t=i[n],t.isVisible()&&e.push(t);return e},getRootSkeletonNode:function(){return this._rootSkeleton},getAllSubBones:function(){for(var t=[],e=[],i=this._childBones,n=0;n<i.length;n++)e.push(i[n]);for(;e.length>0;){var r=e.pop();t.push(r);for(var o=r.getChildBones(),s=0;s<o;s++)e.push(o[s])}return t},getAllSubSkins:function(){for(var t=this.getAllSubBones(),e=[],i=0;i<t.length;i++)for(var n=t[i].getSkins(),r=0;r<n.length;r++)e.push(n[i]);return e},addChild:function(e,i,n){t.prototype.addChild.call(this,e,i,n),this._addToChildrenListHelper(e)},removeChild:function(e,i){this._children.indexOf(e)!==-1&&(t.prototype.removeChild.call(this,e,i),this._removeFromChildrenListHelper(e))},setBlendFunc:function(t){var e=this._blendFunc;if(t&&e.src!==t.src&&e.dst!==t.dst){this._blendFunc=t;for(var i,n=this._boneSkins,r=0;r<n.length;r++)i=n[r],i.setBlendFunc(t)}},getBlendFunc:function(){return this._blendFunc},setDebugDrawLength:function(t){this._rackLength=t,this._updateVertices()},getDebugDrawLength:function(){return this._rackLength},setDebugDrawWidth:function(t){this._rackWidth=t,this._updateVertices()},getDebugDrawWidth:function(){return this._rackWidth},setDebugDrawEnabled:function(t){var e=this._renderCmd;e._debug!==t&&(e._debug=t,cc.renderer.childrenOrderDirty=!0,this._visible&&null!=this._rootSkeleton&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0))},isDebugDrawEnabled:function(){return this._renderCmd._debug},setDebugDrawColor:function(t){this._rackColor=t},getDebugDrawColor:function(){return this._rackColor},getVisibleSkinsRect:function(){var t,e,i,r=0;t=e=i=r;var o=!0,s=n.rect(0,0,0,0);this._renderCmd._debug&&null!=this._rootSkeleton&&this._rootSkeleton._renderCmd._debug&&(i=this._rackWidth,r=this._rackLength,o=!1);for(var c,a=this._boneSkins,l=0;l<a.length;l++){c=a[l];var h=c.getBoundingBox();!c.isVisible()||0===h.x&&0===h.y&&0===h.width&&0===h.height||(o?(t=cc.rectGetMinX(h),e=cc.rectGetMinY(h),i=cc.rectGetMaxX(h),r=cc.rectGetMaxY(h),o=!1):(t=Math.min(cc.rectGetMinX(h),t),e=Math.min(cc.rectGetMinY(h),e),i=Math.max(cc.rectGetMaxX(h),i),r=Math.max(cc.rectGetMaxY(h),r)),s.setRect(t,e,i-t,r-e))}return s},getBoundingBox:function(){var t=this.getVisibleSkinsRect();return cc.rectApplyAffineTransform(t,this.getNodeToParentAffineTransform())},batchBoneDrawToSkeleton:function(t){},setLocalZOrder:function(e){t.prototype.setLocalZOrder.call(this,e),null!=this._rootSkeleton&&(this._rootSkeleton._subBonesOrderDirty=!0)},setName:function(e){var i=this._rootSkeleton,n=this.getName();if(t.prototype.setName.call(this,e),null!=i){var r=i._subBonesMap[n],o=i._subBonesMap[e];r&&!o&&(delete i._subBonesMap[r],i._subBonesMap[e]=r)}},setContentSize:function(e){t.prototype.setContentSize.call(this,e),this._updateVertices()},setAnchorPoint:function(e){t.prototype.setAnchorPoint.call(this,e),this._updateVertices()},setVisible:function(e){this._visible!=e&&(t.prototype.setVisible.call(this,e),null!=this._rootSkeleton&&(this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0))},_addToChildrenListHelper:function(t){t instanceof o?this._addToBoneList(t):this._addToSkinList(t)},_removeFromChildrenListHelper:function(t){t instanceof o?this._removeFromBoneList(t):t instanceof e&&this._removeFromSkinList(skin)},_removeFromBoneList:function(t){if(null!=this._rootSkeleton&&t instanceof ccs.SkeletonNode&&t._rootSkeleton===this._rootSkeleton){t._rootSkeleton=null;var e=t.getAllSubBones();e.push(t);for(var i,n=0;n<e.length;n++)i=e[n],i._rootSkeleton=null,delete this._rootSkeleton._subBonesMap[i.getName()],this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0}else this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0;cc.arrayRemoveObject(this._childBones,t)},_setRootSkeleton:function(t){this._rootSkeleton=t;for(var e=this.getAllSubBones(),i=0;i<e.length;i++)this._addToBoneList(e[i])},_addToBoneList:function(t){if(this._childBones.indexOf(t)===-1&&this._childBones.push(t),null!=this._rootSkeleton){var i=t;if(!(i instanceof e||t._rootSkeleton)){var n=t.getAllSubBones();n.push(t);for(var r,o=0;o<n.length;o++){r=n[o],r._setRootSkeleton(this._rootSkeleton);var s=r.getName();this._rootSkeleton._subBonesMap[s]?(cc.log("already has a bone named %s in skeleton %s",s,this._rootSkeleton.getName()),this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0):(this._rootSkeleton._subBonesMap[r.getName()]=r,this._rootSkeleton._subBonesDirty=!0,this._rootSkeleton._subBonesOrderDirty=!0)}}}},_visitSkins:function(){var t=this._renderCmd;if(this._visible){var e=t.getParentRenderCmd();e&&(t._curLevel=e._curLevel+1);var i,n,r=this._boneSkins;t._syncStatus(e);var o=r.length;if(o>0){for(this.sortAllChildren(),i=0;i<o&&(n=r[i],n._localZOrder<0);i++)n._renderCmd.visit(t);for(;i<o;i++)r[i]._renderCmd.visit(t)}t._dirtyFlag=0}},_addToSkinList:function(t){if(this._boneSkins.push(t),t.getBlendFunc){var e=t.getBlendFunc();this._blendFunc.src!==e.src&&this._blendFunc.dst!==e.dst&&t.setBlendFunc(this._blendFunc)}},_removeFromSkinList:function(t){cc.arrayRemoveObject(this._boneSkins,t)},sortAllChildren:function(){this._sortArray(this._childBones),this._sortArray(this._boneSkins),t.prototype.sortAllChildren.call(this)},_sortArray:function(t){if(t){var e,i,n,r=t.length;for(e=1;e<r;e++){for(n=t[e],i=e-1;i>=0;){if(n._localZOrder<t[i]._localZOrder)t[i+1]=t[i];else{if(!(n._localZOrder===t[i]._localZOrder&&n.arrivalOrder<t[i].arrivalOrder))break;t[i+1]=t[i]}i--}t[i+1]=n}}},_updateVertices:function(){var t=this._squareVertices,e=this._renderCmd._anchorPointInPoints;if(this._rackLength!=t[2].x-e.x||t[3].y!=this._rackWidth/2-e.y){t[1].x=t[1].y=t[3].y=0,t[0].x=t[2].x=.1*this._rackLength,t[2].y=.5*this._rackWidth,t[0].y=-t[2].y,t[3].x=this._rackLength;for(var i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y;this._renderCmd.updateDebugPoint(t)}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new s(this):new c(this)}});o.create=function(t,e){return new ccui.BoneNode(t,e)};var s=function(){var e=function(e){t.CanvasRenderCmd.call(this,e),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode},i=e.prototype=Object.create(t.CanvasRenderCmd.prototype);return i.constructor=e,i.visit=function(t){var e=this._node;e._visit&&e._visit(t)},i.updateDebugPoint=function(t){this._drawNode.clear(),this._drawNode.drawPoly(t,this._color,0,this._color)},i.transform=function(e,i){var n=this._node._rootSkeleton;t.CanvasRenderCmd.prototype.transform.call(this,e,i),n&&n._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},e}(),c=function(){var e=function(e){t.WebGLRenderCmd.call(this,e),this._debug=!1,this._color=cc.color.WHITE,this._drawNode=new cc.DrawNode},i=e.prototype=Object.create(t.WebGLRenderCmd.prototype);return i.constructor=e,i.visit=function(t){var e=this._node;e._visit&&e._visit(t)},i.updateDebugPoint=function(t){this._drawNode.clear(),this._drawNode.drawPoly(t,this._color,0,this._color)},i.transform=function(e,i){var n=this._node._rootSkeleton;t.WebGLRenderCmd.prototype.transform.call(this,e,i),n&&n._renderCmd._debug&&this._drawNode._renderCmd.transform(this)},e}();return o}(),ccs.SkeletonNode=function(){var t=ccs.BoneNode,e=({p:cc.p,size:cc.size,rect:cc.rect},t.extend({_subBonesMap:null,_squareVertices:null,_squareColors:null,_noMVPVertices:null,_skinGroupMap:null,_sortedAllBonesDirty:!1,_sortedAllBones:null,_batchedBoneVetices:null,_batchedBoneColors:null,_batchedVeticesCount:null,_batchBoneCommand:null,_subOrderedAllBones:null,ctor:function(){this._squareVertices=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._rootSkeleton=this,t.prototype.ctor.call(this),this._subBonesMap={},this._subOrderedAllBones=[],this._skinGroupMap={},this._rackLength=this._rackWidth=20,this._updateVertices()},getBoneNode:function(t){var e=this._subBonesMap[t];return e?e:null},getAllSubBonesMap:function(){return this._subBonesMap},changeSkins:function(t){if("object"==typeof t){var e;for(var i in t){e=t[i];var n=this.getBoneNode(i);null!==n&&n.displaySkin(e,!0)}}else{var r=this._suitMap[t];r&&this.changeSkins(r,!0)}},addSkinGroup:function(t,e){this._skinGroupMap[t]=e},getBoundingBox:function(){var t,e,i,n=0;t=e=i=n;var r=this.getVisibleSkinsRect(),o=!0;0===r.x&&0===r.y&&0===r.width&&0===r.height||(t=cc.rectGetMinX(r),e=cc.rectGetMinY(r),i=cc.rectGetMaxX(r),n=cc.rectGetMaxY(r),o=!1);for(var s,c=this.getAllSubBones(),a=0;a<c.length;a++){s=c[a];var l=cc.rectApplyAffineTransform(s.getVisibleSkinsRect(),s.getNodeToParentTransform(s.getRootSkeletonNode()));0===l.x&&0===l.y&&0===l.width&&0===l.height||(o?(t=cc.rectGetMinX(l),e=cc.rectGetMinY(l),i=cc.rectGetMaxX(l),n=cc.rectGetMaxY(l),o=!1):(t=Math.min(cc.rectGetMinX(l),t),e=Math.min(cc.rectGetMinY(l),e),i=Math.max(cc.rectGetMaxX(l),i),n=Math.max(cc.rectGetMaxY(l),n)))}return r.x=t,r.y=e,r.width=i-t,r.height=n-e,cc.rectApplyAffineTransform(r,this.getNodeToParentTransform())},_visit:function(t){if(this._visible){var e=this._renderCmd;t=t||e.getParentRenderCmd(),e._syncStatus(t);var i,n;if(0!==this._children.length)for(i=0;i<this._children.length;i++)n=this._children[i],n._renderCmd.visit(e);this._checkSubBonesDirty();var r,o,s=this._subOrderedAllBones;for(i=0;i<s.length;i++)r=s[i],r._visitSkins();if(e._debug)for(i=0;i<s.length;i++)o=s[i]._renderCmd,cc.renderer.pushRenderCommand(o._drawNode._renderCmd);this._dirtyFlag=0}},_checkSubBonesDirty:function(){this._subBonesDirty&&(this._updateOrderedAllbones(),this._subBonesDirty=!1),this._subBonesOrderDirty&&(this._sortOrderedAllBones(),this._subBonesOrderDirty=!1)},_updateOrderedAllbones:function(){this._subOrderedAllBones.length=0;for(var t,e=[],i=this._childBones,n=0;n<i.length;n++)t=i[n],t.isVisible()&&e.push(t);for(;e.length>0;){var r=e.pop(),o=r._renderCmd;o._syncStatus(o.getParentRenderCmd()),this._subOrderedAllBones.push(r);for(var s,c=r.getChildBones(),n=0;n<c.length;n++)s=c[n],s.isVisible()&&e.push(s)}},_sortOrderedAllBones:function(){this._sortArray(this._subOrderedAllBones)},_updateVertices:function(){var t=this._squareVertices,e=this._renderCmd._anchorPointInPoints;if(this._rackLength!=t[6].x-e.x||this._rackWidth!=t[3].y-e.y){var i=.5*this._rackLength,n=.5*this._rackWidth,r=.25*i,o=.25*n;t[5].y=t[2].y=t[1].y=t[6].y=t[0].x=t[4].x=t[7].x=t[3].x=0,t[5].x=-i,t[0].y=-n,t[6].x=i,t[3].y=n,t[1].x=r,t[7].y=o,t[2].x=-r,t[4].y=-o;for(var s=0;s<t.length;s++)t[s].x+=e.x,t[s].y+=e.y}},_updateAllDrawBones:function(){this._subDrawBones={};for(var t in this._subBonesMap){var e=this._subBonesMap[t];e.isVisible()&&e.isDebugDrawEnabled()&&this._subDrawBones.push(e)}this._sortArray(this._sortedAllBones),this._subDrawBones=!1}}));return e.create=function(){return new e},e}(),ccs._load=function(){var t=function(t,n,r){var s=cc.loader.getRes(t);if(!s)return cc.log("%s does not exist",t);var c=i(t).toLocaleLowerCase();if("json"!==c&&"exportjson"!==c)return cc.log("%s load error, must be json file",t);var a;if(n?a=e[n]:s.widgetTree?a=e.ccui:s.nodeTree?a=e.timeline:s.Content&&s.Content.Content?a=e.timeline:s.gameobjects&&(a=e.scene),!a)return cc.log("Can't find the parser : %s",t),new cc.Node;var l=s.version||s.Version;if(!l&&s.armature_data)return cc.warn("%s is armature. please use:",t),cc.warn("    ccs.armatureDataManager.addArmatureFileInfoAsync(%s);",t),cc.warn("    var armature = new ccs.Armature('name');"),new cc.Node;var h=o(a,l);return h?h.parse(t,s,r)||null:(cc.log("Can't find the parser : %s",t),new cc.Node)},e={ccui:{},timeline:{},action:{},scene:{}};t.registerParser=function(t,i,n){return t&&i&&n?(e[t]||(e[t]={}),void(e[t][i]=n)):cc.log("register parser error")},t.getParser=function(t,i){return t&&i?e[t]?e[t][i]:void 0:t?e[t]:e};var i=function(t){var e=t.match(n);return e&&e[1]?e[1]:null},n=/\.([^\.]+)$/,r=/([^\.](\.\*)?)*$/,o=function(t,e){return t[e]?t[e]:"*"===e?null:o(t,e.replace(r,"*"))};return t}(),ccs._parser=cc.Class.extend({ctor:function(){this.parsers={}},_dirnameReg:/\S*\//,_dirname:function(t){var e=t.match(this._dirnameReg);return e&&e[0]?e[0]:""},getClass:function(t){return t.classname},getNodeJson:function(t){return t.widgetTree},parse:function(t,e,i){i=i||this._dirname(t),this.pretreatment(e,i);var n=this.parseNode(this.getNodeJson(e),i,t);return n&&this.deferred(e,i,n,t),n},pretreatment:function(t,e,i){},deferred:function(t,e,i,n){},parseNode:function(t,e){var i=this.parsers[this.getClass(t)],n=null;return i?n=i.call(this,t,e):cc.log("Can't find the parser : %s",this.getClass(t)),n},registerParser:function(t,e){this.parsers[t]=e}}),ccs.load=function(t,e){var i={node:null,action:null};return i.node=ccs._load(t,null,e),i.action=ccs._load(t,"action",e),i.action&&i.action.tag===-1&&i.node&&(i.action.tag=i.node.tag),i},ccs.load.validate={},ccs.load.preload=!0,ccs.loadWithVisibleSize=function(t,e){var i=ccs.load(t,e),n=cc.director.getVisibleSize();return i.node&&n&&(i.node.setContentSize(n.width,n.height),ccui.helper.doLayout(i.node)),i},ccs.actionTimelineCache={createAction:function(t){return ccs._load(t,"action")}},ccs.csLoader={createNode:function(t){return ccs._load(t)}},cc.loader.register(["json"],{load:function(t,e,i,n){cc.loader.loadJson(t,function(t,i){var r=cc.path;if(i&&i.Content&&i.Content.Content.UsedResources){for(var o,s,c=i.Content.Content.UsedResources,a=r.dirname(e),l=[],h=0;h<c.length;h++)!ccs.load.preload&&/\.(png|jpg$)/.test(c[h])||(o=r.join(a,c[h]),s=r._normalize(o),ccs.load.validate[s]||(ccs.load.validate[s]=!0,l.push(s)));cc.loader.load(l,function(){n(t,i)})}else n(t,i)})}}),function(t,e){var i=e.extend({getNodeJson:function(t){return t.action},parseNode:function(t,e,i){if(!t)return null;var n=this,r=new ccs.ActionTimeline;r.setDuration(t.duration),r.setTimeSpeed(t.speed||1);var o=t.timelines;return o.forEach(function(t){var i,o=n.parsers[t.frameType];o?i=o.call(n,t,e):cc.log("parser does not exist : %s",t.frameType),i&&r.addTimeline(i),"ColorFrame"===t.frameType&&r.addTimeline(n.parsers.AlphaFrame.call(n,t,e))}),r}}),n=new i,r=[{name:"PositionFrame",handle:function(t){var e=new ccs.PositionFrame,i=t.x,n=t.y;return e.setPosition(cc.p(i,n)),e}},{name:"VisibleFrame",handle:function(t){var e=new ccs.VisibleFrame,i=t.value;return e.setVisible(i),e}},{name:"ScaleFrame",handle:function(t){var e=new ccs.ScaleFrame,i=t.x,n=t.y;return e.setScaleX(i),e.setScaleY(n),e}},{name:"RotationFrame",handle:function(t){var e=new ccs.RotationFrame,i=t.rotation;return e.setRotation(i),e}},{name:"SkewFrame",handle:function(t){var e=new ccs.SkewFrame,i=t.x,n=t.y;return e.setSkewX(i),e.setSkewY(n),e}},{name:"RotationSkewFrame",handle:function(t){var e=new ccs.RotationSkewFrame,i=t.x,n=t.y;return e.setSkewX(i),e.setSkewY(n),e}},{name:"AnchorFrame",handle:function(t){var e=new ccs.AnchorPointFrame,i=t.x,n=t.y;return e.setAnchorPoint(cc.p(i,n)),e}},{name:"InnerActionFrame",handle:function(t){var e=new ccs.InnerActionFrame,i=t.innerActionType,n=t.startFrame;return e.setInnerActionType(i),e.setStartFrameIndex(n),e}},{name:"ColorFrame",handle:function(t){var e=new ccs.ColorFrame,i=t.red,n=t.green,r=t.blue;e.setColor(cc.color(i,n,r));var o=new ccs.AlphaFrame,s=t.alpha;return o.setAlpha(s),e}},{name:"AlphaFrame",handle:function(t){var e=new ccs.AlphaFrame,i=t.alpha;return e.setAlpha(i),e}},{name:"TextureFrame",handle:function(t){var e=new ccs.TextureFrame,i=t.value;if(null!=i){var n=i,r=cc.spriteFrameCache.getSpriteFrame(n);if(null==r){var o=ccs.csLoader.getJsonPath();n=o+i}e.setTextureName(n)}return e}},{name:"EventFrame",handle:function(t){var e=new ccs.EventFrame,i=t.value;return null!=i&&e.setEvent(i),e}},{name:"ZOrderFrame",handle:function(t){var e=new ccs.ZOrderFrame,i=t.value;return e.setZOrder(i),e}}];r.forEach(function(t){n.registerParser(t.name,function(e,i){var n=new ccs.Timeline;n.setActionTag(e.actionTag);var r=e.frames;return r&&r.length&&r.forEach(function(e){var i=t.handle(e);i.setFrameIndex(e.frameIndex),i.setTween(e.tween),n.addFrame(i)}),n})}),t.registerParser("action","0.*",n),t.registerParser("action","1.*",n)}(ccs._load,ccs._parser),function(t,e){var i=e.extend({getNodeJson:function(t){return t.Content.Content.Animation},parseNode:function(t,e,i){if(!t)return null;var n=this,r=new ccs.ActionTimeline;r.setDuration(t.Duration),r.setTimeSpeed(t.Speed||1);var o=t.Timelines;return o.forEach(function(t){var i,o=n.parsers[t.Property];o?i=o.call(n,t,e):cc.log("parser does not exist : %s",t.Property),i&&r.addTimeline(i)}),r},deferred:function(t,e,i,n){for(var r=t.Content.Content.AnimationList,o=r?r.length:0,s=0;s<o;s++){var c=r[s],a={name:null,startIndex:null,endIndex:null};a.name=c.Name,a.startIndex=c.StartIndex,a.endIndex=c.EndIndex,i.addAnimationInfo(a)}}}),n=new i,r=[{name:"Position",handle:function(t){var e=new ccs.PositionFrame,i=t.X,n=t.Y;return e.setPosition(cc.p(i,n)),e}},{name:"VisibleForFrame",handle:function(t){var e=new ccs.VisibleFrame,i=t.Value;return e.setVisible(i),e}},{name:"Scale",handle:function(t){var e=new ccs.ScaleFrame,i=t.X,n=t.Y;return e.setScaleX(i),e.setScaleY(n),e}},{name:"Rotation",handle:function(t){var e=new ccs.RotationFrame,i=t.Rotation||t.Value||0;return e.setRotation(i),e}},{name:"Skew",handle:function(t){var e=new ccs.SkewFrame,i=t.X,n=t.Y;return e.setSkewX(i),e.setSkewY(n),e}},{name:"RotationSkew",handle:function(t){var e=new ccs.RotationSkewFrame,i=t.X,n=t.Y;return e.setSkewX(i),e.setSkewY(n),e}},{name:"Anchor",handle:function(t){var e=new ccs.AnchorPointFrame,i=t.X,n=t.Y;return e.setAnchorPoint(cc.p(i,n)),e}},{name:"AnchorPoint",handle:function(t){var e=new ccs.AnchorPointFrame,i=t.X,n=t.Y;return e.setAnchorPoint(cc.p(i,n)),e}},{name:"InnerAction",handle:function(t){var e=new ccs.InnerActionFrame,i=t.InnerActionType,n=t.StartFrame;return e.setInnerActionType(i),e.setStartFrameIndex(n),e}},{name:"CColor",handle:function(t){var e=new ccs.ColorFrame,i=t.Color;return i||(i={}),i.R=void 0===i.R?255:i.R,i.G=void 0===i.G?255:i.G,i.B=void 0===i.B?255:i.B,e.setColor(cc.color(i.R,i.G,i.B)),e}},{name:"Alpha",handle:function(t){var e=new ccs.AlphaFrame,i=t.Value;return e.setAlpha(i),e}},{name:"FileData",handle:function(t,e){var i,n,r,o,s;return i=new ccs.TextureFrame,n=t.TextureFile,null!=n&&(r=n.Plist,o=n.Path,s=cc.spriteFrameCache.getSpriteFrame(o),!s&&r&&(cc.loader.getRes(e+r)?(cc.spriteFrameCache.addSpriteFrames(e+r),s=cc.spriteFrameCache.getSpriteFrame(o)):cc.log("%s need to be preloaded",e+r)),null==s&&(o=e+o),i.setTextureName(o)),i}},{name:"FrameEvent",handle:function(t){var e=new ccs.EventFrame,i=t.Value;return null!=i&&e.setEvent(i),e}},{name:"ZOrder",handle:function(t){var e=new ccs.ZOrderFrame,i=t.Value;return e.setZOrder(i),e}},{name:"ActionValue",handle:function(t){var e=new ccs.InnerActionFrame,i=t.InnerActionType,n=t.CurrentAniamtionName,r=t.SingleFrameIndex,o=t.FrameIndex;return void 0!==o&&e.setFrameIndex(o),e.setInnerActionType(ccs.InnerActionType[i]),e.setSingleFrameIndex(r),e.setEnterWithName(!0),n&&e.setAnimationName(n),e}},{name:"BlendFunc",handle:function(t){var e=new ccs.BlendFuncFrame,i=t.BlendFunc;return i&&void 0!==i.Src&&void 0!==i.Dst&&e.setBlendFunc(new cc.BlendFunc(i.Src,i.Dst)),e}}],o=function(t,e){var i=e.Type;t.setTweenType(i);var n=e.Points,r=[];n&&(n.forEach(function(t){r.push(t.X),r.push(t.Y)}),t.setEasingParams(r))};r.forEach(function(t){n.registerParser(t.name,function(e,i){var n=new ccs.Timeline;n.setActionTag(e.ActionTag);var r=e.Frames;return r&&r.length&&r.forEach(function(e){var r=t.handle(e,i);r.setFrameIndex(e.FrameIndex);var s=null==e.Tween||e.Tween;r.setTween(s);var c=e.EasingData;c&&o(r,c),n.addFrame(r)}),n})}),t.registerParser("action","2.*",n),t.registerParser("action","*",n)}(ccs._load,ccs._parser),function(t,e){var i=e.extend({getNodeJson:function(t){return t},parseNode:function(t,e){var i=this.parsers[this.getClass(t)],n=null;return i?n=i.call(this,t,e):cc.log("Can't find the parser : %s",this.getClass(t)),n},deferred:function(t,e,i,n){ccs.triggerManager.parse(t.Triggers||[]),ccs.sceneReader&&(ccs.sceneReader._node=i)},setPropertyFromJsonDict:function(t,e){var i=cc.isUndefined(e.x)?0:e.x,n=cc.isUndefined(e.y)?0:e.y;t.setPosition(i,n);var r=Boolean(cc.isUndefined(e.visible)?1:e.visible);t.setVisible(r);var o=cc.isUndefined(e.objecttag)?-1:e.objecttag;t.setTag(o);var s=cc.isUndefined(e.zorder)?0:e.zorder;t.setLocalZOrder(s);var c=cc.isUndefined(e.scalex)?1:e.scalex,a=cc.isUndefined(e.scaley)?1:e.scaley;t.setScaleX(c),t.setScaleY(a);var l=cc.isUndefined(e.rotation)?0:e.rotation;t.setRotation(l);var h=e.name||"";t.setName(h)}}),n=new i;n.parseChild=function(t,e,i){for(var n=0;n<e.length;n++){var r,o=e[n];o&&(r=this.parseNode(o,i)),r&&t.addChild(r)}};var r={CCSprite:function(t,e,i){var n=new cc.Sprite;s(e.fileData,i,function(t,e){if(0===e)n.setTexture(t);else if(1===e){var i=cc.spriteFrameCache.getSpriteFrame(t);n.setSpriteFrame(i)}});var r=new ccs.ComRender(n,"CCSprite");return t.addComponent(r),r},CCTMXTiledMap:function(t,e,i){var n=null;s(e.fileData,i,function(t,e){0===e&&(n=new cc.TMXTiledMap(t))});var r=new ccs.ComRender(n,"CCTMXTiledMap");return t.addComponent(r),r},CCParticleSystemQuad:function(t,e,i){var n=null;s(e.fileData,i,function(t,e){0===e?n=new cc.ParticleSystem(t):cc.log("unknown resourcetype on CCParticleSystemQuad!"),n.setPosition(0,0)});var r=new ccs.ComRender(n,"CCParticleSystemQuad");return t.addComponent(r),r},CCArmature:function(t,e,i){var n=null;if(s(e.fileData,i,function(t,e){if(0===e){var i=cc.loader.getRes(t);i||cc.log("Please load the resource [%s] first!",t);var r=i.armature_data,o=r[0],s=o.name;ccs.armatureDataManager.addArmatureFileInfo(t),n=new ccs.Armature(s)}}),n){var r=new ccs.ComRender(n,"CCArmature");t.addComponent(r);var o=e.selectedactionname;return o&&n.getAnimation()&&n.getAnimation().play(o),r}},CCComAudio:function(t,e,i){var n=null;s(e.fileData,i,function(i,r){if(0===r){n=new ccs.ComAudio,n.preloadEffect(i);var o=e.name;o&&n.setName(o),t.addComponent(n)}})},CCComAttribute:function(t,e,i){var n=null;return s(e.fileData,i,function(e,i){0===i?(n=new ccs.ComAttribute,""!==e&&n.parse(e),t.addComponent(n)):cc.log("unknown resourcetype on CCComAttribute!")}),n},CCBackgroundAudio:function(t,e,i){var n=null;s(e.fileData,i,function(i,r){if(0===r){n=new ccs.ComAudio,n.preloadBackgroundMusic(i),n.setFile(i);var o=Boolean(e.loop||0);n.setLoop(o);var s=e.name;s&&n.setName(s),t.addComponent(n),n.playBackgroundMusic(i,o)}})},GUIComponent:function(t,e,i){var n=null;s(e.fileData,i,function(t,e){n=ccs._load(t,"ccui")});var r=new ccs.ComRender(n,"GUIComponent");return t.addComponent(r),r},CCScene:function(){}},o={},s=function(t,e,i){if(null!=t){var n=t.path,r=t.resourceType,s=t.plist;if(!n)return;s&&(cc.loader.getRes(e+s)?(o[e+s]=!0,cc.spriteFrameCache.addSpriteFrames(e+s)):o[e+s]||cc.log("%s need to be preloaded",e+s)),0!==r?i(n,r):i(e+n,r)}};n.parseComponents=function(t,e,i){t&&e&&e.forEach(function(e){var n=r[e.classname],o=null;n?o=n(t,e,i):cc.log("Can't find the component parser : %s",e.classname);var s=e.name;o&&s&&o.setName(s)})},n.registerParser("CCNode",function(t,e){var i=new cc.Node;this.setPropertyFromJsonDict(i,t),this.parseChild.call(this,i,t.gameobjects,e),this.parseComponents(i,t.components,e);var n=t.CanvasSize;return n&&i.setContentSize(cc.size(n._width,n._height)),i}),t.registerParser("scene","*",n)}(ccs._load,ccs._parser),function(t,e){var i={},n=e.extend({getNodeJson:function(t){return t.nodeTree},addSpriteFrame:function(t,e,n){if(t&&e&&t.length===e.length)for(var r=0;r<t.length;r++){var o=n+t[r];cc.loader.getRes(o)||i[o]?i[o]=!0:cc.log("%s need to be preloaded",o),cc.spriteFrameCache.addSpriteFrames(o,n+e[r])}},pretreatment:function(t,e,i){this.addSpriteFrame(t.textures,t.texturesPng,e)}}),r=new n;r.generalAttributes=function(t,e){var i=null!=e.width?e.width:0,n=null!=e.height?e.height:0,r=null!=e.x?e.x:0,o=null!=e.y?e.y:0,s=null!=e.scaleX?e.scaleX:1,c=null!=e.scaleY?e.scaleY:1,a=null!=e.rotation?e.rotation:0,l=null!=e.rotationSkewX?e.rotationSkewX:0,h=null!=e.rotationSkewY?e.rotationSkewY:0,u=null!=e.skewX?e.skewX:0,d=null!=e.skewY?e.skewY:0,_=null!=e.anchorPointX?e.anchorPointX:.5,p=null!=e.anchorPointY?e.anchorPointY:.5,f=null!=e.opacity?e.opacity:255,m=null!=e.colorR?e.colorR:255,g=null!=e.colorG?e.colorG:255,y=null!=e.colorB?e.colorB:255,v=null!=e.colorR?e.colorR:0,T=null!=e.tag?e.tag:0,C=null!=e.actionTag?e.actionTag:0,S=null==e.visible||e.visible;0==r&&0==o||t.setPosition(cc.p(r,o)),1!=s&&t.setScaleX(s),1!=c&&t.setScaleY(c),0!=a&&t.setRotation(a),0!=l&&t.setRotationX(l),0!=h&&t.setRotationY(h),0!=u&&t.setSkewX(u),0!=d&&t.setSkewY(d),.5==_&&.5==p||t.setAnchorPoint(cc.p(_,p)),0==i&&0==n||t.setContentSize(cc.size(i,n)),0!=v&&t.setLocalZOrder(v),1!=S&&t.setVisible(S),255!=f&&t.setOpacity(f),255==m&&255==g&&255==y||t.setColor(cc.color(m,g,y)),t.setTag(T),t.setUserObject(new ccs.ActionTimelineData(C))},r.parseComponent=function(t,e){if(e)for(var i=0;i<e.length;++i){var n=e[i],r=this.loadComponent(n);r&&t.addComponent(r)}},r.parseChild=function(t,e,i,n){for(var r=i.children,o=0;o<r.length;o++){var s=this.parseNode(r[o],n);if(s)if(e instanceof ccui.PageView)s instanceof ccui.Layout&&e.addPage(s);else if(e instanceof ccui.ListView)s instanceof ccui.Widget&&e.pushBackCustomItem(s);else{if(!(e instanceof ccui.Layout)&&s instanceof ccui.Widget){if(s.getPositionType()===ccui.Widget.POSITION_PERCENT){var c=s.getPositionPercent(),a=e.getAnchorPoint();s.setPositionPercent(cc.p(c.x+a.x,c.y+a.y))}var l=e.getAnchorPointInPoints();s.setPosition(cc.p(s.getPositionX()+l.x,s.getPositionY()+l.y))}e.addChild(s)}}},r.initNode=function(t){var e=new cc.Node;return this.generalAttributes(e,t),e},r.initSubGraph=function(t){var e,i=t.fileName;return e=i&&""!==i?this.createNode(i):new ccs.Node,this.generalAttributes(e,t),e},r.initSprite=function(t,e){var i,n=t.fileName;if(null!=n){var r=cc.spriteFrameCache.getSpriteFrame(n);r?i=ccs.Sprite.createWithSpriteFrame(r):(n=e+n,i=new ccs.Sprite(n)),i||(i=new cc.Sprite,cc.log("filePath is empty. Create a sprite with no texture"))}else i=new ccs.Sprite;this.generalAttributes(i,t);var o=t.flipX,s=t.flipY;return 0!=o&&i.setFlippedX(o),0!=s&&i.setFlippedY(s),i},r.initParticle=function(t,e){var i=t.plistFile,n=t.tmxFile,r=new cc.ParticleSystemQuad(i);return r.setTotalParticles(n),this.generalAttributes(r,t),r},r.initTMXTiledMap=function(t,e){var i=t.tmxFile,n=t.tmxString,r=t.resourcePath,o=null;return i&&""!==i?o=new cc.TMXTiledMap(i):n&&""!==n&&r&&""!==r&&(o=new cc.TMXTiledMap(n,r)),o};var o=t.getParser("ccui")["*"];r.initWidget=function(t,e){var i=t.classname,n=o.parsers[i];if(!n)return cc.log("%s parser is not found",i);var r=n.call(o,t,e);if(r){var s=t.rotationSkewX,c=t.rotationSkewY,a=t.skewX,l=t.skewY;0!=s&&r.setRotationX(s),0!=c&&r.setRotationY(c),0!=a&&r.setSkewX(a),0!=l&&r.setSkewY(l);var h=t.actionTag;r.setUserObject(new ccs.ActionTimelineData(h))}return r};var s=[{name:"Node",handle:r.initNode},{name:"SubGraph",handle:r.initSubGraph},{name:"Sprite",handle:r.initSprite},{name:"Particle",handle:r.initParticle},{name:"TMXTiledMap",handle:r.initTMXTiledMap},{name:"Widget",handle:r.initWidget},{name:"Panel",handle:r.initWidget},{name:"Button",handle:r.initWidget},{name:"CheckBox",handle:r.initWidget},{name:"ImageView",handle:r.initWidget},{name:"LabelAtlas",handle:r.initWidget},{name:"LabelBMFont",handle:r.initWidget},{name:"Label",handle:r.initWidget},{name:"ListView",handle:r.initWidget},{name:"LoadingBar",handle:r.initWidget},{name:"PageView",handle:r.initWidget},{name:"ScrollView",handle:r.initWidget},{name:"Slider",handle:r.initWidget},{name:"TextField",handle:r.initWidget}];s.forEach(function(t){r.registerParser(t.name,function(e,i,n){var r=t.handle.call(this,e.options);return this.parseComponent(r,e.components),this.parseChild(i,r,e,n),r})}),t.registerParser("timeline","0.*",r),t.registerParser("timeline","1.*",r)}(ccs._load,ccs._parser),function(t,e){var i=!1,n=e.extend({parse:function(t,e,i){var n;n=void 0!==i?i:this._dirname(t),this.pretreatment(e,n,t);var r=this.parseNode(this.getNodeJson(e),n);return this.deferred(e,n,r,t),r},getNodeJson:function(t){var e=t.Content;return e.ObjectData?e.ObjectData:e.Content.ObjectData},getClass:function(t){return t.ctype}}),r=new n,o=function(t,e){return void 0===t?e:t};r.generalAttributes=function(t,e){null!=e.Name&&t.setName(e.Name);var i=e.Position;null==i||null==i.X&&null==i.Y||t.setPosition(cc.p(i.X||0,i.Y||0));var n=e.Scale;null!=n&&(null!=n.ScaleX&&t.setScaleX(n.ScaleX),null!=n.ScaleY&&t.setScaleY(n.ScaleY));var r=e.RotationSkewX;null!=r&&t.setRotationX(r);var s=e.RotationSkewY;null!=e.RotationSkewY&&t.setRotationY(s);var a=e.AnchorPoint;null!=a&&(null==a.ScaleX&&(a.ScaleX=0),null==a.ScaleY&&(a.ScaleY=0),.5==a.ScaleX&&.5==a.ScaleY||t.setAnchorPoint(cc.p(a.ScaleX,a.ScaleY))),null!=e.ZOrder&&t.setLocalZOrder(e.ZOrder);var l=o(e.VisibleForFrame,!0);t.setVisible(l);var h=e.Size;h&&p(t,h),null!=e.Alpha&&t.setOpacity(e.Alpha),t.setTag(e.Tag||0);var u=e.ActionTag||0,d=new ccs.ComExtensionData,_=e.UserData;void 0!==_&&d.setCustomProperty(_),d.setActionTag(u),t.getComponent("ComExtensionData")&&t.removeComponent("ComExtensionData"),t.addComponent(d),t.setCascadeColorEnabled(!0),t.setCascadeOpacityEnabled(!0),c(t,e)},r.parseChild=function(t,e,i){if(t&&e)for(var n=0;n<e.length;n++){var r=this.parseNode(e[n],i);if(r)if(t instanceof ccui.PageView)r instanceof ccui.Layout&&t.addPage(r);else if(t instanceof ccui.ListView)r instanceof ccui.Widget&&t.pushBackCustomItem(r);else{if(!(t instanceof ccui.Layout)&&r instanceof ccui.Widget&&r.getPositionType()===ccui.Widget.POSITION_PERCENT){var o=r.getPositionPercent(),s=t.getAnchorPoint();r.setPositionPercent(cc.p(o.x+s.x,o.y+s.y))}t.addChild(r)}}},r.initSingleNode=function(t){var e=new cc.Node;this.generalAttributes(e,t);var i=t.CColor;return null!=i&&e.setColor(_(i)),e},r.initSprite=function(t,e){var i=new cc.Sprite;d(t.FileData,e,function(t,e){if(0===e)i.setTexture(t);else if(1===e){var n=cc.spriteFrameCache.getSpriteFrame(t);n&&i.setSpriteFrame(n)}});var n=t.BlendFunc;if(t.BlendFunc){var r=cc.BlendFunc.ALPHA_PREMULTIPLIED;void 0!==n.Src&&(r.src=n.Src),void 0!==n.Dst&&(r.dst=n.Dst),i.setBlendFunc(r)}t.FlipX&&i.setFlippedX(!0),t.FlipY&&i.setFlippedY(!0),this.generalAttributes(i,t);var o=t.CColor;return null!=o&&i.setColor(_(o)),i},r.initParticle=function(t,e){var i,n=this;return d(t.FileData,e,function(e,r){cc.loader.getRes(e)||cc.log("%s need to be preloaded",e),i=new cc.ParticleSystem(e),n.generalAttributes(i,t),i.setPositionType(cc.ParticleSystem.TYPE_GROUPED),!cc.sys.isNative&&i.setDrawMode(cc.ParticleSystem.TEXTURE_MODE);var o=t.BlendFunc;if(t.BlendFunc){var s=cc.BlendFunc.ALPHA_PREMULTIPLIED;void 0!==o.Src&&(s.src=o.Src),void 0!==o.Dst&&(s.dst=o.Dst),i.setBlendFunc(s)}}),i},r.widgetAttributes=function(t,e,i){t.setCascadeColorEnabled(!0),t.setCascadeOpacityEnabled(!0),t.setUnifySizeEnabled(!1),t.ignoreContentAdaptWithSize(!1),!i&&p(t,e.Size);var n=e.Name;n&&t.setName(n);var r=e.ActionTag||0;t.setActionTag(r);var a=new ccs.ComExtensionData,l=e.UserData;void 0!==l&&a.setCustomProperty(l),a.setActionTag(r),t.getComponent("ComExtensionData")&&t.removeComponent("ComExtensionData"),t.addComponent(a);var h=e.RotationSkewX;h&&t.setRotationX(h);var u=e.RotationSkewY;u&&t.setRotationY(u);var d=e.FlipX;d&&t.setFlippedX(!0);var f=e.FlipY;f&&t.setFlippedY(!0);var m=e.zOrder;null!=m&&t.setLocalZOrder(m);var g=o(e.VisibleForFrame,!0);t.setVisible(g);var y=e.Alpha;null!=y&&t.setOpacity(y),t.setTag(e.Tag||0);var v=e.TouchEnable||!1;t.setTouchEnabled(v);var T=e.CallBackType;null!=T&&t.setCallbackType(T);var C=e.CallBackName;C&&t.setCallbackName(C);var S=e.Position;null!=S&&t.setPosition(S.X||0,S.Y||0);var x=e.Scale;if(null!=x){var A=o(x.ScaleX,1),E=o(x.ScaleY,1);t.setScaleX(A),t.setScaleY(E)}var b=e.AnchorPoint;null!=b&&t.setAnchorPoint(b.ScaleX||0,b.ScaleY||0);var R=e.CColor;null!=R&&t.setColor(_(R)),c(t,e),s(t,e)};var s=function(t,e){var i=e.CallBackType,n=e.CallBackName,r=function(e){"function"==typeof t[n]&&t[n](e)};"Click"===i?t.addClickEventListener(r):"Touch"===i?t.addTouchEventListener(r):"Event"===i&&t.addCCSEventListener(r)},c=function(t,e){var i=ccui.LayoutComponent.bindLayoutComponent(t);if(i){var n=e.PositionPercentXEnable||e.PositionPercentXEnabled||!1,r=e.PositionPercentYEnable||e.PositionPercentYEnabled||!1,o=0,s=0,c=e.PrePosition;null!=c&&(o=c.X||0,s=c.Y||0);var a=e.PercentWidthEnable||e.PercentWidthEnabled||!1,l=e.PercentHeightEnable||e.PercentHeightEnabled||!1,h=0,u=0,d=e.PreSize;null!=c&&(h=d.X||0,u=d.Y||0);var _=e.StretchWidthEnable||!1,p=e.StretchHeightEnable||!1,f=e.HorizontalEdge,m=e.VerticalEdge,g=e.LeftMargin||0,y=e.RightMargin||0,v=e.TopMargin||0,T=e.BottomMargin||0;i.setPositionPercentXEnabled(n),i.setPositionPercentYEnabled(r),i.setPositionPercentX(o),i.setPositionPercentY(s),i.setPercentWidthEnabled(a),i.setPercentHeightEnabled(l),i.setPercentWidth(h),i.setPercentHeight(u),i.setPercentWidthEnabled(a||l),i.setStretchWidthEnabled(_),i.setStretchHeightEnabled(p);var C=ccui.LayoutComponent.horizontalEdge.NONE;"LeftEdge"===f?C=ccui.LayoutComponent.horizontalEdge.LEFT:"RightEdge"===f?C=ccui.LayoutComponent.horizontalEdge.RIGHT:"BothEdge"===f&&(C=ccui.LayoutComponent.horizontalEdge.CENTER),i.setHorizontalEdge(C);var S=ccui.LayoutComponent.verticalEdge.NONE;"TopEdge"===m?S=ccui.LayoutComponent.verticalEdge.TOP:"BottomEdge"===m?S=ccui.LayoutComponent.verticalEdge.BOTTOM:"BothEdge"===m&&(S=ccui.LayoutComponent.verticalEdge.CENTER),i.setVerticalEdge(S),i.setTopMargin(v),i.setBottomMargin(T),i.setLeftMargin(g),i.setRightMargin(y),i.setVerticalEdge(S),i.setTopMargin(v),i.setBottomMargin(T),i.setLeftMargin(g),i.setRightMargin(y)}},a=function(t,e,i,n){2===t.getBackGroundColorType()?(i=i||{},n=n||{},t.setBackGroundColor(_(i),_(n))):(e=e||{},t.setBackGroundColor(_(e)))},l=function(t,e){var i=e.ScaleX||0,n=e.ScaleY||0;t.setBackGroundColorVector(cc.p(i,n))};r.initPanel=function(t,e){var i=new ccui.Layout;this.widgetAttributes(i,t);var n=t.ClipAble||!1;null!=n&&i.setClippingEnabled(n);var r=o(t.ComboBoxIndex,0);i.setBackGroundColorType(r);var s=o(t.BackColorAlpha,255);null!=s&&i.setBackGroundColorOpacity(s);var c=t.Scale9Enable;null!=c&&i.setBackGroundImageScale9Enabled(c);var h=o(t.Alpha,255);if(i.setOpacity(h),d(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)}),c){var u=t.Scale9OriginX||0,_=t.Scale9OriginY||0,f=t.Scale9Width||0,m=t.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(u,_,f,m)),p(i,t.Size)}else i.isIgnoreContentAdaptWithSize()||p(i,t.Size);return a(i,t.SingleColor,t.FirstColor,t.EndColor),l(i,t.ColorVector),i},r.initText=function(t,e){var i=new ccui.Text,n=t.TouchScaleChangeAble;null!=n&&i.setTouchScaleChangeEnabled(n);var r=t.LabelText;null!=r&&i.setString(r);var s=t.FontSize;null!=s&&i.setFontSize(s);var c=t.FontName;null!=c&&i.setFontName(c);var a=t.AreaWidth,l=t.areaHeight;a&&l&&i.setTextAreaSize(cc.size(a,l));var h=t.HorizontalAlignmentType||"HT_Left";switch(h){case"HT_Right":h=2;break;case"HT_Center":h=1;break;case"HT_Left":default:h=0}i.setTextHorizontalAlignment(h);var u=t.VerticalAlignmentType||"VT_Top";switch(u){case"VT_Bottom":u=2;break;case"VT_Center":u=1;break;case"VT_Top":default:u=0}i.setTextVerticalAlignment(u);var d=t.FontResource;if(null!=d){var p=d.Path;null!=p&&(cc.sys.isNative?c=cc.path.join(cc.loader.resPath,e,p):(c=p.match(/([^\/]+)\.(\S+)/),c=c?c[1]:""),i.setFontName(c))}t.OutlineEnabled&&t.OutlineColor&&i.enableOutline&&i.enableOutline(_(t.OutlineColor),o(t.OutlineSize,1)),t.ShadowEnabled&&t.ShadowColor&&i.enableShadow&&i.enableShadow(_(t.ShadowColor),cc.size(o(t.ShadowOffsetX,2),o(t.ShadowOffsetY,-2)),t.ShadowBlurRadius||0);var f=t.IsCustomSize;null!=f&&i.ignoreContentAdaptWithSize(!f),i.setUnifySizeEnabled(!1);var m=t.CColor;return t.CColor=null,i.setTextColor(_(m)),this.widgetAttributes(i,t,i.isIgnoreContentAdaptWithSize()),t.CColor=m,i},r.initButton=function(t,e){var i=new ccui.Button;d(t.NormalFileData,e,function(t,e){i.loadTextureNormal(t,e)}),d(t.PressedFileData,e,function(t,e){i.loadTexturePressed(t,e)}),d(t.DisabledFileData,e,function(t,e){i.loadTextureDisabled(t,e)});var n=o(t.Scale9Enable,!1);n&&i.setScale9Enabled(n);var r=t.ButtonText;null!=r&&i.setTitleText(r);var s=t.FontSize;null!=s&&i.setTitleFontSize(s);var c=t.FontName;null!=c&&i.setTitleFontName(c);var a=t.TextColor;null!=a&&i.setTitleColor(_(a));var l=o(t.DisplayState,!0);i.setBright(l),i.setEnabled(l);var h=t.FontResource;if(null!=h){var u=h.Path;null!=u&&(cc.sys.isNative?c=cc.path.join(cc.loader.resPath,e,u):(c=u.match(/([^\/]+)\.(\S+)/),c=c?c[1]:""),i.setTitleFontName(c))}var f=i.getTitleRenderer();if(f&&t.ShadowEnabled&&t.ShadowColor&&f.enableShadow&&f.enableShadow(_(t.ShadowColor),cc.size(o(t.ShadowOffsetX,2),o(t.ShadowOffsetY,-2)),t.ShadowBlurRadius||0),f&&t.OutlineEnabled&&t.OutlineColor&&f.enableStroke&&f.enableStroke(_(t.OutlineColor),o(t.OutlineSize,1)),this.widgetAttributes(i,t),n){i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var m=cc.rect(t.Scale9OriginX||0,t.Scale9OriginY||0,t.Scale9Width||0,t.Scale9Height||0);i.setCapInsets(m)}return p(i,t.Size),i},r.initCheckBox=function(t,e){var i=new ccui.CheckBox;this.widgetAttributes(i,t);var n=[{name:"NormalBackFileData",handle:i.loadTextureBackGround},{name:"PressedBackFileData",handle:i.loadTextureBackGroundSelected},{name:"NodeNormalFileData",handle:i.loadTextureFrontCross},{name:"DisableBackFileData",handle:i.loadTextureBackGroundDisabled},{name:"NodeDisableFileData",handle:i.loadTextureFrontCrossDisabled}];n.forEach(function(n){d(t[n.name],e,function(t,e){n.handle.call(i,t,e)})});var r=o(t.CheckedState,!1);i.setSelected(r);var s=o(t.DisplayState,!0);return i.setBright(s),i.setEnabled(s),i},r.initScrollView=function(t,e){var i=new ccui.ScrollView;this.widgetAttributes(i,t),d(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)});var n=t.ClipAble||!1;i.setClippingEnabled(n);var r=o(t.ComboBoxIndex,0);i.setBackGroundColorType(r);var s=t.BackColorAlpha;null!=s&&i.setBackGroundColorOpacity(s);var c=t.Scale9Enable;if(c){i.setBackGroundImageScale9Enabled(!0);var h=t.Scale9OriginX||0,u=t.Scale9OriginY||0,_=t.Scale9Width||0,f=t.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(h,u,_,f)),p(i,t.Size)}else i.isIgnoreContentAdaptWithSize()||p(i,t.Size);a(i,t.SingleColor,t.FirstColor,t.EndColor),l(i,t.ColorVector);var m=t.InnerNodeSize,g=cc.size(m.Width||0,m.Height||0);i.setInnerContainerSize(g);var y=0;"Vertical"===t.ScrollDirectionType&&(y=1),"Horizontal"===t.ScrollDirectionType&&(y=2),"Vertical_Horizontal"===t.ScrollDirectionType&&(y=3),i.setDirection(y);var v=o(t.IsBounceEnabled,!1);return i.setBounceEnabled(v),i},r.initImageView=function(t,e){var i=new ccui.ImageView;d(t.FileData,e,function(t,e){i.loadTexture(t,e)}),d(t.ImageFileData,e,function(t,e){i.loadTexture(t,e)});var n=t.Scale9Enable;if(n){i.setScale9Enabled(!0),i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var r=t.Scale9OriginX||0,o=t.Scale9OriginY||0,s=t.Scale9Width||0,c=t.Scale9Height||0;i.setCapInsets(cc.rect(r,o,s,c))}else p(i,t.Size);return this.widgetAttributes(i,t),i},r.initLoadingBar=function(t,e){var i=new ccui.LoadingBar;this.widgetAttributes(i,t),d(t.ImageFileData,e,function(t,e){i.loadTexture(t,e)});var n="Right_To_Left"===t.ProgressType?1:0;i.setDirection(n);var r=o(t.ProgressInfo,80);return null!=r&&i.setPercent(r),i},r.initSlider=function(t,e){var i=new ccui.Slider,n=cc.loader;this.widgetAttributes(i,t);var r=[{name:"BackGroundData",handle:i.loadBarTexture},{name:"BallNormalData",handle:i.loadSlidBallTextureNormal},{name:"BallPressedData",handle:i.loadSlidBallTexturePressed},{name:"BallDisabledData",handle:i.loadSlidBallTextureDisabled},{name:"ProgressBarData",handle:i.loadProgressBarTexture}];r.forEach(function(r){d(t[r.name],e,function(t,e){0!==e||n.getRes(t)||cc.log("%s need to be preloaded",t),r.handle.call(i,t,e)})});var s=t.PercentInfo||0;i.setPercent(s);var c=o(t.DisplayState,!0);return i.setBright(c),i.setEnabled(c),i},r.initPageView=function(t,e){var i=new ccui.PageView;this.widgetAttributes(i,t),d(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)});var n=t.ClipAble||!1;i.setClippingEnabled(n);var r=t.Scale9Enable;if(r){i.setBackGroundImageScale9Enabled(!0);var s=t.Scale9OriginX||0,c=t.Scale9OriginY||0,h=t.Scale9Width||0,u=t.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(s,c,h,u))}var _=o(t.ComboBoxIndex,0);i.setBackGroundColorType(_),a(i,t.SingleColor,t.FirstColor,t.EndColor),l(i,t.ColorVector);var f=t.BackColorAlpha;return null!=f&&i.setBackGroundColorOpacity(f),p(i,t.Size),i},r.initListView=function(t,e){var i=new ccui.ListView;this.widgetAttributes(i,t),d(t.FileData,e,function(t,e){i.setBackGroundImage(t,e)});var n=t.ClipAble||!1;i.setClippingEnabled(n);var r=o(t.ComboBoxIndex,0);i.setBackGroundColorType(r);var s=o(t.BackColorAlpha,255),c=t.Scale9Enable;if(c){i.setBackGroundImageScale9Enabled(!0);var h=t.Scale9OriginX||0,u=t.Scale9OriginY||0,_=t.Scale9Width||0,f=t.Scale9Height||0;i.setBackGroundImageCapInsets(cc.rect(h,u,_,f))}var m=o(t.DirectionType,ccui.ListView.DIR_HORIZONTAL),g=o(t.VerticalType,"Align_Left"),y=o(t.HorizontalType,"Align_Top");m?"Vertical"===m&&(i.setDirection(ccui.ScrollView.DIR_VERTICAL),""===y?i.setGravity(ccui.ListView.GRAVITY_LEFT):"Align_Right"===y?i.setGravity(ccui.ListView.GRAVITY_RIGHT):"Align_HorizontalCenter"===y&&i.setGravity(ccui.ListView.GRAVITY_CENTER_HORIZONTAL)):(i.setDirection(ccui.ScrollView.DIR_HORIZONTAL),"Align_Bottom"===g?i.setGravity(ccui.ListView.GRAVITY_BOTTOM):"Align_VerticalCenter"===g?i.setGravity(ccui.ListView.GRAVITY_CENTER_VERTICAL):i.setGravity(ccui.ListView.GRAVITY_TOP));var v=o(t.IsBounceEnabled,!1);i.setBounceEnabled(v);var T=t.ItemMargin||0;i.setItemsMargin(T);var C=t.InnerNodeSize;return null!=C&&i.setInnerContainerSize(cc.size(C.Widget||0,C.Height||0)),a(i,t.SingleColor,t.FirstColor,t.EndColor),l(i,t.ColorVector),null!=s&&i.setBackGroundColorOpacity(s),p(i,t.Size),i},r.initTextAtlas=function(t,e){var i=new ccui.TextAtlas,n=t.LabelText,r=t.CharWidth,o=t.CharHeight,s=t.StartChar;return d(t.LabelAtlasFileImage_CNB,e,function(t,e){cc.loader.getRes(t)||cc.log("%s need to be preloaded",t),0===e&&i.setProperty(n,t,r,o,s)}),this.widgetAttributes(i,t),i.ignoreContentAdaptWithSize(!0),i},r.initTextBMFont=function(t,e){var i=new ccui.TextBMFont;this.widgetAttributes(i,t);var n=t.LabelText;return i.setString(n),d(t.LabelBMFontFile_CNB,e,function(t,e){cc.loader.getRes(t)||cc.log("%s need to be pre loaded",t),i.setFntFile(t)}),i.ignoreContentAdaptWithSize(!0),i},r.initTextField=function(t,e){var i=new ccui.TextField,n=t.PasswordEnable;if(n){i.setPasswordEnabled(!0);var r=t.PasswordStyleText||"*";i.setPasswordStyleText(r)}var o=t.PlaceHolderText;null!=o&&i.setPlaceHolder(o);var s=t.FontSize;null!=s&&i.setFontSize(s);var c=t.FontName;null!=c&&i.setFontName(c);var a=t.MaxLengthEnable;if(a){i.setMaxLengthEnabled(!0);var l=t.MaxLengthText||0;i.setMaxLength(l)}this.widgetAttributes(i,t);var h=t.LabelText;null!=h&&i.setString(h);var u=t.FontResource;if(null!=u){var d=u.Path;null!=d&&(cc.sys.isNative?c=cc.path.join(cc.loader.resPath,e,d):(c=d.match(/([^\/]+)\.(\S+)/),c=c?c[1]:""),i.setFontName(c))}i.setUnifySizeEnabled(!1),i.ignoreContentAdaptWithSize(!1);var f=t.CColor;return null!=f&&i.setTextColor(_(f)),i.isIgnoreContentAdaptWithSize()||(p(i,t.Size),cc.sys.isNative&&i.getVirtualRenderer().setLineBreakWithoutSpace(!0)),i},r.initSimpleAudio=function(t,e){var i=new ccs.ComAudio,n=t.Loop||!1;i.setLoop(n),d(t.FileData,e,function(t,e){i.setFile(t)})},r.initGameMap=function(t,e){var i=null;return d(t.FileData,e,function(e,n){0===n&&(i=new cc.TMXTiledMap(e)),r.generalAttributes(i,t)}),i},r.initProjectNode=function(t,e){var i=t.FileData;if(null!=i&&i.Path){var n=e+i.Path;if(cc.loader.getRes(n)){var o=ccs.load(n,e);if(r.generalAttributes(o.node,t),o.action&&o.node){o.action.tag=o.node.tag;var s=t.InnerActionSpeed;void 0!==s&&o.action.setTimeSpeed(s),o.node.runAction(o.action),o.action.gotoFrameAndPause(0)}return o.node}cc.log("%s need to be preloaded",n)}};var h=function(t){if(!t)return"";var e=t.match(/([^\/]+)\.[^\/]+$/);return e&&e[1]?e[1]:""};r.initArmature=function(t,e){var i=new ccs.Armature,n=t.IsLoop,o=t.IsAutoPlay,s=t.CurrentAnimationName;return d(t.FileData,e,function(t,e){var r,c,a=cc.loader.getRes(t);a?(r=a.config_file_path,c=a.config_png_path,r.forEach(function(t,e){c[e]&&cc.spriteFrameCache.addSpriteFrames(t,c[e])})):cc.log("%s need to be preloaded",t),ccs.armatureDataManager.addArmatureFileInfo(t),i.init(h(t)),o?i.getAnimation().play(s,-1,n):(i.getAnimation().play(s),i.getAnimation().gotoAndPause(0))}),delete t.AnchorPoint,delete t.Size,r.generalAttributes(i,t),i.setColor(_(t.CColor)),i},r.initBoneNode=function(t,e){var i=new ccs.BoneNode,n=t.Length;void 0!==n&&i.setDebugDrawLength(n);var o=t.BlendFunc;o&&void 0!==o.Src&&void 0!==o.Dst&&i.setBlendFunc(new cc.BlendFunc(o.Src,o.Dst)),r.generalAttributes(i,t);var s=t.CColor;return!s||void 0===s.R&&void 0===s.G&&void 0===s.B||i.setColor(_(s)),i},r.initSkeletonNode=function(t){var e=new ccs.SkeletonNode;r.generalAttributes(e,t);var i=t.CColor;return!i||void 0===i.R&&void 0===i.G&&void 0===i.B||e.setColor(_(i)),e};var u={},d=function(t,e,i){if(null!=t){var n,r=t.Path;n="Default"===t.Type||"Normal"===t.Type?0:1;var o=t.Plist;o&&(cc.loader.getRes(e+o)?(u[e+o]=!0,cc.spriteFrameCache.addSpriteFrames(e+o)):u[e+o]||cc.spriteFrameCache.getSpriteFrame(r)||cc.log("%s need to be preloaded",e+o)),0!==n?cc.spriteFrameCache.getSpriteFrame(r)?i(r,n):cc.log("failed to get spriteFrame: %s",r):i(e+r,n)}},_=function(t){if(t){var e=null!=t.R?t.R:255,i=null!=t.G?t.G:255,n=null!=t.B?t.B:255,r=null!=t.A?t.A:255;return cc.color(e,i,n,r)}},p=function(t,e){var i=e.X||0,n=e.Y||0;e&&t.setContentSize(cc.size(i,n))},f=[{name:"SingleNodeObjectData",handle:r.initSingleNode},{name:"NodeObjectData",handle:r.initSingleNode},{name:"LayerObjectData",handle:r.initSingleNode},{name:"GameNodeObjectData",handle:r.initSingleNode},{name:"GameLayerObjectData",handle:r.initSingleNode},{name:"SpriteObjectData",handle:r.initSprite},{name:"ParticleObjectData",handle:r.initParticle},{name:"PanelObjectData",handle:r.initPanel},{name:"TextObjectData",handle:r.initText},{name:"ButtonObjectData",handle:r.initButton},{name:"CheckBoxObjectData",handle:r.initCheckBox},{name:"ScrollViewObjectData",handle:r.initScrollView},{name:"ImageViewObjectData",handle:r.initImageView},{name:"LoadingBarObjectData",handle:r.initLoadingBar},{name:"SliderObjectData",handle:r.initSlider},{name:"PageViewObjectData",handle:r.initPageView},{name:"ListViewObjectData",handle:r.initListView},{name:"TextAtlasObjectData",handle:r.initTextAtlas},{name:"TextBMFontObjectData",handle:r.initTextBMFont},{name:"TextFieldObjectData",handle:r.initTextField},{name:"SimpleAudioObjectData",handle:r.initSimpleAudio},{name:"GameMapObjectData",handle:r.initGameMap},{name:"ProjectNodeObjectData",handle:r.initProjectNode},{name:"ArmatureNodeObjectData",handle:r.initArmature},{name:"BoneNodeObjectData",handle:r.initBoneNode},{name:"SkeletonNodeObjectData",handle:r.initSkeletonNode}];f.forEach(function(t){r.registerParser(t.name,function(e,n){var r=t.handle.call(this,e,n);return this.parseChild(r,e.Children,n),i&&r&&(r.__parserName=t.name),r})}),t.registerParser("timeline","2.*",r),t.registerParser("timeline","*",r)}(ccs._load,ccs._parser),function(t,e){var i=e.extend({addSpriteFrame:function(t,e){if(t)for(var i=0;i<t.length;i++)cc.spriteFrameCache.addSpriteFrames(e+t[i])},pretreatment:function(t,e){this.addSpriteFrame(t.textures,e)},deferred:function(t,e,i,n){i&&(ccs.actionManager.initWithDictionary(n,t.animation,i),i.setContentSize(cc.size(t.designWidth,t.designHeight)))}}),n=new i;n.generalAttributes=function(t,e){var i=e.ignoreSize;null!=i&&t.ignoreContentAdaptWithSize(i),e.sizeType&&t.setSizeType(e.sizeType),e.positionType&&t.setPositionType(e.positionType),t.setSizePercent(cc.p(e.sizePercentX,e.sizePercentY)),t.setPositionPercent(cc.p(e.positionPercentX,e.positionPercentY));var n=0,r=0,o=e.adaptScreen;if(o){var s=cc.director.getWinSize();n=s.width,r=s.height}else n=e.width,r=e.height;t.setContentSize(n,r),t.setTag(e.tag),t.setActionTag(e.actiontag),t.setTouchEnabled(e.touchAble);var c=e.name,a=c?c:"default";t.setName(a);var l=e.x,h=e.y;t.setPosition(l,h);var u=null!=e.scaleX?e.scaleX:1;t.setScaleX(u);var d=null!=e.scaleY?e.scaleY:1;t.setScaleY(d);var _=e.rotation||0;t.setRotation(_);var p=e.visible||!1;null!=p&&t.setVisible(p),t.setLocalZOrder(e.ZOrder);var f=e.layoutParameter;if(null!=f){var m=e.layoutParameter,g=m.type,y=null;switch(g){case 0:break;case 1:y=new ccui.LinearLayoutParameter;var v=m.gravity;y.setGravity(v);break;case 2:y=new ccui.RelativeLayoutParameter;var T=y,C=m.relativeName;T.setRelativeName(C);var S=m.relativeToName;T.setRelativeToWidgetName(S);var x=m.align;T.setAlign(x)}if(null!=y){var A=m.marginLeft||0,E=m.marginTop||0,b=m.marginRight||0,R=m.marginDown||0;y.setMargin(A,E,b,R),t.setLayoutParameter(y)}}},n.colorAttributes=function(t,e){var i=e.opacity;null!=i&&t.setOpacity(i);var n=e.colorR,r=e.colorG,o=e.colorB;t.setColor(cc.color(null==n?255:n,null==r?255:r,null==o?255:o)),t.setFlippedX(e.flipX),t.setFlippedY(e.flipY)},n.anchorPointAttributes=function(t,e){var i,n=e.anchorPointX;i=null!=n?e.anchorPointX:t.getAnchorPoint().x;var r,o=e.anchorPointY;r=null!=o?e.anchorPointY:t.getAnchorPoint().y,null==n&&null==o||t.setAnchorPoint(cc.p(i,r))},n.parseChild=function(t,e,i){for(var n=e.children,r=0;r<n.length;r++){var o=this.parseNode(n[r],i);if(o)if(t instanceof ccui.PageView)t.addPage(o);else if(t instanceof ccui.ListView)t.pushBackCustomItem(o);else{if(!(t instanceof ccui.Layout)){if(o.getPositionType()===ccui.Widget.POSITION_PERCENT){var s=o.getPositionPercent(),c=t.getAnchorPoint();o.setPositionPercent(cc.p(s.x+c.x,s.y+c.y))}var a=t.getAnchorPointInPoints();o.setPosition(cc.p(o.getPositionX()+a.x,o.getPositionY()+a.y))}t.addChild(o)}}};var r=function(t,e,i,n){i&&(0===e?n(t+i,e):n(i,e))};n.LayoutAttributes=function(t,e,i){var n=0,o=0,s=e.adaptScreen;if(s){var c=cc.director.getWinSize();n=c.width,o=c.height}else n=e.width,o=e.height;t.setSize(cc.size(n,o)),t.setClippingEnabled(e.clipAble);var a=e.backGroundScale9Enable;t.setBackGroundImageScale9Enabled(a);var l=e.bgColorR,h=e.bgColorG,u=e.bgColorB,d=e.bgStartColorR,_=e.bgStartColorG,p=e.bgStartColorB,f=e.bgEndColorR,m=e.bgEndColorG,g=e.bgEndColorB,y=e.vectorX,v=e.vectorY;t.setBackGroundColorVector(cc.p(y,v));var T=e.bgColorOpacity,C=e.colorType;t.setBackGroundColorType(C),t.setBackGroundColor(cc.color(d,_,p),cc.color(f,m,g)),t.setBackGroundColor(cc.color(l,h,u)),t.setBackGroundColorOpacity(T);var S=e.backGroundImageData;if(S&&r(i,S.resourceType,S.path,function(e,i){t.setBackGroundImage(e,i)}),a){var x=e.capInsetsX,A=e.capInsetsY,E=e.capInsetsWidth,b=e.capInsetsHeight;t.setBackGroundImageCapInsets(cc.rect(x,A,E,b))}e.layoutType&&t.setLayoutType(e.layoutType)},n.ButtonAttributes=function(t,e,i){var n=t,o=e.scale9Enable;n.setScale9Enabled(o);var s=e.normalData;r(i,s.resourceType,s.path,function(t,e){n.loadTextureNormal(t,e)});var c=e.pressedData;r(i,c.resourceType,c.path,function(t,e){n.loadTexturePressed(t,e)});var a=e.disabledData;if(r(i,a.resourceType,a.path,function(t,e){n.loadTextureDisabled(t,e)}),o){var l=e.capInsetsX,h=e.capInsetsY,u=e.capInsetsWidth,d=e.capInsetsHeight;n.setCapInsets(cc.rect(l,h,u,d));var _=e.scale9Width,p=e.scale9Height;null!=_&&null!=p&&n.setSize(cc.size(_,p))}var f=e.text;null!=f&&n.setTitleText(f);var m=e.textColorR,g=e.textColorG,y=e.textColorB,v=null!==m?e.textColorR:255,T=null!==g?e.textColorG:255,C=null!==y?e.textColorB:255;n.setTitleColor(cc.color(v,T,C));var S=e.fontSize;null!=S&&n.setTitleFontSize(e.fontSize);var x=e.fontName;x&&n.setTitleFontName(e.fontName)},n.CheckBoxAttributes=function(t,e,i){var n=e.backGroundBoxData;r(i,n.resourceType,n.path,function(e,i){t.loadTextureBackGround(e,i)});var o=e.backGroundBoxSelectedData;r(i,o.resourceType||n.resourceType,o.path||n.path,function(e,i){t.loadTextureBackGroundSelected(e,i)});var s=e.frontCrossData;r(i,s.resourceType,s.path,function(e,i){t.loadTextureFrontCross(e,i)});var c=e.backGroundBoxDisabledData;r(i,c.resourceType||s.resourceType,c.path||s.path,function(e,i){t.loadTextureBackGroundDisabled(e,i)});var a=e.frontCrossDisabledData;r(i,a.resourceType,a.path,function(e,i){t.loadTextureFrontCrossDisabled(e,i)}),e.selectedState&&t.setSelected(e.selectedState)},n.ImageViewAttributes=function(t,e,i){var n=e.fileNameData;r(i,n.resourceType,n.path,function(e,i){t.loadTexture(e,i)});var o=e.scale9Enable,s=!1;if(o&&(s=e.scale9Enable),t.setScale9Enabled(s),s){var c=e.scale9Width,a=e.scale9Height;if(c&&a){var l=e.scale9Width,h=e.scale9Height;t.setSize(cc.size(l,h))}var u=e.capInsetsX,d=e.capInsetsY,_=e.capInsetsWidth,p=e.capInsetsHeight;t.setCapInsets(cc.rect(u,d,_,p))}},n.TextAtlasAttributes=function(t,e,i){var n=e.stringValue,r=e.charMapFileData,o=e.itemWidth,s=e.itemHeight,c=e.startCharMap;if(null!=n&&r&&null!=o&&null!=s&&null!=c){var a=e.charMapFileData,l=a.resourceType;switch(l){case 0:var h=i,u=a.path,d=h+u;t.setProperty(n,d,o,s,c);break;case 1:cc.log("Wrong res type of LabelAtlas!")}}},n.TextBMFontAttributes=function(t,e,i){var n=e.fileNameData,r=n.resourceType;switch(r){case 0:var o=i,s=n.path,c=o+s;t.setFntFile(c);break;case 1:cc.log("Wrong res type of LabelAtlas!")}var a=e.text;t.setString(a)};var o=/\.ttf$/;n.TextAttributes=function(t,e,i){var n=e.touchScaleEnable;t.setTouchScaleChangeEnabled(n);var r=e.text;t.setString(r);var s=e.fontSize;null!=s&&t.setFontSize(e.fontSize);var c=e.fontName;null!=c&&(cc.sys.isNative?o.test(c)?t.setFontName(cc.path.join(cc.loader.resPath,i,c)):t.setFontName(c):t.setFontName(c.replace(o,"")));var a=e.areaWidth,l=e.areaHeight;if(null!=a&&null!=l){var h=cc.size(e.areaWidth,e.areaHeight);t.setTextAreaSize(h)}var u=e.hAlignment;null!=u&&t.setTextHorizontalAlignment(e.hAlignment);var d=e.vAlignment;null!=d&&t.setTextVerticalAlignment(e.vAlignment)},n.ListViewAttributes=function(t,e,i){n.ScrollViewAttributes(t,e,i);var r=e.direction;t.setDirection(r);var o=e.gravity;t.setGravity(o);var s=e.itemMargin;t.setItemsMargin(s)},n.LoadingBarAttributes=function(t,e,i){var n=e.textureData;r(i,n.resourceType,n.path,function(e,i){t.loadTexture(e,i)});var o=e.scale9Enable;if(t.setScale9Enabled(o),o){var s=e.capInsetsX,c=e.capInsetsY,a=e.capInsetsWidth,l=e.capInsetsHeight;t.setCapInsets(cc.rect(s,c,a,l));var h=e.width,u=e.height;t.setSize(cc.size(h,u))}t.setDirection(e.direction),t.setPercent(e.percent)},n.PageViewAttributes=n.LayoutAttributes,n.ScrollViewAttributes=function(t,e,i){n.LayoutAttributes(t,e,i);var r=null!=e.innerWidth?e.innerWidth:200,o=null!=e.innerHeight?e.innerHeight:200;t.setInnerContainerSize(cc.size(r,o));var s=null!=e.direction?e.direction:1;t.setDirection(s),t.setBounceEnabled(e.bounceEnable)},n.SliderAttributes=function(t,e,i){var n=t,o=e.scale9Enable;n.setScale9Enabled(o);var s=e.barFileName,c=e.length,a=e.barFileNameData,l=a.resourceType,h=a.path;null!=s?o&&(r(i,l,h,function(t,e){n.loadBarTexture(t,e)}),n.setSize(cc.size(c,n.getContentSize().height))):r(i,l,h,function(t,e){n.loadBarTexture(t,e)});var u=e.ballNormalData;r(i,u.resourceType,u.path,function(t,e){n.loadSlidBallTextureNormal(t,e)});var d=e.ballPressedData;r(i,d.resourceType||u.resourceType,d.path||u.path,function(t,e){n.loadSlidBallTexturePressed(t,e)});var _=e.ballDisabledData;r(i,_.resourceType,_.path,function(t,e){n.loadSlidBallTextureDisabled(t,e)});var p=e.progressBarData;r(i,p.resourceType,p.path,function(t,e){n.loadProgressBarTexture(t,e)})},n.TextFieldAttributes=function(t,e,i){var n=e.placeHolder;n&&t.setPlaceHolder(n),t.setString(e.text||"");var r=e.fontSize;r&&t.setFontSize(r);var s=e.fontName;null!=s&&(cc.sys.isNative?o.test(s)?t.setFontName(cc.path.join(cc.loader.resPath,i,s)):t.setFontName(s):t.setFontName(s.replace(o,"")));var c=e.touchSizeWidth,a=e.touchSizeHeight;null!=c&&null!=a&&t.setTouchSize(c,a);var l=(e.width,e.height,e.maxLengthEnable);if(t.setMaxLengthEnabled(l),l){var h=e.maxLength;t.setMaxLength(h)}var u=e.passwordEnable;t.setPasswordEnabled(u),u&&t.setPasswordStyleText(e.passwordStyleText);var d=e.areaWidth,_=e.areaHeight;if(d&&_){var p=cc.size(d,_);t.setTextAreaSize(p)}var f=e.hAlignment;f&&t.setTextHorizontalAlignment(f);var m=e.vAlignment;m&&t.setTextVerticalAlignment(m);var g=e.colorR,y=e.colorG,v=e.colorB;void 0!==g&&void 0!==y&&void 0!==v&&t.setTextColor(cc.color(g,y,v))};var s=[{name:"Panel",object:ccui.Layout,handle:n.LayoutAttributes},{name:"Button",object:ccui.Button,handle:n.ButtonAttributes},{name:"CheckBox",object:ccui.CheckBox,handle:n.CheckBoxAttributes},{name:"ImageView",object:ccui.ImageView,handle:n.ImageViewAttributes},{name:"LabelAtlas",object:ccui.TextAtlas,handle:n.TextAtlasAttributes},{name:"LabelBMFont",object:ccui.TextBMFont,handle:n.TextBMFontAttributes},{name:"Label",object:ccui.Text,handle:n.TextAttributes},{name:"ListView",object:ccui.ListView,handle:n.ListViewAttributes},{name:"LoadingBar",object:ccui.LoadingBar,handle:n.LoadingBarAttributes},{name:"PageView",object:ccui.PageView,handle:n.PageViewAttributes},{name:"ScrollView",object:ccui.ScrollView,handle:n.ScrollViewAttributes},{name:"Slider",object:ccui.Slider,handle:n.SliderAttributes},{name:"TextField",object:ccui.TextField,handle:n.TextFieldAttributes}];s.forEach(function(t){n.registerParser(t.name,function(e,i){var r=new t.object,o=e.options;return n.generalAttributes(r,o),t.handle(r,o,i),n.colorAttributes(r,o),n.anchorPointAttributes(r,o),n.parseChild.call(this,r,e,i),r})}),t.registerParser("ccui","*",n)}(ccs._load,ccs._parser),function(){ccs.uiReader={_fileDesignSizes:{},widgetFromJsonFile:function(t){var e=cc.loader.getRes(t);e&&(this._fileDesignSizes[t]=cc.size(e.designWidth||0,e.designHeight||0));var i=e.Version||e.version,n=ccs.uiReader.getVersionInteger(i);return!i||n>=1700?(cc.warn("Not supported file types, Please try use the ccs.load"),null):ccs._load(t,"ccui")},registerTypeAndCallBack:function(t,e,i,n){var r=ccs._load.getParser("ccui")["*"],o=n.bind(i);r.registerParser(t,function(n,r){var s=new e,c=n.options;i.setPropsFromJsonDictionary&&i.setPropsFromJsonDictionary(s,c),this.generalAttributes(s,c);var a=c.customProperty;return a=a?JSON.parse(a):{},o(t,s,a),this.colorAttributes(s,c),this.anchorPointAttributes(s,c),this.parseChild.call(this,s,n,r),s})},getVersionInteger:function(t){if(!t||"string"!=typeof t)return 0;var e=t.split(".");if(4!==e.length)return 0;var i=0;return e.forEach(function(t,e){i+=t*Math.pow(10,3-e)}),i},storeFileDesignSize:function(t,e){this._fileDesignSizes[t]=e},getFileDesignSize:function(t){return this._fileDesignSizes[t]},getFilePath:function(){return this._filePath},setFilePath:function(t){this._filePath=t},getParseObjectMap:function(){return ccs._load.getParser("ccui")["*"].parsers},getParseCallBackMap:function(){return ccs._load.getParser("ccui")["*"].parsers},clear:function(){}};var t=ccs._load.getParser("ccui")["*"];ccs.imageViewReader={setPropsFromJsonDictionary:t.ImageViewAttributes},ccs.buttonReader={setPropsFromJsonDictionary:t.ButtonAttributes},ccs.checkBoxReader={setPropsFromJsonDictionary:t.CheckBoxAttributes},ccs.labelAtlasReader={setPropsFromJsonDictionary:t.TextAtlasAttributes},ccs.labelBMFontReader={setPropsFromJsonDictionary:t.TextBMFontAttributes},ccs.labelReader={setPropsFromJsonDictionary:t.TextAttributes},ccs.layoutReader={setPropsFromJsonDictionary:t.LayoutAttributes},ccs.listViewReader={setPropsFromJsonDictionary:t.ListViewAttributes},ccs.loadingBarReader={setPropsFromJsonDictionary:t.LoadingBarAttributes},ccs.pageViewReader={setPropsFromJsonDictionary:t.PageViewAttributes},ccs.scrollViewReader={setPropsFromJsonDictionary:t.ScrollViewAttributes},ccs.sliderReader={setPropsFromJsonDictionary:t.SliderAttributes},ccs.textFieldReader={setPropsFromJsonDictionary:t.TextFieldAttributes}}(),function(){ccs.sceneReader={_node:null,createNodeWithSceneFile:function(t){var e=ccs._load(t,"scene");return this._node=e,e},getNodeByTag:function(t){return null==this._node?null:this._node.getTag()===t?this._node:this._nodeByTag(this._node,t)},_nodeByTag:function(t,e){if(null==t)return null;for(var i=null,n=t.getChildren(),r=0;r<n.length;r++){var o=n[r];if(o&&o.getTag()===e){i=o;break}if(i=this._nodeByTag(o,e))break}return i},version:function(){return"*"},setTarget:function(){},clear:function(){ccs.triggerManager.removeAll(),cc.audioEngine.end()}}}();!function(){ccs.Armature.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._parentCmd=null,this._realAnchorPointInPoints=new cc.Point(0,0)};var t=ccs.Armature.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(ccs.Armature.RenderCmd,t),t.constructor=ccs.Armature.WebGLRenderCmd,t.uploadData=function(t,e,i){for(var n,r=this._node,o=this._parentCmd||this,s=r._children,c=cc.BlendFunc.ALPHA_PREMULTIPLIED,a=cc.BlendFunc.ALPHA_NON_PREMULTIPLIED,l=0,h=s.length;l<h;l++){var u=s[l],d=u._renderCmd;if(u&&u.getDisplayRenderNode){var _=u.getDisplayRenderNode();if(null===_)continue;switch(n=_._renderCmd,u.getDisplayRenderNodeType()){case ccs.DISPLAY_TYPE_SPRITE:if(_ instanceof ccs.Skin){_.setShaderProgram(this._shaderProgram),this._updateColorAndOpacity(n,u),n.transform(o);var p=u.getBlendFunc();if(p.src!==c.src||p.dst!==c.dst)_.setBlendFunc(u.getBlendFunc());else{var f=_.getTexture();r._blendFunc.src===c.src&&r._blendFunc.dst===c.dst&&f&&!f.hasPremultipliedAlpha()?_.setBlendFunc(a):_.setBlendFunc(r._blendFunc)}cc.renderer._uploadBufferData(n)}break;case ccs.DISPLAY_TYPE_ARMATURE:_.setShaderProgram(this._shaderProgram),n._parentCmd=this;default:d._syncStatus(o),n._syncStatus(d),n.uploadData?cc.renderer._uploadBufferData(n):n.rendering&&(cc.renderer._batchRendering(),n.rendering(cc._renderContext))}}else u instanceof cc.Node&&(u.setShaderProgram(this._shaderProgram),d._syncStatus(o),d.uploadData?cc.renderer._uploadBufferData(d):d.rendering&&(cc.renderer._batchRendering(),d.rendering(cc._renderContext)))}return this._parentCmd=null,0},t.initShaderCache=function(){this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)},t.setShaderProgram=function(t){this._shaderProgram=t},t._updateColorAndOpacity=function(t,e){var i=e._renderCmd._displayedColor,n=e._renderCmd._displayedOpacity,r=cc.Node._dirtyFlags,o=t._dirtyFlag,s=o&r.colorDirty,c=o&r.opacityDirty;s&&t._updateDisplayColor(i),c&&t._updateDisplayOpacity(n),(s||c)&&t._updateColor()},t.visit=function(t){var e=this._node;if(e._visible){t=t||this.getParentRenderCmd(),t&&(this._curLevel=t._curLevel+1),this._syncStatus(t),e.sortAllChildren();var i,n,r=cc.renderer,o=e._children,s=o.length;for(isNaN(e._customZ)&&(e._vertexZ=r.assignedZ,r.assignedZ+=r.assignedZStep),n=0;n<s&&(i=o[n],i._localZOrder<0);n++)isNaN(i._customZ)&&(i._vertexZ=r.assignedZ,r.assignedZ+=r.assignedZStep);for(r.pushRenderCommand(this);n<s;n++)i=o[n],isNaN(i._customZ)&&(i._vertexZ=r.assignedZ,r.assignedZ+=r.assignedZStep);this._dirtyFlag=0}}}();cc.pool={_pool:{},_releaseCB:function(){this.release()},_autoRelease:function(t){var e=void 0!==t._running&&!t._running;cc.director.getScheduler().schedule(this._releaseCB,t,0,0,0,e)},putInPool:function(t){var e=t.constructor.prototype.__pid;if(!e){var i={writable:!0,enumerable:!1,configurable:!0};i.value=ClassManager.getNewID(),Object.defineProperty(t.constructor.prototype,"__pid",i)}this._pool[e]||(this._pool[e]=[]),t.retain&&t.retain(),t.unuse&&t.unuse(),this._pool[e].push(t)},hasObject:function(t){var e=t.prototype.__pid,i=this._pool[e];return!(!i||0===i.length)},removeObject:function(t){var e=t.constructor.prototype.__pid;if(e){var i=this._pool[e];if(i)for(var n=0;n<i.length;n++)t===i[n]&&(t.release&&t.release(),i.splice(n,1))}},getFromPool:function(t){if(this.hasObject(t)){var e=t.prototype.__pid,i=this._pool[e],n=Array.prototype.slice.call(arguments);n.shift();var r=i.pop();return r.reuse&&r.reuse.apply(r,n),cc.sys.isNative&&r.release&&this._autoRelease(r),r}},drainAllPools:function(){for(var t in this._pool)for(var e=0;e<this._pool[t].length;e++){var i=this._pool[t][e];i.release&&i.release()}this._pool={}}};!function(){if(void 0!==cc){var PluginManager=function(){};PluginManager.prototype={constructor:PluginManager,getInstance:function(){return this},loadPlugin:function(t){},unloadPlugin:function(t){}};var PluginAssembly=function(){};PluginAssembly.prototype={constructor:PluginAssembly,setDebugMode:function(t){},startSession:function(t){},setCaptureUncaughtException:function(t){},callFuncWithParam:function(t){return"function"==typeof this[t]?this[t].apply(this,Array.prototype.splice.call(arguments,1)):void cc.log("function is not define")},callStringFuncWithParam:function(t){this.callFuncWithParam.apply(arguments)},getPluginName:function(){return this._name},getPluginVersion:function(){return this._version}},PluginAssembly.extend=function(name,porp){var p,prototype={};for(p in PluginAssembly.prototype)prototype[p]=PluginAssembly.prototype[p];for(p in porp)prototype[p]=porp[p];var tmp=eval("(function "+name+"Plugin(){})");return prototype.constructor=tmp,tmp.prototype=prototype,tmp};var Param=function(t,e){var i,n=plugin.PluginParam.ParamType;switch(t){case n.TypeInt:i=parseInt(e);break;case n.TypeFloat:i=parseFloat(e);break;case n.TypeBool:i=Boolean(e);break;case n.TypeString:i=String(e);break;case n.TypeStringMap:i=e;break;default:i=e}return i};Param.ParamType={TypeInt:1,TypeFloat:2,TypeBool:3,TypeString:4,TypeStringMap:5},Param.AdsResultCode={AdsReceived:0,FullScreenViewShown:1,FullScreenViewDismissed:2,PointsSpendSucceed:3,PointsSpendFailed:4,NetworkError:5,UnknownError:6},Param.PayResultCode={PaySuccess:0,PayFail:1,PayCancel:2,PayTimeOut:3},Param.ShareResultCode={ShareSuccess:0,ShareFail:1,ShareCancel:2,ShareTimeOut:3};var PluginList={},Plugin={extend:function(t,e){var i=cc.game.config&&cc.game.config.plugin||{};PluginList[t]=new(PluginAssembly.extend(t,e)),"function"==typeof PluginList[t].ctor&&PluginList[t].ctor(i[t])},PluginList:PluginList,PluginParam:Param,PluginManager:new PluginManager};window.plugin=Plugin}}();!function(){var t={_ignoreBodyRotation:!1,_body:null,_rotation:1,ctor:function(t,e){if(cc.Sprite.prototype.ctor.call(this),void 0===t)cc.PhysicsSprite.prototype.init.call(this);else if(cc.isString(t))if("#"===t[0]){var i=t.substr(1,t.length-1),n=cc.spriteFrameCache.getSpriteFrame(i);this.initWithSpriteFrame(n)}else this.init(t,e);else cc.isObject(t)&&(t instanceof cc.Texture2D?this.initWithTexture(t,e):t instanceof cc.SpriteFrame&&this.initWithSpriteFrame(t));cc.renderer.pushRenderCommand(this._renderCmd)},visit:function(){cc.renderer.pushRenderCommand(this._renderCmd),cc.Sprite.prototype.visit.call(this)},setBody:function(t){this._body=t},getBody:function(){return this._body},getPosition:function(){var t=this._body;return{x:t.p.x,y:t.p.y}},getPositionX:function(){return this._body.p.x},getPositionY:function(){return this._body.p.y},setPosition:function(t,e){void 0===e?(this._body.p.x=t.x,this._body.p.y=t.y):(this._body.p.x=t,this._body.p.y=e)},setPositionX:function(t){this._body.p.x=t},setPositionY:function(t){this._body.p.y=t},_syncPosition:function(){var t=this._position,e=this._body;t.x===e.p.x&&t.y===e.p.y||cc.Sprite.prototype.setPosition.call(this,e.p.x,e.p.y)},getRotation:function(){return this._ignoreBodyRotation?this._rotationX:-cc.radiansToDegrees(this._body.a)},setRotation:function(t){this._ignoreBodyRotation?cc.Sprite.prototype.setRotation.call(this,t):this._body.a=-cc.degreesToRadians(t)},_syncRotation:function(){var t=-cc.radiansToDegrees(this._body.a);this._rotationX!==t&&cc.Sprite.prototype.setRotation.call(this,t)},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},isDirty:function(){return!this._body.isSleeping()},setDirty:function(){},setIgnoreBodyRotation:function(t){this._ignoreBodyRotation=t},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.PhysicsSprite.CanvasRenderCmd(this):new cc.PhysicsSprite.WebGLRenderCmd(this)}};cc.PhysicsSprite=cc.Sprite.extend(t),cc.PhysicsSprite._className="PhysicsSprite";var e=cc.PhysicsSprite.prototype;e.body,cc.defineGetterSetter(e,"body",e.getBody,e.setBody),e.dirty,cc.defineGetterSetter(e,"dirty",e.isDirty,e.setDirty),cc.PhysicsSprite.create=function(t,e){return new cc.PhysicsSprite(t,e)},cc.PhysicsSprite.createWithSpriteFrameName=cc.PhysicsSprite.create,cc.PhysicsSprite.createWithSpriteFrame=cc.PhysicsSprite.create}(),function(){cc.PhysicsSprite.CanvasRenderCmd=function(t){cc.Sprite.CanvasRenderCmd.call(this,t),this._needDraw=!0};var t=cc.PhysicsSprite.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);t.constructor=cc.PhysicsSprite.CanvasRenderCmd,t.rendering=function(t,e,i){var n=this._node;n._syncPosition(),n._ignoreBodyRotation||n._syncRotation(),this.transform(this.getParentRenderCmd()),cc.Sprite.CanvasRenderCmd.prototype.rendering.call(this,t,e,i)}}(),cc.__convertVerts=function(t){for(var e=[],i=0;i<t.length/2;i++)e[i]={x:t[2*i],y:t[2*i+1]};return e},cc.ColorForBody=function(t){return t.isRogue()||t.isSleeping()?cc.color(128,128,128,128):t.nodeIdleTime>t.space.sleepTimeThreshold?cc.color(84,84,84,128):cc.color(255,0,0,128)},cc.DrawShape=function(t,e){var i=t.body,n=cc.ColorForBody(i);switch(t.collisionCode){case cp.CircleShape.prototype.collisionCode:this.drawDot(t.tc,Math.max(t.r,1),n),this.drawSegment(t.tc,cp.v.add(t.tc,cp.v.mult(i.rot,t.r)),1,n);break;case cp.SegmentShape.prototype.collisionCode:this.drawSegment(t.ta,t.tb,Math.max(t.r,2),n);break;case cp.PolyShape.prototype.collisionCode:var r=cc.color(n.r,n.g,n.b,cc.lerp(n.a,255,.5));this.drawPoly(cc.__convertVerts(t.tVerts),n,1,r);break;default:cc.log("cc.DrawShape(): Bad assertion in DrawShape()")}},cc.DrawConstraint=function(t,e){var i,n,r=t.a,o=t.b;if(t instanceof cp.PinJoint)i=r.local2World(t.anchr1),n=o.local2World(t.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR);else if(t instanceof cp.SlideJoint)i=r.local2World(t.anchr1),n=o.local2World(t.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR);else if(t instanceof cp.PivotJoint)i=r.local2World(t.anchr1),n=o.local2World(t.anchr2),this.drawDot(i,3,cc.CONSTRAINT_COLOR),this.drawDot(n,3,cc.CONSTRAINT_COLOR);else if(t instanceof cp.GrooveJoint){i=r.local2World(t.grv_a),n=r.local2World(t.grv_b);var s=o.local2World(t.anchr2);this.drawDot(s,3,cc.CONSTRAINT_COLOR),this.drawSegment(i,n,1,cc.CONSTRAINT_COLOR)}else t instanceof cp.DampedSpring},cc.CONSTRAINT_COLOR=cc.color(0,255,0,128),cc.PhysicsDebugNode=cc.DrawNode.extend({_space:null,_className:"PhysicsDebugNode",ctor:function(t){cc.DrawNode.prototype.ctor.call(this),this._space=t},getSpace:function(){return this._space},setSpace:function(t){this._space=t},draw:function(t){this._space&&(this._space.eachShape(cc.DrawShape.bind(this)),this._space.eachConstraint(cc.DrawConstraint.bind(this)),cc.DrawNode.prototype.draw.call(this),this.clear())},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.PhysicsDebugNode.CanvasRenderCmd(this):new cc.PhysicsDebugNode.WebGLRenderCmd(this)}}),cc.PhysicsDebugNode.create=function(t){return new cc.PhysicsDebugNode(t)},function(){cc.PhysicsDebugNode.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._buffer=t._buffer,this._needDraw=!0};var t=cc.PhysicsDebugNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=cc.PhysicsDebugNode.CanvasRenderCmd,t.rendering=function(t,e,i){var n=this._node;n._space&&(n._space.eachShape(cc.DrawShape.bind(n)),n._space.eachConstraint(cc.DrawConstraint.bind(n)),cc.DrawNode.CanvasRenderCmd.prototype.rendering.call(this,t,e,i),n.clear())},t._drawDot=cc.DrawNode.CanvasRenderCmd.prototype._drawDot,t._drawSegment=cc.DrawNode.CanvasRenderCmd.prototype._drawSegment,t._drawPoly=cc.DrawNode.CanvasRenderCmd.prototype._drawPoly}();!function(){cc.PhysicsDebugNode.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity()},cc.PhysicsDebugNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),cc.PhysicsDebugNode.WebGLRenderCmd.prototype.constructor=cc.PhysicsDebugNode.WebGLRenderCmd,cc.PhysicsDebugNode.WebGLRenderCmd.prototype.rendering=function(t){var e=this._node;if(e._space){e._space.eachShape(cc.DrawShape.bind(e)),e._space.eachConstraint(cc.DrawConstraint.bind(e));var i=this._worldTransform;this._matrix.mat[0]=i.a,this._matrix.mat[4]=i.c,this._matrix.mat[12]=i.tx,this._matrix.mat[1]=i.b,this._matrix.mat[5]=i.d,this._matrix.mat[13]=i.ty,cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst),this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),e._render(),e.clear()}}}(),function(){cc.PhysicsSprite.WebGLRenderCmd=function(t){cc.Sprite.WebGLRenderCmd.call(this,t),this._needDraw=!0};var t=cc.PhysicsSprite.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);t.constructor=cc.PhysicsSprite.WebGLRenderCmd,t.spUploadData=cc.Sprite.WebGLRenderCmd.prototype.uploadData,t.uploadData=function(t,e,i){var n=this._node;return n._syncPosition(),n._ignoreBodyRotation||n._syncRotation(),this.transform(this.getParentRenderCmd(),!0),this.spUploadData(t,e,i)}}();!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.io=t()}}(function(){var t;return function t(e,i,n){function r(s,c){if(!i[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return r(i?i:t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){e.exports=t("./lib/")},{"./lib/":2}],2:[function(t,e,i){function n(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n=r(t),o=n.source,l=n.id;return e.forceNew||e["force new connection"]||!1===e.multiplex?(c("ignoring socket cache for %s",o),i=s(o,e)):(a[l]||(c("new io instance for %s",o),a[l]=s(o,e)),i=a[l]),i.socket(n.path)}var r=t("./url"),o=t("socket.io-parser"),s=t("./manager"),c=t("debug")("socket.io-client");e.exports=i=n;var a=i.managers={};i.protocol=o.protocol,i.connect=n,i.Manager=t("./manager"),i.Socket=t("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(t,e,i){function n(t,e){return this instanceof n?(t&&"object"==typeof t&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new c.Encoder,this.decoder=new c.Decoder,this.autoConnect=e.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(t,e)}var r=(t("./url"),t("engine.io-client")),o=t("./socket"),s=t("component-emitter"),c=t("socket.io-parser"),a=t("./on"),l=t("component-bind"),h=(t("object-component"),t("debug")("socket.io-client:manager")),u=t("indexof"),d=t("backo2");e.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)this.nsps[t].id=this.engine.id},s(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(t){if(h("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=r(this.uri,this.opts);var e=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var n=a(e,"open",function(){i.onopen(),t&&t()}),o=a(e,"error",function(e){if(h("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;h("connect attempt will timeout after %d",s);var c=setTimeout(function(){h("connect attempt timed out after %d",s),n.destroy(),e.close(),e.emit("error","timeout"),i.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(n),this.subs.push(o),this},n.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",l(this,"ondata"))),this.subs.push(a(this.decoder,"decoded",l(this,"ondecoded"))),this.subs.push(a(t,"error",l(this,"onerror"))),this.subs.push(a(t,"close",l(this,"onclose")))},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){h("error",t),this.emitAll("error",t)},n.prototype.socket=function(t){var e=this.nsps[t];if(!e){e=new o(this,t),this.nsps[t]=e;var i=this;e.on("connect",function(){e.id=i.engine.id,~u(i.connected,e)||i.connected.push(e)})}return e},n.prototype.destroy=function(t){var e=u(this.connected,t);~e&&this.connected.splice(e,1),this.connected.length||this.close()},n.prototype.packet=function(t){h("writing packet %j",t);var e=this;e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(t){for(var i=0;i<t.length;i++)e.engine.write(t[i]);e.encoding=!1,e.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},n.prototype.cleanup=function(){for(var t;t=this.subs.shift();)t.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){h("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();h("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(h("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(h("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(h("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(t,e,i){function n(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}e.exports=n},{}],5:[function(t,e,i){function n(t,e){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=t("socket.io-parser"),o=t("component-emitter"),s=t("to-array"),c=t("./on"),a=t("component-bind"),l=t("debug")("socket.io-client:socket"),h=t("has-binary");e.exports=i=n;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},d=o.prototype.emit;o(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[c(t,"open",a(this,"onopen")),c(t,"packet",a(this,"onpacket")),c(t,"close",a(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},n.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){if(u.hasOwnProperty(t))return d.apply(this,arguments),this;var e=s(arguments),i=r.EVENT;h(e)&&(i=r.BINARY_EVENT);var n={type:i,data:e};return"function"==typeof e[e.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){l("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},n.prototype.onclose=function(t){l("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){if(t.nsp==this.nsp)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(t);break;case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:this.onack(t);break;case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];l("emitting event %j",e),null!=t.id&&(l("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?d.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var n=s(arguments);l("sending ack %j",n);var o=h(n)?r.BINARY_ACK:r.ACK;e.packet({type:o,id:t,data:n})}}},n.prototype.onack=function(t){l("calling ack %s with %j",t.id,t.data);var e=this.acks[t.id];e.apply(this,t.data),delete this.acks[t.id]},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)d.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(t,e,i){(function(i){function n(t,e){var n=t,e=e||i.location;return null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?e.protocol+t:e.hostname+t),/^(https?|wss?):\/\//.test(t)||(o("protocol-less url %s",t),t="undefined"!=typeof e?e.protocol+"//"+t:"https://"+t),o("parse %s",t),n=r(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(e&&e.port==n.port?"":":"+n.port),n}var r=t("parseuri"),o=t("debug")("socket.io-client:url");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(t,e,i){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},{}],8:[function(t,e,i){var n=[].slice;e.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}},{}],9:[function(t,e,i){function n(t){if(t)return r(t)}function r(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){n.off(t,i),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[t];if(!i)return this;if(1==arguments.length)return delete this._callbacks[t],this;for(var n,r=0;r<i.length;r++)if(n=i[r],n===e||n.fn===e){i.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks[t];if(i){i=i.slice(0);for(var n=0,r=i.length;n<r;++n)i[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],10:[function(t,e,i){function n(t){return n.enabled(t)?function(e){e=r(e);var i=new Date,o=i-(n[t]||i);n[t]=i,e=t+" "+e+" +"+n.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function r(t){return t instanceof Error?t.stack||t.message:t}e.exports=n,n.names=[],n.skips=[],n.enable=function(t){try{localStorage.debug=t}catch(t){}for(var e=(t||"").split(/[\s,]+/),i=e.length,r=0;r<i;r++)t=e[r].replace("*",".*?"),"-"===t[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$"))},n.disable=function(){n.enable("")},n.humanize=function(t){var e=1e3,i=6e4,n=60*i;return t>=n?(t/n).toFixed(1)+"h":t>=i?(t/i).toFixed(1)+"m":t>=e?(t/e|0)+"s":t+"ms"},n.enabled=function(t){for(var e=0,i=n.skips.length;e<i;e++)if(n.skips[e].test(t))return!1;for(var e=0,i=n.names.length;e<i;e++)if(n.names[e].test(t))return!0;return!1};try{window.localStorage&&n.enable(localStorage.debug)}catch(t){}},{}],11:[function(t,e,i){e.exports=t("./lib/")},{"./lib/":12}],12:[function(t,e,i){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(t,e,i){(function(i){function n(t,e){if(!(this instanceof n))return new n(t,e);if(e=e||{},t&&"object"==typeof t&&(e=t,t=null),t&&(t=h(t),e.host=t.host,e.secure="https"==t.protocol||"wss"==t.protocol,e.port=t.port,t.query&&(e.query=t.query)),this.secure=null!=e.secure?e.secure:i.location&&"https:"==location.protocol,e.host){var r=e.host.split(":");e.hostname=r.shift(),r.length?e.port=r.pop():e.port||(e.port=this.secure?"443":"80")}this.agent=e.agent||!1,this.hostname=e.hostname||(i.location?location.hostname:"localhost"),this.port=e.port||(i.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized||null,this.open()}function r(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var o=t("./transports"),s=t("component-emitter"),c=t("debug")("engine.io-client:socket"),a=t("indexof"),l=t("engine.io-parser"),h=t("parseuri"),u=t("parsejson"),d=t("parseqs");e.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=l.protocol,n.Socket=n,n.Transport=t("./transport"),n.transports=t("./transports"),n.parser=t("engine.io-parser"),n.prototype.createTransport=function(t){c('creating transport "%s"',t);var e=r(this.query);e.EIO=l.protocol,e.transport=t,this.id&&(e.sid=this.id);var i=new o[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return i},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)t="websocket";else{if(0==this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";var t;try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){c("setting transport %s",t.name);var e=this;this.transport&&(c("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(d.onlyBinaryUpgrades){var e=!this.supportsBinary&&d.transport.supportsBinary;u=u||e}u||(c('probe transport "%s" opened',t),h.send([{type:"ping",data:"probe"}]),h.once("packet",function(e){if(!u)if("pong"==e.type&&"probe"==e.data){if(c('probe transport "%s" pong',t),d.upgrading=!0,d.emit("upgrading",h),!h)return;n.priorWebsocketSuccess="websocket"==h.name,c('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){u||"closed"!=d.readyState&&(c("changing transport and sending upgrade packet"),l(),d.setTransport(h),h.send([{type:"upgrade"}]),d.emit("upgrade",h),h=null,d.upgrading=!1,d.flush())})}else{c('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=h.name,d.emit("upgradeError",i)}}))}function i(){u||(u=!0,l(),h.close(),h=null)}function r(e){var n=new Error("probe error: "+e);n.transport=h.name,i(),c('probe transport "%s" failed because of error: %s',t,e),d.emit("upgradeError",n)}function o(){r("transport closed")}function s(){r("socket closed")}function a(t){h&&t.name!=h.name&&(c('"%s" works - aborting "%s"',t.name,h.name),i())}function l(){h.removeListener("open",e),h.removeListener("error",r),h.removeListener("close",o),d.removeListener("close",s),d.removeListener("upgrading",a)}c('probing transport "%s"',t);var h=this.createTransport(t,{probe:1}),u=!1,d=this;n.priorWebsocketSuccess=!1,h.once("open",e),h.once("error",r),h.once("close",o),this.once("close",s),this.once("upgrading",a),h.open()},n.prototype.onOpen=function(){if(c("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){c("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"==this.readyState||"open"==this.readyState)switch(c('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(u(t.data));break;case"pong":this.setPing();break;case"error":var e=new Error("server error");e.code=t.data,this.emit("error",e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else c('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!=e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){c("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){this.sendPacket("ping")},n.prototype.onDrain=function(){for(var t=0;t<this.prevBufferLen;t++)this.callbackBuffer[t]&&this.callbackBuffer[t]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(c("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e){return this.sendPacket("message",t,e),this},n.prototype.sendPacket=function(t,e,i){if("closing"!=this.readyState&&"closed"!=this.readyState){var n={type:t,data:e};this.emit("packetCreate",n),this.writeBuffer.push(n),this.callbackBuffer.push(i),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),c("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function i(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},n.prototype.onError=function(t){c("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){c('socket close with reason: "%s"',t);var i=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){i.writeBuffer=[],i.callbackBuffer=[],i.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e)}},n.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~a(this.transports,t[i])&&e.push(t[i]);return e}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(t,e,i){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized}var r=t("engine.io-parser"),o=t("component-emitter");e.exports=n,o(n.prototype),n.timestamps=0,n.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},n.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!=this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(t,e,i){(function(e){function n(t){var i,n=!1,c=!1,a=!1!==t.jsonp;if(e.location){var l="https:"==location.protocol,h=location.port;h||(h=l?443:80),n=t.hostname!=location.hostname||h!=t.port,c=t.secure!=l}if(t.xdomain=n,t.xscheme=c,i=new r(t),"open"in i&&!t.forceJSONP)return new o(t);if(!a)throw new Error("JSONP disabled");return new s(t)}var r=t("xmlhttprequest"),o=t("./polling-xhr"),s=t("./polling-jsonp"),c=t("./websocket");i.polling=n,i.websocket=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(t,e,i){(function(i){function n(){}function r(t){o.call(this,t),this.query=this.query||{},c||(i.___eio||(i.___eio=[]),c=i.___eio),this.index=c.length;var e=this;c.push(function(t){e.onData(t)}),this.query.j=this.index,i.document&&i.addEventListener&&i.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=n)},!1)}var o=t("./polling"),s=t("component-inherit");e.exports=r;var c,a=/\n/g,l=/\\n/g;s(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i),this.script=e;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},r.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(t){o=document.createElement("iframe"),o.name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,s=document.createElement("form"),c=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),c.name="d",s.appendChild(c),document.body.appendChild(s),this.form=s,this.area=c}this.form.action=this.uri(),n(),t=t.replace(l,"\\\n"),this.area.value=t.replace(a,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==r.iframe.readyState&&i()}:this.iframe.onload=i}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(t,e,i){(function(i){function n(){}function r(t){if(a.call(this,t),i.location){var e="https:"==location.protocol,n=location.port;n||(n=e?443:80),this.xd=t.hostname!=i.location.hostname||n!=t.port,this.xs=t.secure!=e}}function o(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.create()}function s(){for(var t in o.requests)o.requests.hasOwnProperty(t)&&o.requests[t].abort()}var c=t("xmlhttprequest"),a=t("./polling"),l=t("component-emitter"),h=t("component-inherit"),u=t("debug")("engine.io-client:polling-xhr");e.exports=r,e.exports.Request=o,h(r,a),r.prototype.supportsBinary=!0,r.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,new o(t)},r.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:i}),r=this;n.on("success",e),n.on("error",function(t){r.onError("xhr post error",t)}),this.sendXhr=n},r.prototype.doPoll=function(){u("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},l(o.prototype),o.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new c(t),n=this;try{if(u("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async),this.supportsBinary&&(e.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){4==e.readyState&&(200==e.status||1223==e.status?n.onLoad():setTimeout(function(){n.onError(e.status)},0))},u("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout(function(){n.onError(t)},0)}i.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},o.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},o.prototype.cleanup=function(t){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(t){}i.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(t){}t="application/octet-stream"===e?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return"undefined"!=typeof i.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},i.document&&(o.requestsCount=0,o.requests={},i.attachEvent?i.attachEvent("onunload",s):i.addEventListener&&i.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(t,e,i){function n(t){var e=t&&t.forceBase64;l&&!e||(this.supportsBinary=!1),r.call(this,t)}var r=t("../transport"),o=t("parseqs"),s=t("engine.io-parser"),c=t("component-inherit"),a=t("debug")("engine.io-client:polling");e.exports=n;var l=function(){var e=t("xmlhttprequest"),i=new e({xdomain:!1});return null!=i.responseType}();c(n,r),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){a("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(a("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){a("pre-pause polling complete"),--n||e()})),this.writable||(a("we are currently writing - waiting to pause"),n++,this.once("drain",function(){a("pre-pause writing complete"),--n||e()}))}else e()},n.prototype.poll=function(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var e=this;a("polling got data %s",t);var i=function(t,i,n){return"opening"==e.readyState&&e.onOpen(),"close"==t.type?(e.onClose(),!1):void e.onPacket(t)};s.decodePayload(t,this.socket.binaryType,i),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){a("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")},e=this;s.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=+new Date+"-"+r.timestamps++),this.supportsBinary||t.sid||(t.b64=1),t=o.encode(t),this.port&&("https"==e&&443!=this.port||"http"==e&&80!=this.port)&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+this.hostname+i+this.path+t}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(t,e,i){function n(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),r.call(this,t)}var r=t("../transport"),o=t("engine.io-parser"),s=t("parseqs"),c=t("component-inherit"),a=t("debug")("engine.io-client:websocket"),l=t("ws");e.exports=n,c(n,r),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,i={agent:this.agent};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.ws=new l(t,e,i),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(t){var e=this;setTimeout(function(){r.prototype.onData.call(e,t)},0)}),n.prototype.write=function(t){function e(){i.writable=!0,i.emit("drain")}var i=this;this.writable=!1;for(var n=0,r=t.length;n<r;n++)o.encodePacket(t[n],this.supportsBinary,function(t){try{i.ws.send(t)}catch(t){a("websocket closed before onclose event")}});setTimeout(e,0)},n.prototype.onClose=function(){r.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=+new Date),this.supportsBinary||(t.b64=1),t=s.encode(t),t.length&&(t="?"+t),e+"://"+this.hostname+i+this.path+t},n.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===n.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(t,e,i){var n=t("has-cors");e.exports=function(t){var e=t.xdomain,i=t.xscheme,r=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!i&&r)return new XDomainRequest}catch(t){}if(!e)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}},{"has-cors":40}],21:[function(t,e,i){e.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],22:[function(t,e,i){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),!e)return t;var n="color: "+this.color;t=[t[0],n,"color: inherit"].concat(Array.prototype.slice.call(t,1));var r=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%"!==t&&(r++,"%c"===t&&(o=r))}),t.splice(o,0,n),t}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?localStorage.removeItem("debug"):localStorage.debug=t}catch(t){}}function c(){var t;try{t=localStorage.debug}catch(t){}return t}i=e.exports=t("./debug"),i.log=o,i.formatArgs=r,i.save=s,i.load=c,i.useColors=n,i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(t){return JSON.stringify(t)},i.enable(c())},{"./debug":23}],23:[function(t,e,i){function n(){return i.colors[h++%i.colors.length]}function r(t){function e(){}function r(){var t=r,e=+new Date,o=e-(l||e);t.diff=o,t.prev=l,t.curr=e,l=e,null==t.useColors&&(t.useColors=i.useColors()),null==t.color&&t.useColors&&(t.color=n());var s=Array.prototype.slice.call(arguments);s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,n){if("%"===e)return e;c++;var r=i.formatters[n];if("function"==typeof r){var o=s[c];e=r.call(t,o),s.splice(c,1),c--}return e}),"function"==typeof i.formatArgs&&(s=i.formatArgs.apply(t,s));var a=r.log||i.log||console.log.bind(console);a.apply(t,s)}e.enabled=!1,r.enabled=!0;var o=i.enabled(t)?r:e;return o.namespace=t,o}function o(t){i.save(t);for(var e=(t||"").split(/[\s,]+/),n=e.length,r=0;r<n;r++)e[r]&&(t=e[r].replace(/\*/g,".*?"),"-"===t[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")))}function s(){i.enable("")}function c(t){var e,n;for(e=0,n=i.skips.length;e<n;e++)if(i.skips[e].test(t))return!1;for(e=0,n=i.names.length;e<n;e++)if(i.names[e].test(t))return!0;return!1}function a(t){return t instanceof Error?t.stack||t.message:t}i=e.exports=r,i.coerce=a,i.disable=s,i.enable=o,i.enabled=c,i.humanize=t("ms"),i.names=[],i.skips=[],i.formatters={};var l,h=0},{ms:24}],24:[function(t,e,i){function n(t){var e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"y":return i*u;case"days":case"day":case"d":return i*h;case"hours":case"hour":case"h":return i*l;case"minutes":case"minute":case"m":return i*a;case"seconds":case"second":case"s":return i*c;case"ms":return i}}}function r(t){return t>=h?Math.round(t/h)+"d":t>=l?Math.round(t/l)+"h":t>=a?Math.round(t/a)+"m":t>=c?Math.round(t/c)+"s":t+"ms"}function o(t){return s(t,h,"day")||s(t,l,"hour")||s(t,a,"minute")||s(t,c,"second")||t+" ms"}function s(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var c=1e3,a=60*c,l=60*a,h=24*l,u=365.25*h;e.exports=function(t,e){return e=e||{},"string"==typeof t?n(t):e.long?o(t):r(t)}},{}],25:[function(t,e,i){(function(e){function n(t,e){var n="b"+i.packets[t.type]+t.data.data;return e(n)}function r(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=g[t.type];for(var c=0;c<o.length;c++)s[c+1]=o[c];return n(s.buffer)}function o(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var r=new FileReader;return r.onload=function(){t.data=r.result,i.encodePacket(t,e,!0,n)},r.readAsArrayBuffer(t.data)}function s(t,e,n){if(!e)return i.encodeBase64Packet(t,n);if(m)return o(t,e,n);var r=new Uint8Array(1);r[0]=g[t.type];var s=new T([r.buffer,t.data]);return n(s)}function c(t,e,i){for(var n=new Array(t.length),r=d(t.length,i),o=function(t,i,r){e(i,function(e,i){n[t]=i,r(e,n)})},s=0;s<t.length;s++)o(s,t[s],r)}var a=t("./keys"),l=t("has-binary"),h=t("arraybuffer.slice"),u=t("base64-arraybuffer"),d=t("after"),_=t("utf8"),p=navigator.userAgent.match(/Android/i),f=/PhantomJS/i.test(navigator.userAgent),m=p||f;i.protocol=3;var g=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=a(g),v={type:"error",data:"parser error"},T=t("blob");i.encodePacket=function(t,i,o,c){"function"==typeof i&&(c=i,i=!1),"function"==typeof o&&(c=o,o=null);var a=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer)return r(t,i,c);if(T&&a instanceof e.Blob)return s(t,i,c);if(a&&a.base64)return n(t,c);var l=g[t.type];return void 0!==t.data&&(l+=o?_.encode(String(t.data)):String(t.data)),c(""+l)},i.encodeBase64Packet=function(t,n){var r="b"+i.packets[t.type];if(T&&t.data instanceof T){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];n(r+t)},o.readAsDataURL(t.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var c=new Uint8Array(t.data),a=new Array(c.length),l=0;l<c.length;l++)a[l]=c[l];s=String.fromCharCode.apply(null,a)}return r+=e.btoa(s),n(r)},i.decodePacket=function(t,e,n){if("string"==typeof t||void 0===t){if("b"==t.charAt(0))return i.decodeBase64Packet(t.substr(1),e);if(n)try{t=_.decode(t)}catch(t){return v}var r=t.charAt(0);return Number(r)==r&&y[r]?t.length>1?{type:y[r],data:t.substring(1)}:{type:y[r]}:v}var o=new Uint8Array(t),r=o[0],s=h(t,1);return T&&"blob"===e&&(s=new T([s])),{type:y[r],data:s}},i.decodeBase64Packet=function(t,i){var n=y[t.charAt(0)];if(!e.ArrayBuffer)return{type:n,data:{base64:!0,data:t.substr(1)}};var r=u.decode(t.substr(1));return"blob"===i&&T&&(r=new T([r])),{type:n,data:r}},i.encodePayload=function(t,e,n){function r(t){return t.length+":"+t}function o(t,n){i.encodePacket(t,!!s&&e,!0,function(t){n(null,r(t))})}"function"==typeof e&&(n=e,e=null);var s=l(t);return e&&s?T&&!m?i.encodePayloadAsBlob(t,n):i.encodePayloadAsArrayBuffer(t,n):t.length?void c(t,o,function(t,e){return n(e.join(""))}):n("0:")},i.decodePayload=function(t,e,n){if("string"!=typeof t)return i.decodePayloadAsBinary(t,e,n);"function"==typeof e&&(n=e,e=null);var r;if(""==t)return n(v,0,1);for(var o,s,c="",a=0,l=t.length;a<l;a++){var h=t.charAt(a);if(":"!=h)c+=h;else{if(""==c||c!=(o=Number(c)))return n(v,0,1);if(s=t.substr(a+1,o),c!=s.length)return n(v,0,1);if(s.length){if(r=i.decodePacket(s,e,!0),v.type==r.type&&v.data==r.data)return n(v,0,1);var u=n(r,a+o,l);if(!1===u)return}a+=o,c=""}}return""!=c?n(v,0,1):void 0},i.encodePayloadAsArrayBuffer=function(t,e){function n(t,e){i.encodePacket(t,!0,!0,function(t){return e(null,t)})}return t.length?void c(t,n,function(t,i){var n=i.reduce(function(t,e){var i;return i="string"==typeof e?e.length:e.byteLength,t+i.toString().length+i+2},0),r=new Uint8Array(n),o=0;return i.forEach(function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);i=n.buffer}e?r[o++]=0:r[o++]=1;for(var c=i.byteLength.toString(),s=0;s<c.length;s++)r[o++]=parseInt(c[s]);r[o++]=255;for(var n=new Uint8Array(i),s=0;s<n.length;s++)r[o++]=n[s]}),e(r.buffer)}):e(new ArrayBuffer(0))},i.encodePayloadAsBlob=function(t,e){function n(t,e){i.encodePacket(t,!0,!0,function(t){var i=new Uint8Array(1);if(i[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);t=n.buffer,i[0]=0}for(var o=t instanceof ArrayBuffer?t.byteLength:t.size,s=o.toString(),c=new Uint8Array(s.length+1),r=0;r<s.length;r++)c[r]=parseInt(s[r]);if(c[s.length]=255,T){var a=new T([i.buffer,c.buffer,t]);e(null,a)}})}c(t,n,function(t,i){return e(new T(i))})},i.decodePayloadAsBinary=function(t,e,n){"function"==typeof e&&(n=e,e=null);for(var r=t,o=[],s=!1;r.byteLength>0;){for(var c=new Uint8Array(r),a=0===c[0],l="",u=1;255!=c[u];u++){if(l.length>310){s=!0;break}l+=c[u]}if(s)return n(v,0,1);r=h(r,2+l.length),l=parseInt(l);var d=h(r,0,l);if(a)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(t){var _=new Uint8Array(d);d="";for(var u=0;u<_.length;u++)d+=String.fromCharCode(_[u])}o.push(d),r=h(r,l)}var p=o.length;o.forEach(function(t,r){n(i.decodePacket(t,e,!0),r,p)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(t,e,i){e.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},{}],27:[function(t,e,i){function n(t,e,i){function n(t,r){if(n.count<=0)throw new Error("after called too many times");--n.count,t?(o=!0,e(t),e=i):0!==n.count||o||e(null,r)}var o=!1;return i=i||r,n.count=t,0===t?e():n}function r(){}e.exports=n},{}],28:[function(t,e,i){e.exports=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-e),s=e,c=0;s<i;s++,c++)o[c]=r[s];return o.buffer}},{}],29:[function(t,e,i){!function(t){"use strict";i.encode=function(e){var i,n=new Uint8Array(e),r=n.length,o="";for(i=0;i<r;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},i.decode=function(e){var i,n,r,o,s,c=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var h=new ArrayBuffer(c),u=new Uint8Array(h);for(i=0;i<a;i+=4)n=t.indexOf(e[i]),r=t.indexOf(e[i+1]),o=t.indexOf(e[i+2]),s=t.indexOf(e[i+3]),u[l++]=n<<2|r>>4,u[l++]=(15&r)<<4|o>>2,u[l++]=(3&o)<<6|63&s;return h}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(t,e,i){(function(t){function i(t,e){e=e||{};for(var i=new n,r=0;r<t.length;r++)i.append(t[r]);return e.type?i.getBlob(e.type):i.getBlob()}var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,r=function(){try{var t=new Blob(["hi"]);return 2==t.size}catch(t){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;e.exports=function(){return r?t.Blob:o?i:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,e,i){(function(i){function n(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(r(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var o in t)if(t.hasOwnProperty(o)&&e(t[o]))return!0}return!1}return e(t)}var r=t("isarray");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(t,e,i){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],33:[function(e,i,n){(function(e){!function(r){function o(t){for(var e,i,n=[],r=0,o=t.length;r<o;)e=t.charCodeAt(r++),e>=55296&&e<=56319&&r<o?(i=t.charCodeAt(r++),56320==(64512&i)?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--)):n.push(e);return n}function s(t){for(var e,i=t.length,n=-1,r="";++n<i;)e=t[n],e>65535&&(e-=65536,r+=v(e>>>10&1023|55296),e=56320|1023&e),r+=v(e);return r}function c(t,e){return v(t>>e&63|128)}function a(t){if(0==(4294967168&t))return v(t);var e="";return 0==(4294965248&t)?e=v(t>>6&31|192):0==(4294901760&t)?(e=v(t>>12&15|224),e+=c(t,6)):0==(4292870144&t)&&(e=v(t>>18&7|240),e+=c(t,12),e+=c(t,6)),e+=v(63&t|128)}function l(t){for(var e,i=o(t),n=i.length,r=-1,s="";++r<n;)e=i[r],s+=a(e);return s}function h(){if(y>=g)throw Error("Invalid byte index");var t=255&m[y];if(y++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function u(){var t,e,i,n,r;if(y>g)throw Error("Invalid byte index");if(y==g)return!1;if(t=255&m[y],y++,0==(128&t))return t;if(192==(224&t)){var e=h();if(r=(31&t)<<6|e,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if(e=h(),i=h(),r=(15&t)<<12|e<<6|i,r>=2048)return r;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=h(),i=h(),n=h(),r=(15&t)<<18|e<<12|i<<6|n,r>=65536&&r<=1114111))return r;throw Error("Invalid UTF-8 detected")}function d(t){m=o(t),g=m.length,y=0;for(var e,i=[];(e=u())!==!1;)i.push(e);return s(i)}var _="object"==typeof n&&n,p="object"==typeof i&&i&&i.exports==_&&i,f="object"==typeof e&&e;f.global!==f&&f.window!==f||(r=f);var m,g,y,v=String.fromCharCode,T={version:"2.0.0",encode:l,decode:d};if("function"==typeof t&&"object"==typeof t.amd&&t.amd)t(function(){return T});else if(_&&!_.nodeType)if(p)p.exports=T;else{var C={},S=C.hasOwnProperty;for(var x in T)S.call(T,x)&&(_[x]=T[x])}else r.utf8=T}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(t,e,i){(function(t){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,c=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(c,""),t.JSON&&JSON.parse?JSON.parse(e):i.test(e.replace(n,"@").replace(r,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(t,e,i){i.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},i.decode=function(t){for(var e={},i=t.split("&"),n=0,r=i.length;n<r;n++){var o=i[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},{}],36:[function(t,e,i){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){var e=t,i=t.indexOf("["),o=t.indexOf("]");i!=-1&&o!=-1&&(t=t.substring(0,i)+t.substring(i,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=n.exec(t||""),c={},a=14;a--;)c[r[a]]=s[a]||"";return i!=-1&&o!=-1&&(c.source=e,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c}},{}],37:[function(t,e,i){function n(t,e,i){var n;return n=e?new o(t,e):new o(t)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket;e.exports=o?n:null,o&&(n.prototype=o.prototype)},{}],38:[function(t,e,i){(function(i){function n(t){function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(r(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0}return!1}return e(t)}var r=t("isarray");e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(t,e,i){e.exports=t(32)},{}],40:[function(t,e,i){var n=t("global");try{e.exports="XMLHttpRequest"in n&&"withCredentials"in new n.XMLHttpRequest}catch(t){e.exports=!1}},{global:41}],41:[function(t,e,i){e.exports=function(){return this}()},{}],42:[function(t,e,i){var n=[].indexOf;e.exports=function(t,e){if(n)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1}},{}],43:[function(t,e,i){var n=Object.prototype.hasOwnProperty;i.keys=Object.keys||function(t){var e=[];for(var i in t)n.call(t,i)&&e.push(i);return e},i.values=function(t){var e=[];for(var i in t)n.call(t,i)&&e.push(t[i]);return e},i.merge=function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);return t},i.length=function(t){return i.keys(t).length},i.isEmpty=function(t){return 0==i.length(t)}},{}],44:[function(t,e,i){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(t){for(var e=n.exec(t||""),i={},o=14;o--;)i[r[o]]=e[o]||"";return i}},{}],45:[function(t,e,i){(function(e){var n=t("isarray"),r=t("./is-buffer");i.deconstructPacket=function(t){function e(t){if(!t)return t;if(r(t)){var o={_placeholder:!0,num:i.length};return i.push(t),o}if(n(t)){for(var s=new Array(t.length),c=0;c<t.length;c++)s[c]=e(t[c]);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var a in t)s[a]=e(t[a]);return s}return t}var i=[],o=t.data,s=t;return s.data=e(o),s.attachments=i.length,{packet:s,buffers:i}},i.reconstructPacket=function(t,e){function i(t){if(t&&t._placeholder){var r=e[t.num];return r}if(n(t)){for(var o=0;o<t.length;o++)t[o]=i(t[o]);return t}if(t&&"object"==typeof t){for(var s in t)t[s]=i(t[s]);return t}return t}return t.data=i(t.data),t.attachments=void 0,t},i.removeBlobs=function(t,i){function o(t,a,l){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){s++;var h=new FileReader;h.onload=function(){l?l[a]=this.result:c=this.result,--s||i(c)},h.readAsArrayBuffer(t)}else if(n(t))for(var u=0;u<t.length;u++)o(t[u],u,t);else if(t&&"object"==typeof t&&!r(t))for(var d in t)o(t[d],d,t)}var s=0,c=t;o(c),s||i(c)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(t,e,i){function n(){}function r(t){var e="",n=!1;return e+=t.type,i.BINARY_EVENT!=t.type&&i.BINARY_ACK!=t.type||(e+=t.attachments,e+="-"),t.nsp&&"/"!=t.nsp&&(n=!0,e+=t.nsp),null!=t.id&&(n&&(e+=",",n=!1),e+=t.id),null!=t.data&&(n&&(e+=","),e+=u.stringify(t.data)),h("encoded %j as %s",t,e),e}function o(t,e){function i(t){var i=_.deconstructPacket(t),n=r(i.packet),o=i.buffers;o.unshift(n),e(o)}_.removeBlobs(t,i)}function s(){this.reconstructor=null}function c(t){var e={},n=0;if(e.type=Number(t.charAt(0)),null==i.types[e.type])return l();if(i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type){for(var r="";"-"!=t.charAt(++n)&&(r+=t.charAt(n),n!=t.length););if(r!=Number(r)||"-"!=t.charAt(n))throw new Error("Illegal attachments");e.attachments=Number(r)}if("/"==t.charAt(n+1))for(e.nsp="";++n;){var o=t.charAt(n);if(","==o)break;if(e.nsp+=o,n==t.length)break}else e.nsp="/";var s=t.charAt(n+1);if(""!==s&&Number(s)==s){for(e.id="";++n;){var o=t.charAt(n);if(null==o||Number(o)!=o){--n;break}if(e.id+=t.charAt(n),n==t.length)break}e.id=Number(e.id)}if(t.charAt(++n))try{e.data=u.parse(t.substr(n))}catch(t){return l()}return h("decoded %s as %j",t,e),e}function a(t){this.reconPack=t,this.buffers=[]}function l(t){return{type:i.ERROR,data:"parser error"}}var h=t("debug")("socket.io-parser"),u=t("json3"),d=(t("isarray"),t("component-emitter")),_=t("./binary"),p=t("./is-buffer");i.protocol=4,i.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],i.CONNECT=0,i.DISCONNECT=1,i.EVENT=2,i.ACK=3,i.ERROR=4,i.BINARY_EVENT=5,i.BINARY_ACK=6,i.Encoder=n,i.Decoder=s,n.prototype.encode=function(t,e){if(h("encoding packet %j",t),i.BINARY_EVENT==t.type||i.BINARY_ACK==t.type)o(t,e);else{var n=r(t);e([n])}},d(s.prototype),s.prototype.add=function(t){var e;if("string"==typeof t)e=c(t),i.BINARY_EVENT==e.type||i.BINARY_ACK==e.type?(this.reconstructor=new a(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!p(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,this.emit("decoded",e))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=_.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(t,e,i){(function(t){function i(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(t,e,i){e.exports=t(32)},{}],49:[function(e,i,n){!function(e){function i(t){if(i[t]!==s)return i[t];var e;if("bug-string-char-index"==t)e="a"!="a"[0];else if("json"==t)e=i("json-stringify")&&i("json-parse");else{var n,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==t){var o=h.stringify,a="function"==typeof o&&u;if(a){(n=function(){return 1}).toJSON=n;try{a="0"===o(0)&&"0"===o(new Number)&&'""'==o(new String)&&o(c)===s&&o(s)===s&&o()===s&&"1"===o(n)&&"[1]"==o([n])&&"[null]"==o([s])&&"null"==o(null)&&"[null,null,null]"==o([s,c,null])&&o({a:[n,!0,!1,null,"\0\b\n\f\r\t"]})==r&&"1"===o(null,n)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new Date(-1))}catch(t){a=!1}}e=a}if("json-parse"==t){var l=h.parse;if("function"==typeof l)try{if(0===l("0")&&!l(!1)){n=l(r);var d=5==n.a.length&&1===n.a[0];if(d){try{d=!l('"\t"')}catch(t){}if(d)try{d=1!==l("01")}catch(t){}if(d)try{d=1!==l("1.")}catch(t){}}}}catch(t){d=!1}e=d}}return i[t]=!!e}var r,o,s,c={}.toString,a="function"==typeof t&&t.amd,l="object"==typeof JSON&&JSON,h="object"==typeof n&&n&&!n.nodeType&&n;h&&l?(h.stringify=l.stringify,h.parse=l.parse):h=e.JSON=l||{};var u=new Date(-0xc782b5b800cec);try{u=u.getUTCFullYear()==-109252&&0===u.getUTCMonth()&&1===u.getUTCDate()&&10==u.getUTCHours()&&37==u.getUTCMinutes()&&6==u.getUTCSeconds()&&708==u.getUTCMilliseconds()}catch(t){}if(!i("json")){var d="[object Function]",_="[object Date]",p="[object Number]",f="[object String]",m="[object Array]",g="[object Boolean]",y=i("bug-string-char-index");if(!u)var v=Math.floor,T=[0,31,59,90,120,151,181,212,243,273,304,334],C=function(t,e){return T[e]+365*(t-1970)+v((t-1969+(e=+(e>1)))/4)-v((t-1901+e)/100)+v((t-1601+e)/400)};(r={}.hasOwnProperty)||(r=function(t){var e,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=c?r=function(t){var e=this.__proto__,i=t in(this.__proto__=null,this);return this.__proto__=e,i}:(e=i.constructor,r=function(t){var i=(this.constructor||e).prototype;return t in this&&!(t in i&&this[t]===i[t])}),i=null,r.call(this,t)});var S={boolean:1,number:1,string:1,undefined:1},x=function(t,e){var i=typeof t[e];return"object"==i?!!t[e]:!S[i]};if(o=function(t,e){var i,n,s,a=0;(i=function(){this.valueOf=0}).prototype.valueOf=0,n=new i;for(s in n)r.call(n,s)&&a++;return i=n=null,a?o=2==a?function(t,e){var i,n={},o=c.call(t)==d;for(i in t)o&&"prototype"==i||r.call(n,i)||!(n[i]=1)||!r.call(t,i)||e(i)}:function(t,e){var i,n,o=c.call(t)==d;for(i in t)o&&"prototype"==i||!r.call(t,i)||(n="constructor"===i)||e(i);(n||r.call(t,i="constructor"))&&e(i)}:(n=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],o=function(t,e){var i,o,s=c.call(t)==d,a=!s&&"function"!=typeof t.constructor&&x(t,"hasOwnProperty")?t.hasOwnProperty:r;for(i in t)s&&"prototype"==i||!a.call(t,i)||e(i);for(o=n.length;i=n[--o];a.call(t,i)&&e(i));}),o(t,e)},!i("json-stringify")){var A={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},E="000000",b=function(t,e){return(E+(e||0)).slice(-t)},R="\\u00",P=function(t){var e,i='"',n=0,r=t.length,o=r>10&&y;for(o&&(e=t.split(""));n<r;n++){var s=t.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:i+=A[s];break;default:if(s<32){i+=R+b(2,s.toString(16));break}i+=o?e[n]:y?t.charAt(n):t[n]}}return i+'"'},w=function(t,e,i,n,a,l,h){var u,d,y,T,S,x,A,E,R,I,D,L,O,B,N,F;try{u=e[t]}catch(t){}if("object"==typeof u&&u)if(d=c.call(u),d!=_||r.call(u,"toJSON"))"function"==typeof u.toJSON&&(d!=p&&d!=f&&d!=m||r.call(u,"toJSON"))&&(u=u.toJSON(t));else if(u>-1/0&&u<1/0){if(C){for(S=v(u/864e5),y=v(S/365.2425)+1970-1;C(y+1,0)<=S;y++);for(T=v((S-C(y,0))/30.42);C(y,T+1)<=S;T++);S=1+S-C(y,T),x=(u%864e5+864e5)%864e5,A=v(x/36e5)%24,E=v(x/6e4)%60,R=v(x/1e3)%60,I=x%1e3}else y=u.getUTCFullYear(),T=u.getUTCMonth(),S=u.getUTCDate(),A=u.getUTCHours(),E=u.getUTCMinutes(),R=u.getUTCSeconds(),I=u.getUTCMilliseconds();u=(y<=0||y>=1e4?(y<0?"-":"+")+b(6,y<0?-y:y):b(4,y))+"-"+b(2,T+1)+"-"+b(2,S)+"T"+b(2,A)+":"+b(2,E)+":"+b(2,R)+"."+b(3,I)+"Z"}else u=null;if(i&&(u=i.call(e,t,u)),null===u)return"null";if(d=c.call(u),d==g)return""+u;if(d==p)return u>-1/0&&u<1/0?""+u:"null";if(d==f)return P(""+u);if("object"==typeof u){for(B=h.length;B--;)if(h[B]===u)throw TypeError();if(h.push(u),D=[],N=l,l+=a,d==m){for(O=0,B=u.length;O<B;O++)L=w(O,u,i,n,a,l,h),D.push(L===s?"null":L);F=D.length?a?"[\n"+l+D.join(",\n"+l)+"\n"+N+"]":"["+D.join(",")+"]":"[]"}else o(n||u,function(t){var e=w(t,u,i,n,a,l,h);e!==s&&D.push(P(t)+":"+(a?" ":"")+e)}),F=D.length?a?"{\n"+l+D.join(",\n"+l)+"\n"+N+"}":"{"+D.join(",")+"}":"{}";return h.pop(),F}};h.stringify=function(t,e,i){var n,r,o,s;if("function"==typeof e||"object"==typeof e&&e)if((s=c.call(e))==d)r=e;else if(s==m){o={};for(var a,l=0,h=e.length;l<h;a=e[l++],s=c.call(a),(s==f||s==p)&&(o[a]=1));}if(i)if((s=c.call(i))==p){if((i-=i%1)>0)for(n="",i>10&&(i=10);n.length<i;n+=" ");}else s==f&&(n=i.length<=10?i:i.slice(0,10));return w("",(a={},a[""]=t,a),r,o,n,"",[])}}if(!i("json-parse")){var I,D,L=String.fromCharCode,O={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},B=function(){throw I=D=null,SyntaxError()},N=function(){for(var t,e,i,n,r,o=D,s=o.length;I<s;)switch(r=o.charCodeAt(I)){case 9:case 10:case 13:case 32:I++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=y?o.charAt(I):o[I],I++,t;case 34:for(t="@",I++;I<s;)if(r=o.charCodeAt(I),r<32)B();else if(92==r)switch(r=o.charCodeAt(++I)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=O[r],I++;break;case 117:for(e=++I,i=I+4;I<i;I++)r=o.charCodeAt(I),r>=48&&r<=57||r>=97&&r<=102||r>=65&&r<=70||B();t+=L("0x"+o.slice(e,I));break;default:B()}else{if(34==r)break;for(r=o.charCodeAt(I),e=I;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++I);t+=o.slice(e,I)}if(34==o.charCodeAt(I))return I++,t;B();default:if(e=I,45==r&&(n=!0,r=o.charCodeAt(++I)),r>=48&&r<=57){for(48==r&&(r=o.charCodeAt(I+1),r>=48&&r<=57)&&B(),n=!1;I<s&&(r=o.charCodeAt(I),r>=48&&r<=57);I++);if(46==o.charCodeAt(I)){for(i=++I;i<s&&(r=o.charCodeAt(i),r>=48&&r<=57);i++);i==I&&B(),I=i}if(r=o.charCodeAt(I),101==r||69==r){for(r=o.charCodeAt(++I),43!=r&&45!=r||I++,i=I;i<s&&(r=o.charCodeAt(i),r>=48&&r<=57);i++);i==I&&B(),I=i}return+o.slice(e,I)}if(n&&B(),"true"==o.slice(I,I+4))return I+=4,!0;if("false"==o.slice(I,I+5))return I+=5,!1;if("null"==o.slice(I,I+4))return I+=4,null;B()}return"$"},F=function(t){var e,i;if("$"==t&&B(),"string"==typeof t){if("@"==(y?t.charAt(0):t[0]))return t.slice(1);if("["==t){for(e=[];t=N(),"]"!=t;i||(i=!0))i&&(","==t?(t=N(),"]"==t&&B()):B()),","==t&&B(),e.push(F(t));return e}if("{"==t){for(e={};t=N(),"}"!=t;i||(i=!0))i&&(","==t?(t=N(),"}"==t&&B()):B()),","!=t&&"string"==typeof t&&"@"==(y?t.charAt(0):t[0])&&":"==N()||B(),e[t.slice(1)]=F(N());return e}B()}return t},M=function(t,e,i){var n=V(t,e,i);n===s?delete t[e]:t[e]=n},V=function(t,e,i){var n,r=t[e];if("object"==typeof r&&r)if(c.call(r)==m)for(n=r.length;n--;)M(r,n,i);else o(r,function(t){M(r,t,i)});return i.call(t,e,r)};h.parse=function(t,e){var i,n;return I=0,D=""+t,i=F(N()),"$"!=N()&&B(),I=D=null,e&&c.call(e)==d?V((n={},n[""]=i,n),"",e):i}}}a&&t(function(){return h})}(this)},{}],50:[function(t,e,i){function n(t,e){var i=[];e=e||0;for(var n=e||0;n<t.length;n++)i[n-e]=t[n];return i}e.exports=n},{}]},{},[1])(1)});var gaf=gaf||{};gaf.COMPRESSION_NONE=4669766,gaf.COMPRESSION_ZIP=4669763,gaf.IDNONE=4294967295,gaf.FIRST_FRAME_INDEX=0,gaf.EFFECT_DROP_SHADOW=0,gaf.EFFECT_BLUR=1,gaf.EFFECT_GLOW=2,gaf.EFFECT_COLOR_MATRIX=6,gaf.ACTION_STOP=0,gaf.ACTION_PLAY=1,gaf.ACTION_GO_TO_AND_STOP=2,gaf.ACTION_GO_TO_AND_PLAY=3,gaf.ACTION_DISPATCH_EVENT=4,gaf.PI_FRAME=0,gaf.PI_EVENT_TYPE=0,gaf.TYPE_TEXTURE=0,gaf.TYPE_TEXT_FIELD=1,gaf.TYPE_TIME_LINE=2,gaf.UNIFORM_BLUR_TEXEL_OFFSET="u_step",gaf.UNIFORM_GLOW_TEXEL_OFFSET="u_step",gaf.UNIFORM_GLOW_COLOR="u_glowColor",gaf.UNIFORM_ALPHA_TINT_MULT="colorTransformMult",gaf.UNIFORM_ALPHA_TINT_OFFSET="colorTransformOffsets",gaf.UNIFORM_ALPHA_COLOR_MATRIX_BODY="colorMatrix",gaf.UNIFORM_ALPHA_COLOR_MATRIX_APPENDIX="colorMatrix2";var gaf=gaf||{};gaf._tmp=gaf._tmp||{},gaf._initialized=!1,gaf.CCGAFLoader=function(){this.load=function(t,e,i,n){gaf._initialized||gaf._setup();var r=new gaf.Loader;r.LoadFile(t,function(t){n(null,t)})}},gaf._setup=function(){gaf._setupShaders(),gaf._initialized=!0},cc.loader.register(".gaf",new gaf.CCGAFLoader),gaf.CGAffineTransformCocosFormatFromFlashFormat=function(t){var e={};return e.a=t.a,e.b=-t.b,e.c=-t.c,e.d=t.d,e.tx=t.tx,e.ty=-t.ty,e},gaf._AssetPreload=function(){this[0]=this.End,this[1]=this.Atlases,this[2]=this.AnimationMasks,this[3]=this.AnimationObjects,this[4]=this.AnimationFrames,this[5]=this.NamedParts,this[6]=this.Sequences,this[7]=this.TextFields,this[8]=this.Atlases,this[9]=this.Stage,this[10]=this.AnimationObjects,this[11]=this.AnimationMasks,this[12]=this.AnimationFrames,this[13]=this.TimeLine},gaf._AssetPreload.prototype.End=function(t,e,i){i&&(i.getFps=function(){return t.getSceneFps()})},gaf._AssetPreload.prototype.Tag=function(t,e,i){this[e.tagId].call(this,t,e.content,i)},gaf._AssetPreload.prototype.Tags=function(t,e,i){var n=this;e.forEach(function(e){n.Tag(t,e,i)})},gaf._AssetPreload.prototype.AtlasCreateFrames=function(t,e,i){t.forEach(function(t){var n=e._atlases[t.atlasId],r=cc.rect(t.origin.x,t.origin.y,t.size.x,t.size.y),o=new cc.SpriteFrame(n,r);o._gafAnchor={x:0-(0-t.pivot.x/t.size.x),y:0+(1-t.pivot.y/t.size.y)},i[t.elementAtlasId]=o})},gaf._AssetPreload.prototype.Atlases=function(t,e,i){var n=t._atlasScales[e.scale]=t._atlasScales[e.scale]||[],r=cc.Director._getInstance().getContentScaleFactor();e.atlases.forEach(function(i){var o=i.id,s=function(){gaf._AssetPreload.AtlasCreateFrames(e.elements,t,n)},c="";i.sources.forEach(function(t){t.csf===r&&(c=t.source)}),cc.assert(c,"GAF Error. Texture for current CSF not found. Reconvert animation with correct parameters."),t._textureLoadDelegate&&(c=t._textureLoadDelegate(c));for(var a=!1,l=t._getSearchPaths(c),h=0,u=l.length;h<u;++h){var d=l[h],_=cc.textureCache.getTextureForKey(d);if(_&&_.isLoaded()){_.handleLoadedTexture(!0),a=!0,t._atlases[o]=_,s();break}}if(!a){var p=function(e){e.handleLoadedTexture(!0),t._onAtlasLoaded(o,e)},f=function(){cc.log("GAF Error. Couldn't find `"+c+"` required by `"+t.getGAFFileName()+"`")};t._atlasesToLoad.hasOwnProperty(o)||(gaf._AtlasLoader.loadArray(l,p,f),t._atlasesToLoad[o]={}),t._onLoadTasks.push(s)}})},gaf._AssetPreload.prototype.AnimationObjects=function(t,e,i){e.forEach(function(e){e.type=void 0===e.type?gaf.TYPE_TEXTURE:e.type,i._objects.push(e.objectId),t._objects[e.objectId]=e})},gaf._AssetPreload.prototype.convertTint=function(t,e){return t?{mult:{r:255*t.redMultiplier,g:255*t.greenMultiplier,b:255*t.blueMultiplier,a:255*e},offset:{r:255*t.redOffset,g:255*t.greenOffset,b:255*t.blueOffset,a:255*t.alphaOffset}}:null},gaf._AssetPreload.prototype.convertState=function(t){return{hasColorTransform:t.hasColorTransform,hasMask:t.hasMask,hasEffect:t.hasEffect,objectIdRef:t.objectIdRef,depth:t.depth,alpha:255*t.alpha,matrix:gaf.CGAffineTransformCocosFormatFromFlashFormat(t.matrix),colorTransform:this.convertTint(t.colorTransform,t.alpha),effect:t.effect,maskObjectIdRef:t.maskObjectIdRef}},gaf._AssetPreload.prototype.AnimationFrames=function(t,e,i){var n=this;cc.assert(i,"Error. Time Line should not be null.");for(var r={},o=[],s={},c=0,a=e.length;c<a;++c){var l=e[c];l.state&&l.state.forEach(function(t){0!==t.alpha?r[t.objectIdRef]=n.convertState(t):r[t.objectIdRef]=null});var h=[];for(var u in r)r.hasOwnProperty(u)&&r[u]&&h.push(r[u]);s=l,o[l.frame-1]={states:h,actions:l.actions||null}}i.getFrames=function(){return o}},gaf._AssetPreload.prototype.NamedParts=function(t,e,i){var n={};e.forEach(function(t){n[t.name]=t.objectId}),i.getNamedParts=function(){return n}},gaf._AssetPreload.prototype.Sequences=function(t,e,i){var n={};e.forEach(function(t){n[t.id]={start:t.start-1,end:t.end}}),i.getSequences=function(){return n}},gaf._AssetPreload.prototype.TextFields=function(t,e,i){},gaf._AssetPreload.prototype.Stage=function(t,e,i){t._sceneFps=e.fps,t._sceneColor=e.color,t._sceneWidth=e.width,t._sceneHeight=e.height},gaf._AssetPreload.prototype.AnimationMasks=function(t,e,i){e.forEach(function(e){e.type=void 0===e.type?gaf.TYPE_TEXTURE:e.type,i._objects.push(e.objectId),t._masks[e.objectId]=e})},gaf._AssetPreload.prototype.TimeLine=function(t,e,i){var n=new gaf._TimeLineProto(t,e.animationFrameCount,e.boundingBox,e.pivotPoint,e.id,e.linkageName);t._pushTimeLine(n),this.Tags(t,e.tags,n)},gaf._AssetPreload=new gaf._AssetPreload;var gaf=gaf||{};gaf.Asset=cc.Class.extend({_className:"GAFAsset",_header:null,_timeLines:null,_textFields:null,_protos:null,_objects:null,_masks:null,_rootTimeLine:null,_textureLoadDelegate:null,_sceneFps:60,_sceneWidth:0,_sceneHeight:0,_sceneColor:0,_gafData:null,_desiredAtlasScale:1,_usedAtlasScale:0,_atlases:null,_onLoadTasks:null,_atlasScales:null,_textureLoaded:!1,_atlasesToLoad:null,_gafName:null,initWithGAFFile:function(t,e){var i=this;this._textureLoadDelegate=e,this._gafName=t;var n=cc.loader.getRes(t);return n?this._init(n):(cc.loader.load(t,function(t,e){t||i._init(e[0])}),!1)},initWithGAFBundle:function(t,e,i){return cc.assert(!1,"initWithGAFBundle is not yet implemented"),!1},setRootTimelineWithName:function(t){for(var e=0,i=this._timeLines.length;e<i;++e){var n=this._timeLines[e];if(n&&n.getLinkageName()===t)return void this._setRootTimeline(n)}},isAssetVersionPlayable:function(){return!0},desiredAtlasScale:function(){return this._desiredAtlasScale},setDesiredAtlasScale:function(t){this._desiredAtlasScale=t;for(var e in this._atlasScales)this._atlasScales.hasOwnProperty(e)&&(0===this._usedAtlasScale||Math.abs(this._usedAtlasScale-t)>Math.abs(e-t))&&(this._usedAtlasScale=e)},createObject:function(){return this._instantiateGaf(this._gafData)},createObjectAndRun:function(t){cc.assert(1===arguments.length,"GAFAsset::createObjectAndRun should have one param");var e=this._instantiateGaf(this._gafData);return e.setLooped(t,!0),e.start(),e},setTextureLoadDelegate:function(t){},getSceneFps:function(){return this._sceneFps},getSceneWidth:function(){},getSceneHeight:function(){},getSceneColor:function(){},setSceneFps:function(t){this._sceneFps=t},setSceneWidth:function(t){},setSceneHeight:function(t){},setSceneColor:function(t){},getHeader:function(){return this._header},getGAFFileName:function(){return this._gafName},ctor:function(){this._header={},this._timeLines=[],this._textFields=[],this._objects=[],this._masks=[],this._protos=[],this._atlases={},this._onLoadTasks=[],this._atlasScales={},this._atlasesToLoad={},arguments.length>0&&this.initWithGAFFile.apply(this,arguments)},_getProtos:function(){return this._protos},_setRootTimeline:function(t){this._rootTimeLine=t,this._header.pivot=t.getPivot(),this._header.frameSize=t.getRect()},_setHeader:function(t){for(var e in t)t.hasOwnProperty(e)&&(this._header[e]=t[e])},_getMajorVerison:function(){return this._header.versionMajor},_init:function(t){var e=this;this._gafData=t,this._setHeader(t.header),this._timeLinesToLink=[],this._getMajorVerison()<4&&this._pushTimeLine(new gaf._TimeLineProto(this,this._header.framesCount,this._header.frameSize,this._header.pivot)),gaf._AssetPreload.Tags(this,t.tags,this._rootTimeLine),this._objects.forEach(function(t){switch(t.type){case gaf.TYPE_TEXTURE:e._protos[t.objectId]||(e._protos[t.objectId]=new gaf._SpriteProto(e,e._atlasScales,t.elementAtlasIdRef));break;case gaf.TYPE_TIME_LINE:e._protos[t.objectId]=e._timeLines[t.elementAtlasIdRef];break;case gaf.TYPE_TEXT_FIELD:e._protos[t.objectId]=e._textFields[t.elementAtlasIdRef];break;default:cc.log("Unknown object type: "+t.type)}}),this._masks.forEach(function(t){if(!e._protos[t.objectId]){var i=null;switch(t.type){case gaf.TYPE_TEXTURE:i=new gaf._SpriteProto(e,e._atlasScales,t.elementAtlasIdRef);break;case gaf.TYPE_TIME_LINE:i=e._timeLines[t.elementAtlasIdRef];break;case gaf.TYPE_TEXT_FIELD:i=e._textFields[t.elementAtlasIdRef]}e._protos[t.objectId]=new gaf._MaskProto(e,i,t.elementAtlasIdRef)}}),this.setDesiredAtlasScale(this._desiredAtlasScale),0===Object.keys(this._atlasesToLoad).length&&(this._textureLoaded=!0,this.dispatchEvent("load"))},_pushTimeLine:function(t){this._timeLines[t.getId()]=t,0===t.getId()&&this._setRootTimeline(t)},_instantiateGaf:function(){var t=null;return t=this._rootTimeLine._gafConstruct()},_onAtlasLoaded:function(t,e){this._atlases[t]=e,delete this._atlasesToLoad[t],0===Object.keys(this._atlasesToLoad).length&&(this._onLoadTasks.forEach(function(t){t()}),this._onLoadTasks.length=0,this._textureLoaded=!0,this.dispatchEvent("load"))},isLoaded:function(){return this._textureLoaded},_getSearchPaths:function(t){var e=this.getGAFFileName().split("/");e[e.length-1]=t;var i=e.join("/");return[t,i]}}),gaf.Asset.create=function(t,e){return new gaf.Asset(t,e)},gaf.Asset.createWithBundle=function(t,e,i){var n=new gaf.Asset;return n.initWithGAFBundle(t,e,i),n},cc.EventHelper.prototype.apply(gaf.Asset.prototype);var gaf=gaf||{};gaf._stateHasCtx=function(t){if(t.hasColorTransform&&(t.colorTransform.offset.r>0||t.colorTransform.offset.g>0||t.colorTransform.offset.b>0||t.colorTransform.offset.a>0))return!0;if(t.hasEffect)for(var e=0,i=t.effect.length;e<i;++e)if(t.effect[e].type===gaf.EFFECT_COLOR_MATRIX)return!0;return!1},gaf.Object=cc.Node.extend({_asset:null,_className:"GAFObject",_id:gaf.IDNONE,_gafproto:null,_parentTimeLine:null,_lastVisibleInFrame:0,_filterStack:null,_cascadeColorMult:null,_cascadeColorOffset:null,_needsCtx:!1,_usedAtlasScale:1,ctor:function(t){1==arguments.length&&(this._usedAtlasScale=t),this._super(),this._cascadeColorMult=cc.color(255,255,255,255),this._cascadeColorOffset=cc.color(0,0,0,0),this._filterStack=[]},setAnimationStartedNextLoopDelegate:function(t){},setAnimationFinishedPlayDelegate:function(t){},setLooped:function(t){},getBoundingBoxForCurrentFrame:function(){return null},setFps:function(t){},getObjectByName:function(t){return null},clearSequence:function(){},getIsAnimationRunning:function(){return!1},getSequences:function(){return[]},gotoAndStop:function(t){},getStartFrame:function(t){return gaf.IDNONE},setFramePlayedDelegate:function(t){},getCurrentFrameIndex:function(){return gaf.IDNONE},getTotalFrameCount:function(){return 0},start:function(){},stop:function(){},isVisibleInCurrentFrame:function(){return!(this._parentTimeLine&&this._parentTimeLine.getCurrentFrameIndex()+1!=this._lastVisibleInFrame)},isDone:function(){return!0},playSequence:function(t,e,i){return!1},isReversed:function(){return!1},setSequenceDelegate:function(t){},setFrame:function(t){return!1},setControlDelegate:function(t){},getEndFrame:function(t){return gaf.IDNONE},pauseAnimation:function(){},gotoAndPlay:function(t){},isLooped:function(){return!1},resumeAnimation:function(){},setReversed:function(t){},hasSequences:function(){return!1},getFps:function(){return 60},setLocator:function(t){},setExternalTransform:function(t){cc.affineTransformEqualToTransform(this._additionalTransform,t)||this.setAdditionalTransform(t)},getExternalTransform:function(){return this._additionalTransform},setAnimationRunning:function(){},_enableTick:function(t){},_resetState:function(){},_updateVisibility:function(t,e){var i=t.hasColorTransform?t.colorTransform.offset.a:0;this.setOpacity(t.alpha+i)},isVisible:function(){return this.getOpacity()>0},visit:function(t){this.isVisibleInCurrentFrame()&&this._super(t)},_getFilters:function(){return null},_processAnimation:function(){},_applyState:function(t,e){this._applyStateSuper(t,e)},_applyStateSuper:function(t,e){if(this._needsCtx=e._needsCtx,this._filterStack.length=0,this._parentTimeLine=e,1!=this._usedAtlasScale){var i=cc.clone(t.matrix);i.tx*=this._usedAtlasScale,i.ty*=this._usedAtlasScale,this.setExternalTransform(i)}else this.setExternalTransform(t.matrix);t.hasEffect&&(this._filterStack=this._filterStack.concat(t.effect),this._needsCtx=!0),e._filterStack&&e._filterStack.length>0&&(this._filterStack=this._filterStack.concat(e._filterStack)),this._filterStack.length>0&&this._filterStack[0].type===gaf.EFFECT_COLOR_MATRIX&&(this._needsCtx=!0),t.hasColorTransform?(this._cascadeColorMult.r=t.colorTransform.mult.r*e._cascadeColorMult.r/255,this._cascadeColorMult.g=t.colorTransform.mult.g*e._cascadeColorMult.g/255,this._cascadeColorMult.b=t.colorTransform.mult.b*e._cascadeColorMult.b/255,this._cascadeColorMult.a=t.colorTransform.mult.a*e._cascadeColorMult.a/255,this._cascadeColorOffset.r=t.colorTransform.offset.r+e._cascadeColorOffset.r,this._cascadeColorOffset.g=t.colorTransform.offset.g+e._cascadeColorOffset.g,this._cascadeColorOffset.b=t.colorTransform.offset.b+e._cascadeColorOffset.b,this._cascadeColorOffset.a=t.colorTransform.offset.a+e._cascadeColorOffset.a):(this._cascadeColorMult.r=e._cascadeColorMult.r,this._cascadeColorMult.g=e._cascadeColorMult.g,this._cascadeColorMult.b=e._cascadeColorMult.b,this._cascadeColorMult.a=t.alpha*(e._cascadeColorMult.a/255),this._cascadeColorOffset.r=e._cascadeColorOffset.r,this._cascadeColorOffset.g=e._cascadeColorOffset.g,this._cascadeColorOffset.b=e._cascadeColorOffset.b,this._cascadeColorOffset.a=e._cascadeColorOffset.a),(this._cascadeColorOffset.r>0||this._cascadeColorOffset.g>0||this._cascadeColorOffset.b>0||this._cascadeColorOffset.a>0)&&(this._needsCtx=!0)},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this),this._renderCmd._visit=this._renderCmd.visit;var t=this;this._renderCmd.visit=function(e){t.isVisibleInCurrentFrame()&&this._visit(e)}},_getNode:function(){return this},setAnchorPoint:function(t,e){void 0===e?this._super(t.x,t.y-1):this._super(t,e-1)}}),gaf.Object._createNullObject=function(){var t=new gaf.Object;return t.isVisible=function(){return!0},t},gaf.TimeLine=gaf.Object.extend({_className:"GAFTimeLine",_objects:null,_container:null,_animationStartedNextLoopDelegate:null,_animationFinishedPlayDelegate:null,_framePlayedDelegate:null,_sequenceDelegate:null,_fps:60,_frameTime:1/60,_currentSequenceStart:gaf.FIRST_FRAME_INDEX,_currentSequenceEnd:gaf.FIRST_FRAME_INDEX,_totalFrameCount:0,_isRunning:!1,_isLooped:!1,_isReversed:!1,_timeDelta:0,_animationsSelectorScheduled:!1,_currentFrame:gaf.FIRST_FRAME_INDEX,setAnimationStartedNextLoopDelegate:function(t){this._animationStartedNextLoopDelegate=t},setAnimationFinishedPlayDelegate:function(t){this._animationFinishedPlayDelegate=t},setLooped:function(t,e){this._isLooped=t,e&&this._objects.forEach(function(i){i.setLooped(t,e)})},getBoundingBoxForCurrentFrame:function(){var t=null,e=!0;return this._objects.forEach(function(i){if(i.isVisibleInCurrentFrame()&&i.isVisible()){var n=i.getBoundingBoxForCurrentFrame();n||(n=i.getBoundingBox()),e?(e=!1,t=n):t=cc.rectUnion(t,n)}}),cc._rectApplyAffineTransformIn(t,this._container.getNodeToParentTransform())},setFps:function(t){cc.assert(0!==t,"Error! Fps is set to zero."),this._fps=t,this._frameTime=1/t},getObjectByName:function(t){var e=t.split("."),i=null,n=-1,r=this,o={};try{e.forEach(function(t){var e=r._gafproto.getNamedParts();if(!e.hasOwnProperty(t))throw o.lastElement=t,o;n=e[t],i=r._objects[n],r=i})}catch(e){if(e!==o)throw e;return cc.log("Sequence incorrect: `"+t+"` At: `"+o.lastElement+"`"),null}return i},clearSequence:function(){this._currentSequenceStart=gaf.FIRST_FRAME_INDEX,this._currentSequenceEnd=this._gafproto.getTotalFrames()},getIsAnimationRunning:function(){return this._isRunning},gotoAndStop:function(t){var e=0;return e="string"==typeof t?this.getStartFrame(t):t,!!this.setFrame(e)&&(this.setAnimationRunning(!1,!1),!0)},gotoAndPlay:function(t){var e=0;return e="string"==typeof t?this.getStartFrame(t):t,!!this.setFrame(e)&&(this.setAnimationRunning(!0,!1),!0)},getStartFrame:function(t){var e=this._gafproto.getSequences()[t];return e?e.start:gaf.IDNONE},getEndFrame:function(t){var e=this._gafproto.getSequences()[t];return e?e.end:gaf.IDNONE},setFramePlayedDelegate:function(t){this._framePlayedDelegate=t},getCurrentFrameIndex:function(){return this._showingFrame},getTotalFrameCount:function(){return this._gafproto.getTotalFrames()},start:function(){this._enableTick(!0),this._isRunning||(this._currentFrame=gaf.FIRST_FRAME_INDEX,this.setAnimationRunning(!0,!0))},stop:function(){this._enableTick(!1),this._isRunning&&(this._currentFrame=gaf.FIRST_FRAME_INDEX,this.setAnimationRunning(!1,!0))},isDone:function(){return!this._isLooped&&(this._isReversed?this._currentFrame<gaf.FIRST_FRAME_INDEX-1:this._currentFrame>this._totalFrameCount)},getSequences:function(){return this._gafproto.getSequences()},playSequence:function(t,e){var i=this.getStartFrame(t),n=this.getEndFrame(t);return gaf.IDNONE!==i&&gaf.IDNONE!==n&&(this._currentSequenceStart=i,this._currentSequenceEnd=n,this._currentFrame<this._currentSequenceStart||this._currentFrame>this._currentSequenceEnd?this._currentFrame=this._currentSequenceStart:this._currentFrame=this._currentSequenceStart,this.setLooped(e,!1),this.resumeAnimation(),!0)},isReversed:function(){return this._isReversed},setSequenceDelegate:function(t){this._sequenceDelegate=t},setFrame:function(t){return t>=gaf.FIRST_FRAME_INDEX&&t<this._totalFrameCount&&(this._showingFrame=t,this._currentFrame=t,this._processAnimation(),!0)},pauseAnimation:function(){this._isRunning&&this.setAnimationRunning(!1,!1)},isLooped:function(){return this._isLooped},resumeAnimation:function(){this._isRunning||this.setAnimationRunning(!0,!1)},setReversed:function(t){this._isReversed=t},hasSequences:function(){return this._gafproto.getSequences().length>0},getFps:function(){return this._fps},ctor:function(t,e){this._super(e),this._objects=[],cc.assert(t,"Error! Missing mandatory parameter."),this._gafproto=t},setExternalTransform:function(t){cc.affineTransformEqualToTransform(this._container._additionalTransform,t)||this._container.setAdditionalTransform(t)},_init:function(){this.setContentSize(this._gafproto.getBoundingBox()),this._currentSequenceEnd=this._gafproto.getTotalFrames(),this._totalFrameCount=this._currentSequenceEnd,this.setFps(this._gafproto.getFps()),this._container=new cc.Node,this.addChild(this._container);var t=this,e=this._gafproto.getAsset();this._gafproto.getObjects().forEach(function(i){var n=e._getProtos()[i];cc.assert(n,"Error. GAF proto for type: "+i.type+" and reference id: "+i+" not found."),t._objects[i]=n._gafConstruct()})},_enableTick:function(t){!this._animationsSelectorScheduled&&t?(this.schedule(this._processAnimations),this._animationsSelectorScheduled=!0):this._animationsSelectorScheduled&&!t&&(this.unschedule(this._processAnimations),this._animationsSelectorScheduled=!1)},_processAnimations:function(t){for(this._timeDelta+=t;this._timeDelta>=this._frameTime;)this._timeDelta-=this._frameTime,this._step()},_step:function(){if(this._showingFrame=this._currentFrame,!this.getIsAnimationRunning())return void this._processAnimation();if(this._sequenceDelegate){var t;t=this._isReversed?this._getSequenceByFirstFrame(this._currentFrame+1):this._getSequenceByLastFrame(this._currentFrame),t&&this._sequenceDelegate(this,t)}this._isCurrentFrameLastInSequence()&&(this._isLooped?this._animationStartedNextLoopDelegate&&this._animationStartedNextLoopDelegate(this):(this.setAnimationRunning(!1,!1),this._animationFinishedPlayDelegate&&this._animationFinishedPlayDelegate(this))),this._processAnimation(),this._currentFrame=this._nextFrame()},_isCurrentFrameLastInSequence:function(){return this._isReversed?this._currentFrame==this._currentSequenceStart:this._currentFrame==this._currentSequenceEnd-1},_nextFrame:function(){return this._isCurrentFrameLastInSequence()?this._isLooped?this._isReversed?this._currentSequenceEnd-1:this._currentSequenceStart:this._currentFrame:this._currentFrame+(this._isReversed?-1:1)},_processAnimation:function(){this._realizeFrame(this._container,this._currentFrame),this._framePlayedDelegate&&this._framePlayedDelegate(this,this._currentFrame)},_realizeFrame:function(t,e){var i=this,n=i._objects,r=i._gafproto.getFrames();if(!(e>r.length)){var o=r[e];if(o)for(var s=o.states,c=0,a=s.length;c<a;++c){var l=s[c],h=n[l.objectIdRef];if(!h)return;if(l.alpha<0&&h._resetState(),h._updateVisibility(l,i),h.isVisible()){h._applyState(l,i);var u=t;l.hasMask&&(u=n[l.maskObjectIdRef]._getNode(),cc.assert(u,"Error! Mask not found.")),h._lastVisibleInFrame=1+e,gaf.TimeLine.rearrangeSubobject(u,h,l.depth),h._step&&h._step()}}}},setAnimationRunning:function(t,e){this._isRunning=t,e&&this._objects.forEach(function(i){i&&i.setAnimationRunning&&i.setAnimationRunning(t,e)})},_getSequenceByLastFrame:function(){var t=this._gafproto.getSequences();for(var e in t)if(t.hasOwnProperty(e)&&t[e].end===frame+1)return e;return""},_resetState:function(){this._super(),this._currentFrame=this._currentSequenceStart},_getSequenceByFirstFrame:function(){var t=this._gafproto.getSequences();for(var e in t)if(t.hasOwnProperty(e)&&t[e].start===frame)return e;return""}}),gaf.TimeLine.rearrangeSubobject=function(t,e,i){var n=e.getParent();n!==t?(e.removeFromParent(!1),t.addChild(e,i)):e.setLocalZOrder(i)},gaf.TextField=gaf.Object.extend({_className:"GAFTextField"}),gaf.Sprite=gaf.Object.extend({_className:"GAFSprite",_hasCtx:!1,_hasFilter:!1,ctor:function(t,e){this._super(e),cc.assert(t,"Error! Missing mandatory parameter."),this._gafproto=t},_init:function(){var t=this._gafproto.getFrame();cc.assert(t instanceof cc.SpriteFrame,"Error. Wrong object type."),this._sprite=new cc.Sprite,this._sprite._renderCmd=this._gafCreateRenderCmd(this._sprite),this._sprite.initWithSpriteFrame(t),this._sprite.setAnchorPoint(this._gafproto.getAnchor()),this.addChild(this._sprite),this._sprite.setOpacityModifyRGB(!0),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&this._sprite.setBlendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA)},_applyState:function(t,e){this._applyStateSuper(t,e),this._needsCtx?(this._hasCtx||(this._enableCtx(),this._hasCtx=!0),this._applyCtxState(t)):(this._hasCtx&&(this._disableCtx(),this._hasCtx=!1),cc.colorEqual(this._sprite._realColor,this._cascadeColorMult)||this._sprite.setColor(this._cascadeColorMult),this._sprite.getOpacity()!=this._cascadeColorMult.a&&this._sprite.setOpacity(this._cascadeColorMult.a))},_enableCtx:function(){this._sprite._renderCmd._enableCtx()},_disableCtx:function(){this._sprite._renderCmd._disableCtx()},_applyCtxState:function(t){this._sprite._renderCmd._applyCtxState(this)},getBoundingBoxForCurrentFrame:function(){var t=this._sprite.getBoundingBox();return cc._rectApplyAffineTransformIn(t,this.getNodeToParentTransform())},_gafCreateRenderCmd:function(t){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new gaf.Sprite.CanvasRenderCmd(t):new gaf.Sprite.WebGLRenderCmd(t)}}),gaf.Mask=gaf.Object.extend({_className:"GAFMask",_clippingNode:null,ctor:function(t){this._super(),cc.assert(t,"Error! Missing mandatory parameter."),this._gafproto=t},_init:function(){var t=this._gafproto.getMaskNodeProto();cc.assert(t,"Error. Mask node for id ref "+this._gafproto.getIdRef()+" not found."),this._maskNode=t._gafConstruct(),this._clippingNode=cc.ClippingNode.create(this._maskNode),this._clippingNode.setAlphaThreshold(.5),this.addChild(this._clippingNode)},setExternalTransform:function(t){cc.affineTransformEqualToTransform(this._maskNode._additionalTransform,t)||this._maskNode.setAdditionalTransform(t)},_getNode:function(){return this._clippingNode}}),function(){gaf.Sprite.CanvasRenderCmd=function(t){cc.Sprite.CanvasRenderCmd.call(this,t),this._hasTintMult=!1,this._hasTintOffset=!1,this._hasCtx=!1,this._tintMult=cc.color(255,255,255,255),this._tintOffset=cc.color(0,0,0,0),this._textureDirty=!1};var t=gaf.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);t.constructor=gaf.Sprite.CanvasRenderCmd,t._disableCtx=function(){this._hasTintOffset=!1,this._hasCtx=!1,this._textureDirty=!0,this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),this._tintMult=cc.color(255,255,255,255),this._tintOffset=cc.color(0,0,0,0)},t._enableCtx=function(){},t._applyCtxState=function(t){var e=t._cascadeColorMult,i=t._cascadeColorOffset,n=e.a;this._node.getOpacity()!=n&&this._node.setOpacity(n);var r=!cc.colorEqual(this._tintMult,e);r&&(this._node.setColor(e),this._tintMult=e,this._hasTintMult=255!==e.r||255!==e.g||255!==e.b);var o=this._tintOffset.r!=i.r||this._tintOffset.g!=i.g||this._tintOffset.b!=i.b||this._tintOffset.a!=i.a;o&&(this._tintOffset=i,this._hasTintOffset=0!==i.r||0!==i.g||0!==i.b||0!==i.a),this._textureDirty=r||o,this._textureDirty&&this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty),this._hasCtx=t._filterStack.length>0&&t._filterStack[0].type===gaf.EFFECT_COLOR_MATRIX},t.rendering=function(t,e,i){var n=this._node,r=this._textureCoord,o=this._displayedOpacity/255;if((!n._texture||0!==r.width&&0!==r.height&&n._texture._textureLoaded)&&0!==o){var s,c=t||cc._renderContext,a=c.getContext(),l=n._offsetPosition.x,h=n._rect.height,u=n._rect.width,d=-n._offsetPosition.y-h;c.setTransform(this._worldTransform,e,i),c.setCompositeOperation(this._blendFuncStr),c.setGlobalAlpha(o),(n._flippedX||n._flippedY)&&c.save(),n._flippedX&&(l=-l-u,a.scale(-1,1)),n._flippedY&&(d=n._offsetPosition.y,a.scale(1,-1)),s=n._texture._htmlElementObj,this._colorized?a.drawImage(s,0,0,r.width,r.height,l*e,d*i,u*e,h*i):a.drawImage(s,r.renderX,r.renderY,r.width,r.height,l*e,d*i,u*e,h*i),(n._flippedX||n._flippedY)&&c.restore(),cc.g_NumberOfDraws++}},cc.sys._supportCanvasNewBlendModes&&(t._updateColor=function(){var t=this._displayedColor,e=this._node;if(this._hasTintMult|=255!==t.r||255!==t.g||255!==t.b,this._textureDirty){this._textureDirty=!1,this._colorized&&(this._colorized=!1,e.texture=this._originalTexture);var i,n=e._texture,r=this._textureCoord;if(this._hasTintMult&&n&&r.validRect&&this._originalTexture){if(i=n.getHtmlElementObj(),!i)return;this._colorized=!0,(this._hasTintOffset||this._hasCtx)&&(t=this._tintMult),i=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,t,r),n=new cc.Texture2D,n.initWithElement(i),n.handleLoadedTexture(),e.texture=n}if(n=e._texture,this._hasTintOffset){var o=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());if(n&&r.validRect&&this._originalTexture){if(i=n.getHtmlElementObj(),!i)return;if(this._colorized)var s=cc.rect(0,0,r.width,r.height);else s=r;i=this._gafGenerateTintImage(e.texture._htmlElementObj,s,o,this._tintOffset,r),n=new cc.Texture2D,n.initWithElement(i),n.handleLoadedTexture(),e.texture=n,this._colorized=!0}}}},t._gafGenerateTintImage=function(t,e,i,n,r,o){r||(r=cc.rect(0,0,t.width,t.height));var s,c=Math.min(r.width,i[0].width),a=Math.min(r.height,i[0].height),l=o;return l?(s=l.getContext("2d"),s.clearRect(0,0,c,a)):(l=document.createElement("canvas"),l.width=c,l.height=a,s=l.getContext("2d")),s.save(),s.globalCompositeOperation="source-over",s.drawImage(i[2],r.x,r.y,c,a,0,0,c,a),s.globalCompositeOperation="source-in",s.fillStyle="rgba("+Math.round(n.r)+","+Math.round(n.g)+","+Math.round(n.b)+",1)",s.fillRect(0,0,c,a),s.globalCompositeOperation="lighter",s.drawImage(t,e.x,e.y,c,a,0,0,c,a),s.restore(),l})}(),gaf._TimeLineProto=function(t,e,i,n,r,o){r="undefined"!=typeof r?r:0,o=o||"",this._objects=[],this.getTotalFrames=function(){return e},this.getBoundingBox=function(){return i},this.getId=function(){return r},this.getLinkageName=function(){return o},this.getPivot=function(){return n},this.getRect=function(){return i},this.getNamedParts=function(){return{}},this.getSequences=function(){return{}},this.getFrames=function(){return[]},this.getFps=function(){return 60},this.getObjects=function(){return this._objects},this.getAsset=function(){return t},this._gafConstruct=function(){var t=this.getAsset()._usedAtlasScale,e=new gaf.TimeLine(this,t);return e._init(),e}},gaf._SpriteProto=function(t,e,i){this.getFrames=function(){return e},this.getIdRef=function(){return i},this.getAsset=function(){return t},this._gafConstruct=function(){var t=this.getAsset()._usedAtlasScale,e=new gaf.Sprite(this,t);return e._init(),e}},gaf._SpriteProto.prototype.getFrame=function(){var t=this.getAsset()._usedAtlasScale;cc.assert(t,"Error. Atlas scale zero.");var e=this.getFrames()[t];return cc.assert(e,"Error. No frames found for used scale `"+t+"`"),e[this.getIdRef()]},gaf._SpriteProto.prototype.getAnchor=function(){return this.getFrame()._gafAnchor},gaf._MaskProto=function(t,e,i){this.getIdRef=function(){return i},this.getMaskNodeProto=function(){return e},this._gafConstruct=function(){var t=new gaf.Mask(this);return t._init(),t}},gaf.ReadSingleTag=function(t){var e=t.Ushort(),i=gaf.Tags[e],n={};return"undefined"==typeof i?(console.log("GAF. Non implemented tag detected."),gaf.Tags.Default.parse(t,e)):n=i.parse(t,e),n},gaf.ReadTags=function(t){var e=[];try{do{var i=gaf.ReadSingleTag(t);e.push(i)}while(0!=i.tagId)}catch(t){if(!(t instanceof Error&&"GAF format error"==t.message))throw console.log(t.stack),t;console.log("GAF format error:\n"+t.stack)}return e},gaf.Tag=function(){this.Default=Object.create(gaf.Tag.base),this[0]=Object.create(gaf.Tag.End),this[1]=Object.create(gaf.Tag.DefineAtlas),this[2]=Object.create(gaf.Tag.DefineAnimationMasks),this[3]=Object.create(gaf.Tag.DefineAnimationObjects),this[4]=Object.create(gaf.Tag.DefineAnimationFrames),this[5]=Object.create(gaf.Tag.DefineNamedParts),this[6]=Object.create(gaf.Tag.DefineSequences),this[7]=Object.create(gaf.Tag.DefineTextFields),this[8]=Object.create(gaf.Tag.DefineAtlas2),this[9]=Object.create(gaf.Tag.DefineStage),this[10]=Object.create(gaf.Tag.DefineAnimationObjects2),this[11]=Object.create(gaf.Tag.DefineAnimationMasks2),this[12]=Object.create(gaf.Tag.DefineAnimationFrames2),this[13]=Object.create(gaf.Tag.DefineTimeline)},gaf.Tag.base=function(){},gaf.Tag.base.parse=function(t,e){var i=t.Uint();t.startNestedBuffer(i);var n=this.doParse(t);return t.endNestedBuffer(),n.tagName=this.tagName,n.tagId=e,n},gaf.Tag.base.doParse=function(t){return{}},gaf.Tag.End=Object.create(gaf.Tag.base),gaf.Tag.End.tagName="TagEnd",gaf.Tag.DefineAtlas=Object.create(gaf.Tag.base),gaf.Tag.DefineAtlas.tagName="TagDefineAtlas",gaf.Tag.DefineAtlas.doParse=function(t){var e=t.fields("scale","Float","atlases",t.array("Ubyte",t.fields("id","Uint","sources",t.array("Ubyte",t.fields("source","String","csf","Float")))),"elements",t.array("Uint",t.fields("pivot","Point","origin","Point","scale","Float","size","Point","atlasId","Uint","elementAtlasId","Uint")));return{content:e()}},gaf.Tag.DefineAnimationMasks=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationMasks.tagName="TagDefineAnimationMasks",gaf.Tag.DefineAnimationMasks.doParse=function(t){var e=t.array("Uint",t.fields("objectId","Uint","elementAtlasIdRef","Uint")),i={content:e()};return i},gaf.Tag.DefineAnimationObjects=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationObjects.tagName="TagDefineAnimationObjects",gaf.Tag.DefineAnimationObjects.doParse=function(t){var e=t.array("Uint",t.fields("objectId","Uint","elementAtlasIdRef","Uint"));return{content:e()}},gaf.Tag.DefineAnimationFrames=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationFrames.tagName="TagDefineAnimationFrames",gaf.Tag.DefineAnimationFrames.doParse=function(t){var e=t.array("Uint",t.fields("frame","Uint","state",t.array("Uint",t.fields("hasColorTransform","Ubyte","hasMask","Ubyte","hasEffect","Ubyte","objectIdRef","Uint","depth","Int","alpha","Float","matrix","Matrix","colorTransform",t.condition("hasColorTransform",1,t.fields("alphaOffset","Float","redMultiplier","Float","redOffset","Float","greenMultiplier","Float","greenOffset","Float","blueMultiplier","Float","blueOffset","Float")),"effect",t.condition("hasEffect",1,t.array("Ubyte",gaf.Tag._readFilter(t))),"maskObjectIdRef",t.condition("hasMask",1,t.fields("maskObjectIdRef","Uint"))))));return{content:e()}},gaf.Tag.DefineNamedParts=Object.create(gaf.Tag.base),gaf.Tag.DefineNamedParts.tagName="TagDefineNamedParts",gaf.Tag.DefineNamedParts.doParse=function(t){var e=t.array("Uint",t.fields("objectId","Uint","name","String"));return{content:e()}},gaf.Tag.DefineSequences=Object.create(gaf.Tag.base),gaf.Tag.DefineSequences.tagName="TagDefineSequences",gaf.Tag.DefineSequences.doParse=function(t){var e=t.array("Uint",t.fields("id","String","start","Ushort","end","Ushort"));return{content:e()}},gaf.Tag.DefineTextFields=Object.create(gaf.Tag.base),gaf.Tag.DefineTextFields.tagName="TagDefineTextFields",gaf.Tag.DefineTextFields.doParse=function(t){var e=t.array("Uint",t.fields("id","Uint","pivot","Point","end","Ushort","width","Float","height","Float","text","String","embedFonts","Boolean","multiline","Boolean","wordWrap","Boolean","hasRestrict","Boolean","restrict",t.condition("hasRestrict",1,function(){return t.String}),"editable","Boolean","selectable","Boolean","displayAsPassword","Boolean","maxChars","Uint","align","Uint","blockIndent","Uint","bold","Boolean","bullet","Boolean","color","color","font","String","indent","Uint","italic","Boolean","kerning","Boolean","leading","Uint","leftMargin","Uint","letterSpacing","Float","rightMargin","Uint","size","Uint","tabStops",t.array("Uint",t.fields("value","Uint")),"target","string","underline","Boolean","url","String"));return{content:e()}},gaf.Tag.DefineAtlas2=Object.create(gaf.Tag.base),gaf.Tag.DefineAtlas2.tagName="TagDefineAtlas2",gaf.Tag.DefineAtlas2.doParse=function(t){var e=t.fields("scale","Float","atlases",t.array("Ubyte",t.fields("id","Uint","sources",t.array("Ubyte",t.fields("source","String","csf","Float")))),"elements",t.array("Uint",t.fields("pivot","Point","origin","Point","scale","Float","size","Point","atlasId","Uint","elementAtlasId","Uint","hasScale9Grid","Boolean","scale9GridRect",t.condition("hasScale9Grid",1,function(){return t.Rect()}))));return{content:e()}},gaf.Tag.DefineStage=Object.create(gaf.Tag.base),gaf.Tag.DefineStage.tagName="TagDefineStage",gaf.Tag.DefineStage.doParse=function(t){var e=t.fields("fps","Ubyte","color","color","width","Ushort","height","Ushort");return{content:e()}},gaf.Tag.DefineAnimationObjects2=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationObjects2.tagName="TagDefineAnimationObjects2",gaf.Tag.DefineAnimationObjects2.doParse=function(t){var e=t.array("Uint",t.fields("objectId","Uint","elementAtlasIdRef","Uint","type","Ushort"));return{content:e()}},gaf.Tag.DefineAnimationMasks2=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationMasks2.tagName="TagDefineAnimationMasks2",gaf.Tag.DefineAnimationMasks2.doParse=function(t){var e=t.array("Uint",t.fields("objectId","Uint","elementAtlasIdRef","Uint","type","Ushort"));return{content:e()}},gaf.Tag.DefineAnimationFrames2=Object.create(gaf.Tag.base),gaf.Tag.DefineAnimationFrames2.tagName="TagDefineAnimationFrames2",gaf.Tag.DefineAnimationFrames2.doParse=function(t){var e=t.array("Uint",t.fields("frame","Uint","hasChangesInDisplayList","Boolean","hasActions","Boolean","state",t.condition("hasChangesInDisplayList",1,t.array("Uint",t.fields("hasColorTransform","Boolean","hasMask","Boolean","hasEffect","Boolean","objectIdRef","Uint","depth","Int","alpha","Float","matrix","Matrix","colorTransform",t.condition("hasColorTransform",1,t.fields("alphaOffset","Float","redMultiplier","Float","redOffset","Float","greenMultiplier","Float","greenOffset","Float","blueMultiplier","Float","blueOffset","Float")),"effect",t.condition("hasEffect",1,t.array("Ubyte",gaf.Tag._readFilter(t))),"maskObjectIdRef",t.condition("hasMask",1,function(){return t.Uint()})))),"actions",t.condition("hasActions",1,t.array("Uint",t.fields("type","Uint","scope","String","params",gaf.Tag._readActionArguments(t))))));return{content:e()}},gaf.Tag.DefineTimeline=Object.create(gaf.Tag.base),gaf.Tag.DefineTimeline.tagName="TagDefineTimeline",gaf.Tag.DefineTimeline.doParse=function(t){var e=t.fields("id","Uint","animationFrameCount","Uint","boundingBox","Rect","pivotPoint","Point","hasLinkage","Boolean","linkageName",t.condition("hasLinkage",1,function(){return t.String()})),i={content:e()};return i.content.tags=gaf.ReadTags(t),i},gaf.Tag._readActionArguments=function(t){return function(){var e=t.Uint(),i=[];for(t.startNestedBuffer(e);t.maxOffset()<t.tell();)i.push(t.String());return t.endNestedBuffer(),i}},gaf.Tag._readFilter=function(t){return t.fields("type","Uint","dropShadow",t.condition("type",gaf.EFFECT_DROP_SHADOW,t.fields("color","color","blurX","Float","blurY","Float","angle","Float","distance","Float","strength","Float","inner","Boolean","knockout","Boolean")),"blur",t.condition("type",gaf.EFFECT_BLUR,t.fields("blurX","Float","blurY","Float")),"glow",t.condition("type",gaf.EFFECT_GLOW,t.fields("color","color","blurX","Float","blurY","Float","strength","Float","inner","Boolean","knockout","Boolean")),"colorMatrix",t.condition("type",gaf.EFFECT_COLOR_MATRIX,t.fields("rr","Float","gr","Float","br","Float","ar","Float","r","Float","rg","Float","gg","Float","bg","Float","ag","Float","g","Float","rb","Float","gb","Float","bb","Float","ab","Float","b","Float","ra","Float","ga","Float","ba","Float","aa","Float","a","Float")))},gaf.Tags=new gaf.Tag;var gaf=gaf||{};gaf.Loader=function(){var t=function(t,e){e.compression=t.Uint(),e.versionMajor=t.Ubyte(),e.versionMinor=t.Ubyte(),e.fileLength=t.Uint()},e=function(t,e){e.framesCount=t.Ushort(),e.frameSize=t.Rect(),e.pivot=t.Point()},i=function(t,e){var i=t.Uint();e.scaleValues=[];for(var n=0;n<i;++n)e.scaleValues.push(t.Float());var r=t.Uint();e.csfValues=[];for(var n=0;n<r;++n)e.csfValues.push(t.Float())};this.LoadFile=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0);var n=this;i.responseType="arraybuffer",i.onload=function(t){var r=new gaf.DataReader(i.response),o=n.LoadStream(r);e&&e(o)},i.send()},this.LoadStream=function(n){var r={};if(t(n,r),r.compression==gaf.COMPRESSION_NONE);else{if(r.compression!=gaf.COMPRESSION_ZIP)throw new Error("GAF syntax error.");var o=n.dataRaw.slice(n.tell()),s=new window.Zlib.Inflate(new Uint8Array(o)),c=s.decompress();n=new gaf.DataReader(c.buffer)}r.versionMajor<4?e(n,r):i(n,r);var a=gaf.ReadTags(n);return{header:r,tags:a}}},gaf.DataReader=function(t){this.dataRaw=t,this.buf=new DataView(t),this.offset=[0]},gaf.DataReader.prototype.constructor=gaf.DataReader,gaf.DataReader.prototype.newOffset=function(t){if(this.offset[this.offset.length-1]+=t,this.getOffset()>this.maxOffset())throw new Error("GAF format error");return this.offset[this.offset.length-1]-t},gaf.DataReader.prototype.maxOffset=function(){return 1==this.offset.length?this.buf.byteLength:this.offset[this.offset.length-2]},gaf.DataReader.prototype.getOffset=function(t){return this.offset[this.offset.length-1]},gaf.DataReader.prototype.Ubyte=function(){return this.buf.getUint8(this.newOffset(1))},gaf.DataReader.prototype.Boolean=function(){var t=this.buf.getUint8(this.newOffset(1));if(t>1)throw new Error("GAF format error");return t},gaf.DataReader.prototype.Uint=function(){return this.buf.getUint32(this.newOffset(4),!0)},gaf.DataReader.prototype.Int=function(){return this.buf.getInt32(this.newOffset(4),!0)},gaf.DataReader.prototype.color=function(){return{b:this.Ubyte(),g:this.Ubyte(),r:this.Ubyte(),a:this.Ubyte()}},gaf.DataReader.prototype.Ushort=function(){return this.buf.getUint16(this.newOffset(2),!0)},gaf.DataReader.prototype.Float=function(){return this.buf.getFloat32(this.newOffset(4),!0)},gaf.DataReader.prototype.String=function(){var t=this.Ushort(),e=this.newOffset(t),i=this.getOffset();try{var n=this.dataRaw.slice(e,i)}catch(t){if("Object doesn't support property or method 'slice'"!=t.message)throw t;n=[];for(var r=e;r<i;++r)n.push(this.buf.getUint8(r))}return decodeURIComponent(escape(String.fromCharCode.apply(null,new Uint8Array(n))))},gaf.DataReader.prototype.startNestedBuffer=function(t){this.offset.push(this.offset[this.offset.length-1]),this.offset[this.offset.length-2]+=t},gaf.DataReader.prototype.endNestedBuffer=function(){if(1==this.offset.length)throw new Error("No nested buffer available");this.offset.pop()},gaf.DataReader.prototype.Point=function(){return{x:this.Float(),y:this.Float()}},gaf.DataReader.prototype.Rect=function(){return{x:this.Float(),y:this.Float(),width:this.Float(),height:this.Float()}},gaf.DataReader.prototype.Matrix=function(){return{a:this.Float(),b:this.Float(),c:this.Float(),d:this.Float(),tx:this.Float(),ty:this.Float()}},gaf.DataReader.prototype.seek=function(t){this.offset[this.offset.length-1]=t},gaf.DataReader.prototype.tell=function(){return this.offset[this.offset.length-1]},gaf.DataReader.prototype.fields=function(){var t=this,e=arguments;return function(){arguments.callee.result={};var i=0;if(e.length%2)throw new Error("Number of arguments is not even");for(;i<e.length;){var n=e[i++],r=e[i++];if("function"==typeof r)arguments.callee.result[n]=r();else{if(!(r in t&&"function"==typeof t[r]))throw new Error("Object DataReader has no function `"+r+"`");arguments.callee.result[n]=t[r].call(t)}}return arguments.callee.result}},gaf.DataReader.prototype.condition=function(t,e,i){var n=arguments;return function(){if(3!=n.length)throw new Error("Condition function");var t=arguments.callee.caller;if(!("result"in t))throw new Error("Condition function caller has no key `result`");var e=t.result,i=n[0],r=n[1],o=n[2],s=null;return s="function"==typeof r?function(){return r(e[i])}:function(){return r==e[i]},s()?o():null}},gaf.DataReader.prototype.array=function(){var t=this,e=arguments;return function(){arguments.callee.result=[];for(var i=t[e[0]].call(t),n=0;n<i;++n){var r=e[1].call();arguments.callee.result.push(r)}return arguments.callee.result}},gaf.SHADER_GAUSSIAN_BLUR_FRAG="varying mediump vec2 v_texCoord;\nuniform mediump vec2 u_step;\nvoid main()\n{ \n    mediump vec4 sum = vec4(0.0);                                      \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 4.0) * 0.05;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 0.0) * 0.18;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 4.0) * 0.05;   \n    gl_FragColor = sum;                                                \n} \n",gaf.SHADER_GLOW_FRAG="varying mediump vec2 v_texCoord;\nuniform mediump vec2 u_step;\nuniform mediump vec4 u_glowColor;\nvoid main()\n{ \n    mediump vec4 sum = vec4(0.0);                                      \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 4.0) * 0.05;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord - u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 0.0) * 0.18;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 1.0) * 0.15;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 2.0) * 0.12;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 3.0) * 0.09;   \n    sum += texture2D(CC_Texture0, v_texCoord + u_step * 4.0) * 0.05;   \n    gl_FragColor = sum * u_glowColor;                                  \n} \n",gaf.SHADER_COLOR_MATRIX_FRAG="varying mediump vec2 v_texCoord;\nvarying mediump vec4 v_fragmentColor;\nuniform mediump vec4 colorTransformMult;\nuniform mediump vec4 colorTransformOffsets;\nuniform mediump mat4 colorMatrix;\nuniform mediump vec4 colorMatrix2;\nvoid main()\n{ \n    vec4 texColor = texture2D(CC_Texture0, v_texCoord);                          \n    const float kMinimalAlphaAllowed = 1.0e-8;                                   \n    if (texColor.a > kMinimalAlphaAllowed)                                       \n    {                                                                            \n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);                  \n        vec4 ctxColor = texColor * colorTransformMult + colorTransformOffsets;   \n        vec4 adjustColor = colorMatrix * ctxColor + colorMatrix2;                \n        adjustColor *= v_fragmentColor;                                          \n        texColor = vec4(adjustColor.rgb * adjustColor.a, adjustColor.a);         \n    }                                                                            \n    gl_FragColor = texColor;                                                     \n}\n",gaf._glShaderInit=function(){gaf._Uniforms={ColorTransformMult:-1,ColorTransformOffset:-1,ColorMatrixBody:-1,ColorMatrixAppendix:-1,BlurTexelOffset:-1,GlowTexelOffset:-1,GlowColor:-1},gaf._shaderCreate=function(t,e){var i=new cc.GLProgram,n=i.initWithVertexShaderByteArray(e,t);return cc.assert(n,"Shader init error"),i.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),i.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),i.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),n=i.link(),cc.assert(n,"Shader linking error"),i.updateUniforms(),i},gaf._shaderCreateAlpha=function(){var t=gaf._shaderCreate(gaf.SHADER_COLOR_MATRIX_FRAG,cc.SHADER_POSITION_TEXTURE_COLOR_VERT);return gaf._Uniforms.ColorTransformMult=t.getUniformLocationForName(gaf.UNIFORM_ALPHA_TINT_MULT),gaf._Uniforms.ColorTransformOffset=t.getUniformLocationForName(gaf.UNIFORM_ALPHA_TINT_OFFSET),gaf._Uniforms.ColorMatrixBody=t.getUniformLocationForName(gaf.UNIFORM_ALPHA_COLOR_MATRIX_BODY),gaf._Uniforms.ColorMatrixAppendix=t.getUniformLocationForName(gaf.UNIFORM_ALPHA_COLOR_MATRIX_APPENDIX),t},gaf._shaderCreateBlur=function(){var t=gaf._shaderCreate(gaf.SHADER_GAUSSIAN_BLUR_FRAG,cc.SHADER_POSITION_TEXTURE_COLOR_VERT);return gaf._Uniforms.BlurTexelOffset=t._glContext.getUniformLocation(t._programObj,gaf.UNIFORM_BLUR_TEXEL_OFFSET),t},gaf._shaderCreateGlow=function(){var t=gaf._shaderCreate(gaf.SHADER_GLOW_FRAG,cc.SHADER_POSITION_TEXTURE_COLOR_VERT);return gaf._Uniforms.GlowTexelOffset=t._glContext.getUniformLocation(t._programObj,gaf.UNIFORM_GLOW_TEXEL_OFFSET),gaf._Uniforms.GlowColor=t._glContext.getUniformLocation(t._programObj,gaf.UNIFORM_GLOW_COLOR),t},gaf._Shaders={Alpha:gaf._shaderCreateAlpha(),Blur:gaf._shaderCreateBlur(),Glow:gaf._shaderCreateGlow()}},gaf._setupShaders=function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL?gaf._glShaderInit():delete gaf._glShaderInit},gaf._AtlasLoader={},gaf._AtlasLoader.execute=function(t,e,i){t()?e():i()},gaf._AtlasLoader.checkAtlas=function(t){return function(){return t&&"string"!=typeof t&&t.isLoaded()}},gaf._AtlasLoader.load=function(t,e,i){cc.textureCache.addImage(t,function(t){gaf._AtlasLoader.execute(gaf._AtlasLoader.checkAtlas(t),function(){e(t)},i)})},gaf._AtlasLoader.loadFront=function(t,e,i){return function(){t.length>0?gaf._AtlasLoader.load(t[0],e,gaf._AtlasLoader.loadFront(t.slice(1),e,i)):i()}},gaf._AtlasLoader.loadArray=function(t,e,i){gaf._AtlasLoader.loadFront(t,e,i)()};var Box2D={};!function(t,e){function i(){}!(Object.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(t,e,i){i.get instanceof Function&&t.__defineGetter__(e,i.get),i.set instanceof Function&&t.__defineSetter__(e,i.set)}),t.inherit=function(t,e){var n=t;i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=n},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){t===e&&(t=0);for(var i=new Array(t||0),n=0;n<t;++n)i[n]=0;return i},t.is=function(t,i){return null!==t&&(i instanceof Function&&t instanceof i||!(t.constructor.__implements==e||!t.constructor.__implements[i]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"==typeof Box2D&&(Box2D={}),"undefined"==typeof Box2D.Collision&&(Box2D.Collision={}),"undefined"==typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),"undefined"==typeof Box2D.Common&&(Box2D.Common={}),"undefined"==typeof Box2D.Common.Math&&(Box2D.Common.Math={}),"undefined"==typeof Box2D.Dynamics&&(Box2D.Dynamics={}),"undefined"==typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),"undefined"==typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),"undefined"==typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function i(){i.b2BoundValues.apply(this,arguments),this.constructor===i&&this.b2BoundValues.apply(this,arguments)}function n(){n.b2Collision.apply(this,arguments)}function r(){r.b2ContactID.apply(this,arguments),this.constructor===r&&this.b2ContactID.apply(this,arguments)}function o(){o.b2ContactPoint.apply(this,arguments)}function s(){s.b2Distance.apply(this,arguments)}function c(){c.b2DistanceInput.apply(this,arguments)}function a(){a.b2DistanceOutput.apply(this,arguments)}function l(){l.b2DistanceProxy.apply(this,arguments)}function h(){h.b2DynamicTree.apply(this,arguments),this.constructor===h&&this.b2DynamicTree.apply(this,arguments)}function u(){u.b2DynamicTreeBroadPhase.apply(this,arguments)}function d(){d.b2DynamicTreeNode.apply(this,arguments)}function _(){_.b2DynamicTreePair.apply(this,arguments)}function p(){p.b2Manifold.apply(this,arguments),this.constructor===p&&this.b2Manifold.apply(this,arguments)}function f(){f.b2ManifoldPoint.apply(this,arguments),this.constructor===f&&this.b2ManifoldPoint.apply(this,arguments)}function m(){m.b2Point.apply(this,arguments)}function g(){g.b2RayCastInput.apply(this,arguments),this.constructor===g&&this.b2RayCastInput.apply(this,arguments)}function y(){y.b2RayCastOutput.apply(this,arguments)}function v(){v.b2Segment.apply(this,arguments)}function T(){T.b2SeparationFunction.apply(this,arguments)}function C(){C.b2Simplex.apply(this,arguments),this.constructor===C&&this.b2Simplex.apply(this,arguments)}function S(){S.b2SimplexCache.apply(this,arguments)}function x(){x.b2SimplexVertex.apply(this,arguments)}function A(){A.b2TimeOfImpact.apply(this,arguments)}function E(){E.b2TOIInput.apply(this,arguments)}function b(){b.b2WorldManifold.apply(this,arguments),this.constructor===b&&this.b2WorldManifold.apply(this,arguments)}function R(){R.ClipVertex.apply(this,arguments)}function P(){P.Features.apply(this,arguments)}function w(){w.b2CircleShape.apply(this,arguments),this.constructor===w&&this.b2CircleShape.apply(this,arguments)}function I(){I.b2EdgeChainDef.apply(this,arguments),this.constructor===I&&this.b2EdgeChainDef.apply(this,arguments)}function D(){D.b2EdgeShape.apply(this,arguments),this.constructor===D&&this.b2EdgeShape.apply(this,arguments)}function L(){L.b2MassData.apply(this,arguments)}function O(){O.b2PolygonShape.apply(this,arguments),this.constructor===O&&this.b2PolygonShape.apply(this,arguments)}function B(){B.b2Shape.apply(this,arguments),this.constructor===B&&this.b2Shape.apply(this,arguments)}function N(){N.b2Color.apply(this,arguments),this.constructor===N&&this.b2Color.apply(this,arguments)}function F(){F.b2Settings.apply(this,arguments)}function M(){M.b2Mat22.apply(this,arguments),this.constructor===M&&this.b2Mat22.apply(this,arguments)}function V(){V.b2Mat33.apply(this,arguments),this.constructor===V&&this.b2Mat33.apply(this,arguments)}function k(){k.b2Math.apply(this,arguments)}function G(){G.b2Sweep.apply(this,arguments)}function W(){W.b2Transform.apply(this,arguments),this.constructor===W&&this.b2Transform.apply(this,arguments)}function z(){z.b2Vec2.apply(this,arguments),this.constructor===z&&this.b2Vec2.apply(this,arguments)}function U(){U.b2Vec3.apply(this,arguments),this.constructor===U&&this.b2Vec3.apply(this,arguments)}function Y(){Y.b2Body.apply(this,arguments),this.constructor===Y&&this.b2Body.apply(this,arguments)}function X(){X.b2BodyDef.apply(this,arguments),this.constructor===X&&this.b2BodyDef.apply(this,arguments)}function H(){H.b2ContactFilter.apply(this,arguments)}function j(){j.b2ContactImpulse.apply(this,arguments)}function q(){q.b2ContactListener.apply(this,arguments)}function Z(){Z.b2ContactManager.apply(this,arguments),this.constructor===Z&&this.b2ContactManager.apply(this,arguments)}function J(){J.b2DebugDraw.apply(this,arguments),this.constructor===J&&this.b2DebugDraw.apply(this,arguments)}function K(){K.b2DestructionListener.apply(this,arguments)}function Q(){Q.b2FilterData.apply(this,arguments)}function $(){$.b2Fixture.apply(this,arguments),this.constructor===$&&this.b2Fixture.apply(this,arguments)}function tt(){tt.b2FixtureDef.apply(this,arguments),this.constructor===tt&&this.b2FixtureDef.apply(this,arguments)}function et(){et.b2Island.apply(this,arguments),this.constructor===et&&this.b2Island.apply(this,arguments)}function it(){it.b2TimeStep.apply(this,arguments)}function nt(){nt.b2World.apply(this,arguments),this.constructor===nt&&this.b2World.apply(this,arguments)}function rt(){rt.b2CircleContact.apply(this,arguments)}function ot(){ot.b2Contact.apply(this,arguments),this.constructor===ot&&this.b2Contact.apply(this,arguments)}function st(){st.b2ContactConstraint.apply(this,arguments),this.constructor===st&&this.b2ContactConstraint.apply(this,arguments)}function ct(){ct.b2ContactConstraintPoint.apply(this,arguments)}function at(){at.b2ContactEdge.apply(this,arguments)}function lt(){lt.b2ContactFactory.apply(this,arguments),this.constructor===lt&&this.b2ContactFactory.apply(this,arguments)}function ht(){ht.b2ContactRegister.apply(this,arguments)}function ut(){ut.b2ContactResult.apply(this,arguments)}function dt(){dt.b2ContactSolver.apply(this,arguments),this.constructor===dt&&this.b2ContactSolver.apply(this,arguments)}function _t(){_t.b2EdgeAndCircleContact.apply(this,arguments)}function pt(){pt.b2NullContact.apply(this,arguments),this.constructor===pt&&this.b2NullContact.apply(this,arguments)}function ft(){ft.b2PolyAndCircleContact.apply(this,arguments)}function mt(){mt.b2PolyAndEdgeContact.apply(this,arguments)}function gt(){gt.b2PolygonContact.apply(this,arguments)}function yt(){yt.b2PositionSolverManifold.apply(this,arguments),this.constructor===yt&&this.b2PositionSolverManifold.apply(this,arguments)}function vt(){vt.b2BuoyancyController.apply(this,arguments)}function Tt(){Tt.b2ConstantAccelController.apply(this,arguments)}function Ct(){Ct.b2ConstantForceController.apply(this,arguments)}function St(){St.b2Controller.apply(this,arguments)}function xt(){xt.b2ControllerEdge.apply(this,arguments)}function At(){At.b2GravityController.apply(this,arguments)}function Et(){Et.b2TensorDampingController.apply(this,arguments)}function bt(){bt.b2DistanceJoint.apply(this,arguments),this.constructor===bt&&this.b2DistanceJoint.apply(this,arguments)}function Rt(){Rt.b2DistanceJointDef.apply(this,arguments),this.constructor===Rt&&this.b2DistanceJointDef.apply(this,arguments)}function Pt(){Pt.b2FrictionJoint.apply(this,arguments),this.constructor===Pt&&this.b2FrictionJoint.apply(this,arguments)}function wt(){wt.b2FrictionJointDef.apply(this,arguments),this.constructor===wt&&this.b2FrictionJointDef.apply(this,arguments)}function It(){It.b2GearJoint.apply(this,arguments),this.constructor===It&&this.b2GearJoint.apply(this,arguments)}function Dt(){Dt.b2GearJointDef.apply(this,arguments),this.constructor===Dt&&this.b2GearJointDef.apply(this,arguments)}function Lt(){Lt.b2Jacobian.apply(this,arguments)}function Ot(){Ot.b2Joint.apply(this,arguments),this.constructor===Ot&&this.b2Joint.apply(this,arguments)}function Bt(){Bt.b2JointDef.apply(this,arguments),this.constructor===Bt&&this.b2JointDef.apply(this,arguments)}function Nt(){Nt.b2JointEdge.apply(this,arguments)}function Ft(){Ft.b2LineJoint.apply(this,arguments),this.constructor===Ft&&this.b2LineJoint.apply(this,arguments)}function Mt(){Mt.b2LineJointDef.apply(this,arguments),this.constructor===Mt&&this.b2LineJointDef.apply(this,arguments)}function Vt(){Vt.b2MouseJoint.apply(this,arguments),this.constructor===Vt&&this.b2MouseJoint.apply(this,arguments)}function kt(){kt.b2MouseJointDef.apply(this,arguments),this.constructor===kt&&this.b2MouseJointDef.apply(this,arguments)}function Gt(){Gt.b2PrismaticJoint.apply(this,arguments),this.constructor===Gt&&this.b2PrismaticJoint.apply(this,arguments)}function Wt(){Wt.b2PrismaticJointDef.apply(this,arguments),this.constructor===Wt&&this.b2PrismaticJointDef.apply(this,arguments)}function zt(){zt.b2PulleyJoint.apply(this,arguments),this.constructor===zt&&this.b2PulleyJoint.apply(this,arguments)}function Ut(){Ut.b2PulleyJointDef.apply(this,arguments),this.constructor===Ut&&this.b2PulleyJointDef.apply(this,arguments)}function Yt(){Yt.b2RevoluteJoint.apply(this,arguments),this.constructor===Yt&&this.b2RevoluteJoint.apply(this,arguments)}function Xt(){Xt.b2RevoluteJointDef.apply(this,arguments),this.constructor===Xt&&this.b2RevoluteJointDef.apply(this,arguments)}function Ht(){Ht.b2WeldJoint.apply(this,arguments),this.constructor===Ht&&this.b2WeldJoint.apply(this,arguments)}function jt(){jt.b2WeldJointDef.apply(this,arguments),this.constructor===jt&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=t,Box2D.Collision.b2Bound=e,Box2D.Collision.b2BoundValues=i,Box2D.Collision.b2Collision=n,Box2D.Collision.b2ContactID=r,Box2D.Collision.b2ContactPoint=o,Box2D.Collision.b2Distance=s,Box2D.Collision.b2DistanceInput=c,Box2D.Collision.b2DistanceOutput=a,Box2D.Collision.b2DistanceProxy=l,Box2D.Collision.b2DynamicTree=h,Box2D.Collision.b2DynamicTreeBroadPhase=u,Box2D.Collision.b2DynamicTreeNode=d,Box2D.Collision.b2DynamicTreePair=_,Box2D.Collision.b2Manifold=p,Box2D.Collision.b2ManifoldPoint=f,Box2D.Collision.b2Point=m,Box2D.Collision.b2RayCastInput=g,Box2D.Collision.b2RayCastOutput=y,Box2D.Collision.b2Segment=v,Box2D.Collision.b2SeparationFunction=T,Box2D.Collision.b2Simplex=C,Box2D.Collision.b2SimplexCache=S,Box2D.Collision.b2SimplexVertex=x,Box2D.Collision.b2TimeOfImpact=A,Box2D.Collision.b2TOIInput=E,Box2D.Collision.b2WorldManifold=b,Box2D.Collision.ClipVertex=R,Box2D.Collision.Features=P,Box2D.Collision.Shapes.b2CircleShape=w,Box2D.Collision.Shapes.b2EdgeChainDef=I,Box2D.Collision.Shapes.b2EdgeShape=D,Box2D.Collision.Shapes.b2MassData=L,Box2D.Collision.Shapes.b2PolygonShape=O,Box2D.Collision.Shapes.b2Shape=B,Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=N,Box2D.Common.b2Settings=F,Box2D.Common.Math.b2Mat22=M,Box2D.Common.Math.b2Mat33=V,Box2D.Common.Math.b2Math=k,Box2D.Common.Math.b2Sweep=G,Box2D.Common.Math.b2Transform=W,Box2D.Common.Math.b2Vec2=z,Box2D.Common.Math.b2Vec3=U,Box2D.Dynamics.b2Body=Y,Box2D.Dynamics.b2BodyDef=X,Box2D.Dynamics.b2ContactFilter=H,Box2D.Dynamics.b2ContactImpulse=j,Box2D.Dynamics.b2ContactListener=q,Box2D.Dynamics.b2ContactManager=Z,Box2D.Dynamics.b2DebugDraw=J,Box2D.Dynamics.b2DestructionListener=K,Box2D.Dynamics.b2FilterData=Q,Box2D.Dynamics.b2Fixture=$,Box2D.Dynamics.b2FixtureDef=tt,Box2D.Dynamics.b2Island=et,Box2D.Dynamics.b2TimeStep=it,Box2D.Dynamics.b2World=nt,Box2D.Dynamics.Contacts.b2CircleContact=rt,Box2D.Dynamics.Contacts.b2Contact=ot,Box2D.Dynamics.Contacts.b2ContactConstraint=st,Box2D.Dynamics.Contacts.b2ContactConstraintPoint=ct,Box2D.Dynamics.Contacts.b2ContactEdge=at,Box2D.Dynamics.Contacts.b2ContactFactory=lt,Box2D.Dynamics.Contacts.b2ContactRegister=ht,Box2D.Dynamics.Contacts.b2ContactResult=ut,Box2D.Dynamics.Contacts.b2ContactSolver=dt,Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=_t,Box2D.Dynamics.Contacts.b2NullContact=pt,Box2D.Dynamics.Contacts.b2PolyAndCircleContact=ft,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=mt,Box2D.Dynamics.Contacts.b2PolygonContact=gt,Box2D.Dynamics.Contacts.b2PositionSolverManifold=yt,Box2D.Dynamics.Controllers.b2BuoyancyController=vt,Box2D.Dynamics.Controllers.b2ConstantAccelController=Tt,Box2D.Dynamics.Controllers.b2ConstantForceController=Ct,Box2D.Dynamics.Controllers.b2Controller=St,Box2D.Dynamics.Controllers.b2ControllerEdge=xt,Box2D.Dynamics.Controllers.b2GravityController=At,Box2D.Dynamics.Controllers.b2TensorDampingController=Et,Box2D.Dynamics.Joints.b2DistanceJoint=bt,Box2D.Dynamics.Joints.b2DistanceJointDef=Rt,Box2D.Dynamics.Joints.b2FrictionJoint=Pt,Box2D.Dynamics.Joints.b2FrictionJointDef=wt,Box2D.Dynamics.Joints.b2GearJoint=It,Box2D.Dynamics.Joints.b2GearJointDef=Dt,Box2D.Dynamics.Joints.b2Jacobian=Lt,Box2D.Dynamics.Joints.b2Joint=Ot,Box2D.Dynamics.Joints.b2JointDef=Bt,Box2D.Dynamics.Joints.b2JointEdge=Nt,Box2D.Dynamics.Joints.b2LineJoint=Ft,Box2D.Dynamics.Joints.b2LineJointDef=Mt,Box2D.Dynamics.Joints.b2MouseJoint=Vt,Box2D.Dynamics.Joints.b2MouseJointDef=kt,Box2D.Dynamics.Joints.b2PrismaticJoint=Gt,Box2D.Dynamics.Joints.b2PrismaticJointDef=Wt,Box2D.Dynamics.Joints.b2PulleyJoint=zt,Box2D.Dynamics.Joints.b2PulleyJointDef=Ut,Box2D.Dynamics.Joints.b2RevoluteJoint=Yt,Box2D.Dynamics.Joints.b2RevoluteJointDef=Xt,Box2D.Dynamics.Joints.b2WeldJoint=Ht,Box2D.Dynamics.Joints.b2WeldJointDef=jt}(),Box2D.postDefs=[],function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),i=Box2D.Collision.Shapes.b2Shape,n=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),r=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),o=Box2D.Common.Math.b2Sweep,s=Box2D.Common.Math.b2Transform,c=Box2D.Common.Math.b2Vec2,a=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB),l=Box2D.Collision.b2Bound,h=Box2D.Collision.b2BoundValues,u=Box2D.Collision.b2Collision,d=Box2D.Collision.b2ContactID,_=Box2D.Collision.b2ContactPoint,p=Box2D.Collision.b2Distance,f=Box2D.Collision.b2DistanceInput,m=Box2D.Collision.b2DistanceOutput,g=Box2D.Collision.b2DistanceProxy,y=Box2D.Collision.b2DynamicTree,v=Box2D.Collision.b2DynamicTreeBroadPhase,T=Box2D.Collision.b2DynamicTreeNode,C=Box2D.Collision.b2DynamicTreePair,S=Box2D.Collision.b2Manifold,x=Box2D.Collision.b2ManifoldPoint,A=Box2D.Collision.b2Point,E=Box2D.Collision.b2RayCastInput,b=Box2D.Collision.b2RayCastOutput,R=Box2D.Collision.b2Segment,P=Box2D.Collision.b2SeparationFunction,w=Box2D.Collision.b2Simplex,I=Box2D.Collision.b2SimplexCache,D=Box2D.Collision.b2SimplexVertex,L=Box2D.Collision.b2TimeOfImpact,O=Box2D.Collision.b2TOIInput,B=Box2D.Collision.b2WorldManifold,N=Box2D.Collision.ClipVertex,F=Box2D.Collision.Features,M=Box2D.Collision.IBroadPhase;a.b2AABB=function(){this.lowerBound=new c,this.upperBound=new c},a.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},a.prototype.GetCenter=function(){return new c((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},a.prototype.GetExtents=function(){return new c((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},a.prototype.Contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y},a.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,r=e.p1.x,o=e.p1.y,s=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,a=Math.abs(s),l=Math.abs(c),h=t.normal,u=0,d=0,_=0,p=0,f=0;if(a<Number.MIN_VALUE){if(r<this.lowerBound.x||this.upperBound.x<r)return!1}else if(u=1/s,d=(this.lowerBound.x-r)*u,_=(this.upperBound.x-r)*u,f=-1,d>_&&(p=d,d=_,_=p,f=1),d>i&&(h.x=f,h.y=0,i=d),n=Math.min(n,_),i>n)return!1;if(l<Number.MIN_VALUE){if(o<this.lowerBound.y||this.upperBound.y<o)return!1}else if(u=1/c,d=(this.lowerBound.y-o)*u,_=(this.upperBound.y-o)*u,f=-1,d>_&&(p=d,d=_,_=p,f=1),d>i&&(h.y=f,h.x=0,i=d),n=Math.min(n,_),i>n)return!1;return t.fraction=i,!0},a.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,r=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||r>0)},a.Combine=function(t,e){var i=new a;return i.Combine(t,e),i},a.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},l.b2Bound=function(){},l.prototype.IsLower=function(){return 0==(1&this.value)},l.prototype.IsUpper=function(){return 1==(1&this.value)},l.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},h.b2BoundValues=function(){},h.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},u.b2Collision=function(){},u.ClipSegmentToLine=function(t,e,i,n){void 0===n&&(n=0);var r,o=0;r=e[0];var s=r.v;r=e[1];var c=r.v,a=i.x*s.x+i.y*s.y-n,l=i.x*c.x+i.y*c.y-n;if(a<=0&&t[o++].Set(e[0]),l<=0&&t[o++].Set(e[1]),a*l<0){var h=a/(a-l);r=t[o];var u=r.v;u.x=s.x+h*(c.x-s.x),u.y=s.y+h*(c.y-s.y),r=t[o];var d;a>0?(d=e[0],r.id=d.id):(d=e[1],r.id=d.id),++o}return o},u.EdgeSeparation=function(t,e,i,n,r){void 0===i&&(i=0);var o,s,c=(parseInt(t.m_vertexCount),t.m_vertices),a=t.m_normals,l=parseInt(n.m_vertexCount),h=n.m_vertices;o=e.R,s=a[i];var u=o.col1.x*s.x+o.col2.x*s.y,d=o.col1.y*s.x+o.col2.y*s.y;o=r.R;for(var _=o.col1.x*u+o.col1.y*d,p=o.col2.x*u+o.col2.y*d,f=0,m=Number.MAX_VALUE,g=0;g<l;++g){s=h[g];var y=s.x*_+s.y*p;y<m&&(m=y,f=g)}s=c[i],o=e.R;var v=e.position.x+(o.col1.x*s.x+o.col2.x*s.y),T=e.position.y+(o.col1.y*s.x+o.col2.y*s.y);s=h[f],o=r.R;var C=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),S=r.position.y+(o.col1.y*s.x+o.col2.y*s.y);C-=v,S-=T;var x=C*u+S*d;return x},u.FindMaxSeparation=function(t,e,i,n,r){var o,s,c=parseInt(e.m_vertexCount),a=e.m_normals;s=r.R,o=n.m_centroid;var l=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),h=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);s=i.R,o=e.m_centroid,l-=i.position.x+(s.col1.x*o.x+s.col2.x*o.y),h-=i.position.y+(s.col1.y*o.x+s.col2.y*o.y);for(var d=l*i.R.col1.x+h*i.R.col1.y,_=l*i.R.col2.x+h*i.R.col2.y,p=0,f=-Number.MAX_VALUE,m=0;m<c;++m){o=a[m];var g=o.x*d+o.y*_;g>f&&(f=g,p=m)}var y=u.EdgeSeparation(e,i,p,n,r),v=parseInt(p-1>=0?p-1:c-1),T=u.EdgeSeparation(e,i,v,n,r),C=parseInt(p+1<c?p+1:0),S=u.EdgeSeparation(e,i,C,n,r),x=0,A=0,E=0;if(T>y&&T>S)E=-1,x=v,A=T;else{if(!(S>y))return t[0]=p,y;E=1,x=C,A=S}for(;;){if(p=E==-1?x-1>=0?x-1:c-1:x+1<c?x+1:0,y=u.EdgeSeparation(e,i,p,n,r),!(y>A))break;x=p,A=y}return t[0]=x,A},u.FindIncidentEdge=function(t,e,i,n,r,o){void 0===n&&(n=0);var s,c,a=(parseInt(e.m_vertexCount),e.m_normals),l=parseInt(r.m_vertexCount),h=r.m_vertices,u=r.m_normals;s=i.R,c=a[n];var d=s.col1.x*c.x+s.col2.x*c.y,_=s.col1.y*c.x+s.col2.y*c.y;s=o.R;var p=s.col1.x*d+s.col1.y*_;_=s.col2.x*d+s.col2.y*_,d=p;for(var f=0,m=Number.MAX_VALUE,g=0;g<l;++g){c=u[g];var y=d*c.x+_*c.y;y<m&&(m=y,f=g)}var v,T=parseInt(f),C=parseInt(T+1<l?T+1:0);v=t[0],c=h[T],s=o.R,v.v.x=o.position.x+(s.col1.x*c.x+s.col2.x*c.y),v.v.y=o.position.y+(s.col1.y*c.x+s.col2.y*c.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=T,v.id.features.incidentVertex=0,v=t[1],c=h[C],s=o.R,v.v.x=o.position.x+(s.col1.x*c.x+s.col2.x*c.y),v.v.y=o.position.y+(s.col1.y*c.x+s.col2.y*c.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=C,v.id.features.incidentVertex=1},u.MakeClipPointVector=function(){var t=new Vector(2);return t[0]=new N,t[1]=new N,t},u.CollidePolygons=function(t,e,i,r,o){var s;t.m_pointCount=0;var c=e.m_radius+r.m_radius,a=0;u.s_edgeAO[0]=a;var l=u.FindMaxSeparation(u.s_edgeAO,e,i,r,o);if(a=u.s_edgeAO[0],!(l>c)){var h=0;u.s_edgeBO[0]=h;var d=u.FindMaxSeparation(u.s_edgeBO,r,o,e,i);if(h=u.s_edgeBO[0],!(d>c)){var _,p,f,m,g,y=0,v=0,T=.98,C=.001;d>T*l+C?(_=r,p=e,f=o,m=i,y=h,t.m_type=S.e_faceB,v=1):(_=e,p=r,f=i,m=o,y=a,t.m_type=S.e_faceA,v=0);var x=u.s_incidentEdge;u.FindIncidentEdge(x,_,f,y,p,m);var A,E=parseInt(_.m_vertexCount),b=_.m_vertices,R=b[y];A=y+1<E?b[parseInt(y+1)]:b[0];var P=u.s_localTangent;P.Set(A.x-R.x,A.y-R.y),P.Normalize();var w=u.s_localNormal;w.x=P.y,w.y=-P.x;var I=u.s_planePoint;I.Set(.5*(R.x+A.x),.5*(R.y+A.y));var D=u.s_tangent;g=f.R,D.x=g.col1.x*P.x+g.col2.x*P.y,D.y=g.col1.y*P.x+g.col2.y*P.y;var L=u.s_tangent2;L.x=-D.x,L.y=-D.y;var O=u.s_normal;O.x=D.y,O.y=-D.x;var B=u.s_v11,N=u.s_v12;B.x=f.position.x+(g.col1.x*R.x+g.col2.x*R.y),B.y=f.position.y+(g.col1.y*R.x+g.col2.y*R.y),N.x=f.position.x+(g.col1.x*A.x+g.col2.x*A.y),N.y=f.position.y+(g.col1.y*A.x+g.col2.y*A.y);var F=O.x*B.x+O.y*B.y,M=-D.x*B.x-D.y*B.y+c,V=D.x*N.x+D.y*N.y+c,k=u.s_clipPoints1,G=u.s_clipPoints2,W=0;if(W=u.ClipSegmentToLine(k,x,L,M),!(W<2||(W=u.ClipSegmentToLine(G,k,D,V),W<2))){t.m_localPlaneNormal.SetV(w),t.m_localPoint.SetV(I);for(var z=0,U=0;U<n.b2_maxManifoldPoints;++U){s=G[U];var Y=O.x*s.v.x+O.y*s.v.y-F;if(Y<=c){var X=t.m_points[z];g=m.R;var H=s.v.x-m.position.x,j=s.v.y-m.position.y;X.m_localPoint.x=H*g.col1.x+j*g.col1.y,X.m_localPoint.y=H*g.col2.x+j*g.col2.y,X.m_id.Set(s.id),X.m_id.features.flip=v,++z}}t.m_pointCount=z}}}},u.CollideCircles=function(t,e,i,n,r){t.m_pointCount=0;var o,s;o=i.R,s=e.m_p;var c=i.position.x+(o.col1.x*s.x+o.col2.x*s.y),a=i.position.y+(o.col1.y*s.x+o.col2.y*s.y);o=r.R,s=n.m_p;var l=r.position.x+(o.col1.x*s.x+o.col2.x*s.y),h=r.position.y+(o.col1.y*s.x+o.col2.y*s.y),u=l-c,d=h-a,_=u*u+d*d,p=e.m_radius+n.m_radius;_>p*p||(t.m_type=S.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},u.CollidePolygonAndCircle=function(t,e,i,n,r){t.m_pointCount=0;var o,s,c=0,a=0;s=r.R,o=n.m_p;var l=r.position.x+(s.col1.x*o.x+s.col2.x*o.y),h=r.position.y+(s.col1.y*o.x+s.col2.y*o.y);c=l-i.position.x,a=h-i.position.y,s=i.R;for(var u=c*s.col1.x+a*s.col1.y,d=c*s.col2.x+a*s.col2.y,_=0,p=-Number.MAX_VALUE,f=e.m_radius+n.m_radius,m=parseInt(e.m_vertexCount),g=e.m_vertices,y=e.m_normals,v=0;v<m;++v){o=g[v],c=u-o.x,a=d-o.y,o=y[v];var T=o.x*c+o.y*a;if(T>f)return;T>p&&(p=T,_=v)}var C=parseInt(_),x=parseInt(C+1<m?C+1:0),A=g[C],E=g[x];if(p<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=S.e_faceA,t.m_localPlaneNormal.SetV(y[_]),t.m_localPoint.x=.5*(A.x+E.x),t.m_localPoint.y=.5*(A.y+E.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var b=(u-A.x)*(E.x-A.x)+(d-A.y)*(E.y-A.y),R=(u-E.x)*(A.x-E.x)+(d-E.y)*(A.y-E.y);if(b<=0){if((u-A.x)*(u-A.x)+(d-A.y)*(d-A.y)>f*f)return;t.m_pointCount=1,t.m_type=S.e_faceA,t.m_localPlaneNormal.x=u-A.x,t.m_localPlaneNormal.y=d-A.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(A),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(R<=0){if((u-E.x)*(u-E.x)+(d-E.y)*(d-E.y)>f*f)return;t.m_pointCount=1,t.m_type=S.e_faceA,t.m_localPlaneNormal.x=u-E.x,t.m_localPlaneNormal.y=d-E.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(E),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var P=.5*(A.x+E.x),w=.5*(A.y+E.y);if(p=(u-P)*y[C].x+(d-w)*y[C].y,p>f)return;t.m_pointCount=1,t.m_type=S.e_faceA,t.m_localPlaneNormal.x=y[C].x,t.m_localPlaneNormal.y=y[C].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(P,w),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},u.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,r=i.x-n.x,o=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,c=i.y-n.y;return!(r>0||o>0)&&!(s>0||c>0)},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=u.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new c,Box2D.Collision.b2Collision.s_localNormal=new c,Box2D.Collision.b2Collision.s_planePoint=new c,Box2D.Collision.b2Collision.s_normal=new c,Box2D.Collision.b2Collision.s_tangent=new c,Box2D.Collision.b2Collision.s_tangent2=new c,Box2D.Collision.b2Collision.s_v11=new c,Box2D.Collision.b2Collision.s_v12=new c,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new c,Box2D.Collision.b2Collision.b2_nullFeature=255}),d.b2ContactID=function(){this.features=new F},d.prototype.b2ContactID=function(){this.features._m_id=this},d.prototype.Set=function(t){this.key=t._key},d.prototype.Copy=function(){var t=new d;return t.key=this.key,t},Object.defineProperty(d.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(d.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),_.b2ContactPoint=function(){this.position=new c,this.velocity=new c,this.normal=new c,this.id=new d},p.b2Distance=function(){},p.Distance=function(t,e,i){++p.b2_gjkCalls;var o=i.proxyA,s=i.proxyB,a=i.transformA,l=i.transformB,h=p.s_simplex;h.ReadCache(e,o,a,s,l);for(var u,d=h.m_vertices,_=20,f=p.s_saveA,m=p.s_saveB,g=0,y=h.GetClosestPoint(),v=y.LengthSquared(),T=v,C=0,S=0;S<_;){for(g=h.m_count,C=0;C<g;C++)f[C]=d[C].indexA,m[C]=d[C].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3();break;default:n.b2Assert(!1)}if(3==h.m_count)break;u=h.GetClosestPoint(),T=u.LengthSquared(),v=T;var x=h.GetSearchDirection();if(x.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var A=d[h.m_count];A.indexA=o.GetSupport(r.MulTMV(a.R,x.GetNegative())),A.wA=r.MulX(a,o.GetVertex(A.indexA)),A.indexB=s.GetSupport(r.MulTMV(l.R,x)),A.wB=r.MulX(l,s.GetVertex(A.indexB)),A.w=r.SubtractVV(A.wB,A.wA),++S,++p.b2_gjkIters;var E=!1;for(C=0;C<g;C++)if(A.indexA==f[C]&&A.indexB==m[C]){E=!0;break}if(E)break;++h.m_count}if(p.b2_gjkMaxIters=r.Max(p.b2_gjkMaxIters,S),h.GetWitnessPoints(t.pointA,t.pointB),t.distance=r.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=S,h.WriteCache(e),i.useRadii){var b=o.m_radius,R=s.m_radius;if(t.distance>b+R&&t.distance>Number.MIN_VALUE){t.distance-=b+R;var P=r.SubtractVV(t.pointB,t.pointA);P.Normalize(),t.pointA.x+=b*P.x,t.pointA.y+=b*P.y,t.pointB.x-=R*P.x,t.pointB.y-=R*P.y}else u=new c,u.x=.5*(t.pointA.x+t.pointB.x),u.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=u.x,t.pointA.y=t.pointB.y=u.y,t.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new w,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),f.b2DistanceInput=function(){},m.b2DistanceOutput=function(){this.pointA=new c,this.pointB=new c},g.b2DistanceProxy=function(){},g.prototype.Set=function(r){switch(r.GetType()){case i.e_circleShape:var o=r instanceof t?r:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=o.m_p,this.m_count=1,this.m_radius=o.m_radius;break;case i.e_polygonShape:var s=r instanceof e?r:null;this.m_vertices=s.m_vertices,this.m_count=s.m_vertexCount,this.m_radius=s.m_radius;break;default:n.b2Assert(!1)}},g.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},g.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},g.prototype.GetVertexCount=function(){return this.m_count},g.prototype.GetVertex=function(t){return void 0===t&&(t=0),n.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},y.b2DynamicTree=function(){},y.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},y.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),r=n.b2_aabbExtension,o=n.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-r,i.aabb.lowerBound.y=t.lowerBound.y-o,i.aabb.upperBound.x=t.upperBound.x+r,i.aabb.upperBound.y=t.upperBound.y+o,i.userData=e,this.InsertLeaf(i),i},y.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},y.prototype.MoveProxy=function(t,e,i){if(n.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var r=n.b2_aabbExtension+n.b2_aabbMultiplier*(i.x>0?i.x:-i.x),o=n.b2_aabbExtension+n.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-r,t.aabb.lowerBound.y=e.lowerBound.y-o,t.aabb.upperBound.x=e.upperBound.x+r,t.aabb.upperBound.y=e.upperBound.y+o,this.InsertLeaf(t),!0},y.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},y.prototype.GetFatAABB=function(t){return t.aabb},y.prototype.GetUserData=function(t){return t.userData},y.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Vector,n=0;for(i[n++]=this.m_root;n>0;){var r=i[--n];if(r.aabb.TestOverlap(e))if(r.IsLeaf()){var o=t(r);if(!o)return}else i[n++]=r.child1,i[n++]=r.child2}}},y.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,o=r.SubtractVV(i,n);o.Normalize();var s=r.CrossFV(1,o),c=r.AbsV(s),l=e.maxFraction,h=new a,u=0,d=0;u=i.x+l*(n.x-i.x),d=i.y+l*(n.y-i.y),h.lowerBound.x=Math.min(i.x,u),h.lowerBound.y=Math.min(i.y,d),h.upperBound.x=Math.max(i.x,u),h.upperBound.y=Math.max(i.y,d);var _=new Vector,p=0;for(_[p++]=this.m_root;p>0;){var f=_[--p];if(0!=f.aabb.TestOverlap(h)){var m=f.aabb.GetCenter(),g=f.aabb.GetExtents(),y=Math.abs(s.x*(i.x-m.x)+s.y*(i.y-m.y))-c.x*g.x-c.y*g.y;if(!(y>0))if(f.IsLeaf()){var v=new E;if(v.p1=e.p1,v.p2=e.p2,v.maxFraction=e.maxFraction,l=t(v,f),0==l)return;l>0&&(u=i.x+l*(n.x-i.x),d=i.y+l*(n.y-i.y),h.lowerBound.x=Math.min(i.x,u),h.lowerBound.y=Math.min(i.y,d),h.upperBound.x=Math.max(i.x,u),h.upperBound.y=Math.max(i.y,d))}else _[p++]=f.child1,_[p++]=f.child2}}}},y.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new T},y.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},y.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,r=i.child2,o=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y),s=Math.abs((r.aabb.lowerBound.x+r.aabb.upperBound.x)/2-e.x)+Math.abs((r.aabb.lowerBound.y+r.aabb.upperBound.y)/2-e.y);i=o<s?n:r}while(0==i.IsLeaf());var c=i.parent,a=this.AllocateNode();if(a.parent=c,a.userData=null,a.aabb.Combine(t.aabb,i.aabb),c){i.parent.child1==i?c.child1=a:c.child2=a,a.child1=i,a.child2=t,i.parent=a,t.parent=a;do{if(c.aabb.Contains(a.aabb))break;c.aabb.Combine(c.child1.aabb,c.child2.aabb),a=c,c=c.parent}while(c)}else a.child1=i,a.child2=t,i.parent=a,t.parent=a,this.m_root=a},y.prototype.RemoveLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var r=n.aabb;if(n.aabb=a.Combine(n.child1.aabb,n.child2.aabb),r.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)},v.b2DynamicTreeBroadPhase=function(){this.m_tree=new y,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},v.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},v.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},v.prototype.MoveProxy=function(t,e,i){var n=this.m_tree.MoveProxy(t,e,i);n&&this.BufferMove(t)},v.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},v.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},v.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},v.prototype.GetProxyCount=function(){return this.m_proxyCount},v.prototype.UpdatePairs=function(t){function e(t){if(t==n)return!0;i.m_pairCount==i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new C);var e=i.m_pairBuffer[i.m_pairCount];return e.proxyA=t<n?t:n,e.proxyB=t>=n?t:n,++i.m_pairCount,!0}var i=this;i.m_pairCount=0;var n,r=0;for(r=0;r<i.m_moveBuffer.length;++r){n=i.m_moveBuffer[r];var o=i.m_tree.GetFatAABB(n);i.m_tree.Query(e,o)}i.m_moveBuffer.length=0;for(var r=0;r<i.m_pairCount;){var s=i.m_pairBuffer[r],c=i.m_tree.GetUserData(s.proxyA),a=i.m_tree.GetUserData(s.proxyB);for(t(c,a),++r;r<i.m_pairCount;){var l=i.m_pairBuffer[r];if(l.proxyA!=s.proxyA||l.proxyB!=s.proxyB)break;++r}}},v.prototype.Query=function(t,e){this.m_tree.Query(t,e)},v.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},v.prototype.Validate=function(){},v.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},v.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},v.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},v.prototype.ComparePairs=function(t,e){return 0},v.__implements={},v.__implements[M]=!0,T.b2DynamicTreeNode=function(){this.aabb=new a},T.prototype.IsLeaf=function(){return null==this.child1},C.b2DynamicTreePair=function(){},S.b2Manifold=function(){this.m_pointCount=0},S.prototype.b2Manifold=function(){this.m_points=new Vector(n.b2_maxManifoldPoints);for(var t=0;t<n.b2_maxManifoldPoints;t++)this.m_points[t]=new x;this.m_localPlaneNormal=new c,this.m_localPoint=new c},S.prototype.Reset=function(){for(var t=0;t<n.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof x?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},S.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<n.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof x?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},S.prototype.Copy=function(){var t=new S;return t.Set(this),t},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),x.b2ManifoldPoint=function(){this.m_localPoint=new c,this.m_id=new d},x.prototype.b2ManifoldPoint=function(){this.Reset()},x.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},x.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},A.b2Point=function(){this.p=new c},A.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},A.prototype.GetFirstVertex=function(t){return this.p},E.b2RayCastInput=function(){this.p1=new c,this.p2=new c},E.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},b.b2RayCastOutput=function(){this.normal=new c},R.b2Segment=function(){this.p1=new c,this.p2=new c},R.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var r=i.p1,o=i.p2.x-r.x,s=i.p2.y-r.y,c=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,l=a,h=-c,u=100*Number.MIN_VALUE,d=-(o*l+s*h);if(d>u){var _=r.x-this.p1.x,p=r.y-this.p1.y,f=_*l+p*h;if(0<=f&&f<=n*d){var m=-o*p+s*_;if(-u*d<=m&&m<=d*(1+u)){f/=d;var g=Math.sqrt(l*l+h*h);return l/=g,h/=g,t[0]=f,e.Set(l,h),!0}}}return!1},R.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},R.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},R.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},P.b2SeparationFunction=function(){this.m_localPoint=new c,this.m_axis=new c},P.prototype.Initialize=function(t,e,i,o,s){this.m_proxyA=e,this.m_proxyB=o;var a=parseInt(t.count);n.b2Assert(0<a&&a<3);var l,h,u,d,_,p,f,m,g=0,y=0,v=0,T=0,C=0,S=0,x=0,A=0;if(1==a)this.m_type=P.e_points,l=this.m_proxyA.GetVertex(t.indexA[0]),d=this.m_proxyB.GetVertex(t.indexB[0]),m=l,f=i.R,g=i.position.x+(f.col1.x*m.x+f.col2.x*m.y),y=i.position.y+(f.col1.y*m.x+f.col2.y*m.y),m=d,f=s.R,v=s.position.x+(f.col1.x*m.x+f.col2.x*m.y),T=s.position.y+(f.col1.y*m.x+f.col2.y*m.y),this.m_axis.x=v-g,this.m_axis.y=T-y,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=P.e_faceA,h=this.m_proxyA.GetVertex(t.indexA[0]),u=this.m_proxyA.GetVertex(t.indexA[1]),d=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(h.x+u.x),this.m_localPoint.y=.5*(h.y+u.y),this.m_axis=r.CrossVF(r.SubtractVV(u,h),1),this.m_axis.Normalize(),m=this.m_axis,f=i.R,C=f.col1.x*m.x+f.col2.x*m.y,S=f.col1.y*m.x+f.col2.y*m.y,m=this.m_localPoint,f=i.R,g=i.position.x+(f.col1.x*m.x+f.col2.x*m.y),y=i.position.y+(f.col1.y*m.x+f.col2.y*m.y),m=d,f=s.R,v=s.position.x+(f.col1.x*m.x+f.col2.x*m.y),T=s.position.y+(f.col1.y*m.x+f.col2.y*m.y),x=(v-g)*C+(T-y)*S,x<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=P.e_faceB,_=this.m_proxyB.GetVertex(t.indexB[0]),p=this.m_proxyB.GetVertex(t.indexB[1]),l=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(_.x+p.x),this.m_localPoint.y=.5*(_.y+p.y),this.m_axis=r.CrossVF(r.SubtractVV(p,_),1),this.m_axis.Normalize(),m=this.m_axis,f=s.R,C=f.col1.x*m.x+f.col2.x*m.y,S=f.col1.y*m.x+f.col2.y*m.y,m=this.m_localPoint,f=s.R,v=s.position.x+(f.col1.x*m.x+f.col2.x*m.y),T=s.position.y+(f.col1.y*m.x+f.col2.y*m.y),m=l,f=i.R,g=i.position.x+(f.col1.x*m.x+f.col2.x*m.y),y=i.position.y+(f.col1.y*m.x+f.col2.y*m.y),x=(g-v)*C+(y-T)*S,x<0&&this.m_axis.NegativeSelf();else{h=this.m_proxyA.GetVertex(t.indexA[0]),u=this.m_proxyA.GetVertex(t.indexA[1]),_=this.m_proxyB.GetVertex(t.indexB[0]),p=this.m_proxyB.GetVertex(t.indexB[1]);var E=(r.MulX(i,l),r.MulMV(i.R,r.SubtractVV(u,h))),b=(r.MulX(s,d),r.MulMV(s.R,r.SubtractVV(p,_))),R=E.x*E.x+E.y*E.y,w=b.x*b.x+b.y*b.y,I=r.SubtractVV(b,E),D=E.x*I.x+E.y*I.y,L=b.x*I.x+b.y*I.y,O=E.x*b.x+E.y*b.y,B=R*w-O*O;x=0,0!=B&&(x=r.Clamp((O*L-D*w)/B,0,1));var N=(O*x+L)/w;N<0&&(N=0,x=r.Clamp((O-D)/R,0,1)),l=new c,l.x=h.x+x*(u.x-h.x),l.y=h.y+x*(u.y-h.y),d=new c,d.x=_.x+x*(p.x-_.x),d.y=_.y+x*(p.y-_.y),0==x||1==x?(this.m_type=P.e_faceB,this.m_axis=r.CrossVF(r.SubtractVV(p,_),1),this.m_axis.Normalize(),this.m_localPoint=d,m=this.m_axis,f=s.R,C=f.col1.x*m.x+f.col2.x*m.y,S=f.col1.y*m.x+f.col2.y*m.y,m=this.m_localPoint,f=s.R,v=s.position.x+(f.col1.x*m.x+f.col2.x*m.y),T=s.position.y+(f.col1.y*m.x+f.col2.y*m.y),m=l,f=i.R,g=i.position.x+(f.col1.x*m.x+f.col2.x*m.y),y=i.position.y+(f.col1.y*m.x+f.col2.y*m.y),A=(g-v)*C+(y-T)*S,x<0&&this.m_axis.NegativeSelf()):(this.m_type=P.e_faceA,this.m_axis=r.CrossVF(r.SubtractVV(u,h),1),this.m_localPoint=l,m=this.m_axis,f=i.R,C=f.col1.x*m.x+f.col2.x*m.y,S=f.col1.y*m.x+f.col2.y*m.y,m=this.m_localPoint,f=i.R,g=i.position.x+(f.col1.x*m.x+f.col2.x*m.y),y=i.position.y+(f.col1.y*m.x+f.col2.y*m.y),m=d,f=s.R,v=s.position.x+(f.col1.x*m.x+f.col2.x*m.y),T=s.position.y+(f.col1.y*m.x+f.col2.y*m.y),A=(v-g)*C+(T-y)*S,x<0&&this.m_axis.NegativeSelf())}},P.prototype.Evaluate=function(t,e){var i,o,s,c,a,l,h,u=0;switch(this.m_type){case P.e_points:return i=r.MulTMV(t.R,this.m_axis),o=r.MulTMV(e.R,this.m_axis.GetNegative()),s=this.m_proxyA.GetSupportVertex(i),c=this.m_proxyB.GetSupportVertex(o),a=r.MulX(t,s),l=r.MulX(e,c),u=(l.x-a.x)*this.m_axis.x+(l.y-a.y)*this.m_axis.y;case P.e_faceA:return h=r.MulMV(t.R,this.m_axis),a=r.MulX(t,this.m_localPoint),o=r.MulTMV(e.R,h.GetNegative()),c=this.m_proxyB.GetSupportVertex(o),l=r.MulX(e,c),u=(l.x-a.x)*h.x+(l.y-a.y)*h.y;case P.e_faceB:return h=r.MulMV(e.R,this.m_axis),l=r.MulX(e,this.m_localPoint),i=r.MulTMV(t.R,h.GetNegative()),s=this.m_proxyA.GetSupportVertex(i),a=r.MulX(t,s),u=(a.x-l.x)*h.x+(a.y-l.y)*h.y;default:return n.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),w.b2Simplex=function(){this.m_v1=new D,this.m_v2=new D,this.m_v3=new D,this.m_vertices=new Vector(3)},w.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},w.prototype.ReadCache=function(t,e,i,o,s){n.b2Assert(0<=t.count&&t.count<=3);var c,a;this.m_count=t.count;for(var l=this.m_vertices,h=0;h<this.m_count;h++){var u=l[h];u.indexA=t.indexA[h],u.indexB=t.indexB[h],c=e.GetVertex(u.indexA),a=o.GetVertex(u.indexB),u.wA=r.MulX(i,c),u.wB=r.MulX(s,a),u.w=r.SubtractVV(u.wB,u.wA),u.a=0}if(this.m_count>1){var d=t.metric,_=this.GetMetric();(_<.5*d||2*d<_||_<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(u=l[0],u.indexA=0,u.indexB=0,c=e.GetVertex(0),a=o.GetVertex(0),u.wA=r.MulX(i,c),u.wB=r.MulX(s,a),u.w=r.SubtractVV(u.wB,u.wA),this.m_count=1)},w.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=Box2D.parseUInt(e[i].indexA),t.indexB[i]=Box2D.parseUInt(e[i].indexB)},w.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=r.SubtractVV(this.m_v2.w,this.m_v1.w),e=r.CrossVV(t,this.m_v1.w.GetNegative());return e>0?r.CrossFV(1,t):r.CrossVF(t,1);default:return n.b2Assert(!1),new c}},w.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return n.b2Assert(!1),new c;case 1:return this.m_v1.w;case 2:return new c(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return n.b2Assert(!1),new c}},w.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:n.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:n.b2Assert(!1)}},w.prototype.GetMetric=function(){switch(this.m_count){case 0:return n.b2Assert(!1),0;case 1:return 0;case 2:return r.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return r.CrossVV(r.SubtractVV(this.m_v2.w,this.m_v1.w),r.SubtractVV(this.m_v3.w,this.m_v1.w));default:return n.b2Assert(!1),0}},w.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=r.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var o=e.x*i.x+e.y*i.y;if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var s=1/(o+n);this.m_v1.a=o*s,this.m_v2.a=n*s,this.m_count=2},w.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=r.SubtractVV(e,t),o=r.Dot(t,n),s=r.Dot(e,n),c=s,a=-o,l=r.SubtractVV(i,t),h=r.Dot(t,l),u=r.Dot(i,l),d=u,_=-h,p=r.SubtractVV(i,e),f=r.Dot(e,p),m=r.Dot(i,p),g=m,y=-f,v=r.CrossVV(n,l),T=v*r.CrossVV(e,i),C=v*r.CrossVV(i,t),S=v*r.CrossVV(t,e);if(a<=0&&_<=0)return this.m_v1.a=1,void(this.m_count=1);if(c>0&&a>0&&S<=0){var x=1/(c+a);return this.m_v1.a=c*x,this.m_v2.a=a*x,void(this.m_count=2)}if(d>0&&_>0&&C<=0){var A=1/(d+_);return this.m_v1.a=d*A,this.m_v3.a=_*A,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(c<=0&&y<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(d<=0&&g<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(g>0&&y>0&&T<=0){var E=1/(g+y);return this.m_v2.a=g*E,this.m_v3.a=y*E,this.m_count=2,void this.m_v1.Set(this.m_v3)}var b=1/(T+C+S);this.m_v1.a=T*b,this.m_v2.a=C*b,this.m_v3.a=S*b,this.m_count=3},I.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},D.b2SimplexVertex=function(){},D.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},L.b2TimeOfImpact=function(){},L.TimeOfImpact=function(t){++L.b2_toiCalls;var e=t.proxyA,i=t.proxyB,o=t.sweepA,s=t.sweepB;n.b2Assert(o.t0==s.t0),n.b2Assert(1-o.t0>Number.MIN_VALUE);var c=e.m_radius+i.m_radius,a=t.tolerance,l=0,h=1e3,u=0,d=0;for(L.s_cache.count=0,L.s_distanceInput.useRadii=!1;;){if(o.GetTransform(L.s_xfA,l),s.GetTransform(L.s_xfB,l),L.s_distanceInput.proxyA=e,L.s_distanceInput.proxyB=i,L.s_distanceInput.transformA=L.s_xfA,L.s_distanceInput.transformB=L.s_xfB,p.Distance(L.s_distanceOutput,L.s_cache,L.s_distanceInput),L.s_distanceOutput.distance<=0){l=1;break}L.s_fcn.Initialize(L.s_cache,e,L.s_xfA,i,L.s_xfB);var _=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(_<=0){l=1;break}if(0==u&&(d=_>c?r.Max(c-a,.75*c):r.Max(_-a,.02*c)),_-d<.5*a){if(0==u){l=1;break}break}var f=l,m=l,g=1,y=_;o.GetTransform(L.s_xfA,g),s.GetTransform(L.s_xfB,g);var v=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(v>=d){l=1;break}for(var T=0;;){var C=0;C=1&T?m+(d-y)*(g-m)/(v-y):.5*(m+g),o.GetTransform(L.s_xfA,C),s.GetTransform(L.s_xfB,C);var S=L.s_fcn.Evaluate(L.s_xfA,L.s_xfB);if(r.Abs(S-d)<.025*a){f=C;break}if(S>d?(m=C,y=S):(g=C,v=S),++T,++L.b2_toiRootIters,50==T)break}if(L.b2_toiMaxRootIters=r.Max(L.b2_toiMaxRootIters,T),f<(1+100*Number.MIN_VALUE)*l)break;if(l=f,u++,++L.b2_toiIters,u==h)break}return L.b2_toiMaxIters=r.Max(L.b2_toiMaxIters,u),l},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new I,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new f,Box2D.Collision.b2TimeOfImpact.s_xfA=new s,Box2D.Collision.b2TimeOfImpact.s_xfB=new s,Box2D.Collision.b2TimeOfImpact.s_fcn=new P,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new m}),O.b2TOIInput=function(){this.proxyA=new g,this.proxyB=new g,this.sweepA=new o,this.sweepB=new o},B.b2WorldManifold=function(){this.m_normal=new c},B.prototype.b2WorldManifold=function(){this.m_points=new Vector(n.b2_maxManifoldPoints);for(var t=0;t<n.b2_maxManifoldPoints;t++)this.m_points[t]=new c},B.prototype.Initialize=function(t,e,i,n,r){if(void 0===i&&(i=0),void 0===r&&(r=0),0!=t.m_pointCount){var o,s,c=0,a=0,l=0,h=0,u=0,d=0,_=0;switch(t.m_type){case S.e_circles:s=e.R,o=t.m_localPoint;var p=e.position.x+s.col1.x*o.x+s.col2.x*o.y,f=e.position.y+s.col1.y*o.x+s.col2.y*o.y;s=n.R,o=t.m_points[0].m_localPoint;var m=n.position.x+s.col1.x*o.x+s.col2.x*o.y,g=n.position.y+s.col1.y*o.x+s.col2.y*o.y,y=m-p,v=g-f,T=y*y+v*v;if(T>Number.MIN_VALUE*Number.MIN_VALUE){var C=Math.sqrt(T);this.m_normal.x=y/C,this.m_normal.y=v/C}else this.m_normal.x=1,this.m_normal.y=0;var x=p+i*this.m_normal.x,A=f+i*this.m_normal.y,E=m-r*this.m_normal.x,b=g-r*this.m_normal.y;this.m_points[0].x=.5*(x+E),this.m_points[0].y=.5*(A+b);break;case S.e_faceA:for(s=e.R,o=t.m_localPlaneNormal,a=s.col1.x*o.x+s.col2.x*o.y,l=s.col1.y*o.x+s.col2.y*o.y,s=e.R,o=t.m_localPoint,h=e.position.x+s.col1.x*o.x+s.col2.x*o.y,u=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=a,this.m_normal.y=l,c=0;c<t.m_pointCount;c++)s=n.R,o=t.m_points[c].m_localPoint,d=n.position.x+s.col1.x*o.x+s.col2.x*o.y,_=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[c].x=d+.5*(i-(d-h)*a-(_-u)*l-r)*a,this.m_points[c].y=_+.5*(i-(d-h)*a-(_-u)*l-r)*l;break;case S.e_faceB:for(s=n.R,o=t.m_localPlaneNormal,a=s.col1.x*o.x+s.col2.x*o.y,l=s.col1.y*o.x+s.col2.y*o.y,s=n.R,o=t.m_localPoint,h=n.position.x+s.col1.x*o.x+s.col2.x*o.y,u=n.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_normal.x=-a,this.m_normal.y=-l,c=0;c<t.m_pointCount;c++)s=e.R,o=t.m_points[c].m_localPoint,d=e.position.x+s.col1.x*o.x+s.col2.x*o.y,_=e.position.y+s.col1.y*o.x+s.col2.y*o.y,this.m_points[c].x=d+.5*(r-(d-h)*a-(_-u)*l-i)*a,this.m_points[c].y=_+.5*(r-(d-h)*a-(_-u)*l-i)*l}}},N.ClipVertex=function(){this.v=new c,this.id=new d},N.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},F.Features=function(){},Object.defineProperty(F.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(F.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(F.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(F.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(F.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(F.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(F.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(F.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}(),function(){var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Collision.Shapes.b2CircleShape,i=Box2D.Collision.Shapes.b2EdgeChainDef,n=Box2D.Collision.Shapes.b2EdgeShape,r=Box2D.Collision.Shapes.b2MassData,o=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,c=Box2D.Common.Math.b2Mat22,a=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),l=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform),h=Box2D.Common.Math.b2Vec2,u=(Box2D.Common.Math.b2Vec3,Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance),d=Box2D.Collision.b2DistanceInput,_=Box2D.Collision.b2DistanceOutput,p=Box2D.Collision.b2DistanceProxy,f=(Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache);Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape),e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new h},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,e)){var i=t instanceof e?t:null;this.m_p.SetV(i.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return n=e.x-n,r=e.y-r,n*n+r*r<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,r=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),o=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-r,c=e.p1.y-o,a=s*s+c*c-this.m_radius*this.m_radius,l=e.p2.x-e.p1.x,h=e.p2.y-e.p1.y,u=s*l+c*h,d=l*l+h*h,_=u*u-d*a;if(_<0||d<Number.MIN_VALUE)return!1;var p=-(u+Math.sqrt(_));return 0<=p&&p<=e.maxFraction*d&&(p/=d,t.fraction=p,t.normal.x=s+p*l,t.normal.y=c+p*h,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),r=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,r-this.m_radius),t.upperBound.Set(n+this.m_radius,r+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=a.MulX(i,this.m_p),o=-(a.Dot(t,r)-e);if(o<-this.m_radius+Number.MIN_VALUE)return 0;if(o>this.m_radius)return n.SetV(r),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,c=o*o,l=s*(Math.asin(o/this.m_radius)+Math.PI/2)+o*Math.sqrt(s-c),h=-2/3*Math.pow(s-c,1.5)/l;return n.x=r.x+t.x*h,n.y=r.y+t.y*h,l},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=s.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(n,Box2D.Collision.Shapes.b2Shape),n.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,n.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new h,this.m_v1=new h,this.m_v2=new h,this.m_coreV1=new h,this.m_coreV2=new h,this.m_normal=new h,this.m_direction=new h,this.m_cornerDir1=new h,this.m_cornerDir2=new h},n.prototype.TestPoint=function(t,e){return!1},n.prototype.RayCast=function(t,e,i){var n,r=e.p2.x-e.p1.x,o=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),c=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-c,l=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),h=100*Number.MIN_VALUE,u=-(r*a+o*l);if(u>h){var d=e.p1.x-s,_=e.p1.y-c,p=d*a+_*l;if(0<=p&&p<=e.maxFraction*u){var f=-r*_+o*d;if(-h*u<=f&&f<=u*(1+h)){p/=u,t.fraction=p;var m=Math.sqrt(a*a+l*l);return t.normal.x=a/m,t.normal.y=l/m,!0}}}return!1},n.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),r=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),o=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<o?(t.lowerBound.x=n,t.upperBound.x=o):(t.lowerBound.x=o,t.upperBound.x=n),r<s?(t.lowerBound.y=r,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=r)},n.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},n.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=new h(t.x*e,t.y*e),o=a.MulX(i,this.m_v1),s=a.MulX(i,this.m_v2),c=a.Dot(t,o)-e,l=a.Dot(t,s)-e;if(c>0){if(l>0)return 0;o.x=-l/(c-l)*o.x+c/(c-l)*s.x,o.y=-l/(c-l)*o.y+c/(c-l)*s.y}else l>0&&(s.x=-l/(c-l)*o.x+c/(c-l)*s.x,s.y=-l/(c-l)*o.y+c/(c-l)*s.y);return n.x=(r.x+o.x+s.x)/3,n.y=(r.y+o.y+s.y)/3,.5*((o.x-r.x)*(s.y-r.y)-(o.y-r.y)*(s.x-r.x))},n.prototype.GetLength=function(){return this.m_length},n.prototype.GetVertex1=function(){return this.m_v1},n.prototype.GetVertex2=function(){return this.m_v2},n.prototype.GetCoreVertex1=function(){return this.m_coreV1},n.prototype.GetCoreVertex2=function(){return this.m_coreV2},n.prototype.GetNormalVector=function(){return this.m_normal},n.prototype.GetDirectionVector=function(){return this.m_direction},n.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},n.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},n.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},n.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},n.prototype.GetFirstVertex=function(t){var e=t.R;return new h(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},n.prototype.GetNextEdge=function(){return this.m_nextEdge},n.prototype.GetPrevEdge=function(){return this.m_prevEdge},n.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,r=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),o=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),c=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return r*e+o*i>s*e+c*i?(this.s_supportVec.x=r,this.s_supportVec.y=o):(this.s_supportVec.x=s,this.s_supportVec.y=c),this.s_supportVec},n.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=s.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},n.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},n.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},r.b2MassData=function(){this.mass=0,this.center=new h(0,0),this.I=0},Box2D.inherit(o,Box2D.Collision.Shapes.b2Shape),o.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,o.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},o.prototype.Copy=function(){var t=new o;return t.Set(this),t},o.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,o)){var e=t instanceof o?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},o.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new Vector,r=0;for(r=0;r<t.length;++r)i=t[r],n.push(i);this.SetAsVector(n,e)},o.AsArray=function(t,e){void 0===e&&(e=0);var i=new o;return i.SetAsArray(t,e),i},o.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i);var n=0;for(n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(e[n]);for(n=0;n<this.m_vertexCount;++n){var r=parseInt(n),s=parseInt(n+1<this.m_vertexCount?n+1:0),c=a.SubtractVV(this.m_vertices[s],this.m_vertices[r]);t.b2Assert(c.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(a.CrossVF(c,1)),this.m_normals[n].Normalize()}this.m_centroid=o.ComputeCentroid(this.m_vertices,this.m_vertexCount)},o.AsVector=function(t,e){void 0===e&&(e=0);var i=new o;return i.SetAsVector(t,e),i},o.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},o.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new o;return i.SetAsBox(t,e),i},o.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var r=new l;r.position=i,r.R.Set(n);for(var o=0;o<this.m_vertexCount;++o)this.m_vertices[o]=a.MulX(r,this.m_vertices[o]),this.m_normals[o]=a.MulMV(r.R,this.m_normals[o])},o.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var r=new o;return r.SetAsOrientedBox(t,e,i,n),r},o.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=a.CrossVF(a.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},o.AsEdge=function(t,e){var i=new o;return i.SetAsEdge(t,e),i},o.prototype.TestPoint=function(t,e){for(var i,n=t.R,r=e.x-t.position.x,o=e.y-t.position.y,s=r*n.col1.x+o*n.col1.y,c=r*n.col2.x+o*n.col2.y,a=0;a<this.m_vertexCount;++a){i=this.m_vertices[a],r=s-i.x,o=c-i.y,i=this.m_normals[a];var l=i.x*r+i.y*o;if(l>0)return!1}return!0},o.prototype.RayCast=function(t,e,i){var n,r,o=0,s=e.maxFraction,c=0,a=0;c=e.p1.x-i.position.x,a=e.p1.y-i.position.y,n=i.R;var l=c*n.col1.x+a*n.col1.y,h=c*n.col2.x+a*n.col2.y;c=e.p2.x-i.position.x,a=e.p2.y-i.position.y,n=i.R;for(var u=c*n.col1.x+a*n.col1.y,d=c*n.col2.x+a*n.col2.y,_=u-l,p=d-h,f=parseInt(-1),m=0;m<this.m_vertexCount;++m){r=this.m_vertices[m],c=r.x-l,a=r.y-h,r=this.m_normals[m];var g=r.x*c+r.y*a,y=r.x*_+r.y*p;if(0==y){if(g<0)return!1}else y<0&&g<o*y?(o=g/y,f=m):y>0&&g<s*y&&(s=g/y);if(s<o-Number.MIN_VALUE)return!1}return f>=0&&(t.fraction=o,n=i.R,r=this.m_normals[f],t.normal.x=n.col1.x*r.x+n.col2.x*r.y,t.normal.y=n.col1.y*r.x+n.col2.y*r.y,!0)},o.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],r=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),o=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=r,c=o,a=1;a<this.m_vertexCount;++a){n=this.m_vertices[a];var l=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),h=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);r=r<l?r:l,o=o<h?o:h,s=s>l?s:l,c=c>h?c:h}t.lowerBound.x=r-this.m_radius,t.lowerBound.y=o-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=c+this.m_radius},o.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,r=0,o=0,s=0,c=0,a=1/3,l=0;l<this.m_vertexCount;++l){var h=this.m_vertices[l],u=l+1<this.m_vertexCount?this.m_vertices[parseInt(l+1)]:this.m_vertices[0],d=h.x-s,_=h.y-c,p=u.x-s,f=u.y-c,m=d*f-_*p,g=.5*m;r+=g,i+=g*a*(s+h.x+u.x),n+=g*a*(c+h.y+u.y);var y=s,v=c,T=d,C=_,S=p,x=f,A=a*(.25*(T*T+S*T+S*S)+(y*T+y*S))+.5*y*y,E=a*(.25*(C*C+x*C+x*x)+(v*C+v*x))+.5*v*v;o+=m*(A+E)}t.mass=e*r,i*=1/r,n*=1/r,t.center.Set(i,n),t.I=e*o},o.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=a.MulTMV(i.R,t),s=e-a.Dot(t,i.position),c=new Vector_a2j_Number,l=0,u=parseInt(-1),d=parseInt(-1),_=!1,p=0;for(p=0;p<this.m_vertexCount;++p){c[p]=a.Dot(o,this.m_vertices[p])-s;var f=c[p]<-Number.MIN_VALUE;p>0&&(f?_||(u=p-1,l++):_&&(d=p-1,l++)),_=f}switch(l){case 0:if(_){var m=new r;return this.ComputeMass(m,1),n.SetV(a.MulX(i,m.center)),m.mass}return 0;case 1:u==-1?u=this.m_vertexCount-1:d=this.m_vertexCount-1}var g,y=parseInt((u+1)%this.m_vertexCount),v=parseInt((d+1)%this.m_vertexCount),T=(0-c[u])/(c[y]-c[u]),C=(0-c[d])/(c[v]-c[d]),S=new h(this.m_vertices[u].x*(1-T)+this.m_vertices[y].x*T,this.m_vertices[u].y*(1-T)+this.m_vertices[y].y*T),x=new h(this.m_vertices[d].x*(1-C)+this.m_vertices[v].x*C,this.m_vertices[d].y*(1-C)+this.m_vertices[v].y*C),A=0,E=new h,b=this.m_vertices[y];for(p=y;p!=v;){p=(p+1)%this.m_vertexCount,g=p==v?x:this.m_vertices[p];var R=.5*((b.x-S.x)*(g.y-S.y)-(b.y-S.y)*(g.x-S.x));A+=R,E.x+=R*(S.x+b.x+g.x)/3,E.y+=R*(S.y+b.y+g.y)/3,b=g}return E.Multiply(1/A),n.SetV(a.MulX(i,E)),A},o.prototype.GetVertexCount=function(){return this.m_vertexCount},o.prototype.GetVertices=function(){return this.m_vertices},o.prototype.GetNormals=function(){return this.m_normals},o.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return e},o.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var r=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;r>i&&(e=n,i=r)}return this.m_vertices[e]},o.prototype.Validate=function(){return!1},o.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=s.e_polygonShape,this.m_centroid=new h,this.m_vertices=new Vector,this.m_normals=new Vector},o.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new h,this.m_normals[e]=new h},o.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new h,n=0,r=0,o=0,s=1/3,c=0;c<e;++c){var a=t[c],l=c+1<e?t[parseInt(c+1)]:t[0],u=a.x-r,d=a.y-o,_=l.x-r,p=l.y-o,f=u*p-d*_,m=.5*f;n+=m,i.x+=m*s*(r+a.x+l.x),i.y+=m*s*(o+a.y+l.y)}return i.x*=1/n,i.y*=1/n,i},o.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,r=new Vector(i+1);for(n=0;n<i;++n)r[n]=e[n];r[i]=r[0];var o=Number.MAX_VALUE;for(n=1;n<=i;++n){var s=r[parseInt(n-1)],c=r[n].x-s.x,a=r[n].y-s.y,l=Math.sqrt(c*c+a*a);c/=l,a/=l;for(var h=-a,u=c,d=Number.MAX_VALUE,_=Number.MAX_VALUE,p=-Number.MAX_VALUE,f=-Number.MAX_VALUE,m=0;m<i;++m){var g=r[m].x-s.x,y=r[m].y-s.y,v=c*g+a*y,T=h*g+u*y;v<d&&(d=v),T<_&&(_=T),v>p&&(p=v),T>f&&(f=T)}var C=(p-d)*(f-_);if(C<.95*o){o=C,t.R.col1.x=c,t.R.col1.y=a,t.R.col2.x=h,t.R.col2.y=u;var S=.5*(d+p),x=.5*(_+f),A=t.R;t.center.x=s.x+(A.col1.x*S+A.col2.x*x),t.center.y=s.y+(A.col1.y*S+A.col2.y*x),t.extents.x=.5*(p-d),t.extents.y=.5*(f-_)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new c}),s.b2Shape=function(){},s.prototype.Copy=function(){return null},s.prototype.Set=function(t){this.m_radius=t.m_radius},s.prototype.GetType=function(){return this.m_type},s.prototype.TestPoint=function(t,e){return!1},s.prototype.RayCast=function(t,e,i){return!1},s.prototype.ComputeAABB=function(t,e){},s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},s.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},s.TestOverlap=function(t,e,i,n){var r=new d;r.proxyA=new p,r.proxyA.Set(t),r.proxyB=new p,r.proxyB.Set(i),r.transformA=e,r.transformB=n,r.useRadii=!0;var o=new f;o.count=0;var s=new _;return u.Distance(s,o,r),s.distance<10*Number.MIN_VALUE},s.prototype.b2Shape=function(){this.m_type=s.e_unknownShape,this.m_radius=t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=Box2D.Common.b2Color,e=(Box2D.Common.b2internal,Box2D.Common.b2Settings),i=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math);Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},t.prototype.Set=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){var t=(Box2D.Collision.b2AABB,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Common.Math.b2Mat22),e=Box2D.Common.Math.b2Mat33,i=Box2D.Common.Math.b2Math,n=Box2D.Common.Math.b2Sweep,r=Box2D.Common.Math.b2Transform,o=Box2D.Common.Math.b2Vec2,s=Box2D.Common.Math.b2Vec3;t.b2Mat22=function(){this.col1=new o,this.col2=new o},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,r=this.col2.y,o=e*r-i*n;return 0!=o&&(o=1/o),t.col1.x=o*r,t.col2.x=-o*i,t.col1.y=-o*n,t.col2.y=o*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,c=n*s-r*o;return 0!=c&&(c=1/c),t.x=c*(s*e-r*i),t.y=c*(n*i-o*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new s,this.col2=new s,this.col3=new s},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,r=this.col2.x,o=this.col1.y,s=this.col2.y,c=n*s-r*o;return 0!=c&&(c=1/c),t.x=c*(s*e-r*i),t.y=c*(n*i-o*e),t},e.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var r=this.col1.x,o=this.col1.y,s=this.col1.z,c=this.col2.x,a=this.col2.y,l=this.col2.z,h=this.col3.x,u=this.col3.y,d=this.col3.z,_=r*(a*d-l*u)+o*(l*h-c*d)+s*(c*u-a*h);return 0!=_&&(_=1/_),t.x=_*(e*(a*d-l*u)+i*(l*h-c*d)+n*(c*u-a*h)),t.y=_*(r*(i*d-n*u)+o*(n*h-e*d)+s*(e*u-i*h)),t.z=_*(r*(a*n-l*i)+o*(l*e-c*n)+s*(c*i-a*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){void 0===e&&(e=0);var i=new o(e*t.y,-e*t.x);return i},i.CrossFV=function(t,e){void 0===t&&(t=0);var i=new o(-t*e.y,t*e.x);return i},i.MulMV=function(t,e){var i=new o(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y);return i},i.MulTMV=function(t,e){var n=new o(i.Dot(e,t.col1),i.Dot(e,t.col2));return n},i.MulX=function(t,e){var n=i.MulMV(t.R,e);return n.x+=t.position.x,n.y+=t.position.y,n},i.MulXT=function(t,e){var n=i.SubtractVV(e,t.position),r=n.x*t.R.col1.x+n.y*t.R.col1.y;return n.y=n.x*t.R.col2.x+n.y*t.R.col2.y,n.x=r,n},i.AddVV=function(t,e){var i=new o(t.x+e.x,t.y+e.y);return i},i.SubtractVV=function(t,e){var i=new o(t.x-e.x,t.y-e.y);return i},i.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},i.MulFV=function(t,e){void 0===t&&(t=0);var i=new o(t*e.x,t*e.y);return i},i.AddMM=function(e,n){var r=t.FromVV(i.AddVV(e.col1,n.col1),i.AddVV(e.col2,n.col2));return r},i.MulMM=function(e,n){var r=t.FromVV(i.MulMV(e,n.col1),i.MulMV(e,n.col2));return r},i.MulTMM=function(e,n){var r=new o(i.Dot(e.col1,n.col1),i.Dot(e.col2,n.col1)),s=new o(i.Dot(e.col1,n.col2),i.Dot(e.col2,n.col2)),c=t.FromVV(r,s);return c},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){var e=new o(i.Abs(t.x),i.Abs(t.y));return e},i.AbsM=function(e){var n=t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2));return n},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,e){var n=new o(i.Min(t.x,e.x),i.Min(t.y,e.y));return n},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){var n=new o(i.Max(t.x,e.x),i.Max(t.y,e.y));return n},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:t>i?i:t},i.ClampV=function(t,e,n){return i.MaxV(e,i.MinV(t,n))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,t|=t>>16&65535,t+1},i.IsPowerOfTwo=function(t){void 0===t&&(t=0);var e=t>0&&0==(t&t-1);return e},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new o(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new o(1,0),new o(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new r(i.b2Vec2_zero,i.b2Mat22_identity)}),n.b2Sweep=function(){this.localCenter=new o,this.c0=new o,this.c=new o},n.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},n.prototype.Copy=function(){var t=new n;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},n.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},n.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},r.b2Transform=function(){this.position=new o,this.R=new t},r.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},r.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},r.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},r.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},r.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},o.b2Vec2=function(){},o.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},o.prototype.SetZero=function(){this.x=0,this.y=0},o.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},o.prototype.SetV=function(t){this.x=t.x,this.y=t.y},o.prototype.GetNegative=function(){return new o(-this.x,-this.y)},o.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},o.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new o(t,e)},o.prototype.Copy=function(){return new o(this.x,this.y)},o.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},o.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},o.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},o.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},o.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},o.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},o.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},o.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},o.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},o.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},o.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},o.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},o.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},s.b2Vec3=function(){},s.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetZero=function(){this.x=this.y=this.z=0},s.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},s.prototype.GetNegative=function(){return new s(-this.x,-this.y,-this.z)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},s.prototype.Copy=function(){return new s(this.x,this.y,this.z)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){var t=(Box2D.Dynamics.Controllers.b2ControllerEdge,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),e=Box2D.Common.Math.b2Sweep,i=Box2D.Common.Math.b2Transform,n=Box2D.Common.Math.b2Vec2,r=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),o=(Box2D.Common.b2internal,Box2D.Common.b2Settings),s=Box2D.Collision.b2AABB,c=(Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint),a=(Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase),l=(Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput),h=Box2D.Collision.b2RayCastOutput,u=(Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase,Box2D.Collision.Shapes.b2CircleShape),d=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),_=Box2D.Collision.Shapes.b2MassData,p=Box2D.Collision.Shapes.b2PolygonShape,f=Box2D.Collision.Shapes.b2Shape,m=Box2D.Dynamics.b2Body,g=Box2D.Dynamics.b2BodyDef,y=Box2D.Dynamics.b2ContactFilter,v=Box2D.Dynamics.b2ContactImpulse,T=Box2D.Dynamics.b2ContactListener,C=Box2D.Dynamics.b2ContactManager,S=Box2D.Dynamics.b2DebugDraw,x=Box2D.Dynamics.b2DestructionListener,A=Box2D.Dynamics.b2FilterData,E=Box2D.Dynamics.b2Fixture,b=Box2D.Dynamics.b2FixtureDef,R=Box2D.Dynamics.b2Island,P=Box2D.Dynamics.b2TimeStep,w=Box2D.Dynamics.b2World,I=(Box2D.Dynamics.Contacts.b2CircleContact,Box2D.Dynamics.Contacts.b2Contact),D=(Box2D.Dynamics.Contacts.b2ContactConstraint,Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Box2D.Dynamics.Contacts.b2ContactEdge,Box2D.Dynamics.Contacts.b2ContactFactory),L=(Box2D.Dynamics.Contacts.b2ContactRegister,Box2D.Dynamics.Contacts.b2ContactResult,Box2D.Dynamics.Contacts.b2ContactSolver),O=(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Box2D.Dynamics.Contacts.b2NullContact,Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,Box2D.Dynamics.Contacts.b2PolygonContact,Box2D.Dynamics.Contacts.b2PositionSolverManifold,Box2D.Dynamics.Controllers.b2Controller,Box2D.Dynamics.Joints.b2DistanceJoint,Box2D.Dynamics.Joints.b2DistanceJointDef,Box2D.Dynamics.Joints.b2FrictionJoint,Box2D.Dynamics.Joints.b2FrictionJointDef,Box2D.Dynamics.Joints.b2GearJoint,Box2D.Dynamics.Joints.b2GearJointDef,Box2D.Dynamics.Joints.b2Jacobian,Box2D.Dynamics.Joints.b2Joint),B=(Box2D.Dynamics.Joints.b2JointDef,Box2D.Dynamics.Joints.b2JointEdge,Box2D.Dynamics.Joints.b2LineJoint,Box2D.Dynamics.Joints.b2LineJointDef,Box2D.Dynamics.Joints.b2MouseJoint,Box2D.Dynamics.Joints.b2MouseJointDef,Box2D.Dynamics.Joints.b2PrismaticJoint,Box2D.Dynamics.Joints.b2PrismaticJointDef,Box2D.Dynamics.Joints.b2PulleyJoint);Box2D.Dynamics.Joints.b2PulleyJointDef,Box2D.Dynamics.Joints.b2RevoluteJoint,Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2WeldJoint,Box2D.Dynamics.Joints.b2WeldJointDef;m.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new n,this.m_force=new n},m.prototype.connectEdges=function(e,i,n){void 0===n&&(n=0);var r=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x),s=Math.tan(.5*(r-n)),c=t.MulFV(s,i.GetDirectionVector());c=t.SubtractVV(c,i.GetNormalVector()),c=t.MulFV(o.b2_toiSlop,c),c=t.AddVV(c,i.GetVertex1());var a=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());a.Normalize();var l=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,c,a,l),i.SetPrevEdge(e,c,a,l),r},m.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new E;if(e.Create(this,this.m_xf,t),this.m_flags&m.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=w.e_newFixture,e},m.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new b;return i.shape=t,i.density=e,this.CreateFixture(i)},m.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null,n=!1;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,n=!0;break}i=e,e=e.m_next}for(var r=this.m_contactList;r;){var o=r.contact;r=r.next;var s=o.GetFixtureA(),c=o.GetFixtureB();t!=s&&t!=c||this.m_world.m_contactManager.Destroy(o)}if(this.m_flags&m.e_activeFlag){var a=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(a)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},m.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,r=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*r.x+n.col2.x*r.y,this.m_sweep.c.y=n.col1.y*r.x+n.col2.y*r.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var o=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(o,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},m.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},m.prototype.GetTransform=function(){return this.m_xf},m.prototype.GetPosition=function(){return this.m_xf.position},m.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},m.prototype.GetAngle=function(){return this.m_sweep.a},m.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},m.prototype.GetWorldCenter=function(){return this.m_sweep.c},m.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},m.prototype.SetLinearVelocity=function(t){this.m_type!=m.b2_staticBody&&this.m_linearVelocity.SetV(t)},m.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},m.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=m.b2_staticBody&&(this.m_angularVelocity=t)},m.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},m.prototype.GetDefinition=function(){var t=new g;return t.type=this.GetType(),t.allowSleep=(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag,t.bullet=(this.m_flags&m.e_bulletFlag)==m.e_bulletFlag,t.awake=(this.m_flags&m.e_awakeFlag)==m.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},m.prototype.ApplyForce=function(t,e){this.m_type==m.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},m.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==m.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},m.prototype.ApplyImpulse=function(t,e){this.m_type==m.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},m.prototype.Split=function(e){for(var i,n=this.GetLinearVelocity().Copy(),r=this.GetAngularVelocity(),o=this.GetWorldCenter(),s=this,c=this.m_world.CreateBody(this.GetDefinition()),a=s.m_fixtureList;a;)if(e(a)){var l=a.m_next;i?i.m_next=l:s.m_fixtureList=l,s.m_fixtureCount--,a.m_next=c.m_fixtureList,c.m_fixtureList=a,c.m_fixtureCount++,a.m_body=c,a=l}else i=a,a=a.m_next;s.ResetMassData(),c.ResetMassData();var h=s.GetWorldCenter(),u=c.GetWorldCenter(),d=t.AddVV(n,t.CrossFV(r,t.SubtractVV(h,o))),_=t.AddVV(n,t.CrossFV(r,t.SubtractVV(u,o)));return s.SetLinearVelocity(d),c.SetLinearVelocity(_),s.SetAngularVelocity(r),c.SetAngularVelocity(r),s.SynchronizeFixtures(),c.SynchronizeFixtures(),c},m.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=r,e=i}n.m_fixtureCount=0;var n=this,r=t;n.GetWorldCenter(),r.GetWorldCenter(),n.GetLinearVelocity().Copy(),r.GetLinearVelocity().Copy(),n.GetAngularVelocity(),r.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},m.prototype.GetMass=function(){return this.m_mass},m.prototype.GetInertia=function(){return this.m_I},m.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},m.prototype.SetMassData=function(e){if(o.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==m.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&m.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},m.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=m.b2_staticBody&&this.m_type!=m.b2_kinematicBody){for(var e=n.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var r=i.GetMassData();this.m_mass+=r.mass,e.x+=r.center.x*r.mass,e.y+=r.center.y*r.mass,this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&m.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,o.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-s.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-s.x)}},m.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},m.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},m.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},m.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},m.prototype.GetLinearVelocityFromWorldPoint=function(t){return new n(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},m.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new n(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},m.prototype.GetLinearDamping=function(){return this.m_linearDamping},m.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},m.prototype.GetAngularDamping=function(){return this.m_angularDamping},m.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},m.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==m.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},m.prototype.GetType=function(){return this.m_type},m.prototype.SetBullet=function(t){t?this.m_flags|=m.e_bulletFlag:this.m_flags&=~m.e_bulletFlag},m.prototype.IsBullet=function(){return(this.m_flags&m.e_bulletFlag)==m.e_bulletFlag},m.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=m.e_allowSleepFlag:(this.m_flags&=~m.e_allowSleepFlag,this.SetAwake(!0))},m.prototype.SetAwake=function(t){t?(this.m_flags|=m.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~m.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},m.prototype.IsAwake=function(){return(this.m_flags&m.e_awakeFlag)==m.e_awakeFlag},m.prototype.SetFixedRotation=function(t){t?this.m_flags|=m.e_fixedRotationFlag:this.m_flags&=~m.e_fixedRotationFlag,this.ResetMassData()},m.prototype.IsFixedRotation=function(){return(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag},m.prototype.SetActive=function(t){if(t!=this.IsActive()){var e,i;if(t)for(this.m_flags|=m.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~m.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var r=n;n=n.next,this.m_world.m_contactManager.Destroy(r.contact)}this.m_contactList=null}}},m.prototype.IsActive=function(){return(this.m_flags&m.e_activeFlag)==m.e_activeFlag},m.prototype.IsSleepingAllowed=function(){return(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag},m.prototype.GetFixtureList=function(){return this.m_fixtureList},m.prototype.GetJointList=function(){return this.m_jointList},m.prototype.GetControllerList=function(){return this.m_controllerList},m.prototype.GetContactList=function(){return this.m_contactList},m.prototype.GetNext=function(){return this.m_next},m.prototype.GetUserData=function(){return this.m_userData},m.prototype.SetUserData=function(t){this.m_userData=t},m.prototype.GetWorld=function(){return this.m_world},m.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=m.e_bulletFlag),t.fixedRotation&&(this.m_flags|=m.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=m.e_allowSleepFlag),t.awake&&(this.m_flags|=m.e_awakeFlag),t.active&&(this.m_flags|=m.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==m.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},m.prototype.SynchronizeFixtures=function(){var t=m.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,i=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(e.col1.x*i.x+e.col2.x*i.y),t.position.y=this.m_sweep.c0.y-(e.col1.y*i.x+e.col2.y*i.y);var n,r=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(r,t,this.m_xf)},m.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},m.prototype.ShouldCollide=function(t){if(this.m_type!=m.b2_dynamicBody&&t.m_type!=m.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},m.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new i,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),g.b2BodyDef=function(){this.position=new n,this.linearVelocity=new n},g.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=m.b2_staticBody,this.active=!0,this.inertiaScale=1},y.b2ContactFilter=function(){},y.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();if(i.groupIndex==n.groupIndex&&0!=i.groupIndex)return i.groupIndex>0;var r=0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits);return r},y.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof E?t:null,e)},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new y}),v.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(o.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(o.b2_maxManifoldPoints)},T.b2ContactListener=function(){},T.prototype.BeginContact=function(t){},T.prototype.EndContact=function(t){},T.prototype.PreSolve=function(t,e){},T.prototype.PostSolve=function(t,e){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new T}),C.b2ContactManager=function(){},C.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=y.b2_defaultFilter,this.m_contactListener=T.b2_defaultListener,this.m_contactFactory=new D(this.m_allocator),this.m_broadPhase=new a},C.prototype.AddPair=function(t,e){var i=t instanceof E?t:null,n=e instanceof E?e:null,r=i.GetBody(),o=n.GetBody();if(r!=o){for(var s=o.GetContactList();s;){if(s.other==r){var c=s.contact.GetFixtureA(),a=s.contact.GetFixtureB();if(c==i&&a==n)return;if(c==n&&a==i)return}s=s.next}if(0!=o.ShouldCollide(r)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var l=this.m_contactFactory.Create(i,n);i=l.GetFixtureA(),n=l.GetFixtureB(),r=i.m_body,o=n.m_body,l.m_prev=null,l.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=l),this.m_world.m_contactList=l,l.m_nodeA.contact=l,l.m_nodeA.other=o,l.m_nodeA.prev=null,l.m_nodeA.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=l.m_nodeA),r.m_contactList=l.m_nodeA,l.m_nodeB.contact=l,l.m_nodeB.other=r,l.m_nodeB.prev=null,l.m_nodeB.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=l.m_nodeB),o.m_contactList=l.m_nodeB,++this.m_world.m_contactCount}}},C.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},C.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},C.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),r=i.GetBody();if(0!=n.IsAwake()||0!=r.IsAwake()){if(t.m_flags&I.e_filterFlag){if(0==r.ShouldCollide(n)){var o=t;t=o.GetNext(),this.Destroy(o);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){o=t,t=o.GetNext(),this.Destroy(o);continue}t.m_flags&=~I.e_filterFlag}var s=e.m_proxy,c=i.m_proxy,a=this.m_broadPhase.TestOverlap(s,c);0!=a?(t.Update(this.m_contactListener),t=t.GetNext()):(o=t,t=o.GetNext(),this.Destroy(o))}else t=t.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new c}),S.b2DebugDraw=function(){},S.prototype.b2DebugDraw=function(){},S.prototype.SetFlags=function(t){void 0===t&&(t=0)},S.prototype.GetFlags=function(){},S.prototype.AppendFlags=function(t){void 0===t&&(t=0)},S.prototype.ClearFlags=function(t){void 0===t&&(t=0)},S.prototype.SetSprite=function(t){},S.prototype.GetSprite=function(){},S.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},S.prototype.GetDrawScale=function(){},S.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},S.prototype.GetLineThickness=function(){},S.prototype.SetAlpha=function(t){void 0===t&&(t=0)},S.prototype.GetAlpha=function(){},S.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},S.prototype.GetFillAlpha=function(){},S.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},S.prototype.GetXFormScale=function(){},S.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},S.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},S.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},S.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},S.prototype.DrawSegment=function(t,e,i){},S.prototype.DrawTransform=function(t){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),x.b2DestructionListener=function(){},x.prototype.SayGoodbyeJoint=function(t){},x.prototype.SayGoodbyeFixture=function(t){},A.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},A.prototype.Copy=function(){var t=new A;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},E.b2Fixture=function(){this.m_filter=new A},E.prototype.GetType=function(){return this.m_shape.GetType()},E.prototype.GetShape=function(){return this.m_shape},E.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.SetSensor(n.IsSensor()||r.IsSensor()),e=e.next}},E.prototype.IsSensor=function(){return this.m_isSensor},E.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),r=i.GetFixtureB();n!=this&&r!=this||i.FlagForFiltering(),e=e.next}},E.prototype.GetFilterData=function(){return this.m_filter.Copy()},E.prototype.GetBody=function(){return this.m_body},E.prototype.GetNext=function(){return this.m_next},E.prototype.GetUserData=function(){return this.m_userData},E.prototype.SetUserData=function(t){this.m_userData=t},E.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},E.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},E.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new _),this.m_shape.ComputeMass(t,this.m_density),t},E.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},E.prototype.GetDensity=function(){return this.m_density},E.prototype.GetFriction=function(){return this.m_friction},E.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},E.prototype.GetRestitution=function(){return this.m_restitution},E.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},E.prototype.GetAABB=function(){return this.m_aabb},E.prototype.b2Fixture=function(){this.m_aabb=new s,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},E.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},E.prototype.Destroy=function(){this.m_shape=null},E.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},E.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},E.prototype.Synchronize=function(e,i,n){if(this.m_proxy){var r=new s,o=new s;this.m_shape.ComputeAABB(r,i),this.m_shape.ComputeAABB(o,n),this.m_aabb.Combine(r,o);var c=t.SubtractVV(n.position,i.position);e.MoveProxy(this.m_proxy,this.m_aabb,c)}},b.b2FixtureDef=function(){this.filter=new A},b.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},R.b2Island=function(){},R.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},R.prototype.Initialize=function(t,e,i,n,r,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=r,this.m_contactSolver=o,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},R.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},R.prototype.Solve=function(e,i,n){var r,s,c=0,a=0;for(c=0;c<this.m_bodyCount;++c)r=this.m_bodies[c],r.GetType()==m.b2_dynamicBody&&(r.m_linearVelocity.x+=e.dt*(i.x+r.m_invMass*r.m_force.x),r.m_linearVelocity.y+=e.dt*(i.y+r.m_invMass*r.m_force.y),r.m_angularVelocity+=e.dt*r.m_invI*r.m_torque,r.m_linearVelocity.Multiply(t.Clamp(1-e.dt*r.m_linearDamping,0,1)),r.m_angularVelocity*=t.Clamp(1-e.dt*r.m_angularDamping,0,1));this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var l=this.m_contactSolver;for(l.InitVelocityConstraints(e),c=0;c<this.m_jointCount;++c)s=this.m_joints[c],s.InitVelocityConstraints(e);for(c=0;c<e.velocityIterations;++c){for(a=0;a<this.m_jointCount;++a)s=this.m_joints[a],s.SolveVelocityConstraints(e);l.SolveVelocityConstraints()}for(c=0;c<this.m_jointCount;++c)s=this.m_joints[c],s.FinalizeVelocityConstraints();for(l.FinalizeVelocityConstraints(),c=0;c<this.m_bodyCount;++c)if(r=this.m_bodies[c],r.GetType()!=m.b2_staticBody){var h=e.dt*r.m_linearVelocity.x,u=e.dt*r.m_linearVelocity.y;h*h+u*u>o.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=o.b2_maxTranslation*e.inv_dt,r.m_linearVelocity.y*=o.b2_maxTranslation*e.inv_dt);var d=e.dt*r.m_angularVelocity;d*d>o.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-o.b2_maxRotation*e.inv_dt:r.m_angularVelocity=o.b2_maxRotation*e.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=e.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=e.dt*r.m_linearVelocity.y,r.m_sweep.a+=e.dt*r.m_angularVelocity,r.SynchronizeTransform()}for(c=0;c<e.positionIterations;++c){var _=l.SolvePositionConstraints(o.b2_contactBaumgarte),p=!0;for(a=0;a<this.m_jointCount;++a){s=this.m_joints[a];var f=s.SolvePositionConstraints(o.b2_contactBaumgarte);p=p&&f}if(_&&p)break}if(this.Report(l.m_constraints),n){var g=Number.MAX_VALUE,y=o.b2_linearSleepTolerance*o.b2_linearSleepTolerance,v=o.b2_angularSleepTolerance*o.b2_angularSleepTolerance;for(c=0;c<this.m_bodyCount;++c)r=this.m_bodies[c],r.GetType()!=m.b2_staticBody&&(0==(r.m_flags&m.e_allowSleepFlag)&&(r.m_sleepTime=0,g=0),0==(r.m_flags&m.e_allowSleepFlag)||r.m_angularVelocity*r.m_angularVelocity>v||t.Dot(r.m_linearVelocity,r.m_linearVelocity)>y?(r.m_sleepTime=0,g=0):(r.m_sleepTime+=e.dt,g=t.Min(g,r.m_sleepTime)));if(g>=o.b2_timeToSleep)for(c=0;c<this.m_bodyCount;++c)r=this.m_bodies[c],r.SetAwake(!1)}},R.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var r=this.m_bodies[e];if(r.GetType()!=m.b2_staticBody){var s=t.dt*r.m_linearVelocity.x,c=t.dt*r.m_linearVelocity.y;s*s+c*c>o.b2_maxTranslationSquared&&(r.m_linearVelocity.Normalize(),r.m_linearVelocity.x*=o.b2_maxTranslation*t.inv_dt,r.m_linearVelocity.y*=o.b2_maxTranslation*t.inv_dt);var a=t.dt*r.m_angularVelocity;a*a>o.b2_maxRotationSquared&&(r.m_angularVelocity<0?r.m_angularVelocity=-o.b2_maxRotation*t.inv_dt:r.m_angularVelocity=o.b2_maxRotation*t.inv_dt),r.m_sweep.c0.SetV(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_sweep.c.x+=t.dt*r.m_linearVelocity.x,r.m_sweep.c.y+=t.dt*r.m_linearVelocity.y,r.m_sweep.a+=t.dt*r.m_angularVelocity,r.SynchronizeTransform()}}var l=.75;for(e=0;e<t.positionIterations;++e){var h=n.SolvePositionConstraints(l),u=!0;for(i=0;i<this.m_jointCount;++i){var d=this.m_joints[i].SolvePositionConstraints(o.b2_contactBaumgarte);u=u&&d}if(h&&u)break}this.Report(n.m_constraints)},R.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],r=0;r<n.pointCount;++r)R.s_impulse.normalImpulses[r]=n.points[r].normalImpulse,R.s_impulse.tangentImpulses[r]=n.points[r].tangentImpulse;this.m_listener.PostSolve(i,R.s_impulse)}},R.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},R.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},R.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new v}),P.b2TimeStep=function(){},P.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},w.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new C,this.m_contactSolver=new L,this.m_island=new R},w.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,w.m_warmStarting=!0,w.m_continuousPhysics=!0,this.m_allowSleep=e,t.y=t.y,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new g;this.m_groundBody=this.CreateBody(i)},w.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},w.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},w.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},w.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},w.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},w.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},w.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},w.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new m(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},w.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var r=n;n=n.nextController,r.controller.RemoveBody(t)}for(var o=t.m_contactList;o;){var s=o;o=o.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var c=t.m_fixtureList;c;){var a=c;c=c.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(a),a.DestroyProxy(this.m_contactManager.m_broadPhase),a.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},w.prototype.CreateJoint=function(t){var e=O.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next;return e},w.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,O.Destroy(t,null),--this.m_jointCount,0==e)for(var r=n.GetContactList();r;)r.other==i&&r.contact.FlagForFiltering(),r=r.next},w.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},w.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},w.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},w.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},w.prototype.SetWarmStarting=function(t){w.m_warmStarting=t},w.prototype.SetContinuousPhysics=function(t){w.m_continuousPhysics=t},w.prototype.GetBodyCount=function(){return this.m_bodyCount},w.prototype.GetJointCount=function(){return this.m_jointCount},w.prototype.GetContactCount=function(){return this.m_contactCount},w.prototype.SetGravity=function(t){this.m_gravity=t},w.prototype.GetGravity=function(){return this.m_gravity},w.prototype.GetGroundBody=function(){return this.m_groundBody},w.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&w.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~w.e_newFixture),this.m_flags|=w.e_locked;var n=w.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,t>0?n.inv_dt=1/t:n.inv_dt=0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=w.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),w.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~w.e_locked},w.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},w.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,o,c,a,l=this.m_debugDraw.GetFlags(),h=(new n,new n,new n,new s,new s,[new n,new n,new n,new n]),u=new r(0,0,0);if(l&S.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(a=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?(u.Set(.5,.5,.3),this.DrawShape(i,a,u)):t.GetType()==m.b2_staticBody?(u.Set(.5,.9,.5),this.DrawShape(i,a,u)):t.GetType()==m.b2_kinematicBody?(u.Set(.5,.5,.9),this.DrawShape(i,a,u)):0==t.IsAwake()?(u.Set(.6,.6,.6),this.DrawShape(i,a,u)):(u.Set(.9,.7,.7),this.DrawShape(i,a,u));if(l&S.e_jointBit)for(o=this.m_jointList;o;o=o.m_next)this.DrawJoint(o);if(l&S.e_controllerBit)for(var d=this.m_controllerList;d;d=d.m_next)d.Draw(this.m_debugDraw);if(l&S.e_pairBit){u.Set(.3,.9,.9);for(var _=this.m_contactManager.m_contactList;_;_=_.GetNext()){var p=_.GetFixtureA(),f=_.GetFixtureB(),g=p.GetAABB().GetCenter(),y=f.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(g,y,u)}}if(l&S.e_aabbBit)for(c=this.m_contactManager.m_broadPhase,h=[new n,new n,new n,new n],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var v=c.GetFatAABB(e.m_proxy);h[0].Set(v.lowerBound.x,v.lowerBound.y),h[1].Set(v.upperBound.x,v.lowerBound.y),h[2].Set(v.upperBound.x,v.upperBound.y),h[3].Set(v.lowerBound.x,v.upperBound.y),this.m_debugDraw.DrawPolygon(h,4,u)}if(l&S.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)a=w.s_xf,a.R=t.m_xf.R,a.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}},w.prototype.QueryAABB=function(t,e){function i(e){return t(r.GetUserData(e))}var n=this,r=n.m_contactManager.m_broadPhase;r.Query(i,e)},w.prototype.QueryShape=function(t,e,n){function r(i){var r=c.GetUserData(i)instanceof E?c.GetUserData(i):null;return!f.TestOverlap(e,n,r.GetShape(),r.GetBody().GetTransform())||t(r)}var o=this;void 0===n&&(n=null),null==n&&(n=new i,n.SetIdentity());var c=o.m_contactManager.m_broadPhase,a=new s;e.ComputeAABB(a,n),c.Query(r,a)},w.prototype.QueryPoint=function(t,e){function i(i){var n=r.GetUserData(i)instanceof E?r.GetUserData(i):null;return!n.TestPoint(e)||t(n)}var n=this,r=n.m_contactManager.m_broadPhase,c=new s;c.lowerBound.Set(e.x-o.b2_linearSlop,e.y-o.b2_linearSlop),c.upperBound.Set(e.x+o.b2_linearSlop,e.y+o.b2_linearSlop),r.Query(i,c)},w.prototype.RayCast=function(t,e,i){function r(r,o){var a=s.GetUserData(o),l=a instanceof E?a:null,h=l.RayCast(c,r);if(h){var u=c.fraction,d=new n((1-u)*e.x+u*i.x,(1-u)*e.y+u*i.y);return t(l,d,c.normal,u)}return r.maxFraction}var o=this,s=o.m_contactManager.m_broadPhase,c=new h,a=new l(e,i);s.RayCast(r,a)},w.prototype.RayCastOne=function(t,e){function i(t,e,i,r){return void 0===r&&(r=0),n=t,r}var n,r=this;return r.RayCast(i,t,e),n},w.prototype.RayCastAll=function(t,e){function i(t,e,i,n){return void 0===n&&(n=0),r[r.length]=t,1}var n=this,r=new Vector;return n.RayCast(i,t,e),r},w.prototype.GetBodyList=function(){return this.m_bodyList},w.prototype.GetJointList=function(){return this.m_jointList},w.prototype.GetContactList=function(){return this.m_contactList},w.prototype.IsLocked=function(){return(this.m_flags&w.e_locked)>0},w.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~m.e_islandFlag;for(var r=this.m_contactList;r;r=r.m_next)r.m_flags&=~I.e_islandFlag;for(var o=this.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var s=(parseInt(this.m_bodyCount),this.s_stack),c=this.m_bodyList;c;c=c.m_next)if(!(c.m_flags&m.e_islandFlag)&&0!=c.IsAwake()&&0!=c.IsActive()&&c.GetType()!=m.b2_staticBody){n.Clear();var a=0;for(s[a++]=c,c.m_flags|=m.e_islandFlag;a>0;)if(e=s[--a],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=m.b2_staticBody){for(var l,h=e.m_contactList;h;h=h.next)h.contact.m_flags&I.e_islandFlag||1!=h.contact.IsSensor()&&0!=h.contact.IsEnabled()&&0!=h.contact.IsTouching()&&(n.AddContact(h.contact),h.contact.m_flags|=I.e_islandFlag,l=h.other,l.m_flags&m.e_islandFlag||(s[a++]=l,l.m_flags|=m.e_islandFlag));for(var u=e.m_jointList;u;u=u.next)1!=u.joint.m_islandFlag&&(l=u.other,0!=l.IsActive()&&(n.AddJoint(u.joint),u.joint.m_islandFlag=!0,l.m_flags&m.e_islandFlag||(s[a++]=l,l.m_flags|=m.e_islandFlag)))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var d=0;d<n.m_bodyCount;++d)e=n.m_bodies[d],e.GetType()==m.b2_staticBody&&(e.m_flags&=~m.e_islandFlag)}for(d=0;d<s.length&&s[d];++d)s[d]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=m.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},w.prototype.SolveTOI=function(t){var e,i,n,r,s,c,a,l=this.m_island;l.Initialize(this.m_bodyCount,o.b2_maxTOIContactsPerIsland,o.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var h=w.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~m.e_islandFlag,e.m_sweep.t0=0;var u;for(u=this.m_contactList;u;u=u.m_next)u.m_flags&=~(I.e_toiFlag|I.e_islandFlag);for(a=this.m_jointList;a;a=a.m_next)a.m_islandFlag=!1;for(;;){var d=null,_=1;for(u=this.m_contactList;u;u=u.m_next)if(1!=u.IsSensor()&&0!=u.IsEnabled()&&0!=u.IsContinuous()){var p=1;if(u.m_flags&I.e_toiFlag)p=u.m_toi;else{if(i=u.m_fixtureA,n=u.m_fixtureB,r=i.m_body,s=n.m_body,!(r.GetType()==m.b2_dynamicBody&&0!=r.IsAwake()||s.GetType()==m.b2_dynamicBody&&0!=s.IsAwake()))continue;var f=r.m_sweep.t0;r.m_sweep.t0<s.m_sweep.t0?(f=s.m_sweep.t0,r.m_sweep.Advance(f)):s.m_sweep.t0<r.m_sweep.t0&&(f=r.m_sweep.t0,s.m_sweep.Advance(f)),p=u.ComputeTOI(r.m_sweep,s.m_sweep),o.b2Assert(0<=p&&p<=1),p>0&&p<1&&(p=(1-p)*f+p,p>1&&(p=1)),u.m_toi=p,u.m_flags|=I.e_toiFlag}Number.MIN_VALUE<p&&p<_&&(d=u,_=p)}if(null==d||1-100*Number.MIN_VALUE<_)break;if(i=d.m_fixtureA,n=d.m_fixtureB,r=i.m_body,s=n.m_body,w.s_backupA.Set(r.m_sweep),w.s_backupB.Set(s.m_sweep),r.Advance(_),s.Advance(_),d.Update(this.m_contactManager.m_contactListener),d.m_flags&=~I.e_toiFlag,1!=d.IsSensor()&&0!=d.IsEnabled()){if(0!=d.IsTouching()){var g=r;g.GetType()!=m.b2_dynamicBody&&(g=s),l.Clear();var y=0,v=0;for(h[y+v++]=g,g.m_flags|=m.e_islandFlag;v>0;)if(e=h[y++],--v,l.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==m.b2_dynamicBody){for(c=e.m_contactList;c&&l.m_contactCount!=l.m_contactCapacity;c=c.next)if(!(c.contact.m_flags&I.e_islandFlag)&&1!=c.contact.IsSensor()&&0!=c.contact.IsEnabled()&&0!=c.contact.IsTouching()){l.AddContact(c.contact),c.contact.m_flags|=I.e_islandFlag;var T=c.other;T.m_flags&m.e_islandFlag||(T.GetType()!=m.b2_staticBody&&(T.Advance(_),T.SetAwake(!0)),h[y+v]=T,++v,T.m_flags|=m.e_islandFlag)}for(var C=e.m_jointList;C;C=C.next)l.m_jointCount!=l.m_jointCapacity&&1!=C.joint.m_islandFlag&&(T=C.other,0!=T.IsActive()&&(l.AddJoint(C.joint),C.joint.m_islandFlag=!0,T.m_flags&m.e_islandFlag||(T.GetType()!=m.b2_staticBody&&(T.Advance(_),T.SetAwake(!0)),h[y+v]=T,++v,T.m_flags|=m.e_islandFlag)))}var S=w.s_timestep;S.warmStarting=!1,S.dt=(1-_)*t.dt,S.inv_dt=1/S.dt,S.dtRatio=0,S.velocityIterations=t.velocityIterations,S.positionIterations=t.positionIterations,l.SolveTOI(S);var x=0;for(x=0;x<l.m_bodyCount;++x)if(e=l.m_bodies[x],e.m_flags&=~m.e_islandFlag,0!=e.IsAwake()&&e.GetType()==m.b2_dynamicBody)for(e.SynchronizeFixtures(),c=e.m_contactList;c;c=c.next)c.contact.m_flags&=~I.e_toiFlag;for(x=0;x<l.m_contactCount;++x)u=l.m_contacts[x],u.m_flags&=~(I.e_toiFlag|I.e_islandFlag);for(x=0;x<l.m_jointCount;++x)a=l.m_joints[x],a.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else r.m_sweep.Set(w.s_backupA),s.m_sweep.Set(w.s_backupB),r.SynchronizeTransform(),s.SynchronizeTransform()}},w.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,r=i.m_xf,o=n.position,s=r.position,c=t.GetAnchorA(),a=t.GetAnchorB(),l=w.s_jointColor;switch(t.m_type){case O.e_distanceJoint:this.m_debugDraw.DrawSegment(c,a,l);break;case O.e_pulleyJoint:var h=t instanceof B?t:null,u=h.GetGroundAnchorA(),d=h.GetGroundAnchorB();this.m_debugDraw.DrawSegment(u,c,l),this.m_debugDraw.DrawSegment(d,a,l),this.m_debugDraw.DrawSegment(u,d,l);break;case O.e_mouseJoint:this.m_debugDraw.DrawSegment(c,a,l);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(o,c,l),this.m_debugDraw.DrawSegment(c,a,l),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,a,l)}},w.prototype.DrawShape=function(e,i,n){switch(e.m_type){case f.e_circleShape:var r=e instanceof u?e:null,o=t.MulX(i,r.m_p),s=r.m_radius,c=i.R.col1;this.m_debugDraw.DrawSolidCircle(o,s,c,n);break;case f.e_polygonShape:var a=0,l=e instanceof p?e:null,h=parseInt(l.GetVertexCount()),_=l.GetVertices(),m=new Vector(h);for(a=0;a<h;++a)m[a]=t.MulX(i,_[a]);this.m_debugDraw.DrawSolidPolygon(m,h,n);break;case f.e_edgeShape:var g=e instanceof d?e:null;this.m_debugDraw.DrawSegment(t.MulX(i,g.GetVertex1()),t.MulX(i,g.GetVertex2()),n)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new P,Box2D.Dynamics.b2World.s_xf=new i,Box2D.Dynamics.b2World.s_backupA=new e,Box2D.Dynamics.b2World.s_backupB=new e,Box2D.Dynamics.b2World.s_timestep=new P,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new r(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),i=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),n=Box2D.Collision.Shapes.b2Shape,r=Box2D.Dynamics.Contacts.b2CircleContact,o=Box2D.Dynamics.Contacts.b2Contact,s=Box2D.Dynamics.Contacts.b2ContactConstraint,c=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,a=Box2D.Dynamics.Contacts.b2ContactEdge,l=Box2D.Dynamics.Contacts.b2ContactFactory,h=Box2D.Dynamics.Contacts.b2ContactRegister,u=Box2D.Dynamics.Contacts.b2ContactResult,d=Box2D.Dynamics.Contacts.b2ContactSolver,_=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,p=Box2D.Dynamics.Contacts.b2NullContact,f=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,m=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,g=Box2D.Dynamics.Contacts.b2PolygonContact,y=Box2D.Dynamics.Contacts.b2PositionSolverManifold,v=Box2D.Dynamics.b2Body,T=(Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep),C=(Box2D.Dynamics.b2World,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),S=Box2D.Common.Math.b2Mat22,x=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),A=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),E=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision),b=Box2D.Collision.b2ContactID,R=(Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold),P=(Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact),w=Box2D.Collision.b2TOIInput,I=Box2D.Collision.b2WorldManifold;Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(r,Box2D.Dynamics.Contacts.b2Contact),r.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,r.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},r.Create=function(t){return new r},r.Destroy=function(t,e){},r.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},r.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();E.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},o.b2Contact=function(){this.m_nodeA=new a,this.m_nodeB=new a,this.m_manifold=new R,this.m_oldManifold=new R},o.prototype.GetManifold=function(){return this.m_manifold},o.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),r.m_radius)},o.prototype.IsTouching=function(){return(this.m_flags&o.e_touchingFlag)==o.e_touchingFlag},o.prototype.IsContinuous=function(){return(this.m_flags&o.e_continuousFlag)==o.e_continuousFlag},o.prototype.SetSensor=function(t){t?this.m_flags|=o.e_sensorFlag:this.m_flags&=~o.e_sensorFlag},o.prototype.IsSensor=function(){return(this.m_flags&o.e_sensorFlag)==o.e_sensorFlag},o.prototype.SetEnabled=function(t){t?this.m_flags|=o.e_enabledFlag:this.m_flags&=~o.e_enabledFlag},o.prototype.IsEnabled=function(){return(this.m_flags&o.e_enabledFlag)==o.e_enabledFlag},o.prototype.GetNext=function(){return this.m_next},o.prototype.GetFixtureA=function(){return this.m_fixtureA},o.prototype.GetFixtureB=function(){return this.m_fixtureB},o.prototype.FlagForFiltering=function(){this.m_flags|=o.e_filterFlag},o.prototype.b2Contact=function(){},o.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=o.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=o.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=v.b2_dynamicBody||i.IsBullet()||n.GetType()!=v.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=o.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},o.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=o.e_enabledFlag;var i=!1,r=(this.m_flags&o.e_touchingFlag)==o.e_touchingFlag,s=this.m_fixtureA.m_body,c=this.m_fixtureB.m_body,a=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&o.e_sensorFlag){if(a){var l=this.m_fixtureA.GetShape(),h=this.m_fixtureB.GetShape(),u=s.GetTransform(),d=c.GetTransform();i=n.TestOverlap(l,u,h,d)}this.m_manifold.m_pointCount=0}else{if(s.GetType()!=v.b2_dynamicBody||s.IsBullet()||c.GetType()!=v.b2_dynamicBody||c.IsBullet()?this.m_flags|=o.e_continuousFlag:this.m_flags&=~o.e_continuousFlag,a){this.Evaluate(),i=this.m_manifold.m_pointCount>0;for(var _=0;_<this.m_manifold.m_pointCount;++_){var p=this.m_manifold.m_points[_];p.m_normalImpulse=0,p.m_tangentImpulse=0;for(var f=p.m_id,m=0;m<this.m_oldManifold.m_pointCount;++m){var g=this.m_oldManifold.m_points[m];if(g.m_id.key==f.key){p.m_normalImpulse=g.m_normalImpulse,p.m_tangentImpulse=g.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=r&&(s.SetAwake(!0),c.SetAwake(!0))}i?this.m_flags|=o.e_touchingFlag:this.m_flags&=~o.e_touchingFlag,0==r&&1==i&&t.BeginContact(this),1==r&&0==i&&t.EndContact(this),0==(this.m_flags&o.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},o.prototype.Evaluate=function(){},o.prototype.ComputeTOI=function(t,e){return o.s_input.proxyA.Set(this.m_fixtureA.GetShape()),o.s_input.proxyB.Set(this.m_fixtureB.GetShape()),o.s_input.sweepA=t,o.s_input.sweepB=e,o.s_input.tolerance=C.b2_linearSlop,P.TimeOfImpact(o.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new w}),s.b2ContactConstraint=function(){this.localPlaneNormal=new A,this.localPoint=new A,this.normal=new A,this.normalMass=new S,this.K=new S},s.prototype.b2ContactConstraint=function(){this.points=new Vector(C.b2_maxManifoldPoints);for(var t=0;t<C.b2_maxManifoldPoints;t++)this.points[t]=new c},c.b2ContactConstraintPoint=function(){this.localPoint=new A,this.rA=new A,this.rB=new A},a.b2ContactEdge=function(){},l.b2ContactFactory=function(){},l.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},l.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},l.prototype.InitializeRegisters=function(){this.m_registers=new Vector(n.e_shapeTypeCount);for(var t=0;t<n.e_shapeTypeCount;t++){this.m_registers[t]=new Vector(n.e_shapeTypeCount);for(var e=0;e<n.e_shapeTypeCount;e++)this.m_registers[t][e]=new h}this.AddType(r.Create,r.Destroy,n.e_circleShape,n.e_circleShape),this.AddType(f.Create,f.Destroy,n.e_polygonShape,n.e_circleShape),this.AddType(g.Create,g.Destroy,n.e_polygonShape,n.e_polygonShape),this.AddType(_.Create,_.Destroy,n.e_edgeShape,n.e_circleShape),this.AddType(m.Create,m.Destroy,n.e_polygonShape,n.e_edgeShape)},l.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),r=parseInt(e.GetType()),o=this.m_registers[n][r];if(o.pool)return i=o.pool,o.pool=i.m_next,o.poolCount--,i.Reset(t,e),i;var s=o.createFcn;return null!=s?o.primary?(i=s(this.m_allocator),i.Reset(t,e),i):(i=s(this.m_allocator),i.Reset(e,t),i):null},l.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t;var r=n.destroyFcn;r(t,this.m_allocator)},h.b2ContactRegister=function(){},u.b2ContactResult=function(){this.position=new A,this.normal=new A,this.id=new b},d.b2ContactSolver=function(){this.m_step=new T,this.m_constraints=new Vector},d.prototype.b2ContactSolver=function(){},d.prototype.Initialize=function(t,e,i,n){void 0===i&&(i=0);var r;this.m_step.Set(t),this.m_allocator=n;var o=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new s;for(o=0;o<i;++o){r=e[o];var c=r.m_fixtureA,a=r.m_fixtureB,l=c.m_shape,h=a.m_shape,u=l.m_radius,_=h.m_radius,p=c.m_body,f=a.m_body,m=r.GetManifold(),g=C.b2MixFriction(c.GetFriction(),a.GetFriction()),y=C.b2MixRestitution(c.GetRestitution(),a.GetRestitution()),v=p.m_linearVelocity.x,T=p.m_linearVelocity.y,S=f.m_linearVelocity.x,x=f.m_linearVelocity.y,A=p.m_angularVelocity,E=f.m_angularVelocity;C.b2Assert(m.m_pointCount>0),d.s_worldManifold.Initialize(m,p.m_xf,u,f.m_xf,_);var b=d.s_worldManifold.m_normal.x,R=d.s_worldManifold.m_normal.y,P=this.m_constraints[o];P.bodyA=p,P.bodyB=f,P.manifold=m,P.normal.x=b,P.normal.y=R,P.pointCount=m.m_pointCount,P.friction=g,P.restitution=y,P.localPlaneNormal.x=m.m_localPlaneNormal.x,P.localPlaneNormal.y=m.m_localPlaneNormal.y,P.localPoint.x=m.m_localPoint.x,P.localPoint.y=m.m_localPoint.y,P.radius=u+_,P.type=m.m_type;for(var w=0;w<P.pointCount;++w){var I=m.m_points[w],D=P.points[w];D.normalImpulse=I.m_normalImpulse,D.tangentImpulse=I.m_tangentImpulse,D.localPoint.SetV(I.m_localPoint);var L=D.rA.x=d.s_worldManifold.m_points[w].x-p.m_sweep.c.x,O=D.rA.y=d.s_worldManifold.m_points[w].y-p.m_sweep.c.y,B=D.rB.x=d.s_worldManifold.m_points[w].x-f.m_sweep.c.x,N=D.rB.y=d.s_worldManifold.m_points[w].y-f.m_sweep.c.y,F=L*R-O*b,M=B*R-N*b;F*=F,M*=M;var V=p.m_invMass+f.m_invMass+p.m_invI*F+f.m_invI*M;D.normalMass=1/V;var k=p.m_mass*p.m_invMass+f.m_mass*f.m_invMass;k+=p.m_mass*p.m_invI*F+f.m_mass*f.m_invI*M,D.equalizedMass=1/k;var G=R,W=-b,z=L*W-O*G,U=B*W-N*G;z*=z,U*=U;var Y=p.m_invMass+f.m_invMass+p.m_invI*z+f.m_invI*U;D.tangentMass=1/Y,D.velocityBias=0;var X=S+-E*N-v- -A*O,H=x+E*B-T-A*L,j=P.normal.x*X+P.normal.y*H;j<-C.b2_velocityThreshold&&(D.velocityBias+=-P.restitution*j)}if(2==P.pointCount){var q=P.points[0],Z=P.points[1],J=p.m_invMass,K=p.m_invI,Q=f.m_invMass,$=f.m_invI,tt=q.rA.x*R-q.rA.y*b,et=q.rB.x*R-q.rB.y*b,it=Z.rA.x*R-Z.rA.y*b,nt=Z.rB.x*R-Z.rB.y*b,rt=J+Q+K*tt*tt+$*et*et,ot=J+Q+K*it*it+$*nt*nt,st=J+Q+K*tt*it+$*et*nt,ct=100;rt*rt<ct*(rt*ot-st*st)?(P.K.col1.Set(rt,st),P.K.col2.Set(st,ot),P.K.GetInverse(P.normalMass)):P.pointCount=1}}},d.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,r=i.bodyB,o=n.m_invMass,s=n.m_invI,c=r.m_invMass,a=r.m_invI,l=i.normal.x,h=i.normal.y,u=h,d=-l,_=0,p=0;if(t.warmStarting)for(p=i.pointCount,_=0;_<p;++_){var f=i.points[_];f.normalImpulse*=t.dtRatio,f.tangentImpulse*=t.dtRatio;var m=f.normalImpulse*l+f.tangentImpulse*u,g=f.normalImpulse*h+f.tangentImpulse*d;n.m_angularVelocity-=s*(f.rA.x*g-f.rA.y*m),n.m_linearVelocity.x-=o*m,n.m_linearVelocity.y-=o*g,r.m_angularVelocity+=a*(f.rB.x*g-f.rB.y*m),r.m_linearVelocity.x+=c*m,r.m_linearVelocity.y+=c*g}else for(p=i.pointCount,_=0;_<p;++_){var y=i.points[_];y.normalImpulse=0,y.tangentImpulse=0}}},d.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,r=0,o=0,s=0,c=0,a=0,l=0,h=0,u=0,d=0,_=0,p=0,f=0,m=0,g=0,y=0;y<this.m_constraintCount;++y){var v=this.m_constraints[y],T=v.bodyA,C=v.bodyB,S=T.m_angularVelocity,A=C.m_angularVelocity,E=T.m_linearVelocity,b=C.m_linearVelocity,R=T.m_invMass,P=T.m_invI,w=C.m_invMass,I=C.m_invI,D=v.normal.x,L=v.normal.y,O=L,B=-D,N=v.friction;for(i=0;i<v.pointCount;i++)t=v.points[i],n=b.x-A*t.rB.y-E.x+S*t.rA.y,r=b.y+A*t.rB.x-E.y-S*t.rA.x,s=n*O+r*B,c=t.tangentMass*-s,a=N*t.normalImpulse,l=x.Clamp(t.tangentImpulse+c,-a,a),c=l-t.tangentImpulse,h=c*O,u=c*B,E.x-=R*h,E.y-=R*u,S-=P*(t.rA.x*u-t.rA.y*h),b.x+=w*h,b.y+=w*u,A+=I*(t.rB.x*u-t.rB.y*h),t.tangentImpulse=l;parseInt(v.pointCount);if(1==v.pointCount)t=v.points[0],n=b.x+-A*t.rB.y-E.x- -S*t.rA.y,r=b.y+A*t.rB.x-E.y-S*t.rA.x,o=n*D+r*L,c=-t.normalMass*(o-t.velocityBias),l=t.normalImpulse+c,l=l>0?l:0,c=l-t.normalImpulse,h=c*D,u=c*L,E.x-=R*h,E.y-=R*u,S-=P*(t.rA.x*u-t.rA.y*h),b.x+=w*h,b.y+=w*u,A+=I*(t.rB.x*u-t.rB.y*h),t.normalImpulse=l;else{var F=v.points[0],M=v.points[1],V=F.normalImpulse,k=M.normalImpulse,G=b.x-A*F.rB.y-E.x+S*F.rA.y,W=b.y+A*F.rB.x-E.y-S*F.rA.x,z=b.x-A*M.rB.y-E.x+S*M.rA.y,U=b.y+A*M.rB.x-E.y-S*M.rA.x,Y=G*D+W*L,X=z*D+U*L,H=Y-F.velocityBias,j=X-M.velocityBias;e=v.K,H-=e.col1.x*V+e.col2.x*k,j-=e.col1.y*V+e.col2.y*k;for(;;){e=v.normalMass;var q=-(e.col1.x*H+e.col2.x*j),Z=-(e.col1.y*H+e.col2.y*j);if(q>=0&&Z>=0){d=q-V,_=Z-k,p=d*D,f=d*L,m=_*D,g=_*L,E.x-=R*(p+m),E.y-=R*(f+g),S-=P*(F.rA.x*f-F.rA.y*p+M.rA.x*g-M.rA.y*m),b.x+=w*(p+m),b.y+=w*(f+g),A+=I*(F.rB.x*f-F.rB.y*p+M.rB.x*g-M.rB.y*m),F.normalImpulse=q,M.normalImpulse=Z;break}if(q=-F.normalMass*H,Z=0,Y=0,X=v.K.col1.y*q+j,q>=0&&X>=0){d=q-V,_=Z-k,p=d*D,f=d*L,m=_*D,g=_*L,E.x-=R*(p+m),E.y-=R*(f+g),S-=P*(F.rA.x*f-F.rA.y*p+M.rA.x*g-M.rA.y*m),b.x+=w*(p+m),b.y+=w*(f+g),A+=I*(F.rB.x*f-F.rB.y*p+M.rB.x*g-M.rB.y*m),F.normalImpulse=q,M.normalImpulse=Z;break}if(q=0,Z=-M.normalMass*j,Y=v.K.col2.x*Z+H,X=0,Z>=0&&Y>=0){d=q-V,_=Z-k,p=d*D,f=d*L,m=_*D,g=_*L,E.x-=R*(p+m),E.y-=R*(f+g),S-=P*(F.rA.x*f-F.rA.y*p+M.rA.x*g-M.rA.y*m),b.x+=w*(p+m),b.y+=w*(f+g),A+=I*(F.rB.x*f-F.rB.y*p+M.rB.x*g-M.rB.y*m),F.normalImpulse=q,M.normalImpulse=Z;break}if(q=0,Z=0,Y=H,X=j,Y>=0&&X>=0){d=q-V,_=Z-k,p=d*D,f=d*L,m=_*D,g=_*L,E.x-=R*(p+m),E.y-=R*(f+g),S-=P*(F.rA.x*f-F.rA.y*p+M.rA.x*g-M.rA.y*m),b.x+=w*(p+m),b.y+=w*(f+g),A+=I*(F.rB.x*f-F.rB.y*p+M.rB.x*g-M.rB.y*m),F.normalImpulse=q,M.normalImpulse=Z;break}break}}T.m_angularVelocity=S,C.m_angularVelocity=A}},d.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var r=i.m_points[n],o=e.points[n];r.m_normalImpulse=o.normalImpulse,r.m_tangentImpulse=o.tangentImpulse}},d.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],r=n.bodyA,o=n.bodyB,s=r.m_mass*r.m_invMass,c=r.m_mass*r.m_invI,a=o.m_mass*o.m_invMass,l=o.m_mass*o.m_invI;d.s_psm.Initialize(n);for(var h=d.s_psm.m_normal,u=0;u<n.pointCount;u++){var _=n.points[u],p=d.s_psm.m_points[u],f=d.s_psm.m_separations[u],m=p.x-r.m_sweep.c.x,g=p.y-r.m_sweep.c.y,y=p.x-o.m_sweep.c.x,v=p.y-o.m_sweep.c.y;e=e<f?e:f;var T=x.Clamp(t*(f+C.b2_linearSlop),-C.b2_maxLinearCorrection,0),S=-_.equalizedMass*T,A=S*h.x,E=S*h.y;r.m_sweep.c.x-=s*A,r.m_sweep.c.y-=s*E,r.m_sweep.a-=c*(m*E-g*A),r.SynchronizeTransform(),o.m_sweep.c.x+=a*A,o.m_sweep.c.y+=a*E,o.m_sweep.a+=l*(y*E-v*A),o.SynchronizeTransform()}}return e>-1.5*C.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new I,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new y}),Box2D.inherit(_,Box2D.Dynamics.Contacts.b2Contact),_.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,_.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},_.Create=function(t){return new _},_.Destroy=function(t,e){},_.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},_.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},_.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,r){},Box2D.inherit(p,Box2D.Dynamics.Contacts.b2Contact),p.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,p.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},p.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},p.prototype.Evaluate=function(){},Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact),f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,f.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},f.Create=function(t){return new f},f.Destroy=function(t,e){},f.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),C.b2Assert(t.GetType()==n.e_polygonShape),C.b2Assert(e.GetType()==n.e_circleShape)},f.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;E.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact),m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,m.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},m.Create=function(t){return new m},m.Destroy=function(t,e){},m.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),C.b2Assert(t.GetType()==n.e_polygonShape),C.b2Assert(e.GetType()==n.e_edgeShape)},m.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},m.prototype.b2CollidePolyAndEdge=function(t,e,i,n,r){},Box2D.inherit(g,Box2D.Dynamics.Contacts.b2Contact),g.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,g.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},g.Create=function(t){return new g},g.Destroy=function(t,e){},g.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},g.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();E.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},y.b2PositionSolverManifold=function(){},y.prototype.b2PositionSolverManifold=function(){this.m_normal=new A,this.m_separations=new Vector_a2j_Number(C.b2_maxManifoldPoints),this.m_points=new Vector(C.b2_maxManifoldPoints);for(var t=0;t<C.b2_maxManifoldPoints;t++)this.m_points[t]=new A},y.prototype.Initialize=function(t){C.b2Assert(t.pointCount>0);var e,i,n=0,r=0,o=0,s=0,c=0;switch(t.type){case R.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var a=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),l=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var h=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),u=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),d=h-a,_=u-l,p=d*d+_*_;if(p>Number.MIN_VALUE*Number.MIN_VALUE){var f=Math.sqrt(p);this.m_normal.x=d/f,this.m_normal.y=_/f}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(a+h),this.m_points[0].y=.5*(l+u),this.m_separations[0]=d*this.m_normal.x+_*this.m_normal.y-t.radius;break;case R.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-c)*this.m_normal.y-t.radius,this.m_points[n].x=r,this.m_points[n].y=o;break;case R.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,r=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),o=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(r-s)*this.m_normal.x+(o-c)*this.m_normal.y-t.radius,this.m_points[n].Set(r,o);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new A,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new A})}(),function(){var t=(Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Common.Math.b2Mat22),e=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),i=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),n=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),r=(Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape,Box2D.Collision.Shapes.b2Shape,Box2D.Dynamics.Controllers.b2BuoyancyController),o=Box2D.Dynamics.Controllers.b2ConstantAccelController,s=Box2D.Dynamics.Controllers.b2ConstantForceController,c=Box2D.Dynamics.Controllers.b2Controller,a=Box2D.Dynamics.Controllers.b2ControllerEdge,l=Box2D.Dynamics.Controllers.b2GravityController,h=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller),r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,r.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.offset=0,this.density=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},r.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var n=e.body;if(0!=n.IsAwake()){for(var r=new i,o=new i,s=0,c=0,a=n.GetFixtureList();a;a=a.GetNext()){var l=new i,h=a.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),l);s+=h,r.x+=h*l.x,r.y+=h*l.y;var u=0;u=(this.useDensity,1),c+=h*u,o.x+=h*l.x*u,o.y+=h*l.y*u}if(r.x/=s,r.y/=s,o.x/=c,o.y/=c,!(s<Number.MIN_VALUE)){var d=this.gravity.GetNegative();d.Multiply(this.density*s),n.ApplyForce(d,o);var _=n.GetLinearVelocityFromWorldPoint(r);_.Subtract(this.velocity),_.Multiply(-this.linearDrag*s),n.ApplyForce(_,r),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}}}}},r.prototype.Draw=function(t){var e=1e3,r=new i,o=new i;r.x=this.normal.x*this.offset+this.normal.y*e,r.y=this.normal.y*this.offset-this.normal.x*e,o.x=this.normal.x*this.offset-this.normal.y*e,o.y=this.normal.y*this.offset+this.normal.x*e;var s=new n(0,0,1);t.DrawSegment(r,o,s)},Box2D.inherit(o,Box2D.Dynamics.Controllers.b2Controller),o.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,o.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},o.prototype.Step=function(t){for(var e=new i(this.A.x*t.dt,this.A.y*t.dt),n=this.m_bodyList;n;n=n.nextBody){var r=n.body;r.IsAwake()&&r.SetLinearVelocity(new i(r.GetLinearVelocity().x+e.x,r.GetLinearVelocity().y+e.y))}},Box2D.inherit(s,Box2D.Dynamics.Controllers.b2Controller),s.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},s.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},c.b2Controller=function(){},c.prototype.Step=function(t){},c.prototype.Draw=function(t){},c.prototype.AddBody=function(t){var e=new a;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},c.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},c.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},c.prototype.GetNext=function(){return this.m_next},c.prototype.GetWorld=function(){return this.m_world},c.prototype.GetBodyList=function(){return this.m_bodyList},a.b2ControllerEdge=function(){},Box2D.inherit(l,Box2D.Dynamics.Controllers.b2Controller),l.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,l.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},l.prototype.Step=function(t){var e=null,n=null,r=null,o=0,s=null,c=null,a=null,l=0,h=0,u=0,d=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,r=n.GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)c=s.body,a=c.GetWorldCenter(),l=a.x-r.x,h=a.y-r.y,u=l*l+h*h,u<Number.MIN_VALUE||(d=new i(l,h),d.Multiply(this.G/u/Math.sqrt(u)*o*c.GetMass()),n.IsAwake()&&n.ApplyForce(d,r),d.Multiply(-1),c.IsAwake()&&c.ApplyForce(d,a));else for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,r=n.GetWorldCenter(),o=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)c=s.body,a=c.GetWorldCenter(),l=a.x-r.x,h=a.y-r.y,u=l*l+h*h,u<Number.MIN_VALUE||(d=new i(l,h),d.Multiply(this.G/u*o*c.GetMass()),n.IsAwake()&&n.ApplyForce(d,r),d.Multiply(-1),c.IsAwake()&&c.ApplyForce(d,a))},Box2D.inherit(h,Box2D.Dynamics.Controllers.b2Controller),h.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,h.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},h.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,t>0||e>0?this.maxTimestep=1/Math.max(t,e):this.maxTimestep=0},h.prototype.Step=function(t){var n=t.dt;if(!(n<=Number.MIN_VALUE)){n>this.maxTimestep&&this.maxTimestep>0&&(n=this.maxTimestep);for(var r=this.m_bodyList;r;r=r.nextBody){var o=r.body;if(o.IsAwake()){var s=o.GetWorldVector(e.MulMV(this.T,o.GetLocalVector(o.GetLinearVelocity())));o.SetLinearVelocity(new i(o.GetLinearVelocity().x+s.x*n,o.GetLinearVelocity().y+s.y*n))}}}}}(),function(){var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,n=Box2D.Common.Math.b2Math,r=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),o=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,c=Box2D.Dynamics.Joints.b2DistanceJointDef,a=Box2D.Dynamics.Joints.b2FrictionJoint,l=Box2D.Dynamics.Joints.b2FrictionJointDef,h=Box2D.Dynamics.Joints.b2GearJoint,u=Box2D.Dynamics.Joints.b2GearJointDef,d=Box2D.Dynamics.Joints.b2Jacobian,_=Box2D.Dynamics.Joints.b2Joint,p=Box2D.Dynamics.Joints.b2JointDef,f=Box2D.Dynamics.Joints.b2JointEdge,m=Box2D.Dynamics.Joints.b2LineJoint,g=Box2D.Dynamics.Joints.b2LineJointDef,y=Box2D.Dynamics.Joints.b2MouseJoint,v=Box2D.Dynamics.Joints.b2MouseJointDef,T=Box2D.Dynamics.Joints.b2PrismaticJoint,C=Box2D.Dynamics.Joints.b2PrismaticJointDef,S=Box2D.Dynamics.Joints.b2PulleyJoint,x=Box2D.Dynamics.Joints.b2PulleyJointDef,A=Box2D.Dynamics.Joints.b2RevoluteJoint,E=Box2D.Dynamics.Joints.b2RevoluteJointDef,b=Box2D.Dynamics.Joints.b2WeldJoint,R=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint),s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u=new r},s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},s.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},s.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},s.prototype.GetLength=function(){return this.m_length},s.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},s.prototype.GetFrequency=function(){return this.m_frequencyHz},s.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},s.prototype.GetDampingRatio=function(){return this.m_dampingRatio},s.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},s.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},s.prototype.InitVelocityConstraints=function(e){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,c=this.m_localAnchor1.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*c,c=i.col1.y*s+i.col2.y*c,s=n,i=o.m_xf.R;var a=this.m_localAnchor2.x-o.m_sweep.localCenter.x,l=this.m_localAnchor2.y-o.m_sweep.localCenter.y;n=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=n,this.m_u.x=o.m_sweep.c.x+a-r.m_sweep.c.x-s,this.m_u.y=o.m_sweep.c.y+l-r.m_sweep.c.y-c;var h=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);h>t.b2_linearSlop?this.m_u.Multiply(1/h):this.m_u.SetZero();var u=s*this.m_u.y-c*this.m_u.x,d=a*this.m_u.y-l*this.m_u.x,_=r.m_invMass+r.m_invI*u*u+o.m_invMass+o.m_invI*d*d;if(this.m_mass=0!=_?1/_:0,this.m_frequencyHz>0){var p=h-this.m_length,f=2*Math.PI*this.m_frequencyHz,m=2*this.m_mass*this.m_dampingRatio*f,g=this.m_mass*f*f;this.m_gamma=e.dt*(m+e.dt*g),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=p*e.dt*g*this.m_gamma,this.m_mass=_+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var y=this.m_impulse*this.m_u.x,v=this.m_impulse*this.m_u.y;r.m_linearVelocity.x-=r.m_invMass*y,r.m_linearVelocity.y-=r.m_invMass*v,r.m_angularVelocity-=r.m_invI*(s*v-c*y),o.m_linearVelocity.x+=o.m_invMass*y,o.m_linearVelocity.y+=o.m_invMass*v,o.m_angularVelocity+=o.m_invI*(a*v-l*y)}else this.m_impulse=0},s.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,o=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*r+e.col2.x*o;o=e.col1.y*r+e.col2.y*o,r=s,e=n.m_xf.R;var c=this.m_localAnchor2.x-n.m_sweep.localCenter.x,a=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*c+e.col2.x*a,a=e.col1.y*c+e.col2.y*a,c=s;var l=i.m_linearVelocity.x+-i.m_angularVelocity*o,h=i.m_linearVelocity.y+i.m_angularVelocity*r,u=n.m_linearVelocity.x+-n.m_angularVelocity*a,d=n.m_linearVelocity.y+n.m_angularVelocity*c,_=this.m_u.x*(u-l)+this.m_u.y*(d-h),p=-this.m_mass*(_+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=p;var f=p*this.m_u.x,m=p*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*f,i.m_linearVelocity.y-=i.m_invMass*m,i.m_angularVelocity-=i.m_invI*(r*m-o*f),n.m_linearVelocity.x+=n.m_invMass*f,n.m_linearVelocity.y+=n.m_invMass*m,n.m_angularVelocity+=n.m_invI*(c*m-a*f)},s.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i;if(this.m_frequencyHz>0)return!0;var r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchor1.x-r.m_sweep.localCenter.x,c=this.m_localAnchor1.y-r.m_sweep.localCenter.y,a=i.col1.x*s+i.col2.x*c;c=i.col1.y*s+i.col2.y*c,s=a,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,h=this.m_localAnchor2.y-o.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*h,h=i.col1.y*l+i.col2.y*h,l=a;var u=o.m_sweep.c.x+l-r.m_sweep.c.x-s,d=o.m_sweep.c.y+h-r.m_sweep.c.y-c,_=Math.sqrt(u*u+d*d);u/=_,d/=_;var p=_-this.m_length;p=n.Clamp(p,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var f=-this.m_mass*p;this.m_u.Set(u,d);var m=f*this.m_u.x,g=f*this.m_u.y;return r.m_sweep.c.x-=r.m_invMass*m,r.m_sweep.c.y-=r.m_invMass*g,r.m_sweep.a-=r.m_invI*(s*g-c*m),o.m_sweep.c.x+=o.m_invMass*m,o.m_sweep.c.y+=o.m_invMass*g,o.m_sweep.a+=o.m_invI*(l*g-h*m),r.SynchronizeTransform(),o.SynchronizeTransform(),n.Abs(p)<t.b2_linearSlop},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},c.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},c.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var r=n.x-i.x,o=n.y-i.y;this.length=Math.sqrt(r*r+o*o),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(a,Box2D.Dynamics.Joints.b2Joint),a.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,a.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_linearMass=new e,this.m_linearImpulse=new r},a.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},a.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},a.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},a.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},a.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},a.prototype.GetMaxForce=function(){return this.m_maxForce},a.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},a.prototype.GetMaxTorque=function(){return this.m_maxTorque},a.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},a.prototype.InitVelocityConstraints=function(t){var i,n=0,r=this.m_bodyA,o=this.m_bodyB;i=r.m_xf.R;var s=this.m_localAnchorA.x-r.m_sweep.localCenter.x,c=this.m_localAnchorA.y-r.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*c,c=i.col1.y*s+i.col2.y*c,s=n,i=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;n=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=n;var h=r.m_invMass,u=o.m_invMass,d=r.m_invI,_=o.m_invI,p=new e;if(p.col1.x=h+u,p.col2.x=0,p.col1.y=0,p.col2.y=h+u,p.col1.x+=d*c*c,p.col2.x+=-d*s*c,p.col1.y+=-d*s*c,p.col2.y+=d*s*s,p.col1.x+=_*l*l,p.col2.x+=-_*a*l,p.col1.y+=-_*a*l,p.col2.y+=_*a*a,p.GetInverse(this.m_linearMass),this.m_angularMass=d+_,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var f=this.m_linearImpulse;r.m_linearVelocity.x-=h*f.x,r.m_linearVelocity.y-=h*f.y,r.m_angularVelocity-=d*(s*f.y-c*f.x+this.m_angularImpulse),o.m_linearVelocity.x+=u*f.x,o.m_linearVelocity.y+=u*f.y,o.m_angularVelocity+=_*(a*f.y-l*f.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},a.prototype.SolveVelocityConstraints=function(t){var e,i=0,o=this.m_bodyA,s=this.m_bodyB,c=o.m_linearVelocity,a=o.m_angularVelocity,l=s.m_linearVelocity,h=s.m_angularVelocity,u=o.m_invMass,d=s.m_invMass,_=o.m_invI,p=s.m_invI;e=o.m_xf.R;var f=this.m_localAnchorA.x-o.m_sweep.localCenter.x,m=this.m_localAnchorA.y-o.m_sweep.localCenter.y;i=e.col1.x*f+e.col2.x*m,m=e.col1.y*f+e.col2.y*m,f=i,e=s.m_xf.R;var g=this.m_localAnchorB.x-s.m_sweep.localCenter.x,y=this.m_localAnchorB.y-s.m_sweep.localCenter.y;i=e.col1.x*g+e.col2.x*y,y=e.col1.y*g+e.col2.y*y,g=i;var v=0,T=h-a,C=-this.m_angularMass*T,S=this.m_angularImpulse;v=t.dt*this.m_maxTorque,this.m_angularImpulse=n.Clamp(this.m_angularImpulse+C,-v,v),C=this.m_angularImpulse-S,a-=_*C,h+=p*C;var x=l.x-h*y-c.x+a*m,A=l.y+h*g-c.y-a*f,E=n.MulMV(this.m_linearMass,new r(-x,-A)),b=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(E),v=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>v*v&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(v)),E=n.SubtractVV(this.m_linearImpulse,b),c.x-=u*E.x,c.y-=u*E.y,a-=_*(f*E.y-m*E.x),l.x+=d*E.x,l.y+=d*E.y,h+=p*(g*E.y-y*E.x),o.m_angularVelocity=a,s.m_angularVelocity=h},a.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(l,Box2D.Dynamics.Joints.b2JointDef),l.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,l.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},l.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_frictionJoint,this.maxForce=0,this.maxTorque=0},l.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},Box2D.inherit(h,Box2D.Dynamics.Joints.b2Joint),h.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,h.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_J=new d},h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},h.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},h.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,r=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=r;var o=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*o)},h.prototype.GetRatio=function(){return this.m_ratio},h.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},h.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,r=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==_.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof A?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),n=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof T?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),n=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==_.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof A?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),r=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof T?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),r=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*r,this.m_impulse=0},h.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,r=this.m_ground2,o=this.m_bodyA,s=this.m_bodyB,c=0,a=0,l=0,h=0,u=0,d=0,_=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,_+=o.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,c=e.col1.x*i.x+e.col2.x*i.y,a=e.col1.y*i.x+e.col2.y*i.y,e=o.m_xf.R,l=this.m_localAnchor1.x-o.m_sweep.localCenter.x,h=this.m_localAnchor1.y-o.m_sweep.localCenter.y,d=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=d,u=l*a-h*c,this.m_J.linearA.Set(-c,-a),this.m_J.angularA=-u,_+=o.m_invMass+o.m_invI*u*u),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,_+=this.m_ratio*this.m_ratio*s.m_invI):(e=r.m_xf.R,i=this.m_prismatic2.m_localXAxis1,c=e.col1.x*i.x+e.col2.x*i.y,a=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,l=this.m_localAnchor2.x-s.m_sweep.localCenter.x,h=this.m_localAnchor2.y-s.m_sweep.localCenter.y,d=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=d,u=l*a-h*c,this.m_J.linearB.Set(-this.m_ratio*c,-this.m_ratio*a),this.m_J.angularB=-this.m_ratio*u,_+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*u*u)),this.m_mass=_>0?1/_:0,t.warmStarting?(o.m_linearVelocity.x+=o.m_invMass*this.m_impulse*this.m_J.linearA.x,o.m_linearVelocity.y+=o.m_invMass*this.m_impulse*this.m_J.linearA.y,o.m_angularVelocity+=o.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},h.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),r=-this.m_mass*n;this.m_impulse+=r,e.m_linearVelocity.x+=e.m_invMass*r*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*r*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*r*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*r*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*r*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*r*this.m_J.angularB},h.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i=0,n=this.m_bodyA,r=this.m_bodyB,o=0,s=0;o=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),s=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var c=this.m_constant-(o+this.m_ratio*s),a=-this.m_mass*c;return n.m_sweep.c.x+=n.m_invMass*a*this.m_J.linearA.x,n.m_sweep.c.y+=n.m_invMass*a*this.m_J.linearA.y,n.m_sweep.a+=n.m_invI*a*this.m_J.angularA,r.m_sweep.c.x+=r.m_invMass*a*this.m_J.linearB.x,r.m_sweep.c.y+=r.m_invMass*a*this.m_J.linearB.y,r.m_sweep.a+=r.m_invI*a*this.m_J.angularB,n.SynchronizeTransform(),r.SynchronizeTransform(),i<t.b2_linearSlop},Box2D.inherit(u,Box2D.Dynamics.Joints.b2JointDef),u.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,u.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},u.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},d.b2Jacobian=function(){this.linearA=new r,this.linearB=new r},d.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},d.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},d.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},_.b2Joint=function(){this.m_edgeA=new f,this.m_edgeB=new f,this.m_localCenterA=new r,this.m_localCenterB=new r},_.prototype.GetType=function(){return this.m_type},_.prototype.GetAnchorA=function(){return null},_.prototype.GetAnchorB=function(){return null},_.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},_.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},_.prototype.GetBodyA=function(){return this.m_bodyA},_.prototype.GetBodyB=function(){return this.m_bodyB},_.prototype.GetNext=function(){return this.m_next},_.prototype.GetUserData=function(){return this.m_userData},_.prototype.SetUserData=function(t){this.m_userData=t},_.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},_.Create=function(t,e){var i=null;switch(t.type){case _.e_distanceJoint:i=new s(t instanceof c?t:null);break;case _.e_mouseJoint:i=new y(t instanceof v?t:null);break;case _.e_prismaticJoint:i=new T(t instanceof C?t:null);break;case _.e_revoluteJoint:i=new A(t instanceof E?t:null);break;case _.e_pulleyJoint:i=new S(t instanceof x?t:null);break;case _.e_gearJoint:i=new h(t instanceof u?t:null);break;case _.e_lineJoint:i=new m(t instanceof g?t:null);break;case _.e_weldJoint:i=new b(t instanceof R?t:null);break;case _.e_frictionJoint:i=new a(t instanceof l?t:null)}return i},_.Destroy=function(t,e){},_.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},_.prototype.InitVelocityConstraints=function(t){},_.prototype.SolveVelocityConstraints=function(t){},_.prototype.FinalizeVelocityConstraints=function(){},_.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),p.b2JointDef=function(){},p.prototype.b2JointDef=function(){this.type=_.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},f.b2JointEdge=function(){},Box2D.inherit(m,Box2D.Dynamics.Joints.b2Joint),m.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,m.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new e,this.m_impulse=new r},m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},m.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},m.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},m.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1),c=s.x*r+s.y*o;return c},m.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,c=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*c,c=t.col1.y*s+t.col2.y*c,s=o;var a=e.m_sweep.c.x+n,l=e.m_sweep.c.y+r,h=i.m_sweep.c.x+s,u=i.m_sweep.c.y+c,d=h-a,_=u-l,p=e.GetWorldVector(this.m_localXAxis1),f=e.m_linearVelocity,m=i.m_linearVelocity,g=e.m_angularVelocity,y=i.m_angularVelocity,v=d*(-g*p.y)+_*(g*p.x)+(p.x*(m.x+-y*c-f.x- -g*r)+p.y*(m.y+y*s-f.y-g*n));return v},m.prototype.IsLimitEnabled=function(){return this.m_enableLimit},m.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},m.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},m.prototype.GetUpperLimit=function(){return this.m_upperTranslation},m.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},m.prototype.IsMotorEnabled=function(){return this.m_enableMotor},m.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},m.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},m.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},m.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},m.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},m.prototype.GetMotorForce=function(){return this.m_motorImpulse},m.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=_.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},m.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(r.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var c=r.GetTransform();o.GetTransform();i=r.m_xf.R;var a=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=o.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*h+i.col2.x*u,u=i.col1.y*h+i.col2.y*u,h=s;var d=o.m_sweep.c.x+h-r.m_sweep.c.x-a,p=o.m_sweep.c.y+u-r.m_sweep.c.y-l;this.m_invMassA=r.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=r.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(n.MulMV(c.R,this.m_localXAxis1)),this.m_a1=(d+a)*this.m_axis.y-(p+l)*this.m_axis.x,this.m_a2=h*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(n.MulMV(c.R,this.m_localYAxis1)),this.m_s1=(d+a)*this.m_perp.y-(p+l)*this.m_perp.x,this.m_s2=h*this.m_perp.y-u*this.m_perp.x;var f=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,y=this.m_invIB;if(this.m_K.col1.x=f+m+g*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=f+m+g*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*d+this.m_axis.y*p;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=_.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=_.e_atLowerLimit&&(this.m_limitState=_.e_atLowerLimit,this.m_impulse.y=0):v>=this.m_upperTranslation?this.m_limitState!=_.e_atUpperLimit&&(this.m_limitState=_.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=_.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=_.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var T=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,C=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,S=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,x=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;r.m_linearVelocity.x-=this.m_invMassA*T,r.m_linearVelocity.y-=this.m_invMassA*C,r.m_angularVelocity-=this.m_invIA*S,o.m_linearVelocity.x+=this.m_invMassB*T,o.m_linearVelocity.y+=this.m_invMassB*C,o.m_angularVelocity+=this.m_invIB*x}else this.m_impulse.SetZero(),this.m_motorImpulse=0},m.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,o=e.m_linearVelocity,s=e.m_angularVelocity,c=i.m_linearVelocity,a=i.m_angularVelocity,l=0,h=0,u=0,d=0;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var p=this.m_axis.x*(c.x-o.x)+this.m_axis.y*(c.y-o.y)+this.m_a2*a-this.m_a1*s,f=this.m_motorMass*(this.m_motorSpeed-p),m=this.m_motorImpulse,g=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+f,-g,g),f=this.m_motorImpulse-m,l=f*this.m_axis.x,h=f*this.m_axis.y,u=f*this.m_a1,d=f*this.m_a2,o.x-=this.m_invMassA*l,o.y-=this.m_invMassA*h,s-=this.m_invIA*u,c.x+=this.m_invMassB*l,c.y+=this.m_invMassB*h,a+=this.m_invIB*d}var y=this.m_perp.x*(c.x-o.x)+this.m_perp.y*(c.y-o.y)+this.m_s2*a-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var v=this.m_axis.x*(c.x-o.x)+this.m_axis.y*(c.y-o.y)+this.m_a2*a-this.m_a1*s,T=this.m_impulse.Copy(),C=this.m_K.Solve(new r,-y,-v);this.m_impulse.Add(C),this.m_limitState==_.e_atLowerLimit?this.m_impulse.y=n.Max(this.m_impulse.y,0):this.m_limitState==_.e_atUpperLimit&&(this.m_impulse.y=n.Min(this.m_impulse.y,0));var S=-y-(this.m_impulse.y-T.y)*this.m_K.col2.x,x=0;x=0!=this.m_K.col1.x?S/this.m_K.col1.x+T.x:T.x,this.m_impulse.x=x,C.x=this.m_impulse.x-T.x,C.y=this.m_impulse.y-T.y,l=C.x*this.m_perp.x+C.y*this.m_axis.x,h=C.x*this.m_perp.y+C.y*this.m_axis.y,u=C.x*this.m_s1+C.y*this.m_a1,d=C.x*this.m_s2+C.y*this.m_a2,o.x-=this.m_invMassA*l,o.y-=this.m_invMassA*h,s-=this.m_invIA*u,c.x+=this.m_invMassB*l,c.y+=this.m_invMassB*h,a+=this.m_invIB*d}else{var A=0;A=0!=this.m_K.col1.x?-y/this.m_K.col1.x:0,this.m_impulse.x+=A,l=A*this.m_perp.x,h=A*this.m_perp.y,u=A*this.m_s1,d=A*this.m_s2,o.x-=this.m_invMassA*l,o.y-=this.m_invMassA*h,s-=this.m_invIA*u,c.x+=this.m_invMassB*l,c.y+=this.m_invMassB*h,a+=this.m_invIB*d}e.m_linearVelocity.SetV(o),e.m_angularVelocity=s,i.m_linearVelocity.SetV(c),i.m_angularVelocity=a},m.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var o,s=this.m_bodyA,c=this.m_bodyB,a=s.m_sweep.c,l=s.m_sweep.a,h=c.m_sweep.c,u=c.m_sweep.a,d=0,_=0,p=0,f=0,m=0,g=0,y=0,v=!1,T=0,C=e.FromAngle(l),S=e.FromAngle(u);o=C;var x=this.m_localAnchor1.x-this.m_localCenterA.x,A=this.m_localAnchor1.y-this.m_localCenterA.y;d=o.col1.x*x+o.col2.x*A,A=o.col1.y*x+o.col2.y*A,x=d,o=S;var E=this.m_localAnchor2.x-this.m_localCenterB.x,b=this.m_localAnchor2.y-this.m_localCenterB.y;d=o.col1.x*E+o.col2.x*b,b=o.col1.y*E+o.col2.y*b,E=d;var R=h.x+E-a.x-x,P=h.y+b-a.y-A;if(this.m_enableLimit){this.m_axis=n.MulMV(C,this.m_localXAxis1),this.m_a1=(R+x)*this.m_axis.y-(P+A)*this.m_axis.x,this.m_a2=E*this.m_axis.y-b*this.m_axis.x;var w=this.m_axis.x*R+this.m_axis.y*P;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(T=n.Clamp(w,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),g=n.Abs(w),v=!0):w<=this.m_lowerTranslation?(T=n.Clamp(w-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),g=this.m_lowerTranslation-w,v=!0):w>=this.m_upperTranslation&&(T=n.Clamp(w-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),g=w-this.m_upperTranslation,v=!0)}this.m_perp=n.MulMV(C,this.m_localYAxis1),this.m_s1=(R+x)*this.m_perp.y-(P+A)*this.m_perp.x,this.m_s2=E*this.m_perp.y-b*this.m_perp.x;var I=new r,D=this.m_perp.x*R+this.m_perp.y*P;if(g=n.Max(g,n.Abs(D)),y=0,v)_=this.m_invMassA,p=this.m_invMassB,f=this.m_invIA,m=this.m_invIB,this.m_K.col1.x=_+p+f*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,this.m_K.col1.y=f*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+p+f*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2,this.m_K.Solve(I,-D,-T);else{_=this.m_invMassA,p=this.m_invMassB,f=this.m_invIA,m=this.m_invIB;var L=_+p+f*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2,O=0;O=0!=L?-D/L:0,I.x=O,I.y=0}var B=I.x*this.m_perp.x+I.y*this.m_axis.x,N=I.x*this.m_perp.y+I.y*this.m_axis.y,F=I.x*this.m_s1+I.y*this.m_a1,M=I.x*this.m_s2+I.y*this.m_a2;return a.x-=this.m_invMassA*B,a.y-=this.m_invMassA*N,l-=this.m_invIA*F,h.x+=this.m_invMassB*B,h.y+=this.m_invMassB*N,u+=this.m_invIB*M,s.m_sweep.a=l,c.m_sweep.a=u,s.SynchronizeTransform(),c.SynchronizeTransform(),g<=t.b2_linearSlop&&y<=t.b2_angularSlop},Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef),g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,g.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},g.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},g.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},Box2D.inherit(y,Box2D.Dynamics.Joints.b2Joint),y.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,y.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new r,this.m_target=new r,this.m_impulse=new r,this.m_mass=new e,this.m_C=new r},y.prototype.GetAnchorA=function(){return this.m_target},y.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},y.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},y.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},y.prototype.GetTarget=function(){return this.m_target},y.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},y.prototype.GetMaxForce=function(){return this.m_maxForce},y.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},y.prototype.GetFrequency=function(){return this.m_frequencyHz},y.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},y.prototype.GetDampingRatio=function(){return this.m_dampingRatio},y.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},y.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},y.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,i=e.GetMass(),n=2*Math.PI*this.m_frequencyHz,r=2*i*this.m_dampingRatio*n,o=i*n*n;this.m_gamma=t.dt*(r+t.dt*o),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*o*this.m_gamma;var s;s=e.m_xf.R;var c=this.m_localAnchor.x-e.m_sweep.localCenter.x,a=this.m_localAnchor.y-e.m_sweep.localCenter.y,l=s.col1.x*c+s.col2.x*a;a=s.col1.y*c+s.col2.y*a,c=l;var h=e.m_invMass,u=e.m_invI;this.K1.col1.x=h,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=h,this.K2.col1.x=u*a*a,this.K2.col2.x=-u*c*a,this.K2.col1.y=-u*c*a,this.K2.col2.y=u*c*c,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+c-this.m_target.x,this.m_C.y=e.m_sweep.c.y+a-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=h*this.m_impulse.x,e.m_linearVelocity.y+=h*this.m_impulse.y,e.m_angularVelocity+=u*(c*this.m_impulse.y-a*this.m_impulse.x)},y.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyB,n=0,r=0;e=i.m_xf.R;var o=this.m_localAnchor.x-i.m_sweep.localCenter.x,s=this.m_localAnchor.y-i.m_sweep.localCenter.y;n=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=n;var c=i.m_linearVelocity.x+-i.m_angularVelocity*s,a=i.m_linearVelocity.y+i.m_angularVelocity*o;e=this.m_mass,n=c+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,r=a+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var l=-(e.col1.x*n+e.col2.x*r),h=-(e.col1.y*n+e.col2.y*r),u=this.m_impulse.x,d=this.m_impulse.y;this.m_impulse.x+=l,this.m_impulse.y+=h;var _=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>_*_&&this.m_impulse.Multiply(_/this.m_impulse.Length()),l=this.m_impulse.x-u,h=this.m_impulse.y-d,i.m_linearVelocity.x+=i.m_invMass*l,i.m_linearVelocity.y+=i.m_invMass*h,i.m_angularVelocity+=i.m_invI*(o*h-s*l)},y.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef),v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,v.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new r},v.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(T,Box2D.Dynamics.Joints.b2Joint),T.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,T.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_localXAxis1=new r,this.m_localYAxis1=new r,this.m_axis=new r,this.m_perp=new r,this.m_K=new i,this.m_impulse=new o},T.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},T.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},T.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},T.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},T.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),r=n.x-i.x,o=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1),c=s.x*r+s.y*o;return c},T.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,r=this.m_localAnchor1.y-e.m_sweep.localCenter.y,o=t.col1.x*n+t.col2.x*r;r=t.col1.y*n+t.col2.y*r,n=o,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,c=this.m_localAnchor2.y-i.m_sweep.localCenter.y;o=t.col1.x*s+t.col2.x*c,c=t.col1.y*s+t.col2.y*c,s=o;var a=e.m_sweep.c.x+n,l=e.m_sweep.c.y+r,h=i.m_sweep.c.x+s,u=i.m_sweep.c.y+c,d=h-a,_=u-l,p=e.GetWorldVector(this.m_localXAxis1),f=e.m_linearVelocity,m=i.m_linearVelocity,g=e.m_angularVelocity,y=i.m_angularVelocity,v=d*(-g*p.y)+_*(g*p.x)+(p.x*(m.x+-y*c-f.x- -g*r)+p.y*(m.y+y*s-f.y-g*n));return v},T.prototype.IsLimitEnabled=function(){return this.m_enableLimit},T.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},T.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},T.prototype.GetUpperLimit=function(){return this.m_upperTranslation},T.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},T.prototype.IsMotorEnabled=function(){return this.m_enableMotor},T.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},T.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},T.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},T.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},T.prototype.GetMotorForce=function(){return this.m_motorImpulse},T.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=_.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},T.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_localCenterA.SetV(r.GetLocalCenter()),this.m_localCenterB.SetV(o.GetLocalCenter());var c=r.GetTransform();o.GetTransform();i=r.m_xf.R;var a=this.m_localAnchor1.x-this.m_localCenterA.x,l=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=o.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,u=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*h+i.col2.x*u,u=i.col1.y*h+i.col2.y*u,h=s;var d=o.m_sweep.c.x+h-r.m_sweep.c.x-a,p=o.m_sweep.c.y+u-r.m_sweep.c.y-l;this.m_invMassA=r.m_invMass,this.m_invMassB=o.m_invMass,this.m_invIA=r.m_invI,this.m_invIB=o.m_invI,this.m_axis.SetV(n.MulMV(c.R,this.m_localXAxis1)),this.m_a1=(d+a)*this.m_axis.y-(p+l)*this.m_axis.x,this.m_a2=h*this.m_axis.y-u*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(n.MulMV(c.R,this.m_localYAxis1)),this.m_s1=(d+a)*this.m_perp.y-(p+l)*this.m_perp.x,this.m_s2=h*this.m_perp.y-u*this.m_perp.x;var f=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,y=this.m_invIB;if(this.m_K.col1.x=f+m+g*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1+y*this.m_s2,this.m_K.col1.z=g*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=g+y,this.m_K.col2.z=g*this.m_a1+y*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=f+m+g*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*d+this.m_axis.y*p;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=_.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=_.e_atLowerLimit&&(this.m_limitState=_.e_atLowerLimit,this.m_impulse.z=0):v>=this.m_upperTranslation?this.m_limitState!=_.e_atUpperLimit&&(this.m_limitState=_.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=_.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=_.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var T=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,C=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,S=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,x=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;r.m_linearVelocity.x-=this.m_invMassA*T,r.m_linearVelocity.y-=this.m_invMassA*C,r.m_angularVelocity-=this.m_invIA*S,o.m_linearVelocity.x+=this.m_invMassB*T,o.m_linearVelocity.y+=this.m_invMassB*C,o.m_angularVelocity+=this.m_invIB*x}else this.m_impulse.SetZero(),this.m_motorImpulse=0},T.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,s=e.m_linearVelocity,c=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,h=0,u=0,d=0,p=0;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var f=this.m_axis.x*(a.x-s.x)+this.m_axis.y*(a.y-s.y)+this.m_a2*l-this.m_a1*c,m=this.m_motorMass*(this.m_motorSpeed-f),g=this.m_motorImpulse,y=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+m,-y,y),m=this.m_motorImpulse-g,h=m*this.m_axis.x,u=m*this.m_axis.y,d=m*this.m_a1,p=m*this.m_a2,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*u,c-=this.m_invIA*d,a.x+=this.m_invMassB*h,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}var v=this.m_perp.x*(a.x-s.x)+this.m_perp.y*(a.y-s.y)+this.m_s2*l-this.m_s1*c,T=l-c;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var C=this.m_axis.x*(a.x-s.x)+this.m_axis.y*(a.y-s.y)+this.m_a2*l-this.m_a1*c,S=this.m_impulse.Copy(),x=this.m_K.Solve33(new o,-v,-T,-C);this.m_impulse.Add(x),this.m_limitState==_.e_atLowerLimit?this.m_impulse.z=n.Max(this.m_impulse.z,0):this.m_limitState==_.e_atUpperLimit&&(this.m_impulse.z=n.Min(this.m_impulse.z,0));var A=-v-(this.m_impulse.z-S.z)*this.m_K.col3.x,E=-T-(this.m_impulse.z-S.z)*this.m_K.col3.y,b=this.m_K.Solve22(new r,A,E);b.x+=S.x,b.y+=S.y,this.m_impulse.x=b.x,this.m_impulse.y=b.y,x.x=this.m_impulse.x-S.x,x.y=this.m_impulse.y-S.y,x.z=this.m_impulse.z-S.z,h=x.x*this.m_perp.x+x.z*this.m_axis.x,u=x.x*this.m_perp.y+x.z*this.m_axis.y,d=x.x*this.m_s1+x.y+x.z*this.m_a1,p=x.x*this.m_s2+x.y+x.z*this.m_a2,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*u,c-=this.m_invIA*d,a.x+=this.m_invMassB*h,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}else{var R=this.m_K.Solve22(new r,-v,-T);this.m_impulse.x+=R.x,this.m_impulse.y+=R.y,h=R.x*this.m_perp.x,u=R.x*this.m_perp.y,d=R.x*this.m_s1+R.y,p=R.x*this.m_s2+R.y,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*u,c-=this.m_invIA*d,a.x+=this.m_invMassB*h,a.y+=this.m_invMassB*u,l+=this.m_invIB*p}e.m_linearVelocity.SetV(s),e.m_angularVelocity=c,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},T.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var s,c=this.m_bodyA,a=this.m_bodyB,l=c.m_sweep.c,h=c.m_sweep.a,u=a.m_sweep.c,d=a.m_sweep.a,_=0,p=0,f=0,m=0,g=0,y=0,v=0,T=!1,C=0,S=e.FromAngle(h),x=e.FromAngle(d);s=S;var A=this.m_localAnchor1.x-this.m_localCenterA.x,E=this.m_localAnchor1.y-this.m_localCenterA.y;_=s.col1.x*A+s.col2.x*E,E=s.col1.y*A+s.col2.y*E,A=_,s=x;var b=this.m_localAnchor2.x-this.m_localCenterB.x,R=this.m_localAnchor2.y-this.m_localCenterB.y;_=s.col1.x*b+s.col2.x*R,R=s.col1.y*b+s.col2.y*R,b=_;var P=u.x+b-l.x-A,w=u.y+R-l.y-E;if(this.m_enableLimit){this.m_axis=n.MulMV(S,this.m_localXAxis1),this.m_a1=(P+A)*this.m_axis.y-(w+E)*this.m_axis.x,this.m_a2=b*this.m_axis.y-R*this.m_axis.x;var I=this.m_axis.x*P+this.m_axis.y*w;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(C=n.Clamp(I,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=n.Abs(I),T=!0):I<=this.m_lowerTranslation?(C=n.Clamp(I-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=this.m_lowerTranslation-I,T=!0):I>=this.m_upperTranslation&&(C=n.Clamp(I-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),y=I-this.m_upperTranslation,T=!0)}this.m_perp=n.MulMV(S,this.m_localYAxis1),this.m_s1=(P+A)*this.m_perp.y-(w+E)*this.m_perp.x,this.m_s2=b*this.m_perp.y-R*this.m_perp.x;var D=new o,L=this.m_perp.x*P+this.m_perp.y*w,O=d-h-this.m_refAngle;if(y=n.Max(y,n.Abs(L)),v=n.Abs(O),T)p=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=p+f+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,this.m_K.col1.y=m*this.m_s1+g*this.m_s2,this.m_K.col1.z=m*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+g,this.m_K.col2.z=m*this.m_a1+g*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=p+f+m*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.Solve33(D,-L,-O,-C);else{p=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,g=this.m_invIB;var B=p+f+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,N=m*this.m_s1+g*this.m_s2,F=m+g;this.m_K.col1.Set(B,N,0),this.m_K.col2.Set(N,F,0);var M=this.m_K.Solve22(new r,-L,-O);D.x=M.x,D.y=M.y,D.z=0}var V=D.x*this.m_perp.x+D.z*this.m_axis.x,k=D.x*this.m_perp.y+D.z*this.m_axis.y,G=D.x*this.m_s1+D.y+D.z*this.m_a1,W=D.x*this.m_s2+D.y+D.z*this.m_a2;return l.x-=this.m_invMassA*V,l.y-=this.m_invMassA*k,h-=this.m_invIA*G,u.x+=this.m_invMassB*V,u.y+=this.m_invMassB*k,d+=this.m_invIB*W,c.m_sweep.a=h,a.m_sweep.a=d,c.SynchronizeTransform(),a.SynchronizeTransform(),y<=t.b2_linearSlop&&v<=t.b2_angularSlop},Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef),C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,C.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r,this.localAxisA=new r},C.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},C.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(S,Box2D.Dynamics.Joints.b2Joint),S.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,S.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new r,this.m_groundAnchor2=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_u1=new r,this.m_u2=new r},S.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},S.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},S.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},S.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},S.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},S.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},S.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},S.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,r=t.y-i;return Math.sqrt(n*n+r*r)},S.prototype.GetRatio=function(){return this.m_ratio},S.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=n.Min(t.maxLengthA,this.m_constant-this.m_ratio*S.b2_minPulleyLength),this.m_maxLength2=n.Min(t.maxLengthB,(this.m_constant-S.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},S.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,r=this.m_bodyB;i=n.m_xf.R;var o=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,c=i.col1.x*o+i.col2.x*s;s=i.col1.y*o+i.col2.y*s,o=c,i=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;c=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=c;var h=n.m_sweep.c.x+o,u=n.m_sweep.c.y+s,d=r.m_sweep.c.x+a,p=r.m_sweep.c.y+l,f=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,g=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,y=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(h-f,u-m),this.m_u2.Set(d-g,p-y);var v=this.m_u1.Length(),T=this.m_u2.Length();v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),T>t.b2_linearSlop?this.m_u2.Multiply(1/T):this.m_u2.SetZero();var C=this.m_constant-v-this.m_ratio*T;C>0?(this.m_state=_.e_inactiveLimit,this.m_impulse=0):this.m_state=_.e_atUpperLimit,v<this.m_maxLength1?(this.m_limitState1=_.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=_.e_atUpperLimit,T<this.m_maxLength2?(this.m_limitState2=_.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=_.e_atUpperLimit;var S=o*this.m_u1.y-s*this.m_u1.x,x=a*this.m_u2.y-l*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*S*S,this.m_limitMass2=r.m_invMass+r.m_invI*x*x,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var A=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,E=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,b=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,R=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*A,n.m_linearVelocity.y+=n.m_invMass*E,n.m_angularVelocity+=n.m_invI*(o*E-s*A),r.m_linearVelocity.x+=r.m_invMass*b,r.m_linearVelocity.y+=r.m_invMass*R,r.m_angularVelocity+=r.m_invI*(a*R-l*b)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},S.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,r=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,c=e.col1.x*o+e.col2.x*s;s=e.col1.y*o+e.col2.y*s,o=c,e=r.m_xf.R;var a=this.m_localAnchor2.x-r.m_sweep.localCenter.x,l=this.m_localAnchor2.y-r.m_sweep.localCenter.y;c=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=c;var h=0,u=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,T=0,C=0;this.m_state==_.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*s,u=i.m_linearVelocity.y+i.m_angularVelocity*o,d=r.m_linearVelocity.x+-r.m_angularVelocity*l,p=r.m_linearVelocity.y+r.m_angularVelocity*a,v=-(this.m_u1.x*h+this.m_u1.y*u)-this.m_ratio*(this.m_u2.x*d+this.m_u2.y*p),T=this.m_pulleyMass*-v,C=this.m_impulse,this.m_impulse=n.Max(0,this.m_impulse+T),T=this.m_impulse-C,f=-T*this.m_u1.x,m=-T*this.m_u1.y,g=-this.m_ratio*T*this.m_u2.x,y=-this.m_ratio*T*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*f,i.m_linearVelocity.y+=i.m_invMass*m,i.m_angularVelocity+=i.m_invI*(o*m-s*f),r.m_linearVelocity.x+=r.m_invMass*g,r.m_linearVelocity.y+=r.m_invMass*y,r.m_angularVelocity+=r.m_invI*(a*y-l*g)),this.m_limitState1==_.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*s,u=i.m_linearVelocity.y+i.m_angularVelocity*o,v=-(this.m_u1.x*h+this.m_u1.y*u),T=-this.m_limitMass1*v,C=this.m_limitImpulse1,this.m_limitImpulse1=n.Max(0,this.m_limitImpulse1+T),T=this.m_limitImpulse1-C,f=-T*this.m_u1.x,m=-T*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*f,i.m_linearVelocity.y+=i.m_invMass*m,i.m_angularVelocity+=i.m_invI*(o*m-s*f)),this.m_limitState2==_.e_atUpperLimit&&(d=r.m_linearVelocity.x+-r.m_angularVelocity*l,p=r.m_linearVelocity.y+r.m_angularVelocity*a,v=-(this.m_u2.x*d+this.m_u2.y*p),T=-this.m_limitMass2*v,C=this.m_limitImpulse2,this.m_limitImpulse2=n.Max(0,this.m_limitImpulse2+T),T=this.m_limitImpulse2-C,g=-T*this.m_u2.x,y=-T*this.m_u2.y,r.m_linearVelocity.x+=r.m_invMass*g,r.m_linearVelocity.y+=r.m_invMass*y,r.m_angularVelocity+=r.m_invI*(a*y-l*g))},S.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,r=this.m_bodyA,o=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,c=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,a=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,l=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,h=0,u=0,d=0,p=0,f=0,m=0,g=0,y=0,v=0,T=0,C=0,S=0,x=0,A=0;return this.m_state==_.e_atUpperLimit&&(i=r.m_xf.R,h=this.m_localAnchor1.x-r.m_sweep.localCenter.x,u=this.m_localAnchor1.y-r.m_sweep.localCenter.y,x=i.col1.x*h+i.col2.x*u,u=i.col1.y*h+i.col2.y*u,h=x,i=o.m_xf.R,d=this.m_localAnchor2.x-o.m_sweep.localCenter.x,p=this.m_localAnchor2.y-o.m_sweep.localCenter.y,x=i.col1.x*d+i.col2.x*p,p=i.col1.y*d+i.col2.y*p,d=x,f=r.m_sweep.c.x+h,m=r.m_sweep.c.y+u,g=o.m_sweep.c.x+d,y=o.m_sweep.c.y+p,this.m_u1.Set(f-s,m-c),this.m_u2.Set(g-a,y-l),v=this.m_u1.Length(),T=this.m_u2.Length(),v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),T>t.b2_linearSlop?this.m_u2.Multiply(1/T):this.m_u2.SetZero(),C=this.m_constant-v-this.m_ratio*T,A=n.Max(A,-C),C=n.Clamp(C+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),S=-this.m_pulleyMass*C,f=-S*this.m_u1.x,m=-S*this.m_u1.y,g=-this.m_ratio*S*this.m_u2.x,y=-this.m_ratio*S*this.m_u2.y,r.m_sweep.c.x+=r.m_invMass*f,r.m_sweep.c.y+=r.m_invMass*m,r.m_sweep.a+=r.m_invI*(h*m-u*f),o.m_sweep.c.x+=o.m_invMass*g,o.m_sweep.c.y+=o.m_invMass*y,o.m_sweep.a+=o.m_invI*(d*y-p*g),r.SynchronizeTransform(),o.SynchronizeTransform()),this.m_limitState1==_.e_atUpperLimit&&(i=r.m_xf.R,h=this.m_localAnchor1.x-r.m_sweep.localCenter.x,u=this.m_localAnchor1.y-r.m_sweep.localCenter.y,x=i.col1.x*h+i.col2.x*u,u=i.col1.y*h+i.col2.y*u,h=x,f=r.m_sweep.c.x+h,m=r.m_sweep.c.y+u,this.m_u1.Set(f-s,m-c),v=this.m_u1.Length(),v>t.b2_linearSlop?(this.m_u1.x*=1/v,this.m_u1.y*=1/v):this.m_u1.SetZero(),C=this.m_maxLength1-v,A=n.Max(A,-C),C=n.Clamp(C+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),S=-this.m_limitMass1*C,f=-S*this.m_u1.x,m=-S*this.m_u1.y,r.m_sweep.c.x+=r.m_invMass*f,r.m_sweep.c.y+=r.m_invMass*m,r.m_sweep.a+=r.m_invI*(h*m-u*f),r.SynchronizeTransform()),this.m_limitState2==_.e_atUpperLimit&&(i=o.m_xf.R,d=this.m_localAnchor2.x-o.m_sweep.localCenter.x,p=this.m_localAnchor2.y-o.m_sweep.localCenter.y,x=i.col1.x*d+i.col2.x*p,p=i.col1.y*d+i.col2.y*p,d=x,g=o.m_sweep.c.x+d,y=o.m_sweep.c.y+p,this.m_u2.Set(g-a,y-l),T=this.m_u2.Length(),T>t.b2_linearSlop?(this.m_u2.x*=1/T,this.m_u2.y*=1/T):this.m_u2.SetZero(),C=this.m_maxLength2-T,A=n.Max(A,-C),C=n.Clamp(C+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),S=-this.m_limitMass2*C,g=-S*this.m_u2.x,y=-S*this.m_u2.y,o.m_sweep.c.x+=o.m_invMass*g,o.m_sweep.c.y+=o.m_invMass*y,o.m_sweep.a+=o.m_invI*(d*y-p*g),o.SynchronizeTransform()),A<t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(x,Box2D.Dynamics.Joints.b2JointDef),x.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,x.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new r,this.groundAnchorB=new r,this.localAnchorA=new r,this.localAnchorB=new r},x.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},x.prototype.Initialize=function(t,e,i,n,r,o,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(r),this.localAnchorB=this.bodyB.GetLocalPoint(o);var c=r.x-i.x,a=r.y-i.y;this.lengthA=Math.sqrt(c*c+a*a);var l=o.x-n.x,h=o.y-n.y;this.lengthB=Math.sqrt(l*l+h*h),this.ratio=s;var u=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=u-this.ratio*S.b2_minPulleyLength,this.maxLengthB=(u-S.b2_minPulleyLength)/this.ratio},Box2D.inherit(A,Box2D.Dynamics.Joints.b2Joint),A.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,A.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new o,this.impulse2=new r,this.reduced=new r,this.m_localAnchor1=new r,this.m_localAnchor2=new r,this.m_impulse=new o,this.m_mass=new i},A.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},A.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},A.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},A.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},A.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},A.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},A.prototype.IsLimitEnabled=function(){return this.m_enableLimit};A.prototype.EnableLimit=function(t){this.m_enableLimit=t};A.prototype.GetLowerLimit=function(){return this.m_lowerAngle},A.prototype.GetUpperLimit=function(){return this.m_upperAngle},A.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},A.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},A.prototype.EnableMotor=function(t){this.m_enableMotor=t},A.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},A.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},A.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},A.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},A.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=_.e_inactiveLimit},A.prototype.InitVelocityConstraints=function(e){var i,r=this.m_bodyA,o=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit,i=r.m_xf.R;var c=this.m_localAnchor1.x-r.m_sweep.localCenter.x,a=this.m_localAnchor1.y-r.m_sweep.localCenter.y;s=i.col1.x*c+i.col2.x*a,a=i.col1.y*c+i.col2.y*a,c=s,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,h=this.m_localAnchor2.y-o.m_sweep.localCenter.y;s=i.col1.x*l+i.col2.x*h,h=i.col1.y*l+i.col2.y*h,l=s;var u=r.m_invMass,d=o.m_invMass,p=r.m_invI,f=o.m_invI;if(this.m_mass.col1.x=u+d+a*a*p+h*h*f,this.m_mass.col2.x=-a*c*p-h*l*f,this.m_mass.col3.x=-a*p-h*f,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=u+d+c*c*p+l*l*f,this.m_mass.col3.y=c*p+l*f,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=p+f,this.m_motorMass=1/(p+f),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var m=o.m_sweep.a-r.m_sweep.a-this.m_referenceAngle;n.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=_.e_equalLimits:m<=this.m_lowerAngle?(this.m_limitState!=_.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=_.e_atLowerLimit):m>=this.m_upperAngle?(this.m_limitState!=_.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=_.e_atUpperLimit):(this.m_limitState=_.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=_.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var g=this.m_impulse.x,y=this.m_impulse.y;r.m_linearVelocity.x-=u*g,r.m_linearVelocity.y-=u*y,r.m_angularVelocity-=p*(c*y-a*g+this.m_motorImpulse+this.m_impulse.z),o.m_linearVelocity.x+=d*g,o.m_linearVelocity.y+=d*y,o.m_angularVelocity+=f*(l*y-h*g+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},A.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,r=this.m_bodyB,o=0,s=0,c=0,a=0,l=0,h=0,u=i.m_linearVelocity,d=i.m_angularVelocity,p=r.m_linearVelocity,f=r.m_angularVelocity,m=i.m_invMass,g=r.m_invMass,y=i.m_invI,v=r.m_invI;if(this.m_enableMotor&&this.m_limitState!=_.e_equalLimits){var T=f-d-this.m_motorSpeed,C=this.m_motorMass*-T,S=this.m_motorImpulse,x=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+C,-x,x),C=this.m_motorImpulse-S,d-=y*C,f+=v*C}if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){e=i.m_xf.R,c=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*c+e.col2.x*a,a=e.col1.y*c+e.col2.y*a,c=o,e=r.m_xf.R,l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,h=this.m_localAnchor2.y-r.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=o;var A=p.x+-f*h-u.x- -d*a,E=p.y+f*l-u.y-d*c,b=f-d;this.m_mass.Solve33(this.impulse3,-A,-E,-b),this.m_limitState==_.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==_.e_atLowerLimit?(s=this.m_impulse.z+this.impulse3.z,s<0&&(this.m_mass.Solve22(this.reduced,-A,-E),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==_.e_atUpperLimit&&(s=this.m_impulse.z+this.impulse3.z,s>0&&(this.m_mass.Solve22(this.reduced,-A,-E),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),u.x-=m*this.impulse3.x,u.y-=m*this.impulse3.y,d-=y*(c*this.impulse3.y-a*this.impulse3.x+this.impulse3.z),p.x+=g*this.impulse3.x,p.y+=g*this.impulse3.y,f+=v*(l*this.impulse3.y-h*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,c=this.m_localAnchor1.x-i.m_sweep.localCenter.x,a=this.m_localAnchor1.y-i.m_sweep.localCenter.y,o=e.col1.x*c+e.col2.x*a,a=e.col1.y*c+e.col2.y*a,c=o,e=r.m_xf.R,l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,h=this.m_localAnchor2.y-r.m_sweep.localCenter.y,o=e.col1.x*l+e.col2.x*h,h=e.col1.y*l+e.col2.y*h,l=o;var R=p.x+-f*h-u.x- -d*a,P=p.y+f*l-u.y-d*c;this.m_mass.Solve22(this.impulse2,-R,-P),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,u.x-=m*this.impulse2.x,u.y-=m*this.impulse2.y,d-=y*(c*this.impulse2.y-a*this.impulse2.x),p.x+=g*this.impulse2.x,p.y+=g*this.impulse2.y,f+=v*(l*this.impulse2.y-h*this.impulse2.x)}i.m_linearVelocity.SetV(u),i.m_angularVelocity=d,r.m_linearVelocity.SetV(p),r.m_angularVelocity=f},A.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,r=0,o=this.m_bodyA,s=this.m_bodyB,c=0,a=0,l=0,h=0,u=0;if(this.m_enableLimit&&this.m_limitState!=_.e_inactiveLimit){var d=s.m_sweep.a-o.m_sweep.a-this.m_referenceAngle,p=0;this.m_limitState==_.e_equalLimits?(r=n.Clamp(d-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),p=-this.m_motorMass*r,c=n.Abs(r)):this.m_limitState==_.e_atLowerLimit?(r=d-this.m_lowerAngle,c=-r,r=n.Clamp(r+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),p=-this.m_motorMass*r):this.m_limitState==_.e_atUpperLimit&&(r=d-this.m_upperAngle,c=r,r=n.Clamp(r-t.b2_angularSlop,0,t.b2_maxAngularCorrection),p=-this.m_motorMass*r),o.m_sweep.a-=o.m_invI*p,s.m_sweep.a+=s.m_invI*p,o.SynchronizeTransform(),s.SynchronizeTransform()}i=o.m_xf.R;var f=this.m_localAnchor1.x-o.m_sweep.localCenter.x,m=this.m_localAnchor1.y-o.m_sweep.localCenter.y;l=i.col1.x*f+i.col2.x*m,m=i.col1.y*f+i.col2.y*m,f=l,i=s.m_xf.R;var g=this.m_localAnchor2.x-s.m_sweep.localCenter.x,y=this.m_localAnchor2.y-s.m_sweep.localCenter.y;l=i.col1.x*g+i.col2.x*y,y=i.col1.y*g+i.col2.y*y,g=l;var v=s.m_sweep.c.x+g-o.m_sweep.c.x-f,T=s.m_sweep.c.y+y-o.m_sweep.c.y-m,C=v*v+T*T,S=Math.sqrt(C);a=S;var x=o.m_invMass,E=s.m_invMass,b=o.m_invI,R=s.m_invI,P=10*t.b2_linearSlop;if(C>P*P){var w=x+E,I=1/w;h=I*-v,u=I*-T;var D=.5;o.m_sweep.c.x-=D*x*h,o.m_sweep.c.y-=D*x*u,s.m_sweep.c.x+=D*E*h,s.m_sweep.c.y+=D*E*u,v=s.m_sweep.c.x+g-o.m_sweep.c.x-f,T=s.m_sweep.c.y+y-o.m_sweep.c.y-m}return this.K1.col1.x=x+E,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=x+E,this.K2.col1.x=b*m*m,this.K2.col2.x=-b*f*m,this.K2.col1.y=-b*f*m,this.K2.col2.y=b*f*f,this.K3.col1.x=R*y*y,this.K3.col2.x=-R*g*y,this.K3.col1.y=-R*g*y,this.K3.col2.y=R*g*g,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(A.tImpulse,-v,-T),h=A.tImpulse.x,u=A.tImpulse.y,o.m_sweep.c.x-=o.m_invMass*h,o.m_sweep.c.y-=o.m_invMass*u,o.m_sweep.a-=o.m_invI*(f*u-m*h),s.m_sweep.c.x+=s.m_invMass*h,s.m_sweep.c.y+=s.m_invMass*u,s.m_sweep.a+=s.m_invI*(g*u-y*h),o.SynchronizeTransform(),s.SynchronizeTransform(),a<=t.b2_linearSlop&&c<=t.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new r}),Box2D.inherit(E,Box2D.Dynamics.Joints.b2JointDef),E.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,E.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},E.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},E.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(b,Box2D.Dynamics.Joints.b2Joint),b.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,b.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new r,this.m_localAnchorB=new r,this.m_impulse=new o,this.m_mass=new i},b.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},b.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},b.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new r(t*this.m_impulse.x,t*this.m_impulse.y)},b.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},b.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},b.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB;e=n.m_xf.R;var o=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*o+e.col2.x*s,s=e.col1.y*o+e.col2.y*s,o=i,e=r.m_xf.R;var c=this.m_localAnchorB.x-r.m_sweep.localCenter.x,a=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*c+e.col2.x*a,a=e.col1.y*c+e.col2.y*a,c=i;var l=n.m_invMass,h=r.m_invMass,u=n.m_invI,d=r.m_invI;this.m_mass.col1.x=l+h+s*s*u+a*a*d,this.m_mass.col2.x=-s*o*u-a*c*d,this.m_mass.col3.x=-s*u-a*d,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=l+h+o*o*u+c*c*d,this.m_mass.col3.y=o*u+c*d,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=u+d,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=l*this.m_impulse.x,n.m_linearVelocity.y-=l*this.m_impulse.y,n.m_angularVelocity-=u*(o*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),r.m_linearVelocity.x+=h*this.m_impulse.x,r.m_linearVelocity.y+=h*this.m_impulse.y,r.m_angularVelocity+=d*(c*this.m_impulse.y-a*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},b.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,r=this.m_bodyB,s=n.m_linearVelocity,c=n.m_angularVelocity,a=r.m_linearVelocity,l=r.m_angularVelocity,h=n.m_invMass,u=r.m_invMass,d=n.m_invI,_=r.m_invI;e=n.m_xf.R;var p=this.m_localAnchorA.x-n.m_sweep.localCenter.x,f=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*p+e.col2.x*f,f=e.col1.y*p+e.col2.y*f,p=i,e=r.m_xf.R;var m=this.m_localAnchorB.x-r.m_sweep.localCenter.x,g=this.m_localAnchorB.y-r.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*g,g=e.col1.y*m+e.col2.y*g,m=i;var y=a.x-l*g-s.x+c*f,v=a.y+l*m-s.y-c*p,T=l-c,C=new o;this.m_mass.Solve33(C,-y,-v,-T),this.m_impulse.Add(C),s.x-=h*C.x,s.y-=h*C.y,c-=d*(p*C.y-f*C.x+C.z),a.x+=u*C.x,a.y+=u*C.y,l+=_*(m*C.y-g*C.x+C.z),n.m_angularVelocity=c,r.m_angularVelocity=l},b.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,r=0,s=this.m_bodyA,c=this.m_bodyB;i=s.m_xf.R;var a=this.m_localAnchorA.x-s.m_sweep.localCenter.x,l=this.m_localAnchorA.y-s.m_sweep.localCenter.y;r=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=r,i=c.m_xf.R;var h=this.m_localAnchorB.x-c.m_sweep.localCenter.x,u=this.m_localAnchorB.y-c.m_sweep.localCenter.y;r=i.col1.x*h+i.col2.x*u,u=i.col1.y*h+i.col2.y*u,h=r;var d=s.m_invMass,_=c.m_invMass,p=s.m_invI,f=c.m_invI,m=c.m_sweep.c.x+h-s.m_sweep.c.x-a,g=c.m_sweep.c.y+u-s.m_sweep.c.y-l,y=c.m_sweep.a-s.m_sweep.a-this.m_referenceAngle,v=10*t.b2_linearSlop,T=Math.sqrt(m*m+g*g),C=n.Abs(y);T>v&&(p*=1,f*=1),this.m_mass.col1.x=d+_+l*l*p+u*u*f,this.m_mass.col2.x=-l*a*p-u*h*f,this.m_mass.col3.x=-l*p-u*f,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=d+_+a*a*p+h*h*f,this.m_mass.col3.y=a*p+h*f,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=p+f;var S=new o;return this.m_mass.Solve33(S,-m,-g,-y),s.m_sweep.c.x-=d*S.x,s.m_sweep.c.y-=d*S.y,s.m_sweep.a-=p*(a*S.y-l*S.x+S.z),c.m_sweep.c.x+=_*S.x,c.m_sweep.c.y+=_*S.y,c.m_sweep.a+=f*(h*S.y-u*S.x+S.z),s.SynchronizeTransform(),c.SynchronizeTransform(),T<=t.b2_linearSlop&&C<=t.b2_angularSlop},Box2D.inherit(R,Box2D.Dynamics.Joints.b2JointDef),R.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,R.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new r,this.localAnchorB=new r},R.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=_.e_weldJoint,this.referenceAngle=0},R.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=Box2D.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*r,t[0].y*r);for(var o=1;o<e;o++)n.lineTo(t[o].x*r,t[o].y*r);n.lineTo(t[0].x*r,t[0].y*r),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,r=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*r,t.y*r,e*r,0,2*Math.PI,!0),n.closePath(),n.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var r=this.m_ctx,o=this.m_drawScale,s=t.x*o,c=t.y*o;r.moveTo(0,0),r.beginPath(),r.strokeStyle=this._color(n.color,this.m_alpha),r.fillStyle=this._color(n.color,this.m_fillAlpha),r.arc(s,c,e*o,0,2*Math.PI,!0),r.moveTo(s,c),r.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),r.closePath(),r.fill(),r.stroke()}},t.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,r=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*r,t.y*r),n.lineTo(e.x*r,e.y*r),n.closePath(),n.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs,"undefined"!=typeof require&&"undefined"!=typeof module&&(module.exports=Box2D);!function(){Object.create=Object.create||function(t){function e(){}return e.prototype=t,new e};var t;"undefined"==typeof exports?(t={},"object"==typeof window&&(window.cp=t)):t=exports;var e,i,n=function(t,e){if(!t)throw new Error("Assertion failed: "+e)},r=function(t,e){!t&&console&&console.warn&&(console.warn("ASSERTION FAILED: "+e),console.trace&&console.trace())},o=function(t,e){return t<e?t:e},s=function(t,e){return t>e?t:e};"object"==typeof window&&window.navigator.userAgent.indexOf("Firefox")>-1?(e=Math.min,i=Math.max):(e=o,i=s);var c=function(t,e){return t<e?t+" "+e:e+" "+t},a=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return t[i]=t[t.length-1],void t.length--},l=function(t,e,i){var n=A(e,i),r=m(v(n,A(t,i))/O(n));return x(i,b(n,r))},h=function(t,e,i,n,r,o){var s=i-r,c=n-o,a=m(T(s,c,t-r,e-o)/B(s,c));return new g(r+s*a,o+c*a)};t.momentForCircle=function(t,e,i,n){return t*(.5*(e*e+i*i)+O(n))},t.areaForCircle=function(t,e){return Math.PI*Math.abs(t*t-e*e)},t.momentForSegment=function(t,e,i){var n=b(x(e,i),.5);return t*(G(i,e)/12+O(n))},t.areaForSegment=function(t,e,i){return i*(Math.PI*i+2*k(t,e))},t.momentForPoly=function(t,e,i){for(var n=0,r=0,o=e.length,s=0;s<o;s+=2){var c=e[s]+i.x,a=e[s+1]+i.y,l=e[(s+2)%o]+i.x,h=e[(s+3)%o]+i.y,u=P(l,h,c,a),d=T(c,a,c,a)+T(c,a,l,h)+T(l,h,l,h);n+=u*d,r+=u}return t*n/(6*r)},t.areaForPoly=function(t){for(var e=0,i=0,n=t.length;i<n;i+=2)e+=R(new g(t[i],t[i+1]),new g(t[(i+2)%n],t[(i+3)%n]));return-e/2},t.centroidForPoly=function(t){for(var e=0,i=new g(0,0),n=0,r=t.length;n<r;n+=2){var o=new g(t[n],t[n+1]),s=new g(t[(n+2)%r],t[(n+3)%r]),c=R(o,s);e+=c,i=x(i,b(x(o,s),c))}return b(i,1/(3*e))},t.recenterPoly=function(e){for(var i=t.centroidForPoly(e),n=0;n<e.length;n+=2)e[n]-=i.x,e[n+1]-=i.y},t.momentForBox=function(t,e,i){return t*(e*e+i*i)/12},t.momentForBox2=function(e,i){var n=i.r-i.l,r=i.t-i.b,o=b([i.l+i.r,i.b+i.t],.5);return t.momentForBox(e,n,r)+e*O(o)};var u=t.loopIndexes=function(t){var e,i,n,r,o=0,s=0;e=n=t[0],i=r=t[1];for(var c=t.length>>1,a=1;a<c;a++){var l=t[2*a],h=t[2*a+1];l<e||l==e&&h<i?(e=l,i=h,o=a):(l>n||l==n&&h>r)&&(n=l,r=h,s=a)}return[o,s]},d=function(t,e,i){var n=t[2*e];t[2*e]=t[2*i],t[2*i]=n,n=t[2*e+1],t[2*e+1]=t[2*i+1],t[2*i+1]=n},_=function(t,e,i,n,r,o){if(0===i)return 0;for(var s=0,c=e,a=A(r,n),l=o*C(a),h=e,u=e+i-1;h<=u;){var _=new g(t[2*h],t[2*h+1]),p=R(a,A(_,n));p>l?(p>s&&(s=p,c=h),h++):(d(t,h,u),u--)}return c!=e&&d(t,e,c),h-e},p=function(t,e,i,n,r,o,s,c){if(n<0)return 0;if(0==n)return e[2*c]=o.x,e[2*c+1]=o.y,1;var a=_(e,i,n,r,o,t),l=new g(e[2*i],e[2*i+1]),h=p(t,e,i+1,a-1,r,l,o,c),u=c+h++;e[2*u]=o.x,e[2*u+1]=o.y;var d=_(e,i+a,n-a,o,s,t),f=new g(e[2*(i+a)],e[2*(i+a)+1]);return h+p(t,e,i+a+1,d-1,o,f,s,c+h)};t.convexHull=function(t,e,i){if(e)for(var n=0;n<t.length;n++)e[n]=t[n];else e=t;var o=u(t),s=o[0],c=o[1];if(s==c)return e.length=2,e;d(e,0,s),d(e,1,0==c?s:c);var a=new g(e[0],e[1]),l=new g(e[2],e[3]),h=t.length>>1,_=p(i,e,2,h-2,a,l,a,1)+1;return e.length=2*_,r(tt(e),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),e};var f=function(t,n,r){return e(i(t,n),r)},m=function(t){return i(0,e(t,1))},g=t.Vect=function(t,e){this.x=t,this.y=e};t.v=function(t,e){return new g(t,e)};var y=t.vzero=new g(0,0),v=t.v.dot=function(t,e){return t.x*e.x+t.y*e.y},T=function(t,e,i,n){return t*i+e*n},C=t.v.len=function(t){return Math.sqrt(v(t,t))},S=t.v.len2=function(t,e){return Math.sqrt(t*t+e*e)},x=(t.v.eql=function(t,e){return t.x===e.x&&t.y===e.y},t.v.add=function(t,e){return new g(t.x+e.x,t.y+e.y)});g.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this};var A=t.v.sub=function(t,e){return new g(t.x-e.x,t.y-e.y)};g.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this};var E=t.v.neg=function(t){return new g(-t.x,-t.y)};g.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var b=t.v.mult=function(t,e){return new g(t.x*e,t.y*e)};g.prototype.mult=function(t){return this.x*=t,this.y*=t,this};var R=t.v.cross=function(t,e){return t.x*e.y-t.y*e.x},P=function(t,e,i,n){return t*n-e*i},w=t.v.perp=function(t){return new g(-t.y,t.x)},I=(t.v.pvrperp=function(t){return new g(t.y,-t.x)},t.v.project=function(t,e){return b(e,v(t,e)/O(e))});g.prototype.project=function(t){return this.mult(v(this,t)/O(t)),this};var D=t.v.rotate=function(t,e){return new g(t.x*e.x-t.y*e.y,t.x*e.y+t.y*e.x)};g.prototype.rotate=function(t){return this.x=this.x*t.x-this.y*t.y,this.y=this.x*t.y+this.y*t.x,this};var L=t.v.unrotate=function(t,e){return new g(t.x*e.x+t.y*e.y,t.y*e.x-t.x*e.y)},O=t.v.lengthsq=function(t){return v(t,t)},B=t.v.lengthsq2=function(t,e){return t*t+e*e},N=t.v.lerp=function(t,e,i){return x(b(t,1-i),b(e,i))},F=t.v.normalize=function(t){return b(t,1/C(t))},M=t.v.normalize_safe=function(t){return 0===t.x&&0===t.y?y:F(t)},V=t.v.clamp=function(t,e){return v(t,t)>e*e?b(F(t),e):t},k=(t.v.lerpconst=function(t,e,i){return x(t,V(A(e,t),i))},t.v.dist=function(t,e){return C(A(t,e))}),G=t.v.distsq=function(t,e){return O(A(t,e))},W=(t.v.near=function(t,e,i){return G(t,e)<i*i},t.v.slerp=function(t,e,i){var n=Math.acos(v(t,e));if(n){var r=1/Math.sin(n);return x(b(t,Math.sin((1-i)*n)*r),b(e,Math.sin(i*n)*r))}return t}),z=(t.v.slerpconst=function(t,i,n){var r=Math.acos(v(t,i));return W(t,i,e(n,r)/r)},t.v.forangle=function(t){return new g(Math.cos(t),Math.sin(t))},t.v.toangle=function(t){return Math.atan2(t.y,t.x)},t.v.str=function(t){return"("+t.x.toFixed(3)+", "+t.y.toFixed(3)+")"},0),U=t.BB=function(t,e,i,n){this.l=t,this.b=e,this.r=i,this.t=n,z++};t.bb=function(t,e,i,n){return new U(t,e,i,n)};var Y=function(t,e){return new U(t.x-e,t.y-e,t.x+e,t.y+e)},X=function(t,e,i,n,r){return t.l<=n&&e<=t.r&&t.b<=r&&i<=t.t},H=0,j=(t.NO_GROUP=0,t.ALL_LAYERS=-1);t.ALL_CATEGORIES=-1;t.resetShapeIdCounter=function(){H=0};var q=t.Shape=function(t){this.body=t,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=H++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=y,this.collision_type=0,this.group=0,this.layers=j,this.space=null,this.collisionCode=this.collisionCode};q.prototype.setElasticity=function(t){this.e=t},q.prototype.setFriction=function(t){this.body.activate(),this.u=t},q.prototype.setLayers=function(t){this.body.activate(),this.layers=t},q.prototype.setSensor=function(t){this.body.activate(),this.sensor=t},q.prototype.setCollisionType=function(t){this.body.activate(),this.collision_type=t},q.prototype.getBody=function(){return this.body},q.prototype.active=function(){return this.body&&this.body.shapeList.indexOf(this)!==-1},q.prototype.setBody=function(t){n(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=t},q.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},q.prototype.update=function(t,e){n(!isNaN(e.x),"Rotation is NaN"),n(!isNaN(t.x),"Position is NaN"),this.cacheData(t,e)},q.prototype.pointQuery=function(t){var e=this.nearestPointQuery(t);if(e.d<0)return e},q.prototype.getBB=function(){return new U(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var Z=function(t,e,i){this.shape=t,this.p=e,this.d=i},J=function(t,e,i){this.shape=t,this.t=e,this.n=i};J.prototype.hitPoint=function(t,e){return N(t,e,this.t)},J.prototype.hitDist=function(t,e){return k(t,e)*this.t};var K=t.CircleShape=function(t,e,i){this.c=this.tc=i,this.r=e,this.type="circle",q.call(this,t)};K.prototype=Object.create(q.prototype),K.prototype.cacheData=function(t,e){var i=this.tc=D(this.c,e).add(t),n=this.r;this.bb_l=i.x-n,this.bb_b=i.y-n,this.bb_r=i.x+n,this.bb_t=i.y+n},K.prototype.nearestPointQuery=function(t){var e=t.x-this.tc.x,i=t.y-this.tc.y,n=S(e,i),r=this.r,o=new g(this.tc.x+e*r/n,this.tc.y+i*r/n);return new Z(this,o,n-r)};var Q=function(t,e,i,n,r,o){n=A(n,e),r=A(r,e);var s=v(n,n)-2*v(n,r)+v(r,r),c=-2*v(n,n)+2*v(n,r),a=v(n,n)-i*i,l=c*c-4*s*a;if(l>=0){var h=(-c-Math.sqrt(l))/(2*s);if(0<=h&&h<=1)return new J(t,h,F(N(n,r,h)))}};K.prototype.segmentQuery=function(t,e){return Q(this,this.tc,this.r,t,e)};var $=t.SegmentShape=function(t,e,i,n){this.a=e,this.b=i,this.n=w(F(A(i,e))),this.ta=this.tb=this.tn=null,this.r=n,this.a_tangent=y,this.b_tangent=y,this.type="segment",q.call(this,t)};$.prototype=Object.create(q.prototype),$.prototype.cacheData=function(t,e){this.ta=x(t,D(this.a,e)),this.tb=x(t,D(this.b,e)),this.tn=D(this.n,e);var i,n,r,o;this.ta.x<this.tb.x?(i=this.ta.x,n=this.tb.x):(i=this.tb.x,n=this.ta.x),this.ta.y<this.tb.y?(r=this.ta.y,o=this.tb.y):(r=this.tb.y,o=this.ta.y);var s=this.r;this.bb_l=i-s,this.bb_b=r-s,this.bb_r=n+s,this.bb_t=o+s},$.prototype.nearestPointQuery=function(t){var e=l(t,this.ta,this.tb),i=t.x-e.x,n=t.y-e.y,r=S(i,n),o=this.r,s=r?x(e,b(new g(i,n),o/r)):e;return new Z(this,s,r-o)},$.prototype.segmentQuery=function(t,e){var i=this.tn,n=v(A(this.ta,t),i),r=this.r,o=n>0?E(i):i,s=A(b(o,r),t),c=x(this.ta,s),a=x(this.tb,s),l=A(e,t);if(R(l,c)*R(l,a)<=0){var h=n+(n>0?-r:r),u=-h,d=v(l,i)-h;if(u*d<0)return new J(this,u/(u-d),o)}else if(0!==r){var _=Q(this,this.ta,this.r,t,e),p=Q(this,this.tb,this.r,t,e);return _?p&&p.t<_.t?p:_:p}},$.prototype.setNeighbors=function(t,e){this.a_tangent=A(t,this.a),this.b_tangent=A(e,this.b)},$.prototype.setEndpoints=function(t,e){this.a=t,this.b=e,this.n=w(F(A(e,t)))};var tt=function(t){for(var e=t.length,i=0;i<e;i+=2){var n=t[i],r=t[i+1],o=t[(i+2)%e],s=t[(i+3)%e],c=t[(i+4)%e],a=t[(i+5)%e];if(P(o-n,s-r,c-o,a-s)>0)return!1}return!0},et=t.PolyShape=function(t,e,i){this.setVerts(e,i),this.type="poly",q.call(this,t)};et.prototype=Object.create(q.prototype);var it=function(t,e){this.n=t,this.d=e};it.prototype.compare=function(t){return v(this.n,t)-this.d},et.prototype.setVerts=function(t,e){n(t.length>=4,"Polygons require some verts"),n("number"==typeof t[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),n(tt(t),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var i=t.length,r=i>>1;this.verts=new Array(i),this.tVerts=new Array(i),this.planes=new Array(r),this.tPlanes=new Array(r);for(var o=0;o<i;o+=2){var s=t[o]+e.x,c=t[o+1]+e.y,a=t[(o+2)%i]+e.x,l=t[(o+3)%i]+e.y,h=F(w(new g(a-s,l-c)));this.verts[o]=s,this.verts[o+1]=c,this.planes[o>>1]=new it(h,T(h.x,h.y,s,c)),this.tPlanes[o>>1]=new it(new g(0,0),0)}};var nt=(t.BoxShape=function(t,e,i){var n=e/2,r=i/2;return nt(t,new U(-n,-r,n,r))},t.BoxShape2=function(t,e){var i=[e.l,e.b,e.l,e.t,e.r,e.t,e.r,e.b];return new et(t,i,y)});et.prototype.transformVerts=function(t,n){for(var r=this.verts,o=this.tVerts,s=1/0,c=-(1/0),a=1/0,l=-(1/0),h=0;h<r.length;h+=2){var u=r[h],d=r[h+1],_=t.x+u*n.x-d*n.y,p=t.y+u*n.y+d*n.x;o[h]=_,o[h+1]=p,s=e(s,_),c=i(c,_),a=e(a,p),l=i(l,p)}this.bb_l=s,this.bb_b=a,this.bb_r=c,this.bb_t=l},et.prototype.transformAxes=function(t,e){for(var i=this.planes,n=this.tPlanes,r=0;r<i.length;r++){var o=D(i[r].n,e);n[r].n=o,n[r].d=v(t,o)+i[r].d}},et.prototype.cacheData=function(t,e){this.transformAxes(t,e),this.transformVerts(t,e)},et.prototype.nearestPointQuery=function(t){for(var e=this.tPlanes,i=this.tVerts,n=i[i.length-2],r=i[i.length-1],o=1/0,s=y,c=!1,a=0;a<e.length;a++){e[a].compare(t)>0&&(c=!0);var l=i[2*a],u=i[2*a+1],d=h(t.x,t.y,n,r,l,u),_=k(t,d);_<o&&(o=_,s=d),n=l,r=u}return new Z(this,s,c?o:-o)},et.prototype.segmentQuery=function(t,e){for(var i=this.tPlanes,n=this.tVerts,r=i.length,o=2*r,s=0;s<r;s++){var c=i[s].n,a=v(t,c);if(!(i[s].d>a)){var l=v(e,c),h=(i[s].d-a)/(l-a);if(!(h<0||1<h)){var u=N(t,e,h),d=-R(c,u),_=-P(c.x,c.y,n[2*s],n[2*s+1]),p=-P(c.x,c.y,n[(2*s+2)%o],n[(2*s+3)%o]);if(_<=d&&d<=p)return new J(this,h,c)}}}},et.prototype.valueOnAxis=function(t,i){for(var n=this.tVerts,r=T(t.x,t.y,n[0],n[1]),o=2;o<n.length;o+=2)r=e(r,T(t.x,t.y,n[o],n[o+1]));return r-i},et.prototype.containsVert=function(t,e){for(var i=this.tPlanes,n=0;n<i.length;n++){var r=i[n].n,o=T(r.x,r.y,t,e)-i[n].d;if(o>0)return!1}return!0},et.prototype.containsVertPartial=function(t,e,i){for(var n=this.tPlanes,r=0;r<n.length;r++){var o=n[r].n;if(!(v(o,i)<0)){var s=T(o.x,o.y,t,e)-n[r].d;if(s>0)return!1}}return!0},et.prototype.getNumVerts=function(){return this.verts.length/2},et.prototype.getCount=et.prototype.getNumVerts,et.prototype.getVert=function(t){return new g(this.verts[2*t],this.verts[2*t+1])};var rt=t.Body=function(t,e){this.p=new g(0,0),this.vx=this.vy=0,this.f=new g(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(t),this.setMoment(e),this.rot=new g(0,0),this.setAngle(0)},ot=function(){var t=new rt(1/0,1/0);return t.nodeIdleTime=1/0,t};t.StaticBody=ot;var st=function(t,e){n(t.x==t.x&&t.y==t.y,e)},ct=function(t,e){n(Math.abs(t.x)!==1/0&&Math.abs(t.y)!==1/0,e)},at=function(t,e){st(t,e),ct(t,e)};rt.prototype.sanityCheck=function(){n(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),n(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),at(this.p,"Body's position is invalid."),at(this.f,"Body's force is invalid."),n(this.vx===this.vx&&Math.abs(this.vx)!==1/0,"Body's velocity is invalid."),n(this.vy===this.vy&&Math.abs(this.vy)!==1/0,"Body's velocity is invalid."),n(this.a===this.a&&Math.abs(this.a)!==1/0,"Body's angle is invalid."),n(this.w===this.w&&Math.abs(this.w)!==1/0,"Body's angular velocity is invalid."),n(this.t===this.t&&Math.abs(this.t)!==1/0,"Body's torque is invalid."),at(this.rot,"Body's rotation vector is invalid."),n(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),n(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")},rt.prototype.getPos=function(){return this.p},rt.prototype.getVel=function(){return new g(this.vx,this.vy)},rt.prototype.getAngVel=function(){return this.w},rt.prototype.getPosition=rt.prototype.getPos,rt.prototype.getVelocity=rt.prototype.getVel,rt.prototype.getAngularVelocity=rt.prototype.getAngVel,rt.prototype.getCenterOfGravity=function(){return this.p},rt.prototype.isSleeping=function(){return null!==this.nodeRoot},rt.prototype.isStatic=function(){return this.nodeIdleTime===1/0},rt.prototype.isRogue=function(){return null===this.space},rt.prototype.setMass=function(t){n(t>0,"Mass must be positive and non-zero."),this.activate(),this.m=t,this.m_inv=1/t},rt.prototype.setMoment=function(t){n(t>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=t,this.i_inv=1/t},rt.prototype.addShape=function(t){this.shapeList.push(t)},rt.prototype.removeShape=function(t){a(this.shapeList,t)};var lt=function(t,e,i){return t===i?t.next(e):(t.a===e?t.next_a=lt(t.next_a,e,i):t.next_b=lt(t.next_b,e,i),t)};rt.prototype.removeConstraint=function(t){this.constraintList=lt(this.constraintList,this,t)},rt.prototype.setPos=function(e){this.activate(),this.sanityCheck(),e===y&&(e=t.v(0,0)),this.p=e},rt.prototype.setVel=function(t){this.activate(),this.vx=t.x,this.vy=t.y},rt.prototype.setAngVel=function(t){this.activate(),this.w=t},rt.prototype.setAngleInternal=function(t){n(!isNaN(t),"Internal Error: Attempting to set body's angle to NaN"),this.a=t,this.rot.x=Math.cos(t),this.rot.y=Math.sin(t)},rt.prototype.setAngle=function(t){this.activate(),this.sanityCheck(),this.setAngleInternal(t)},rt.prototype.velocity_func=function(t,e,i){var n=this.vx*e+(t.x+this.f.x*this.m_inv)*i,r=this.vy*e+(t.y+this.f.y*this.m_inv)*i,o=this.v_limit,s=n*n+r*r,c=s>o*o?o/Math.sqrt(s):1;this.vx=n*c,this.vy=r*c;var a=this.w_limit;this.w=f(this.w*e+this.t*this.i_inv*i,-a,a),this.sanityCheck()},rt.prototype.position_func=function(t){this.p.x+=(this.vx+this.v_biasx)*t,this.p.y+=(this.vy+this.v_biasy)*t,this.setAngleInternal(this.a+(this.w+this.w_bias)*t),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},rt.prototype.resetForces=function(){this.activate(),this.f=new g(0,0),this.t=0},rt.prototype.applyForce=function(t,e){this.activate(),this.f=x(this.f,t),this.t+=R(e,t)},rt.prototype.applyImpulse=function(t,e){this.activate(),ue(this,t.x,t.y,e)},rt.prototype.getVelAtPoint=function(t){return x(new g(this.vx,this.vy),b(w(t),this.w))},rt.prototype.getVelAtWorldPoint=function(t){return this.getVelAtPoint(A(t,this.p))},rt.prototype.getVelAtLocalPoint=function(t){return this.getVelAtPoint(D(t,this.rot))},rt.prototype.eachShape=function(t){for(var e=0,i=this.shapeList.length;e<i;e++)t(this.shapeList[e])},rt.prototype.eachConstraint=function(t){for(var e=this.constraintList;e;){var i=e.next(this);t(e),e=i}},rt.prototype.eachArbiter=function(t){for(var e=this.arbiterList;e;){var i=e.next(this);e.swappedColl=this===e.body_b,t(e),e=i}},rt.prototype.local2World=function(t){return x(this.p,D(t,this.rot))},rt.prototype.world2Local=function(t){return L(A(t,this.p),this.rot)},rt.prototype.localToWorld=rt.prototype.local2World,rt.prototype.worldToLocal=rt.prototype.world2Local,rt.prototype.kineticEnergy=function(){var t=this.vx*this.vx+this.vy*this.vy,e=this.w*this.w;return(t?t*this.m:0)+(e?e*this.i:0)};var ht=t.SpatialIndex=function(t){if(this.staticIndex=t,t){if(t.dynamicIndex)throw new Error("This static index is already associated with a dynamic index.");t.dynamicIndex=this}};ht.prototype.collideStatic=function(t,e){if(t.count>0){var i=t.query;this.each(function(t){i(t,new U(t.bb_l,t.bb_b,t.bb_r,t.bb_t),e)})}};var ut=t.BBTree=function(t){ht.call(this,t),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};ut.prototype=Object.create(ht.prototype);var dt=0,_t=function(t,n,r){this.obj=null,this.bb_l=e(n.bb_l,r.bb_l),this.bb_b=e(n.bb_b,r.bb_b),this.bb_r=i(n.bb_r,r.bb_r),this.bb_t=i(n.bb_t,r.bb_t),this.parent=null,this.setA(n),this.setB(r)};ut.prototype.makeNode=function(t,e){var i=this.pooledNodes;return i?(this.pooledNodes=i.parent,i.constructor(this,t,e),i):(dt++,new _t(this,t,e))};var pt=0,ft=function(t,e){this.obj=e,t.getBB(e,this),this.parent=null,this.stamp=1,this.pairs=null,pt++};ut.prototype.getBB=function(t,n){var r=this.velocityFunc;if(r){var o=.1,s=(t.bb_r-t.bb_l)*o,c=(t.bb_t-t.bb_b)*o,a=b(r(t),.1);n.bb_l=t.bb_l+e(-s,a.x),n.bb_b=t.bb_b+e(-c,a.y),n.bb_r=t.bb_r+i(s,a.x),n.bb_t=t.bb_t+i(c,a.y)}else n.bb_l=t.bb_l,n.bb_b=t.bb_b,n.bb_r=t.bb_r,n.bb_t=t.bb_t},ut.prototype.getStamp=function(){var t=this.dynamicIndex;return t&&t.stamp?t.stamp:this.stamp},ut.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++};var mt=0,gt=function(t,e,i,n){this.prevA=null,this.leafA=t,this.nextA=e,this.prevB=null,this.leafB=i,this.nextB=n};ut.prototype.makePair=function(t,e,i,n){var r=this.pooledPairs;return r?(this.pooledPairs=r.prevA,r.prevA=null,r.leafA=t,r.nextA=e,r.prevB=null,r.leafB=i,r.nextB=n,r):(mt++,new gt(t,e,i,n))},gt.prototype.recycle=function(t){this.prevA=t.pooledPairs,t.pooledPairs=this};var yt=function(t,e,i){i&&(i.leafA===e?i.prevA=t:i.prevB=t),t?t.leafA===e?t.nextA=i:t.nextB=i:e.pairs=i};ft.prototype.clearPairs=function(t){var e,i=this.pairs;for(this.pairs=null;i;)i.leafA===this?(e=i.nextA,yt(i.prevB,i.leafB,i.nextB)):(e=i.nextB,yt(i.prevA,i.leafA,i.nextA)),i.recycle(t),i=e};var vt=function(t,e,i){var n=t.pairs,r=e.pairs,o=i.makePair(t,n,e,r);t.pairs=e.pairs=o,n&&(n.leafA===t?n.prevA=o:n.prevB=o),r&&(r.leafA===e?r.prevA=o:r.prevB=o)};_t.prototype.recycle=function(t){this.parent=t.pooledNodes,t.pooledNodes=this},ft.prototype.recycle=function(t){},_t.prototype.setA=function(t){this.A=t,t.parent=this},_t.prototype.setB=function(t){this.B=t,t.parent=this},ft.prototype.isLeaf=!0,_t.prototype.isLeaf=!1,_t.prototype.otherChild=function(t){return this.A==t?this.B:this.A},_t.prototype.replaceChild=function(t,n,o){r(t==this.A||t==this.B,"Node is not a child of parent."),this.A==t?(this.A.recycle(o),this.setA(n)):(this.B.recycle(o),this.setB(n));for(var s=this;s;s=s.parent){var c=s.A,a=s.B;s.bb_l=e(c.bb_l,a.bb_l),s.bb_b=e(c.bb_b,a.bb_b),s.bb_r=i(c.bb_r,a.bb_r),s.bb_t=i(c.bb_t,a.bb_t)}},_t.prototype.bbArea=ft.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var Tt=function(t,n){return(i(t.bb_r,n.bb_r)-e(t.bb_l,n.bb_l))*(i(t.bb_t,n.bb_t)-e(t.bb_b,n.bb_b))},Ct=function(t,e){return Math.abs(t.bb_l+t.bb_r-e.bb_l-e.bb_r)+Math.abs(t.bb_b+t.bb_t-e.bb_b-e.bb_t)},St=function(t,n,r){if(null==t)return n;if(t.isLeaf)return r.makeNode(n,t);var o=t.B.bbArea()+Tt(t.A,n),s=t.A.bbArea()+Tt(t.B,n);return o===s&&(o=Ct(t.A,n),s=Ct(t.B,n)),s<o?t.setB(St(t.B,n,r)):t.setA(St(t.A,n,r)),t.bb_l=e(t.bb_l,n.bb_l),t.bb_b=e(t.bb_b,n.bb_b),t.bb_r=i(t.bb_r,n.bb_r),t.bb_t=i(t.bb_t,n.bb_t),t};_t.prototype.intersectsBB=ft.prototype.intersectsBB=function(t){return this.bb_l<=t.r&&t.l<=this.bb_r&&this.bb_b<=t.t&&t.b<=this.bb_t};var xt=function(t,e,i){t.intersectsBB(e)&&(t.isLeaf?i(t.obj):(xt(t.A,e,i),xt(t.B,e,i)))},At=function(t,n,r){var o=1/(r.x-n.x),s=t.bb_l==n.x?-(1/0):(t.bb_l-n.x)*o,c=t.bb_r==n.x?1/0:(t.bb_r-n.x)*o,a=e(s,c),l=i(s,c),h=1/(r.y-n.y),u=t.bb_b==n.y?-(1/0):(t.bb_b-n.y)*h,d=t.bb_t==n.y?1/0:(t.bb_t-n.y)*h,_=e(u,d),p=i(u,d);if(_<=l&&a<=p){var f=i(a,_),m=e(l,p);if(0<=m&&f<=1)return i(f,0)}return 1/0},Et=function(t,i,n,r,o){if(t.isLeaf)return o(t.obj);var s=At(t.A,i,n),c=At(t.B,i,n);return s<c?(s<r&&(r=e(r,Et(t.A,i,n,r,o))),c<r&&(r=e(r,Et(t.B,i,n,r,o)))):(c<r&&(r=e(r,Et(t.B,i,n,r,o))),s<r&&(r=e(r,Et(t.A,i,n,r,o)))),r};ut.prototype.subtreeRecycle=function(t){t.isLeaf&&(this.subtreeRecycle(t.A),this.subtreeRecycle(t.B),t.recycle(this))};var bt=function(t,e,i){if(e==t)return null;var n=e.parent;if(n==t){var r=t.otherChild(e);return r.parent=t.parent,t.recycle(i),r}return n.parent.replaceChild(n,n.otherChild(e),i),t},Rt=function(t,e){return t.bb_l<=e.bb_r&&e.bb_l<=t.bb_r&&t.bb_b<=e.bb_t&&e.bb_b<=t.bb_t};ft.prototype.markLeafQuery=function(t,e,i,n){Rt(t,this)&&(e?vt(t,this,i):(this.stamp<t.stamp&&vt(this,t,i),n&&n(t.obj,this.obj)))},_t.prototype.markLeafQuery=function(t,e,i,n){Rt(t,this)&&(this.A.markLeafQuery(t,e,i,n),this.B.markLeafQuery(t,e,i,n))},ft.prototype.markSubtree=function(t,e,i){if(this.stamp==t.getStamp()){e&&e.markLeafQuery(this,!1,t,i);for(var n=this;n.parent;n=n.parent)n==n.parent.A?n.parent.B.markLeafQuery(this,!0,t,i):n.parent.A.markLeafQuery(this,!1,t,i)}else for(var r=this.pairs;r;)this===r.leafB?(i&&i(r.leafA.obj,this.obj),r=r.nextB):r=r.nextA},_t.prototype.markSubtree=function(t,e,i){this.A.markSubtree(t,e,i),this.B.markSubtree(t,e,i)},ft.prototype.containsObj=function(t){return this.bb_l<=t.bb_l&&this.bb_r>=t.bb_r&&this.bb_b<=t.bb_b&&this.bb_t>=t.bb_t},ft.prototype.update=function(t){var e=t.root,i=this.obj;return!this.containsObj(i)&&(t.getBB(this.obj,this),e=bt(e,this,t),t.root=St(e,this,t),this.clearPairs(t),this.stamp=t.getStamp(),!0)},ft.prototype.addPairs=function(t){var e=t.dynamicIndex;if(e){var i=e.root;i&&i.markLeafQuery(this,!0,e,null)}else{var n=t.staticIndex.root;this.markSubtree(t,n,null)}},ut.prototype.insert=function(t,e){var i=new ft(this,t);this.leaves[e]=i,this.root=St(this.root,i,this),this.count++,i.stamp=this.getStamp(),i.addPairs(this),this.incrementStamp()},ut.prototype.remove=function(t,e){var i=this.leaves[e];delete this.leaves[e],this.root=bt(this.root,i,this),this.count--,i.clearPairs(this),i.recycle(this)},ut.prototype.contains=function(t,e){return null!=this.leaves[e]};var Pt=function(t,e){};ut.prototype.reindexQuery=function(t){if(this.root){var e,i=this.leaves;for(e in i)i[e].update(this);var n=this.staticIndex,r=n&&n.root;this.root.markSubtree(this,r,t),n&&!r&&this.collideStatic(this,n,t),this.incrementStamp()}},ut.prototype.reindex=function(){this.reindexQuery(Pt)},ut.prototype.reindexObject=function(t,e){var i=this.leaves[e];i&&(i.update(this)&&i.addPairs(this),this.incrementStamp())},ut.prototype.pointQuery=function(t,e){this.query(new U(t.x,t.y,t.x,t.y),e)},ut.prototype.segmentQuery=function(t,e,i,n){this.root&&Et(this.root,t,e,i,n)},ut.prototype.query=function(t,e){this.root&&xt(this.root,t,e)},ut.prototype.count=function(){return this.count},ut.prototype.each=function(t){var e;for(e in this.leaves)t(this.leaves[e].obj)};var wt=function(t,n,r,o,s){return(i(t.bb_r,o)-e(t.bb_l,n))*(i(t.bb_t,s)-e(t.bb_b,r))},It=function(t,n,r,o){if(1==o)return n[r];if(2==o)return t.makeNode(n[r],n[r+1]);for(var s=n[r],c=s.bb_l,a=s.bb_b,l=s.bb_r,h=s.bb_t,u=r+o,d=r+1;d<u;d++)s=n[d],c=e(c,s.bb_l),a=e(a,s.bb_b),l=i(l,s.bb_r),h=i(h,s.bb_t);var _=l-c>h-a,p=new Array(2*o);if(_)for(var d=r;d<u;d++)p[2*d+0]=n[d].bb_l,p[2*d+1]=n[d].bb_r;else for(var d=r;d<u;d++)p[2*d+0]=n[d].bb_b,p[2*d+1]=n[d].bb_t;p.sort(function(t,e){return t-e});var f=.5*(p[o-1]+p[o]),m=c,g=a,y=l,v=h,T=c,C=a,S=l,x=h;_?y=T=f:v=C=f;for(var A=u,E=r;E<A;){var s=n[E];wt(s,T,C,S,x)<wt(s,m,g,y,v)?(A--,n[E]=n[A],n[A]=s):E++}if(A==o){for(var s=null,d=r;d<u;d++)s=St(s,n[d],t);return s}return NodeNew(t,It(t,n,r,A-r),It(t,n,A,u-A))};ut.prototype.optimize=function(){var t=new Array(this.count),e=0;for(var i in this.leaves)t[e++]=this.nodes[i];tree.subtreeRecycle(root),this.root=It(tree,t,t.length)};var Dt=function(t,e){!t.isLeaf&&e<=10&&(Dt(t.A,e+1),Dt(t.B,e+1));for(var i="",n=0;n<e;n++)i+=" ";console.log(i+t.bb_b+" "+t.bb_t)};ut.prototype.log=function(){this.root&&Dt(this.root,0)};var Lt=t.CollisionHandler=function(){this.a=this.b=0};Lt.prototype.begin=function(t,e){return!0},Lt.prototype.preSolve=function(t,e){return!0},Lt.prototype.postSolve=function(t,e){},Lt.prototype.separate=function(t,e){};var Ot=function(t,e){this.e=0,this.u=0,this.surface_vr=y,this.a=t,this.body_a=t.body,this.b=e,this.body_b=e.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"};Ot.prototype.getShapes=function(){return this.swappedColl?[this.b,this.a]:[this.a,this.b]},Ot.prototype.totalImpulse=function(){for(var t=this.contacts,e=new g(0,0),i=0,n=t.length;i<n;i++){var r=t[i];e.add(b(r.n,r.jnAcc))}return this.swappedColl?e:e.neg()},Ot.prototype.totalImpulseWithFriction=function(){for(var t=this.contacts,e=new g(0,0),i=0,n=t.length;i<n;i++){var r=t[i];e.add(new g(r.jnAcc,r.jtAcc).rotate(r.n))}return this.swappedColl?e:e.neg()},Ot.prototype.totalKE=function(){for(var t=(1-this.e)/(1+this.e),e=0,i=this.contacts,n=0,r=i.length;n<r;n++){var o=i[n],s=o.jnAcc,c=o.jtAcc;e+=t*s*s/o.nMass+c*c/o.tMass}return e},Ot.prototype.ignore=function(){this.state="ignore"},Ot.prototype.getA=function(){return this.swappedColl?this.b:this.a},Ot.prototype.getB=function(){return this.swappedColl?this.a:this.b},Ot.prototype.isFirstContact=function(){return"first coll"===this.state};var Bt=function(t,e,i){this.point=t,this.normal=e,this.dist=i};Ot.prototype.getContactPointSet=function(){var t,e=new Array(this.contacts.length);for(t=0;t<e.length;t++)e[t]=new Bt(this.contacts[t].p,this.contacts[t].n,this.contacts[t].dist);return e},Ot.prototype.getNormal=function(t){var e=this.contacts[t].n;return this.swappedColl?E(e):e},Ot.prototype.getPoint=function(t){return this.contacts[t].p},Ot.prototype.getDepth=function(t){return this.contacts[t].dist};var Nt=function(t,e,i,n){i?i.body_a===e?i.thread_a_next=n:i.thread_b_next=n:e.arbiterList=n,n&&(n.body_a===e?n.thread_a_prev=i:n.thread_b_prev=i)};Ot.prototype.unthread=function(){Nt(this,this.body_a,this.thread_a_prev,this.thread_a_next),Nt(this,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Ot.prototype.update=function(t,e,i,n){if(this.contacts)for(var r=0;r<this.contacts.length;r++)for(var o=this.contacts[r],s=0;s<t.length;s++){var c=t[s];c.hash===o.hash&&(c.jnAcc=o.jnAcc,c.jtAcc=o.jtAcc)}this.contacts=t,this.handler=e,this.swappedColl=i.collision_type!==e.a,this.e=i.e*n.e,this.u=i.u*n.u,this.surface_vr=A(i.surface_v,n.surface_v),this.a=i,this.body_a=i.body,this.b=n,this.body_b=n.body,"cached"==this.state&&(this.state="first coll")},Ot.prototype.preStep=function(t,i,n){for(var r=this.body_a,o=this.body_b,s=0;s<this.contacts.length;s++){var c=this.contacts[s];c.r1=A(c.p,r.p),c.r2=A(c.p,o.p),c.nMass=1/fe(r,o,c.r1,c.r2,c.n),c.tMass=1/fe(r,o,c.r1,c.r2,w(c.n)),c.bias=-n*e(0,c.dist+i)/t,c.jBias=0,c.bounce=he(r,o,c.r1,c.r2,c.n)*this.e}},Ot.prototype.applyCachedImpulse=function(t){if(!this.isFirstContact())for(var e=this.body_a,i=this.body_b,n=0;n<this.contacts.length;n++){var r=this.contacts[n],o=r.n.x,s=r.n.y,c=o*r.jnAcc-s*r.jtAcc,a=o*r.jtAcc+s*r.jnAcc;de(e,i,r.r1,r.r2,c*t,a*t)}};var Ft=0,Mt=0;Ot.prototype.applyImpulse=function(){Ft++;for(var t=this.body_a,e=this.body_b,n=this.surface_vr,r=this.u,o=0;o<this.contacts.length;o++){Mt++;var s=this.contacts[o],c=s.nMass,a=s.n,l=s.r1,h=s.r2,u=e.vx-h.y*e.w-(t.vx-l.y*t.w),d=e.vy+h.x*e.w-(t.vy+l.x*t.w),_=a.x*(e.v_biasx-h.y*e.w_bias-t.v_biasx+l.y*t.w_bias)+a.y*(h.x*e.w_bias+e.v_biasy-l.x*t.w_bias-t.v_biasy),p=T(u,d,a.x,a.y),m=T(u+n.x,d+n.y,-a.y,a.x),g=(s.bias-_)*c,y=s.jBias;s.jBias=i(y+g,0);var v=-(s.bounce+p)*c,C=s.jnAcc;s.jnAcc=i(C+v,0);var S=r*s.jnAcc,x=-m*s.tMass,A=s.jtAcc;s.jtAcc=f(A+x,-S,S);var E=a.x*(s.jBias-y),b=a.y*(s.jBias-y);_e(t,-E,-b,l),_e(e,E,b,h);var R=s.jnAcc-C,P=s.jtAcc-A;de(t,e,l,h,a.x*R-a.y*P,a.x*P+a.y*R)}},Ot.prototype.callSeparate=function(t){var e=t.lookupHandler(this.a.collision_type,this.b.collision_type);e.separate(this,t)},Ot.prototype.next=function(t){return this.body_a==t?this.thread_a_next:this.thread_b_next};var Vt=0,kt=function(t,e,i,n){this.p=t,this.n=e,this.dist=i,this.r1=this.r2=y,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=n,Vt++},Gt=[],Wt=function(t,e,i,n){var r=i+n,o=A(e,t),s=O(o);if(!(s>=r*r)){var c=Math.sqrt(s);return new kt(x(t,b(o,.5+(i-.5*r)/(c?c:1/0))),c?b(o,1/c):new g(1,0),c-r,0)}},zt=function(t,e){var i=Wt(t.tc,e.tc,t.r,e.r);return i?[i]:Gt},Ut=function(t,e){var i=e.ta,n=e.tb,r=t.tc,o=A(n,i),s=m(v(o,A(r,i))/O(o)),c=x(i,b(o,s)),a=Wt(r,c,t.r,e.r);if(a){var l=a.n;return 0===s&&v(l,e.a_tangent)<0||1===s&&v(l,e.b_tangent)<0?Gt:[a]}return Gt},Yt=0,Xt=function(t,e){var i=0,n=t.valueOnAxis(e[0].n,e[0].d);if(n>0)return-1;for(var r=1;r<e.length;r++){var o=t.valueOnAxis(e[r].n,e[r].d);if(o>0)return-1;o>n&&(n=o,i=r)}return Yt=n,i},Ht=function(t,e,i,n){for(var r=[],o=t.tVerts,s=0;s<o.length;s+=2){var a=o[s],l=o[s+1];e.containsVertPartial(a,l,E(i))&&r.push(new kt(new g(a,l),i,n,c(t.hashid,s)))}for(var h=e.tVerts,s=0;s<h.length;s+=2){var a=h[s],l=h[s+1];t.containsVertPartial(a,l,i)&&r.push(new kt(new g(a,l),i,n,c(e.hashid,s)))}return r},jt=function(t,e,i,n){for(var r=[],o=t.tVerts,s=0;s<o.length;s+=2){var a=o[s],l=o[s+1];e.containsVert(a,l)&&r.push(new kt(new g(a,l),i,n,c(t.hashid,s>>1)))}for(var h=e.tVerts,s=0;s<h.length;s+=2){var a=h[s],l=h[s+1];t.containsVert(a,l)&&r.push(new kt(new g(a,l),i,n,c(e.hashid,s>>1)))}return r.length?r:Ht(t,e,i,n)},qt=function(t,e){var i=Xt(e,t.tPlanes);if(i==-1)return Gt;var n=Yt,r=Xt(t,e.tPlanes);if(r==-1)return Gt;var o=Yt;return n>o?jt(t,e,t.tPlanes[i].n,n):jt(t,e,E(e.tPlanes[r].n),o)},Zt=function(t,i,n){var r=v(i,t.ta)-t.r,o=v(i,t.tb)-t.r;return e(r,o)-n},Jt=function(t,e,i,n,r){for(var o=R(e.tn,e.ta),s=R(e.tn,e.tb),a=b(e.tn,r),l=i.tVerts,h=0;h<l.length;h+=2){var u=l[h],d=l[h+1];if(T(u,d,a.x,a.y)<v(e.tn,e.ta)*r+e.r){var _=P(e.tn.x,e.tn.y,u,d);o>=_&&_>=s&&t.push(new kt(new g(u,d),a,n,c(i.hashid,h)))}}},Kt=function(t,e){var i=[],n=e.tPlanes,r=n.length,o=v(t.tn,t.ta),s=e.valueOnAxis(t.tn,o)-t.r,a=e.valueOnAxis(E(t.tn),-o)-t.r;if(a>0||s>0)return Gt;var l=0,h=Zt(t,n[0].n,n[0].d);if(h>0)return Gt;for(var u=0;u<r;u++){var d=Zt(t,n[u].n,n[u].d);if(d>0)return Gt;d>h&&(h=d,l=u)}var _=E(n[l].n),p=x(t.ta,b(_,t.r)),f=x(t.tb,b(_,t.r));if(e.containsVert(p.x,p.y)&&i.push(new kt(p,_,h,c(t.hashid,0))),e.containsVert(f.x,f.y)&&i.push(new kt(f,_,h,c(t.hashid,1))),(s>=h||a>=h)&&(s>a?Jt(i,t,e,s,1):Jt(i,t,e,a,-1)),0===i.length){var m,y=2*l,T=e.tVerts,C=new g(T[y],T[y+1]);if(m=Wt(t.ta,C,t.r,0,i))return[m];if(m=Wt(t.tb,C,t.r,0,i))return[m];var S=2*r,A=new g(T[(y+2)%S],T[(y+3)%S]);if(m=Wt(t.ta,A,t.r,0,i))return[m];if(m=Wt(t.tb,A,t.r,0,i))return[m]}return i},Qt=function(t,e){for(var i=e.tPlanes,n=0,r=v(i[0].n,t.tc)-i[0].d-t.r,o=0;o<i.length;o++){var s=v(i[o].n,t.tc)-i[o].d-t.r;if(s>0)return Gt;s>r&&(r=s,n=o)}var c=i[n].n,a=e.tVerts,l=a.length,h=n<<1,u=a[h],d=a[h+1],_=a[(h+2)%l],p=a[(h+3)%l],f=P(c.x,c.y,u,d),m=P(c.x,c.y,_,p),y=R(c,t.tc);if(y<m){var T=Wt(t.tc,new g(_,p),t.r,0,T);return T?[T]:Gt}if(y<f)return[new kt(A(t.tc,b(c,t.r+r/2)),E(c),r,0)];var T=Wt(t.tc,new g(u,d),t.r,0,T);return T?[T]:Gt};K.prototype.collisionCode=0,$.prototype.collisionCode=1,et.prototype.collisionCode=2,K.prototype.collisionTable=[zt,Ut,Qt],$.prototype.collisionTable=[null,function(t,e){return Gt},Kt],et.prototype.collisionTable=[null,null,qt];var $t=t.collideShapes=function(t,e){return n(t.collisionCode<=e.collisionCode,"Collided shapes must be sorted by type"),t.collisionTable[e.collisionCode](t,e)},te=new Lt,ee=t.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new ut(null),this.activeShapes=new ut(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=te,this.postStepCallbacks=[],this.iterations=10,this.gravity=y,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new rt(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()};ee.prototype.getCurrentTimeStep=function(){return this.curr_dt},ee.prototype.setIterations=function(t){this.iterations=t},ee.prototype.isLocked=function(){return this.locked};var ie=function(t){n(!t.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")};ee.prototype.addCollisionHandler=function(t,e,i,n,r,o){ie(this),this.removeCollisionHandler(t,e);var s=new Lt;s.a=t,s.b=e,i&&(s.begin=i),n&&(s.preSolve=n),r&&(s.postSolve=r),o&&(s.separate=o),this.collisionHandlers[c(t,e)]=s},ee.prototype.removeCollisionHandler=function(t,e){ie(this),delete this.collisionHandlers[c(t,e)]},ee.prototype.setDefaultCollisionHandler=function(t,e,i,n){ie(this);var r=new Lt;t&&(r.begin=t),e&&(r.preSolve=e),i&&(r.postSolve=i),n&&(r.separate=n),this.defaultHandler=r},ee.prototype.lookupHandler=function(t,e){return this.collisionHandlers[c(t,e)]||this.defaultHandler},ee.prototype.addShape=function(t){var e=t.body;return e.isStatic()?this.addStaticShape(t):(n(!t.space,"This shape is already added to a space and cannot be added to another."),ie(this),e.activate(),e.addShape(t),t.update(e.p,e.rot),this.activeShapes.insert(t,t.hashid),t.space=this,t)},ee.prototype.addStaticShape=function(t){n(!t.space,"This shape is already added to a space and cannot be added to another."),ie(this);var e=t.body;return e.addShape(t),t.update(e.p,e.rot),this.staticShapes.insert(t,t.hashid),t.space=this,t},ee.prototype.addBody=function(t){return n(!t.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),n(!t.space,"This body is already added to a space and cannot be added to another."),ie(this),this.bodies.push(t),t.space=this,t},ee.prototype.addConstraint=function(t){n(!t.space,"This shape is already added to a space and cannot be added to another."),ie(this);var e=t.a,i=t.b;return e.activate(),i.activate(),this.constraints.push(t),t.next_a=e.constraintList,e.constraintList=t,t.next_b=i.constraintList,i.constraintList=t,t.space=this,t},ee.prototype.filterArbiters=function(t,e){for(var i in this.cachedArbiters){var n=this.cachedArbiters[i];(t!==n.body_a||e!==n.a&&null!==e)&&(t!==n.body_b||e!==n.b&&null!==e)||(e&&"cached"!==n.state&&n.callSeparate(this),n.unthread(),a(this.arbiters,n),delete this.cachedArbiters[i])}},ee.prototype.removeShape=function(t){var e=t.body;e.isStatic()?this.removeStaticShape(t):(n(this.containsShape(t),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),ie(this),e.activate(),e.removeShape(t),this.filterArbiters(e,t),this.activeShapes.remove(t,t.hashid),t.space=null)},ee.prototype.removeStaticShape=function(t){n(this.containsShape(t),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),ie(this);var e=t.body;e.isStatic()&&e.activateStatic(t),e.removeShape(t),this.filterArbiters(e,t),this.staticShapes.remove(t,t.hashid),t.space=null},ee.prototype.removeBody=function(t){n(this.containsBody(t),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),ie(this),t.activate(),a(this.bodies,t),t.space=null},ee.prototype.removeConstraint=function(t){n(this.containsConstraint(t),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),ie(this),t.a.activate(),t.b.activate(),a(this.constraints,t),t.a.removeConstraint(t),t.b.removeConstraint(t),t.space=null},ee.prototype.containsShape=function(t){return t.space===this},ee.prototype.containsBody=function(t){return t.space==this},ee.prototype.containsConstraint=function(t){return t.space==this},ee.prototype.uncacheArbiter=function(t){delete this.cachedArbiters[c(t.a.hashid,t.b.hashid)],a(this.arbiters,t)},ee.prototype.eachBody=function(t){this.lock();for(var e=this.bodies,i=0;i<e.length;i++)t(e[i]);for(var n=this.sleepingComponents,i=0;i<n.length;i++)for(var r=n[i],o=r;o;){var s=o.nodeNext;t(o),o=s}this.unlock(!0)},ee.prototype.eachShape=function(t){this.lock(),this.activeShapes.each(t),this.staticShapes.each(t),this.unlock(!0)},ee.prototype.eachConstraint=function(t){this.lock();for(var e=this.constraints,i=0;i<e.length;i++)t(e[i]);this.unlock(!0)},ee.prototype.reindexStatic=function(){n(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each(function(t){var e=t.body;t.update(e.p,e.rot)}),this.staticShapes.reindex()},ee.prototype.reindexShape=function(t){n(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var e=t.body;t.update(e.p,e.rot),this.activeShapes.reindexObject(t,t.hashid),this.staticShapes.reindexObject(t,t.hashid)},ee.prototype.reindexShapesForBody=function(t){for(var e=t.shapeList;e;e=e.next)this.reindexShape(e)},ee.prototype.useSpatialHash=function(t,e){throw new Error("Spatial Hash not implemented.")},ee.prototype.activateBody=function(t){if(n(!t.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked)this.rousedBodies.indexOf(t)===-1&&this.rousedBodies.push(t);else{this.bodies.push(t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.staticShapes.remove(i,i.hashid),this.activeShapes.insert(i,i.hashid)}for(var r=t.arbiterList;r;r=r.next(t)){var o=r.body_a;if(t===o||o.isStatic()){var s=r.a,a=r.b;this.cachedArbiters[c(s.hashid,a.hashid)]=r,r.stamp=this.stamp,r.handler=this.lookupHandler(s.collision_type,a.collision_type),this.arbiters.push(r)}}for(var l=t.constraintList;l;l=l.nodeNext){var o=l.a;(t===o||o.isStatic())&&this.constraints.push(l)}}},ee.prototype.deactivateBody=function(t){n(!t.isRogue(),"Internal error: Attempting to deactivate a rogue body."),a(this.bodies,t);for(var e=0;e<t.shapeList.length;e++){var i=t.shapeList[e];this.activeShapes.remove(i,i.hashid),this.staticShapes.insert(i,i.hashid)}for(var r=t.arbiterList;r;r=r.next(t)){var o=r.body_a;(t===o||o.isStatic())&&this.uncacheArbiter(r)}for(var s=t.constraintList;s;s=s.nodeNext){var o=s.a;(t===o||o.isStatic())&&a(this.constraints,s)}};var ne=function(t){return t?t.nodeRoot:null},re=function(t){if(t&&t.isSleeping(t)){n(!t.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var e=t.space,i=t;i;){var r=i.nodeNext;i.nodeIdleTime=0,i.nodeRoot=null,i.nodeNext=null,e.activateBody(i),i=r}a(e.sleepingComponents,t)}};rt.prototype.activate=function(){this.isRogue()||(this.nodeIdleTime=0,re(ne(this)))},rt.prototype.activateStatic=function(t){n(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var e=this.arbiterList;e;e=e.next(this))t&&t!=e.a&&t!=e.b||(e.body_a==this?e.body_b:e.body_a).activate()},rt.prototype.pushArbiter=function(t){r(null===(t.body_a===this?t.thread_a_next:t.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),r(null===(t.body_a===this?t.thread_a_prev:t.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var e=this.arbiterList;r(null===e||null===(e.body_a===this?e.thread_a_prev:e.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),t.body_a===this?t.thread_a_next=e:t.thread_b_next=e,e&&(e.body_a===this?e.thread_a_prev=t:e.thread_b_prev=t),this.arbiterList=t};var oe=function(t,e){e.nodeRoot=t,e!==t&&(e.nodeNext=t.nodeNext,t.nodeNext=e)},se=function(t,e){if(!e.isRogue()){var i=ne(e);if(null==i){oe(t,e);for(var n=e.arbiterList;n;n=n.next(e))se(t,e==n.body_a?n.body_b:n.body_a);for(var o=e.constraintList;o;o=o.next(e))se(t,e==o.a?o.b:o.a)}else r(i===t,"Internal Error: Inconsistency detected in the contact graph.")}},ce=function(t,e){for(var i=t;i;i=i.nodeNext)if(i.nodeIdleTime<e)return!0;return!1};ee.prototype.processComponents=function(t){for(var e=this.sleepTimeThreshold!==1/0,i=this.bodies,n=0;n<i.length;n++){var o=i[n];r(null===o.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),r(null===o.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(e)for(var s=this.idleSpeedThreshold,c=s?s*s:O(this.gravity)*t*t,n=0;n<i.length;n++){var o=i[n],a=c?o.m*c:0;o.nodeIdleTime=o.kineticEnergy()>a?0:o.nodeIdleTime+t}for(var l=this.arbiters,n=0,h=l.length;n<h;n++){var u=l[n],d=u.body_a,_=u.body_b;e&&((_.isRogue()&&!_.isStatic()||d.isSleeping())&&d.activate(),(d.isRogue()&&!d.isStatic()||_.isSleeping())&&_.activate()),d.pushArbiter(u),_.pushArbiter(u)}if(e){for(var p=this.constraints,n=0;n<p.length;n++){var f=p[n],d=f.a,_=f.b;_.isRogue()&&!_.isStatic()&&d.activate(),d.isRogue()&&!d.isStatic()&&_.activate()}for(var n=0;n<i.length;){var o=i[n];if(null!==ne(o)||(se(o,o),ce(o,this.sleepTimeThreshold)))n++,o.nodeRoot=null,o.nodeNext=null;else{this.sleepingComponents.push(o);for(var m=o;m;m=m.nodeNext)this.deactivateBody(m)}}}},rt.prototype.sleep=function(){this.sleepWithGroup(null)},rt.prototype.sleepWithGroup=function(t){n(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var e=this.space;if(n(e,"Cannot put a rogue body to sleep."),n(!e.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),n(null===t||t.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())return void n(ne(this)===ne(t),"The body is already sleeping and it's group cannot be reassigned.");for(var i=0;i<this.shapeList.length;i++)this.shapeList[i].update(this.p,this.rot);if(e.deactivateBody(this),t){var r=ne(t);this.nodeRoot=r,this.nodeNext=r.nodeNext,this.nodeIdleTime=0,r.nodeNext=this}else this.nodeRoot=this,this.nodeNext=null,this.nodeIdleTime=0,e.sleepingComponents.push(this);a(e.bodies,this)},ee.prototype.activateShapesTouchingShape=function(t){this.sleepTimeThreshold!==1/0&&this.shapeQuery(t,function(t,e){t.body.activate()})},ee.prototype.pointQuery=function(t,e,i,n){var r=function(r){(!r.group||i!==r.group)&&e&r.layers&&r.pointQuery(t)&&n(r)},o=new U(t.x,t.y,t.x,t.y);this.lock(),this.activeShapes.query(o,r),this.staticShapes.query(o,r),this.unlock(!0)},ee.prototype.pointQueryFirst=function(t,e,i){var n=null;return this.pointQuery(t,e,i,function(t){t.sensor||(n=t)}),n},ee.prototype.nearestPointQuery=function(t,e,i,n,r){var o=function(o){if((!o.group||n!==o.group)&&i&o.layers){var s=o.nearestPointQuery(t);s.d<e&&r(o,s.d,s.p)}},s=Y(t,e);this.lock(),this.activeShapes.query(s,o),this.staticShapes.query(s,o),this.unlock(!0)},ee.prototype.nearestPointQueryNearest=function(t,e,i,n){var r,o=function(o){if((!o.group||n!==o.group)&&i&o.layers&&!o.sensor){var s=o.nearestPointQuery(t);s.d<e&&(!r||s.d<r.d)&&(r=s)}},s=Y(t,e);return this.activeShapes.query(s,o),this.staticShapes.query(s,o),r},t.SHAPE_FILTER_ALL={group:t.NO_GROUP,categories:t.ALL_CATEGORIES,mask:t.ALL_CATEGORIES},ee.prototype.pointQueryNearest=function(t,e,i){var n=this.nearestPointQueryNearest(t,e,i.mask,i.group);return"undefined"!=typeof n&&(n.distance=n.d,n.point=n.p),n},ee.prototype.segmentQuery=function(t,e,i,n,r){var o=function(o){var s;return(!o.group||n!==o.group)&&i&o.layers&&(s=o.segmentQuery(t,e))&&r(o,s.t,s.n),1};this.lock(),this.staticShapes.segmentQuery(t,e,1,o),this.activeShapes.segmentQuery(t,e,1,o),this.unlock(!0)},ee.prototype.segmentQueryFirst=function(e,i,n,r){var o=null,s=function(t){var s;return(!t.group||r!==t.group)&&n&t.layers&&!t.sensor&&(s=t.segmentQuery(e,i))&&(null===o||s.t<o.t)&&(o=s),o?o.t:1};return this.staticShapes.segmentQuery(e,i,1,s),this.activeShapes.segmentQuery(e,i,o?o.t:1,s),o&&"null"!==o&&"undefined"!==o&&(o.normal=o.n,o.alpha=o.t,o.p=o.point=t.v.lerp(e,i,o.t)),o},ee.prototype.bbQuery=function(t,e,i,n){var r=function(r){(!r.group||i!==r.group)&&e&r.layers&&X(t,r.bb_l,r.bb_b,r.bb_r,r.bb_t)&&n(r)};this.lock(),this.activeShapes.query(t,r),this.staticShapes.query(t,r),this.unlock(!0)},ee.prototype.shapeQuery=function(t,e){var i=t.body;i&&t.update(i.p,i.rot);var n=new U(t.bb_l,t.bb_b,t.bb_r,t.bb_t),r=!1,o=function(i){var n=t;if((!n.group||n.group!==i.group)&&n.layers&i.layers&&n!==i){var o;if(n.collisionCode<=i.collisionCode)o=$t(n,i);else{o=$t(i,n);for(var s=0;s<o.length;s++)o[s].n=E(o[s].n)}if(o.length&&(r=!(n.sensor||i.sensor),e)){for(var c=new Array(o.length),s=0;s<o.length;s++)c[s]=new Bt(o[s].p,o[s].n,o[s].dist);e(i,c)}}};return this.lock(),this.activeShapes.query(n,o),this.staticShapes.query(n,o),this.unlock(!0),r},ee.prototype.addPostStepCallback=function(t){r(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(t)},ee.prototype.runPostStepCallbacks=function(){for(var t=0;t<this.postStepCallbacks.length;t++)this.postStepCallbacks[t]();this.postStepCallbacks=[]},ee.prototype.lock=function(){this.locked++},ee.prototype.unlock=function(t){if(this.locked--,n(this.locked>=0,"Internal Error: Space lock underflow."),0===this.locked&&t){for(var e=this.rousedBodies,i=0;i<e.length;i++)this.activateBody(e[i]);e.length=0,this.runPostStepCallbacks()}},ee.prototype.makeCollideShapes=function(){var t=this;return function(e,i){var n=t;if(e.bb_l<=i.bb_r&&i.bb_l<=e.bb_r&&e.bb_b<=i.bb_t&&i.bb_b<=e.bb_t&&e.body!==i.body&&(!e.group||e.group!==i.group)&&e.layers&i.layers){var r=n.lookupHandler(e.collision_type,i.collision_type),o=e.sensor||i.sensor;if(!o||r!==te){if(e.collisionCode>i.collisionCode){var s=e;e=i,i=s}var a=$t(e,i);if(0!==a.length){var l=c(e.hashid,i.hashid),h=n.cachedArbiters[l];h||(h=n.cachedArbiters[l]=new Ot(e,i)),h.update(a,r,e,i),"first coll"!=h.state||r.begin(h,n)||h.ignore(),"ignore"!==h.state&&r.preSolve(h,n)&&!o?n.arbiters.push(h):(h.contacts=null,"ignore"!==h.state&&(h.state="normal")),h.stamp=n.stamp}}}}},ee.prototype.arbiterSetFilter=function(t){var e=this.stamp-t.stamp,i=t.body_a,n=t.body_b;return!(!i.isStatic()&&!i.isSleeping()||!n.isStatic()&&!n.isSleeping())||(e>=1&&"cached"!=t.state&&(t.callSeparate(this),t.state="cached"),!(e>=this.collisionPersistence)||(t.contacts=null,!1))};var ae=function(t){var e=t.body;t.update(e.p,e.rot)};ee.prototype.step=function(t){if(0!==t){n(0===y.x&&0===y.y,"vzero is invalid"),this.stamp++;var e=this.curr_dt;this.curr_dt=t;var i,r,o,s=this.bodies,c=this.constraints,a=this.arbiters;for(i=0;i<a.length;i++){var l=a[i];l.state="normal",l.body_a.isSleeping()||l.body_b.isSleeping()||l.unthread()}for(a.length=0,this.lock(),i=0;i<s.length;i++)s[i].position_func(t);this.activeShapes.each(ae),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(t),this.lock();for(o in this.cachedArbiters)this.arbiterSetFilter(this.cachedArbiters[o])||delete this.cachedArbiters[o];var h=this.collisionSlop,u=1-Math.pow(this.collisionBias,t);for(i=0;i<a.length;i++)a[i].preStep(t,h,u);for(i=0;i<c.length;i++){var d=c[i];d.preSolve(this),d.preStep(t)}var _=Math.pow(this.damping,t),p=this.gravity;for(i=0;i<s.length;i++)s[i].velocity_func(p,_,t);var f=0===e?0:t/e;for(i=0;i<a.length;i++)a[i].applyCachedImpulse(f);for(i=0;i<c.length;i++)c[i].applyCachedImpulse(f);for(i=0;i<this.iterations;i++){for(r=0;r<a.length;r++)a[r].applyImpulse();for(r=0;r<c.length;r++)c[r].applyImpulse()}for(i=0;i<c.length;i++)c[i].postSolve(this);for(i=0;i<a.length;i++)a[i].handler.postSolve(a[i],this);this.unlock(!0)}};var le=function(t,e,i,n){var r=t.vx+-i.y*t.w,o=t.vy+i.x*t.w,s=e.vx+-n.y*e.w,c=e.vy+n.x*e.w;return new g(s-r,c-o)},he=function(t,e,i,n,r){var o=t.vx+-i.y*t.w,s=t.vy+i.x*t.w,c=e.vx+-n.y*e.w,a=e.vy+n.x*e.w;return T(c-o,a-s,r.x,r.y)},ue=function(t,e,i,n){t.vx+=e*t.m_inv,t.vy+=i*t.m_inv,t.w+=t.i_inv*(n.x*i-n.y*e)},de=function(t,e,i,n,r,o){ue(t,-r,-o,i),ue(e,r,o,n)},_e=function(t,e,i,n){t.v_biasx+=e*t.m_inv,t.v_biasy+=i*t.m_inv,t.w_bias+=t.i_inv*P(n.x,n.y,e,i)},pe=function(t,e,i){var n=R(e,i);return t.m_inv+t.i_inv*n*n},fe=function(t,e,i,n,o){var s=pe(t,i,o)+pe(e,n,o);return r(0!==s,"Unsolvable collision or constraint."),s},me=function(t,e,i,n,o,s){var c,a,l,h,u=t.m_inv+e.m_inv;c=u,a=0,l=0,h=u;var d=t.i_inv,_=i.x*i.x*d,p=i.y*i.y*d,f=-i.x*i.y*d;c+=p,a+=f,l+=f,h+=_;var m=e.i_inv,g=n.x*n.x*m,y=n.y*n.y*m,v=-n.x*n.y*m;c+=y,a+=v,l+=v,h+=g;var T=c*h-a*l;r(0!==T,"Unsolvable constraint.");var C=1/T;o.x=h*C,o.y=-a*C,s.x=-l*C,s.y=c*C},ge=function(t,e,i){return new g(v(t,e),v(t,i))},ye=function(t,e){return 1-Math.pow(t,e)},ve=t.Constraint=function(t,e){this.a=t,this.b=e,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};ve.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},ve.prototype.preStep=function(t){},ve.prototype.applyCachedImpulse=function(t){},ve.prototype.applyImpulse=function(){},ve.prototype.getImpulse=function(){return 0},ve.prototype.preSolve=function(t){},ve.prototype.postSolve=function(t){},ve.prototype.next=function(t){return this.a===t?this.next_a:this.next_b};var Te=t.PinJoint=function(t,e,i,n){ve.call(this,t,e),this.anchr1=i,this.anchr2=n;var o=t?x(t.p,D(i,t.rot)):i,s=e?x(e.p,D(n,e.rot)):n;this.dist=C(A(s,o)),r(this.dist>0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Te.prototype=Object.create(ve.prototype),Te.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),r=C(n);this.n=b(n,1/(r?r:1/0)),this.nMass=1/fe(e,i,this.r1,this.r2,this.n);var o=this.maxBias;this.bias=f(-ye(this.errorBias,t)*(r-this.dist)/t,-o,o),this.jnMax=this.maxForce*t},Te.prototype.applyCachedImpulse=function(t){var e=b(this.n,this.jnAcc*t);de(this.a,this.b,this.r1,this.r2,e.x,e.y)},Te.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=he(t,e,this.r1,this.r2,i),r=(this.bias-n)*this.nMass,o=this.jnAcc;this.jnAcc=f(o+r,-this.jnMax,this.jnMax),r=this.jnAcc-o,de(t,e,this.r1,this.r2,i.x*r,i.y*r)},Te.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Ce=t.SlideJoint=function(t,e,i,n,r,o){ve.call(this,t,e),this.anchr1=i,this.anchr2=n,this.min=r,this.max=o,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};Ce.prototype=Object.create(ve.prototype),Ce.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),r=C(n),o=0;r>this.max?(o=r-this.max,this.n=M(n)):r<this.min?(o=this.min-r,this.n=E(M(n))):(this.n=y,this.jnAcc=0),this.nMass=1/fe(e,i,this.r1,this.r2,this.n);var s=this.maxBias;this.bias=f(-ye(this.errorBias,t)*o/t,-s,s),this.jnMax=this.maxForce*t},Ce.prototype.applyCachedImpulse=function(t){var e=this.jnAcc*t;de(this.a,this.b,this.r1,this.r2,this.n.x*e,this.n.y*e)},Ce.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var t=this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,o=le(t,e,n,r),s=v(o,i),c=(this.bias-s)*this.nMass,a=this.jnAcc;this.jnAcc=f(a+c,-this.jnMax,0),c=this.jnAcc-a,de(t,e,this.r1,this.r2,i.x*c,i.y*c)}},Ce.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var Se=t.PivotJoint=function(t,e,i,n){if(ve.call(this,t,e),"undefined"==typeof n){var r=i;i=t?t.world2Local(r):r,n=e?e.world2Local(r):r}this.anchr1=i,this.anchr2=n,this.r1=this.r2=y,this.k1=new g(0,0),this.k2=new g(0,0),this.jAcc=y,this.jMaxLen=0,this.bias=y};Se.prototype=Object.create(ve.prototype),Se.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot),me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var n=A(x(i.p,this.r2),x(e.p,this.r1));this.bias=V(b(n,-ye(this.errorBias,t)/t),this.maxBias)},Se.prototype.applyCachedImpulse=function(t){de(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},Se.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,r=le(t,e,i,n),o=ge(A(this.bias,r),this.k1,this.k2),s=this.jAcc;this.jAcc=V(x(this.jAcc,o),this.jMaxLen),de(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},Se.prototype.getImpulse=function(){return C(this.jAcc)};var xe=t.GrooveJoint=function(t,e,i,n,r){ve.call(this,t,e),this.grv_a=i,this.grv_b=n,this.grv_n=w(F(A(n,i))),this.anchr2=r,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new g(0,0),this.k2=new g(0,0),this.jAcc=y,this.jMaxLen=0,this.bias=null};xe.prototype=Object.create(ve.prototype),xe.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.local2World(this.grv_a),r=e.local2World(this.grv_b),o=D(this.grv_n,e.rot),s=v(n,o);this.grv_tn=o,this.r2=D(this.anchr2,i.rot);var c=R(x(i.p,this.r2),o);c<=R(n,o)?(this.clamp=1,this.r1=A(n,e.p)):c>=R(r,o)?(this.clamp=-1,this.r1=A(r,e.p)):(this.clamp=0,this.r1=A(x(b(w(o),-c),b(o,s)),e.p)),me(e,i,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*t;var a=A(x(i.p,this.r2),x(e.p,this.r1));this.bias=V(b(a,-ye(this.errorBias,t)/t),this.maxBias)},xe.prototype.applyCachedImpulse=function(t){de(this.a,this.b,this.r1,this.r2,this.jAcc.x*t,this.jAcc.y*t)},xe.prototype.grooveConstrain=function(t){var e=this.grv_tn,i=this.clamp*R(t,e)>0?t:I(t,e);return V(i,this.jMaxLen)},xe.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.r1,n=this.r2,r=le(t,e,i,n),o=ge(A(this.bias,r),this.k1,this.k2),s=this.jAcc;this.jAcc=this.grooveConstrain(x(s,o)),de(t,e,this.r1,this.r2,this.jAcc.x-s.x,this.jAcc.y-s.y)},xe.prototype.getImpulse=function(){return C(this.jAcc)},xe.prototype.setGrooveA=function(t){this.grv_a=t,this.grv_n=w(F(A(this.grv_b,t))),this.activateBodies()},xe.prototype.setGrooveB=function(t){this.grv_b=t,this.grv_n=w(F(A(t,this.grv_a))),this.activateBodies()};var Ae=function(t,e){return(t.restLength-e)*t.stiffness},Ee=t.DampedSpring=function(t,e,i,n,r,o,s){ve.call(this,t,e),this.anchr1=i,this.anchr2=n,this.restLength=r,this.stiffness=o,this.damping=s,this.springForceFunc=Ae,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};Ee.prototype=Object.create(ve.prototype),Ee.prototype.preStep=function(t){var e=this.a,i=this.b;this.r1=D(this.anchr1,e.rot),this.r2=D(this.anchr2,i.rot);var n=A(x(i.p,this.r2),x(e.p,this.r1)),o=C(n);this.n=b(n,1/(o?o:1/0));var s=fe(e,i,this.r1,this.r2,this.n);r(0!==s,"Unsolvable this."),this.nMass=1/s,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*t*s);var c=this.springForceFunc(this,o);de(e,i,this.r1,this.r2,this.n.x*c*t,this.n.y*c*t)},Ee.prototype.applyCachedImpulse=function(t){},Ee.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=this.n,n=this.r1,r=this.r2,o=he(t,e,n,r,i),s=(this.target_vrn-o)*this.v_coef;this.target_vrn=o+s,s*=this.nMass,de(t,e,this.r1,this.r2,this.n.x*s,this.n.y*s)},Ee.prototype.getImpulse=function(){return 0};var be=function(t,e){return(e-t.restAngle)*t.stiffness},Re=t.DampedRotarySpring=function(t,e,i,n,r){ve.call(this,t,e),this.restAngle=i,this.stiffness=n,this.damping=r,this.springTorqueFunc=be,this.target_wrn=0,this.w_coef=0,this.iSum=0};Re.prototype=Object.create(ve.prototype),Re.prototype.preStep=function(t){var e=this.a,i=this.b,n=e.i_inv+i.i_inv;r(0!==n,"Unsolvable spring."),this.iSum=1/n,this.w_coef=1-Math.exp(-this.damping*t*n),this.target_wrn=0;var o=this.springTorqueFunc(this,e.a-i.a)*t;e.w-=o*e.i_inv,i.w+=o*i.i_inv},Re.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=t.w-e.w,n=(this.target_wrn-i)*this.w_coef;this.target_wrn=i+n;var r=n*this.iSum;t.w+=r*t.i_inv,e.w-=r*e.i_inv};var Pe=t.RotaryLimitJoint=function(t,e,i,n){ve.call(this,t,e),this.min=i,this.max=n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Pe.prototype=Object.create(ve.prototype),Pe.prototype.preStep=function(t){var e=this.a,i=this.b,n=i.a-e.a,r=0;n>this.max?r=this.max-n:n<this.min&&(r=this.min-n),this.iSum=1/(1/e.i+1/i.i);var o=this.maxBias;this.bias=f(-ye(this.errorBias,t)*r/t,-o,o),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},Pe.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},Pe.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=-(this.bias+i)*this.iSum,r=this.jAcc;this.bias<0?this.jAcc=f(r+n,0,this.jMax):this.jAcc=f(r+n,-this.jMax,0),n=this.jAcc-r,t.w-=n*t.i_inv,e.w+=n*e.i_inv}},Pe.prototype.getImpulse=function(){return Math.abs(joint.jAcc)};var we=t.RatchetJoint=function(t,e,i,n){ve.call(this,t,e),this.angle=0,this.phase=i,this.ratchet=n,this.angle=(e?e.a:0)-(t?t.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};we.prototype=Object.create(ve.prototype),we.prototype.preStep=function(t){var e=this.a,i=this.b,n=this.angle,r=this.phase,o=this.ratchet,s=i.a-e.a,c=n-s,a=0;c*o>0?a=c:this.angle=Math.floor((s-r)/o)*o+r,this.iSum=1/(e.i_inv+i.i_inv);var l=this.maxBias;this.bias=f(-ye(this.errorBias,t)*a/t,-l,l),this.jMax=this.maxForce*t,this.bias||(this.jAcc=0)},we.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},we.prototype.applyImpulse=function(){if(this.bias){var t=this.a,e=this.b,i=e.w-t.w,n=this.ratchet,r=-(this.bias+i)*this.iSum,o=this.jAcc;this.jAcc=f((o+r)*n,0,this.jMax*Math.abs(n))/n,r=this.jAcc-o,t.w-=r*t.i_inv,e.w+=r*e.i_inv}},we.prototype.getImpulse=function(t){return Math.abs(t.jAcc)};var Ie=t.GearJoint=function(t,e,i,n){ve.call(this,t,e),this.phase=i,this.ratio=n,this.ratio_inv=1/n,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Ie.prototype=Object.create(ve.prototype),Ie.prototype.preStep=function(t){var e=this.a,i=this.b;this.iSum=1/(e.i_inv*this.ratio_inv+this.ratio*i.i_inv);var n=this.maxBias;this.bias=f(-ye(this.errorBias,t)*(i.a*this.ratio-e.a-this.phase)/t,-n,n),this.jMax=this.maxForce*t},Ie.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv*this.ratio_inv,i.w+=n*i.i_inv},Ie.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w*this.ratio-t.w,n=(this.bias-i)*this.iSum,r=this.jAcc;this.jAcc=f(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv*this.ratio_inv,e.w+=n*e.i_inv},Ie.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Ie.prototype.setRatio=function(t){this.ratio=t,this.ratio_inv=1/t,this.activateBodies()};var De=t.SimpleMotor=function(t,e,i){ve.call(this,t,e),this.rate=i,this.jAcc=0,this.iSum=this.jMax=0};De.prototype=Object.create(ve.prototype),De.prototype.preStep=function(t){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*t},De.prototype.applyCachedImpulse=function(t){var e=this.a,i=this.b,n=this.jAcc*t;e.w-=n*e.i_inv,i.w+=n*i.i_inv},De.prototype.applyImpulse=function(){var t=this.a,e=this.b,i=e.w-t.w+this.rate,n=-i*this.iSum,r=this.jAcc;this.jAcc=f(r+n,-this.jMax,this.jMax),n=this.jAcc-r,t.w-=n*t.i_inv,e.w+=n*e.i_inv},De.prototype.getImpulse=function(){return Math.abs(this.jAcc)}}();var sp=sp||{};sp.VERTEX_INDEX={X1:0,Y1:1,X2:2,Y2:3,X3:4,Y3:5,X4:6,Y4:7},sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.Skeleton=cc.Node.extend({_skeleton:null,_rootBone:null,_timeScale:1,_debugSlots:!1,_debugBones:!1,_premultipliedAlpha:!1,_ownsSkeletonData:null,_atlas:null,_blendFunc:null,ctor:function(t,e,i){cc.Node.prototype.ctor.call(this),0===arguments.length?this.init():this.initWithArgs(t,e,i)},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new sp.Skeleton.CanvasRenderCmd(this):new sp.Skeleton.WebGLRenderCmd(this)},init:function(){cc.Node.prototype.init.call(this),this._premultipliedAlpha=cc._renderType===cc.game.RENDER_TYPE_WEBGL&&cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA,this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST},this.scheduleUpdate()},setDebugSolots:function(t){this._debugSlots=t},setDebugBones:function(t){this._debugBones=t},setDebugSlotsEnabled:function(t){this._debugSlots=t},getDebugSlotsEnabled:function(){return this._debugSlots},setDebugBonesEnabled:function(t){this._debugBones=t},getDebugBonesEnabled:function(){return this._debugBones},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},initWithArgs:function(t,e,i){var n,r,o,s=t,c=e;if(cc.isString(s)){if(cc.isString(c)){var a=cc.loader.getRes(c);sp._atlasLoader.setAtlasFile(c),r=new spine.Atlas(a,sp._atlasLoader)}else r=e;i=i||1/cc.director.getContentScaleFactor();var l=new spine.AtlasAttachmentLoader(r),h=new spine.SkeletonJson(l);h.scale=i;var u=cc.loader.getRes(s);n=h.readSkeletonData(u),r.dispose(h),o=!0}else n=t,o=e;this.setSkeletonData(n,o),this.init()},getBoundingBox:function(){for(var t=cc.FLT_MAX,e=cc.FLT_MAX,i=cc.FLT_MIN,n=cc.FLT_MIN,r=this.getScaleX(),o=this.getScaleY(),s=[],c=this._skeleton.slots,a=sp.VERTEX_INDEX,l=0,h=c.length;l<h;++l){var u=c[l];if(u.attachment&&u.attachment.type==sp.ATTACHMENT_TYPE.REGION){var d=u.attachment;this._computeRegionAttachmentWorldVertices(d,u.bone.skeleton.x,u.bone.skeleton.y,u.bone,s),t=Math.min(t,s[a.X1]*r,s[a.X4]*r,s[a.X2]*r,s[a.X3]*r),e=Math.min(e,s[a.Y1]*o,s[a.Y4]*o,s[a.Y2]*o,s[a.Y3]*o),i=Math.max(i,s[a.X1]*r,s[a.X4]*r,s[a.X2]*r,s[a.X3]*r),n=Math.max(n,s[a.Y1]*o,s[a.Y4]*o,s[a.Y2]*o,s[a.Y3]*o)}}var _=this.getPosition();return cc.rect(_.x+t,_.y+e,i-t,n-e)},_computeRegionAttachmentWorldVertices:function(t,e,i,n,r){var o=t.offset,s=sp.VERTEX_INDEX;e+=n.worldX,i+=n.worldY,r[s.X1]=o[s.X1]*n.m00+o[s.Y1]*n.m01+e,r[s.Y1]=o[s.X1]*n.m10+o[s.Y1]*n.m11+i,r[s.X2]=o[s.X2]*n.m00+o[s.Y2]*n.m01+e,r[s.Y2]=o[s.X2]*n.m10+o[s.Y2]*n.m11+i,r[s.X3]=o[s.X3]*n.m00+o[s.Y3]*n.m01+e,r[s.Y3]=o[s.X3]*n.m10+o[s.Y3]*n.m11+i,r[s.X4]=o[s.X4]*n.m00+o[s.Y4]*n.m01+e,r[s.Y4]=o[s.X4]*n.m10+o[s.Y4]*n.m11+i},updateWorldTransform:function(){this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton.setSlotsToSetupPose()},findBone:function(t){return this._skeleton.findBone(t)},findSlot:function(t){return this._skeleton.findSlot(t)},setSkin:function(t){return this._skeleton.setSkinByName(t)},getAttachment:function(t,e){return this._skeleton.getAttachmentBySlotName(t,e)},setAttachment:function(t,e){this._skeleton.setAttachment(t,e)},setPremultipliedAlpha:function(t){this._premultipliedAlpha=t},isPremultipliedAlpha:function(){return this._premultipliedAlpha},setSkeletonData:function(t,e){null!=t.width&&null!=t.height&&this.setContentSize(t.width/cc.director.getContentScaleFactor(),t.height/cc.director.getContentScaleFactor()),this._skeleton=new spine.Skeleton(t),this._skeleton.updateWorldTransform(),this._rootBone=this._skeleton.getRootBone(),this._ownsSkeletonData=e,this._renderCmd._createChildFormSkeletonData()},getTextureAtlas:function(t){return t.rendererObject.page.rendererObject},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(t,e){var i=this._blendFunc;void 0===e?(i.src=t.src,i.dst=t.dst):(i.src=t,i.dst=e)},update:function(t){this._skeleton.update(t)}}),sp.Skeleton.create=function(t,e,i){return new sp.Skeleton(t,e,i)};var spine={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};spine.BoneData=function(t,e){this.length=this.x=this.y=this.rotation=0,this.scaleX=this.scaleY=1,this.name=t,this.parent=e},spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1},spine.BlendMode={normal:0,additive:1,multiply:2,screen:3},spine.SlotData=function(t,e){this.r=this.g=this.b=this.a=1,this.blendMode=spine.BlendMode.normal,this.name=t,this.boneData=e},spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,blendMode:spine.BlendMode.normal},spine.IkConstraintData=function(t){this.bendDirection=this.mix=1,this.name=t,this.bones=[]},spine.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},spine.Bone=function(t,e,i){this.x=this.y=this.rotation=this.rotationIK=0,this.scaleX=this.scaleY=1,this.flipX=this.flipY=!1,this.m00=this.m01=this.worldX=0,this.m10=this.m11=this.worldY=0,this.worldRotation=0,this.worldScaleX=this.worldScaleY=1,this.worldFlipX=this.worldFlipY=!1,this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()},spine.Bone.yDown=!1,spine.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var t=this.parent;if(t)this.worldX=this.x*t.m00+this.y*t.m01+t.worldX,this.worldY=this.x*t.m10+this.y*t.m11+t.worldY,this.data.inheritScale?(this.worldScaleX=t.worldScaleX*this.scaleX,this.worldScaleY=t.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?t.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=t.worldFlipX!=this.flipX,this.worldFlipY=t.worldFlipY!=this.flipY;else{var e=this.skeleton.flipX,i=this.skeleton.flipY;this.worldX=e?-this.x:this.x,this.worldY=i!=spine.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=e!=this.flipX,this.worldFlipY=i!=this.flipY}var n=this.worldRotation*spine.degRad,r=Math.cos(n),o=Math.sin(n);this.worldFlipX?(this.m00=-r*this.worldScaleX,this.m01=o*this.worldScaleY):(this.m00=r*this.worldScaleX,this.m01=-o*this.worldScaleY),this.worldFlipY!=spine.Bone.yDown?(this.m10=-o*this.worldScaleX,this.m11=-r*this.worldScaleY):(this.m10=o*this.worldScaleX,this.m11=r*this.worldScaleY)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.rotationIK=this.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.flipX=t.flipX,this.flipY=t.flipY},worldToLocal:function(t){var e=t[0]-this.worldX,i=t[1]-this.worldY,n=this.m00,r=this.m10,o=this.m01,s=this.m11;this.worldFlipX!=(this.worldFlipY!=spine.Bone.yDown)&&(n=-n,s=-s);var c=1/(n*s-o*r);t[0]=e*n*c-i*o*c,t[1]=i*s*c-e*r*c},localToWorld:function(t){var e=t[0],i=t[1];t[0]=e*this.m00+i*this.m01+this.worldX,t[1]=e*this.m10+i*this.m11+this.worldY}},spine.Slot=function(t,e){this.r=this.g=this.b=this.a=1,this._attachmentTime=0,this.data=t,this.bone=e,this.setToSetupPose()},spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(t){this.attachment=t,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0},setAttachmentTime:function(t){this._attachmentTime=this.bone.skeleton.time-t},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.bone.skeleton.data.slots,i=0,n=e.length;i<n;i++)if(e[i]==t){this.setAttachment(t.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(i,t.attachmentName):null);break}}},spine.IkConstraint=function(t,e){this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=[];for(var i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)},spine.IkConstraint.prototype={apply:function(){var t=this.target,e=this.bones;switch(e.length){case 1:spine.IkConstraint.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:spine.IkConstraint.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}}},spine.IkConstraint.apply1=function(t,e,i,n){var r=t.data.inheritRotation&&t.parent?t.parent.worldRotation:0,o=t.rotation,s=Math.atan2(i-t.worldY,e-t.worldX)*spine.radDeg;t.worldFlipX!=(t.worldFlipY!=spine.Bone.yDown)&&(s=-s),s-=r,t.rotationIK=o+(s-o)*n},spine.IkConstraint.apply2=function(t,e,i,n,r,o){var s=e.rotation,c=t.rotation;if(!o)return e.rotationIK=s,void(t.rotationIK=c);var a,l,h=spine.temp,u=t.parent;u?(h[0]=i,h[1]=n,u.worldToLocal(h),i=(h[0]-t.x)*u.worldScaleX,n=(h[1]-t.y)*u.worldScaleY):(i-=t.x,n-=t.y),e.parent==t?(a=e.x,l=e.y):(h[0]=e.x,h[1]=e.y,e.parent.localToWorld(h),t.worldToLocal(h),a=h[0],l=h[1]);var d=a*t.worldScaleX,_=l*t.worldScaleY,p=Math.atan2(_,d),f=Math.sqrt(d*d+_*_),m=e.data.length*e.worldScaleX,g=2*f*m;if(g<1e-4)return void(e.rotationIK=s+(Math.atan2(n,i)*spine.radDeg-c-s)*o);var y=(i*i+n*n-f*f-m*m)/g;y<-1?y=-1:y>1&&(y=1);var v=Math.acos(y)*r,T=f+m*y,C=m*Math.sin(v),S=Math.atan2(n*T-i*C,i*T+n*C),x=(S-p)*spine.radDeg-c;x>180?x-=360:x<-180&&(x+=360),t.rotationIK=c+x*o,x=(v+p)*spine.radDeg-s,x>180?x-=360:x<-180&&(x+=360),e.rotationIK=s+(x+t.worldRotation-e.parent.worldRotation)*o},spine.Skin=function(t){this.name=t,this.attachments={}},spine.Skin.prototype={addAttachment:function(t,e,i){this.attachments[t+":"+e]=i},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var i in e.attachments){var n=i.indexOf(":"),r=parseInt(i.substring(0,n)),o=i.substring(n+1),s=t.slots[r];if(s.attachment&&s.attachment.name==o){var c=this.getAttachment(r,o);c&&s.setAttachment(c)}}}},spine.Animation=function(t,e,i){this.name=t,this.timelines=e,this.duration=i},spine.Animation.prototype={apply:function(t,e,i,n,r){n&&0!=this.duration&&(i%=this.duration,e%=this.duration);for(var o=this.timelines,s=0,c=o.length;s<c;s++)o[s].apply(t,e,i,r,1)},mix:function(t,e,i,n,r,o){n&&0!=this.duration&&(i%=this.duration,e%=this.duration);for(var s=this.timelines,c=0,a=s.length;c<a;c++)s[c].apply(t,e,i,r,o)}},spine.Animation.binarySearch=function(t,e,i){var n=0,r=Math.floor(t.length/i)-2;if(!r)return i;for(var o=r>>>1;;){if(t[(o+1)*i]<=e?n=o+1:r=o,n==r)return(n+1)*i;o=n+r>>>1}},spine.Animation.binarySearch1=function(t,e){var i=0,n=t.length-2;if(!n)return 1;for(var r=n>>>1;;){if(t[r+1]<=e?i=r+1:n=r,i==n)return i+1;r=i+n>>>1}},spine.Animation.linearSearch=function(t,e,i){for(var n=0,r=t.length-i;n<=r;n+=i)if(t[n]>e)return n;return-1},spine.Curves=function(t){this.curves=[]},spine.Curves.prototype={setLinear:function(t){this.curves[19*t]=0},setStepped:function(t){this.curves[19*t]=1},setCurve:function(t,e,i,n,r){var o=.1,s=o*o,c=s*o,a=3*o,l=3*s,h=6*s,u=6*c,d=2*-e+n,_=2*-i+r,p=3*(e-n)+1,f=3*(i-r)+1,m=e*a+d*l+p*c,g=i*a+_*l+f*c,y=d*h+p*u,v=_*h+f*u,T=p*u,C=f*u,S=19*t,x=this.curves;x[S++]=2;for(var A=m,E=g,b=S+19-1;S<b;S+=2)x[S]=A,x[S+1]=E,m+=y,g+=v,y+=T,v+=C,A+=m,E+=g},getCurvePercent:function(t,e){e=e<0?0:e>1?1:e;var i=this.curves,n=19*t,r=i[n];if(0===r)return e;if(1==r)return 0;n++;for(var o=0,s=n,c=n+19-1;n<c;n+=2)if(o=i[n],o>=e){var a,l;return n==s?(a=0,l=0):(a=i[n-2],l=i[n-1]),l+(i[n+1]-l)*(e-a)/(o-a)}var h=i[n-1];return h+(1-h)*(e-o)/(1-o)}},spine.RotateTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=2*t},spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s=t.bones[this.boneIndex];if(i>=o[o.length-2]){for(var c=s.data.rotation+o[o.length-1]-s.rotation;c>180;)c-=360;for(;c<-180;)c+=360;return void(s.rotation+=c*r)}var a=spine.Animation.binarySearch(o,i,2),l=o[a-1],h=o[a],u=1-(i-h)/(o[a-2]-h);u=this.curves.getCurvePercent(a/2-1,u);for(var c=o[a+1]-l;c>180;)c-=360;for(;c<-180;)c+=360;for(c=s.data.rotation+(l+c*u)-s.rotation;c>180;)c-=360;for(;c<-180;)c+=360;s.rotation+=c*r}}},spine.TranslateTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=3*t},spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s=t.bones[this.boneIndex];if(i>=o[o.length-3])return s.x+=(s.data.x+o[o.length-2]-s.x)*r,void(s.y+=(s.data.y+o[o.length-1]-s.y)*r);var c=spine.Animation.binarySearch(o,i,3),a=o[c-2],l=o[c-1],h=o[c],u=1-(i-h)/(o[c+-3]-h);u=this.curves.getCurvePercent(c/3-1,u),s.x+=(s.data.x+a+(o[c+1]-a)*u-s.x)*r,s.y+=(s.data.y+l+(o[c+2]-l)*u-s.y)*r}}},spine.ScaleTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=3*t},spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s=t.bones[this.boneIndex];if(i>=o[o.length-3])return s.scaleX+=(s.data.scaleX*o[o.length-2]-s.scaleX)*r,void(s.scaleY+=(s.data.scaleY*o[o.length-1]-s.scaleY)*r);var c=spine.Animation.binarySearch(o,i,3),a=o[c-2],l=o[c-1],h=o[c],u=1-(i-h)/(o[c+-3]-h);u=this.curves.getCurvePercent(c/3-1,u),s.scaleX+=(s.data.scaleX*(a+(o[c+1]-a)*u)-s.scaleX)*r,s.scaleY+=(s.data.scaleY*(l+(o[c+2]-l)*u)-s.scaleY)*r}}},spine.ColorTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=5*t},spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(t,e,i,n,r,o){t*=5,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r,this.frames[t+4]=o},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s,c,a,l;if(i>=o[o.length-5]){var h=o.length-1;s=o[h-3],c=o[h-2],a=o[h-1],l=o[h]}else{var u=spine.Animation.binarySearch(o,i,5),d=o[u-4],_=o[u-3],p=o[u-2],f=o[u-1],m=o[u],g=1-(i-m)/(o[u-5]-m);g=this.curves.getCurvePercent(u/5-1,g),s=d+(o[u+1]-d)*g,c=_+(o[u+2]-_)*g,a=p+(o[u+3]-p)*g,l=f+(o[u+4]-f)*g}var y=t.slots[this.slotIndex];r<1?(y.r+=(s-y.r)*r,y.g+=(c-y.g)*r,y.b+=(a-y.b)*r,y.a+=(l-y.a)*r):(y.r=s,y.g=c,y.b=a,y.a=l)}}},spine.AttachmentTimeline=function(t){this.slotIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},apply:function(t,e,i,n,r){var o=this.frames;if(i<o[0])return void(e>i&&this.apply(t,e,Number.MAX_VALUE,null,0));e>i&&(e=-1);var s=i>=o[o.length-1]?o.length-1:spine.Animation.binarySearch1(o,i)-1;if(!(o[s]<e)){var c=this.attachmentNames[s];t.slots[this.slotIndex].setAttachment(c?t.getAttachmentBySlotIndex(this.slotIndex,c):null)}}},spine.EventTimeline=function(t){this.frames=[],this.frames.length=t,this.events=[],this.events.length=t},spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.events[t]=i},apply:function(t,e,i,n,r){if(n){var o=this.frames,s=o.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,n,r),e=-1;else if(e>=o[s-1])return;if(!(i<o[0])){var c;if(e<o[0])c=0;else{c=spine.Animation.binarySearch1(o,e);for(var a=o[c];c>0&&o[c-1]==a;)c--}for(var l=this.events;c<s&&i>=o[c];c++)n.push(l[c])}}}},spine.DrawOrderTimeline=function(t){this.frames=[],this.frames.length=t,this.drawOrders=[],this.drawOrders.length=t},spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.drawOrders[t]=i},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s;s=i>=o[o.length-1]?o.length-1:spine.Animation.binarySearch1(o,i)-1;var c=t.drawOrder,a=t.slots,l=this.drawOrders[s];if(l)for(var h=0,u=l.length;h<u;h++)c[h]=t.slots[l[h]];else for(var h=0,u=a.length;h<u;h++)c[h]=a[h]}}},spine.FfdTimeline=function(t){this.slotIndex=this.attachment=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=t,this.frameVertices=[],this.frameVertices.length=t},spine.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,i){this.frames[t]=e,this.frameVertices[t]=i},apply:function(t,e,i,n,r){var o=t.slots[this.slotIndex];if(o.attachment==this.attachment){var s=this.frames;if(!(i<s[0])){var c=this.frameVertices,a=c[0].length,l=o.attachmentVertices;if(l.length!=a&&(r=1),l.length=a,i>=s[s.length-1]){var h=c[s.length-1];if(r<1)for(var u=0;u<a;u++)l[u]+=(h[u]-l[u])*r;else for(var u=0;u<a;u++)l[u]=h[u]}else{var d=spine.Animation.binarySearch1(s,i),_=s[d],p=1-(i-_)/(s[d-1]-_);p=this.curves.getCurvePercent(d-1,p<0?0:p>1?1:p);var f=c[d-1],m=c[d];if(r<1)for(var u=0;u<a;u++){var g=f[u];l[u]+=(g+(m[u]-g)*p-l[u])*r}else for(var u=0;u<a;u++){var g=f[u];l[u]=g+(m[u]-g)*p}}}}}},spine.IkConstraintTimeline=function(t){this.ikConstraintIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=3*t},spine.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n},apply:function(t,e,i,n,r){var o=this.frames;if(!(i<o[0])){var s=t.ikConstraints[this.ikConstraintIndex];if(i>=o[o.length-3])return s.mix+=(o[o.length-2]-s.mix)*r,void(s.bendDirection=o[o.length-1]);var c=spine.Animation.binarySearch(o,i,3),a=o[c+-2],l=o[c],h=1-(i-l)/(o[c+-3]-l);h=this.curves.getCurvePercent(c/3-1,h);var u=a+(o[c+1]-a)*h;s.mix+=(u-s.mix)*r,s.bendDirection=o[c+-1]}}},spine.FlipXTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=2*t},spine.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i?1:0},apply:function(t,e,i,n,r){var o=this.frames;if(i<o[0])return void(e>i&&this.apply(t,e,Number.MAX_VALUE,null,0));e>i&&(e=-1);var s=(i>=o[o.length-2]?o.length:spine.Animation.binarySearch(o,i,2))-2;o[s]<e||(t.bones[this.boneIndex].flipX=0!=o[s+1])}},spine.FlipYTimeline=function(t){this.boneIndex=0,this.curves=new spine.Curves(t),this.frames=[],this.frames.length=2*t},spine.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i?1:0},apply:function(t,e,i,n,r){var o=this.frames;if(i<o[0])return void(e>i&&this.apply(t,e,Number.MAX_VALUE,null,0));e>i&&(e=-1);var s=(i>=o[o.length-2]?o.length:spine.Animation.binarySearch(o,i,2))-2;o[s]<e||(t.bones[this.boneIndex].flipY=0!=o[s+1])}},spine.SkeletonData=function(){this.width=this.height=0,this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[]},spine.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(t){for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].name==t)return slot[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},findSkin:function(t){for(var e=this.skins,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},findEvent:function(t){for(var e=this.events,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},findAnimation:function(t){for(var e=this.animations,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},findIkConstraint:function(t){for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null}},spine.Skeleton=function(t){this.x=this.y=0,this.r=this.g=this.b=this.a=1,this.time=0,this.flipX=this.flipY=!1,this.data=t,this.bones=[];for(var e=0,i=t.bones.length;e<i;e++){var n=t.bones[e],r=n.parent?this.bones[t.bones.indexOf(n.parent)]:null;this.bones.push(new spine.Bone(n,this,r))}this.slots=[],this.drawOrder=[];for(var e=0,i=t.slots.length;e<i;e++){var o=t.slots[e],s=this.bones[t.bones.indexOf(o.boneData)],c=new spine.Slot(o,s);this.slots.push(c),this.drawOrder.push(c)}this.ikConstraints=[];for(var e=0,i=t.ikConstraints.length;e<i;e++)this.ikConstraints.push(new spine.IkConstraint(t.ikConstraints[e],this));this.boneCache=[],this.updateCache()},spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var t=this.ikConstraints,e=t.length,i=e+1,n=this.boneCache;n.length>i&&(n.length=i);for(var r=0,o=n.length;r<o;r++)n[r].length=0;for(;n.length<i;)n[n.length]=[];var s=n[0],c=this.bones;t:for(var r=0,o=c.length;r<o;r++){var a=c[r],l=a;do{for(var h=0;h<e;h++)for(var u=t[h],d=u.bones[0],_=u.bones[u.bones.length-1];;){if(l==_){n[h].push(a),n[h+1].push(a);continue t}if(_==d)break;_=_.parent}l=l.parent}while(l);s[s.length]=a}},updateWorldTransform:function(){for(var t=this.bones,e=0,i=t.length;e<i;e++){var n=t[e];n.rotationIK=n.rotation}for(var e=0,r=this.boneCache.length-1;;){for(var o=this.boneCache[e],s=0,c=o.length;s<c;s++)o[s].updateWorldTransform();if(e==r)break;this.ikConstraints[e].apply(),e++}},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].setToSetupPose();for(var n=this.ikConstraints,e=0,i=n.length;e<i;e++){var r=n[e];r.bendDirection=r.data.bendDirection,r.mix=r.data.mix}},setSlotsToSetupPose:function(){for(var t=this.slots,e=this.drawOrder,i=0,n=t.length;i<n;i++)e[i]=t[i],t[i].setToSetupPose(i)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return e[i];return null},findBoneIndex:function(t){for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},findSlot:function(t){for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return e[i];return null},findSlotIndex:function(t){for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)},setSkin:function(t){if(t)if(this.skin)t._attachAll(this,this.skin);else for(var e=this.slots,i=0,n=e.length;i<n;i++){var r=e[i],o=r.data.attachmentName;if(o){var s=t.getAttachment(i,o);s&&r.setAttachment(s)}}this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var i=this.slots,n=0,r=i.length;n<r;n++){var o=i[n];if(o.data.name==t){var s=null;if(e&&(s=this.getAttachmentBySlotIndex(n,e),!s))throw new Error("Attachment not found: "+e+", for slot: "+t);return void o.setAttachment(s)}}throw new Error("Slot not found: "+t)},findIkConstraint:function(t){for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return e[i];return null},update:function(t){this.time+=t}},spine.EventData=function(t){this.intValue=this.floatValue=0,this.name=t},spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null},spine.Event=function(t){this.intValue=this.floatValue=0,this.data=t},spine.Event.prototype={intValue:0,floatValue:0,stringValue:null},spine.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},spine.RegionAttachment=function(t){this.type=spine.AttachmentType.region,this.x=this.y=this.rotation=0,this.scaleX=this.scaleY=1,this.width=this.height=0,this.r=this.g=this.b=this.a=1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.name=t,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},spine.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,i,n,r){var o=this.uvs;r?(o[2]=t,o[3]=n,o[4]=t,o[5]=e,o[6]=i,o[7]=e,o[0]=i,o[1]=n):(o[0]=t,o[1]=n,o[2]=t,o[3]=e,o[4]=i,o[5]=e,o[6]=i,o[7]=n)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.regionOffsetX*t,n=-this.height/2*this.scaleY+this.regionOffsetY*e,r=i+this.regionWidth*t,o=n+this.regionHeight*e,s=this.rotation*spine.degRad,c=Math.cos(s),a=Math.sin(s),l=i*c+this.x,h=i*a,u=n*c+this.y,d=n*a,_=r*c+this.x,p=r*a,f=o*c+this.y,m=o*a,g=this.offset;g[0]=l-d,g[1]=u+h,g[2]=l-m,g[3]=f+h,g[4]=_-m,g[5]=f+p,g[6]=_-d,g[7]=u+p},computeVertices:function(t,e,i,n){t+=i.worldX,e+=i.worldY;var r=i.m00,o=i.m01,s=i.m10,c=i.m11,a=this.offset;n[0]=a[0]*r+a[1]*o+t,n[1]=a[0]*s+a[1]*c+e,n[2]=a[2]*r+a[3]*o+t,n[3]=a[2]*s+a[3]*c+e,n[4]=a[4]*r+a[5]*o+t,n[5]=a[4]*s+a[5]*c+e,n[6]=a[6]*r+a[7]*o+t,n[7]=a[6]*s+a[7]*c+e}},spine.MeshAttachment=function(t){this.type=spine.AttachmentType.mesh,this.hullLength=0,this.r=this.g=this.b=this.a=1,this.regionU=this.regionV=this.regionV2=0,this.regionRotate=!1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.width=this.height=0,this.name=t},spine.MeshAttachment.prototype={vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var t=this.regionU2-this.regionU,e=this.regionV2-this.regionV,i=this.regionUVs.length;if(this.uvs&&this.uvs.length==i||(this.uvs=new spine.Float32Array(i)),this.regionRotate)for(var n=0;n<i;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n+1]*t,this.uvs[n+1]=this.regionV+e-this.regionUVs[n]*e;else for(var n=0;n<i;n+=2)this.uvs[n]=this.regionU+this.regionUVs[n]*t,this.uvs[n+1]=this.regionV+this.regionUVs[n+1]*e},computeWorldVertices:function(t,e,i,n){var r=i.bone;t+=r.worldX,e+=r.worldY;var o=r.m00,s=r.m01,c=r.m10,a=r.m11,l=this.vertices,h=l.length;i.attachmentVertices.length==h&&(l=i.attachmentVertices);for(var u=0;u<h;u+=2){var d=l[u],_=l[u+1];n[u]=d*o+_*s+t,n[u+1]=d*c+_*a+e}}},spine.SkinnedMeshAttachment=function(t){this.type=spine.AttachmentType.skinnedmesh,this.hullLength=0,this.r=this.g=this.b=this.a=1,this.regionU=this.regionV=this.regionU2=this.regionV2=0,this.regionRotate=!1,this.regionOffsetX=this.regionOffsetY=this.regionWidth=this.regionHeight=this.regionOriginalWidth=this.regionOriginalHeight=0,this.width=this.height=0,this.name=t},spine.SkinnedMeshAttachment.prototype={bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(t,e,i,n,r){var o=this.regionU2-this.regionU,s=this.regionV2-this.regionV,c=this.regionUVs.length;if(this.uvs&&this.uvs.length==c||(this.uvs=new spine.Float32Array(c)),this.regionRotate)for(var a=0;a<c;a+=2)this.uvs[a]=this.regionU+this.regionUVs[a+1]*o,this.uvs[a+1]=this.regionV+s-this.regionUVs[a]*s;else for(var a=0;a<c;a+=2)this.uvs[a]=this.regionU+this.regionUVs[a]*o,this.uvs[a+1]=this.regionV+this.regionUVs[a+1]*s},computeWorldVertices:function(t,e,i,n){var r,o,s,c,a,l,h,u=i.bone.skeleton.bones,d=this.weights,_=this.bones,p=0,f=0,m=0,g=0,y=_.length;if(i.attachmentVertices.length)for(var v=i.attachmentVertices;f<y;p+=2){for(o=0,s=0,r=_[f++]+f;f<r;f++,m+=3,g+=2)c=u[_[f]],a=d[m]+v[g],l=d[m+1]+v[g+1],h=d[m+2],o+=(a*c.m00+l*c.m01+c.worldX)*h,s+=(a*c.m10+l*c.m11+c.worldY)*h;n[p]=o+t,n[p+1]=s+e}else for(;f<y;p+=2){for(o=0,s=0,r=_[f++]+f;f<r;f++,m+=3)c=u[_[f]],a=d[m],l=d[m+1],h=d[m+2],o+=(a*c.m00+l*c.m01+c.worldX)*h,s+=(a*c.m10+l*c.m11+c.worldY)*h;n[p]=o+t,n[p+1]=s+e}}},spine.BoundingBoxAttachment=function(t){this.type=spine.AttachmentType.boundingbox,this.name=t,this.vertices=[]},spine.BoundingBoxAttachment.prototype={computeWorldVertices:function(t,e,i,n){t+=i.worldX,e+=i.worldY;for(var r=i.m00,o=i.m01,s=i.m10,c=i.m11,a=this.vertices,l=0,h=a.length;l<h;l+=2){var u=a[l],d=a[l+1];n[l]=u*r+d*o+t,n[l+1]=u*s+d*c+e}}},spine.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={},this.defaultMix=0},spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,i){var n=this.skeletonData.findAnimation(t);if(!n)throw new Error("Animation not found: "+t);var r=this.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);this.setMix(n,r,i)},setMix:function(t,e,i){this.animationToMixTime[t.name+":"+e.name]=i},getMix:function(t,e){var i=t.name+":"+e.name;return this.animationToMixTime.hasOwnProperty(i)?this.animationToMixTime[i]:this.defaultMix}},spine.TrackEntry=function(){this.delay=this.time=this.endTime=0,this.lastTime=-1,this.timeScale=1,this.mixTime=this.mixDuration=1,this.mix=1},spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},spine.AnimationState=function(t){this.timeScale=1,this.data=t,this.tracks=[],this.events=[]},spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(t){t*=this.timeScale;for(var e=0;e<this.tracks.length;e++){var i=this.tracks[e];if(i){if(i.time+=t*i.timeScale,i.previous){var n=t*i.previous.timeScale;i.previous.time+=n,i.mixTime+=n}var r=i.next;r?(r.time=i.lastTime-r.delay,r.time>=0&&this.setCurrent(e,r)):!i.loop&&i.lastTime>=i.endTime&&this.clearTrack(e)}}},apply:function(t){for(var e=0;e<this.tracks.length;e++){var i=this.tracks[e];if(i){this.events.length=0;var n=i.time,r=i.lastTime,o=i.endTime,s=i.loop;!s&&n>o&&(n=o);var c=i.previous;if(c){var a=c.time;!c.loop&&a>c.endTime&&(a=c.endTime),c.animation.apply(t,a,a,c.loop,null);var l=i.mixTime/i.mixDuration*i.mix;l>=1&&(l=1,i.previous=null),i.animation.mix(t,i.lastTime,n,s,this.events,l)}else 1==i.mix?i.animation.apply(t,i.lastTime,n,s,this.events):i.animation.mix(t,i.lastTime,n,s,this.events,i.mix);for(var h=0,u=this.events.length;h<u;h++){var d=this.events[h];i.onEvent&&i.onEvent(e,d),this.onEvent&&this.onEvent(e,d)}if(s?r%o>n%o:r<o&&n>=o){var _=Math.floor(n/o);i.onComplete&&i.onComplete(e,_),this.onComplete&&this.onComplete(e,_)}i.lastTime=i.time}}},clearTracks:function(){for(var t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0},clearTrack:function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];e&&(e.onEnd&&e.onEnd(t),this.onEnd&&this.onEnd(t),this.tracks[t]=null)}},_expandToIndex:function(t){if(t<this.tracks.length)return this.tracks[t];for(;t>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(t,e){var i=this._expandToIndex(t);if(i){var n=i.previous;i.previous=null,i.onEnd&&i.onEnd(t),this.onEnd&&this.onEnd(t),e.mixDuration=this.data.getMix(i.animation,e.animation),e.mixDuration>0&&(e.mixTime=0,n&&i.mixTime/i.mixDuration<.5?e.previous=n:e.previous=i)}this.tracks[t]=e,e.onStart&&e.onStart(t),this.onStart&&this.onStart(t)},setAnimationByName:function(t,e,i){var n=this.data.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);return this.setAnimation(t,n,i)},setAnimation:function(t,e,i){var n=new spine.TrackEntry;return n.animation=e,n.loop=i,n.endTime=e.duration,this.setCurrent(t,n),n},addAnimationByName:function(t,e,i,n){var r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);return this.addAnimation(t,r,i,n)},addAnimation:function(t,e,i,n){var r=new spine.TrackEntry;r.animation=e,r.loop=i,r.endTime=e.duration;var o=this._expandToIndex(t);if(o){for(;o.next;)o=o.next;o.next=r}else this.tracks[t]=r;return n<=0&&(o?n+=o.endTime-this.data.getMix(o.animation,e):n=0),r.delay=n,r},getCurrent:function(t){return t>=this.tracks.length?null:this.tracks[t]}},spine.SkeletonJson=function(t){this.scale=1,this.attachmentLoader=t},spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(t,e){var i=new spine.SkeletonData;i.name=e;var n=t.skeleton;n&&(i.hash=n.hash,i.version=n.spine,i.width=n.width||0,i.height=n.height||0);for(var r=t.bones,o=0,s=r.length;o<s;o++){var c=r[o],a=null;if(c.parent&&(a=i.findBone(c.parent),!a))throw new Error("Parent bone not found: "+c.parent);var l=new spine.BoneData(c.name,a);l.length=(c.length||0)*this.scale,l.x=(c.x||0)*this.scale,l.y=(c.y||0)*this.scale,l.rotation=c.rotation||0,l.scaleX=c.hasOwnProperty("scaleX")?c.scaleX:1,l.scaleY=c.hasOwnProperty("scaleY")?c.scaleY:1,l.inheritScale=!c.hasOwnProperty("inheritScale")||c.inheritScale,l.inheritRotation=!c.hasOwnProperty("inheritRotation")||c.inheritRotation,i.bones.push(l)}var h=t.ik;if(h)for(var o=0,s=h.length;o<s;o++){for(var u=h[o],d=new spine.IkConstraintData(u.name),r=u.bones,_=0,p=r.length;_<p;_++){var f=i.findBone(r[_]);if(!f)throw new Error("IK bone not found: "+r[_]);d.bones.push(f)}if(d.target=i.findBone(u.target),!d.target)throw new Error("Target bone not found: "+u.target);d.bendDirection=!u.hasOwnProperty("bendPositive")||u.bendPositive?1:-1,d.mix=u.hasOwnProperty("mix")?u.mix:1,i.ikConstraints.push(d)}for(var m=t.slots,o=0,s=m.length;o<s;o++){var g=m[o],l=i.findBone(g.bone);if(!l)throw new Error("Slot bone not found: "+g.bone);var y=new spine.SlotData(g.name,l),v=g.color;v&&(y.r=this.toColor(v,0),y.g=this.toColor(v,1),y.b=this.toColor(v,2),y.a=this.toColor(v,3)),y.attachmentName=g.attachment,y.blendMode=spine.AttachmentType[g.blend||"normal"],i.slots.push(y)}var T=t.skins;for(var C in T)if(T.hasOwnProperty(C)){var S=T[C],x=new spine.Skin(C);for(var A in S)if(S.hasOwnProperty(A)){var E=i.findSlotIndex(A),b=S[A];for(var R in b)if(b.hasOwnProperty(R)){var P=this.readAttachment(x,R,b[R]);P&&x.addAttachment(E,R,P)}}i.skins.push(x),"default"==x.name&&(i.defaultSkin=x)}var w=t.events;for(var I in w)if(w.hasOwnProperty(I)){var D=w[I],L=new spine.EventData(I);L.intValue=D.int||0,L.floatValue=D.float||0,L.stringValue=D.string||null,i.events.push(L)}var O=t.animations;for(var B in O)O.hasOwnProperty(B)&&this.readAnimation(B,O[B],i);return i},readAttachment:function(t,e,i){e=i.name||e;var n=spine.AttachmentType[i.type||"region"],r=i.path||e,o=this.scale;if(n==spine.AttachmentType.region){var s=this.attachmentLoader.newRegionAttachment(t,e,r);if(!s)return null;s.path=r,s.x=(i.x||0)*o,s.y=(i.y||0)*o,s.scaleX=i.hasOwnProperty("scaleX")?i.scaleX:1,s.scaleY=i.hasOwnProperty("scaleY")?i.scaleY:1,s.rotation=i.rotation||0,s.width=(i.width||0)*o,s.height=(i.height||0)*o;var c=i.color;return c&&(s.r=this.toColor(c,0),s.g=this.toColor(c,1),s.b=this.toColor(c,2),s.a=this.toColor(c,3)),s.updateOffset(),s}if(n==spine.AttachmentType.mesh){var a=this.attachmentLoader.newMeshAttachment(t,e,r);return a?(a.path=r,a.vertices=this.getFloatArray(i,"vertices",o),a.triangles=this.getIntArray(i,"triangles"),a.regionUVs=this.getFloatArray(i,"uvs",1),a.updateUVs(),c=i.color,c&&(a.r=this.toColor(c,0),a.g=this.toColor(c,1),a.b=this.toColor(c,2),a.a=this.toColor(c,3)),a.hullLength=2*(i.hull||0),i.edges&&(a.edges=this.getIntArray(i,"edges")),a.width=(i.width||0)*o,a.height=(i.height||0)*o,a):null}if(n==spine.AttachmentType.skinnedmesh){var a=this.attachmentLoader.newSkinnedMeshAttachment(t,e,r);if(!a)return null;a.path=r;for(var l=this.getFloatArray(i,"uvs",1),h=this.getFloatArray(i,"vertices",1),u=[],d=[],_=0,p=h.length;_<p;){var f=0|h[_++];d[d.length]=f;for(var m=_+4*f;_<m;)d[d.length]=h[_],u[u.length]=h[_+1]*o,u[u.length]=h[_+2]*o,u[u.length]=h[_+3],_+=4}return a.bones=d,a.weights=u,a.triangles=this.getIntArray(i,"triangles"),a.regionUVs=l,a.updateUVs(),c=i.color,c&&(a.r=this.toColor(c,0),a.g=this.toColor(c,1),a.b=this.toColor(c,2),a.a=this.toColor(c,3)),a.hullLength=2*(i.hull||0),i.edges&&(a.edges=this.getIntArray(i,"edges")),a.width=(i.width||0)*o,a.height=(i.height||0)*o,a}if(n==spine.AttachmentType.boundingbox){for(var g=this.attachmentLoader.newBoundingBoxAttachment(t,e),h=i.vertices,_=0,p=h.length;_<p;_++)g.vertices.push(h[_]*o);return g}throw new Error("Unknown attachment type: "+n)},readAnimation:function(t,e,i){var n=[],r=0,o=e.slots;for(var s in o)if(o.hasOwnProperty(s)){var c=o[s],a=i.findSlotIndex(s);for(var l in c)if(c.hasOwnProperty(l)){var h=c[l];if("color"==l){var u=new spine.ColorTimeline(h.length);u.slotIndex=a;for(var d=0,_=0,p=h.length;_<p;_++){var f=h[_],m=f.color,g=this.toColor(m,0),y=this.toColor(m,1),v=this.toColor(m,2),T=this.toColor(m,3);u.setFrame(d,f.time,g,y,v,T),this.readCurve(u,d,f),d++}n.push(u),r=Math.max(r,u.frames[5*u.getFrameCount()-5])}else{if("attachment"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+s+")");var u=new spine.AttachmentTimeline(h.length);u.slotIndex=a;for(var d=0,_=0,p=h.length;_<p;_++){var f=h[_];u.setFrame(d++,f.time,f.name)}n.push(u),r=Math.max(r,u.frames[u.getFrameCount()-1])}}}var C=e.bones;for(var S in C)if(C.hasOwnProperty(S)){var x=i.findBoneIndex(S);if(x==-1)throw new Error("Bone not found: "+S);var A=C[S];for(var l in A)if(A.hasOwnProperty(l)){var h=A[l];if("rotate"==l){var u=new spine.RotateTimeline(h.length);u.boneIndex=x;for(var d=0,_=0,p=h.length;_<p;_++){var f=h[_];u.setFrame(d,f.time,f.angle),this.readCurve(u,d,f),d++}n.push(u),r=Math.max(r,u.frames[2*u.getFrameCount()-2])}else if("translate"==l||"scale"==l){var u,E=1;"scale"==l?u=new spine.ScaleTimeline(h.length):(u=new spine.TranslateTimeline(h.length),E=this.scale),u.boneIndex=x;for(var d=0,_=0,p=h.length;_<p;_++){var f=h[_],b=(f.x||0)*E,R=(f.y||0)*E;u.setFrame(d,f.time,b,R),this.readCurve(u,d,f),d++}n.push(u),r=Math.max(r,u.frames[3*u.getFrameCount()-3])}else{if("flipX"!=l&&"flipY"!=l)throw new Error("Invalid timeline type for a bone: "+l+" ("+S+")");var b="flipX"==l,u=b?new spine.FlipXTimeline(h.length):new spine.FlipYTimeline(h.length);u.boneIndex=x;for(var P=b?"x":"y",d=0,_=0,p=h.length;_<p;_++){var f=h[_];u.setFrame(d,f.time,f[P]||!1),d++}n.push(u),r=Math.max(r,u.frames[2*u.getFrameCount()-2])}}}var w=e.ik;for(var I in w)if(w.hasOwnProperty(I)){var D=i.findIkConstraint(I),h=w[I],u=new spine.IkConstraintTimeline(h.length);u.ikConstraintIndex=i.ikConstraints.indexOf(D);for(var d=0,_=0,p=h.length;_<p;_++){var f=h[_],L=f.hasOwnProperty("mix")?f.mix:1,O=!f.hasOwnProperty("bendPositive")||f.bendPositive?1:-1;u.setFrame(d,f.time,L,O),this.readCurve(u,d,f),d++}n.push(u),r=Math.max(r,u.frames[3*u.frameCount-3])}var B=e.ffd;for(var N in B){var F=i.findSkin(N),c=B[N];for(s in c){var a=i.findSlotIndex(s),M=c[s];for(var V in M){var h=M[V],u=new spine.FfdTimeline(h.length),k=F.getAttachment(a,V);if(!k)throw new Error("FFD attachment not found: "+V);u.slotIndex=a,u.attachment=k;var G,W=k.type==spine.AttachmentType.mesh;G=W?k.vertices.length:k.weights.length/3*2;for(var d=0,_=0,p=h.length;_<p;_++){var z,f=h[_];if(f.vertices){var U=f.vertices,z=[];z.length=G;var Y=f.offset||0,X=U.length;if(1==this.scale)for(var H=0;H<X;H++)z[H+Y]=U[H];else for(var H=0;H<X;H++)z[H+Y]=U[H]*this.scale;if(W)for(var j=k.vertices,H=0,X=z.length;H<X;H++)z[H]+=j[H]}else W?z=k.vertices:(z=[],z.length=G);u.setFrame(d,f.time,z),this.readCurve(u,d,f),d++}n[n.length]=u,r=Math.max(r,u.frames[u.frameCount-1])}}}var q=e.drawOrder;if(q||(q=e.draworder),q){for(var u=new spine.DrawOrderTimeline(q.length),Z=i.slots.length,d=0,_=0,p=q.length;_<p;_++){var J=q[_],K=null;if(J.offsets){K=[],K.length=Z;for(var H=Z-1;H>=0;H--)K[H]=-1;var Q=J.offsets,$=[];$.length=Z-Q.length;for(var tt=0,et=0,H=0,X=Q.length;H<X;H++){var it=Q[H],a=i.findSlotIndex(it.slot);if(a==-1)throw new Error("Slot not found: "+it.slot);for(;tt!=a;)$[et++]=tt++;K[tt+it.offset]=tt++}for(;tt<Z;)$[et++]=tt++;for(var H=Z-1;H>=0;H--)K[H]==-1&&(K[H]=$[--et])}u.setFrame(d++,J.time,K)}n.push(u),r=Math.max(r,u.frames[u.getFrameCount()-1])}var nt=e.events;if(nt){for(var u=new spine.EventTimeline(nt.length),d=0,_=0,p=nt.length;_<p;_++){var rt=nt[_],ot=i.findEvent(rt.name);if(!ot)throw new Error("Event not found: "+rt.name);var st=new spine.Event(ot);st.intValue=rt.hasOwnProperty("int")?rt.int:ot.intValue,st.floatValue=rt.hasOwnProperty("float")?rt.float:ot.floatValue,st.stringValue=rt.hasOwnProperty("string")?rt.string:ot.stringValue,u.setFrame(d++,rt.time,st)}n.push(u),r=Math.max(r,u.frames[u.getFrameCount()-1])}i.animations.push(new spine.Animation(t,n,r))},readCurve:function(t,e,i){var n=i.curve;n?"stepped"==n?t.curves.setStepped(e):n instanceof Array&&t.curves.setCurve(e,n[0],n[1],n[2],n[3]):t.curves.setLinear(e)},toColor:function(t,e){if(8!=t.length)throw new Error("Color hexadecimal length must be 8, received: "+t);return parseInt(t.substring(2*e,2*e+2),16)/255},getFloatArray:function(t,e,i){var n=t[e],r=new spine.Float32Array(n.length),o=0,s=n.length;if(1==i)for(;o<s;o++)r[o]=n[o];else for(;o<s;o++)r[o]=n[o]*i;return r},getIntArray:function(t,e){for(var i=t[e],n=new spine.Uint16Array(i.length),r=0,o=i.length;r<o;r++)n[r]=0|i[r];return n}},spine.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var i=new spine.AtlasReader(t),n=[];n.length=4;for(var r=null;;){var o=i.readLine();if(null===o)break;if(o=i.trim(o),o.length)if(r){var s=new spine.AtlasRegion;s.name=o,s.page=r,s.rotate="true"==i.readValue(),i.readTuple(n);var c=parseInt(n[0]),a=parseInt(n[1]);i.readTuple(n);var l=parseInt(n[0]),h=parseInt(n[1]);s.u=c/r.width,s.v=a/r.height,s.rotate?(s.u2=(c+h)/r.width,s.v2=(a+l)/r.height):(s.u2=(c+l)/r.width,s.v2=(a+h)/r.height),s.x=c,s.y=a,s.width=Math.abs(l),s.height=Math.abs(h),4==i.readTuple(n)&&(s.splits=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],4==i.readTuple(n)&&(s.pads=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i.readTuple(n))),s.originalWidth=parseInt(n[0]),s.originalHeight=parseInt(n[1]),i.readTuple(n),s.offsetX=parseInt(n[0]),s.offsetY=parseInt(n[1]),s.index=parseInt(i.readValue()),this.regions.push(s)}else{r=new spine.AtlasPage,r.name=o,2==i.readTuple(n)&&(r.width=parseInt(n[0]),r.height=parseInt(n[1]),i.readTuple(n)),r.format=spine.Atlas.Format[n[0]],i.readTuple(n),r.minFilter=spine.Atlas.TextureFilter[n[0]],r.magFilter=spine.Atlas.TextureFilter[n[1]];var u=i.readValue();r.uWrap=spine.Atlas.TextureWrap.clampToEdge,r.vWrap=spine.Atlas.TextureWrap.clampToEdge,"x"==u?r.uWrap=spine.Atlas.TextureWrap.repeat:"y"==u?r.vWrap=spine.Atlas.TextureWrap.repeat:"xy"==u&&(r.uWrap=r.vWrap=spine.Atlas.TextureWrap.repeat),e.load(r,o,this),this.pages.push(r)}else r=null}},spine.Atlas.prototype={findRegion:function(t){for(var e=this.regions,i=0,n=e.length;i<n;i++)if(e[i].name==t)return e[i];return null},dispose:function(){for(var t=this.pages,e=0,i=t.length;e<i;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,i=0,n=e.length;i<n;i++){var r=e[i];r.page==t&&(r.u=r.x/t.width,r.v=r.y/t.height,r.rotate?(r.u2=(r.x+r.height)/t.width,r.v2=(r.y+r.width)/t.height):(r.u2=(r.x+r.width)/t.width,r.v2=(r.y+r.height)/t.height))}}},spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},spine.AtlasPage=function(){this.width=this.height=0},spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},spine.AtlasRegion=function(){this.x=this.y=this.width=this.height=this.u=this.v=this.u2=this.v2=this.offsetX=this.offsetY=this.originalWidth=this.originalHeight=0,this.index=0},spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},spine.AtlasReader=function(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)},spine.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(e==-1)throw new Error("Invalid line: "+t);return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),i=e.indexOf(":");if(i==-1)throw new Error("Invalid line: "+e);for(var n=0,r=i+1;n<3;n++){var o=e.indexOf(",",r);if(o==-1)break;t[n]=this.trim(e.substr(r,o-r)),r=o+1}return t[n]=this.trim(e.substring(r)),n+1}},spine.AtlasAttachmentLoader=function(t){this.atlas=t},spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(t,e,i){var n=this.atlas.findRegion(i);if(!n)throw new Error("Region not found in atlas: "+i+" (region attachment: "+e+")");var r=new spine.RegionAttachment(e);return r.rendererObject=n,r.setUVs(n.u,n.v,n.u2,n.v2,n.rotate),r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newMeshAttachment:function(t,e,i){var n=this.atlas.findRegion(i);if(!n)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");var r=new spine.MeshAttachment(e);return r.rendererObject=n,r.regionU=n.u,r.regionV=n.v,r.regionU2=n.u2,r.regionV2=n.v2,r.regionRotate=n.rotate,r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newSkinnedMeshAttachment:function(t,e,i){var n=this.atlas.findRegion(i);if(!n)throw new Error("Region not found in atlas: "+i+" (skinned mesh attachment: "+e+")");var r=new spine.SkinnedMeshAttachment(e);return r.rendererObject=n,r.regionU=n.u,r.regionV=n.v,r.regionU2=n.u2,r.regionV2=n.v2,r.regionRotate=n.rotate,r.regionOffsetX=n.offsetX,r.regionOffsetY=n.offsetY,r.regionWidth=n.width,r.regionHeight=n.height,r.regionOriginalWidth=n.originalWidth,r.regionOriginalHeight=n.originalHeight,r},newBoundingBoxAttachment:function(t,e){return new spine.BoundingBoxAttachment(e)}},spine.SkeletonBounds=function(){this.minX=this.minY=this.maxX=this.maxY=0,this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(t,e){var i=t.slots,n=i.length,r=t.x,o=t.y,s=this.boundingBoxes,c=this.polygonPool,a=this.polygons;s.length=0;for(var l=0,h=a.length;l<h;l++)c.push(a[l]);a.length=0;for(var l=0;l<n;l++){var u=i[l],d=u.attachment;if(d.type==spine.AttachmentType.boundingbox){s.push(d);var _,p=c.length;p>0?(_=c[p-1],c.splice(p-1,1)):_=[],a.push(_),_.length=d.vertices.length,d.computeWorldVertices(r,o,u.bone,_)}}e&&this.aabbCompute()},aabbCompute:function(){for(var t=this.polygons,e=Number.MAX_VALUE,i=Number.MAX_VALUE,n=Number.MIN_VALUE,r=Number.MIN_VALUE,o=0,s=t.length;o<s;o++)for(var c=t[o],a=0,l=c.length;a<l;a+=2){var h=c[a],u=c[a+1];e=Math.min(e,h),i=Math.min(i,u),n=Math.max(n,h),r=Math.max(r,u)}this.minX=e,this.minY=i,this.maxX=n,this.maxY=r},aabbContainsPoint:function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},aabbIntersectsSegment:function(t,e,i,n){var r=this.minX,o=this.minY,s=this.maxX,c=this.maxY;if(t<=r&&i<=r||e<=o&&n<=o||t>=s&&i>=s||e>=c&&n>=c)return!1;var a=(n-e)/(i-t),l=a*(r-t)+e;if(l>o&&l<c)return!0;if(l=a*(s-t)+e,l>o&&l<c)return!0;var h=(o-e)/a+t;return h>r&&h<s||(h=(c-e)/a+t,h>r&&h<s)},aabbIntersectsSkeleton:function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},containsPoint:function(t,e){for(var i=this.polygons,n=0,r=i.length;n<r;n++)if(this.polygonContainsPoint(i[n],t,e))return this.boundingBoxes[n];return null},intersectsSegment:function(t,e,i,n){for(var r=this.polygons,o=0,s=r.length;o<s;o++)if(r[o].intersectsSegment(t,e,i,n))return this.boundingBoxes[o];return null},polygonContainsPoint:function(t,e,i){for(var n=t.length,r=n-2,o=!1,s=0;s<n;s+=2){var c=t[s+1],a=t[r+1];if(c<i&&a>=i||a<i&&c>=i){var l=t[s];l+(i-c)/(a-c)*(t[r]-l)<e&&(o=!o)}r=s}return o},polygonIntersectsSegment:function(t,e,i,n,r){for(var o=t.length,s=e-n,c=i-r,a=e*r-i*n,l=t[o-2],h=t[o-1],u=0;u<o;u+=2){var d=t[u],_=t[u+1],p=l*_-h*d,f=l-d,m=h-_,g=s*m-c*f,y=(a*f-s*p)/g;if((y>=l&&y<=d||y>=d&&y<=l)&&(y>=e&&y<=n||y>=n&&y<=e)){var v=(a*m-c*p)/g;if((v>=h&&v<=_||v>=_&&v<=h)&&(v>=i&&v<=r||v>=r&&v<=i))return!0}l=d,h=_}return!1},getPolygon:function(t){var e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}},sp._atlasPage_createTexture_webGL=function(t,e){var i=cc.textureCache.addImage(e);t.rendererObject=new cc.TextureAtlas(i,128),t.width=i.getPixelsWide(),t.height=i.getPixelsHigh()},sp._atlasPage_createTexture_canvas=function(t,e){t._texture=cc.textureCache.addImage(e)},sp._atlasPage_disposeTexture=function(t){t.rendererObject.release()},sp._atlasLoader={spAtlasFile:null,setAtlasFile:function(t){this.spAtlasFile=t},load:function(t,e,i){var n=cc.path.join(cc.path.dirname(this.spAtlasFile),e);cc._renderType===cc.game.RENDER_TYPE_WEBGL?sp._atlasPage_createTexture_webGL(t,n):sp._atlasPage_createTexture_canvas(t,n)},unload:function(t){}},sp.ANIMATION_EVENT_TYPE={START:0,END:1,COMPLETE:2,EVENT:3},sp.TrackEntryListeners=function(t,e,i,n){this.startListener=t||null,this.endListener=e||null,this.completeListener=i||null,this.eventListener=n||null},sp.TrackEntryListeners.getListeners=function(t){return t.rendererObject||(t.rendererObject=new sp.TrackEntryListeners,t.listener=sp.trackEntryCallback),t.rendererObject},sp.trackEntryCallback=function(t,e,i,n,r){t.rendererObject.onTrackEntryEvent(e,i,n,r)},sp.SkeletonAnimation=sp.Skeleton.extend({_state:null,_target:null,_callback:null,_ownsAnimationStateData:!1,_startListener:null,_endListener:null,_completeListener:null,_eventListener:null,init:function(){sp.Skeleton.prototype.init.call(this),this._ownsAnimationStateData=!0,this.setAnimationStateData(new spine.AnimationStateData(this._skeleton.data))},setAnimationStateData:function(t){var e=new spine.AnimationState(t);e.rendererObject=this,e.onStart=this._onAnimationStateStart.bind(this),e.onComplete=this._onAnimationStateComplete.bind(this),e.onEnd=this._onAnimationStateEnd.bind(this),e.onEvent=this._onAnimationStateEvent.bind(this),this._state=e},setMix:function(t,e,i){this._state.data.setMixByName(t,e,i)},setAnimationListener:function(t,e){this._target=t,this._callback=e},setAnimation:function(t,e,i){var n=this._skeleton.data.findAnimation(e);return n?this._state.setAnimation(t,n,i):(cc.log("Spine: Animation not found: "+e),null)},addAnimation:function(t,e,i,n){n=null==n?0:n;var r=this._skeleton.data.findAnimation(e);return r?this._state.addAnimation(t,r,i,n):(cc.log("Spine: Animation not found:"+e),null)},getCurrent:function(t){return this._state.getCurrent(t)},clearTracks:function(){this._state.clearTracks()},clearTrack:function(t){this._state.clearTrack(t)},update:function(t){this._super(t),t*=this._timeScale,this._state.update(t),this._state.apply(this._skeleton),this._skeleton.updateWorldTransform(),this._renderCmd._updateChild()},setStartListener:function(t){this._startListener=t},setEndListener:function(t){this._endListener=t},setCompleteListener:function(t){this._completeListener=t},setEventListener:function(t){this._eventListener=t},setTrackStartListener:function(t,e){sp.TrackEntryListeners.getListeners(t).startListener=e},setTrackEndListener:function(t,e){sp.TrackEntryListeners.getListeners(t).endListener=e},setTrackCompleteListener:function(t,e){sp.TrackEntryListeners.getListeners(t).completeListener=e},setTrackEventListener:function(t,e){sp.TrackEntryListeners.getListeners(t).eventListener=e},onTrackEntryEvent:function(t,e,i,n){var r=this._state.getCurrent(t);if(r.rendererObject){var o=r.rendererObject;switch(e){case sp.ANIMATION_EVENT_TYPE.START:o.startListener&&o.startListener(t);break;case sp.ANIMATION_EVENT_TYPE.END:o.endListener&&o.endListener(t);break;case sp.ANIMATION_EVENT_TYPE.COMPLETE:o.completeListener&&o.completeListener(t,n);break;case sp.ANIMATION_EVENT_TYPE.EVENT:o.eventListener&&o.eventListener(t,i)}}},onAnimationStateEvent:function(t,e,i,n){switch(e){case sp.ANIMATION_EVENT_TYPE.START:this._startListener&&this._startListener(t);break;case sp.ANIMATION_EVENT_TYPE.END:this._endListener&&this._endListener(t);break;case sp.ANIMATION_EVENT_TYPE.COMPLETE:this._completeListener&&this._completeListener(t,n);break;case sp.ANIMATION_EVENT_TYPE.EVENT:this._eventListener&&this._eventListener(t,i)}},getState:function(){return this._state},_onAnimationStateStart:function(t){this._animationStateCallback(t,sp.ANIMATION_EVENT_TYPE.START,null,0)},_onAnimationStateEnd:function(t){this._animationStateCallback(t,sp.ANIMATION_EVENT_TYPE.END,null,0)},_onAnimationStateComplete:function(t,e){this._animationStateCallback(t,sp.ANIMATION_EVENT_TYPE.COMPLETE,null,e)},_onAnimationStateEvent:function(t,e){this._animationStateCallback(t,sp.ANIMATION_EVENT_TYPE.EVENT,e,0)},_animationStateCallback:function(t,e,i,n){this.onAnimationStateEvent(t,e,i,n),this._target&&this._callback&&this._callback.call(this._target,this,t,e,i,n)}}),sp.SkeletonAnimation.create=function(t,e,i){return new sp.SkeletonAnimation(t,e,i)},function(){sp.Skeleton.CanvasRenderCmd=function(t){cc.Node.CanvasRenderCmd.call(this,t),this._needDraw=!0};var t=sp.Skeleton.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);t.constructor=sp.Skeleton.CanvasRenderCmd,t.rendering=function(t,e,i){var n,r,o,s,c=this._node;t=t||cc._renderContext;var a=c._skeleton,l=a.drawOrder;for(n=0,r=l.length;n<r;n++)o=l[n],s=o._slotNode,s._visible&&s._renderCmd&&o.currentSprite&&(s._renderCmd.transform(this,!0),o.currentSprite._renderCmd.rendering(t,e,i),s._renderCmd._dirtyFlag=o.currentSprite._renderCmd._dirtyFlag=0);if(c._debugSlots||c._debugBones){t.setTransform(this._worldTransform,e,i),t.setGlobalAlpha(1);var h,u=cc._drawingUtil;if(c._debugSlots){u.setDrawColor(0,0,255,255),u.setLineWidth(1);var d=[];for(n=0,r=a.slots.length;n<r;n++)o=a.drawOrder[n],o.attachment&&o.attachment.type==sp.ATTACHMENT_TYPE.REGION&&(h=o.attachment,this._updateRegionAttachmentSlot(h,o,d),u.drawPoly(d,4,!0))}if(c._debugBones){var _;for(u.setLineWidth(2),u.setDrawColor(255,0,0,255),n=0,r=a.bones.length;n<r;n++){_=a.bones[n];var p=_.data.length*_.m00+_.worldX,f=_.data.length*_.m10+_.worldY;u.drawLine({x:_.worldX,y:_.worldY},{x:p,y:f})}for(u.setPointSize(4),u.setDrawColor(0,0,255,255),n=0,r=a.bones.length;n<r;n++)_=a.bones[n],u.drawPoint({x:_.worldX,y:_.worldY}),0===n&&u.setDrawColor(0,255,0,255)}}},t._updateRegionAttachmentSlot=function(t,e,i){if(i){var n={},r=sp.VERTEX_INDEX,o=e.bone;t.computeVertices(o.skeleton.x,o.skeleton.y,o,n),i.length=0,i.push(cc.p(n[r.X1],n[r.Y1])),i.push(cc.p(n[r.X4],n[r.Y4])),i.push(cc.p(n[r.X3],n[r.Y3])),i.push(cc.p(n[r.X2],n[r.Y2]))}},t._createChildFormSkeletonData=function(){for(var t,e,i=this._node,n=i._skeleton,r=0,o=n.slots.length;r<o;r++){var s=n.slots[r],c=s.attachment,a=new cc.Node;s._slotNode=a,c instanceof spine.RegionAttachment?(t=c.rendererObject.name,e=this._createSprite(s,c),s.currentSprite=e,s.currentSpriteName=t,a.addChild(e)):c instanceof spine.MeshAttachment}};var e=function(t,e,i,n){var r=new cc.Rect(i.x,i.y,i.width,i.height);t.initWithTexture(e,r,i.rotate,!1),t._rect.width=n.width,t._rect.height=n.height,t.setContentSize(n.width,n.height),t.setRotation(-n.rotation),t.setScale(i.width/i.originalWidth*n.scaleX,i.height/i.originalHeight*n.scaleY)};t._createSprite=function(t,i){var n=i.rendererObject,r=n.page._texture,o=new cc.Sprite;return r.isLoaded()?e(o,r,n,i):r.addEventListener("load",function(){e(o,r,n,i)},this),t.sprites=t.sprites||{},t.sprites[n.name]=o,o},t._updateChild=function(){var t,e,i,n,r,o,s=this._node._skeleton,c=s.slots;for(t=0,e=c.length;t<e;t++)if(n=c[t],r=n.attachment,o=n._slotNode,r){var a=r.type;if(a===spine.AttachmentType.region){if(r.rendererObject&&(!n.currentSpriteName||n.currentSpriteName!==r.name)){var l=r.rendererObject.name;if(void 0!==n.currentSprite&&n.currentSprite.setVisible(!1),n.sprites=n.sprites||{},void 0!==n.sprites[l])n.sprites[l].setVisible(!0);else{var h=this._createSprite(n,r);o.addChild(h)}n.currentSprite=n.sprites[l],n.currentSpriteName=l}var u=n.bone;o.setPosition(u.worldX+r.x*u.m00+r.y*u.m01,u.worldY+r.x*u.m10+r.y*u.m11),o.setScale(u.worldScaleX,u.worldScaleY),i=n.currentSprite,i._flippedX=u.worldFlipX,i._flippedY=u.worldFlipY,i._flippedY||i._flippedX?(o.setRotation(u.worldRotation),i.setRotation(r.rotation)):(o.setRotation(-u.worldRotation),i.setRotation(-r.rotation)),i._renderCmd._displayedOpacity=0|this._node.getOpacity()*s.a*n.a;var d=0|s.r*n.r*255,_=0|s.g*n.g*255,p=0|s.b*n.b*255;i.setColor(cc.color(d,_,p)),i._renderCmd._updateColor()}else if(a!==spine.AttachmentType.skinnedmesh){o.setVisible(!1);continue}o.setVisible(!0)}else o.setVisible(!1)}}();!function(){sp.Skeleton.WebGLRenderCmd=function(t){cc.Node.WebGLRenderCmd.call(this,t),this._needDraw=!0,this._matrix=new cc.math.Matrix4,this._matrix.identity(),this._tmpQuad=new cc.V3F_C4B_T2F_Quad,this.setShaderProgram(cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR))};var t=sp.Skeleton.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);t.constructor=sp.Skeleton.WebGLRenderCmd,t.rendering=function(t){var e,i,n,r,o,s,c=this._node,a=this._tmpQuad,l=c.getColor(),h=c._skeleton,u=c._blendFunc,d=c._premultipliedAlpha,_=this._worldTransform;for(this._matrix.mat[0]=_.a,this._matrix.mat[4]=_.c,this._matrix.mat[12]=_.tx,this._matrix.mat[1]=_.b,this._matrix.mat[5]=_.d,this._matrix.mat[13]=_.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix),h.r=l.r/255,h.g=l.g/255,h.b=l.b/255,h.a=c.getOpacity()/255,d&&(h.r*=h.a,h.g*=h.a,h.b*=h.a),o=0,s=h.drawOrder.length;o<s;o++)if(r=h.drawOrder[o],r.attachment){switch(n=r.attachment,r.attachment.type){case sp.ATTACHMENT_TYPE.REGION:this._updateRegionAttachmentQuad(n,r,a,d);break;case sp.ATTACHMENT_TYPE.MESH:this._updateMeshAttachmentQuad(n,r,a,d);break;case sp.ATTACHMENT_TYPE.SKINNED_MESH:break;default:continue}var p=c.getTextureAtlas(n);if(r.data.blendMode!=e)switch(i&&(i.drawQuads(),i.removeAllQuads()),e=r.data.blendMode){case spine.BlendMode.additive:cc.glBlendFunc(d?cc.ONE:cc.SRC_ALPHA,cc.ONE);break;case spine.BlendMode.multiply:cc.glBlendFunc(cc.DST_COLOR,cc.ONE_MINUS_SRC_ALPHA);break;case spine.BlendMode.screen:cc.glBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_COLOR);break;default:cc.glBlendFunc(u.src,u.dst)}else p!=i&&i&&(i.drawQuads(),i.removeAllQuads());i=p;var f=i.getTotalQuads();if(i.getCapacity()==f&&(i.drawQuads(),i.removeAllQuads(),!i.resizeCapacity(2*i.getCapacity())))return;i.updateQuad(a,f)}if(i&&(i.drawQuads(),i.removeAllQuads()),c._debugBones||c._debugSlots){cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._matrix;var m=cc._drawingUtil;if(c._debugSlots)for(m.setDrawColor(0,0,255,255),m.setLineWidth(1),o=0,s=h.slots.length;o<s;o++)if(r=h.drawOrder[o],r.attachment&&r.attachment.type==sp.ATTACHMENT_TYPE.REGION){n=r.attachment,this._updateRegionAttachmentQuad(n,r,a);var g=[];g.push(cc.p(a.bl.vertices.x,a.bl.vertices.y)),g.push(cc.p(a.br.vertices.x,a.br.vertices.y)),g.push(cc.p(a.tr.vertices.x,a.tr.vertices.y)),g.push(cc.p(a.tl.vertices.x,a.tl.vertices.y)),m.drawPoly(g,4,!0)}if(c._debugBones){var y;for(m.setLineWidth(2),m.setDrawColor(255,0,0,255),o=0,s=h.bones.length;o<s;o++){y=h.bones[o];var v=y.data.length*y.m00+y.worldX,T=y.data.length*y.m10+y.worldY;m.drawLine(cc.p(y.worldX,y.worldY),cc.p(v,T))}for(m.setPointSize(4),m.setDrawColor(0,0,255,255),o=0,s=h.bones.length;o<s;o++)y=h.bones[o],m.drawPoint(cc.p(y.worldX,y.worldY)),0==o&&m.setDrawColor(0,255,0,255)}cc.kmGLPopMatrix()}},t._createChildFormSkeletonData=function(){},t._updateChild=function(){},t._updateRegionAttachmentQuad=function(t,e,i,n){var r={};t.computeVertices(e.bone.skeleton.x,e.bone.skeleton.y,e.bone,r);var o=e.bone.skeleton.r*e.r*255,s=e.bone.skeleton.g*e.g*255,c=e.bone.skeleton.b*e.b*255,a=e.bone.skeleton.a*e.a;n&&(o*=a,s*=a,c*=a);var l=255*a;i.bl.colors.r=i.tl.colors.r=i.tr.colors.r=i.br.colors.r=o,i.bl.colors.g=i.tl.colors.g=i.tr.colors.g=i.br.colors.g=s,i.bl.colors.b=i.tl.colors.b=i.tr.colors.b=i.br.colors.b=c,i.bl.colors.a=i.tl.colors.a=i.tr.colors.a=i.br.colors.a=l;var h=sp.VERTEX_INDEX;i.bl.vertices.x=r[h.X1],i.bl.vertices.y=r[h.Y1],i.tl.vertices.x=r[h.X2],i.tl.vertices.y=r[h.Y2],i.tr.vertices.x=r[h.X3],i.tr.vertices.y=r[h.Y3],i.br.vertices.x=r[h.X4],i.br.vertices.y=r[h.Y4],i.bl.texCoords.u=t.uvs[h.X1],i.bl.texCoords.v=t.uvs[h.Y1],i.tl.texCoords.u=t.uvs[h.X2],i.tl.texCoords.v=t.uvs[h.Y2],i.tr.texCoords.u=t.uvs[h.X3],i.tr.texCoords.v=t.uvs[h.Y3],i.br.texCoords.u=t.uvs[h.X4],i.br.texCoords.v=t.uvs[h.Y4]},t._updateMeshAttachmentQuad=function(t,e,i,n){var r={};t.computeWorldVertices(e.bone.x,e.bone.y,e,r);var o=e.bone.skeleton.r*e.r*255,s=e.bone.skeleton.g*e.g*255,c=e.bone.skeleton.b*e.b*255,a=e.bone.skeleton.a*e.a;n&&(o*=a,s*=a,c*=a);var l=255*a;i.bl.colors.r=i.tl.colors.r=i.tr.colors.r=i.br.colors.r=o,i.bl.colors.g=i.tl.colors.g=i.tr.colors.g=i.br.colors.g=s,i.bl.colors.b=i.tl.colors.b=i.tr.colors.b=i.br.colors.b=c,i.bl.colors.a=i.tl.colors.a=i.tr.colors.a=i.br.colors.a=l;var h=sp.VERTEX_INDEX;i.bl.vertices.x=r[h.X1],i.bl.vertices.y=r[h.Y1],i.tl.vertices.x=r[h.X2],i.tl.vertices.y=r[h.Y2],i.tr.vertices.x=r[h.X3],i.tr.vertices.y=r[h.Y3],i.br.vertices.x=r[h.X4],i.br.vertices.y=r[h.Y4],i.bl.texCoords.u=t.uvs[h.X1],i.bl.texCoords.v=t.uvs[h.Y1],i.tl.texCoords.u=t.uvs[h.X2],i.tl.texCoords.v=t.uvs[h.Y2],i.tr.texCoords.u=t.uvs[h.X3],i.tr.texCoords.v=t.uvs[h.Y3],i.br.texCoords.u=t.uvs[h.X4],i.br.texCoords.v=t.uvs[h.Y4]}}();!function(){gaf.Sprite.WebGLRenderCmd=function(t){cc.Sprite.WebGLRenderCmd.call(this,t),this._defualtShader=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR),this._customShader=gaf._Shaders.Alpha,this._tintMult=null,this._tintOffset=null,this._ctxMatrixBody=null,this._ctxMatrixAppendix=null};var t=gaf.Sprite.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);t.constructor=gaf.Sprite.WebGLRenderCmd,t._identityVec=[1,1,1,1],t._zeroVec=[0,0,0,0],t._identityMat=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t._disableCtx=function(){this.setShaderProgram(this._defualtShader)},t._enableCtx=function(){this.setShaderProgram(this._customShader)},t._applyCtxState=function(t){var e=t._cascadeColorMult;this._tintMult=[e.r/255,e.g/255,e.b/255,e.a/255];var i=t._cascadeColorOffset;this._tintOffset=[i.r/255,i.g/255,i.b/255,i.a/255];var n=t._filterStack;if(n&&n.length>0&&n[0].type===gaf.EFFECT_COLOR_MATRIX){var r=n[0].colorMatrix;this._ctxMatrixBody=[r.rr,r.rg,r.rb,r.ra,r.gr,r.gg,r.gb,r.ga,r.br,r.bg,r.bb,r.ba,r.ar,r.ag,r.ab,r.aa],this._ctxMatrixAppendix=[r.r/255,r.g/255,r.b/255,r.a/255]}else this._ctxMatrixBody=null,this._ctxMatrixAppendix=null},t._setUniforms=function(){this._shaderProgram===this._customShader&&(this._shaderProgram.use(),this._shaderProgram.setUniformLocationWith4fv(gaf._Uniforms.ColorTransformMult,this._tintMult,1),this._shaderProgram.setUniformLocationWith4fv(gaf._Uniforms.ColorTransformOffset,this._tintOffset,1),this._ctxMatrixBody&&this._ctxMatrixAppendix?(this._shaderProgram.setUniformLocationWithMatrix4fv(gaf._Uniforms.ColorMatrixBody,this._ctxMatrixBody,1),this._shaderProgram.setUniformLocationWith4fv(gaf._Uniforms.ColorMatrixAppendix,this._ctxMatrixAppendix,1)):(this._shaderProgram.setUniformLocationWithMatrix4fv(gaf._Uniforms.ColorMatrixBody,this._identityMat,1),this._shaderProgram.setUniformLocationWith4fv(gaf._Uniforms.ColorMatrixAppendix,this._zeroVec,1)))},t.rendering=function(t){this._setUniforms(),cc.Sprite.WebGLRenderCmd.prototype.rendering.call(this,t)}}();